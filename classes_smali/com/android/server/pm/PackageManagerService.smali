.class public Lcom/android/server/pm/PackageManagerService;
.super Landroid/content/pm/IPackageManager$Stub;
.source "PackageManagerService.java"

# interfaces
.implements Lcom/android/server/pm/PackageSender;


# annotations
.annotation system Ldalvik/annotation/MemberClasses;
    value = {
        Lcom/android/server/pm/PackageManagerService$PmTimeTask;,
        Lcom/android/server/pm/PackageManagerService$ActiveInstallSession;,
        Lcom/android/server/pm/PackageManagerService$PackageManagerInternalImpl;,
        Lcom/android/server/pm/PackageManagerService$PackageManagerNative;,
        Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;,
        Lcom/android/server/pm/PackageManagerService$MoveCallbacks;,
        Lcom/android/server/pm/PackageManagerService$PackageFreezer;,
        Lcom/android/server/pm/PackageManagerService$BlobXmlRestorer;,
        Lcom/android/server/pm/PackageManagerService$SystemDeleteException;,
        Lcom/android/server/pm/PackageManagerService$DeletePackageAction;,
        Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;,
        Lcom/android/server/pm/PackageManagerService$PrepareFailure;,
        Lcom/android/server/pm/PackageManagerService$PrepareResult;,
        Lcom/android/server/pm/PackageManagerService$ReconciledPackage;,
        Lcom/android/server/pm/PackageManagerService$ReconcileFailure;,
        Lcom/android/server/pm/PackageManagerService$ReconcileRequest;,
        Lcom/android/server/pm/PackageManagerService$CommitRequest;,
        Lcom/android/server/pm/PackageManagerService$InstallRequest;,
        Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;,
        Lcom/android/server/pm/PackageManagerService$MoveInstallArgs;,
        Lcom/android/server/pm/PackageManagerService$FileInstallArgs;,
        Lcom/android/server/pm/PackageManagerService$InstallArgs;,
        Lcom/android/server/pm/PackageManagerService$InstallParams;,
        Lcom/android/server/pm/PackageManagerService$MultiPackageInstallParams;,
        Lcom/android/server/pm/PackageManagerService$VerificationInfo;,
        Lcom/android/server/pm/PackageManagerService$MoveInfo;,
        Lcom/android/server/pm/PackageManagerService$OriginInfo;,
        Lcom/android/server/pm/PackageManagerService$HandlerParams;,
        Lcom/android/server/pm/PackageManagerService$ScanRequest;,
        Lcom/android/server/pm/PackageManagerService$ScanResult;,
        Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;,
        Lcom/android/server/pm/PackageManagerService$PackageHandler;,
        Lcom/android/server/pm/PackageManagerService$PostInstallData;,
        Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;,
        Lcom/android/server/pm/PackageManagerService$IntentVerifierProxy;,
        Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;,
        Lcom/android/server/pm/PackageManagerService$IFVerificationParams;,
        Lcom/android/server/pm/PackageManagerService$ParallelPackageParserCallback;,
        Lcom/android/server/pm/PackageManagerService$PackageParserCallback;,
        Lcom/android/server/pm/PackageManagerService$ComponentType;,
        Lcom/android/server/pm/PackageManagerService$ScanFlags;
    }
.end annotation


# static fields
.field private static final ATTR_IS_GRANTED:Ljava/lang/String; = "g"

.field private static final ATTR_PACKAGE_NAME:Ljava/lang/String; = "pkg"

.field private static final ATTR_PERMISSION_NAME:Ljava/lang/String; = "name"

.field private static final ATTR_REVOKE_ON_UPGRADE:Ljava/lang/String; = "rou"

.field private static final ATTR_USER_FIXED:Ljava/lang/String; = "fixed"

.field private static final ATTR_USER_SET:Ljava/lang/String; = "set"

.field private static final BLUETOOTH_UID:I = 0x3ea

.field private static final BROADCAST_DELAY:J = 0x3e8L

.field private static final BROADCAST_DELAY_DURING_STARTUP:J = 0x2710L

.field private static final CAPTURE_PERF_LOG_DELAY_MILLIS:J = 0x493e0L

.field static final CHECK_PENDING_VERIFICATION:I = 0x10

.field static final CLEAR_RUNTIME_PERMISSIONS_ON_UPGRADE:Z = false

.field public static final COMPRESSED_EXTENSION:Ljava/lang/String; = ".gz"

.field private static final CTS_SERVICEPERMISSION_WHITE:[Ljava/lang/String;

.field private static DEBUG_ABI_SELECTION:Z = false

.field private static DEBUG_APP_DATA:Z = false

.field private static DEBUG_BACKUP:Z = false

.field private static DEBUG_BROADCASTS:Z = false

.field public static DEBUG_COMPRESSION:Z = false

.field public static DEBUG_DEXOPT:Z = false

.field static DEBUG_DOMAIN_VERIFICATION:Z = false

.field public static DEBUG_INSTALL:Z = false

.field private static DEBUG_INSTANT:Z = false

.field private static DEBUG_INTENT_MATCHING:Z = false

.field private static DEBUG_PACKAGE_INFO:Z = false

.field public static DEBUG_PACKAGE_SCANNING:Z = false

.field public static DEBUG_PERMISSIONS:Z = false

.field static DEBUG_PREFERRED:Z = false

.field public static DEBUG_REMOVE:Z = false

.field static final DEBUG_SD_INSTALL:Z = false

.field public static DEBUG_SETTINGS:Z = false

.field private static DEBUG_SHARED_LIBRARIES:Z = false

.field static DEBUG_UPGRADE:Z = false

.field private static DEBUG_VERIFY:Z = false

.field private static final DEFAULT_ENABLE_ROLLBACK_TIMEOUT_MILLIS:J = 0x2710L

.field private static final DEFAULT_MANDATORY_FSTRIM_INTERVAL:J = 0xf731400L

.field private static final DEFAULT_PACKAGE_PARSER_CACHE_ENABLED:Z = true

.field private static final DEFAULT_UNUSED_STATIC_SHARED_LIB_MIN_CACHE_PERIOD:J = 0x6ddd00L

.field private static final DEFAULT_VERIFICATION_RESPONSE:I = 0x1

.field private static final DEFAULT_VERIFICATION_TIMEOUT:J = 0x2710L

.field private static final DEFAULT_VERIFY_ENABLE:Z = true

.field static final DEFERRED_NO_KILL_INSTALL_OBSERVER:I = 0x18

.field static final DEFERRED_NO_KILL_INSTALL_OBSERVER_DELAY_MS:I = 0x1f4

.field static final DEFERRED_NO_KILL_POST_DELETE:I = 0x17

.field static final DEFERRED_NO_KILL_POST_DELETE_DELAY_MS:I = 0xbb8

.field private static final EMPTY_INT_ARRAY:[I

.field private static final ENABLE_FREE_CACHE_V2:Z

.field static final ENABLE_ROLLBACK_STATUS:I = 0x15

.field static final ENABLE_ROLLBACK_TIMEOUT:I = 0x16

.field private static final HIDE_EPHEMERAL_APIS:Z = false

.field static final INIT_COPY:I = 0x5

.field private static final INSTANT_APP_BROADCAST_PERMISSION:[Ljava/lang/String;

.field static final INSTANT_APP_RESOLUTION_PHASE_TWO:I = 0x14

.field static final INTENT_FILTER_VERIFIED:I = 0x12

.field private static final IS_USER_BUILD:Z

.field private static final KILL_APP_REASON_GIDS_CHANGED:Ljava/lang/String; = "permission grant or revoke changed gids"

.field private static final KILL_APP_REASON_PERMISSIONS_REVOKED:Ljava/lang/String; = "permissions revoked"

.field private static final LOG_UID:I = 0x3ef

.field private static final MSG_CAPTURE_PERFORMANCE_LOG:I = 0x1

.field private static final NETWORKSTACK_UID:I = 0x431

.field private static final NFC_UID:I = 0x403

.field private static final ODM_OVERLAY_DIR:Ljava/lang/String; = "/odm/overlay"

.field private static final OEM_OVERLAY_DIR:Ljava/lang/String; = "/oem/overlay"

.field private static final PACKAGE_GTS_INSTALL:Ljava/lang/String; = "com.google.android.installpackageswhitelist.gts"

.field private static final PACKAGE_GTS_PERMISSION:Ljava/lang/String; = "com.google.android.permission.gts"

.field private static final PACKAGE_MIME_TYPE:Ljava/lang/String; = "application/vnd.android.package-archive"

.field private static final PACKAGE_SCHEME:Ljava/lang/String; = "package"

.field static final PACKAGE_VERIFIED:I = 0xf

.field public static final PLATFORM_PACKAGE_NAME:Ljava/lang/String; = "android"

.field static final POST_INSTALL:I = 0x9

.field private static final PRECOMPILE_LAYOUTS:Ljava/lang/String; = "pm.precompile_layouts"

.field private static final PRODUCT_OVERLAY_DIR:Ljava/lang/String; = "/product/overlay"

.field private static final PRODUCT_SERVICES_OVERLAY_DIR:Ljava/lang/String; = "/product_services/overlay"

.field private static final PROPERTY_ENABLE_ROLLBACK_TIMEOUT_MILLIS:Ljava/lang/String; = "enable_rollback_timeout"

.field private static final RADIO_UID:I = 0x3e9

.field public static final REASON_AB_OTA:I = 0x4

.field public static final REASON_BACKGROUND_DEXOPT:I = 0x3

.field public static final REASON_BOOT:I = 0x1

.field public static final REASON_FIRST_BOOT:I = 0x0

.field public static final REASON_INACTIVE_PACKAGE_DOWNGRADE:I = 0x5

.field public static final REASON_INSTALL:I = 0x2

.field public static final REASON_LAST:I = 0x6

.field public static final REASON_SHARED:I = 0x6

.field public static final REASON_UNKNOWN:I = -0x1

.field static final SCAN_AS_FULL_APP:I = 0x8000

.field static final SCAN_AS_INSTANT_APP:I = 0x4000

.field static final SCAN_AS_ODM:I = 0x800000

.field static final SCAN_AS_OEM:I = 0x80000

.field static final SCAN_AS_PRIVILEGED:I = 0x40000

.field static final SCAN_AS_PRODUCT:I = 0x200000

.field static final SCAN_AS_PRODUCT_SERVICES:I = 0x400000

.field static final SCAN_AS_SYSTEM:I = 0x20000

.field static final SCAN_AS_VENDOR:I = 0x100000

.field static final SCAN_AS_VIRTUAL_PRELOAD:I = 0x10000

.field static final SCAN_BOOTING:I = 0x10

.field static final SCAN_CAN_UNINSTALL:I = 0x1000000

.field static final SCAN_CHECK_ONLY:I = 0x400

.field static final SCAN_DONT_KILL_APP:I = 0x800

.field static final SCAN_FIRST_BOOT_OR_UPGRADE:I = 0x2000

.field static final SCAN_IGNORE_FROZEN:I = 0x1000

.field static final SCAN_INITIAL:I = 0x200

.field static final SCAN_MOVE:I = 0x100

.field static final SCAN_NEW_INSTALL:I = 0x4

.field static final SCAN_NO_DEX:I = 0x1

.field static final SCAN_REQUIRE_KNOWN:I = 0x80

.field static final SCAN_UPDATE_SIGNATURE:I = 0x2

.field static final SCAN_UPDATE_TIME:I = 0x8

.field private static final SD_ENCRYPTION_ALGORITHM:Ljava/lang/String; = "AES"

.field private static final SD_ENCRYPTION_KEYSTORE_NAME:Ljava/lang/String; = "AppsOnSD"

.field static final SEND_PENDING_BROADCAST:I = 0x1

.field private static final SE_UID:I = 0x42c

.field private static final SHELL_UID:I = 0x7d0

.field static final START_INTENT_FILTER_VERIFICATIONS:I = 0x11

.field private static final STATIC_SHARED_LIB_DELIMITER:Ljava/lang/String; = "_"

.field public static final STUB_SUFFIX:Ljava/lang/String; = "-Stub"

.field private static final SYSTEM_RUNTIME_GRANT_MASK:I = 0x34

.field static final TAG:Ljava/lang/String; = "PackageManager"

.field private static final TAG_ALL_GRANTS:Ljava/lang/String; = "rt-grants"

.field private static final TAG_DEFAULT_APPS:Ljava/lang/String; = "da"

.field private static final TAG_GRANT:Ljava/lang/String; = "grant"

.field private static final TAG_INTENT_FILTER_VERIFICATION:Ljava/lang/String; = "iv"

.field private static final TAG_PERMISSION:Ljava/lang/String; = "perm"

.field private static final TAG_PERMISSION_BACKUP:Ljava/lang/String; = "perm-grant-backup"

.field private static final TAG_PREFERRED_BACKUP:Ljava/lang/String; = "pa"

.field private static final TYPE_ACTIVITY:I = 0x1

.field private static final TYPE_PROVIDER:I = 0x4

.field private static final TYPE_RECEIVER:I = 0x2

.field private static final TYPE_SERVICE:I = 0x3

.field private static final TYPE_UNKNOWN:I = 0x0

.field private static final USER_RUNTIME_GRANT_MASK:I = 0xb

.field private static final VENDOR_OVERLAY_DIR:Ljava/lang/String; = "/vendor/overlay"

.field static final WATCHDOG_TIMEOUT:J = 0x927c0L

.field static final WRITE_PACKAGE_LIST:I = 0x13

.field static final WRITE_PACKAGE_RESTRICTIONS:I = 0xe

.field static final WRITE_SETTINGS:I = 0xd

.field static final WRITE_SETTINGS_DELAY:I = 0x2710

.field private static final sAppInstallDir:Ljava/io/File;

.field private static final sAppLib32InstallDir:Ljava/io/File;

.field private static final sBrowserIntent:Landroid/content/Intent;

.field private static final sProviderInitOrderSorter:Ljava/util/Comparator;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/Comparator<",
            "Landroid/content/pm/ProviderInfo;",
            ">;"
        }
    .end annotation
.end field

.field static sUserManager:Lcom/android/server/pm/UserManagerService;


# instance fields
.field bootCompleteInstall:Z

.field bootPkgName:Ljava/lang/String;

.field data_scan:Ljava/lang/Boolean;

.field flymePackageManagerService:Lcom/android/server/pm/FlymePackageManagerService;

.field private mActivityManagerInternal:Landroid/app/ActivityManagerInternal;

.field private mActivityTaskManagerInternal:Lcom/android/server/wm/ActivityTaskManagerInternal;

.field mAndroidApplication:Landroid/content/pm/ApplicationInfo;

.field private final mApexManager:Lcom/android/server/pm/ApexManager;

.field final mAppPredictionServicePackage:Ljava/lang/String;

.field final mArtManagerService:Lcom/android/server/pm/dex/ArtManagerService;

.field final mAvailableFeatures:Landroid/util/ArrayMap;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mAvailableFeatures"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArrayMap<",
            "Ljava/lang/String;",
            "Landroid/content/pm/FeatureInfo;",
            ">;"
        }
    .end annotation
.end field

.field private mBootProfDisable:Z

.field private mCacheDir:Ljava/io/File;

.field final mChangedPackages:Landroid/util/SparseArray;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray<",
            "Landroid/util/SparseArray<",
            "Ljava/lang/String;",
            ">;>;"
        }
    .end annotation
.end field

.field mChangedPackagesSequenceNumber:I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation
.end field

.field final mChangedPackagesSequenceNumbers:Landroid/util/SparseArray;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray<",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Ljava/lang/Integer;",
            ">;>;"
        }
    .end annotation
.end field

.field private mCheckPermissionDelegate:Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation
.end field

.field private final mCompilerStats:Lcom/android/server/pm/CompilerStats;

.field private final mComponentResolver:Lcom/android/server/pm/ComponentResolver;

.field final mConfiguratorPackage:Ljava/lang/String;

.field final mContext:Landroid/content/Context;

.field mCustomResolverComponentName:Landroid/content/ComponentName;

.field final mDefParseFlags:I

.field private mDefaultBrowserProvider:Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation
.end field

.field private mDefaultDialerProvider:Landroid/content/pm/PackageManagerInternal$DefaultDialerProvider;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation
.end field

.field private mDefaultHomeProvider:Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation
.end field

.field final mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

.field private final mDefaultPermissionsGrantedUsers:Landroid/util/SparseIntArray;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation
.end field

.field private mDeviceIdleController:Lcom/android/server/DeviceIdleController$LocalService;

.field private mDeviceStateManager:Lmeizu/os/DeviceStateManager;

.field private final mDexManager:Lcom/android/server/pm/dex/DexManager;

.field private mDexOptDialogShown:Z
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation
.end field

.field private mDirtyUsers:Landroid/util/ArraySet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArraySet<",
            "Ljava/lang/Integer;",
            ">;"
        }
    .end annotation
.end field

.field final mDocumenterPackage:Ljava/lang/String;

.field private final mExistingSystemPackages:Landroid/util/ArraySet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArraySet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation
.end field

.field private final mExpectingBetter:Landroid/util/ArrayMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArrayMap<",
            "Ljava/lang/String;",
            "Ljava/io/File;",
            ">;"
        }
    .end annotation
.end field

.field mExternalSourcesPolicy:Landroid/content/pm/PackageManagerInternal$ExternalSourcesPolicy;

.field final mFactoryTest:Z

.field mFirstBoot:Z

.field private mFlymeThirdAppManager:Lcom/android/server/pm/FlymeThirdAppManager;

.field final mFrozenPackages:Landroid/util/ArraySet;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArraySet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation
.end field

.field final mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

.field final mHandlerThread:Lcom/android/server/ServiceThread;

.field volatile mHasSystemUidErrors:Z

.field final mIncidentReportApproverPackage:Ljava/lang/String;

.field final mInstallLock:Ljava/lang/Object;

.field final mInstaller:Lcom/android/server/pm/Installer;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock"
        }
    .end annotation
.end field

.field final mInstallerService:Lcom/android/server/pm/PackageInstallerService;

.field mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

.field final mInstantAppInstallerInfo:Landroid/content/pm/ResolveInfo;

.field private final mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

.field final mInstantAppResolverConnection:Lcom/android/server/pm/InstantAppResolverConnection;

.field final mInstantAppResolverSettingsComponent:Landroid/content/ComponentName;

.field final mInstrumentation:Landroid/util/ArrayMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArrayMap<",
            "Landroid/content/ComponentName;",
            "Landroid/content/pm/PackageParser$Instrumentation;",
            ">;"
        }
    .end annotation
.end field

.field final mIntentFilterVerificationStates:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray<",
            "Lcom/android/server/pm/IntentFilterVerificationState;",
            ">;"
        }
    .end annotation
.end field

.field private mIntentFilterVerificationToken:I

.field private final mIntentFilterVerifier:Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier<",
            "Landroid/content/pm/PackageParser$ActivityIntentInfo;",
            ">;"
        }
    .end annotation
.end field

.field private final mIntentFilterVerifierComponent:Landroid/content/ComponentName;

.field final mIsPreNMR1Upgrade:Z

.field final mIsPreNUpgrade:Z

.field final mIsPreQUpgrade:Z

.field final mIsUpgrade:Z

.field final mIsolatedOwners:Landroid/util/SparseIntArray;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation
.end field

.field private mKeepUninstalledPackages:Ljava/util/List;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation
.end field

.field final mLoadedVolumes:Landroid/util/ArraySet;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mLoadedVolumes"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArraySet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation
.end field

.field private mMediaMounted:Z

.field final mMetrics:Landroid/util/DisplayMetrics;

.field private final mModuleInfoProvider:Lcom/android/server/pm/ModuleInfoProvider;

.field private final mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

.field mNextInstallToken:I

.field private mNextMoveId:Ljava/util/concurrent/atomic/AtomicInteger;

.field private final mNoKillInstallObservers:Ljava/util/Map;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/Pair<",
            "Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;",
            "Landroid/content/pm/IPackageInstallObserver2;",
            ">;>;"
        }
    .end annotation
.end field

.field private final mOnPermissionChangeListeners:Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;

.field final mOnlyCore:Z

.field final mOptionalVerifierPackage:Ljava/lang/String;

.field private mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

.field private final mPackageDexOptimizer:Lcom/android/server/pm/PackageDexOptimizer;

.field private final mPackageListObservers:Landroid/util/ArraySet;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArraySet<",
            "Landroid/content/pm/PackageManagerInternal$PackageListObserver;",
            ">;"
        }
    .end annotation
.end field

.field final mPackageParserCallback:Landroid/content/pm/PackageParser$Callback;

.field private final mPackageUsage:Lcom/android/server/pm/PackageUsage;

.field final mPackages:Landroid/util/ArrayMap;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArrayMap<",
            "Ljava/lang/String;",
            "Landroid/content/pm/PackageParser$Package;",
            ">;"
        }
    .end annotation
.end field

.field final mParallelPackageParserCallback:Lcom/android/server/pm/PackageManagerService$ParallelPackageParserCallback;

.field final mPendingBroadcasts:Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;

.field final mPendingEnableRollback:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray<",
            "Lcom/android/server/pm/PackageManagerService$InstallParams;",
            ">;"
        }
    .end annotation
.end field

.field private mPendingEnableRollbackToken:I

.field final mPendingVerification:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray<",
            "Lcom/android/server/pm/PackageVerificationState;",
            ">;"
        }
    .end annotation
.end field

.field private mPendingVerificationToken:I

.field private mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

.field private final mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

.field mPlatformPackage:Landroid/content/pm/PackageParser$Package;

.field private mPrepareAppDataFuture:Ljava/util/concurrent/Future;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/concurrent/Future<",
            "*>;"
        }
    .end annotation
.end field

.field private final mProcessLoggingHandler:Lcom/android/server/pm/ProcessLoggingHandler;

.field mPromoteSystemApps:Z

.field final mProtectedBroadcasts:Landroid/util/ArraySet;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mProtectedBroadcasts"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArraySet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation
.end field

.field final mProtectedPackages:Lcom/android/server/pm/ProtectedPackages;

.field final mRequiredInstallerPackage:Ljava/lang/String;

.field final mRequiredPermissionControllerPackage:Ljava/lang/String;

.field final mRequiredUninstallerPackage:Ljava/lang/String;

.field final mRequiredVerifierPackage:Ljava/lang/String;

.field final mResolveActivity:Landroid/content/pm/ActivityInfo;

.field mResolveComponentName:Landroid/content/ComponentName;

.field final mResolveInfo:Landroid/content/pm/ResolveInfo;

.field mResolverReplaced:Z

.field final mRunningInstalls:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray<",
            "Lcom/android/server/pm/PackageManagerService$PostInstallData;",
            ">;"
        }
    .end annotation
.end field

.field volatile mSafeMode:Z

.field final mSdkVersion:I

.field final mSeparateProcesses:[Ljava/lang/String;

.field private mServiceStartWithDelay:J

.field final mServicesSystemSharedLibraryPackageName:Ljava/lang/String;

.field final mSettings:Lcom/android/server/pm/Settings;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation
.end field

.field final mSetupWizardPackage:Ljava/lang/String;

.field final mSharedLibraries:Landroid/util/ArrayMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArrayMap<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;"
        }
    .end annotation
.end field

.field final mSharedSystemSharedLibraryPackageName:Ljava/lang/String;

.field final mStaticLibsByDeclaringPackage:Landroid/util/ArrayMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArrayMap<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;"
        }
    .end annotation
.end field

.field private mStorageListener:Landroid/os/storage/StorageEventListener;

.field private mStorageManagerInternal:Landroid/os/storage/StorageManagerInternal;

.field final mStorageManagerPackage:Ljava/lang/String;

.field volatile mSystemReady:Z

.field final mSystemTextClassifierPackage:Ljava/lang/String;

.field private mTimeTask:Lcom/android/server/pm/PackageManagerService$PmTimeTask;

.field private mTimer:Ljava/util/Timer;

.field final mTransferedPackages:Landroid/util/ArraySet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/ArraySet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation
.end field

.field private mUserManagerInternal:Landroid/os/UserManagerInternal;

.field private final mUserNeedsBadging:Landroid/util/SparseBooleanArray;

.field private final mViewCompiler:Lcom/android/server/pm/dex/ViewCompiler;

.field private volatile mWebInstantAppsDisabled:Landroid/util/SparseBooleanArray;

.field final mWellbeingPackage:Ljava/lang/String;

.field private runningGtsInstall:Z

.field private runningGtsPermission:Z


# direct methods
.method private static synthetic $closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V
    .registers 3
    .param p0, "x0"  # Ljava/lang/Throwable;
    .param p1, "x1"  # Ljava/lang/AutoCloseable;

    .line 3674
    if-eqz p0, :cond_b

    :try_start_2
    invoke-interface {p1}, Ljava/lang/AutoCloseable;->close()V
    :try_end_5
    .catchall {:try_start_2 .. :try_end_5} :catchall_6

    goto :goto_e

    :catchall_6
    move-exception v0

    invoke-virtual {p0, v0}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V

    goto :goto_e

    :cond_b
    invoke-interface {p1}, Ljava/lang/AutoCloseable;->close()V

    :goto_e
    return-void
.end method

.method static constructor <clinit>()V
    .registers 9

    .line 450
    const/4 v0, 0x0

    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_SETTINGS:Z

    .line 451
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    .line 452
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_UPGRADE:Z

    .line 453
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    .line 454
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    .line 455
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    .line 456
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    .line 457
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_BROADCASTS:Z

    .line 458
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_INFO:Z

    .line 459
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INTENT_MATCHING:Z

    .line 460
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z

    .line 461
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_VERIFY:Z

    .line 462
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PERMISSIONS:Z

    .line 463
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_SHARED_LIBRARIES:Z

    .line 464
    sget-boolean v1, Landroid/os/Build;->IS_DEBUGGABLE:Z

    sput-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_COMPRESSION:Z

    .line 469
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DEXOPT:Z

    .line 471
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_ABI_SELECTION:Z

    .line 472
    sget-boolean v1, Landroid/os/Build;->IS_DEBUGGABLE:Z

    sput-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    .line 473
    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_APP_DATA:Z

    .line 480
    nop

    .line 481
    const-string v1, "fw.free_cache_v2"

    const/4 v2, 0x1

    invoke-static {v1, v2}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z

    move-result v1

    sput-boolean v1, Lcom/android/server/pm/PackageManagerService;->ENABLE_FREE_CACHE_V2:Z

    .line 546
    new-array v0, v0, [I

    sput-object v0, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    .line 644
    new-instance v0, Landroid/content/Intent;

    invoke-direct {v0}, Landroid/content/Intent;-><init>()V

    sput-object v0, Lcom/android/server/pm/PackageManagerService;->sBrowserIntent:Landroid/content/Intent;

    .line 645
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sBrowserIntent:Landroid/content/Intent;

    const-string v1, "android.intent.action.VIEW"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->setAction(Ljava/lang/String;)Landroid/content/Intent;

    .line 646
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sBrowserIntent:Landroid/content/Intent;

    const-string v1, "android.intent.category.BROWSABLE"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 647
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sBrowserIntent:Landroid/content/Intent;

    const-string v1, "http:"

    invoke-static {v1}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v1

    invoke-virtual {v0, v1}, Landroid/content/Intent;->setData(Landroid/net/Uri;)Landroid/content/Intent;

    .line 648
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sBrowserIntent:Landroid/content/Intent;

    const/16 v1, 0x200

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 671
    const-string v0, "android.permission.ACCESS_INSTANT_APPS"

    filled-new-array {v0}, [Ljava/lang/String;

    move-result-object v0

    sput-object v0, Lcom/android/server/pm/PackageManagerService;->INSTANT_APP_BROADCAST_PERMISSION:[Ljava/lang/String;

    .line 694
    sget-object v0, Landroid/os/Build;->TYPE:Ljava/lang/String;

    const-string/jumbo v1, "user"

    invoke-virtual {v1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    sput-boolean v0, Lcom/android/server/pm/PackageManagerService;->IS_USER_BUILD:Z

    .line 705
    new-instance v0, Ljava/io/File;

    .line 706
    invoke-static {}, Landroid/os/Environment;->getDataDirectory()Ljava/io/File;

    move-result-object v1

    const-string v2, "app"

    invoke-direct {v0, v1, v2}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    sput-object v0, Lcom/android/server/pm/PackageManagerService;->sAppInstallDir:Ljava/io/File;

    .line 708
    new-instance v0, Ljava/io/File;

    .line 709
    invoke-static {}, Landroid/os/Environment;->getDataDirectory()Ljava/io/File;

    move-result-object v1

    const-string v2, "app-lib"

    invoke-direct {v0, v1, v2}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    sput-object v0, Lcom/android/server/pm/PackageManagerService;->sAppLib32InstallDir:Ljava/io/File;

    .line 815
    const-string v3, "android.permission.ACCOUNT_MANAGER"

    const-string v4, "android.permission.BIND_ACCESSIBILITY_SERVICE"

    const-string v5, "android.permission.BIND_NOTIFICATION_LISTENER_SERVICE"

    const-string v6, "android.permission.REVOKE_RUNTIME_PERMISSIONS"

    const-string v7, "android.permission.GRANT_RUNTIME_PERMISSIONS"

    const-string v8, "android.permission.SUSPEND_APPS"

    filled-new-array/range {v3 .. v8}, [Ljava/lang/String;

    move-result-object v0

    sput-object v0, Lcom/android/server/pm/PackageManagerService;->CTS_SERVICEPERMISSION_WHITE:[Ljava/lang/String;

    .line 13544
    sget-object v0, Lcom/android/server/pm/-$$Lambda$PackageManagerService$gOdSzzOoHvFHJbKlJkAgg4fzOH8;->INSTANCE:Lcom/android/server/pm/-$$Lambda$PackageManagerService$gOdSzzOoHvFHJbKlJkAgg4fzOH8;

    sput-object v0, Lcom/android/server/pm/PackageManagerService;->sProviderInitOrderSorter:Ljava/util/Comparator;

    return-void
.end method

.method public constructor <init>(Landroid/content/Context;Lcom/android/server/pm/Installer;ZZ)V
    .registers 71
    .param p1, "context"  # Landroid/content/Context;
    .param p2, "installer"  # Lcom/android/server/pm/Installer;
    .param p3, "factoryTest"  # Z
    .param p4, "onlyCore"  # Z

    .line 2520
    move-object/from16 v15, p0

    move-object/from16 v13, p1

    move-object/from16 v14, p2

    move/from16 v11, p4

    invoke-direct/range {p0 .. p0}, Landroid/content/pm/IPackageManager$Stub;-><init>()V

    .line 680
    sget v1, Landroid/os/Build$VERSION;->SDK_INT:I

    iput v1, v15, Lcom/android/server/pm/PackageManagerService;->mSdkVersion:I

    .line 693
    const/4 v12, 0x0

    iput-boolean v12, v15, Lcom/android/server/pm/PackageManagerService;->mBootProfDisable:Z

    .line 716
    new-instance v1, Ljava/lang/Object;

    invoke-direct {v1}, Ljava/lang/Object;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    .line 723
    new-instance v1, Landroid/util/ArrayMap;

    invoke-direct {v1}, Landroid/util/ArrayMap;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 728
    new-instance v1, Landroid/util/SparseIntArray;

    invoke-direct {v1}, Landroid/util/SparseIntArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mIsolatedOwners:Landroid/util/SparseIntArray;

    .line 736
    new-instance v1, Landroid/util/ArrayMap;

    invoke-direct {v1}, Landroid/util/ArrayMap;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mExpectingBetter:Landroid/util/ArrayMap;

    .line 741
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mExistingSystemPackages:Landroid/util/ArraySet;

    .line 757
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mFrozenPackages:Landroid/util/ArraySet;

    .line 762
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mLoadedVolumes:Landroid/util/ArraySet;

    .line 776
    iput-boolean v12, v15, Lcom/android/server/pm/PackageManagerService;->bootCompleteInstall:Z

    .line 777
    const/4 v10, 0x0

    iput-object v10, v15, Lcom/android/server/pm/PackageManagerService;->bootPkgName:Ljava/lang/String;

    .line 781
    invoke-static {v12}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v1

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->data_scan:Ljava/lang/Boolean;

    .line 788
    new-instance v1, Landroid/util/SparseArray;

    invoke-direct {v1}, Landroid/util/SparseArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mChangedPackages:Landroid/util/SparseArray;

    .line 794
    new-instance v1, Landroid/util/SparseArray;

    invoke-direct {v1}, Landroid/util/SparseArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumbers:Landroid/util/SparseArray;

    .line 797
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    .line 800
    new-instance v1, Landroid/util/SparseIntArray;

    invoke-direct {v1}, Landroid/util/SparseIntArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionsGrantedUsers:Landroid/util/SparseIntArray;

    .line 826
    iput-boolean v12, v15, Lcom/android/server/pm/PackageManagerService;->runningGtsInstall:Z

    .line 827
    iput-boolean v12, v15, Lcom/android/server/pm/PackageManagerService;->runningGtsPermission:Z

    .line 953
    new-instance v1, Lcom/android/server/pm/PackageManagerService$PackageParserCallback;

    invoke-direct {v1, v15}, Lcom/android/server/pm/PackageManagerService$PackageParserCallback;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPackageParserCallback:Landroid/content/pm/PackageParser$Callback;

    .line 954
    new-instance v1, Lcom/android/server/pm/PackageManagerService$ParallelPackageParserCallback;

    invoke-direct {v1, v15}, Lcom/android/server/pm/PackageManagerService$ParallelPackageParserCallback;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mParallelPackageParserCallback:Lcom/android/server/pm/PackageManagerService$ParallelPackageParserCallback;

    .line 958
    new-instance v1, Landroid/util/ArrayMap;

    invoke-direct {v1}, Landroid/util/ArrayMap;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    .line 959
    new-instance v1, Landroid/util/ArrayMap;

    invoke-direct {v1}, Landroid/util/ArrayMap;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mStaticLibsByDeclaringPackage:Landroid/util/ArrayMap;

    .line 963
    new-instance v1, Landroid/util/ArrayMap;

    invoke-direct {v1}, Landroid/util/ArrayMap;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mInstrumentation:Landroid/util/ArrayMap;

    .line 968
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mTransferedPackages:Landroid/util/ArraySet;

    .line 971
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mProtectedBroadcasts:Landroid/util/ArraySet;

    .line 975
    new-instance v1, Landroid/util/SparseArray;

    invoke-direct {v1}, Landroid/util/SparseArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPendingVerification:Landroid/util/SparseArray;

    .line 978
    new-instance v1, Landroid/util/SparseArray;

    invoke-direct {v1}, Landroid/util/SparseArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPendingEnableRollback:Landroid/util/SparseArray;

    .line 991
    new-instance v1, Ljava/util/concurrent/atomic/AtomicInteger;

    invoke-direct {v1}, Ljava/util/concurrent/atomic/AtomicInteger;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mNextMoveId:Ljava/util/concurrent/atomic/AtomicInteger;

    .line 997
    new-instance v1, Landroid/util/SparseBooleanArray;

    invoke-direct {v1}, Landroid/util/SparseBooleanArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mUserNeedsBadging:Landroid/util/SparseBooleanArray;

    .line 1000
    iput v12, v15, Lcom/android/server/pm/PackageManagerService;->mPendingVerificationToken:I

    .line 1003
    iput v12, v15, Lcom/android/server/pm/PackageManagerService;->mPendingEnableRollbackToken:I

    .line 1008
    new-instance v1, Landroid/util/SparseBooleanArray;

    invoke-direct {v1}, Landroid/util/SparseBooleanArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mWebInstantAppsDisabled:Landroid/util/SparseBooleanArray;

    .line 1011
    new-instance v1, Landroid/content/pm/ActivityInfo;

    invoke-direct {v1}, Landroid/content/pm/ActivityInfo;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    .line 1012
    new-instance v1, Landroid/content/pm/ResolveInfo;

    invoke-direct {v1}, Landroid/content/pm/ResolveInfo;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    .line 1017
    iput-boolean v12, v15, Lcom/android/server/pm/PackageManagerService;->mResolverReplaced:Z

    .line 1022
    iput v12, v15, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerificationToken:I

    .line 1031
    new-instance v1, Landroid/content/pm/ResolveInfo;

    invoke-direct {v1}, Landroid/content/pm/ResolveInfo;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerInfo:Landroid/content/pm/ResolveInfo;

    .line 1033
    new-instance v1, Ljava/util/HashMap;

    invoke-direct {v1}, Ljava/util/HashMap;-><init>()V

    .line 1034
    invoke-static {v1}, Ljava/util/Collections;->synchronizedMap(Ljava/util/Map;)Ljava/util/Map;

    move-result-object v1

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mNoKillInstallObservers:Ljava/util/Map;

    .line 1036
    new-instance v1, Landroid/util/SparseArray;

    invoke-direct {v1}, Landroid/util/SparseArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerificationStates:Landroid/util/SparseArray;

    .line 1384
    new-instance v1, Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;

    invoke-direct {v1}, Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPendingBroadcasts:Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;

    .line 1419
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mDirtyUsers:Landroid/util/ArraySet;

    .line 1435
    new-instance v1, Landroid/util/SparseArray;

    invoke-direct {v1}, Landroid/util/SparseArray;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mRunningInstalls:Landroid/util/SparseArray;

    .line 1436
    const/4 v9, 0x1

    iput v9, v15, Lcom/android/server/pm/PackageManagerService;->mNextInstallToken:I

    .line 1483
    new-instance v1, Lcom/android/server/pm/PackageUsage;

    invoke-direct {v1}, Lcom/android/server/pm/PackageUsage;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPackageUsage:Lcom/android/server/pm/PackageUsage;

    .line 1484
    new-instance v1, Lcom/android/server/pm/CompilerStats;

    invoke-direct {v1}, Lcom/android/server/pm/CompilerStats;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mCompilerStats:Lcom/android/server/pm/CompilerStats;

    .line 1866
    new-instance v1, Lcom/android/server/pm/PackageManagerService$1;

    invoke-direct {v1, v15}, Lcom/android/server/pm/PackageManagerService$1;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 2295
    new-instance v1, Lcom/android/server/pm/PackageManagerService$2;

    invoke-direct {v1, v15}, Lcom/android/server/pm/PackageManagerService$2;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mStorageListener:Landroid/os/storage/StorageEventListener;

    .line 23538
    iput-boolean v12, v15, Lcom/android/server/pm/PackageManagerService;->mMediaMounted:Z

    .line 26637
    iput-object v10, v15, Lcom/android/server/pm/PackageManagerService;->flymePackageManagerService:Lcom/android/server/pm/FlymePackageManagerService;

    .line 2522
    const-string/jumbo v1, "package"

    invoke-static {v1}, Lcom/android/server/utils/DebugOptions;->getInstance(Ljava/lang/String;)Lcom/android/server/utils/DebugOptions;

    move-result-object v7

    .line 2523
    .local v7, "debugOptions":Lcom/android/server/utils/DebugOptions;
    const-class v1, Lcom/android/server/pm/PackageManagerService;

    invoke-virtual {v7, v1}, Lcom/android/server/utils/DebugOptions;->addClass(Ljava/lang/Class;)V

    .line 2524
    invoke-virtual {v7}, Lcom/android/server/utils/DebugOptions;->init()V

    .line 2527
    new-instance v1, Lcom/android/server/pm/FlymeThirdAppManager;

    invoke-direct {v1, v15}, Lcom/android/server/pm/FlymeThirdAppManager;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mFlymeThirdAppManager:Lcom/android/server/pm/FlymeThirdAppManager;

    .line 2529
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    const/4 v8, 0x3

    invoke-static {v1, v8}, Lcom/android/server/LockGuard;->installLock(Ljava/lang/Object;I)Ljava/lang/Object;

    .line 2530
    const-wide/32 v5, 0x40000

    const-string v1, "create package manager"

    invoke-static {v5, v6, v1}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 2532
    const-string/jumbo v1, "ro.bootprof.disable"

    const-string v2, "0"

    invoke-static {v1, v2}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    const-string v2, "1"

    invoke-virtual {v2, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    iput-boolean v1, v15, Lcom/android/server/pm/PackageManagerService;->mBootProfDisable:Z

    .line 2533
    const-string v1, "Android:PMS_START"

    invoke-direct {v15, v1}, Lcom/android/server/pm/PackageManagerService;->addBootEvent(Ljava/lang/String;)V

    .line 2535
    nop

    .line 2536
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    .line 2535
    const/16 v3, 0xbf4

    invoke-static {v3, v1, v2}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 2538
    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mSdkVersion:I

    if-gtz v1, :cond_178

    .line 2539
    const-string v1, "PackageManager"

    const-string v2, "**** ro.build.version.sdk not set!"

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 2542
    :cond_178
    iput-object v13, v15, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 2544
    move/from16 v4, p3

    iput-boolean v4, v15, Lcom/android/server/pm/PackageManagerService;->mFactoryTest:Z

    .line 2545
    iput-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mOnlyCore:Z

    .line 2546
    new-instance v1, Landroid/util/DisplayMetrics;

    invoke-direct {v1}, Landroid/util/DisplayMetrics;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mMetrics:Landroid/util/DisplayMetrics;

    .line 2547
    iput-object v14, v15, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    .line 2550
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v1

    .line 2551
    :try_start_18c
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2
    :try_end_18f
    .catchall {:try_start_18c .. :try_end_18f} :catchall_11fc

    .line 2553
    :try_start_18f
    const-class v3, Landroid/content/pm/PackageManagerInternal;

    new-instance v5, Lcom/android/server/pm/PackageManagerService$PackageManagerInternalImpl;

    invoke-direct {v5, v15, v10}, Lcom/android/server/pm/PackageManagerService$PackageManagerInternalImpl;-><init>(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$1;)V

    invoke-static {v3, v5}, Lcom/android/server/LocalServices;->addService(Ljava/lang/Class;Ljava/lang/Object;)V

    .line 2555
    new-instance v3, Lcom/android/server/pm/UserManagerService;

    new-instance v5, Lcom/android/server/pm/UserDataPreparer;

    iget-object v6, v15, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    iget-object v8, v15, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    iget-object v12, v15, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    iget-boolean v10, v15, Lcom/android/server/pm/PackageManagerService;->mOnlyCore:Z

    invoke-direct {v5, v6, v8, v12, v10}, Lcom/android/server/pm/UserDataPreparer;-><init>(Lcom/android/server/pm/Installer;Ljava/lang/Object;Landroid/content/Context;Z)V

    iget-object v6, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-direct {v3, v13, v15, v5, v6}, Lcom/android/server/pm/UserManagerService;-><init>(Landroid/content/Context;Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/UserDataPreparer;Ljava/lang/Object;)V

    sput-object v3, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    .line 2557
    new-instance v3, Lcom/android/server/pm/ComponentResolver;

    sget-object v5, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    const-class v6, Landroid/content/pm/PackageManagerInternal;

    .line 2558
    invoke-static {v6}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/PackageManagerInternal;

    iget-object v8, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-direct {v3, v5, v6, v8}, Lcom/android/server/pm/ComponentResolver;-><init>(Lcom/android/server/pm/UserManagerService;Landroid/content/pm/PackageManagerInternal;Ljava/lang/Object;)V

    iput-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    .line 2560
    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-static {v13, v3}, Lcom/android/server/pm/permission/PermissionManagerService;->create(Landroid/content/Context;Ljava/lang/Object;)Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    move-result-object v3

    iput-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 2562
    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-virtual {v3}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getDefaultPermissionGrantPolicy()Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    move-result-object v3

    iput-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    .line 2563
    new-instance v3, Lcom/android/server/pm/Settings;

    invoke-static {}, Landroid/os/Environment;->getDataDirectory()Ljava/io/File;

    move-result-object v5

    iget-object v6, v15, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 2564
    invoke-virtual {v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getPermissionSettings()Lcom/android/server/pm/permission/PermissionSettings;

    move-result-object v6

    iget-object v8, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-direct {v3, v5, v6, v8}, Lcom/android/server/pm/Settings;-><init>(Ljava/io/File;Lcom/android/server/pm/permission/PermissionSettings;Ljava/lang/Object;)V

    iput-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    .line 2565
    monitor-exit v2
    :try_end_1e6
    .catchall {:try_start_18f .. :try_end_1e6} :catchall_11f1

    .line 2566
    :try_start_1e6
    monitor-exit v1
    :try_end_1e7
    .catchall {:try_start_1e6 .. :try_end_1e7} :catchall_11fc

    .line 2567
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/16 v2, 0x3e8

    const/16 v3, 0x8

    const-string v5, "android.uid.system"

    invoke-virtual {v1, v5, v2, v9, v3}, Lcom/android/server/pm/Settings;->addSharedUserLPw(Ljava/lang/String;III)Lcom/android/server/pm/SharedUserSetting;

    .line 2569
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/16 v2, 0x3e9

    const-string v5, "android.uid.phone"

    invoke-virtual {v1, v5, v2, v9, v3}, Lcom/android/server/pm/Settings;->addSharedUserLPw(Ljava/lang/String;III)Lcom/android/server/pm/SharedUserSetting;

    .line 2571
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/16 v2, 0x3ef

    const-string v5, "android.uid.log"

    invoke-virtual {v1, v5, v2, v9, v3}, Lcom/android/server/pm/Settings;->addSharedUserLPw(Ljava/lang/String;III)Lcom/android/server/pm/SharedUserSetting;

    .line 2573
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/16 v2, 0x403

    const-string v5, "android.uid.nfc"

    invoke-virtual {v1, v5, v2, v9, v3}, Lcom/android/server/pm/Settings;->addSharedUserLPw(Ljava/lang/String;III)Lcom/android/server/pm/SharedUserSetting;

    .line 2575
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/16 v2, 0x3ea

    const-string v5, "android.uid.bluetooth"

    invoke-virtual {v1, v5, v2, v9, v3}, Lcom/android/server/pm/Settings;->addSharedUserLPw(Ljava/lang/String;III)Lcom/android/server/pm/SharedUserSetting;

    .line 2577
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/16 v2, 0x7d0

    const-string v5, "android.uid.shell"

    invoke-virtual {v1, v5, v2, v9, v3}, Lcom/android/server/pm/Settings;->addSharedUserLPw(Ljava/lang/String;III)Lcom/android/server/pm/SharedUserSetting;

    .line 2579
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/16 v2, 0x42c

    const-string v5, "android.uid.se"

    invoke-virtual {v1, v5, v2, v9, v3}, Lcom/android/server/pm/Settings;->addSharedUserLPw(Ljava/lang/String;III)Lcom/android/server/pm/SharedUserSetting;

    .line 2581
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/16 v2, 0x431

    const-string v5, "android.uid.networkstack"

    invoke-virtual {v1, v5, v2, v9, v3}, Lcom/android/server/pm/Settings;->addSharedUserLPw(Ljava/lang/String;III)Lcom/android/server/pm/SharedUserSetting;

    .line 2584
    const-string v1, "debug.separate_processes"

    invoke-static {v1}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v12

    .line 2585
    .local v12, "separateProcesses":Ljava/lang/String;
    if-eqz v12, :cond_279

    invoke-virtual {v12}, Ljava/lang/String;->length()I

    move-result v1

    if-lez v1, :cond_279

    .line 2586
    const-string v1, "*"

    invoke-virtual {v1, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_256

    .line 2587
    const/4 v1, 0x2

    iput v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    .line 2588
    const/4 v1, 0x0

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSeparateProcesses:[Ljava/lang/String;

    .line 2589
    const-string v1, "PackageManager"

    const-string v2, "Running with debug.separate_processes: * (ALL)"

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    const/4 v10, 0x0

    goto :goto_27f

    .line 2591
    :cond_256
    const/4 v1, 0x0

    iput v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    .line 2592
    const-string v1, ","

    invoke-virtual {v12, v1}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v1

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mSeparateProcesses:[Ljava/lang/String;

    .line 2593
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Running with debug.separate_processes: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    const/4 v10, 0x0

    goto :goto_27f

    .line 2597
    :cond_279
    const/4 v1, 0x0

    iput v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    .line 2598
    const/4 v10, 0x0

    iput-object v10, v15, Lcom/android/server/pm/PackageManagerService;->mSeparateProcesses:[Ljava/lang/String;

    .line 2601
    :goto_27f
    new-instance v1, Lcom/android/server/pm/PackageDexOptimizer;

    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    const-string v3, "*dexopt*"

    invoke-direct {v1, v14, v2, v13, v3}, Lcom/android/server/pm/PackageDexOptimizer;-><init>(Lcom/android/server/pm/Installer;Ljava/lang/Object;Landroid/content/Context;Ljava/lang/String;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPackageDexOptimizer:Lcom/android/server/pm/PackageDexOptimizer;

    .line 2603
    new-instance v8, Lcom/android/server/pm/dex/DexManager;

    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    iget-object v5, v15, Lcom/android/server/pm/PackageManagerService;->mPackageDexOptimizer:Lcom/android/server/pm/PackageDexOptimizer;

    iget-object v6, v15, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    move-object v1, v8

    move-object/from16 v3, p0

    move-object v4, v5

    move-object/from16 v20, v12

    const-wide/32 v11, 0x40000

    .end local v12  # "separateProcesses":Ljava/lang/String;
    .local v20, "separateProcesses":Ljava/lang/String;
    move-object/from16 v5, p2

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/dex/DexManager;-><init>(Landroid/content/Context;Landroid/content/pm/IPackageManager;Lcom/android/server/pm/PackageDexOptimizer;Lcom/android/server/pm/Installer;Ljava/lang/Object;)V

    iput-object v8, v15, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    .line 2604
    new-instance v1, Lcom/android/server/pm/dex/ArtManagerService;

    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    invoke-direct {v1, v2, v15, v14, v3}, Lcom/android/server/pm/dex/ArtManagerService;-><init>(Landroid/content/Context;Landroid/content/pm/IPackageManager;Lcom/android/server/pm/Installer;Ljava/lang/Object;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mArtManagerService:Lcom/android/server/pm/dex/ArtManagerService;

    .line 2605
    new-instance v1, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    invoke-static {}, Lcom/android/server/FgThread;->get()Lcom/android/server/FgThread;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/FgThread;->getLooper()Landroid/os/Looper;

    move-result-object v2

    invoke-direct {v1, v2}, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;-><init>(Landroid/os/Looper;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    .line 2607
    new-instance v1, Lcom/android/server/pm/dex/ViewCompiler;

    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-direct {v1, v2, v3}, Lcom/android/server/pm/dex/ViewCompiler;-><init>(Ljava/lang/Object;Lcom/android/server/pm/Installer;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mViewCompiler:Lcom/android/server/pm/dex/ViewCompiler;

    .line 2609
    new-instance v1, Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;

    .line 2610
    invoke-static {}, Lcom/android/server/FgThread;->get()Lcom/android/server/FgThread;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/FgThread;->getLooper()Landroid/os/Looper;

    move-result-object v2

    invoke-direct {v1, v2}, Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;-><init>(Landroid/os/Looper;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mOnPermissionChangeListeners:Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;

    .line 2612
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mMetrics:Landroid/util/DisplayMetrics;

    invoke-static {v13, v1}, Lcom/android/server/pm/PackageManagerService;->getDefaultDisplayMetrics(Landroid/content/Context;Landroid/util/DisplayMetrics;)V

    .line 2614
    const-string v1, "get system config"

    invoke-static {v11, v12, v1}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 2615
    invoke-static {}, Lcom/android/server/SystemConfig;->getInstance()Lcom/android/server/SystemConfig;

    move-result-object v21

    .line 2616
    .local v21, "systemConfig":Lcom/android/server/SystemConfig;
    invoke-virtual/range {v21 .. v21}, Lcom/android/server/SystemConfig;->getAvailableFeatures()Landroid/util/ArrayMap;

    move-result-object v1

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    .line 2617
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V

    .line 2619
    new-instance v1, Lcom/android/server/pm/ProtectedPackages;

    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-direct {v1, v2}, Lcom/android/server/pm/ProtectedPackages;-><init>(Landroid/content/Context;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mProtectedPackages:Lcom/android/server/pm/ProtectedPackages;

    .line 2621
    new-instance v1, Lcom/android/server/pm/ApexManager;

    invoke-direct {v1, v13}, Lcom/android/server/pm/ApexManager;-><init>(Landroid/content/Context;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    .line 2622
    iget-object v5, v15, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v5

    .line 2624
    :try_start_300
    iget-object v6, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6
    :try_end_303
    .catchall {:try_start_300 .. :try_end_303} :catchall_11e2

    .line 2625
    :try_start_303
    new-instance v1, Lcom/android/server/ServiceThread;

    const-string v2, "PackageManager"

    const/16 v3, 0xa

    invoke-direct {v1, v2, v3, v9}, Lcom/android/server/ServiceThread;-><init>(Ljava/lang/String;IZ)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mHandlerThread:Lcom/android/server/ServiceThread;

    .line 2627
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mHandlerThread:Lcom/android/server/ServiceThread;

    invoke-virtual {v1}, Lcom/android/server/ServiceThread;->start()V

    .line 2628
    new-instance v1, Lcom/android/server/pm/PackageManagerService$PackageHandler;

    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService;->mHandlerThread:Lcom/android/server/ServiceThread;

    invoke-virtual {v2}, Lcom/android/server/ServiceThread;->getLooper()Landroid/os/Looper;

    move-result-object v2

    invoke-direct {v1, v15, v2}, Lcom/android/server/pm/PackageManagerService$PackageHandler;-><init>(Lcom/android/server/pm/PackageManagerService;Landroid/os/Looper;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    .line 2629
    new-instance v1, Lcom/android/server/pm/ProcessLoggingHandler;

    invoke-direct {v1}, Lcom/android/server/pm/ProcessLoggingHandler;-><init>()V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mProcessLoggingHandler:Lcom/android/server/pm/ProcessLoggingHandler;

    .line 2630
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v1

    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const-wide/32 v3, 0x927c0

    invoke-virtual {v1, v2, v3, v4}, Lcom/android/server/Watchdog;->addThread(Landroid/os/Handler;J)V

    .line 2631
    new-instance v1, Lcom/android/server/pm/InstantAppRegistry;

    invoke-direct {v1, v15}, Lcom/android/server/pm/InstantAppRegistry;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    .line 2633
    nop

    .line 2634
    invoke-virtual/range {v21 .. v21}, Lcom/android/server/SystemConfig;->getSharedLibraries()Landroid/util/ArrayMap;

    move-result-object v1

    move-object v4, v1

    .line 2635
    .local v4, "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    invoke-virtual {v4}, Landroid/util/ArrayMap;->size()I

    move-result v1
    :try_end_344
    .catchall {:try_start_303 .. :try_end_344} :catchall_11d1

    move v3, v1

    .line 2636
    .local v3, "builtInLibCount":I
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_346
    if-ge v1, v3, :cond_36c

    .line 2637
    :try_start_348
    invoke-virtual {v4, v1}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/String;

    .line 2638
    .local v2, "name":Ljava/lang/String;
    invoke-virtual {v4, v1}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/SystemConfig$SharedLibraryEntry;

    .line 2639
    .local v8, "entry":Lcom/android/server/SystemConfig$SharedLibraryEntry;
    iget-object v9, v8, Lcom/android/server/SystemConfig$SharedLibraryEntry;->filename:Ljava/lang/String;

    invoke-direct {v15, v9, v2}, Lcom/android/server/pm/PackageManagerService;->addBuiltInSharedLibraryLocked(Ljava/lang/String;Ljava/lang/String;)Z

    .line 2636
    nop

    .end local v2  # "name":Ljava/lang/String;
    .end local v8  # "entry":Lcom/android/server/SystemConfig$SharedLibraryEntry;
    add-int/lit8 v1, v1, 0x1

    const/4 v9, 0x1

    goto :goto_346

    .line 3561
    .end local v1  # "i":I
    .end local v3  # "builtInLibCount":I
    .end local v4  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    :catchall_35e
    move-exception v0

    move-object v1, v0

    move-object/from16 v35, v5

    move-object/from16 v39, v6

    move-object/from16 v42, v7

    move-object v3, v13

    move-object v6, v15

    move-object/from16 v18, v20

    goto/16 :goto_11dd

    .line 2644
    .restart local v3  # "builtInLibCount":I
    .restart local v4  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    :cond_36c
    const-wide/16 v1, -0x1

    .line 2645
    .local v1, "undefinedVersion":J
    const/4 v8, 0x0

    .local v8, "i":I
    :goto_36f
    if-ge v8, v3, :cond_3b1

    .line 2646
    invoke-virtual {v4, v8}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/String;

    .line 2647
    .local v9, "name":Ljava/lang/String;
    invoke-virtual {v4, v8}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v17

    check-cast v17, Lcom/android/server/SystemConfig$SharedLibraryEntry;

    move-object/from16 v22, v17

    .line 2648
    .local v22, "entry":Lcom/android/server/SystemConfig$SharedLibraryEntry;
    move-object/from16 v10, v22

    .end local v22  # "entry":Lcom/android/server/SystemConfig$SharedLibraryEntry;
    .local v10, "entry":Lcom/android/server/SystemConfig$SharedLibraryEntry;
    iget-object v11, v10, Lcom/android/server/SystemConfig$SharedLibraryEntry;->dependencies:[Ljava/lang/String;

    array-length v11, v11

    .line 2649
    .local v11, "dependencyCount":I
    const/4 v12, 0x0

    .local v12, "j":I
    :goto_385
    if-ge v12, v11, :cond_3a6

    .line 2650
    move/from16 v24, v3

    .end local v3  # "builtInLibCount":I
    .local v24, "builtInLibCount":I
    iget-object v3, v10, Lcom/android/server/SystemConfig$SharedLibraryEntry;->dependencies:[Ljava/lang/String;

    aget-object v3, v3, v12

    .line 2651
    invoke-direct {v15, v3, v1, v2}, Lcom/android/server/pm/PackageManagerService;->getSharedLibraryInfoLPr(Ljava/lang/String;J)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v3

    .line 2652
    .local v3, "dependency":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v3, :cond_39d

    .line 2653
    move-object/from16 v25, v4

    .end local v4  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .local v25, "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    invoke-direct {v15, v9, v1, v2}, Lcom/android/server/pm/PackageManagerService;->getSharedLibraryInfoLPr(Ljava/lang/String;J)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v4

    invoke-virtual {v4, v3}, Landroid/content/pm/SharedLibraryInfo;->addDependency(Landroid/content/pm/SharedLibraryInfo;)V
    :try_end_39c
    .catchall {:try_start_348 .. :try_end_39c} :catchall_35e

    goto :goto_39f

    .line 2652
    .end local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .restart local v4  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    :cond_39d
    move-object/from16 v25, v4

    .line 2649
    .end local v3  # "dependency":Landroid/content/pm/SharedLibraryInfo;
    .end local v4  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .restart local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    :goto_39f
    add-int/lit8 v12, v12, 0x1

    move/from16 v3, v24

    move-object/from16 v4, v25

    goto :goto_385

    .end local v24  # "builtInLibCount":I
    .end local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .local v3, "builtInLibCount":I
    .restart local v4  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    :cond_3a6
    move/from16 v24, v3

    move-object/from16 v25, v4

    .line 2645
    .end local v3  # "builtInLibCount":I
    .end local v4  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .end local v9  # "name":Ljava/lang/String;
    .end local v10  # "entry":Lcom/android/server/SystemConfig$SharedLibraryEntry;
    .end local v11  # "dependencyCount":I
    .end local v12  # "j":I
    .restart local v24  # "builtInLibCount":I
    .restart local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    add-int/lit8 v8, v8, 0x1

    const/4 v10, 0x0

    const-wide/32 v11, 0x40000

    goto :goto_36f

    .end local v24  # "builtInLibCount":I
    .end local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .restart local v3  # "builtInLibCount":I
    .restart local v4  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    :cond_3b1
    move/from16 v24, v3

    move-object/from16 v25, v4

    .line 2658
    .end local v3  # "builtInLibCount":I
    .end local v4  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .end local v8  # "i":I
    .restart local v24  # "builtInLibCount":I
    .restart local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    :try_start_3b5
    invoke-static {}, Lcom/android/server/pm/SELinuxMMAC;->readInstallPolicy()Z

    .line 2660
    const-string/jumbo v3, "loadFallbacks"

    const-wide/32 v8, 0x40000

    invoke-static {v8, v9, v3}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 2661
    invoke-static {}, Landroid/content/pm/FallbackCategoryProvider;->loadFallbacks()V

    .line 2662
    invoke-static {v8, v9}, Landroid/os/Trace;->traceEnd(J)V

    .line 2664
    const-string/jumbo v3, "read user settings"

    invoke-static {v8, v9, v3}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 2665
    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    sget-object v4, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    const/4 v11, 0x0

    invoke-virtual {v4, v11}, Lcom/android/server/pm/UserManagerService;->getUsers(Z)Ljava/util/List;

    move-result-object v4

    invoke-virtual {v3, v4}, Lcom/android/server/pm/Settings;->readLPw(Ljava/util/List;)Z

    move-result v3

    if-nez v3, :cond_3de

    const/4 v3, 0x1

    goto :goto_3df

    :cond_3de
    move v3, v11

    :goto_3df
    iput-boolean v3, v15, Lcom/android/server/pm/PackageManagerService;->mFirstBoot:Z

    .line 2666
    const-wide/32 v22, 0x40000

    invoke-static/range {v22 .. v23}, Landroid/os/Trace;->traceEnd(J)V

    .line 2670
    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->size()I

    move-result v3
    :try_end_3ef
    .catchall {:try_start_3b5 .. :try_end_3ef} :catchall_11d1

    move/from16 v19, v3

    .line 2671
    .local v19, "packageSettingCount":I
    add-int/lit8 v3, v19, -0x1

    .local v3, "i":I
    :goto_3f3
    if-ltz v3, :cond_42c

    .line 2672
    :try_start_3f5
    iget-object v4, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4, v3}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 2673
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {v4}, Lcom/android/server/pm/PackageManagerService;->isExternal(Lcom/android/server/pm/PackageSetting;)Z

    move-result v8

    if-nez v8, :cond_429

    iget-object v8, v4, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    if-eqz v8, :cond_411

    iget-object v8, v4, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    invoke-virtual {v8}, Ljava/io/File;->exists()Z

    move-result v8

    if-nez v8, :cond_429

    :cond_411
    iget-object v8, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v9, v4, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    .line 2674
    invoke-virtual {v8, v9}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v8

    if-eqz v8, :cond_429

    .line 2675
    iget-object v8, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v8, v8, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v8, v3}, Landroid/util/ArrayMap;->removeAt(I)Ljava/lang/Object;

    .line 2676
    iget-object v8, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v9, v4, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v8, v9}, Lcom/android/server/pm/Settings;->enableSystemPackageLPw(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;
    :try_end_429
    .catchall {:try_start_3f5 .. :try_end_429} :catchall_35e

    .line 2671
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_429
    add-int/lit8 v3, v3, -0x1

    goto :goto_3f3

    .line 2680
    .end local v3  # "i":I
    :cond_42c
    :try_start_42c
    iget-boolean v3, v15, Lcom/android/server/pm/PackageManagerService;->mOnlyCore:Z
    :try_end_42e
    .catchall {:try_start_42c .. :try_end_42e} :catchall_11d1

    if-nez v3, :cond_437

    :try_start_430
    iget-boolean v3, v15, Lcom/android/server/pm/PackageManagerService;->mFirstBoot:Z

    if-eqz v3, :cond_437

    .line 2681
    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->requestCopyPreoptedFiles()V
    :try_end_437
    .catchall {:try_start_430 .. :try_end_437} :catchall_35e

    .line 2684
    :cond_437
    :try_start_437
    invoke-static {}, Landroid/content/res/Resources;->getSystem()Landroid/content/res/Resources;

    move-result-object v3

    const v4, 0x104014b

    invoke-virtual {v3, v4}, Landroid/content/res/Resources;->getString(I)Ljava/lang/String;

    move-result-object v3

    move-object/from16 v26, v3

    .line 2686
    .local v26, "customResolverActivityName":Ljava/lang/String;
    invoke-static/range {v26 .. v26}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v3
    :try_end_448
    .catchall {:try_start_437 .. :try_end_448} :catchall_11d1

    if-nez v3, :cond_450

    .line 2687
    :try_start_44a
    invoke-static/range {v26 .. v26}, Landroid/content/ComponentName;->unflattenFromString(Ljava/lang/String;)Landroid/content/ComponentName;

    move-result-object v3

    iput-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mCustomResolverComponentName:Landroid/content/ComponentName;
    :try_end_450
    .catchall {:try_start_44a .. :try_end_450} :catchall_35e

    .line 2691
    :cond_450
    :try_start_450
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    move-wide v9, v3

    .line 2694
    .local v9, "startTime":J
    const-string v3, "Android:PMS_SYSTEM_SCAN_START"

    invoke-direct {v15, v3}, Lcom/android/server/pm/PackageManagerService;->addBootEvent(Ljava/lang/String;)V

    .line 2697
    const/16 v3, 0xbfe

    invoke-static {v3, v9, v10}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 2700
    const-string v3, "BOOTCLASSPATH"

    invoke-static {v3}, Ljava/lang/System;->getenv(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    move-object/from16 v27, v3

    .line 2701
    .local v27, "bootClassPath":Ljava/lang/String;
    const-string v3, "SYSTEMSERVERCLASSPATH"

    invoke-static {v3}, Ljava/lang/System;->getenv(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3
    :try_end_46d
    .catchall {:try_start_450 .. :try_end_46d} :catchall_11d1

    move-object/from16 v28, v3

    .line 2703
    .local v28, "systemServerClassPath":Ljava/lang/String;
    if-nez v27, :cond_478

    .line 2704
    :try_start_471
    const-string v3, "PackageManager"

    const-string v4, "No BOOTCLASSPATH found!"

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 2707
    :cond_478
    if-nez v28, :cond_481

    .line 2708
    const-string v3, "PackageManager"

    const-string v4, "No SYSTEMSERVERCLASSPATH found!"

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_481
    .catchall {:try_start_471 .. :try_end_481} :catchall_35e

    .line 2711
    :cond_481
    :try_start_481
    new-instance v8, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v3

    const-string v4, "framework"

    invoke-direct {v8, v3, v4}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    const/4 v12, 0x3

    .line 2713
    .local v8, "frameworkDir":Ljava/io/File;
    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3}, Lcom/android/server/pm/Settings;->getInternalVersion()Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v3

    move-object v4, v3

    .line 2716
    .local v4, "ver":Lcom/android/server/pm/Settings$VersionInfo;
    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3}, Lcom/android/server/pm/Settings;->getMeizuFingerprint()Ljava/lang/String;

    move-result-object v3

    .line 2717
    .local v3, "meizuFingerprint":Ljava/lang/String;
    sget-object v11, Landroid/os/Build;->FINGERPRINT:Ljava/lang/String;

    iget-object v12, v4, Lcom/android/server/pm/Settings$VersionInfo;->fingerprint:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11
    :try_end_4a2
    .catchall {:try_start_481 .. :try_end_4a2} :catchall_11d1

    if-eqz v11, :cond_4af

    :try_start_4a4
    sget-object v11, Landroid/os/Build;->MEIZU_FINGERPRINT:Ljava/lang/String;

    .line 2718
    invoke-virtual {v11, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11
    :try_end_4aa
    .catchall {:try_start_4a4 .. :try_end_4aa} :catchall_35e

    if-nez v11, :cond_4ad

    goto :goto_4af

    :cond_4ad
    const/4 v11, 0x0

    goto :goto_4b0

    :cond_4af
    :goto_4af
    const/4 v11, 0x1

    :goto_4b0
    :try_start_4b0
    iput-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z

    .line 2720
    iget-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z
    :try_end_4b4
    .catchall {:try_start_4b0 .. :try_end_4b4} :catchall_11d1

    if-eqz v11, :cond_4d7

    .line 2721
    :try_start_4b6
    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Upgrading from "

    invoke-virtual {v12, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v11, v4, Lcom/android/server/pm/Settings$VersionInfo;->fingerprint:Ljava/lang/String;

    invoke-virtual {v12, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, " to "

    invoke-virtual {v12, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    sget-object v11, Landroid/os/Build;->FINGERPRINT:Ljava/lang/String;

    invoke-virtual {v12, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    const/4 v12, 0x4

    invoke-static {v12, v11}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V
    :try_end_4d7
    .catchall {:try_start_4b6 .. :try_end_4d7} :catchall_35e

    .line 2726
    :cond_4d7
    :try_start_4d7
    iget-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z
    :try_end_4d9
    .catchall {:try_start_4d7 .. :try_end_4d9} :catchall_11d1

    if-eqz v11, :cond_4e3

    :try_start_4db
    iget v11, v4, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I
    :try_end_4dd
    .catchall {:try_start_4db .. :try_end_4dd} :catchall_35e

    const/16 v12, 0x16

    if-gt v11, v12, :cond_4e3

    const/4 v11, 0x1

    goto :goto_4e4

    :cond_4e3
    const/4 v11, 0x0

    :goto_4e4
    :try_start_4e4
    iput-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mPromoteSystemApps:Z

    .line 2731
    iget-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z
    :try_end_4e8
    .catchall {:try_start_4e4 .. :try_end_4e8} :catchall_11d1

    if-eqz v11, :cond_4f2

    :try_start_4ea
    iget v11, v4, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I
    :try_end_4ec
    .catchall {:try_start_4ea .. :try_end_4ec} :catchall_35e

    const/16 v12, 0x18

    if-ge v11, v12, :cond_4f2

    const/4 v11, 0x1

    goto :goto_4f3

    :cond_4f2
    const/4 v11, 0x0

    :goto_4f3
    :try_start_4f3
    iput-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mIsPreNUpgrade:Z

    .line 2733
    iget-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z
    :try_end_4f7
    .catchall {:try_start_4f3 .. :try_end_4f7} :catchall_11d1

    if-eqz v11, :cond_501

    :try_start_4f9
    iget v11, v4, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I
    :try_end_4fb
    .catchall {:try_start_4f9 .. :try_end_4fb} :catchall_35e

    const/16 v12, 0x19

    if-ge v11, v12, :cond_501

    const/4 v11, 0x1

    goto :goto_502

    :cond_501
    const/4 v11, 0x0

    :goto_502
    :try_start_502
    iput-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mIsPreNMR1Upgrade:Z

    .line 2734
    iget-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z
    :try_end_506
    .catchall {:try_start_502 .. :try_end_506} :catchall_11d1

    if-eqz v11, :cond_510

    :try_start_508
    iget v11, v4, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I
    :try_end_50a
    .catchall {:try_start_508 .. :try_end_50a} :catchall_35e

    const/16 v12, 0x1d

    if-ge v11, v12, :cond_510

    const/4 v11, 0x1

    goto :goto_511

    :cond_510
    const/4 v11, 0x0

    :goto_511
    :try_start_511
    iput-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mIsPreQUpgrade:Z

    .line 2736
    iget v11, v4, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I

    move/from16 v30, v11

    .line 2740
    .local v30, "preUpgradeSdkVersion":I
    iget-boolean v11, v15, Lcom/android/server/pm/PackageManagerService;->mPromoteSystemApps:Z
    :try_end_519
    .catchall {:try_start_511 .. :try_end_519} :catchall_11d1

    if-eqz v11, :cond_54b

    .line 2741
    :try_start_51b
    iget-object v11, v15, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v11, v11, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v11}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v11

    invoke-interface {v11}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v11

    .line 2742
    .local v11, "pkgSettingIter":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    :goto_527
    invoke-interface {v11}, Ljava/util/Iterator;->hasNext()Z

    move-result v12

    if-eqz v12, :cond_548

    .line 2743
    invoke-interface {v11}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Lcom/android/server/pm/PackageSetting;

    .line 2744
    .local v12, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {v12}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Lcom/android/server/pm/PackageSetting;)Z

    move-result v31

    if-eqz v31, :cond_543

    .line 2745
    move-wide/from16 v31, v1

    .end local v1  # "undefinedVersion":J
    .local v31, "undefinedVersion":J
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mExistingSystemPackages:Landroid/util/ArraySet;

    iget-object v2, v12, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z
    :try_end_542
    .catchall {:try_start_51b .. :try_end_542} :catchall_35e

    goto :goto_545

    .line 2744
    .end local v31  # "undefinedVersion":J
    .restart local v1  # "undefinedVersion":J
    :cond_543
    move-wide/from16 v31, v1

    .line 2747
    .end local v1  # "undefinedVersion":J
    .end local v12  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v31  # "undefinedVersion":J
    :goto_545
    move-wide/from16 v1, v31

    goto :goto_527

    .line 2742
    .end local v31  # "undefinedVersion":J
    .restart local v1  # "undefinedVersion":J
    :cond_548
    move-wide/from16 v31, v1

    .end local v1  # "undefinedVersion":J
    .restart local v31  # "undefinedVersion":J
    goto :goto_54d

    .line 2740
    .end local v11  # "pkgSettingIter":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    .end local v31  # "undefinedVersion":J
    .restart local v1  # "undefinedVersion":J
    :cond_54b
    move-wide/from16 v31, v1

    .line 2750
    .end local v1  # "undefinedVersion":J
    .restart local v31  # "undefinedVersion":J
    :goto_54d
    :try_start_54d
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->preparePackageParserCache()Ljava/io/File;

    move-result-object v1

    iput-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mCacheDir:Ljava/io/File;

    .line 2754
    const/16 v1, 0x210

    .line 2756
    .local v1, "scanFlags":I
    iget-boolean v2, v15, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z
    :try_end_557
    .catchall {:try_start_54d .. :try_end_557} :catchall_11d1

    if-nez v2, :cond_560

    :try_start_559
    iget-boolean v2, v15, Lcom/android/server/pm/PackageManagerService;->mFirstBoot:Z
    :try_end_55b
    .catchall {:try_start_559 .. :try_end_55b} :catchall_35e

    if-eqz v2, :cond_55e

    goto :goto_560

    :cond_55e
    move v11, v1

    goto :goto_563

    .line 2757
    :cond_560
    :goto_560
    or-int/lit16 v1, v1, 0x2000

    move v11, v1

    .line 2764
    .end local v1  # "scanFlags":I
    .local v11, "scanFlags":I
    :goto_563
    :try_start_563
    new-instance v2, Ljava/io/File;

    const-string v1, "/vendor/overlay"

    invoke-direct {v2, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I
    :try_end_56c
    .catchall {:try_start_563 .. :try_end_56c} :catchall_11d1

    or-int/lit8 v12, v1, 0x10

    const/high16 v33, 0x20000

    or-int v1, v11, v33

    const/high16 v34, 0x100000

    or-int v35, v1, v34

    const-wide/16 v36, 0x0

    move-object/from16 v1, p0

    move-object/from16 v38, v3

    .end local v3  # "meizuFingerprint":Ljava/lang/String;
    .local v38, "meizuFingerprint":Ljava/lang/String;
    move v3, v12

    move-object v12, v4

    .end local v4  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .local v12, "ver":Lcom/android/server/pm/Settings$VersionInfo;
    move/from16 v4, v35

    move-object/from16 v35, v5

    move-object/from16 v39, v6

    move-wide/from16 v5, v36

    :try_start_586
    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2771
    new-instance v2, Ljava/io/File;

    const-string v1, "/product/overlay"

    invoke-direct {v2, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v1, v11, v33

    const/high16 v36, 0x200000

    or-int v4, v1, v36

    const-wide/16 v5, 0x0

    move-object/from16 v1, p0

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2778
    new-instance v2, Ljava/io/File;

    const-string v1, "/product_services/overlay"

    invoke-direct {v2, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v1, v11, v33

    const/high16 v37, 0x400000

    or-int v4, v1, v37

    const-wide/16 v5, 0x0

    move-object/from16 v1, p0

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2785
    new-instance v2, Ljava/io/File;

    const-string v1, "/odm/overlay"

    invoke-direct {v2, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v1, v11, v33

    const/high16 v4, 0x800000

    or-int/2addr v4, v1

    const-wide/16 v5, 0x0

    move-object/from16 v1, p0

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2792
    new-instance v2, Ljava/io/File;

    const-string v1, "/oem/overlay"

    invoke-direct {v2, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v1, v11, v33

    const/high16 v40, 0x80000

    or-int v4, v1, v40

    const-wide/16 v5, 0x0

    move-object/from16 v1, p0

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2800
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mParallelPackageParserCallback:Lcom/android/server/pm/PackageManagerService$ParallelPackageParserCallback;

    invoke-virtual {v1}, Lcom/android/server/pm/PackageManagerService$ParallelPackageParserCallback;->findStaticOverlayPackages()V

    .line 2803
    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I
    :try_end_5ef
    .catchall {:try_start_586 .. :try_end_5ef} :catchall_11cf

    or-int/lit8 v1, v1, 0x10

    or-int/lit8 v2, v11, 0x1

    or-int v2, v2, v33

    const/high16 v41, 0x40000

    or-int v2, v2, v41

    const-wide/16 v3, 0x0

    move-object/from16 v42, v7

    .end local v7  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .local v42, "debugOptions":Lcom/android/server/utils/DebugOptions;
    move-object/from16 v7, p0

    move-wide/from16 v43, v9

    const/4 v5, 0x1

    .end local v9  # "startTime":J
    .local v43, "startTime":J
    move v9, v1

    const/4 v6, 0x0

    move v10, v2

    move v1, v11

    move-object v2, v12

    move-object/from16 v18, v20

    const/16 v20, 0x0

    const/16 v29, 0x3

    .end local v11  # "scanFlags":I
    .end local v12  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v20  # "separateProcesses":Ljava/lang/String;
    .restart local v1  # "scanFlags":I
    .local v2, "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .local v18, "separateProcesses":Ljava/lang/String;
    move-wide v11, v3

    :try_start_60e
    invoke-direct/range {v7 .. v12}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2811
    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    const-string v4, "android"

    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_11bb

    .line 2817
    new-instance v3, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v4

    const-string/jumbo v7, "priv-app"

    invoke-direct {v3, v4, v7}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    move-object v7, v3

    .line 2818
    .local v7, "privilegedAppDir":Ljava/io/File;
    iget v3, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v3, 0x10

    or-int v4, v1, v33

    or-int v4, v4, v41

    const-wide/16 v9, 0x0

    move v12, v1

    .end local v1  # "scanFlags":I
    .local v12, "scanFlags":I
    move-object/from16 v1, p0

    move-object v11, v2

    .end local v2  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .local v11, "ver":Lcom/android/server/pm/Settings$VersionInfo;
    move-object v2, v7

    move-wide v5, v9

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2827
    new-instance v1, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v2

    const-string v3, "app"

    invoke-direct {v1, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    move-object v9, v1

    .line 2828
    .local v9, "systemAppDir":Ljava/io/File;
    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v4, v12, v33

    const-wide/16 v5, 0x0

    move-object/from16 v1, p0

    move-object v2, v9

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2836
    new-instance v1, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getVendorDirectory()Ljava/io/File;

    move-result-object v2

    const-string/jumbo v3, "priv-app"

    invoke-direct {v1, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
    :try_end_661
    .catchall {:try_start_60e .. :try_end_661} :catchall_11cb

    .line 2838
    .local v1, "privilegedVendorAppDir":Ljava/io/File;
    :try_start_661
    invoke-virtual {v1}, Ljava/io/File;->getCanonicalFile()Ljava/io/File;

    move-result-object v2
    :try_end_665
    .catch Ljava/io/IOException; {:try_start_661 .. :try_end_665} :catch_66e
    .catchall {:try_start_661 .. :try_end_665} :catchall_668

    move-object v1, v2

    .line 2841
    move-object v10, v1

    goto :goto_670

    .line 3561
    .end local v1  # "privilegedVendorAppDir":Ljava/io/File;
    .end local v7  # "privilegedAppDir":Ljava/io/File;
    .end local v8  # "frameworkDir":Ljava/io/File;
    .end local v9  # "systemAppDir":Ljava/io/File;
    .end local v11  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v12  # "scanFlags":I
    .end local v19  # "packageSettingCount":I
    .end local v24  # "builtInLibCount":I
    .end local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .end local v26  # "customResolverActivityName":Ljava/lang/String;
    .end local v27  # "bootClassPath":Ljava/lang/String;
    .end local v28  # "systemServerClassPath":Ljava/lang/String;
    .end local v30  # "preUpgradeSdkVersion":I
    .end local v31  # "undefinedVersion":J
    .end local v38  # "meizuFingerprint":Ljava/lang/String;
    .end local v43  # "startTime":J
    :catchall_668
    move-exception v0

    move-object v1, v0

    move-object v3, v13

    move-object v6, v15

    goto/16 :goto_11dd

    .line 2839
    .restart local v1  # "privilegedVendorAppDir":Ljava/io/File;
    .restart local v7  # "privilegedAppDir":Ljava/io/File;
    .restart local v8  # "frameworkDir":Ljava/io/File;
    .restart local v9  # "systemAppDir":Ljava/io/File;
    .restart local v11  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .restart local v12  # "scanFlags":I
    .restart local v19  # "packageSettingCount":I
    .restart local v24  # "builtInLibCount":I
    .restart local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .restart local v26  # "customResolverActivityName":Ljava/lang/String;
    .restart local v27  # "bootClassPath":Ljava/lang/String;
    .restart local v28  # "systemServerClassPath":Ljava/lang/String;
    .restart local v30  # "preUpgradeSdkVersion":I
    .restart local v31  # "undefinedVersion":J
    .restart local v38  # "meizuFingerprint":Ljava/lang/String;
    .restart local v43  # "startTime":J
    :catch_66e
    move-exception v0

    move-object v10, v1

    .line 2842
    .end local v1  # "privilegedVendorAppDir":Ljava/io/File;
    .local v10, "privilegedVendorAppDir":Ljava/io/File;
    :goto_670
    :try_start_670
    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v1, v12, v33

    or-int v1, v1, v34

    or-int v4, v1, v41

    const-wide/16 v5, 0x0

    move-object/from16 v1, p0

    move-object v2, v10

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2852
    new-instance v1, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getVendorDirectory()Ljava/io/File;

    move-result-object v2

    const-string v3, "app"

    invoke-direct {v1, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
    :try_end_68d
    .catchall {:try_start_670 .. :try_end_68d} :catchall_11cb

    .line 2854
    .local v1, "vendorAppDir":Ljava/io/File;
    :try_start_68d
    invoke-virtual {v1}, Ljava/io/File;->getCanonicalFile()Ljava/io/File;

    move-result-object v2
    :try_end_691
    .catch Ljava/io/IOException; {:try_start_68d .. :try_end_691} :catch_694
    .catchall {:try_start_68d .. :try_end_691} :catchall_668

    move-object v1, v2

    .line 2857
    move-object v5, v1

    goto :goto_696

    .line 2855
    :catch_694
    move-exception v0

    move-object v5, v1

    .line 2858
    .end local v1  # "vendorAppDir":Ljava/io/File;
    .local v5, "vendorAppDir":Ljava/io/File;
    :goto_696
    :try_start_696
    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v1, v12, v33

    or-int v4, v1, v34

    const-wide/16 v16, 0x0

    move-object/from16 v1, p0

    move-object v2, v5

    move-object/from16 v46, v5

    .end local v5  # "vendorAppDir":Ljava/io/File;
    .local v46, "vendorAppDir":Ljava/io/File;
    move-wide/from16 v5, v16

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2868
    new-instance v1, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getOdmDirectory()Ljava/io/File;

    move-result-object v2

    const-string/jumbo v3, "priv-app"

    invoke-direct {v1, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
    :try_end_6b6
    .catchall {:try_start_696 .. :try_end_6b6} :catchall_11cb

    .line 2871
    .local v1, "privilegedOdmAppDir":Ljava/io/File;
    :try_start_6b6
    invoke-virtual {v1}, Ljava/io/File;->getCanonicalFile()Ljava/io/File;

    move-result-object v2
    :try_end_6ba
    .catch Ljava/io/IOException; {:try_start_6b6 .. :try_end_6ba} :catch_6bd
    .catchall {:try_start_6b6 .. :try_end_6ba} :catchall_668

    move-object v1, v2

    .line 2874
    move-object v5, v1

    goto :goto_6bf

    .line 2872
    :catch_6bd
    move-exception v0

    move-object v5, v1

    .line 2875
    .end local v1  # "privilegedOdmAppDir":Ljava/io/File;
    .local v5, "privilegedOdmAppDir":Ljava/io/File;
    :goto_6bf
    :try_start_6bf
    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v1, v12, v33

    or-int v1, v1, v34

    or-int v4, v1, v41

    const-wide/16 v16, 0x0

    move-object/from16 v1, p0

    move-object v2, v5

    move-object/from16 v47, v5

    .end local v5  # "privilegedOdmAppDir":Ljava/io/File;
    .local v47, "privilegedOdmAppDir":Ljava/io/File;
    move-wide/from16 v5, v16

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2886
    new-instance v1, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getOdmDirectory()Ljava/io/File;

    move-result-object v2

    const-string v3, "app"

    invoke-direct {v1, v2, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
    :try_end_6e0
    .catchall {:try_start_6bf .. :try_end_6e0} :catchall_11cb

    .line 2888
    .local v1, "odmAppDir":Ljava/io/File;
    :try_start_6e0
    invoke-virtual {v1}, Ljava/io/File;->getCanonicalFile()Ljava/io/File;

    move-result-object v2
    :try_end_6e4
    .catch Ljava/io/IOException; {:try_start_6e0 .. :try_end_6e4} :catch_6e7
    .catchall {:try_start_6e0 .. :try_end_6e4} :catchall_668

    move-object v1, v2

    .line 2891
    move-object v5, v1

    goto :goto_6e9

    .line 2889
    :catch_6e7
    move-exception v0

    move-object v5, v1

    .line 2892
    .end local v1  # "odmAppDir":Ljava/io/File;
    .local v5, "odmAppDir":Ljava/io/File;
    :goto_6e9
    :try_start_6e9
    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v1, v12, v33

    or-int v4, v1, v34

    const-wide/16 v16, 0x0

    move-object/from16 v1, p0

    move-object v2, v5

    move-object/from16 v48, v5

    .end local v5  # "odmAppDir":Ljava/io/File;
    .local v48, "odmAppDir":Ljava/io/File;
    move-wide/from16 v5, v16

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2901
    new-instance v2, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v1

    const-string v3, "MzApp"

    invoke-direct {v2, v1, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 2902
    .local v2, "mzAppDir":Ljava/io/File;
    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v3, v1, 0x10

    or-int v1, v12, v33

    const/high16 v4, 0x1000000

    or-int/2addr v4, v1

    const-wide/16 v5, 0x0

    move-object/from16 v1, p0

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2906
    new-instance v1, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getVendorDirectory()Ljava/io/File;

    move-result-object v3

    const-string v4, "MzApp"

    invoke-direct {v1, v3, v4}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    move-object v3, v10

    .end local v10  # "privilegedVendorAppDir":Ljava/io/File;
    .local v3, "privilegedVendorAppDir":Ljava/io/File;
    move-object v10, v1

    .line 2907
    .local v10, "vendorMzAppDir":Ljava/io/File;
    iget v1, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I
    :try_end_727
    .catchall {:try_start_6e9 .. :try_end_727} :catchall_11cb

    or-int/lit8 v1, v1, 0x10

    or-int v4, v12, v33

    const/high16 v5, 0x1000000

    or-int/2addr v4, v5

    const-wide/16 v5, 0x0

    move-object/from16 v49, v9

    .end local v9  # "systemAppDir":Ljava/io/File;
    .local v49, "systemAppDir":Ljava/io/File;
    move-object/from16 v9, p0

    move-object/from16 v50, v11

    .end local v11  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .local v50, "ver":Lcom/android/server/pm/Settings$VersionInfo;
    move v11, v1

    move v1, v12

    .end local v12  # "scanFlags":I
    .local v1, "scanFlags":I
    move v12, v4

    move-object v4, v13

    move-wide v13, v5

    :try_start_73b
    invoke-direct/range {v9 .. v14}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2914
    new-instance v5, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getOemDirectory()Ljava/io/File;

    move-result-object v6

    const-string v9, "app"

    invoke-direct {v5, v6, v9}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 2915
    .local v5, "oemAppDir":Ljava/io/File;
    iget v6, v15, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I
    :try_end_74b
    .catchall {:try_start_73b .. :try_end_74b} :catchall_11b8

    or-int/lit8 v13, v6, 0x10

    or-int v6, v1, v33

    or-int v14, v6, v40

    const-wide/16 v16, 0x0

    move-object/from16 v11, p0

    move-object v12, v5

    move-object v6, v15

    move-wide/from16 v15, v16

    :try_start_759
    invoke-direct/range {v11 .. v16}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2924
    new-instance v9, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getProductDirectory()Ljava/io/File;

    move-result-object v11

    const-string/jumbo v12, "priv-app"

    invoke-direct {v9, v11, v12}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
    :try_end_768
    .catchall {:try_start_759 .. :try_end_768} :catchall_11b5

    .line 2926
    .local v9, "privilegedProductAppDir":Ljava/io/File;
    :try_start_768
    invoke-virtual {v9}, Ljava/io/File;->getCanonicalFile()Ljava/io/File;

    move-result-object v11
    :try_end_76c
    .catch Ljava/io/IOException; {:try_start_768 .. :try_end_76c} :catch_773
    .catchall {:try_start_768 .. :try_end_76c} :catchall_76e

    move-object v9, v11

    .line 2929
    goto :goto_774

    .line 3561
    .end local v1  # "scanFlags":I
    .end local v2  # "mzAppDir":Ljava/io/File;
    .end local v3  # "privilegedVendorAppDir":Ljava/io/File;
    .end local v5  # "oemAppDir":Ljava/io/File;
    .end local v7  # "privilegedAppDir":Ljava/io/File;
    .end local v8  # "frameworkDir":Ljava/io/File;
    .end local v9  # "privilegedProductAppDir":Ljava/io/File;
    .end local v10  # "vendorMzAppDir":Ljava/io/File;
    .end local v19  # "packageSettingCount":I
    .end local v24  # "builtInLibCount":I
    .end local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .end local v26  # "customResolverActivityName":Ljava/lang/String;
    .end local v27  # "bootClassPath":Ljava/lang/String;
    .end local v28  # "systemServerClassPath":Ljava/lang/String;
    .end local v30  # "preUpgradeSdkVersion":I
    .end local v31  # "undefinedVersion":J
    .end local v38  # "meizuFingerprint":Ljava/lang/String;
    .end local v43  # "startTime":J
    .end local v46  # "vendorAppDir":Ljava/io/File;
    .end local v47  # "privilegedOdmAppDir":Ljava/io/File;
    .end local v48  # "odmAppDir":Ljava/io/File;
    .end local v49  # "systemAppDir":Ljava/io/File;
    .end local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    :catchall_76e
    move-exception v0

    move-object v1, v0

    move-object v3, v4

    goto/16 :goto_11dd

    .line 2927
    .restart local v1  # "scanFlags":I
    .restart local v2  # "mzAppDir":Ljava/io/File;
    .restart local v3  # "privilegedVendorAppDir":Ljava/io/File;
    .restart local v5  # "oemAppDir":Ljava/io/File;
    .restart local v7  # "privilegedAppDir":Ljava/io/File;
    .restart local v8  # "frameworkDir":Ljava/io/File;
    .restart local v9  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v10  # "vendorMzAppDir":Ljava/io/File;
    .restart local v19  # "packageSettingCount":I
    .restart local v24  # "builtInLibCount":I
    .restart local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .restart local v26  # "customResolverActivityName":Ljava/lang/String;
    .restart local v27  # "bootClassPath":Ljava/lang/String;
    .restart local v28  # "systemServerClassPath":Ljava/lang/String;
    .restart local v30  # "preUpgradeSdkVersion":I
    .restart local v31  # "undefinedVersion":J
    .restart local v38  # "meizuFingerprint":Ljava/lang/String;
    .restart local v43  # "startTime":J
    .restart local v46  # "vendorAppDir":Ljava/io/File;
    .restart local v47  # "privilegedOdmAppDir":Ljava/io/File;
    .restart local v48  # "odmAppDir":Ljava/io/File;
    .restart local v49  # "systemAppDir":Ljava/io/File;
    .restart local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    :catch_773
    move-exception v0

    .line 2930
    :goto_774
    :try_start_774
    iget v11, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v13, v11, 0x10

    or-int v11, v1, v33

    or-int v11, v11, v36

    or-int v14, v11, v41

    const-wide/16 v15, 0x0

    move-object/from16 v11, p0

    move-object v12, v9

    invoke-direct/range {v11 .. v16}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2940
    new-instance v11, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getProductDirectory()Ljava/io/File;

    move-result-object v12

    const-string v13, "app"

    invoke-direct {v11, v12, v13}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
    :try_end_791
    .catchall {:try_start_774 .. :try_end_791} :catchall_11b5

    .line 2942
    .local v11, "productAppDir":Ljava/io/File;
    :try_start_791
    invoke-virtual {v11}, Ljava/io/File;->getCanonicalFile()Ljava/io/File;

    move-result-object v12
    :try_end_795
    .catch Ljava/io/IOException; {:try_start_791 .. :try_end_795} :catch_798
    .catchall {:try_start_791 .. :try_end_795} :catchall_76e

    move-object v11, v12

    .line 2945
    move-object v15, v11

    goto :goto_79a

    .line 2943
    :catch_798
    move-exception v0

    move-object v15, v11

    .line 2946
    .end local v11  # "productAppDir":Ljava/io/File;
    .local v15, "productAppDir":Ljava/io/File;
    :goto_79a
    :try_start_79a
    iget v11, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v13, v11, 0x10

    or-int v11, v1, v33

    or-int v14, v11, v36

    const-wide/16 v16, 0x0

    move-object/from16 v11, p0

    move-object v12, v15

    move-object/from16 v22, v2

    move-object v2, v15

    .end local v15  # "productAppDir":Ljava/io/File;
    .local v2, "productAppDir":Ljava/io/File;
    .local v22, "mzAppDir":Ljava/io/File;
    move-wide/from16 v15, v16

    invoke-direct/range {v11 .. v16}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2955
    new-instance v11, Ljava/io/File;

    .line 2956
    invoke-static {}, Landroid/os/Environment;->getProductServicesDirectory()Ljava/io/File;

    move-result-object v12

    const-string/jumbo v13, "priv-app"

    invoke-direct {v11, v12, v13}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
    :try_end_7bb
    .catchall {:try_start_79a .. :try_end_7bb} :catchall_11b5

    .line 2958
    .local v11, "privilegedProductServicesAppDir":Ljava/io/File;
    nop

    .line 2959
    :try_start_7bc
    invoke-virtual {v11}, Ljava/io/File;->getCanonicalFile()Ljava/io/File;

    move-result-object v12
    :try_end_7c0
    .catch Ljava/io/IOException; {:try_start_7bc .. :try_end_7c0} :catch_7c3
    .catchall {:try_start_7bc .. :try_end_7c0} :catchall_76e

    move-object v11, v12

    .line 2962
    move-object v15, v11

    goto :goto_7c5

    .line 2960
    :catch_7c3
    move-exception v0

    move-object v15, v11

    .line 2963
    .end local v11  # "privilegedProductServicesAppDir":Ljava/io/File;
    .local v15, "privilegedProductServicesAppDir":Ljava/io/File;
    :goto_7c5
    :try_start_7c5
    iget v11, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v13, v11, 0x10

    or-int v11, v1, v33

    or-int v11, v11, v37

    or-int v14, v11, v41

    const-wide/16 v16, 0x0

    move-object/from16 v11, p0

    move-object v12, v15

    move-object/from16 v23, v8

    move-object v8, v15

    .end local v15  # "privilegedProductServicesAppDir":Ljava/io/File;
    .local v8, "privilegedProductServicesAppDir":Ljava/io/File;
    .local v23, "frameworkDir":Ljava/io/File;
    move-wide/from16 v15, v16

    invoke-direct/range {v11 .. v16}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2973
    new-instance v11, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getProductServicesDirectory()Ljava/io/File;

    move-result-object v12

    const-string v13, "app"

    invoke-direct {v11, v12, v13}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V
    :try_end_7e7
    .catchall {:try_start_7c5 .. :try_end_7e7} :catchall_11b5

    .line 2975
    .local v11, "productServicesAppDir":Ljava/io/File;
    :try_start_7e7
    invoke-virtual {v11}, Ljava/io/File;->getCanonicalFile()Ljava/io/File;

    move-result-object v12
    :try_end_7eb
    .catch Ljava/io/IOException; {:try_start_7e7 .. :try_end_7eb} :catch_7ee
    .catchall {:try_start_7e7 .. :try_end_7eb} :catchall_76e

    move-object v11, v12

    .line 2978
    move-object v15, v11

    goto :goto_7f0

    .line 2976
    :catch_7ee
    move-exception v0

    move-object v15, v11

    .line 2979
    .end local v11  # "productServicesAppDir":Ljava/io/File;
    .local v15, "productServicesAppDir":Ljava/io/File;
    :goto_7f0
    :try_start_7f0
    iget v11, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v13, v11, 0x10

    or-int v11, v1, v33

    or-int v14, v11, v37

    const-wide/16 v16, 0x0

    move-object/from16 v11, p0

    move-object v12, v15

    move-object/from16 v51, v10

    move-object v10, v15

    .end local v15  # "productServicesAppDir":Ljava/io/File;
    .local v10, "productServicesAppDir":Ljava/io/File;
    .local v51, "vendorMzAppDir":Ljava/io/File;
    move-wide/from16 v15, v16

    invoke-direct/range {v11 .. v16}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 2988
    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    move-object v15, v11

    .line 2991
    .local v15, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    move-object v14, v11

    .line 2992
    .local v14, "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    iget-boolean v11, v6, Lcom/android/server/pm/PackageManagerService;->mOnlyCore:Z
    :try_end_813
    .catchall {:try_start_7f0 .. :try_end_813} :catchall_11b5

    if-nez v11, :cond_940

    .line 2994
    :try_start_815
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v11}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v11

    invoke-interface {v11}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v11

    .line 2995
    .local v11, "pkgIterator":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    :goto_81f
    invoke-interface {v11}, Ljava/util/Iterator;->hasNext()Z

    move-result v12
    :try_end_823
    .catchall {:try_start_815 .. :try_end_823} :catchall_11b1

    if-eqz v12, :cond_835

    .line 2996
    :try_start_825
    invoke-interface {v11}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Landroid/content/pm/PackageParser$Package;

    .line 2997
    .local v12, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-boolean v13, v12, Landroid/content/pm/PackageParser$Package;->isStub:Z

    if-eqz v13, :cond_834

    .line 2998
    iget-object v13, v12, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-interface {v14, v13}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_834
    .catchall {:try_start_825 .. :try_end_834} :catchall_76e

    .line 3000
    .end local v12  # "pkg":Landroid/content/pm/PackageParser$Package;
    :cond_834
    goto :goto_81f

    .line 3002
    :cond_835
    :try_start_835
    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v12, v12, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v12}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v12

    invoke-interface {v12}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v12

    .line 3003
    .local v12, "psit":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    :goto_841
    invoke-interface {v12}, Ljava/util/Iterator;->hasNext()Z

    move-result v13

    if-eqz v13, :cond_937

    .line 3004
    invoke-interface {v12}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/pm/PackageSetting;

    .line 3010
    .local v13, "ps":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v17, v11

    .end local v11  # "pkgIterator":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    .local v17, "pkgIterator":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    iget v11, v13, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    const/4 v4, 0x1

    and-int/2addr v11, v4

    if-nez v11, :cond_85a

    .line 3011
    move-object/from16 v4, p1

    move-object/from16 v11, v17

    goto :goto_841

    .line 3017
    :cond_85a
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v4, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v11, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/PackageParser$Package;

    .line 3018
    .local v4, "scannedPkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v4, :cond_8d2

    .line 3026
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    move-object/from16 v52, v14

    .end local v14  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v52, "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    iget-object v14, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v11, v14}, Lcom/android/server/pm/Settings;->isDisabledSystemPackageLPr(Ljava/lang/String;)Z

    move-result v11

    if-eqz v11, :cond_8c6

    .line 3027
    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Expecting better updated system app for "

    invoke-virtual {v11, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v14, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v11, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v14, "; removing system app.  Last known codePath="

    invoke-virtual {v11, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v14, v13, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    invoke-virtual {v11, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v14, ", versionCode="

    invoke-virtual {v11, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v54, v8

    move-object/from16 v53, v9

    .end local v8  # "privilegedProductServicesAppDir":Ljava/io/File;
    .end local v9  # "privilegedProductAppDir":Ljava/io/File;
    .local v53, "privilegedProductAppDir":Ljava/io/File;
    .local v54, "privilegedProductServicesAppDir":Ljava/io/File;
    iget-wide v8, v13, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-virtual {v11, v8, v9}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v8, "; scanned versionCode="

    invoke-virtual {v11, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 3032
    invoke-virtual {v4}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v8

    invoke-virtual {v11, v8, v9}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    .line 3027
    const/4 v9, 0x5

    invoke-static {v9, v8}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 3033
    const/4 v8, 0x1

    invoke-direct {v6, v4, v8}, Lcom/android/server/pm/PackageManagerService;->removePackageLI(Landroid/content/pm/PackageParser$Package;Z)V

    .line 3034
    iget-object v8, v6, Lcom/android/server/pm/PackageManagerService;->mExpectingBetter:Landroid/util/ArrayMap;

    iget-object v9, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    iget-object v11, v13, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    invoke-virtual {v8, v9, v11}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-object/from16 v4, p1

    move-object/from16 v11, v17

    move-object/from16 v14, v52

    move-object/from16 v9, v53

    move-object/from16 v8, v54

    goto/16 :goto_841

    .line 3026
    .end local v53  # "privilegedProductAppDir":Ljava/io/File;
    .end local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    .restart local v8  # "privilegedProductServicesAppDir":Ljava/io/File;
    .restart local v9  # "privilegedProductAppDir":Ljava/io/File;
    :cond_8c6
    move-object/from16 v54, v8

    move-object/from16 v53, v9

    .end local v8  # "privilegedProductServicesAppDir":Ljava/io/File;
    .end local v9  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v53  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    move-object/from16 v4, p1

    move-object/from16 v11, v17

    move-object/from16 v14, v52

    goto/16 :goto_841

    .line 3040
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v53  # "privilegedProductAppDir":Ljava/io/File;
    .end local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    .restart local v8  # "privilegedProductServicesAppDir":Ljava/io/File;
    .restart local v9  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v14  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_8d2
    move-object/from16 v54, v8

    move-object/from16 v53, v9

    move-object/from16 v52, v14

    .end local v8  # "privilegedProductServicesAppDir":Ljava/io/File;
    .end local v9  # "privilegedProductAppDir":Ljava/io/File;
    .end local v14  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v53  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    iget-object v8, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v9, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v8, v9}, Lcom/android/server/pm/Settings;->isDisabledSystemPackageLPr(Ljava/lang/String;)Z

    move-result v8

    if-nez v8, :cond_902

    .line 3041
    invoke-interface {v12}, Ljava/util/Iterator;->remove()V

    .line 3042
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "System package "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " no longer exists; it\'s data will be wiped"

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    const/4 v9, 0x5

    invoke-static {v9, v8}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    goto :goto_92b

    .line 3051
    :cond_902
    const/4 v9, 0x5

    iget-object v8, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v11, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    .line 3052
    invoke-virtual {v8, v11}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v8

    .line 3053
    .local v8, "disabledPs":Lcom/android/server/pm/PackageSetting;
    iget-object v11, v8, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    if-eqz v11, :cond_926

    iget-object v11, v8, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    invoke-virtual {v11}, Ljava/io/File;->exists()Z

    move-result v11

    if-eqz v11, :cond_926

    iget-object v11, v8, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-nez v11, :cond_91c

    goto :goto_926

    .line 3060
    :cond_91c
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mExpectingBetter:Landroid/util/ArrayMap;

    iget-object v14, v8, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    iget-object v9, v8, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    invoke-virtual {v11, v14, v9}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto :goto_92b

    .line 3055
    :cond_926
    :goto_926
    iget-object v9, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-interface {v15, v9}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 3063
    .end local v4  # "scannedPkg":Landroid/content/pm/PackageParser$Package;
    .end local v8  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_92b
    move-object/from16 v4, p1

    move-object/from16 v11, v17

    move-object/from16 v14, v52

    move-object/from16 v9, v53

    move-object/from16 v8, v54

    goto/16 :goto_841

    .line 3003
    .end local v17  # "pkgIterator":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v53  # "privilegedProductAppDir":Ljava/io/File;
    .end local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    .local v8, "privilegedProductServicesAppDir":Ljava/io/File;
    .restart local v9  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v11  # "pkgIterator":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    .restart local v14  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_937
    move-object/from16 v54, v8

    move-object/from16 v53, v9

    move-object/from16 v17, v11

    move-object/from16 v52, v14

    .end local v8  # "privilegedProductServicesAppDir":Ljava/io/File;
    .end local v9  # "privilegedProductAppDir":Ljava/io/File;
    .end local v11  # "pkgIterator":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    .end local v14  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v17  # "pkgIterator":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    .restart local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v53  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    goto :goto_946

    .line 2992
    .end local v12  # "psit":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    .end local v17  # "pkgIterator":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v53  # "privilegedProductAppDir":Ljava/io/File;
    .end local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    .restart local v8  # "privilegedProductServicesAppDir":Ljava/io/File;
    .restart local v9  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v14  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_940
    move-object/from16 v54, v8

    move-object/from16 v53, v9

    move-object/from16 v52, v14

    .line 3067
    .end local v8  # "privilegedProductServicesAppDir":Ljava/io/File;
    .end local v9  # "privilegedProductAppDir":Ljava/io/File;
    .end local v14  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v53  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    :goto_946
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->deleteTempPackageFiles()V

    .line 3069
    sget-object v4, Landroid/content/pm/PackageParser;->sCachedPackageReadCount:Ljava/util/concurrent/atomic/AtomicInteger;

    invoke-virtual {v4}, Ljava/util/concurrent/atomic/AtomicInteger;->get()I

    move-result v4

    .line 3072
    .local v4, "cachedSystemApps":I
    iget-object v8, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v8}, Lcom/android/server/pm/Settings;->pruneSharedUsersLPw()V

    .line 3073
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v8

    sub-long v8, v8, v43

    .line 3074
    .local v8, "systemScanTime":J
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v11}, Landroid/util/ArrayMap;->size()I

    move-result v11

    move v14, v11

    .line 3075
    .local v14, "systemPackagesCount":I
    const-string v11, "PackageManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Finished scanning system apps. Time: "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v8, v9}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v13, " ms, packageCount: "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v13, " , timePerPackage: "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 3078
    if-nez v14, :cond_98a

    const-wide/16 v55, 0x0

    move-wide/from16 v64, v55

    move-object/from16 v56, v2

    move-object/from16 v55, v3

    move-wide/from16 v2, v64

    goto :goto_991

    :cond_98a
    move-object/from16 v56, v2

    move-object/from16 v55, v3

    .end local v2  # "productAppDir":Ljava/io/File;
    .end local v3  # "privilegedVendorAppDir":Ljava/io/File;
    .local v55, "privilegedVendorAppDir":Ljava/io/File;
    .local v56, "productAppDir":Ljava/io/File;
    int-to-long v2, v14

    div-long v2, v8, v2

    :goto_991
    invoke-virtual {v12, v2, v3}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v2, " , cached: "

    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 3075
    invoke-static {v11, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3080
    iget-boolean v2, v6, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z

    if-eqz v2, :cond_9b3

    if-lez v14, :cond_9b3

    .line 3081
    const-string/jumbo v2, "ota_package_manager_system_app_avg_scan_time"

    long-to-int v3, v8

    div-int/2addr v3, v14

    const/4 v13, 0x0

    invoke-static {v13, v2, v3}, Lcom/android/internal/logging/MetricsLogger;->histogram(Landroid/content/Context;Ljava/lang/String;I)V

    goto :goto_9b4

    .line 3080
    :cond_9b3
    const/4 v13, 0x0

    .line 3084
    :goto_9b4
    iget-boolean v2, v6, Lcom/android/server/pm/PackageManagerService;->mOnlyCore:Z

    if-nez v2, :cond_d77

    .line 3086
    const-string v2, "Android:PMS_DATA_SCAN_START"

    invoke-direct {v6, v2}, Lcom/android/server/pm/PackageManagerService;->addBootEvent(Ljava/lang/String;)V

    .line 3088
    const/16 v2, 0xc08

    .line 3089
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v11

    .line 3088
    invoke-static {v2, v11, v12}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 3092
    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mFlymeThirdAppManager:Lcom/android/server/pm/FlymeThirdAppManager;

    invoke-virtual {v2}, Lcom/android/server/pm/FlymeThirdAppManager;->readConfig()V

    .line 3093
    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mFlymeThirdAppManager:Lcom/android/server/pm/FlymeThirdAppManager;

    iget-boolean v3, v6, Lcom/android/server/pm/PackageManagerService;->mFirstBoot:Z

    sget-object v11, Lcom/android/server/pm/PackageManagerService;->sAppInstallDir:Ljava/io/File;

    invoke-virtual {v2, v3, v11}, Lcom/android/server/pm/FlymeThirdAppManager;->handleApkCopied(ZLjava/io/File;)Z

    move-result v2

    .line 3095
    .local v2, "someThingCopied":Z
    sget-object v12, Lcom/android/server/pm/PackageManagerService;->sAppInstallDir:Ljava/io/File;

    const/4 v3, 0x0

    .line 3096
    if-eqz v2, :cond_9dd

    move/from16 v17, v1

    goto :goto_9e1

    :cond_9dd
    or-int/lit16 v11, v1, 0x80

    move/from16 v17, v11

    :goto_9e1
    const-wide/16 v57, 0x0

    .line 3095
    move-object/from16 v11, p0

    move v13, v3

    move/from16 v45, v14

    move-object/from16 v3, v52

    .end local v14  # "systemPackagesCount":I
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v3, "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v45, "systemPackagesCount":I
    move/from16 v14, v17

    move-object/from16 v52, v15

    .end local v15  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v52, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move-wide/from16 v15, v57

    invoke-direct/range {v11 .. v16}, Lcom/android/server/pm/PackageManagerService;->scanDirTracedLI(Ljava/io/File;IIJ)V

    .line 3097
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mFlymeThirdAppManager:Lcom/android/server/pm/FlymeThirdAppManager;

    invoke-virtual {v11}, Lcom/android/server/pm/FlymeThirdAppManager;->writeConfig()V

    .line 3103
    invoke-interface/range {v52 .. v52}, Ljava/util/List;->size()I

    move-result v11

    const/4 v12, 0x1

    sub-int/2addr v11, v12

    move v15, v11

    .local v15, "i":I
    :goto_9ff
    if-ltz v15, :cond_af7

    .line 3104
    move-object/from16 v14, v52

    .end local v52  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v14, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    invoke-interface {v14, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Ljava/lang/String;

    move-object v13, v11

    .line 3105
    .local v13, "packageName":Ljava/lang/String;
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v11, v13}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/content/pm/PackageParser$Package;

    .line 3110
    .local v11, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v12, v13}, Lcom/android/server/pm/Settings;->removeDisabledSystemPackageLPw(Ljava/lang/String;)V

    .line 3112
    if-nez v11, :cond_a3b

    .line 3114
    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v52, v2

    .end local v2  # "someThingCopied":Z
    .local v52, "someThingCopied":Z
    const-string v2, "Updated system package "

    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " no longer exists; removing its data"

    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    move-object/from16 v60, v11

    move-object/from16 v61, v13

    move/from16 v62, v15

    move-object v15, v2

    move-object v2, v14

    .local v2, "msg":Ljava/lang/String;
    goto/16 :goto_ab1

    .line 3120
    .end local v52  # "someThingCopied":Z
    .local v2, "someThingCopied":Z
    :cond_a3b
    move/from16 v52, v2

    .end local v2  # "someThingCopied":Z
    .restart local v52  # "someThingCopied":Z
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Updated system package "

    invoke-virtual {v2, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, " no longer exists; rescanning package on data"

    invoke-virtual {v2, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 3129
    .local v2, "msg":Ljava/lang/String;
    const/4 v12, 0x1

    invoke-direct {v6, v11, v12}, Lcom/android/server/pm/PackageManagerService;->removePackageLI(Landroid/content/pm/PackageParser$Package;Z)V
    :try_end_a57
    .catchall {:try_start_835 .. :try_end_a57} :catchall_11b1

    .line 3131
    :try_start_a57
    new-instance v12, Ljava/io/File;
    :try_end_a59
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_a57 .. :try_end_a59} :catch_a8a
    .catchall {:try_start_a57 .. :try_end_a59} :catchall_11b1

    move-object/from16 v57, v2

    .end local v2  # "msg":Ljava/lang/String;
    .local v57, "msg":Ljava/lang/String;
    :try_start_a5b
    iget-object v2, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v2}, Landroid/content/pm/ApplicationInfo;->getCodePath()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v12, v2}, Ljava/io/File;-><init>(Ljava/lang/String;)V
    :try_end_a64
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_a5b .. :try_end_a64} :catch_a80
    .catchall {:try_start_a5b .. :try_end_a64} :catchall_11b1

    .line 3132
    .local v12, "codePath":Ljava/io/File;
    const/4 v2, 0x0

    const-wide/16 v16, 0x0

    const/16 v58, 0x0

    move-object/from16 v60, v11

    .end local v11  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v60, "pkg":Landroid/content/pm/PackageParser$Package;
    move-object/from16 v11, p0

    move-object/from16 v61, v13

    .end local v13  # "packageName":Ljava/lang/String;
    .local v61, "packageName":Ljava/lang/String;
    move v13, v2

    move-object v2, v14

    .end local v14  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v2, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move v14, v1

    move/from16 v62, v15

    .end local v15  # "i":I
    .local v62, "i":I
    move-wide/from16 v15, v16

    move-object/from16 v17, v58

    :try_start_a78
    invoke-direct/range {v11 .. v17}, Lcom/android/server/pm/PackageManagerService;->scanPackageTracedLI(Ljava/io/File;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;
    :try_end_a7b
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_a78 .. :try_end_a7b} :catch_a7d
    .catchall {:try_start_a78 .. :try_end_a7b} :catchall_11b1

    .line 3136
    nop

    .end local v12  # "codePath":Ljava/io/File;
    goto :goto_aaf

    .line 3133
    :catch_a7d
    move-exception v0

    move-object v11, v0

    goto :goto_a95

    .end local v2  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v60  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v61  # "packageName":Ljava/lang/String;
    .end local v62  # "i":I
    .restart local v11  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v13  # "packageName":Ljava/lang/String;
    .restart local v14  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v15  # "i":I
    :catch_a80
    move-exception v0

    move-object/from16 v60, v11

    move-object/from16 v61, v13

    move-object v2, v14

    move/from16 v62, v15

    move-object v11, v0

    .end local v11  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v13  # "packageName":Ljava/lang/String;
    .end local v14  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v15  # "i":I
    .restart local v2  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v60  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v61  # "packageName":Ljava/lang/String;
    .restart local v62  # "i":I
    goto :goto_a95

    .end local v57  # "msg":Ljava/lang/String;
    .end local v60  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v61  # "packageName":Ljava/lang/String;
    .end local v62  # "i":I
    .local v2, "msg":Ljava/lang/String;
    .restart local v11  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v13  # "packageName":Ljava/lang/String;
    .restart local v14  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v15  # "i":I
    :catch_a8a
    move-exception v0

    move-object/from16 v57, v2

    move-object/from16 v60, v11

    move-object/from16 v61, v13

    move-object v2, v14

    move/from16 v62, v15

    move-object v11, v0

    .line 3134
    .end local v13  # "packageName":Ljava/lang/String;
    .end local v14  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v15  # "i":I
    .local v2, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v11, "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v57  # "msg":Ljava/lang/String;
    .restart local v60  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v61  # "packageName":Ljava/lang/String;
    .restart local v62  # "i":I
    :goto_a95
    :try_start_a95
    const-string v12, "PackageManager"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Failed to parse updated, ex-system package: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 3135
    invoke-virtual {v11}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v14

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    .line 3134
    invoke-static {v12, v13}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 3143
    .end local v11  # "e":Lcom/android/server/pm/PackageManagerException;
    :goto_aaf
    move-object/from16 v15, v57

    .end local v57  # "msg":Ljava/lang/String;
    .local v15, "msg":Ljava/lang/String;
    :goto_ab1
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v11, v11, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    move-object/from16 v14, v61

    .end local v61  # "packageName":Ljava/lang/String;
    .local v14, "packageName":Ljava/lang/String;
    invoke-virtual {v11, v14}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/pm/PackageSetting;

    move-object/from16 v17, v11

    .line 3144
    .local v17, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v17, :cond_ae2

    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v11, v14}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    if-nez v11, :cond_ae2

    .line 3145
    const/4 v13, 0x0

    const/16 v16, 0x0

    const/16 v57, 0x0

    const/16 v58, 0x0

    move-object/from16 v11, p0

    move-object/from16 v12, v17

    move-object/from16 v61, v14

    .end local v14  # "packageName":Ljava/lang/String;
    .restart local v61  # "packageName":Ljava/lang/String;
    move-object/from16 v14, v16

    move-object/from16 v63, v15

    .end local v15  # "msg":Ljava/lang/String;
    .local v63, "msg":Ljava/lang/String;
    move/from16 v15, v57

    move/from16 v16, v58

    invoke-direct/range {v11 .. v16}, Lcom/android/server/pm/PackageManagerService;->removePackageDataLIF(Lcom/android/server/pm/PackageSetting;[ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;IZ)V

    goto :goto_ae6

    .line 3144
    .end local v61  # "packageName":Ljava/lang/String;
    .end local v63  # "msg":Ljava/lang/String;
    .restart local v14  # "packageName":Ljava/lang/String;
    .restart local v15  # "msg":Ljava/lang/String;
    :cond_ae2
    move-object/from16 v61, v14

    move-object/from16 v63, v15

    .line 3148
    .end local v14  # "packageName":Ljava/lang/String;
    .end local v15  # "msg":Ljava/lang/String;
    .restart local v61  # "packageName":Ljava/lang/String;
    .restart local v63  # "msg":Ljava/lang/String;
    :goto_ae6
    move-object/from16 v11, v63

    const/4 v15, 0x5

    .end local v63  # "msg":Ljava/lang/String;
    .local v11, "msg":Ljava/lang/String;
    invoke-static {v15, v11}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 3103
    .end local v11  # "msg":Ljava/lang/String;
    .end local v17  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v60  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v61  # "packageName":Ljava/lang/String;
    add-int/lit8 v11, v62, -0x1

    move v15, v11

    move/from16 v64, v52

    move-object/from16 v52, v2

    move/from16 v2, v64

    .end local v62  # "i":I
    .local v11, "i":I
    goto/16 :goto_9ff

    .end local v11  # "i":I
    .local v2, "someThingCopied":Z
    .local v15, "i":I
    .local v52, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_af7
    move/from16 v62, v15

    const/4 v15, 0x5

    move-object/from16 v64, v52

    move/from16 v52, v2

    move-object/from16 v2, v64

    .line 3156
    .end local v15  # "i":I
    .local v2, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v52, "someThingCopied":Z
    move/from16 v11, v20

    move v14, v11

    .local v14, "i":I
    :goto_b03
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mExpectingBetter:Landroid/util/ArrayMap;

    invoke-virtual {v11}, Landroid/util/ArrayMap;->size()I

    move-result v11

    if-ge v14, v11, :cond_d02

    .line 3157
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mExpectingBetter:Landroid/util/ArrayMap;

    invoke-virtual {v11, v14}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Ljava/lang/String;

    move-object v13, v11

    .line 3158
    .restart local v13  # "packageName":Ljava/lang/String;
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v11, v13}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v11

    if-nez v11, :cond_cd2

    .line 3159
    iget-object v11, v6, Lcom/android/server/pm/PackageManagerService;->mExpectingBetter:Landroid/util/ArrayMap;

    invoke-virtual {v11, v14}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Ljava/io/File;

    move-object v12, v11

    .line 3161
    .local v12, "scanFile":Ljava/io/File;
    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Expected better "

    invoke-virtual {v11, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, " but never showed up; reverting to system"

    invoke-virtual {v11, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    const/4 v15, 0x5

    invoke-static {v15, v11}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 3166
    invoke-static {v7, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v11

    if-eqz v11, :cond_b5c

    .line 3167
    iget v11, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v11, v11, 0x10

    .line 3170
    .local v11, "reparseFlags":I
    or-int v16, v1, v33

    or-int v16, v16, v41

    move-object/from16 v57, v7

    move-object/from16 v15, v48

    move-object/from16 v48, v2

    move v2, v11

    move-object/from16 v11, v49

    move-object/from16 v49, v5

    move/from16 v5, v16

    .local v16, "rescanFlags":I
    goto/16 :goto_c8d

    .line 3174
    .end local v11  # "reparseFlags":I
    .end local v16  # "rescanFlags":I
    :cond_b5c
    move-object/from16 v11, v49

    .end local v49  # "systemAppDir":Ljava/io/File;
    .local v11, "systemAppDir":Ljava/io/File;
    invoke-static {v11, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v16

    if-eqz v16, :cond_b79

    .line 3175
    iget v15, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v15, v15, 0x10

    .line 3178
    .local v15, "reparseFlags":I
    or-int v16, v1, v33

    move-object/from16 v49, v5

    move-object/from16 v57, v7

    move/from16 v5, v16

    move-object/from16 v64, v48

    move-object/from16 v48, v2

    move v2, v15

    move-object/from16 v15, v64

    .restart local v16  # "rescanFlags":I
    goto/16 :goto_c8d

    .line 3181
    .end local v15  # "reparseFlags":I
    .end local v16  # "rescanFlags":I
    :cond_b79
    move-object/from16 v15, v55

    .end local v55  # "privilegedVendorAppDir":Ljava/io/File;
    .local v15, "privilegedVendorAppDir":Ljava/io/File;
    invoke-static {v15, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v16

    if-nez v16, :cond_c79

    .line 3182
    move-object/from16 v55, v15

    move-object/from16 v15, v47

    .end local v47  # "privilegedOdmAppDir":Ljava/io/File;
    .local v15, "privilegedOdmAppDir":Ljava/io/File;
    .restart local v55  # "privilegedVendorAppDir":Ljava/io/File;
    invoke-static {v15, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v16

    if-eqz v16, :cond_b97

    move-object/from16 v49, v5

    move-object/from16 v57, v7

    move-object/from16 v47, v15

    move-object/from16 v15, v48

    move-object/from16 v48, v2

    goto/16 :goto_c83

    .line 3191
    :cond_b97
    move-object/from16 v47, v15

    move-object/from16 v15, v46

    .end local v46  # "vendorAppDir":Ljava/io/File;
    .local v15, "vendorAppDir":Ljava/io/File;
    .restart local v47  # "privilegedOdmAppDir":Ljava/io/File;
    invoke-static {v15, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v16

    if-nez v16, :cond_c66

    .line 3192
    move-object/from16 v46, v15

    move-object/from16 v15, v48

    .end local v48  # "odmAppDir":Ljava/io/File;
    .local v15, "odmAppDir":Ljava/io/File;
    .restart local v46  # "vendorAppDir":Ljava/io/File;
    invoke-static {v15, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v16

    if-eqz v16, :cond_bb3

    move-object/from16 v48, v2

    move-object/from16 v49, v5

    move-object/from16 v57, v7

    goto/16 :goto_c70

    .line 3200
    :cond_bb3
    invoke-static {v5, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v16

    if-eqz v16, :cond_bcb

    .line 3201
    move-object/from16 v48, v2

    .end local v2  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v48, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    iget v2, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v2, v2, 0x10

    .line 3204
    .local v2, "reparseFlags":I
    or-int v16, v1, v33

    or-int v16, v16, v40

    move-object/from16 v49, v5

    move-object/from16 v57, v7

    move/from16 v5, v16

    .restart local v16  # "rescanFlags":I
    goto/16 :goto_c8d

    .line 3208
    .end local v16  # "rescanFlags":I
    .end local v48  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v2, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_bcb
    move-object/from16 v48, v2

    .end local v2  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v48  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move-object/from16 v2, v53

    .end local v53  # "privilegedProductAppDir":Ljava/io/File;
    .local v2, "privilegedProductAppDir":Ljava/io/File;
    invoke-static {v2, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v16

    if-eqz v16, :cond_be9

    .line 3209
    move-object/from16 v53, v2

    .end local v2  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v53  # "privilegedProductAppDir":Ljava/io/File;
    iget v2, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v2, v2, 0x10

    .line 3212
    .local v2, "reparseFlags":I
    or-int v16, v1, v33

    or-int v16, v16, v36

    or-int v16, v16, v41

    move-object/from16 v49, v5

    move-object/from16 v57, v7

    move/from16 v5, v16

    .restart local v16  # "rescanFlags":I
    goto/16 :goto_c8d

    .line 3217
    .end local v16  # "rescanFlags":I
    .end local v53  # "privilegedProductAppDir":Ljava/io/File;
    .local v2, "privilegedProductAppDir":Ljava/io/File;
    :cond_be9
    move-object/from16 v53, v2

    .end local v2  # "privilegedProductAppDir":Ljava/io/File;
    .restart local v53  # "privilegedProductAppDir":Ljava/io/File;
    move-object/from16 v2, v56

    .end local v56  # "productAppDir":Ljava/io/File;
    .local v2, "productAppDir":Ljava/io/File;
    invoke-static {v2, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v16

    if-eqz v16, :cond_c05

    .line 3218
    move-object/from16 v56, v2

    .end local v2  # "productAppDir":Ljava/io/File;
    .restart local v56  # "productAppDir":Ljava/io/File;
    iget v2, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v2, v2, 0x10

    .line 3221
    .local v2, "reparseFlags":I
    or-int v16, v1, v33

    or-int v16, v16, v36

    move-object/from16 v49, v5

    move-object/from16 v57, v7

    move/from16 v5, v16

    .restart local v16  # "rescanFlags":I
    goto/16 :goto_c8d

    .line 3225
    .end local v16  # "rescanFlags":I
    .end local v56  # "productAppDir":Ljava/io/File;
    .local v2, "productAppDir":Ljava/io/File;
    :cond_c05
    move-object/from16 v56, v2

    .end local v2  # "productAppDir":Ljava/io/File;
    .restart local v56  # "productAppDir":Ljava/io/File;
    move-object/from16 v2, v54

    .end local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    .local v2, "privilegedProductServicesAppDir":Ljava/io/File;
    invoke-static {v2, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v16

    if-eqz v16, :cond_c23

    .line 3226
    move-object/from16 v54, v2

    .end local v2  # "privilegedProductServicesAppDir":Ljava/io/File;
    .restart local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    iget v2, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v2, v2, 0x10

    .line 3229
    .local v2, "reparseFlags":I
    or-int v16, v1, v33

    or-int v16, v16, v37

    or-int v16, v16, v41

    move-object/from16 v49, v5

    move-object/from16 v57, v7

    move/from16 v5, v16

    .restart local v16  # "rescanFlags":I
    goto/16 :goto_c8d

    .line 3234
    .end local v16  # "rescanFlags":I
    .end local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    .local v2, "privilegedProductServicesAppDir":Ljava/io/File;
    :cond_c23
    move-object/from16 v54, v2

    .end local v2  # "privilegedProductServicesAppDir":Ljava/io/File;
    .restart local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    invoke-static {v10, v12}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v2

    if-eqz v2, :cond_c3a

    .line 3235
    iget v2, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v2, v2, 0x10

    .line 3238
    .local v2, "reparseFlags":I
    or-int v16, v1, v33

    or-int v16, v16, v37

    move-object/from16 v49, v5

    move-object/from16 v57, v7

    move/from16 v5, v16

    .restart local v16  # "rescanFlags":I
    goto :goto_c8d

    .line 3243
    .end local v2  # "reparseFlags":I
    .end local v16  # "rescanFlags":I
    :cond_c3a
    const-string v2, "PackageManager"

    move-object/from16 v49, v5

    .end local v5  # "oemAppDir":Ljava/io/File;
    .local v49, "oemAppDir":Ljava/io/File;
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v57, v7

    .end local v7  # "privilegedAppDir":Ljava/io/File;
    .local v57, "privilegedAppDir":Ljava/io/File;
    const-string v7, "Ignoring unexpected fallback path "

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v2, v5}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 3244
    move-object/from16 v58, v11

    move/from16 v62, v14

    move-object/from16 v59, v15

    const/16 v63, 0x5

    move-object/from16 v64, v47

    move-object/from16 v47, v46

    move-object/from16 v46, v55

    move-object/from16 v55, v64

    goto/16 :goto_cea

    .line 3191
    .end local v46  # "vendorAppDir":Ljava/io/File;
    .end local v49  # "oemAppDir":Ljava/io/File;
    .end local v57  # "privilegedAppDir":Ljava/io/File;
    .local v2, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v5  # "oemAppDir":Ljava/io/File;
    .restart local v7  # "privilegedAppDir":Ljava/io/File;
    .local v15, "vendorAppDir":Ljava/io/File;
    .local v48, "odmAppDir":Ljava/io/File;
    :cond_c66
    move-object/from16 v49, v5

    move-object/from16 v57, v7

    move-object/from16 v46, v15

    move-object/from16 v15, v48

    move-object/from16 v48, v2

    .line 3193
    .end local v2  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v5  # "oemAppDir":Ljava/io/File;
    .end local v7  # "privilegedAppDir":Ljava/io/File;
    .local v15, "odmAppDir":Ljava/io/File;
    .restart local v46  # "vendorAppDir":Ljava/io/File;
    .local v48, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v49  # "oemAppDir":Ljava/io/File;
    .restart local v57  # "privilegedAppDir":Ljava/io/File;
    :goto_c70
    iget v2, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v2, v2, 0x10

    .line 3196
    .local v2, "reparseFlags":I
    or-int v5, v1, v33

    or-int v5, v5, v34

    .local v5, "rescanFlags":I
    goto :goto_c8d

    .line 3181
    .end local v49  # "oemAppDir":Ljava/io/File;
    .end local v55  # "privilegedVendorAppDir":Ljava/io/File;
    .end local v57  # "privilegedAppDir":Ljava/io/File;
    .local v2, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v5, "oemAppDir":Ljava/io/File;
    .restart local v7  # "privilegedAppDir":Ljava/io/File;
    .local v15, "privilegedVendorAppDir":Ljava/io/File;
    .local v48, "odmAppDir":Ljava/io/File;
    :cond_c79
    move-object/from16 v49, v5

    move-object/from16 v57, v7

    move-object/from16 v55, v15

    move-object/from16 v15, v48

    move-object/from16 v48, v2

    .line 3183
    .end local v2  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v5  # "oemAppDir":Ljava/io/File;
    .end local v7  # "privilegedAppDir":Ljava/io/File;
    .local v15, "odmAppDir":Ljava/io/File;
    .local v48, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v49  # "oemAppDir":Ljava/io/File;
    .restart local v55  # "privilegedVendorAppDir":Ljava/io/File;
    .restart local v57  # "privilegedAppDir":Ljava/io/File;
    :goto_c83
    iget v2, v6, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v2, v2, 0x10

    .line 3186
    .local v2, "reparseFlags":I
    or-int v5, v1, v33

    or-int v5, v5, v34

    or-int v5, v5, v41

    .line 3247
    .local v5, "rescanFlags":I
    :goto_c8d
    iget-object v7, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v7, v13}, Lcom/android/server/pm/Settings;->enableSystemPackageLPw(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;
    :try_end_c92
    .catchall {:try_start_a95 .. :try_end_c92} :catchall_11b1

    .line 3250
    const-wide/16 v16, 0x0

    const/4 v7, 0x0

    move-object/from16 v58, v11

    .end local v11  # "systemAppDir":Ljava/io/File;
    .local v58, "systemAppDir":Ljava/io/File;
    move-object/from16 v11, p0

    move-object/from16 v60, v12

    .end local v12  # "scanFile":Ljava/io/File;
    .local v60, "scanFile":Ljava/io/File;
    move-object/from16 v61, v13

    .end local v13  # "packageName":Ljava/lang/String;
    .restart local v61  # "packageName":Ljava/lang/String;
    move v13, v2

    move/from16 v62, v14

    .end local v14  # "i":I
    .restart local v62  # "i":I
    move v14, v5

    move-object/from16 v59, v15

    const/16 v63, 0x5

    move-object/from16 v64, v47

    move-object/from16 v47, v46

    move-object/from16 v46, v55

    move-object/from16 v55, v64

    .end local v15  # "odmAppDir":Ljava/io/File;
    .local v46, "privilegedVendorAppDir":Ljava/io/File;
    .local v47, "vendorAppDir":Ljava/io/File;
    .local v55, "privilegedOdmAppDir":Ljava/io/File;
    .local v59, "odmAppDir":Ljava/io/File;
    move-wide/from16 v15, v16

    move-object/from16 v17, v7

    :try_start_cb1
    invoke-direct/range {v11 .. v17}, Lcom/android/server/pm/PackageManagerService;->scanPackageTracedLI(Ljava/io/File;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;
    :try_end_cb4
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_cb1 .. :try_end_cb4} :catch_cb5
    .catchall {:try_start_cb1 .. :try_end_cb4} :catchall_11b1

    .line 3254
    goto :goto_cea

    .line 3251
    :catch_cb5
    move-exception v0

    move-object v7, v0

    .line 3252
    .local v7, "e":Lcom/android/server/pm/PackageManagerException;
    :try_start_cb7
    const-string v11, "PackageManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Failed to parse original system package: "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 3253
    invoke-virtual {v7}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    .line 3252
    invoke-static {v11, v12}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_cea

    .line 3158
    .end local v57  # "privilegedAppDir":Ljava/io/File;
    .end local v58  # "systemAppDir":Ljava/io/File;
    .end local v59  # "odmAppDir":Ljava/io/File;
    .end local v60  # "scanFile":Ljava/io/File;
    .end local v61  # "packageName":Ljava/lang/String;
    .end local v62  # "i":I
    .local v2, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v5, "oemAppDir":Ljava/io/File;
    .local v7, "privilegedAppDir":Ljava/io/File;
    .restart local v13  # "packageName":Ljava/lang/String;
    .restart local v14  # "i":I
    .local v46, "vendorAppDir":Ljava/io/File;
    .local v47, "privilegedOdmAppDir":Ljava/io/File;
    .local v48, "odmAppDir":Ljava/io/File;
    .local v49, "systemAppDir":Ljava/io/File;
    .local v55, "privilegedVendorAppDir":Ljava/io/File;
    :cond_cd2
    move-object/from16 v57, v7

    move-object/from16 v61, v13

    move/from16 v62, v14

    move/from16 v63, v15

    move-object/from16 v59, v48

    move-object/from16 v58, v49

    move-object/from16 v48, v2

    move-object/from16 v49, v5

    move-object/from16 v64, v47

    move-object/from16 v47, v46

    move-object/from16 v46, v55

    move-object/from16 v55, v64

    .line 3156
    .end local v2  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v5  # "oemAppDir":Ljava/io/File;
    .end local v7  # "privilegedAppDir":Ljava/io/File;
    .end local v13  # "packageName":Ljava/lang/String;
    .end local v14  # "i":I
    .local v46, "privilegedVendorAppDir":Ljava/io/File;
    .local v47, "vendorAppDir":Ljava/io/File;
    .local v48, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v49, "oemAppDir":Ljava/io/File;
    .local v55, "privilegedOdmAppDir":Ljava/io/File;
    .restart local v57  # "privilegedAppDir":Ljava/io/File;
    .restart local v58  # "systemAppDir":Ljava/io/File;
    .restart local v59  # "odmAppDir":Ljava/io/File;
    .restart local v62  # "i":I
    :goto_cea
    add-int/lit8 v14, v62, 0x1

    move-object/from16 v2, v48

    move-object/from16 v5, v49

    move-object/from16 v7, v57

    move-object/from16 v49, v58

    move-object/from16 v48, v59

    move/from16 v15, v63

    move-object/from16 v64, v55

    move-object/from16 v55, v46

    move-object/from16 v46, v47

    move-object/from16 v47, v64

    .end local v62  # "i":I
    .restart local v14  # "i":I
    goto/16 :goto_b03

    .end local v57  # "privilegedAppDir":Ljava/io/File;
    .end local v58  # "systemAppDir":Ljava/io/File;
    .end local v59  # "odmAppDir":Ljava/io/File;
    .restart local v2  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v5  # "oemAppDir":Ljava/io/File;
    .restart local v7  # "privilegedAppDir":Ljava/io/File;
    .local v46, "vendorAppDir":Ljava/io/File;
    .local v47, "privilegedOdmAppDir":Ljava/io/File;
    .local v48, "odmAppDir":Ljava/io/File;
    .local v49, "systemAppDir":Ljava/io/File;
    .local v55, "privilegedVendorAppDir":Ljava/io/File;
    :cond_d02
    move-object/from16 v57, v7

    move/from16 v62, v14

    move-object/from16 v59, v48

    move-object/from16 v58, v49

    move-object/from16 v48, v2

    move-object/from16 v49, v5

    move-object/from16 v64, v47

    move-object/from16 v47, v46

    move-object/from16 v46, v55

    move-object/from16 v55, v64

    .line 3260
    .end local v2  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v5  # "oemAppDir":Ljava/io/File;
    .end local v7  # "privilegedAppDir":Ljava/io/File;
    .end local v14  # "i":I
    .local v46, "privilegedVendorAppDir":Ljava/io/File;
    .local v47, "vendorAppDir":Ljava/io/File;
    .local v48, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v49, "oemAppDir":Ljava/io/File;
    .local v55, "privilegedOdmAppDir":Ljava/io/File;
    .restart local v57  # "privilegedAppDir":Ljava/io/File;
    .restart local v58  # "systemAppDir":Ljava/io/File;
    .restart local v59  # "odmAppDir":Ljava/io/File;
    invoke-direct {v6, v3, v1}, Lcom/android/server/pm/PackageManagerService;->installSystemStubPackages(Ljava/util/List;I)V

    .line 3262
    sget-object v2, Landroid/content/pm/PackageParser;->sCachedPackageReadCount:Ljava/util/concurrent/atomic/AtomicInteger;

    invoke-virtual {v2}, Ljava/util/concurrent/atomic/AtomicInteger;->get()I

    move-result v2

    sub-int/2addr v2, v4

    .line 3265
    .local v2, "cachedNonSystemApps":I
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v11

    sub-long/2addr v11, v8

    sub-long v11, v11, v43

    .line 3266
    .local v11, "dataScanTime":J
    iget-object v5, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5}, Landroid/util/ArrayMap;->size()I

    move-result v5

    sub-int v5, v5, v45

    .line 3267
    .local v5, "dataPackagesCount":I
    const-string v7, "PackageManager"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Finished scanning non-system apps. Time: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v14, " ms, packageCount: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v14, " , timePerPackage: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 3270
    if-nez v5, :cond_d50

    const-wide/16 v14, 0x0

    goto :goto_d53

    :cond_d50
    int-to-long v14, v5

    div-long v14, v11, v14

    :goto_d53
    invoke-virtual {v13, v14, v15}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v14, " , cached: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    .line 3267
    invoke-static {v7, v13}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3272
    iget-boolean v7, v6, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z

    if-eqz v7, :cond_d75

    if-lez v5, :cond_d75

    .line 3273
    const-string/jumbo v7, "ota_package_manager_data_app_avg_scan_time"

    long-to-int v13, v11

    div-int/2addr v13, v5

    const/4 v15, 0x0

    invoke-static {v15, v7, v13}, Lcom/android/internal/logging/MetricsLogger;->histogram(Landroid/content/Context;Ljava/lang/String;I)V

    goto :goto_d8e

    .line 3272
    :cond_d75
    const/4 v15, 0x0

    goto :goto_d8e

    .line 3084
    .end local v2  # "cachedNonSystemApps":I
    .end local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v11  # "dataScanTime":J
    .end local v45  # "systemPackagesCount":I
    .end local v57  # "privilegedAppDir":Ljava/io/File;
    .end local v58  # "systemAppDir":Ljava/io/File;
    .end local v59  # "odmAppDir":Ljava/io/File;
    .local v5, "oemAppDir":Ljava/io/File;
    .restart local v7  # "privilegedAppDir":Ljava/io/File;
    .local v14, "systemPackagesCount":I
    .local v15, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v46, "vendorAppDir":Ljava/io/File;
    .local v47, "privilegedOdmAppDir":Ljava/io/File;
    .local v48, "odmAppDir":Ljava/io/File;
    .local v49, "systemAppDir":Ljava/io/File;
    .local v52, "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v55, "privilegedVendorAppDir":Ljava/io/File;
    :cond_d77
    move-object/from16 v57, v7

    move/from16 v45, v14

    move-object/from16 v59, v48

    move-object/from16 v58, v49

    move-object/from16 v3, v52

    move-object/from16 v49, v5

    move-object/from16 v48, v15

    move-object v15, v13

    move-object/from16 v64, v47

    move-object/from16 v47, v46

    move-object/from16 v46, v55

    move-object/from16 v55, v64

    .line 3277
    .end local v5  # "oemAppDir":Ljava/io/File;
    .end local v7  # "privilegedAppDir":Ljava/io/File;
    .end local v14  # "systemPackagesCount":I
    .end local v15  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v45  # "systemPackagesCount":I
    .local v46, "privilegedVendorAppDir":Ljava/io/File;
    .local v47, "vendorAppDir":Ljava/io/File;
    .local v48, "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v49, "oemAppDir":Ljava/io/File;
    .local v55, "privilegedOdmAppDir":Ljava/io/File;
    .restart local v57  # "privilegedAppDir":Ljava/io/File;
    .restart local v58  # "systemAppDir":Ljava/io/File;
    .restart local v59  # "odmAppDir":Ljava/io/File;
    :goto_d8e
    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mExpectingBetter:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->clear()V

    .line 3280
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getStorageManagerPackageName()Ljava/lang/String;

    move-result-object v2

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mStorageManagerPackage:Ljava/lang/String;

    .line 3284
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getSetupWizardPackageName()Ljava/lang/String;

    move-result-object v2

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mSetupWizardPackage:Ljava/lang/String;

    .line 3285
    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v2}, Lcom/android/server/pm/ComponentResolver;->fixProtectedFilterPriorities()V

    .line 3287
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getSystemTextClassifierPackageName()Ljava/lang/String;

    move-result-object v2

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mSystemTextClassifierPackage:Ljava/lang/String;

    .line 3289
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getWellbeingPackageName()Ljava/lang/String;

    move-result-object v2

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mWellbeingPackage:Ljava/lang/String;

    .line 3290
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getDocumenterPackageName()Ljava/lang/String;

    move-result-object v2

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mDocumenterPackage:Ljava/lang/String;

    .line 3291
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getDeviceConfiguratorPackageName()Ljava/lang/String;

    move-result-object v2

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mConfiguratorPackage:Ljava/lang/String;

    .line 3292
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getAppPredictionServicePackageName()Ljava/lang/String;

    move-result-object v2

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mAppPredictionServicePackage:Ljava/lang/String;

    .line 3293
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getIncidentReportApproverPackageName()Ljava/lang/String;

    move-result-object v2

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mIncidentReportApproverPackage:Ljava/lang/String;

    .line 3297
    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-static {v2}, Ljava/util/Collections;->unmodifiableMap(Ljava/util/Map;)Ljava/util/Map;

    move-result-object v2

    invoke-direct {v6, v15, v2}, Lcom/android/server/pm/PackageManagerService;->updateAllSharedLibrariesLocked(Landroid/content/pm/PackageParser$Package;Ljava/util/Map;)Ljava/util/ArrayList;

    .line 3299
    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2}, Lcom/android/server/pm/Settings;->getAllSharedUsersLPw()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_ddb
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_e19

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/SharedUserSetting;

    .line 3303
    .local v5, "setting":Lcom/android/server/pm/SharedUserSetting;
    iget-object v7, v5, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    .line 3304
    invoke-static {v7, v15}, Lcom/android/server/pm/PackageManagerService;->adjustCpuAbisForSharedUserLPw(Ljava/util/Set;Landroid/content/pm/PackageParser$Package;)Ljava/util/List;

    move-result-object v7

    .line 3305
    .local v7, "changedAbiCodePath":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v7, :cond_e15

    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v11

    if-lez v11, :cond_e15

    .line 3306
    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v11

    const/4 v12, 0x1

    sub-int/2addr v11, v12

    .local v11, "i":I
    :goto_dfb
    if-ltz v11, :cond_e15

    .line 3307
    invoke-interface {v7, v11}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Ljava/lang/String;
    :try_end_e03
    .catchall {:try_start_cb7 .. :try_end_e03} :catchall_11b1

    .line 3309
    .local v12, "codePathString":Ljava/lang/String;
    :try_start_e03
    iget-object v13, v6, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    .line 3310
    invoke-static {}, Lcom/android/server/pm/InstructionSets;->getPreferredInstructionSet()Ljava/lang/String;

    move-result-object v14

    invoke-static {v14}, Lcom/android/server/pm/InstructionSets;->getDexCodeInstructionSet(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v14

    .line 3309
    invoke-virtual {v13, v12, v14}, Lcom/android/server/pm/Installer;->rmdex(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_e10
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_e03 .. :try_end_e10} :catch_e11
    .catchall {:try_start_e03 .. :try_end_e10} :catchall_11b1

    .line 3312
    goto :goto_e12

    .line 3311
    :catch_e11
    move-exception v0

    .line 3306
    .end local v12  # "codePathString":Ljava/lang/String;
    :goto_e12
    add-int/lit8 v11, v11, -0x1

    goto :goto_dfb

    .line 3317
    .end local v11  # "i":I
    :cond_e15
    :try_start_e15
    invoke-virtual {v5}, Lcom/android/server/pm/SharedUserSetting;->fixSeInfoLocked()V

    .line 3318
    .end local v5  # "setting":Lcom/android/server/pm/SharedUserSetting;
    .end local v7  # "changedAbiCodePath":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    goto :goto_ddb

    .line 3322
    :cond_e19
    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mPackageUsage:Lcom/android/server/pm/PackageUsage;

    iget-object v5, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, v5}, Lcom/android/server/pm/PackageUsage;->read(Ljava/lang/Object;)V

    .line 3323
    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mCompilerStats:Lcom/android/server/pm/CompilerStats;

    invoke-virtual {v2}, Lcom/android/server/pm/CompilerStats;->read()V

    .line 3326
    const-string v2, "Android:PMS_SCAN_END"

    invoke-direct {v6, v2}, Lcom/android/server/pm/PackageManagerService;->addBootEvent(Ljava/lang/String;)V

    .line 3328
    const/16 v2, 0xc12

    .line 3329
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v11

    .line 3328
    invoke-static {v2, v11, v12}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 3330
    const-string v2, "PackageManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Time to scan packages: "

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 3331
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v11

    sub-long v11, v11, v43

    long-to-float v7, v11

    const/high16 v11, 0x447a0000  # 1000.0f

    div-float/2addr v7, v11

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(F)Ljava/lang/StringBuilder;

    const-string v7, " seconds"

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    .line 3330
    invoke-static {v2, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3340
    move-object/from16 v2, v50

    .end local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .local v2, "ver":Lcom/android/server/pm/Settings$VersionInfo;
    iget v5, v2, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I

    iget v7, v6, Lcom/android/server/pm/PackageManagerService;->mSdkVersion:I

    if-eq v5, v7, :cond_e62

    const/4 v5, 0x1

    goto :goto_e64

    :cond_e62
    move/from16 v5, v20

    .line 3341
    .local v5, "sdkUpdated":Z
    :goto_e64
    if-eqz v5, :cond_e8d

    .line 3342
    const-string v7, "PackageManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Platform changed from "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v12, v2, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v12, " to "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v12, v6, Lcom/android/server/pm/PackageManagerService;->mSdkVersion:I

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v12, "; regranting permissions for internal storage"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v7, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3345
    :cond_e8d
    iget-object v7, v6, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    sget-object v11, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 3346
    invoke-virtual {v12}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v12

    iget-object v13, v6, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 3345
    invoke-virtual {v7, v11, v5, v12, v13}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updateAllPermissions(Ljava/lang/String;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 3348
    iget v7, v6, Lcom/android/server/pm/PackageManagerService;->mSdkVersion:I

    iput v7, v2, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I

    .line 3353
    if-nez p4, :cond_ece

    iget-boolean v7, v6, Lcom/android/server/pm/PackageManagerService;->mPromoteSystemApps:Z

    if-nez v7, :cond_eaa

    iget-boolean v7, v6, Lcom/android/server/pm/PackageManagerService;->mFirstBoot:Z

    if-eqz v7, :cond_ece

    .line 3354
    :cond_eaa
    sget-object v7, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    const/4 v11, 0x1

    invoke-virtual {v7, v11}, Lcom/android/server/pm/UserManagerService;->getUsers(Z)Ljava/util/List;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v7

    :goto_eb5
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v11

    if-eqz v11, :cond_ece

    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/content/pm/UserInfo;

    .line 3355
    .local v11, "user":Landroid/content/pm/UserInfo;
    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget v13, v11, Landroid/content/pm/UserInfo;->id:I

    invoke-virtual {v12, v13}, Lcom/android/server/pm/Settings;->applyDefaultPreferredAppsLPw(I)V

    .line 3356
    iget v12, v11, Landroid/content/pm/UserInfo;->id:I

    invoke-direct {v6, v12}, Lcom/android/server/pm/PackageManagerService;->primeDomainVerificationsLPw(I)V

    .line 3357
    .end local v11  # "user":Landroid/content/pm/UserInfo;
    goto :goto_eb5

    .line 3364
    :cond_ece
    invoke-static {}, Landroid/os/storage/StorageManager;->isFileEncryptedNativeOrEmulated()Z

    move-result v7

    if-eqz v7, :cond_ed6

    .line 3365
    const/4 v7, 0x1

    .local v7, "storageFlags":I
    goto :goto_ed8

    .line 3367
    .end local v7  # "storageFlags":I
    :cond_ed6
    move/from16 v7, v29

    .line 3369
    .restart local v7  # "storageFlags":I
    :goto_ed8
    sget-object v12, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    const/4 v13, 0x0

    const/16 v16, 0x1

    const/16 v17, 0x1

    move-object/from16 v11, p0

    move v14, v7

    move/from16 v15, v16

    move/from16 v16, v17

    invoke-direct/range {v11 .. v16}, Lcom/android/server/pm/PackageManagerService;->reconcileAppsDataLI(Ljava/lang/String;IIZZ)Ljava/util/List;

    move-result-object v11

    .line 3372
    .local v11, "deferPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    invoke-static {}, Lcom/android/server/SystemServerInitThreadPool;->get()Lcom/android/server/SystemServerInitThreadPool;

    move-result-object v12

    new-instance v13, Lcom/android/server/pm/-$$Lambda$PackageManagerService$sJ5w9GfSftnZPyv5hBDxQkxDJMU;

    invoke-direct {v13, v6, v11, v7}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$sJ5w9GfSftnZPyv5hBDxQkxDJMU;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/util/List;I)V

    const-string/jumbo v14, "prepareAppData"

    invoke-virtual {v12, v13, v14}, Lcom/android/server/SystemServerInitThreadPool;->submit(Ljava/lang/Runnable;Ljava/lang/String;)Ljava/util/concurrent/Future;

    move-result-object v12

    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mPrepareAppDataFuture:Ljava/util/concurrent/Future;

    .line 3414
    iget-boolean v12, v6, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z

    if-eqz v12, :cond_f49

    if-nez p4, :cond_f49

    .line 3415
    const-string v12, "PackageManager"

    const-string v14, "Build fingerprint changed; clearing code caches"

    invoke-static {v12, v14}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3416
    move/from16 v12, v20

    .local v12, "i":I
    :goto_f0b
    iget-object v14, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v14, v14, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v14}, Landroid/util/ArrayMap;->size()I

    move-result v14

    if-ge v12, v14, :cond_f3b

    .line 3417
    iget-object v14, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v14, v14, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v14, v12}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Lcom/android/server/pm/PackageSetting;

    .line 3418
    .local v14, "ps":Lcom/android/server/pm/PackageSetting;
    sget-object v15, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    iget-object v13, v14, Lcom/android/server/pm/PackageSetting;->volumeUuid:Ljava/lang/String;

    invoke-static {v15, v13}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v13

    if-eqz v13, :cond_f34

    .line 3420
    iget-object v13, v14, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    const/16 v15, 0x27

    move/from16 v17, v1

    const/4 v1, -0x1

    .end local v1  # "scanFlags":I
    .local v17, "scanFlags":I
    invoke-direct {v6, v13, v1, v15}, Lcom/android/server/pm/PackageManagerService;->clearAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    goto :goto_f36

    .line 3418
    .end local v17  # "scanFlags":I
    .restart local v1  # "scanFlags":I
    :cond_f34
    move/from16 v17, v1

    .line 3416
    .end local v1  # "scanFlags":I
    .end local v14  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v17  # "scanFlags":I
    :goto_f36
    add-int/lit8 v12, v12, 0x1

    move/from16 v1, v17

    goto :goto_f0b

    .end local v17  # "scanFlags":I
    .restart local v1  # "scanFlags":I
    :cond_f3b
    move/from16 v17, v1

    .line 3425
    .end local v1  # "scanFlags":I
    .end local v12  # "i":I
    .restart local v17  # "scanFlags":I
    sget-object v1, Landroid/os/Build;->FINGERPRINT:Ljava/lang/String;

    iput-object v1, v2, Lcom/android/server/pm/Settings$VersionInfo;->fingerprint:Ljava/lang/String;

    .line 3427
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    sget-object v12, Landroid/os/Build;->MEIZU_FINGERPRINT:Ljava/lang/String;

    invoke-virtual {v1, v12}, Lcom/android/server/pm/Settings;->updateMeizuFingerprint(Ljava/lang/String;)V

    goto :goto_f4b

    .line 3414
    .end local v17  # "scanFlags":I
    .restart local v1  # "scanFlags":I
    :cond_f49
    move/from16 v17, v1

    .line 3433
    .end local v1  # "scanFlags":I
    .restart local v17  # "scanFlags":I
    :goto_f4b
    if-nez p4, :cond_f85

    iget-boolean v1, v6, Lcom/android/server/pm/PackageManagerService;->mIsPreQUpgrade:Z

    if-eqz v1, :cond_f85

    .line 3434
    const-string v1, "PackageManager"

    const-string v12, "Whitelisting all existing apps to hide their icons"

    invoke-static {v1, v12}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3435
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/util/ArrayMap;->size()I

    move-result v1

    .line 3436
    .local v1, "size":I
    const/4 v12, 0x0

    .restart local v12  # "i":I
    :goto_f61
    if-ge v12, v1, :cond_f82

    .line 3437
    iget-object v13, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v13, v13, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v13, v12}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/pm/PackageSetting;

    .line 3438
    .local v13, "ps":Lcom/android/server/pm/PackageSetting;
    iget v14, v13, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    const/4 v15, 0x1

    and-int/2addr v14, v15

    if-eqz v14, :cond_f76

    .line 3439
    move/from16 v15, v20

    goto :goto_f7d

    .line 3441
    :cond_f76
    sget-object v14, Landroid/content/pm/PackageManager;->APP_DETAILS_ACTIVITY_CLASS_NAME:Ljava/lang/String;

    move/from16 v15, v20

    invoke-virtual {v13, v14, v15}, Lcom/android/server/pm/PackageSetting;->disableComponentLPw(Ljava/lang/String;I)Z

    .line 3436
    .end local v13  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_f7d
    add-int/lit8 v12, v12, 0x1

    move/from16 v20, v15

    goto :goto_f61

    :cond_f82
    move/from16 v15, v20

    goto :goto_f87

    .line 3433
    .end local v1  # "size":I
    .end local v12  # "i":I
    :cond_f85
    move/from16 v15, v20

    .line 3446
    :goto_f87
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    const-string v12, "com.meizu.privacy"

    invoke-virtual {v1, v12}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 3447
    .local v1, "packageSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_fbf

    iget v12, v1, Lcom/android/server/pm/PackageSetting;->appId:I

    const/16 v13, 0x2710

    if-ge v12, v13, :cond_fbf

    .line 3448
    const-string v12, "PackageManager"

    const-string v13, "deletePackage com.meizu.privacy for O,P update to Q"

    invoke-static {v12, v13}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3449
    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v12, v12, Lcom/android/server/pm/Settings;->mSharedUsers:Landroid/util/ArrayMap;

    iget-object v13, v1, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v13, v13, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    invoke-virtual {v12, v13}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 3450
    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v12, v12, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v13, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v13, v13, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v12, v13}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 3451
    iget-object v12, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    const/4 v13, 0x7

    const/4 v14, -0x1

    invoke-direct {v6, v12, v14, v13}, Lcom/android/server/pm/PackageManagerService;->destroyAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 3455
    :cond_fbf
    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mExistingSystemPackages:Landroid/util/ArraySet;

    invoke-virtual {v12}, Landroid/util/ArraySet;->clear()V

    .line 3456
    iput-boolean v15, v6, Lcom/android/server/pm/PackageManagerService;->mPromoteSystemApps:Z

    .line 3459
    move/from16 v12, v29

    iput v12, v2, Lcom/android/server/pm/Settings$VersionInfo;->databaseVersion:I

    .line 3462
    const-string/jumbo v12, "write settings"

    const-wide/32 v13, 0x40000

    invoke-static {v13, v14, v12}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 3464
    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v12}, Lcom/android/server/pm/Settings;->removeSystemMultiApp()V

    .line 3466
    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v12}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 3467
    invoke-static {v13, v14}, Landroid/os/Trace;->traceEnd(J)V

    .line 3469
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->initDefaultOpService()V

    .line 3473
    const-string v12, "Android:PMS_READY"

    invoke-direct {v6, v12}, Lcom/android/server/pm/PackageManagerService;->addBootEvent(Ljava/lang/String;)V

    .line 3476
    const/16 v12, 0xc1c

    .line 3477
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v13

    .line 3476
    invoke-static {v12, v13, v14}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 3479
    iget-boolean v12, v6, Lcom/android/server/pm/PackageManagerService;->mOnlyCore:Z

    if-nez v12, :cond_1039

    .line 3480
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getRequiredButNotReallyRequiredVerifierLPr()Ljava/lang/String;

    move-result-object v12

    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    .line 3481
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getOptionalVerifierLPr()Ljava/lang/String;

    move-result-object v12

    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mOptionalVerifierPackage:Ljava/lang/String;

    .line 3482
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getRequiredInstallerLPr()Ljava/lang/String;

    move-result-object v12

    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    .line 3483
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getRequiredUninstallerLPr()Ljava/lang/String;

    move-result-object v12

    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mRequiredUninstallerPackage:Ljava/lang/String;

    .line 3484
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getIntentFilterVerifierComponentNameLPr()Landroid/content/ComponentName;

    move-result-object v12

    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifierComponent:Landroid/content/ComponentName;

    .line 3485
    iget-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifierComponent:Landroid/content/ComponentName;

    if-eqz v12, :cond_1024

    .line 3486
    new-instance v12, Lcom/android/server/pm/PackageManagerService$IntentVerifierProxy;

    iget-object v13, v6, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    iget-object v14, v6, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifierComponent:Landroid/content/ComponentName;

    invoke-direct {v12, v6, v13, v14}, Lcom/android/server/pm/PackageManagerService$IntentVerifierProxy;-><init>(Lcom/android/server/pm/PackageManagerService;Landroid/content/Context;Landroid/content/ComponentName;)V

    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifier:Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;

    const/4 v12, 0x0

    goto :goto_1027

    .line 3489
    :cond_1024
    const/4 v12, 0x0

    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifier:Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;

    .line 3491
    :goto_1027
    const-string v13, "android.ext.services"

    const/4 v14, -0x1

    invoke-direct {v6, v13, v14}, Lcom/android/server/pm/PackageManagerService;->getRequiredSharedLibraryLPr(Ljava/lang/String;I)Ljava/lang/String;

    move-result-object v13

    iput-object v13, v6, Lcom/android/server/pm/PackageManagerService;->mServicesSystemSharedLibraryPackageName:Ljava/lang/String;

    .line 3494
    const-string v13, "android.ext.shared"

    invoke-direct {v6, v13, v14}, Lcom/android/server/pm/PackageManagerService;->getRequiredSharedLibraryLPr(Ljava/lang/String;I)Ljava/lang/String;

    move-result-object v13

    iput-object v13, v6, Lcom/android/server/pm/PackageManagerService;->mSharedSystemSharedLibraryPackageName:Ljava/lang/String;

    goto :goto_104a

    .line 3498
    :cond_1039
    const/4 v12, 0x0

    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    .line 3499
    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mOptionalVerifierPackage:Ljava/lang/String;

    .line 3500
    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    .line 3501
    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mRequiredUninstallerPackage:Ljava/lang/String;

    .line 3502
    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifierComponent:Landroid/content/ComponentName;

    .line 3503
    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifier:Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;

    .line 3504
    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mServicesSystemSharedLibraryPackageName:Ljava/lang/String;

    .line 3505
    iput-object v12, v6, Lcom/android/server/pm/PackageManagerService;->mSharedSystemSharedLibraryPackageName:Ljava/lang/String;

    .line 3509
    :goto_104a
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getRequiredPermissionControllerLPr()Ljava/lang/String;

    move-result-object v13

    iput-object v13, v6, Lcom/android/server/pm/PackageManagerService;->mRequiredPermissionControllerPackage:Ljava/lang/String;

    .line 3512
    invoke-static {}, Lcom/android/server/pm/UserManagerService;->getInstance()Lcom/android/server/pm/UserManagerService;

    move-result-object v13

    invoke-virtual {v13}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v13

    .line 3513
    .local v13, "userIds":[I
    iget-object v14, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v14}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v14

    invoke-interface {v14}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v14

    :goto_1062
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v16

    if-eqz v16, :cond_10cf

    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Landroid/content/pm/PackageParser$Package;

    move-object/from16 v20, v16

    .line 3514
    .local v20, "pkg":Landroid/content/pm/PackageParser$Package;
    invoke-virtual/range {v20 .. v20}, Landroid/content/pm/PackageParser$Package;->isSystem()Z

    move-result v16

    if-eqz v16, :cond_1077

    .line 3515
    goto :goto_1062

    .line 3517
    :cond_1077
    array-length v15, v13

    const/4 v12, 0x0

    :goto_1079
    if-ge v12, v15, :cond_10c4

    aget v29, v13, v12

    move/from16 v33, v29

    .line 3518
    .local v33, "userId":I
    move-object/from16 v29, v1

    move-object/from16 v50, v2

    move-object/from16 v1, v20

    .end local v2  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v20  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    .local v29, "packageSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    iget-object v2, v1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 3519
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v2, :cond_10b1

    move-object/from16 v20, v1

    move/from16 v1, v33

    .end local v33  # "userId":I
    .local v1, "userId":I
    .restart local v20  # "pkg":Landroid/content/pm/PackageParser$Package;
    invoke-virtual {v2, v1}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v33

    if-eqz v33, :cond_10ac

    invoke-virtual {v2, v1}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v33

    if-nez v33, :cond_10a0

    .line 3520
    move-object/from16 v52, v3

    move/from16 v33, v4

    goto :goto_10b9

    .line 3522
    :cond_10a0
    move-object/from16 v52, v3

    .end local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    iget-object v3, v6, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    move/from16 v33, v4

    .end local v4  # "cachedSystemApps":I
    .local v33, "cachedSystemApps":I
    iget v4, v2, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-virtual {v3, v1, v4}, Lcom/android/server/pm/InstantAppRegistry;->addInstantAppLPw(II)V

    goto :goto_10b9

    .line 3519
    .end local v33  # "cachedSystemApps":I
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v4  # "cachedSystemApps":I
    :cond_10ac
    move-object/from16 v52, v3

    move/from16 v33, v4

    .end local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v4  # "cachedSystemApps":I
    .restart local v33  # "cachedSystemApps":I
    .restart local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    goto :goto_10b9

    .end local v20  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v4  # "cachedSystemApps":I
    .local v33, "userId":I
    :cond_10b1
    move-object/from16 v20, v1

    move-object/from16 v52, v3

    move/from16 v1, v33

    move/from16 v33, v4

    .line 3517
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v4  # "cachedSystemApps":I
    .restart local v20  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v33, "cachedSystemApps":I
    .restart local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :goto_10b9
    add-int/lit8 v12, v12, 0x1

    move-object/from16 v1, v29

    move/from16 v4, v33

    move-object/from16 v2, v50

    move-object/from16 v3, v52

    goto :goto_1079

    .end local v29  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v33  # "cachedSystemApps":I
    .end local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v1, "packageSetting":Lcom/android/server/pm/PackageSetting;
    .local v2, "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .restart local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v4  # "cachedSystemApps":I
    :cond_10c4
    move-object/from16 v29, v1

    move-object/from16 v50, v2

    move-object/from16 v52, v3

    move/from16 v33, v4

    .line 3524
    .end local v1  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v2  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v4  # "cachedSystemApps":I
    .end local v20  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v29  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v33  # "cachedSystemApps":I
    .restart local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .restart local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    const/4 v12, 0x0

    const/4 v15, 0x0

    goto :goto_1062

    .line 3526
    .end local v29  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v33  # "cachedSystemApps":I
    .end local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v1  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v2  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .restart local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v4  # "cachedSystemApps":I
    :cond_10cf
    move-object/from16 v29, v1

    move-object/from16 v50, v2

    move-object/from16 v52, v3

    move/from16 v33, v4

    .end local v1  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v2  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v3  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v4  # "cachedSystemApps":I
    .restart local v29  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v33  # "cachedSystemApps":I
    .restart local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .restart local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    new-instance v1, Lcom/android/server/pm/PackageInstallerService;

    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;
    :try_end_10db
    .catchall {:try_start_e15 .. :try_end_10db} :catchall_11b1

    move-object/from16 v3, p1

    :try_start_10dd
    invoke-direct {v1, v3, v6, v2}, Lcom/android/server/pm/PackageInstallerService;-><init>(Landroid/content/Context;Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/ApexManager;)V

    iput-object v1, v6, Lcom/android/server/pm/PackageManagerService;->mInstallerService:Lcom/android/server/pm/PackageInstallerService;

    .line 3527
    nop

    .line 3528
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppResolverLPr()Landroid/util/Pair;

    move-result-object v1

    .line 3529
    .local v1, "instantAppResolverComponent":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    if-eqz v1, :cond_1120

    .line 3530
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v2, :cond_1103

    .line 3531
    const-string v2, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Set ephemeral resolver: "

    invoke-virtual {v4, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v2, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 3533
    :cond_1103
    new-instance v2, Lcom/android/server/pm/InstantAppResolverConnection;

    iget-object v4, v6, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    iget-object v12, v1, Landroid/util/Pair;->first:Ljava/lang/Object;

    check-cast v12, Landroid/content/ComponentName;

    iget-object v14, v1, Landroid/util/Pair;->second:Ljava/lang/Object;

    check-cast v14, Ljava/lang/String;

    invoke-direct {v2, v4, v12, v14}, Lcom/android/server/pm/InstantAppResolverConnection;-><init>(Landroid/content/Context;Landroid/content/ComponentName;Ljava/lang/String;)V

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mInstantAppResolverConnection:Lcom/android/server/pm/InstantAppResolverConnection;

    .line 3536
    iget-object v2, v1, Landroid/util/Pair;->first:Ljava/lang/Object;

    check-cast v2, Landroid/content/ComponentName;

    .line 3537
    invoke-direct {v6, v2}, Lcom/android/server/pm/PackageManagerService;->getInstantAppResolverSettingsLPr(Landroid/content/ComponentName;)Landroid/content/ComponentName;

    move-result-object v2

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mInstantAppResolverSettingsComponent:Landroid/content/ComponentName;

    const/4 v2, 0x0

    goto :goto_1125

    .line 3539
    :cond_1120
    const/4 v2, 0x0

    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mInstantAppResolverConnection:Lcom/android/server/pm/InstantAppResolverConnection;

    .line 3540
    iput-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mInstantAppResolverSettingsComponent:Landroid/content/ComponentName;

    .line 3542
    :goto_1125
    invoke-direct {v6, v2}, Lcom/android/server/pm/PackageManagerService;->updateInstantAppInstallerLocked(Ljava/lang/String;)V

    .line 3552
    new-instance v2, Ljava/util/HashMap;

    invoke-direct {v2}, Ljava/util/HashMap;-><init>()V

    .line 3553
    .local v2, "userPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/Integer;Ljava/util/List<Landroid/content/pm/PackageInfo;>;>;"
    array-length v4, v13

    const/4 v12, 0x0

    :goto_112f
    if-ge v12, v4, :cond_114b

    aget v14, v13, v12

    .line 3554
    .local v14, "userId":I
    invoke-static {v14}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v15

    move-object/from16 v20, v1

    const/4 v1, 0x0

    .end local v1  # "instantAppResolverComponent":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    .local v20, "instantAppResolverComponent":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    invoke-virtual {v6, v1, v14}, Lcom/android/server/pm/PackageManagerService;->getInstalledPackages(II)Landroid/content/pm/ParceledListSlice;

    move-result-object v16

    invoke-virtual/range {v16 .. v16}, Landroid/content/pm/ParceledListSlice;->getList()Ljava/util/List;

    move-result-object v1

    invoke-interface {v2, v15, v1}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 3553
    nop

    .end local v14  # "userId":I
    add-int/lit8 v12, v12, 0x1

    move-object/from16 v1, v20

    goto :goto_112f

    .line 3556
    .end local v20  # "instantAppResolverComponent":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    .restart local v1  # "instantAppResolverComponent":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    :cond_114b
    move-object/from16 v20, v1

    .end local v1  # "instantAppResolverComponent":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    .restart local v20  # "instantAppResolverComponent":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    invoke-virtual {v1, v2}, Lcom/android/server/pm/dex/DexManager;->load(Ljava/util/Map;)V

    .line 3557
    iget-boolean v1, v6, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z

    if-eqz v1, :cond_1164

    .line 3558
    const-string/jumbo v1, "ota_package_manager_init_time"

    .line 3559
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v14

    sub-long v14, v14, v43

    long-to-int v4, v14

    .line 3558
    const/4 v12, 0x0

    invoke-static {v12, v1, v4}, Lcom/android/internal/logging/MetricsLogger;->histogram(Landroid/content/Context;Ljava/lang/String;I)V

    .line 3561
    .end local v2  # "userPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/Integer;Ljava/util/List<Landroid/content/pm/PackageInfo;>;>;"
    .end local v5  # "sdkUpdated":Z
    .end local v7  # "storageFlags":I
    .end local v8  # "systemScanTime":J
    .end local v10  # "productServicesAppDir":Ljava/io/File;
    .end local v11  # "deferPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v13  # "userIds":[I
    .end local v17  # "scanFlags":I
    .end local v19  # "packageSettingCount":I
    .end local v20  # "instantAppResolverComponent":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    .end local v22  # "mzAppDir":Ljava/io/File;
    .end local v23  # "frameworkDir":Ljava/io/File;
    .end local v24  # "builtInLibCount":I
    .end local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .end local v26  # "customResolverActivityName":Ljava/lang/String;
    .end local v27  # "bootClassPath":Ljava/lang/String;
    .end local v28  # "systemServerClassPath":Ljava/lang/String;
    .end local v29  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v30  # "preUpgradeSdkVersion":I
    .end local v31  # "undefinedVersion":J
    .end local v33  # "cachedSystemApps":I
    .end local v38  # "meizuFingerprint":Ljava/lang/String;
    .end local v43  # "startTime":J
    .end local v45  # "systemPackagesCount":I
    .end local v46  # "privilegedVendorAppDir":Ljava/io/File;
    .end local v47  # "vendorAppDir":Ljava/io/File;
    .end local v48  # "possiblyDeletedUpdatedSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v49  # "oemAppDir":Ljava/io/File;
    .end local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v51  # "vendorMzAppDir":Ljava/io/File;
    .end local v52  # "stubSystemApps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v53  # "privilegedProductAppDir":Ljava/io/File;
    .end local v54  # "privilegedProductServicesAppDir":Ljava/io/File;
    .end local v55  # "privilegedOdmAppDir":Ljava/io/File;
    .end local v56  # "productAppDir":Ljava/io/File;
    .end local v57  # "privilegedAppDir":Ljava/io/File;
    .end local v58  # "systemAppDir":Ljava/io/File;
    .end local v59  # "odmAppDir":Ljava/io/File;
    :cond_1164
    monitor-exit v39
    :try_end_1165
    .catchall {:try_start_10dd .. :try_end_1165} :catchall_11df

    .line 3562
    :try_start_1165
    monitor-exit v35
    :try_end_1166
    .catchall {:try_start_1165 .. :try_end_1166} :catchall_11ee

    .line 3564
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 3565
    :try_start_1169
    const-string v2, "PackageManager"

    iget-object v4, v6, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-static {v2, v4}, Lcom/android/server/pm/SetupPackageHandler;->initValueFromSettingsLocked(Ljava/lang/String;Lcom/android/server/pm/Settings;)V

    .line 3566
    monitor-exit v1
    :try_end_1171
    .catchall {:try_start_1169 .. :try_end_1171} :catchall_11ad

    .line 3568
    new-instance v1, Lcom/android/server/pm/ModuleInfoProvider;

    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-direct {v1, v2, v6}, Lcom/android/server/pm/ModuleInfoProvider;-><init>(Landroid/content/Context;Landroid/content/pm/IPackageManager;)V

    iput-object v1, v6, Lcom/android/server/pm/PackageManagerService;->mModuleInfoProvider:Lcom/android/server/pm/ModuleInfoProvider;

    .line 3573
    const-string v1, "GC"

    const-wide/32 v4, 0x40000

    invoke-static {v4, v5, v1}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 3574
    invoke-static {}, Ljava/lang/Runtime;->getRuntime()Ljava/lang/Runtime;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/Runtime;->gc()V

    .line 3575
    invoke-static {v4, v5}, Landroid/os/Trace;->traceEnd(J)V

    .line 3580
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, v2}, Lcom/android/server/pm/Installer;->setWarnIfHeld(Ljava/lang/Object;)V

    .line 3582
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v1

    invoke-static {v1}, Landroid/content/pm/PackageParser;->readConfigUseRoundIcon(Landroid/content/res/Resources;)V

    .line 3584
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    const-wide/32 v4, 0xea60

    add-long/2addr v1, v4

    iput-wide v1, v6, Lcom/android/server/pm/PackageManagerService;->mServiceStartWithDelay:J

    .line 3586
    const-wide/32 v1, 0x40000

    invoke-static {v1, v2}, Landroid/os/Trace;->traceEnd(J)V

    .line 3587
    return-void

    .line 3566
    :catchall_11ad
    move-exception v0

    move-object v2, v0

    :try_start_11af
    monitor-exit v1
    :try_end_11b0
    .catchall {:try_start_11af .. :try_end_11b0} :catchall_11ad

    throw v2

    .line 3561
    :catchall_11b1
    move-exception v0

    move-object/from16 v3, p1

    goto :goto_11e0

    :catchall_11b5
    move-exception v0

    move-object v3, v4

    goto :goto_11e0

    :catchall_11b8
    move-exception v0

    move-object v3, v4

    goto :goto_11cd

    .line 2812
    .local v1, "scanFlags":I
    .local v2, "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .local v8, "frameworkDir":Ljava/io/File;
    .restart local v19  # "packageSettingCount":I
    .restart local v24  # "builtInLibCount":I
    .restart local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .restart local v26  # "customResolverActivityName":Ljava/lang/String;
    .restart local v27  # "bootClassPath":Ljava/lang/String;
    .restart local v28  # "systemServerClassPath":Ljava/lang/String;
    .restart local v30  # "preUpgradeSdkVersion":I
    .restart local v31  # "undefinedVersion":J
    .restart local v38  # "meizuFingerprint":Ljava/lang/String;
    .restart local v43  # "startTime":J
    :cond_11bb
    move/from16 v17, v1

    move-object/from16 v50, v2

    move-object/from16 v23, v8

    move-object v3, v13

    move-object v6, v15

    .end local v1  # "scanFlags":I
    .end local v2  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v8  # "frameworkDir":Ljava/io/File;
    .restart local v17  # "scanFlags":I
    .restart local v23  # "frameworkDir":Ljava/io/File;
    .restart local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    :try_start_11c3
    new-instance v1, Ljava/lang/IllegalStateException;

    const-string v2, "Failed to load frameworks package; check log for warnings"

    invoke-direct {v1, v2}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    .end local v18  # "separateProcesses":Ljava/lang/String;
    .end local v21  # "systemConfig":Lcom/android/server/SystemConfig;
    .end local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "context":Landroid/content/Context;
    .end local p2  # "installer":Lcom/android/server/pm/Installer;
    .end local p3  # "factoryTest":Z
    .end local p4  # "onlyCore":Z
    throw v1

    .line 3561
    .end local v17  # "scanFlags":I
    .end local v19  # "packageSettingCount":I
    .end local v23  # "frameworkDir":Ljava/io/File;
    .end local v24  # "builtInLibCount":I
    .end local v25  # "libConfig":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Lcom/android/server/SystemConfig$SharedLibraryEntry;>;"
    .end local v26  # "customResolverActivityName":Ljava/lang/String;
    .end local v27  # "bootClassPath":Ljava/lang/String;
    .end local v28  # "systemServerClassPath":Ljava/lang/String;
    .end local v30  # "preUpgradeSdkVersion":I
    .end local v31  # "undefinedVersion":J
    .end local v38  # "meizuFingerprint":Ljava/lang/String;
    .end local v43  # "startTime":J
    .end local v50  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .restart local v18  # "separateProcesses":Ljava/lang/String;
    .restart local v21  # "systemConfig":Lcom/android/server/SystemConfig;
    .restart local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "context":Landroid/content/Context;
    .restart local p2  # "installer":Lcom/android/server/pm/Installer;
    .restart local p3  # "factoryTest":Z
    .restart local p4  # "onlyCore":Z
    :catchall_11cb
    move-exception v0

    move-object v3, v13

    :goto_11cd
    move-object v6, v15

    goto :goto_11e0

    .end local v18  # "separateProcesses":Ljava/lang/String;
    .end local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .local v7, "debugOptions":Lcom/android/server/utils/DebugOptions;
    .local v20, "separateProcesses":Ljava/lang/String;
    :catchall_11cf
    move-exception v0

    goto :goto_11d6

    :catchall_11d1
    move-exception v0

    move-object/from16 v35, v5

    move-object/from16 v39, v6

    :goto_11d6
    move-object/from16 v42, v7

    move-object v3, v13

    move-object v6, v15

    move-object/from16 v18, v20

    move-object v1, v0

    .end local v7  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .end local v20  # "separateProcesses":Ljava/lang/String;
    .restart local v18  # "separateProcesses":Ljava/lang/String;
    .restart local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    :goto_11dd
    monitor-exit v39
    :try_end_11de
    .catchall {:try_start_11c3 .. :try_end_11de} :catchall_11df

    .end local v18  # "separateProcesses":Ljava/lang/String;
    .end local v21  # "systemConfig":Lcom/android/server/SystemConfig;
    .end local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "context":Landroid/content/Context;
    .end local p2  # "installer":Lcom/android/server/pm/Installer;
    .end local p3  # "factoryTest":Z
    .end local p4  # "onlyCore":Z
    :try_start_11de
    throw v1

    .restart local v18  # "separateProcesses":Ljava/lang/String;
    .restart local v21  # "systemConfig":Lcom/android/server/SystemConfig;
    .restart local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "context":Landroid/content/Context;
    .restart local p2  # "installer":Lcom/android/server/pm/Installer;
    .restart local p3  # "factoryTest":Z
    .restart local p4  # "onlyCore":Z
    :catchall_11df
    move-exception v0

    :goto_11e0
    move-object v1, v0

    goto :goto_11dd

    .line 3562
    .end local v18  # "separateProcesses":Ljava/lang/String;
    .end local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .restart local v7  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .restart local v20  # "separateProcesses":Ljava/lang/String;
    :catchall_11e2
    move-exception v0

    move-object/from16 v35, v5

    move-object/from16 v42, v7

    move-object v3, v13

    move-object v6, v15

    move-object/from16 v18, v20

    move-object v1, v0

    .end local v7  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .end local v20  # "separateProcesses":Ljava/lang/String;
    .restart local v18  # "separateProcesses":Ljava/lang/String;
    .restart local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    :goto_11ec
    monitor-exit v35
    :try_end_11ed
    .catchall {:try_start_11de .. :try_end_11ed} :catchall_11ee

    throw v1

    :catchall_11ee
    move-exception v0

    move-object v1, v0

    goto :goto_11ec

    .line 2565
    .end local v18  # "separateProcesses":Ljava/lang/String;
    .end local v21  # "systemConfig":Lcom/android/server/SystemConfig;
    .end local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .restart local v7  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    :catchall_11f1
    move-exception v0

    move-object/from16 v42, v7

    move-object v3, v13

    move-object v6, v15

    move-object v4, v0

    .end local v7  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .restart local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    :goto_11f7
    :try_start_11f7
    monitor-exit v2
    :try_end_11f8
    .catchall {:try_start_11f7 .. :try_end_11f8} :catchall_11f9

    .end local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "context":Landroid/content/Context;
    .end local p2  # "installer":Lcom/android/server/pm/Installer;
    .end local p3  # "factoryTest":Z
    .end local p4  # "onlyCore":Z
    :try_start_11f8
    throw v4

    .restart local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "context":Landroid/content/Context;
    .restart local p2  # "installer":Lcom/android/server/pm/Installer;
    .restart local p3  # "factoryTest":Z
    .restart local p4  # "onlyCore":Z
    :catchall_11f9
    move-exception v0

    move-object v4, v0

    goto :goto_11f7

    .line 2566
    .end local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .restart local v7  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    :catchall_11fc
    move-exception v0

    move-object/from16 v42, v7

    move-object v3, v13

    move-object v6, v15

    move-object v2, v0

    .end local v7  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    .restart local v42  # "debugOptions":Lcom/android/server/utils/DebugOptions;
    :goto_1202
    monitor-exit v1
    :try_end_1203
    .catchall {:try_start_11f8 .. :try_end_1203} :catchall_1204

    throw v2

    :catchall_1204
    move-exception v0

    move-object v2, v0

    goto :goto_1202
.end method

.method static synthetic access$000(Lcom/android/server/pm/PackageManagerService;)J
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getVerificationTimeout()J

    move-result-wide v0

    return-wide v0
.end method

.method static synthetic access$100(Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/DeviceIdleController$LocalService;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getDeviceIdleController()Lcom/android/server/DeviceIdleController$LocalService;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$1000(Lcom/android/server/pm/PackageManagerService;Landroid/os/UserHandle;)I
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/os/UserHandle;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getDefaultVerificationResponse(Landroid/os/UserHandle;)I

    move-result v0

    return v0
.end method

.method static synthetic access$1100(Lcom/android/server/pm/PackageManagerService;ILandroid/net/Uri;ILandroid/os/UserHandle;)V
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I
    .param p2, "x2"  # Landroid/net/Uri;
    .param p3, "x3"  # I
    .param p4, "x4"  # Landroid/os/UserHandle;

    .line 447
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->broadcastPackageVerified(ILandroid/net/Uri;ILandroid/os/UserHandle;)V

    return-void
.end method

.method static synthetic access$1200(Lcom/android/server/pm/PackageManagerService;IIZLandroid/content/pm/PackageParser$Package;)V
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I
    .param p2, "x2"  # I
    .param p3, "x3"  # Z
    .param p4, "x4"  # Landroid/content/pm/PackageParser$Package;

    .line 447
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->verifyIntentFiltersIfNeeded(IIZLandroid/content/pm/PackageParser$Package;)V

    return-void
.end method

.method static synthetic access$1300(Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifier:Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;

    return-object v0
.end method

.method static synthetic access$1400(Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mOnPermissionChangeListeners:Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;

    return-object v0
.end method

.method static synthetic access$1500(Lcom/android/server/pm/PackageManagerService;IILjava/lang/String;)V
    .registers 4
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I
    .param p2, "x2"  # I
    .param p3, "x3"  # Ljava/lang/String;

    .line 447
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->killUid(IILjava/lang/String;)V

    return-void
.end method

.method static synthetic access$1600(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;)V
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->reconcileApps(Ljava/lang/String;)V

    return-void
.end method

.method static synthetic access$1700(Lcom/android/server/pm/PackageManagerService;Landroid/os/storage/VolumeInfo;)V
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/os/storage/VolumeInfo;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->loadPrivatePackages(Landroid/os/storage/VolumeInfo;)V

    return-void
.end method

.method static synthetic access$1800(Lcom/android/server/pm/PackageManagerService;Landroid/os/storage/VolumeInfo;)V
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/os/storage/VolumeInfo;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->unloadPrivatePackages(Landroid/os/storage/VolumeInfo;)V

    return-void
.end method

.method static synthetic access$200(Landroid/content/pm/PackageParser$ActivityIntentInfo;)Z
    .registers 2
    .param p0, "x0"  # Landroid/content/pm/PackageParser$ActivityIntentInfo;

    .line 447
    invoke-static {p0}, Lcom/android/server/pm/PackageManagerService;->hasValidDomains(Landroid/content/pm/PackageParser$ActivityIntentInfo;)Z

    move-result v0

    return v0
.end method

.method static synthetic access$2500(Lcom/android/server/pm/PackageManagerService;I)Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->createPackageInstalledInfo(I)Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$2600(Lcom/android/server/pm/PackageManagerService;ZLjava/util/List;)V
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Z
    .param p2, "x2"  # Ljava/util/List;

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->processInstallRequestsAsync(ZLjava/util/List;)V

    return-void
.end method

.method static synthetic access$2700()Z
    .registers 1

    .line 447
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    return v0
.end method

.method static synthetic access$2800(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;II)I
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # I
    .param p3, "x3"  # I

    .line 447
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->fixUpInstallReason(Ljava/lang/String;II)I

    move-result v0

    return v0
.end method

.method static synthetic access$2900(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;)Landroid/content/pm/PackageParser$Package;
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->installBultInMzAppIfNeeded(Ljava/lang/String;)Landroid/content/pm/PackageParser$Package;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$300(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;ZLjava/util/ArrayList;I)V
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # Z
    .param p3, "x3"  # Ljava/util/ArrayList;
    .param p4, "x4"  # I

    .line 447
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->sendPackageChangedBroadcast(Ljava/lang/String;ZLjava/util/ArrayList;I)V

    return-void
.end method

.method static synthetic access$3000(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageInfoLite;)V
    .registers 2
    .param p0, "x0"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "x1"  # Landroid/content/pm/PackageInfoLite;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 447
    invoke-static {p0, p1}, Lcom/android/server/pm/PackageManagerService;->checkDowngrade(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageInfoLite;)V

    return-void
.end method

.method static synthetic access$3100(Landroid/content/pm/PackageParser$Package;)Z
    .registers 2
    .param p0, "x0"  # Landroid/content/pm/PackageParser$Package;

    .line 447
    invoke-static {p0}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    return v0
.end method

.method static synthetic access$3200(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$InstallParams;)Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Lcom/android/server/pm/PackageManagerService$InstallParams;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->createInstallArgs(Lcom/android/server/pm/PackageManagerService$InstallParams;)Lcom/android/server/pm/PackageManagerService$InstallArgs;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$3300(Lcom/android/server/pm/PackageManagerService;III)Z
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I
    .param p2, "x2"  # I
    .param p3, "x3"  # I

    .line 447
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->isVerificationEnabled(III)Z

    move-result v0

    return v0
.end method

.method static synthetic access$3400(Lcom/android/server/pm/PackageManagerService;Landroid/content/Intent;Ljava/lang/String;IIZ)Ljava/util/List;
    .registers 7
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/Intent;
    .param p2, "x2"  # Ljava/lang/String;
    .param p3, "x3"  # I
    .param p4, "x4"  # I
    .param p5, "x5"  # Z

    .line 447
    invoke-direct/range {p0 .. p5}, Lcom/android/server/pm/PackageManagerService;->queryIntentReceiversInternal(Landroid/content/Intent;Ljava/lang/String;IIZ)Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$3500()Z
    .registers 1

    .line 447
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_VERIFY:Z

    return v0
.end method

.method static synthetic access$3608(Lcom/android/server/pm/PackageManagerService;)I
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget v0, p0, Lcom/android/server/pm/PackageManagerService;->mPendingVerificationToken:I

    add-int/lit8 v1, v0, 0x1

    iput v1, p0, Lcom/android/server/pm/PackageManagerService;->mPendingVerificationToken:I

    return v0
.end method

.method static synthetic access$3700(Lcom/android/server/pm/PackageManagerService;Landroid/content/pm/PackageInfoLite;Ljava/util/List;Lcom/android/server/pm/PackageVerificationState;)Ljava/util/List;
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/pm/PackageInfoLite;
    .param p2, "x2"  # Ljava/util/List;
    .param p3, "x3"  # Lcom/android/server/pm/PackageVerificationState;

    .line 447
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->matchVerifiers(Landroid/content/pm/PackageInfoLite;Ljava/util/List;Lcom/android/server/pm/PackageVerificationState;)Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$3800(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;Ljava/util/List;)Landroid/content/ComponentName;
    .registers 4
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # Ljava/util/List;

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->matchComponentForVerifier(Ljava/lang/String;Ljava/util/List;)Landroid/content/ComponentName;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$3908(Lcom/android/server/pm/PackageManagerService;)I
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget v0, p0, Lcom/android/server/pm/PackageManagerService;->mPendingEnableRollbackToken:I

    add-int/lit8 v1, v0, 0x1

    iput v1, p0, Lcom/android/server/pm/PackageManagerService;->mPendingEnableRollbackToken:I

    return v0
.end method

.method static synthetic access$400(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;ZZZ[Ljava/lang/String;Ljava/util/List;ZLjava/lang/String;Landroid/content/pm/IPackageInstallObserver2;)V
    .registers 10
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .param p2, "x2"  # Z
    .param p3, "x3"  # Z
    .param p4, "x4"  # Z
    .param p5, "x5"  # [Ljava/lang/String;
    .param p6, "x6"  # Ljava/util/List;
    .param p7, "x7"  # Z
    .param p8, "x8"  # Ljava/lang/String;
    .param p9, "x9"  # Landroid/content/pm/IPackageInstallObserver2;

    .line 447
    invoke-direct/range {p0 .. p9}, Lcom/android/server/pm/PackageManagerService;->handlePackagePostInstall(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;ZZZ[Ljava/lang/String;Ljava/util/List;ZLjava/lang/String;Landroid/content/pm/IPackageInstallObserver2;)V

    return-void
.end method

.method static synthetic access$4000(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$InstallArgs;I)V
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .param p2, "x2"  # I

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->processPendingInstall(Lcom/android/server/pm/PackageManagerService$InstallArgs;I)V

    return-void
.end method

.method static synthetic access$4100(Lcom/android/server/pm/PackageManagerService;Ljava/io/File;Ljava/lang/String;)Ljava/io/File;
    .registers 4
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/io/File;
    .param p2, "x2"  # Ljava/lang/String;

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->getNextCodePath(Ljava/io/File;Ljava/lang/String;)Ljava/io/File;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$4600()[I
    .registers 1

    .line 447
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    return-object v0
.end method

.method static synthetic access$4900(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;I)Z
    .registers 4
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # I

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->clearApplicationUserDataLIF(Ljava/lang/String;I)Z

    move-result v0

    return v0
.end method

.method static synthetic access$5000(Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/pm/InstantAppRegistry;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    return-object v0
.end method

.method static synthetic access$502(Lcom/android/server/pm/PackageManagerService;Z)Z
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Z

    .line 447
    iput-boolean p1, p0, Lcom/android/server/pm/PackageManagerService;->runningGtsInstall:Z

    return p1
.end method

.method static synthetic access$5100(Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    return-object v0
.end method

.method static synthetic access$5200(Lcom/android/server/pm/PackageManagerService;)Landroid/util/SparseBooleanArray;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mWebInstantAppsDisabled:Landroid/util/SparseBooleanArray;

    return-object v0
.end method

.method static synthetic access$5300(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;IILjava/lang/String;)V
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # I
    .param p3, "x3"  # I
    .param p4, "x4"  # Ljava/lang/String;

    .line 447
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->killApplication(Ljava/lang/String;IILjava/lang/String;)V

    return-void
.end method

.method static synthetic access$5600(Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/pm/PackageManagerService$MoveCallbacks;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    return-object v0
.end method

.method static synthetic access$5700(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;Z)V
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # Z

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->logAppMovedStorage(Ljava/lang/String;Z)V

    return-void
.end method

.method static synthetic access$6000(Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/pm/ModuleInfoProvider;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mModuleInfoProvider:Lcom/android/server/pm/ModuleInfoProvider;

    return-object v0
.end method

.method static synthetic access$602(Lcom/android/server/pm/PackageManagerService;Z)Z
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Z

    .line 447
    iput-boolean p1, p0, Lcom/android/server/pm/PackageManagerService;->runningGtsPermission:Z

    return p1
.end method

.method static synthetic access$6100(Lcom/android/server/pm/PackageManagerService;III)Ljava/util/List;
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I
    .param p2, "x2"  # I
    .param p3, "x3"  # I

    .line 447
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->getInstalledApplicationsListInternal(III)Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$6200(Lcom/android/server/pm/PackageManagerService;I)Ljava/lang/String;
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$6300(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageSetting;II)Z
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "x2"  # I
    .param p3, "x3"  # I

    .line 447
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v0

    return v0
.end method

.method static synthetic access$6400(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;J)Ljava/lang/String;
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # J

    .line 447
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->resolveInternalPackageNameLPr(Ljava/lang/String;J)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$6500(Lcom/android/server/pm/PackageManagerService;)Landroid/util/ArraySet;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    return-object v0
.end method

.method static synthetic access$6600(Lcom/android/server/pm/PackageManagerService;)Ljava/util/List;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mKeepUninstalledPackages:Ljava/util/List;

    return-object v0
.end method

.method static synthetic access$6602(Lcom/android/server/pm/PackageManagerService;Ljava/util/List;)Ljava/util/List;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/util/List;

    .line 447
    iput-object p1, p0, Lcom/android/server/pm/PackageManagerService;->mKeepUninstalledPackages:Ljava/util/List;

    return-object p1
.end method

.method static synthetic access$6700(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;)V
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->deletePackageIfUnusedLPr(Ljava/lang/String;)V

    return-void
.end method

.method static synthetic access$6800(Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/pm/permission/PermissionManagerServiceInternal;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    return-object v0
.end method

.method static synthetic access$6900(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;JIII)Landroid/content/pm/PackageInfo;
    .registers 8
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # J
    .param p4, "x3"  # I
    .param p5, "x4"  # I
    .param p6, "x5"  # I

    .line 447
    invoke-direct/range {p0 .. p6}, Lcom/android/server/pm/PackageManagerService;->getPackageInfoInternal(Ljava/lang/String;JIII)Landroid/content/pm/PackageInfo;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$700(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;)V
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->notifyInstallObserver(Ljava/lang/String;)V

    return-void
.end method

.method static synthetic access$7000(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;III)Landroid/content/pm/ApplicationInfo;
    .registers 6
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # I
    .param p3, "x3"  # I
    .param p4, "x4"  # I

    .line 447
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->getApplicationInfoInternal(Ljava/lang/String;III)Landroid/content/pm/ApplicationInfo;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$7100(Lcom/android/server/pm/PackageManagerService;Landroid/content/ComponentName;III)Landroid/content/pm/ActivityInfo;
    .registers 6
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/ComponentName;
    .param p2, "x2"  # I
    .param p3, "x3"  # I
    .param p4, "x4"  # I

    .line 447
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->getActivityInfoInternal(Landroid/content/ComponentName;III)Landroid/content/pm/ActivityInfo;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$7200(Lcom/android/server/pm/PackageManagerService;Landroid/content/Intent;Ljava/lang/String;IIIZZ)Ljava/util/List;
    .registers 9
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/Intent;
    .param p2, "x2"  # Ljava/lang/String;
    .param p3, "x3"  # I
    .param p4, "x4"  # I
    .param p5, "x5"  # I
    .param p6, "x6"  # Z
    .param p7, "x7"  # Z

    .line 447
    invoke-direct/range {p0 .. p7}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZZ)Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$7300(Lcom/android/server/pm/PackageManagerService;Landroid/content/Intent;Ljava/lang/String;IIIZ)Ljava/util/List;
    .registers 8
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/Intent;
    .param p2, "x2"  # Ljava/lang/String;
    .param p3, "x3"  # I
    .param p4, "x4"  # I
    .param p5, "x5"  # I
    .param p6, "x6"  # Z

    .line 447
    invoke-direct/range {p0 .. p6}, Lcom/android/server/pm/PackageManagerService;->queryIntentServicesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZ)Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$7400(Lcom/android/server/pm/PackageManagerService;I)Landroid/content/ComponentName;
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getDefaultHomeActivity(I)Landroid/content/ComponentName;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$7500(Lcom/android/server/pm/PackageManagerService;I)Z
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->userNeedsBadging(I)Z

    move-result v0

    return v0
.end method

.method static synthetic access$7600(Lcom/android/server/pm/PackageManagerService;Landroid/content/pm/AuxiliaryResolveInfo;Landroid/content/Intent;Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;I)V
    .registers 7
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/pm/AuxiliaryResolveInfo;
    .param p2, "x2"  # Landroid/content/Intent;
    .param p3, "x3"  # Ljava/lang/String;
    .param p4, "x4"  # Ljava/lang/String;
    .param p5, "x5"  # Landroid/os/Bundle;
    .param p6, "x6"  # I

    .line 447
    invoke-direct/range {p0 .. p6}, Lcom/android/server/pm/PackageManagerService;->requestInstantAppResolutionPhaseTwo(Landroid/content/pm/AuxiliaryResolveInfo;Landroid/content/Intent;Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;I)V

    return-void
.end method

.method static synthetic access$7700(Lcom/android/server/pm/PackageManagerService;)Landroid/util/ArraySet;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mExistingSystemPackages:Landroid/util/ArraySet;

    return-object v0
.end method

.method static synthetic access$7800(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "x2"  # I
    .param p3, "x3"  # I

    .line 447
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$7900(Lcom/android/server/pm/PackageManagerService;Landroid/content/Intent;Ljava/lang/String;IIZI)Landroid/content/pm/ResolveInfo;
    .registers 8
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/Intent;
    .param p2, "x2"  # Ljava/lang/String;
    .param p3, "x3"  # I
    .param p4, "x4"  # I
    .param p5, "x5"  # Z
    .param p6, "x6"  # I

    .line 447
    invoke-direct/range {p0 .. p6}, Lcom/android/server/pm/PackageManagerService;->resolveIntentInternal(Landroid/content/Intent;Ljava/lang/String;IIZI)Landroid/content/pm/ResolveInfo;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$800(Lcom/android/server/pm/PackageManagerService;)Landroid/util/ArraySet;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDirtyUsers:Landroid/util/ArraySet;

    return-object v0
.end method

.method static synthetic access$8000(Lcom/android/server/pm/PackageManagerService;Landroid/content/Intent;Ljava/lang/String;III)Landroid/content/pm/ResolveInfo;
    .registers 7
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/Intent;
    .param p2, "x2"  # Ljava/lang/String;
    .param p3, "x3"  # I
    .param p4, "x4"  # I
    .param p5, "x5"  # I

    .line 447
    invoke-direct/range {p0 .. p5}, Lcom/android/server/pm/PackageManagerService;->resolveServiceInternal(Landroid/content/Intent;Ljava/lang/String;III)Landroid/content/pm/ResolveInfo;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$8100(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;II)Landroid/content/pm/ProviderInfo;
    .registers 5
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # I
    .param p3, "x3"  # I

    .line 447
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->resolveContentProviderInternal(Ljava/lang/String;II)Landroid/content/pm/ProviderInfo;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$8200(Lcom/android/server/pm/PackageManagerService;I)I
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getUidTargetSdkVersionLockedLPr(I)I

    move-result v0

    return v0
.end method

.method static synthetic access$8300(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;)I
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getPackageTargetSdkVersionLockedLPr(Ljava/lang/String;)I

    move-result v0

    return v0
.end method

.method static synthetic access$8400(Lcom/android/server/pm/PackageManagerService;II)Z
    .registers 4
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I
    .param p2, "x2"  # I

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v0

    return v0
.end method

.method static synthetic access$8500(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z
    .registers 7
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "x2"  # I
    .param p3, "x3"  # Landroid/content/ComponentName;
    .param p4, "x4"  # I
    .param p5, "x5"  # I

    .line 447
    invoke-direct/range {p0 .. p5}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v0

    return v0
.end method

.method static synthetic access$8600(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;I)V
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # I

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->notifyPackageUseLocked(Ljava/lang/String;I)V

    return-void
.end method

.method static synthetic access$8700(Lcom/android/server/pm/PackageManagerService;)Landroid/util/SparseArray;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getAppsWithSharedUserIdsLocked()Landroid/util/SparseArray;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$8800(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;)Ljava/lang/String;
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;

    .line 447
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getSharedUserIdForPackageLocked(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$8900(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;I)[Ljava/lang/String;
    .registers 4
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Ljava/lang/String;
    .param p2, "x2"  # I

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->getPackagesForSharedUserIdLocked(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method static synthetic access$9000(Lcom/android/server/pm/PackageManagerService;II)V
    .registers 3
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # I
    .param p2, "x2"  # I

    .line 447
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->setEnableRollbackCode(II)V

    return-void
.end method

.method static synthetic access$9102(Lcom/android/server/pm/PackageManagerService;Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;)Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;

    .line 447
    iput-object p1, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultBrowserProvider:Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;

    return-object p1
.end method

.method static synthetic access$9202(Lcom/android/server/pm/PackageManagerService;Landroid/content/pm/PackageManagerInternal$DefaultDialerProvider;)Landroid/content/pm/PackageManagerInternal$DefaultDialerProvider;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/pm/PackageManagerInternal$DefaultDialerProvider;

    .line 447
    iput-object p1, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultDialerProvider:Landroid/content/pm/PackageManagerInternal$DefaultDialerProvider;

    return-object p1
.end method

.method static synthetic access$9302(Lcom/android/server/pm/PackageManagerService;Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;)Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;
    .param p1, "x1"  # Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;

    .line 447
    iput-object p1, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultHomeProvider:Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;

    return-object p1
.end method

.method static synthetic access$9400(Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/pm/ApexManager;
    .registers 2
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    return-object v0
.end method

.method static synthetic access$9500(Lcom/android/server/pm/PackageManagerService;)V
    .registers 1
    .param p0, "x0"  # Lcom/android/server/pm/PackageManagerService;

    .line 447
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->capturePerformLog()V

    return-void
.end method

.method private acquireUxPerfLock(ILjava/lang/String;I)V
    .registers 6
    .param p1, "opcode"  # I
    .param p2, "pkgName"  # Ljava/lang/String;
    .param p3, "dat"  # I

    .line 19605
    new-instance v0, Landroid/util/BoostFramework;

    invoke-direct {v0}, Landroid/util/BoostFramework;-><init>()V

    .line 19606
    .local v0, "ux_perf":Landroid/util/BoostFramework;
    nop

    .line 19607
    const/4 v1, 0x0

    invoke-virtual {v0, p1, v1, p2, p3}, Landroid/util/BoostFramework;->perfUXEngine_events(IILjava/lang/String;I)I

    .line 19609
    return-void
.end method

.method private addBootEvent(Ljava/lang/String;)V
    .registers 5
    .param p1, "bootevent"  # Ljava/lang/String;

    .line 2503
    const-string v0, "BOOTPROF"

    iget-boolean v1, p0, Lcom/android/server/pm/PackageManagerService;->mBootProfDisable:Z

    if-eqz v1, :cond_7

    .line 2504
    return-void

    .line 2508
    :cond_7
    :try_start_7
    new-instance v1, Ljava/io/FileOutputStream;

    const-string v2, "/sys/bootprof/bootprof"

    invoke-direct {v1, v2}, Ljava/io/FileOutputStream;-><init>(Ljava/lang/String;)V

    .line 2509
    .local v1, "fbp":Ljava/io/FileOutputStream;
    invoke-virtual {p1}, Ljava/lang/String;->getBytes()[B

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/io/FileOutputStream;->write([B)V

    .line 2510
    invoke-virtual {v1}, Ljava/io/FileOutputStream;->flush()V

    .line 2511
    invoke-virtual {v1}, Ljava/io/FileOutputStream;->close()V
    :try_end_1b
    .catch Ljava/io/FileNotFoundException; {:try_start_7 .. :try_end_1b} :catch_23
    .catch Ljava/io/IOException; {:try_start_7 .. :try_end_1b} :catch_1c

    .end local v1  # "fbp":Ljava/io/FileOutputStream;
    goto :goto_29

    .line 2514
    :catch_1c
    move-exception v1

    .line 2515
    .local v1, "e":Ljava/io/IOException;
    const-string v2, "Failure open /sys/bootprof/bootprof entry"

    invoke-static {v0, v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_2a

    .line 2512
    .end local v1  # "e":Ljava/io/IOException;
    :catch_23
    move-exception v1

    .line 2513
    .local v1, "e":Ljava/io/FileNotFoundException;
    const-string v2, "Failure open /sys/bootprof/bootprof, not found!"

    invoke-static {v0, v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2516
    .end local v1  # "e":Ljava/io/FileNotFoundException;
    :goto_29
    nop

    .line 2517
    :goto_2a
    return-void
.end method

.method private addBuiltInSharedLibraryLocked(Ljava/lang/String;Ljava/lang/String;)Z
    .registers 15
    .param p1, "path"  # Ljava/lang/String;
    .param p2, "name"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 12570
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->nonStaticSharedLibExistsLocked(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_8

    .line 12571
    const/4 v0, 0x0

    return v0

    .line 12574
    :cond_8
    new-instance v0, Landroid/content/pm/SharedLibraryInfo;

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-wide/16 v6, -0x1

    const/4 v8, 0x0

    new-instance v9, Landroid/content/pm/VersionedPackage;

    const-wide/16 v1, 0x0

    const-string v5, "android"

    invoke-direct {v9, v5, v1, v2}, Landroid/content/pm/VersionedPackage;-><init>(Ljava/lang/String;J)V

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object v1, v0

    move-object v2, p1

    move-object v5, p2

    invoke-direct/range {v1 .. v11}, Landroid/content/pm/SharedLibraryInfo;-><init>(Ljava/lang/String;Ljava/lang/String;Ljava/util/List;Ljava/lang/String;JILandroid/content/pm/VersionedPackage;Ljava/util/List;Ljava/util/List;)V

    .line 12579
    .local v0, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->commitSharedLibraryInfoLocked(Landroid/content/pm/SharedLibraryInfo;)V

    .line 12580
    const/4 v1, 0x1

    return v1
.end method

.method private addDynamicPermission(Landroid/content/pm/PermissionInfo;Z)Z
    .registers 6
    .param p1, "info"  # Landroid/content/pm/PermissionInfo;
    .param p2, "async"  # Z

    .line 5953
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 5954
    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v1

    new-instance v2, Lcom/android/server/pm/PackageManagerService$3;

    invoke-direct {v2, p0, p2}, Lcom/android/server/pm/PackageManagerService$3;-><init>(Lcom/android/server/pm/PackageManagerService;Z)V

    .line 5953
    invoke-virtual {v0, p1, p2, v1, v2}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->addDynamicPermission(Landroid/content/pm/PermissionInfo;ZILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)Z

    move-result v0

    return v0
.end method

.method private addForInitLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;
    .registers 45
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .param p4, "currentTime"  # J
    .param p6, "user"  # Landroid/os/UserHandle;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock",
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 9770
    move-object/from16 v10, p0

    move-object/from16 v9, p1

    move/from16 v8, p2

    move/from16 v7, p3

    and-int/lit8 v0, v8, 0x10

    const/4 v6, 0x1

    if-eqz v0, :cond_f

    move v0, v6

    goto :goto_10

    :cond_f
    const/4 v0, 0x0

    :goto_10
    move/from16 v23, v0

    .line 9782
    .local v23, "scanSystemPartition":Z
    iget-object v0, v9, Landroid/content/pm/PackageParser$Package;->volumeUuid:Ljava/lang/String;

    invoke-virtual {v9, v0}, Landroid/content/pm/PackageParser$Package;->setApplicationVolumeUuid(Ljava/lang/String;)V

    .line 9783
    iget-object v0, v9, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v9, v0}, Landroid/content/pm/PackageParser$Package;->setApplicationInfoCodePath(Ljava/lang/String;)V

    .line 9784
    iget-object v0, v9, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-virtual {v9, v0}, Landroid/content/pm/PackageParser$Package;->setApplicationInfoBaseCodePath(Ljava/lang/String;)V

    .line 9785
    iget-object v0, v9, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    invoke-virtual {v9, v0}, Landroid/content/pm/PackageParser$Package;->setApplicationInfoSplitCodePaths([Ljava/lang/String;)V

    .line 9786
    iget-object v0, v9, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v9, v0}, Landroid/content/pm/PackageParser$Package;->setApplicationInfoResourcePath(Ljava/lang/String;)V

    .line 9787
    iget-object v0, v9, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-virtual {v9, v0}, Landroid/content/pm/PackageParser$Package;->setApplicationInfoBaseResourcePath(Ljava/lang/String;)V

    .line 9788
    iget-object v0, v9, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    invoke-virtual {v9, v0}, Landroid/content/pm/PackageParser$Package;->setApplicationInfoSplitResourcePaths([Ljava/lang/String;)V

    .line 9790
    iget-object v2, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 9791
    :try_start_38
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v9, Landroid/content/pm/PackageParser$Package;->mRealPackage:Ljava/lang/String;

    invoke-virtual {v0, v3}, Lcom/android/server/pm/Settings;->getRenamedPackageLPr(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    move-object v5, v0

    .line 9792
    .local v5, "renamedPkgName":Ljava/lang/String;
    invoke-static {v9, v5}, Lcom/android/server/pm/PackageManagerService;->getRealPackageName(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    .line 9793
    .local v0, "realPkgName":Ljava/lang/String;
    if-eqz v0, :cond_4a

    .line 9794
    invoke-static {v9, v5}, Lcom/android/server/pm/PackageManagerService;->ensurePackageRenamed(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)V

    .line 9796
    :cond_4a
    invoke-direct {v10, v9, v5}, Lcom/android/server/pm/PackageManagerService;->getOriginalPackageLocked(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v3

    .line 9797
    .local v3, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v4, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v11, v9, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v11}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v4

    .line 9798
    .local v4, "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    if-nez v3, :cond_5a

    move-object v11, v4

    goto :goto_5b

    :cond_5a
    move-object v11, v3

    :goto_5b
    move-object v15, v11

    .line 9799
    .local v15, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v15, :cond_60

    move v11, v6

    goto :goto_61

    :cond_60
    const/4 v11, 0x0

    :goto_61
    move/from16 v24, v11

    .line 9800
    .local v24, "pkgAlreadyExists":Z
    if-eqz v24, :cond_68

    iget-object v11, v15, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    goto :goto_6a

    :cond_68
    iget-object v11, v9, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    :goto_6a
    move-object v14, v11

    .line 9801
    .local v14, "disabledPkgName":Ljava/lang/String;
    iget-object v11, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v11, v14}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v11

    move-object v13, v11

    .line 9802
    .local v13, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v13, :cond_76

    move v11, v6

    goto :goto_77

    :cond_76
    const/4 v11, 0x0

    :goto_77
    move/from16 v25, v11

    .line 9804
    .local v25, "isSystemPkgUpdated":Z
    sget-boolean v11, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v11, :cond_96

    if-eqz v25, :cond_96

    .line 9805
    const-string v11, "PackageManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v1, "updatedPkg = "

    invoke-virtual {v12, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v11, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 9808
    :cond_96
    iget-object v1, v9, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    if-eqz v1, :cond_a6

    .line 9809
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v11, v9, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    move-object/from16 v16, v14

    const/4 v14, 0x0

    .end local v14  # "disabledPkgName":Ljava/lang/String;
    .local v16, "disabledPkgName":Ljava/lang/String;
    invoke-virtual {v1, v11, v14, v14, v6}, Lcom/android/server/pm/Settings;->getSharedUserLPw(Ljava/lang/String;IIZ)Lcom/android/server/pm/SharedUserSetting;

    move-result-object v1

    goto :goto_aa

    .line 9811
    .end local v16  # "disabledPkgName":Ljava/lang/String;
    .restart local v14  # "disabledPkgName":Ljava/lang/String;
    :cond_a6
    move-object/from16 v16, v14

    const/4 v14, 0x0

    .end local v14  # "disabledPkgName":Ljava/lang/String;
    .restart local v16  # "disabledPkgName":Ljava/lang/String;
    const/4 v1, 0x0

    :goto_aa
    nop

    .line 9812
    .local v1, "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    sget-boolean v11, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z

    if-eqz v11, :cond_e2

    const/high16 v11, -0x80000000

    and-int/2addr v11, v8

    if-eqz v11, :cond_e2

    if-eqz v1, :cond_e2

    .line 9815
    const-string v11, "PackageManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Shared UserID "

    invoke-virtual {v12, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v14, v9, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    invoke-virtual {v12, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v14, " (uid="

    invoke-virtual {v12, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v14, v1, Lcom/android/server/pm/SharedUserSetting;->userId:I

    invoke-virtual {v12, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v14, "): packages="

    invoke-virtual {v12, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v14, v1, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v12, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    invoke-static {v11, v12}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 9820
    :cond_e2
    if-eqz v23, :cond_1ac

    .line 9825
    if-eqz v25, :cond_19e

    .line 9826
    iget-object v11, v9, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v11, :cond_f1

    .line 9827
    iget-object v11, v9, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v11}, Ljava/util/ArrayList;->size()I

    move-result v11

    goto :goto_f2

    :cond_f1
    const/4 v11, 0x0

    :goto_f2
    move v14, v11

    .line 9828
    .local v14, "scannedChildCount":I
    iget-object v11, v13, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v11, :cond_fe

    .line 9829
    iget-object v11, v13, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v11}, Ljava/util/List;->size()I

    move-result v11

    goto :goto_ff

    :cond_fe
    const/4 v11, 0x0

    :goto_ff
    move v12, v11

    .line 9830
    .local v12, "disabledChildCount":I
    const/4 v11, 0x0

    .local v11, "i":I
    :goto_101
    if-ge v11, v12, :cond_148

    .line 9831
    iget-object v6, v13, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    .line 9832
    invoke-interface {v6, v11}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/String;

    .line 9833
    .local v6, "disabledChildPackageName":Ljava/lang/String;
    const/16 v18, 0x0

    .line 9834
    .local v18, "disabledPackageAvailable":Z
    const/16 v19, 0x0

    move-object/from16 v28, v0

    move/from16 v0, v19

    .local v0, "j":I
    .local v28, "realPkgName":Ljava/lang/String;
    :goto_113
    if-ge v0, v14, :cond_133

    .line 9835
    move-object/from16 v29, v3

    .end local v3  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v29, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v3, v9, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 9836
    .local v3, "childPkg":Landroid/content/pm/PackageParser$Package;
    move-object/from16 v30, v4

    .end local v4  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v30, "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_12c

    .line 9837
    const/16 v18, 0x1

    .line 9838
    goto :goto_137

    .line 9834
    .end local v3  # "childPkg":Landroid/content/pm/PackageParser$Package;
    :cond_12c
    add-int/lit8 v0, v0, 0x1

    move-object/from16 v3, v29

    move-object/from16 v4, v30

    goto :goto_113

    .end local v29  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v30  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v3, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_133
    move-object/from16 v29, v3

    move-object/from16 v30, v4

    .line 9841
    .end local v0  # "j":I
    .end local v3  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v29  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v30  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_137
    if-nez v18, :cond_13e

    .line 9842
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v6}, Lcom/android/server/pm/Settings;->removeDisabledSystemPackageLPw(Ljava/lang/String;)V

    .line 9830
    .end local v6  # "disabledChildPackageName":Ljava/lang/String;
    .end local v18  # "disabledPackageAvailable":Z
    :cond_13e
    add-int/lit8 v11, v11, 0x1

    move-object/from16 v0, v28

    move-object/from16 v3, v29

    move-object/from16 v4, v30

    const/4 v6, 0x1

    goto :goto_101

    .end local v28  # "realPkgName":Ljava/lang/String;
    .end local v29  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v30  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v0, "realPkgName":Ljava/lang/String;
    .restart local v3  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_148
    move-object/from16 v28, v0

    move-object/from16 v29, v3

    move-object/from16 v30, v4

    .line 9846
    .end local v0  # "realPkgName":Ljava/lang/String;
    .end local v3  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v11  # "i":I
    .restart local v28  # "realPkgName":Ljava/lang/String;
    .restart local v29  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v30  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    new-instance v0, Lcom/android/server/pm/PackageManagerService$ScanRequest;

    const/4 v3, 0x0

    const/4 v4, 0x0

    const/4 v6, 0x0

    const/16 v18, 0x0

    iget-object v11, v10, Lcom/android/server/pm/PackageManagerService;->mPlatformPackage:Landroid/content/pm/PackageParser$Package;

    if-ne v9, v11, :cond_15c

    const/16 v21, 0x1

    goto :goto_15e

    :cond_15c
    const/16 v21, 0x0

    :goto_15e
    move-object v11, v0

    move/from16 v31, v12

    .end local v12  # "disabledChildCount":I
    .local v31, "disabledChildCount":I
    move-object/from16 v12, p1

    move-object/from16 v33, v13

    .end local v13  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v33, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object v13, v1

    move/from16 v34, v14

    move-object/from16 v26, v16

    const/16 v35, 0x0

    .end local v14  # "scannedChildCount":I
    .end local v16  # "disabledPkgName":Ljava/lang/String;
    .local v26, "disabledPkgName":Ljava/lang/String;
    .local v34, "scannedChildCount":I
    move-object v14, v3

    move-object v3, v15

    .end local v15  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v3, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v15, v33

    move-object/from16 v16, v4

    move-object/from16 v17, v6

    move/from16 v19, p2

    move/from16 v20, p3

    move-object/from16 v22, p6

    invoke-direct/range {v11 .. v22}, Lcom/android/server/pm/PackageManagerService$ScanRequest;-><init>(Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/SharedUserSetting;Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Ljava/lang/String;IIZLandroid/os/UserHandle;)V

    .line 9850
    .local v0, "request":Lcom/android/server/pm/PackageManagerService$ScanRequest;
    iget-object v4, v10, Lcom/android/server/pm/PackageManagerService;->mPlatformPackage:Landroid/content/pm/PackageParser$Package;

    invoke-static {v9, v8, v7, v4}, Lcom/android/server/pm/PackageManagerService;->applyPolicy(Landroid/content/pm/PackageParser$Package;IILandroid/content/pm/PackageParser$Package;)V

    .line 9851
    iget-boolean v4, v10, Lcom/android/server/pm/PackageManagerService;->mFactoryTest:Z

    const-wide/16 v11, -0x1

    invoke-static {v0, v4, v11, v12}, Lcom/android/server/pm/PackageManagerService;->scanPackageOnlyLI(Lcom/android/server/pm/PackageManagerService$ScanRequest;ZJ)Lcom/android/server/pm/PackageManagerService$ScanResult;

    move-result-object v4

    .line 9852
    .local v4, "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-boolean v6, v4, Lcom/android/server/pm/PackageManagerService$ScanResult;->existingSettingCopied:Z

    if-eqz v6, :cond_1b9

    iget-object v6, v4, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v6, v6, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    if-eqz v6, :cond_1b9

    .line 9853
    iget-object v6, v4, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v6, v6, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v11, v4, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    invoke-virtual {v6, v11}, Lcom/android/server/pm/PackageSetting;->updateFrom(Lcom/android/server/pm/PackageSetting;)V

    goto :goto_1b9

    .line 9825
    .end local v26  # "disabledPkgName":Ljava/lang/String;
    .end local v28  # "realPkgName":Ljava/lang/String;
    .end local v29  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v30  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v31  # "disabledChildCount":I
    .end local v33  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v34  # "scannedChildCount":I
    .local v0, "realPkgName":Ljava/lang/String;
    .local v3, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v4, "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v13  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v15  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v16  # "disabledPkgName":Ljava/lang/String;
    :cond_19e
    move-object/from16 v28, v0

    move-object/from16 v29, v3

    move-object/from16 v30, v4

    move-object/from16 v33, v13

    move-object v3, v15

    move-object/from16 v26, v16

    const/16 v35, 0x0

    .end local v0  # "realPkgName":Ljava/lang/String;
    .end local v4  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v15  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v16  # "disabledPkgName":Ljava/lang/String;
    .local v3, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v26  # "disabledPkgName":Ljava/lang/String;
    .restart local v28  # "realPkgName":Ljava/lang/String;
    .restart local v29  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v30  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v33  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    goto :goto_1b9

    .line 9820
    .end local v26  # "disabledPkgName":Ljava/lang/String;
    .end local v28  # "realPkgName":Ljava/lang/String;
    .end local v29  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v30  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v33  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v0  # "realPkgName":Ljava/lang/String;
    .local v3, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v13  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v15  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v16  # "disabledPkgName":Ljava/lang/String;
    :cond_1ac
    move-object/from16 v28, v0

    move-object/from16 v29, v3

    move-object/from16 v30, v4

    move-object/from16 v33, v13

    move-object v3, v15

    move-object/from16 v26, v16

    const/16 v35, 0x0

    .line 9857
    .end local v0  # "realPkgName":Ljava/lang/String;
    .end local v1  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    .end local v4  # "installedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v15  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v16  # "disabledPkgName":Ljava/lang/String;
    .local v3, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v33  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_1b9
    :goto_1b9
    monitor-exit v2
    :try_end_1ba
    .catchall {:try_start_38 .. :try_end_1ba} :catchall_4a9

    .line 9859
    if-eqz v24, :cond_1c8

    iget-object v0, v3, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    iget-object v1, v9, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    .line 9860
    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_1c8

    const/4 v0, 0x1

    goto :goto_1ca

    :cond_1c8
    move/from16 v0, v35

    :goto_1ca
    move v11, v0

    .line 9861
    .local v11, "newPkgChangedPaths":Z
    if-eqz v24, :cond_1d9

    .line 9862
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v0

    iget-wide v12, v3, Lcom/android/server/pm/PackageSetting;->versionCode:J

    cmp-long v0, v0, v12

    if-lez v0, :cond_1d9

    const/4 v0, 0x1

    goto :goto_1db

    :cond_1d9
    move/from16 v0, v35

    :goto_1db
    move v12, v0

    .line 9863
    .local v12, "newPkgVersionGreater":Z
    if-eqz v23, :cond_1e6

    if-eqz v25, :cond_1e6

    if-eqz v11, :cond_1e6

    if-eqz v12, :cond_1e6

    const/4 v0, 0x1

    goto :goto_1e8

    :cond_1e6
    move/from16 v0, v35

    :goto_1e8
    move v13, v0

    .line 9865
    .local v13, "isSystemPkgBetter":Z
    const/4 v0, 0x5

    if-eqz v13, :cond_258

    .line 9870
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 9872
    :try_start_1ef
    iget-object v2, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v4, v3, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v2, v4}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 9873
    monitor-exit v1
    :try_end_1f7
    .catchall {:try_start_1ef .. :try_end_1f7} :catchall_255

    .line 9875
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "System package updated; name: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v3, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, "; "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v14, v3, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-virtual {v1, v14, v15}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v2, " --> "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9878
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v14

    invoke-virtual {v1, v14, v15}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v2, "; "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v3, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " --> "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v9, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 9875
    invoke-static {v0, v1}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 9881
    iget-object v1, v3, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    iget-object v2, v3, Lcom/android/server/pm/PackageSetting;->resourcePathString:Ljava/lang/String;

    .line 9883
    invoke-static {v3}, Lcom/android/server/pm/InstructionSets;->getAppDexInstructionSets(Lcom/android/server/pm/PackageSetting;)[Ljava/lang/String;

    move-result-object v4

    .line 9881
    invoke-direct {v10, v1, v2, v4}, Lcom/android/server/pm/PackageManagerService;->createInstallArgsForExisting(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$InstallArgs;

    move-result-object v2

    .line 9884
    .local v2, "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    invoke-virtual {v2}, Lcom/android/server/pm/PackageManagerService$InstallArgs;->cleanUpResourcesLI()V

    .line 9885
    iget-object v4, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v4

    .line 9886
    :try_start_249
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v3, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v6}, Lcom/android/server/pm/Settings;->enableSystemPackageLPw(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    .line 9887
    monitor-exit v4

    goto :goto_258

    :catchall_252
    move-exception v0

    monitor-exit v4
    :try_end_254
    .catchall {:try_start_249 .. :try_end_254} :catchall_252

    throw v0

    .line 9873
    .end local v2  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    :catchall_255
    move-exception v0

    :try_start_256
    monitor-exit v1
    :try_end_257
    .catchall {:try_start_256 .. :try_end_257} :catchall_255

    throw v0

    .line 9890
    :cond_258
    :goto_258
    if-eqz v23, :cond_298

    if-eqz v25, :cond_298

    if-eqz v13, :cond_25f

    goto :goto_298

    .line 9894
    :cond_25f
    new-instance v1, Lcom/android/server/pm/PackageManagerException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Package "

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v9, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " at "

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v9, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " ignored: updated version "

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v14, v3, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-virtual {v2, v14, v15}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v4, " better than this "

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9896
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v14

    invoke-virtual {v2, v14, v15}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v1, v0, v2}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v1

    .line 9902
    :cond_298
    :goto_298
    iget-boolean v1, v10, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z

    if-eqz v1, :cond_29e

    if-nez v23, :cond_2a4

    .line 9903
    :cond_29e
    invoke-static/range {v33 .. v33}, Lcom/android/server/pm/PackageManagerServiceUtils;->isApkVerificationForced(Lcom/android/server/pm/PackageSetting;)Z

    move-result v1

    if-eqz v1, :cond_2a6

    :cond_2a4
    const/4 v1, 0x1

    goto :goto_2a8

    :cond_2a6
    move/from16 v1, v35

    :goto_2a8
    move v14, v1

    .line 9907
    .local v14, "forceCollect":Z
    if-nez v23, :cond_2b5

    if-eqz v14, :cond_2b4

    .line 9908
    invoke-direct/range {p0 .. p1}, Lcom/android/server/pm/PackageManagerService;->canSkipForcedPackageVerification(Landroid/content/pm/PackageParser$Package;)Z

    move-result v1

    if-eqz v1, :cond_2b4

    goto :goto_2b5

    :cond_2b4
    goto :goto_2b7

    :cond_2b5
    :goto_2b5
    const/16 v35, 0x1

    :goto_2b7
    move/from16 v15, v35

    .line 9909
    .local v15, "skipVerify":Z
    invoke-direct {v10, v3, v9, v14, v15}, Lcom/android/server/pm/PackageManagerService;->collectCertificatesLI(Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$Package;ZZ)V

    .line 9912
    invoke-direct {v10, v3, v9}, Lcom/android/server/pm/PackageManagerService;->maybeClearProfilesForUpgradesLI(Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$Package;)V

    .line 9918
    const/16 v16, 0x0

    .line 9921
    .local v16, "shouldHideSystemApp":Z
    if-eqz v23, :cond_410

    if-nez v25, :cond_410

    if-eqz v24, :cond_410

    .line 9922
    invoke-virtual {v3}, Lcom/android/server/pm/PackageSetting;->isSystem()Z

    move-result v1

    if-nez v1, :cond_408

    .line 9924
    iget-object v1, v9, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v2, v3, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v2, v2, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    const/4 v6, 0x1

    invoke-virtual {v1, v2, v6}, Landroid/content/pm/PackageParser$SigningDetails;->checkCapability(Landroid/content/pm/PackageParser$SigningDetails;I)Z

    move-result v1

    if-nez v1, :cond_360

    iget-object v1, v3, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v1, v1, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v2, v9, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    const/16 v4, 0x8

    .line 9926
    invoke-virtual {v1, v2, v4}, Landroid/content/pm/PackageParser$SigningDetails;->checkCapability(Landroid/content/pm/PackageParser$SigningDetails;I)Z

    move-result v1

    if-nez v1, :cond_357

    .line 9929
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "System package signature mismatch; name: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v3, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 9932
    iget-object v0, v9, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const-string/jumbo v1, "scanPackageInternalLI"

    invoke-virtual {v10, v0, v1}, Lcom/android/server/pm/PackageManagerService;->freezePackage(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v4

    .line 9934
    .local v4, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :try_start_307
    iget-object v2, v9, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
    :try_end_309
    .catchall {:try_start_307 .. :try_end_309} :catchall_344

    const/4 v0, 0x0

    const/16 v17, 0x1

    const/16 v18, 0x0

    const/16 v19, 0x0

    const/16 v20, 0x0

    const/16 v21, 0x0

    const/16 v22, 0x0

    move-object/from16 v1, p0

    move-object/from16 v36, v3

    .end local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v36, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object v3, v0

    move-object/from16 v37, v4

    .end local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .local v37, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    move/from16 v4, v17

    move-object/from16 v17, v5

    .end local v5  # "renamedPkgName":Ljava/lang/String;
    .local v17, "renamedPkgName":Ljava/lang/String;
    move-object/from16 v5, v18

    move v0, v6

    move/from16 v6, v19

    move-object/from16 v7, v20

    move/from16 v8, v21

    move/from16 v18, v11

    move-object v11, v9

    .end local v11  # "newPkgChangedPaths":Z
    .local v18, "newPkgChangedPaths":Z
    move-object/from16 v9, v22

    :try_start_32f
    invoke-direct/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->deletePackageLIF(Ljava/lang/String;Landroid/os/UserHandle;Z[IILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ZLandroid/content/pm/PackageParser$Package;)Z
    :try_end_332
    .catchall {:try_start_32f .. :try_end_332} :catchall_33f

    .line 9935
    move-object/from16 v1, v37

    .end local v37  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .local v1, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    if-eqz v1, :cond_33a

    const/4 v2, 0x0

    invoke-static {v2, v1}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    .line 9936
    .end local v1  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :cond_33a
    const/4 v1, 0x0

    move v8, v0

    move-object v9, v1

    .end local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v1, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    goto/16 :goto_418

    .line 9932
    .end local v1  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v37  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :catchall_33f
    move-exception v0

    move-object/from16 v1, v37

    move-object v2, v0

    .end local v37  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .local v1, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    goto :goto_34e

    .end local v1  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v17  # "renamedPkgName":Ljava/lang/String;
    .end local v18  # "newPkgChangedPaths":Z
    .end local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v5  # "renamedPkgName":Ljava/lang/String;
    .restart local v11  # "newPkgChangedPaths":Z
    :catchall_344
    move-exception v0

    move-object/from16 v36, v3

    move-object v1, v4

    move-object/from16 v17, v5

    move/from16 v18, v11

    move-object v11, v9

    move-object v2, v0

    .end local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v5  # "renamedPkgName":Ljava/lang/String;
    .end local v11  # "newPkgChangedPaths":Z
    .end local v12  # "newPkgVersionGreater":Z
    .end local v13  # "isSystemPkgBetter":Z
    .end local v14  # "forceCollect":Z
    .end local v15  # "skipVerify":Z
    .end local v16  # "shouldHideSystemApp":Z
    .end local v23  # "scanSystemPartition":Z
    .end local v24  # "pkgAlreadyExists":Z
    .end local v25  # "isSystemPkgUpdated":Z
    .end local v33  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    .end local p4  # "currentTime":J
    .end local p6  # "user":Landroid/os/UserHandle;
    :goto_34e
    :try_start_34e
    throw v2
    :try_end_34f
    .catchall {:try_start_34e .. :try_end_34f} :catchall_34f

    .line 9935
    .restart local v1  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v12  # "newPkgVersionGreater":Z
    .restart local v13  # "isSystemPkgBetter":Z
    .restart local v14  # "forceCollect":Z
    .restart local v15  # "skipVerify":Z
    .restart local v16  # "shouldHideSystemApp":Z
    .restart local v17  # "renamedPkgName":Ljava/lang/String;
    .restart local v18  # "newPkgChangedPaths":Z
    .restart local v23  # "scanSystemPartition":Z
    .restart local v24  # "pkgAlreadyExists":Z
    .restart local v25  # "isSystemPkgUpdated":Z
    .restart local v33  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    .restart local p4  # "currentTime":J
    .restart local p6  # "user":Landroid/os/UserHandle;
    :catchall_34f
    move-exception v0

    move-object v3, v0

    if-eqz v1, :cond_356

    invoke-static {v2, v1}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    :cond_356
    throw v3

    .line 9926
    .end local v1  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v17  # "renamedPkgName":Ljava/lang/String;
    .end local v18  # "newPkgChangedPaths":Z
    .end local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "renamedPkgName":Ljava/lang/String;
    .restart local v11  # "newPkgChangedPaths":Z
    :cond_357
    move-object/from16 v36, v3

    move-object/from16 v17, v5

    move v8, v6

    move/from16 v18, v11

    move-object v11, v9

    .end local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "renamedPkgName":Ljava/lang/String;
    .end local v11  # "newPkgChangedPaths":Z
    .restart local v17  # "renamedPkgName":Ljava/lang/String;
    .restart local v18  # "newPkgChangedPaths":Z
    .restart local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    goto :goto_368

    .line 9924
    .end local v17  # "renamedPkgName":Ljava/lang/String;
    .end local v18  # "newPkgChangedPaths":Z
    .end local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "renamedPkgName":Ljava/lang/String;
    .restart local v11  # "newPkgChangedPaths":Z
    :cond_360
    move-object/from16 v36, v3

    move-object/from16 v17, v5

    move v8, v6

    move/from16 v18, v11

    move-object v11, v9

    .line 9937
    .end local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "renamedPkgName":Ljava/lang/String;
    .end local v11  # "newPkgChangedPaths":Z
    .restart local v17  # "renamedPkgName":Ljava/lang/String;
    .restart local v18  # "newPkgChangedPaths":Z
    .restart local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_368
    if-eqz v12, :cond_3c3

    .line 9941
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "System package enabled; name: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v2, v36

    .end local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v2, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, "; "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v3, v2, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-virtual {v1, v3, v4}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v3, " --> "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9944
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v3

    invoke-virtual {v1, v3, v4}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v3, "; "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " --> "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v11, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 9941
    invoke-static {v0, v1}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 9946
    iget-object v0, v2, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    iget-object v1, v2, Lcom/android/server/pm/PackageSetting;->resourcePathString:Ljava/lang/String;

    .line 9948
    invoke-static {v2}, Lcom/android/server/pm/InstructionSets;->getAppDexInstructionSets(Lcom/android/server/pm/PackageSetting;)[Ljava/lang/String;

    move-result-object v3

    .line 9946
    invoke-direct {v10, v0, v1, v3}, Lcom/android/server/pm/PackageManagerService;->createInstallArgsForExisting(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$InstallArgs;

    move-result-object v1

    .line 9949
    .local v1, "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    iget-object v3, v10, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v3

    .line 9950
    :try_start_3bb
    invoke-virtual {v1}, Lcom/android/server/pm/PackageManagerService$InstallArgs;->cleanUpResourcesLI()V

    .line 9951
    monitor-exit v3

    .line 9952
    .end local v1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    goto :goto_417

    .line 9951
    .restart local v1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    :catchall_3c0
    move-exception v0

    monitor-exit v3
    :try_end_3c2
    .catchall {:try_start_3bb .. :try_end_3c2} :catchall_3c0

    throw v0

    .line 9956
    .end local v1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_3c3
    move-object/from16 v2, v36

    .end local v36  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    const/16 v16, 0x1

    .line 9957
    const/4 v0, 0x4

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "System package disabled; name: "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, "; old: "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " @ "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v3, v2, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-virtual {v1, v3, v4}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v3, "; new: "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v11, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " @ "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v11, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    move-object v9, v2

    goto :goto_418

    .line 9922
    .end local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v17  # "renamedPkgName":Ljava/lang/String;
    .end local v18  # "newPkgChangedPaths":Z
    .restart local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "renamedPkgName":Ljava/lang/String;
    .restart local v11  # "newPkgChangedPaths":Z
    :cond_408
    move-object v2, v3

    move-object/from16 v17, v5

    move/from16 v18, v11

    const/4 v8, 0x1

    move-object v11, v9

    .end local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "renamedPkgName":Ljava/lang/String;
    .end local v11  # "newPkgChangedPaths":Z
    .restart local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v17  # "renamedPkgName":Ljava/lang/String;
    .restart local v18  # "newPkgChangedPaths":Z
    goto :goto_417

    .line 9921
    .end local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v17  # "renamedPkgName":Ljava/lang/String;
    .end local v18  # "newPkgChangedPaths":Z
    .restart local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "renamedPkgName":Ljava/lang/String;
    .restart local v11  # "newPkgChangedPaths":Z
    :cond_410
    move-object v2, v3

    move-object/from16 v17, v5

    move/from16 v18, v11

    const/4 v8, 0x1

    move-object v11, v9

    .line 9966
    .end local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "renamedPkgName":Ljava/lang/String;
    .end local v11  # "newPkgChangedPaths":Z
    .restart local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v17  # "renamedPkgName":Ljava/lang/String;
    .restart local v18  # "newPkgChangedPaths":Z
    :goto_417
    move-object v9, v2

    .end local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v9, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_418
    if-eqz v25, :cond_427

    move-object/from16 v7, v33

    .end local v33  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v7, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-boolean v0, v7, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    if-eqz v0, :cond_429

    .line 9967
    const/high16 v0, 0x1000000

    or-int v0, p3, v0

    move/from16 v19, v0

    .end local p3  # "scanFlags":I
    .local v0, "scanFlags":I
    goto :goto_42b

    .line 9966
    .end local v0  # "scanFlags":I
    .end local v7  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v33  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local p3  # "scanFlags":I
    :cond_427
    move-object/from16 v7, v33

    .line 9970
    .end local v33  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_429
    move/from16 v19, p3

    .end local p3  # "scanFlags":I
    .local v19, "scanFlags":I
    :goto_42b
    or-int/lit8 v4, v19, 0x2

    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move/from16 v3, p2

    move-wide/from16 v5, p4

    move-object/from16 v20, v7

    .end local v7  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v20, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v7, p6

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->scanPackageNewLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Lcom/android/server/pm/PackageManagerService$ScanResult;

    move-result-object v1

    .line 9972
    .local v1, "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-boolean v0, v1, Lcom/android/server/pm/PackageManagerService$ScanResult;->success:Z

    if-eqz v0, :cond_493

    .line 9973
    iget-object v2, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 9974
    const/4 v3, 0x0

    .line 9976
    .local v3, "appIdCreated":Z
    :try_start_445
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v0, v0, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    .line 9977
    .local v0, "pkgName":Ljava/lang/String;
    new-instance v4, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;

    .line 9979
    invoke-static {v0, v1}, Ljava/util/Collections;->singletonMap(Ljava/lang/Object;Ljava/lang/Object;)Ljava/util/Map;

    move-result-object v27

    iget-object v5, v10, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    iget-object v6, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 9983
    invoke-direct/range {p0 .. p1}, Lcom/android/server/pm/PackageManagerService;->getSettingsVersionForPackage(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v7

    .line 9982
    invoke-static {v0, v7}, Ljava/util/Collections;->singletonMap(Ljava/lang/Object;Ljava/lang/Object;)Ljava/util/Map;

    move-result-object v30

    .line 9985
    invoke-direct {v10, v1}, Lcom/android/server/pm/PackageManagerService;->getSharedLibLatestVersionSetting(Lcom/android/server/pm/PackageManagerService$ScanResult;)Lcom/android/server/pm/PackageSetting;

    move-result-object v7

    .line 9984
    invoke-static {v0, v7}, Ljava/util/Collections;->singletonMap(Ljava/lang/Object;Ljava/lang/Object;)Ljava/util/Map;

    move-result-object v31

    const/16 v32, 0x0

    move-object/from16 v26, v4

    move-object/from16 v28, v5

    move-object/from16 v29, v6

    invoke-direct/range {v26 .. v32}, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;-><init>(Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;Lcom/android/server/pm/PackageManagerService$1;)V

    iget-object v5, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 9977
    invoke-static {v4, v5}, Lcom/android/server/pm/PackageManagerService;->reconcilePackagesLocked(Lcom/android/server/pm/PackageManagerService$ReconcileRequest;Lcom/android/server/pm/KeySetManagerService;)Ljava/util/Map;

    move-result-object v4

    .line 9987
    .local v4, "reconcileResult":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    invoke-direct {v10, v1}, Lcom/android/server/pm/PackageManagerService;->optimisticallyRegisterAppId(Lcom/android/server/pm/PackageManagerService$ScanResult;)Z

    move-result v5

    move v3, v5

    .line 9988
    invoke-interface {v4, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;

    invoke-direct {v10, v5}, Lcom/android/server/pm/PackageManagerService;->commitReconciledScanResultLocked(Lcom/android/server/pm/PackageManagerService$ReconciledPackage;)V
    :try_end_484
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_445 .. :try_end_484} :catch_489
    .catchall {:try_start_445 .. :try_end_484} :catchall_487

    .line 9994
    .end local v0  # "pkgName":Ljava/lang/String;
    .end local v4  # "reconcileResult":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    nop

    .line 9995
    .end local v3  # "appIdCreated":Z
    :try_start_485
    monitor-exit v2

    goto :goto_493

    :catchall_487
    move-exception v0

    goto :goto_491

    .line 9989
    .restart local v3  # "appIdCreated":Z
    :catch_489
    move-exception v0

    .line 9990
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    if-eqz v3, :cond_48f

    .line 9991
    invoke-direct {v10, v1}, Lcom/android/server/pm/PackageManagerService;->cleanUpAppIdCreation(Lcom/android/server/pm/PackageManagerService$ScanResult;)V

    .line 9993
    :cond_48f
    nop

    .end local v1  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .end local v9  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "newPkgVersionGreater":Z
    .end local v13  # "isSystemPkgBetter":Z
    .end local v14  # "forceCollect":Z
    .end local v15  # "skipVerify":Z
    .end local v16  # "shouldHideSystemApp":Z
    .end local v17  # "renamedPkgName":Ljava/lang/String;
    .end local v18  # "newPkgChangedPaths":Z
    .end local v19  # "scanFlags":I
    .end local v20  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v23  # "scanSystemPartition":Z
    .end local v24  # "pkgAlreadyExists":Z
    .end local v25  # "isSystemPkgUpdated":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p4  # "currentTime":J
    .end local p6  # "user":Landroid/os/UserHandle;
    throw v0

    .line 9995
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v3  # "appIdCreated":Z
    .restart local v1  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .restart local v9  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v12  # "newPkgVersionGreater":Z
    .restart local v13  # "isSystemPkgBetter":Z
    .restart local v14  # "forceCollect":Z
    .restart local v15  # "skipVerify":Z
    .restart local v16  # "shouldHideSystemApp":Z
    .restart local v17  # "renamedPkgName":Ljava/lang/String;
    .restart local v18  # "newPkgChangedPaths":Z
    .restart local v19  # "scanFlags":I
    .restart local v20  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v23  # "scanSystemPartition":Z
    .restart local v24  # "pkgAlreadyExists":Z
    .restart local v25  # "isSystemPkgUpdated":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p4  # "currentTime":J
    .restart local p6  # "user":Landroid/os/UserHandle;
    :goto_491
    monitor-exit v2
    :try_end_492
    .catchall {:try_start_485 .. :try_end_492} :catchall_487

    throw v0

    .line 9998
    :cond_493
    :goto_493
    if-eqz v16, :cond_4a4

    .line 9999
    iget-object v2, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 10000
    :try_start_498
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v3, v8}, Lcom/android/server/pm/Settings;->disableSystemPackageLPw(Ljava/lang/String;Z)Z

    .line 10001
    monitor-exit v2

    goto :goto_4a4

    :catchall_4a1
    move-exception v0

    monitor-exit v2
    :try_end_4a3
    .catchall {:try_start_498 .. :try_end_4a3} :catchall_4a1

    throw v0

    .line 10003
    :cond_4a4
    :goto_4a4
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v0, v0, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    return-object v0

    .line 9857
    .end local v1  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .end local v9  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "newPkgVersionGreater":Z
    .end local v13  # "isSystemPkgBetter":Z
    .end local v14  # "forceCollect":Z
    .end local v15  # "skipVerify":Z
    .end local v16  # "shouldHideSystemApp":Z
    .end local v17  # "renamedPkgName":Ljava/lang/String;
    .end local v18  # "newPkgChangedPaths":Z
    .end local v19  # "scanFlags":I
    .end local v20  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v24  # "pkgAlreadyExists":Z
    .end local v25  # "isSystemPkgUpdated":Z
    .restart local p3  # "scanFlags":I
    :catchall_4a9
    move-exception v0

    move-object v11, v9

    :goto_4ab
    :try_start_4ab
    monitor-exit v2
    :try_end_4ac
    .catchall {:try_start_4ab .. :try_end_4ac} :catchall_4ad

    throw v0

    :catchall_4ad
    move-exception v0

    goto :goto_4ab
.end method

.method private addPackageHoldingPermissions(Ljava/util/ArrayList;Lcom/android/server/pm/PackageSetting;[Ljava/lang/String;[ZII)V
    .registers 13
    .param p2, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p3, "permissions"  # [Ljava/lang/String;
    .param p4, "tmp"  # [Z
    .param p5, "flags"  # I
    .param p6, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/ArrayList<",
            "Landroid/content/pm/PackageInfo;",
            ">;",
            "Lcom/android/server/pm/PackageSetting;",
            "[",
            "Ljava/lang/String;",
            "[ZII)V"
        }
    .end annotation

    .line 8972
    .local p1, "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageInfo;>;"
    const/4 v0, 0x0

    .line 8973
    .local v0, "numMatch":I
    invoke-virtual {p2}, Lcom/android/server/pm/PackageSetting;->getPermissionsState()Lcom/android/server/pm/permission/PermissionsState;

    move-result-object v1

    .line 8974
    .local v1, "permissionsState":Lcom/android/server/pm/permission/PermissionsState;
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_6
    array-length v3, p3

    if-ge v2, v3, :cond_1d

    .line 8975
    aget-object v3, p3, v2

    .line 8976
    .local v3, "permission":Ljava/lang/String;
    invoke-virtual {v1, v3, p6}, Lcom/android/server/pm/permission/PermissionsState;->hasPermission(Ljava/lang/String;I)Z

    move-result v4

    if-eqz v4, :cond_17

    .line 8977
    const/4 v4, 0x1

    aput-boolean v4, p4, v2

    .line 8978
    add-int/lit8 v0, v0, 0x1

    goto :goto_1a

    .line 8980
    :cond_17
    const/4 v4, 0x0

    aput-boolean v4, p4, v2

    .line 8974
    .end local v3  # "permission":Ljava/lang/String;
    :goto_1a
    add-int/lit8 v2, v2, 0x1

    goto :goto_6

    .line 8983
    .end local v2  # "i":I
    :cond_1d
    if-nez v0, :cond_20

    .line 8984
    return-void

    .line 8986
    :cond_20
    invoke-direct {p0, p2, p5, p6}, Lcom/android/server/pm/PackageManagerService;->generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;

    move-result-object v2

    .line 8990
    .local v2, "pi":Landroid/content/pm/PackageInfo;
    if-eqz v2, :cond_4b

    .line 8991
    and-int/lit16 v3, p5, 0x1000

    if-nez v3, :cond_48

    .line 8992
    array-length v3, p3

    if-ne v0, v3, :cond_30

    .line 8993
    iput-object p3, v2, Landroid/content/pm/PackageInfo;->requestedPermissions:[Ljava/lang/String;

    goto :goto_48

    .line 8995
    :cond_30
    new-array v3, v0, [Ljava/lang/String;

    iput-object v3, v2, Landroid/content/pm/PackageInfo;->requestedPermissions:[Ljava/lang/String;

    .line 8996
    const/4 v0, 0x0

    .line 8997
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_36
    array-length v4, p3

    if-ge v3, v4, :cond_48

    .line 8998
    aget-boolean v4, p4, v3

    if-eqz v4, :cond_45

    .line 8999
    iget-object v4, v2, Landroid/content/pm/PackageInfo;->requestedPermissions:[Ljava/lang/String;

    aget-object v5, p3, v3

    aput-object v5, v4, v0

    .line 9000
    add-int/lit8 v0, v0, 0x1

    .line 8997
    :cond_45
    add-int/lit8 v3, v3, 0x1

    goto :goto_36

    .line 9005
    .end local v3  # "i":I
    :cond_48
    :goto_48
    invoke-virtual {p1, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 9007
    :cond_4b
    return-void
.end method

.method private addPreferredActivityInternal(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;ZILjava/lang/String;)V
    .registers 24
    .param p1, "filter"  # Landroid/content/IntentFilter;
    .param p2, "match"  # I
    .param p3, "set"  # [Landroid/content/ComponentName;
    .param p4, "activity"  # Landroid/content/ComponentName;
    .param p5, "always"  # Z
    .param p6, "userId"  # I
    .param p7, "opname"  # Ljava/lang/String;

    .line 21121
    move-object/from16 v1, p0

    move/from16 v8, p6

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v9

    .line 21122
    .local v9, "callingUid":I
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v5, 0x1

    const/4 v6, 0x0

    const-string v7, "add preferred activity"

    move v3, v9

    move/from16 v4, p6

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 21124
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v2, "android.permission.SET_PREFERRED_APPLICATIONS"

    invoke-virtual {v0, v2}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_45

    .line 21127
    invoke-direct {v1, v9}, Lcom/android/server/pm/PackageManagerService;->getUidTargetSdkVersionLockedLPr(I)I

    move-result v0

    const/16 v2, 0x8

    if-ge v0, v2, :cond_3d

    .line 21129
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Ignoring addPreferredActivity() from uid "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v2, "PackageManager"

    invoke-static {v2, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 21131
    return-void

    .line 21133
    :cond_3d
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const/4 v2, 0x0

    const-string v3, "android.permission.SET_PREFERRED_APPLICATIONS"

    invoke-virtual {v0, v3, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 21136
    :cond_45
    invoke-virtual/range {p1 .. p1}, Landroid/content/IntentFilter;->countActions()I

    move-result v0

    if-nez v0, :cond_53

    .line 21137
    const-string v0, "PackageManager"

    const-string v2, "Cannot set a preferred activity with no filter actions"

    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 21138
    return-void

    .line 21140
    :cond_53
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v0, :cond_93

    .line 21141
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v2, p7

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " activity "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual/range {p4 .. p4}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " for user "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, ":"

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v3, "PackageManager"

    invoke-static {v3, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21143
    new-instance v0, Landroid/util/LogPrinter;

    const/4 v3, 0x4

    const-string v4, "PackageManager"

    invoke-direct {v0, v3, v4}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;)V

    const-string v3, "  "

    move-object/from16 v4, p1

    invoke-virtual {v4, v0, v3}, Landroid/content/IntentFilter;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    goto :goto_97

    .line 21140
    :cond_93
    move-object/from16 v4, p1

    move-object/from16 v2, p7

    .line 21145
    :goto_97
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 21146
    :try_start_9a
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v8}, Lcom/android/server/pm/Settings;->editPreferredActivitiesLPw(I)Lcom/android/server/pm/PreferredIntentResolver;

    move-result-object v0

    .line 21147
    .local v0, "pir":Lcom/android/server/pm/PreferredIntentResolver;
    new-instance v5, Lcom/android/server/pm/PreferredActivity;

    move-object v10, v5

    move-object/from16 v11, p1

    move/from16 v12, p2

    move-object/from16 v13, p3

    move-object/from16 v14, p4

    move/from16 v15, p5

    invoke-direct/range {v10 .. v15}, Lcom/android/server/pm/PreferredActivity;-><init>(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;Z)V

    invoke-virtual {v0, v5}, Lcom/android/server/pm/PreferredIntentResolver;->addFilter(Landroid/content/IntentFilter;)V

    .line 21148
    invoke-virtual {v1, v8}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 21149
    .end local v0  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    monitor-exit v3
    :try_end_b7
    .catchall {:try_start_9a .. :try_end_b7} :catchall_c1

    .line 21150
    invoke-direct {v1, v8}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(I)Z

    move-result v0

    if-nez v0, :cond_c0

    .line 21151
    invoke-direct {v1, v8}, Lcom/android/server/pm/PackageManagerService;->postPreferredActivityChangedBroadcast(I)V

    .line 21153
    :cond_c0
    return-void

    .line 21149
    :catchall_c1
    move-exception v0

    :try_start_c2
    monitor-exit v3
    :try_end_c3
    .catchall {:try_start_c2 .. :try_end_c3} :catchall_c1

    throw v0
.end method

.method private addSharedLibraryLPr(Landroid/content/pm/PackageParser$Package;Ljava/util/Set;Landroid/content/pm/SharedLibraryInfo;Landroid/content/pm/PackageParser$Package;)V
    .registers 8
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p3, "libInfo"  # Landroid/content/pm/SharedLibraryInfo;
    .param p4, "changingLib"  # Landroid/content/pm/PackageParser$Package;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageParser$Package;",
            "Ljava/util/Set<",
            "Ljava/lang/String;",
            ">;",
            "Landroid/content/pm/SharedLibraryInfo;",
            "Landroid/content/pm/PackageParser$Package;",
            ")V"
        }
    .end annotation

    .line 10925
    .local p2, "usesLibraryFiles":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    invoke-virtual {p3}, Landroid/content/pm/SharedLibraryInfo;->getPath()Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_e

    .line 10926
    invoke-virtual {p3}, Landroid/content/pm/SharedLibraryInfo;->getPath()Ljava/lang/String;

    move-result-object v0

    invoke-interface {p2, v0}, Ljava/util/Set;->add(Ljava/lang/Object;)Z

    .line 10927
    return-void

    .line 10929
    :cond_e
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {p3}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/PackageParser$Package;

    .line 10930
    .local v0, "p":Landroid/content/pm/PackageParser$Package;
    if-eqz p4, :cond_35

    iget-object v1, p4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {p3}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_35

    .line 10935
    if-eqz v0, :cond_34

    iget-object v1, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v2, p4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_35

    .line 10936
    :cond_34
    move-object v0, p4

    .line 10939
    :cond_35
    if-eqz v0, :cond_4c

    .line 10940
    invoke-virtual {v0}, Landroid/content/pm/PackageParser$Package;->getAllCodePaths()Ljava/util/List;

    move-result-object v1

    invoke-interface {p2, v1}, Ljava/util/Set;->addAll(Ljava/util/Collection;)Z

    .line 10942
    sget-object v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$xJ_pDKPvSH0lgOwva8xeI2zJ2ns;->INSTANCE:Lcom/android/server/pm/-$$Lambda$PackageManagerService$xJ_pDKPvSH0lgOwva8xeI2zJ2ns;

    invoke-direct {p0, p1, p3, v1}, Lcom/android/server/pm/PackageManagerService;->applyDefiningSharedLibraryUpdateLocked(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/SharedLibraryInfo;Ljava/util/function/BiConsumer;)V

    .line 10945
    iget-object v1, v0, Landroid/content/pm/PackageParser$Package;->usesLibraryFiles:[Ljava/lang/String;

    if-eqz v1, :cond_4c

    .line 10946
    iget-object v1, v0, Landroid/content/pm/PackageParser$Package;->usesLibraryFiles:[Ljava/lang/String;

    invoke-static {p2, v1}, Ljava/util/Collections;->addAll(Ljava/util/Collection;[Ljava/lang/Object;)Z

    .line 10949
    :cond_4c
    return-void
.end method

.method private static addSharedLibraryToPackageVersionMap(Ljava/util/Map;Landroid/content/pm/SharedLibraryInfo;)Z
    .registers 8
    .param p1, "library"  # Landroid/content/pm/SharedLibraryInfo;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;",
            "Landroid/content/pm/SharedLibraryInfo;",
            ")Z"
        }
    .end annotation

    .line 17454
    .local p0, "target":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v0

    .line 17455
    .local v0, "name":Ljava/lang/String;
    invoke-interface {p0, v0}, Ljava/util/Map;->containsKey(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_24

    .line 17456
    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getType()I

    move-result v1

    const/4 v2, 0x2

    const/4 v3, 0x0

    if-eq v1, v2, :cond_13

    .line 17458
    return v3

    .line 17459
    :cond_13
    invoke-interface {p0, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/util/LongSparseArray;

    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v4

    invoke-virtual {v1, v4, v5}, Landroid/util/LongSparseArray;->indexOfKey(J)I

    move-result v1

    if-ltz v1, :cond_2c

    .line 17461
    return v3

    .line 17464
    :cond_24
    new-instance v1, Landroid/util/LongSparseArray;

    invoke-direct {v1}, Landroid/util/LongSparseArray;-><init>()V

    invoke-interface {p0, v0, v1}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 17466
    :cond_2c
    invoke-interface {p0, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/util/LongSparseArray;

    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v2

    invoke-virtual {v1, v2, v3, p1}, Landroid/util/LongSparseArray;->put(JLjava/lang/Object;)V

    .line 17467
    const/4 v1, 0x1

    return v1
.end method

.method private static adjustCpuAbisForSharedUserLPw(Ljava/util/Set;Landroid/content/pm/PackageParser$Package;)Ljava/util/List;
    .registers 12
    .param p1, "scannedPackage"  # Landroid/content/pm/PackageParser$Package;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/Set<",
            "Lcom/android/server/pm/PackageSetting;",
            ">;",
            "Landroid/content/pm/PackageParser$Package;",
            ")",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 13009
    .local p0, "packagesForUser":Ljava/util/Set;, "Ljava/util/Set<Lcom/android/server/pm/PackageSetting;>;"
    const/4 v0, 0x0

    .line 13010
    .local v0, "changedAbiCodePath":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    const/4 v1, 0x0

    .line 13011
    .local v1, "requiredInstructionSet":Ljava/lang/String;
    if-eqz p1, :cond_12

    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    if-eqz v2, :cond_12

    .line 13012
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    invoke-static {v2}, Ldalvik/system/VMRuntime;->getInstructionSet(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    .line 13016
    :cond_12
    const/4 v2, 0x0

    .line 13017
    .local v2, "requirer":Lcom/android/server/pm/PackageSetting;
    invoke-interface {p0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :goto_17
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    const-string v5, "PackageManager"

    if-eqz v4, :cond_79

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 13022
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz p1, :cond_31

    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v7, v4, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_78

    .line 13023
    :cond_31
    iget-object v6, v4, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    if-nez v6, :cond_36

    .line 13024
    goto :goto_17

    .line 13027
    :cond_36
    iget-object v6, v4, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    invoke-static {v6}, Ldalvik/system/VMRuntime;->getInstructionSet(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    .line 13028
    .local v6, "instructionSet":Ljava/lang/String;
    if-eqz v1, :cond_74

    invoke-virtual {v6, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-nez v7, :cond_74

    .line 13031
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Instruction set mismatch, "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 13032
    if-nez v2, :cond_53

    const-string v8, "[caller]"

    goto :goto_54

    :cond_53
    move-object v8, v2

    :goto_54
    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v8, " requires "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " whereas "

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    .line 13035
    .local v7, "errorMessage":Ljava/lang/String;
    invoke-static {v5, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13038
    .end local v7  # "errorMessage":Ljava/lang/String;
    :cond_74
    if-nez v1, :cond_78

    .line 13039
    move-object v1, v6

    .line 13040
    move-object v2, v4

    .line 13043
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "instructionSet":Ljava/lang/String;
    :cond_78
    goto :goto_17

    .line 13045
    :cond_79
    if-eqz v1, :cond_11b

    .line 13047
    if-eqz v2, :cond_86

    .line 13051
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    .line 13052
    .local v3, "adjustedAbi":Ljava/lang/String;
    if-eqz p1, :cond_8a

    .line 13053
    iget-object v4, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v3, v4, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    goto :goto_8a

    .line 13058
    .end local v3  # "adjustedAbi":Ljava/lang/String;
    :cond_86
    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 13061
    .restart local v3  # "adjustedAbi":Ljava/lang/String;
    :cond_8a
    :goto_8a
    invoke-interface {p0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_8e
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v6

    if-eqz v6, :cond_11b

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    .line 13062
    .local v6, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz p1, :cond_a6

    iget-object v7, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v8, v6, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-nez v7, :cond_119

    .line 13063
    :cond_a6
    iget-object v7, v6, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    if-eqz v7, :cond_ab

    .line 13064
    goto :goto_8e

    .line 13067
    :cond_ab
    iput-object v3, v6, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    .line 13068
    iget-object v7, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v7, :cond_119

    iget-object v7, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v7, v7, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    if-eqz v7, :cond_119

    iget-object v7, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v7, v7, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 13069
    invoke-static {v3, v7}, Landroid/text/TextUtils;->equals(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Z

    move-result v7

    if-nez v7, :cond_119

    .line 13070
    iget-object v7, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v7, v7, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v3, v7, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 13071
    sget-boolean v7, Lcom/android/server/pm/PackageManagerService;->DEBUG_ABI_SELECTION:Z

    if-eqz v7, :cond_10c

    .line 13072
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Adjusting ABI for "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v8, v6, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, " to "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, " (requirer="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 13074
    const-string/jumbo v8, "null"

    if-eqz v2, :cond_f1

    iget-object v9, v2, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    goto :goto_f2

    :cond_f1
    move-object v9, v8

    :goto_f2
    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v9, ", scannedPackage="

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 13076
    if-eqz p1, :cond_fd

    move-object v8, p1

    :cond_fd
    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v8, ")"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    .line 13072
    invoke-static {v5, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 13079
    :cond_10c
    if-nez v0, :cond_114

    .line 13080
    new-instance v7, Ljava/util/ArrayList;

    invoke-direct {v7}, Ljava/util/ArrayList;-><init>()V

    move-object v0, v7

    .line 13082
    :cond_114
    iget-object v7, v6, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    invoke-interface {v0, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 13085
    .end local v6  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_119
    goto/16 :goto_8e

    .line 13087
    .end local v3  # "adjustedAbi":Ljava/lang/String;
    :cond_11b
    return-object v0
.end method

.method private adjustScanFlags(ILcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Landroid/os/UserHandle;Landroid/content/pm/PackageParser$Package;)I
    .registers 14
    .param p1, "scanFlags"  # I
    .param p2, "pkgSetting"  # Lcom/android/server/pm/PackageSetting;
    .param p3, "disabledPkgSetting"  # Lcom/android/server/pm/PackageSetting;
    .param p4, "user"  # Landroid/os/UserHandle;
    .param p5, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 11340
    and-int/lit8 v0, p1, 0x4

    if-eqz v0, :cond_10

    if-nez p3, :cond_10

    if-eqz p2, :cond_10

    invoke-virtual {p2}, Lcom/android/server/pm/PackageSetting;->isSystem()Z

    move-result v0

    if-eqz v0, :cond_10

    .line 11341
    move-object v0, p2

    goto :goto_11

    .line 11342
    :cond_10
    move-object v0, p3

    :goto_11
    nop

    .line 11343
    .local v0, "systemPkgSetting":Lcom/android/server/pm/PackageSetting;
    const/high16 v1, 0x100000

    const/high16 v2, 0x40000

    if-eqz v0, :cond_4a

    .line 11345
    const/high16 v3, 0x20000

    or-int/2addr p1, v3

    .line 11346
    iget v4, v0, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    and-int/lit8 v4, v4, 0x8

    if-eqz v4, :cond_22

    .line 11348
    or-int/2addr p1, v2

    .line 11350
    :cond_22
    iget v4, v0, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    and-int/2addr v3, v4

    const/high16 v4, 0x80000

    if-eqz v3, :cond_2a

    .line 11352
    or-int/2addr p1, v4

    .line 11354
    :cond_2a
    iget v3, v0, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    and-int/2addr v3, v2

    if-eqz v3, :cond_30

    .line 11356
    or-int/2addr p1, v1

    .line 11358
    :cond_30
    iget v3, v0, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    and-int/2addr v3, v4

    const/high16 v4, 0x200000

    if-eqz v3, :cond_38

    .line 11360
    or-int/2addr p1, v4

    .line 11362
    :cond_38
    iget v3, v0, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    and-int/2addr v3, v4

    if-eqz v3, :cond_40

    .line 11364
    const/high16 v3, 0x400000

    or-int/2addr p1, v3

    .line 11366
    :cond_40
    iget v3, v0, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    const/high16 v4, 0x40000000  # 2.0f

    and-int/2addr v3, v4

    if-eqz v3, :cond_4a

    .line 11368
    const/high16 v3, 0x800000

    or-int/2addr p1, v3

    .line 11371
    :cond_4a
    const/4 v3, 0x0

    if-eqz p2, :cond_66

    .line 11372
    if-nez p4, :cond_51

    move v4, v3

    goto :goto_55

    :cond_51
    invoke-virtual {p4}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v4

    .line 11373
    .local v4, "userId":I
    :goto_55
    invoke-virtual {p2, v4}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v5

    if-eqz v5, :cond_5d

    .line 11374
    or-int/lit16 p1, p1, 0x4000

    .line 11376
    :cond_5d
    invoke-virtual {p2, v4}, Lcom/android/server/pm/PackageSetting;->getVirtulalPreload(I)Z

    move-result v5

    if-eqz v5, :cond_66

    .line 11377
    const/high16 v5, 0x10000

    or-int/2addr p1, v5

    .line 11382
    .end local v4  # "userId":I
    :cond_66
    and-int/2addr v1, p1

    if-eqz v1, :cond_76

    .line 11383
    const/16 v1, 0x1c

    const-string/jumbo v4, "ro.vndk.version"

    invoke-static {v4, v1}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I

    move-result v4

    if-ge v4, v1, :cond_76

    const/4 v1, 0x1

    goto :goto_77

    :cond_76
    move v1, v3

    .line 11384
    .local v1, "skipVendorPrivilegeScan":Z
    :goto_77
    and-int v4, p1, v2

    if-nez v4, :cond_c1

    .line 11385
    invoke-virtual {p5}, Landroid/content/pm/PackageParser$Package;->isPrivileged()Z

    move-result v4

    if-nez v4, :cond_c1

    iget-object v4, p5, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    if-eqz v4, :cond_c1

    if-nez v1, :cond_c1

    .line 11388
    const/4 v4, 0x0

    .line 11390
    .local v4, "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    :try_start_88
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, p5, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    invoke-virtual {v5, v6, v3, v3, v3}, Lcom/android/server/pm/Settings;->getSharedUserLPw(Ljava/lang/String;IIZ)Lcom/android/server/pm/SharedUserSetting;

    move-result-object v3
    :try_end_90
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_88 .. :try_end_90} :catch_92

    move-object v4, v3

    goto :goto_93

    .line 11391
    :catch_92
    move-exception v3

    :goto_93
    nop

    .line 11392
    if-eqz v4, :cond_c1

    invoke-virtual {v4}, Lcom/android/server/pm/SharedUserSetting;->isPrivileged()Z

    move-result v3

    if-eqz v3, :cond_c1

    .line 11397
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 11398
    :try_start_9f
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    const-string v6, "android"

    invoke-virtual {v5, v6}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 11399
    .local v5, "platformPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v6, v5, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v6, v6, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v6, v6, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    iget-object v7, p5, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v7, v7, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    invoke-static {v6, v7}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v6

    if-eqz v6, :cond_bc

    .line 11401
    or-int/2addr p1, v2

    .line 11403
    .end local v5  # "platformPkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_bc
    monitor-exit v3

    goto :goto_c1

    :catchall_be
    move-exception v2

    monitor-exit v3
    :try_end_c0
    .catchall {:try_start_9f .. :try_end_c0} :catchall_be

    throw v2

    .line 11407
    .end local v4  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    :cond_c1
    :goto_c1
    return p1
.end method

.method private allHavePackage(Ljava/util/List;Ljava/lang/String;)Z
    .registers 9
    .param p2, "packageName"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;",
            "Ljava/lang/String;",
            ")Z"
        }
    .end annotation

    .line 7124
    .local p1, "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-static {p1}, Lcom/android/internal/util/ArrayUtils;->isEmpty(Ljava/util/Collection;)Z

    move-result v0

    const/4 v1, 0x0

    if-eqz v0, :cond_8

    .line 7125
    return v1

    .line 7127
    :cond_8
    const/4 v0, 0x0

    .local v0, "i":I
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v2

    .local v2, "N":I
    :goto_d
    if-ge v0, v2, :cond_2a

    .line 7128
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    .line 7129
    .local v3, "ri":Landroid/content/pm/ResolveInfo;
    if-eqz v3, :cond_1a

    iget-object v4, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    goto :goto_1b

    :cond_1a
    const/4 v4, 0x0

    .line 7130
    .local v4, "ai":Landroid/content/pm/ActivityInfo;
    :goto_1b
    if-eqz v4, :cond_29

    iget-object v5, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_26

    goto :goto_29

    .line 7127
    .end local v3  # "ri":Landroid/content/pm/ResolveInfo;
    .end local v4  # "ai":Landroid/content/pm/ActivityInfo;
    :cond_26
    add-int/lit8 v0, v0, 0x1

    goto :goto_d

    .line 7131
    .restart local v3  # "ri":Landroid/content/pm/ResolveInfo;
    .restart local v4  # "ai":Landroid/content/pm/ActivityInfo;
    :cond_29
    :goto_29
    return v1

    .line 7134
    .end local v0  # "i":I
    .end local v2  # "N":I
    .end local v3  # "ri":Landroid/content/pm/ResolveInfo;
    .end local v4  # "ai":Landroid/content/pm/ActivityInfo;
    :cond_2a
    const/4 v0, 0x1

    return v0
.end method

.method private static apkHasCode(Ljava/lang/String;)Z
    .registers 4
    .param p0, "fileName"  # Ljava/lang/String;

    .line 12031
    const/4 v0, 0x0

    .line 12033
    .local v0, "jarFile":Landroid/util/jar/StrictJarFile;
    const/4 v1, 0x0

    :try_start_2
    new-instance v2, Landroid/util/jar/StrictJarFile;

    invoke-direct {v2, p0, v1, v1}, Landroid/util/jar/StrictJarFile;-><init>(Ljava/lang/String;ZZ)V

    move-object v0, v2

    .line 12035
    const-string v2, "classes.dex"

    invoke-virtual {v0, v2}, Landroid/util/jar/StrictJarFile;->findEntry(Ljava/lang/String;)Ljava/util/zip/ZipEntry;

    move-result-object v2
    :try_end_e
    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_e} :catch_22
    .catchall {:try_start_2 .. :try_end_e} :catchall_19

    if-eqz v2, :cond_11

    const/4 v1, 0x1

    .line 12039
    :cond_11
    nop

    .line 12040
    :try_start_12
    invoke-virtual {v0}, Landroid/util/jar/StrictJarFile;->close()V
    :try_end_15
    .catch Ljava/io/IOException; {:try_start_12 .. :try_end_15} :catch_16

    .line 12042
    :goto_15
    goto :goto_18

    :catch_16
    move-exception v2

    goto :goto_15

    .line 12035
    :goto_18
    return v1

    .line 12038
    :catchall_19
    move-exception v1

    .line 12039
    if-eqz v0, :cond_21

    .line 12040
    :try_start_1c
    invoke-virtual {v0}, Landroid/util/jar/StrictJarFile;->close()V
    :try_end_1f
    .catch Ljava/io/IOException; {:try_start_1c .. :try_end_1f} :catch_20

    goto :goto_21

    .line 12042
    :catch_20
    move-exception v2

    :cond_21
    :goto_21
    throw v1

    .line 12036
    :catch_22
    move-exception v2

    .line 12039
    if-eqz v0, :cond_2b

    .line 12040
    :try_start_25
    invoke-virtual {v0}, Landroid/util/jar/StrictJarFile;->close()V
    :try_end_28
    .catch Ljava/io/IOException; {:try_start_25 .. :try_end_28} :catch_29

    goto :goto_2b

    .line 12042
    :catch_29
    move-exception v2

    .line 12043
    goto :goto_2c

    .line 12042
    :cond_2b
    :goto_2b
    nop

    .line 12044
    :goto_2c
    return v1
.end method

.method private applyDefiningSharedLibraryUpdateLocked(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/SharedLibraryInfo;Ljava/util/function/BiConsumer;)V
    .registers 8
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "libInfo"  # Landroid/content/pm/SharedLibraryInfo;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageParser$Package;",
            "Landroid/content/pm/SharedLibraryInfo;",
            "Ljava/util/function/BiConsumer<",
            "Landroid/content/pm/SharedLibraryInfo;",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;)V"
        }
    .end annotation

    .line 10903
    .local p3, "action":Ljava/util/function/BiConsumer;, "Ljava/util/function/BiConsumer<Landroid/content/pm/SharedLibraryInfo;Landroid/content/pm/SharedLibraryInfo;>;"
    invoke-virtual {p1}, Landroid/content/pm/PackageParser$Package;->isLibrary()Z

    move-result v0

    if-eqz v0, :cond_36

    .line 10904
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-eqz v0, :cond_18

    .line 10905
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    iget-wide v1, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibVersion:J

    invoke-direct {p0, v0, v1, v2}, Lcom/android/server/pm/PackageManagerService;->getSharedLibraryInfoLPr(Ljava/lang/String;J)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v0

    .line 10907
    .local v0, "definedLibrary":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v0, :cond_17

    .line 10908
    invoke-interface {p3, v0, p2}, Ljava/util/function/BiConsumer;->accept(Ljava/lang/Object;Ljava/lang/Object;)V

    .line 10910
    .end local v0  # "definedLibrary":Landroid/content/pm/SharedLibraryInfo;
    :cond_17
    goto :goto_36

    .line 10911
    :cond_18
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_1e
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_36

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/lang/String;

    .line 10912
    .local v1, "libraryName":Ljava/lang/String;
    const-wide/16 v2, -0x1

    invoke-direct {p0, v1, v2, v3}, Lcom/android/server/pm/PackageManagerService;->getSharedLibraryInfoLPr(Ljava/lang/String;J)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v2

    .line 10914
    .local v2, "definedLibrary":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v2, :cond_35

    .line 10915
    invoke-interface {p3, v2, p2}, Ljava/util/function/BiConsumer;->accept(Ljava/lang/Object;Ljava/lang/Object;)V

    .line 10917
    .end local v1  # "libraryName":Ljava/lang/String;
    .end local v2  # "definedLibrary":Landroid/content/pm/SharedLibraryInfo;
    :cond_35
    goto :goto_1e

    .line 10920
    :cond_36
    :goto_36
    return-void
.end method

.method private static applyPolicy(Landroid/content/pm/PackageParser$Package;IILandroid/content/pm/PackageParser$Package;)V
    .registers 13
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "parseFlags"  # I
    .param p2, "scanFlags"  # I
    .param p3, "platformPkg"  # Landroid/content/pm/PackageParser$Package;

    .line 12084
    const/high16 v0, 0x20000

    and-int v1, p2, v0

    const/4 v2, 0x0

    const/4 v3, 0x0

    const/4 v4, 0x1

    if-eqz v1, :cond_8f

    .line 12085
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v1, Landroid/content/pm/ApplicationInfo;->flags:I

    or-int/2addr v5, v4

    iput v5, v1, Landroid/content/pm/ApplicationInfo;->flags:I

    .line 12086
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v1}, Landroid/content/pm/ApplicationInfo;->isDirectBootAware()Z

    move-result v1

    if-eqz v1, :cond_84

    .line 12088
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->services:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_1e
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_33

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Service;

    .line 12089
    .local v5, "s":Landroid/content/pm/PackageParser$Service;
    iget-object v6, v5, Landroid/content/pm/PackageParser$Service;->info:Landroid/content/pm/ServiceInfo;

    iget-object v7, v5, Landroid/content/pm/PackageParser$Service;->info:Landroid/content/pm/ServiceInfo;

    iput-boolean v4, v7, Landroid/content/pm/ServiceInfo;->directBootAware:Z

    iput-boolean v4, v6, Landroid/content/pm/ServiceInfo;->encryptionAware:Z

    .line 12090
    .end local v5  # "s":Landroid/content/pm/PackageParser$Service;
    goto :goto_1e

    .line 12091
    :cond_33
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->providers:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_39
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_4e

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Provider;

    .line 12092
    .local v5, "p":Landroid/content/pm/PackageParser$Provider;
    iget-object v6, v5, Landroid/content/pm/PackageParser$Provider;->info:Landroid/content/pm/ProviderInfo;

    iget-object v7, v5, Landroid/content/pm/PackageParser$Provider;->info:Landroid/content/pm/ProviderInfo;

    iput-boolean v4, v7, Landroid/content/pm/ProviderInfo;->directBootAware:Z

    iput-boolean v4, v6, Landroid/content/pm/ProviderInfo;->encryptionAware:Z

    .line 12093
    .end local v5  # "p":Landroid/content/pm/PackageParser$Provider;
    goto :goto_39

    .line 12094
    :cond_4e
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_54
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_69

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Activity;

    .line 12095
    .local v5, "a":Landroid/content/pm/PackageParser$Activity;
    iget-object v6, v5, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iget-object v7, v5, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iput-boolean v4, v7, Landroid/content/pm/ActivityInfo;->directBootAware:Z

    iput-boolean v4, v6, Landroid/content/pm/ActivityInfo;->encryptionAware:Z

    .line 12096
    .end local v5  # "a":Landroid/content/pm/PackageParser$Activity;
    goto :goto_54

    .line 12097
    :cond_69
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->receivers:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_6f
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_84

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Activity;

    .line 12098
    .local v5, "r":Landroid/content/pm/PackageParser$Activity;
    iget-object v6, v5, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iget-object v7, v5, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iput-boolean v4, v7, Landroid/content/pm/ActivityInfo;->directBootAware:Z

    iput-boolean v4, v6, Landroid/content/pm/ActivityInfo;->encryptionAware:Z

    .line 12099
    .end local v5  # "r":Landroid/content/pm/PackageParser$Activity;
    goto :goto_6f

    .line 12101
    :cond_84
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-static {v1}, Lcom/android/server/pm/PackageManagerServiceUtils;->compressedFileExists(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_cf

    .line 12102
    iput-boolean v4, p0, Landroid/content/pm/PackageParser$Package;->isStub:Z

    goto :goto_cf

    .line 12106
    :cond_8f
    iput-boolean v3, p0, Landroid/content/pm/PackageParser$Package;->coreApp:Z

    .line 12108
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v1, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v5, v5, -0x9

    iput v5, v1, Landroid/content/pm/ApplicationInfo;->flags:I

    .line 12110
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    and-int/lit8 v5, v5, -0x21

    iput v5, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12112
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    and-int/lit8 v5, v5, -0x41

    iput v5, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12115
    iput-object v2, p0, Landroid/content/pm/PackageParser$Package;->protectedBroadcasts:Ljava/util/ArrayList;

    .line 12117
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->permissionGroups:Ljava/util/ArrayList;

    if-eqz v1, :cond_cf

    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->permissionGroups:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_cf

    .line 12118
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->permissionGroups:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    sub-int/2addr v1, v4

    .local v1, "i":I
    :goto_be
    if-ltz v1, :cond_cf

    .line 12119
    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->permissionGroups:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$PermissionGroup;

    iget-object v5, v5, Landroid/content/pm/PackageParser$PermissionGroup;->info:Landroid/content/pm/PermissionGroupInfo;

    iput v3, v5, Landroid/content/pm/PermissionGroupInfo;->priority:I

    .line 12118
    add-int/lit8 v1, v1, -0x1

    goto :goto_be

    .line 12123
    .end local v1  # "i":I
    :cond_cf
    :goto_cf
    const/high16 v1, 0x40000

    and-int v5, p2, v1

    const/high16 v6, 0x40000000  # 2.0f

    if-nez v5, :cond_140

    .line 12125
    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->receivers:Ljava/util/ArrayList;

    if-eqz v5, :cond_fa

    .line 12126
    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->receivers:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    sub-int/2addr v5, v4

    .local v5, "i":I
    :goto_e2
    if-ltz v5, :cond_fa

    .line 12127
    iget-object v7, p0, Landroid/content/pm/PackageParser$Package;->receivers:Ljava/util/ArrayList;

    invoke-virtual {v7, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Landroid/content/pm/PackageParser$Activity;

    .line 12128
    .local v7, "receiver":Landroid/content/pm/PackageParser$Activity;
    iget-object v8, v7, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/2addr v8, v6

    if-eqz v8, :cond_f7

    .line 12129
    iget-object v8, v7, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iput-boolean v3, v8, Landroid/content/pm/ActivityInfo;->exported:Z

    .line 12126
    .end local v7  # "receiver":Landroid/content/pm/PackageParser$Activity;
    :cond_f7
    add-int/lit8 v5, v5, -0x1

    goto :goto_e2

    .line 12134
    .end local v5  # "i":I
    :cond_fa
    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->services:Ljava/util/ArrayList;

    if-eqz v5, :cond_11d

    .line 12135
    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->services:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    sub-int/2addr v5, v4

    .restart local v5  # "i":I
    :goto_105
    if-ltz v5, :cond_11d

    .line 12136
    iget-object v7, p0, Landroid/content/pm/PackageParser$Package;->services:Ljava/util/ArrayList;

    invoke-virtual {v7, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Landroid/content/pm/PackageParser$Service;

    .line 12137
    .local v7, "service":Landroid/content/pm/PackageParser$Service;
    iget-object v8, v7, Landroid/content/pm/PackageParser$Service;->info:Landroid/content/pm/ServiceInfo;

    iget v8, v8, Landroid/content/pm/ServiceInfo;->flags:I

    and-int/2addr v8, v6

    if-eqz v8, :cond_11a

    .line 12138
    iget-object v8, v7, Landroid/content/pm/PackageParser$Service;->info:Landroid/content/pm/ServiceInfo;

    iput-boolean v3, v8, Landroid/content/pm/ServiceInfo;->exported:Z

    .line 12135
    .end local v7  # "service":Landroid/content/pm/PackageParser$Service;
    :cond_11a
    add-int/lit8 v5, v5, -0x1

    goto :goto_105

    .line 12143
    .end local v5  # "i":I
    :cond_11d
    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->providers:Ljava/util/ArrayList;

    if-eqz v5, :cond_140

    .line 12144
    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->providers:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    sub-int/2addr v5, v4

    .restart local v5  # "i":I
    :goto_128
    if-ltz v5, :cond_140

    .line 12145
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->providers:Ljava/util/ArrayList;

    invoke-virtual {v4, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/PackageParser$Provider;

    .line 12146
    .local v4, "provider":Landroid/content/pm/PackageParser$Provider;
    iget-object v7, v4, Landroid/content/pm/PackageParser$Provider;->info:Landroid/content/pm/ProviderInfo;

    iget v7, v7, Landroid/content/pm/ProviderInfo;->flags:I

    and-int/2addr v7, v6

    if-eqz v7, :cond_13d

    .line 12147
    iget-object v7, v4, Landroid/content/pm/PackageParser$Provider;->info:Landroid/content/pm/ProviderInfo;

    iput-boolean v3, v7, Landroid/content/pm/ProviderInfo;->exported:Z

    .line 12144
    .end local v4  # "provider":Landroid/content/pm/PackageParser$Provider;
    :cond_13d
    add-int/lit8 v5, v5, -0x1

    goto :goto_128

    .line 12153
    .end local v5  # "i":I
    :cond_140
    and-int v3, p2, v1

    if-eqz v3, :cond_14c

    .line 12154
    iget-object v3, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v4, v3, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    or-int/lit8 v4, v4, 0x8

    iput v4, v3, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12157
    :cond_14c
    const/high16 v3, 0x80000

    and-int v4, p2, v3

    if-eqz v4, :cond_159

    .line 12158
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v4, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    or-int/2addr v0, v5

    iput v0, v4, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12161
    :cond_159
    const/high16 v0, 0x100000

    and-int v4, p2, v0

    if-eqz v4, :cond_166

    .line 12162
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v4, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    or-int/2addr v1, v5

    iput v1, v4, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12165
    :cond_166
    const/high16 v1, 0x200000

    and-int v4, p2, v1

    if-eqz v4, :cond_173

    .line 12166
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v4, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    or-int/2addr v3, v5

    iput v3, v4, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12169
    :cond_173
    const/high16 v3, 0x400000

    and-int/2addr v3, p2

    if-eqz v3, :cond_17f

    .line 12170
    iget-object v3, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v4, v3, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    or-int/2addr v1, v4

    iput v1, v3, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12173
    :cond_17f
    const/high16 v1, 0x800000

    and-int/2addr v1, p2

    if-eqz v1, :cond_18b

    .line 12174
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    or-int/2addr v3, v6

    iput v3, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12178
    :cond_18b
    const/high16 v1, 0x1000000

    and-int/2addr v1, p2

    if-eqz v1, :cond_199

    .line 12179
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v4, -0x80000000

    or-int/2addr v3, v4

    iput v3, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12183
    :cond_199
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const-string v3, "android"

    invoke-virtual {v3, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-nez v1, :cond_1b3

    if-eqz p3, :cond_1ba

    iget-object v1, p3, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v1, v1, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    iget-object v3, p0, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v3, v3, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .line 12184
    invoke-static {v1, v3}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v1

    if-nez v1, :cond_1ba

    .line 12187
    :cond_1b3
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    or-int/2addr v0, v3

    iput v0, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 12191
    :cond_1ba
    invoke-static {p0}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-nez v0, :cond_1c6

    .line 12193
    iput-object v2, p0, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    .line 12194
    iput-object v2, p0, Landroid/content/pm/PackageParser$Package;->mRealPackage:Ljava/lang/String;

    .line 12195
    iput-object v2, p0, Landroid/content/pm/PackageParser$Package;->mAdoptPermissions:Ljava/util/ArrayList;

    .line 12198
    :cond_1c6
    invoke-static {p0}, Landroid/content/pm/PackageBackwardCompatibility;->modifySharedLibraries(Landroid/content/pm/PackageParser$Package;)V

    .line 12199
    return-void
.end method

.method private applyPostContentProviderResolutionFilter(Ljava/util/List;Ljava/lang/String;)Ljava/util/List;
    .registers 14
    .param p2, "instantAppPkgName"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;",
            "Ljava/lang/String;",
            ")",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8816
    .local p1, "resolveInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-nez p2, :cond_3

    .line 8817
    return-object p1

    .line 8819
    :cond_3
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v0

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_9
    if-ltz v0, :cond_89

    .line 8820
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/ResolveInfo;

    .line 8821
    .local v1, "info":Landroid/content/pm/ResolveInfo;
    iget-object v2, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    iget-object v2, v2, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v2}, Landroid/content/pm/ApplicationInfo;->isInstantApp()Z

    move-result v2

    .line 8823
    .local v2, "isEphemeralApp":Z
    if-eqz v2, :cond_77

    iget-object v3, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    iget-object v3, v3, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_77

    .line 8824
    iget-object v3, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    iget-object v3, v3, Landroid/content/pm/ProviderInfo;->splitName:Ljava/lang/String;

    if-eqz v3, :cond_86

    iget-object v3, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    iget-object v3, v3, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->splitNames:[Ljava/lang/String;

    iget-object v4, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    iget-object v4, v4, Landroid/content/pm/ProviderInfo;->splitName:Ljava/lang/String;

    .line 8825
    invoke-static {v3, v4}, Lcom/android/internal/util/ArrayUtils;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_86

    .line 8829
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v3, :cond_46

    .line 8830
    const-string v3, "PackageManager"

    const-string v4, "Adding ephemeral installer to the ResolveInfo list"

    invoke-static {v3, v4}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8832
    :cond_46
    new-instance v3, Landroid/content/pm/ResolveInfo;

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerInfo:Landroid/content/pm/ResolveInfo;

    invoke-direct {v3, v4}, Landroid/content/pm/ResolveInfo;-><init>(Landroid/content/pm/ResolveInfo;)V

    .line 8834
    .local v3, "installerInfo":Landroid/content/pm/ResolveInfo;
    new-instance v10, Landroid/content/pm/AuxiliaryResolveInfo;

    const/4 v5, 0x0

    iget-object v4, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    iget-object v6, v4, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    iget-object v4, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    iget-object v4, v4, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-wide v7, v4, Landroid/content/pm/ApplicationInfo;->longVersionCode:J

    iget-object v4, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    iget-object v9, v4, Landroid/content/pm/ProviderInfo;->splitName:Ljava/lang/String;

    move-object v4, v10

    invoke-direct/range {v4 .. v9}, Landroid/content/pm/AuxiliaryResolveInfo;-><init>(Landroid/content/ComponentName;Ljava/lang/String;JLjava/lang/String;)V

    iput-object v10, v3, Landroid/content/pm/ResolveInfo;->auxiliaryInfo:Landroid/content/pm/AuxiliaryResolveInfo;

    .line 8840
    new-instance v4, Landroid/content/IntentFilter;

    invoke-direct {v4}, Landroid/content/IntentFilter;-><init>()V

    iput-object v4, v3, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    .line 8842
    invoke-virtual {v1}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v4

    iget-object v4, v4, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    iput-object v4, v3, Landroid/content/pm/ResolveInfo;->resolvePackageName:Ljava/lang/String;

    .line 8843
    invoke-interface {p1, v0, v3}, Ljava/util/List;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 8844
    .end local v3  # "installerInfo":Landroid/content/pm/ResolveInfo;
    goto :goto_86

    .line 8848
    :cond_77
    if-nez v2, :cond_83

    iget-object v3, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    iget v3, v3, Landroid/content/pm/ProviderInfo;->flags:I

    const/high16 v4, 0x100000

    and-int/2addr v3, v4

    if-eqz v3, :cond_83

    .line 8850
    goto :goto_86

    .line 8852
    :cond_83
    invoke-interface {p1, v0}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 8819
    .end local v1  # "info":Landroid/content/pm/ResolveInfo;
    .end local v2  # "isEphemeralApp":Z
    :cond_86
    :goto_86
    add-int/lit8 v0, v0, -0x1

    goto :goto_9

    .line 8854
    .end local v0  # "i":I
    :cond_89
    return-object p1
.end method

.method private applyPostResolutionFilter(Ljava/util/List;Ljava/lang/String;ZIZILandroid/content/Intent;)Ljava/util/List;
    .registers 27
    .param p2, "ephemeralPkgName"  # Ljava/lang/String;
    .param p3, "allowDynamicSplits"  # Z
    .param p4, "filterCallingUid"  # I
    .param p5, "resolveForStart"  # Z
    .param p6, "userId"  # I
    .param p7, "intent"  # Landroid/content/Intent;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;",
            "Ljava/lang/String;",
            "ZIZI",
            "Landroid/content/Intent;",
            ")",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 7922
    .local p1, "resolveInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    move/from16 v3, p6

    invoke-virtual/range {p7 .. p7}, Landroid/content/Intent;->isWebIntent()Z

    move-result v4

    const/4 v5, 0x1

    if-eqz v4, :cond_17

    invoke-direct {v0, v3}, Lcom/android/server/pm/PackageManagerService;->areWebInstantAppsDisabled(I)Z

    move-result v4

    if-eqz v4, :cond_17

    move v4, v5

    goto :goto_18

    :cond_17
    const/4 v4, 0x0

    .line 7923
    .local v4, "blockInstant":Z
    :goto_18
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v6

    sub-int/2addr v6, v5

    .local v6, "i":I
    :goto_1d
    if-ltz v6, :cond_11e

    .line 7924
    invoke-interface {v1, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Landroid/content/pm/ResolveInfo;

    .line 7926
    .local v7, "info":Landroid/content/pm/ResolveInfo;
    iget-boolean v8, v7, Landroid/content/pm/ResolveInfo;->isInstantAppAvailable:Z

    if-eqz v8, :cond_32

    if-eqz v4, :cond_32

    .line 7927
    invoke-interface {v1, v6}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 7928
    move/from16 v10, p4

    goto/16 :goto_11a

    .line 7931
    :cond_32
    if-eqz p3, :cond_d6

    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    if-eqz v8, :cond_d6

    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->splitName:Ljava/lang/String;

    if-eqz v8, :cond_d6

    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->splitNames:[Ljava/lang/String;

    iget-object v9, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v9, v9, Landroid/content/pm/ActivityInfo;->splitName:Ljava/lang/String;

    .line 7934
    invoke-static {v8, v9}, Lcom/android/internal/util/ArrayUtils;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v8

    if-nez v8, :cond_d3

    .line 7936
    iget-object v8, v0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    const-string v9, "PackageManager"

    if-nez v8, :cond_64

    .line 7937
    sget-boolean v8, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v8, :cond_5d

    .line 7938
    const-string v8, "No installer - not adding it to the ResolveInfo list"

    invoke-static {v9, v8}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7940
    :cond_5d
    invoke-interface {v1, v6}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 7941
    move/from16 v10, p4

    goto/16 :goto_11a

    .line 7943
    :cond_64
    if-eqz v4, :cond_77

    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v8, v3}, Lcom/android/server/pm/PackageManagerService;->isInstantApp(Ljava/lang/String;I)Z

    move-result v8

    if-eqz v8, :cond_77

    .line 7944
    invoke-interface {v1, v6}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 7945
    move/from16 v10, p4

    goto/16 :goto_11a

    .line 7949
    :cond_77
    sget-boolean v8, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v8, :cond_80

    .line 7950
    const-string v8, "Adding installer to the ResolveInfo list"

    invoke-static {v9, v8}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7952
    :cond_80
    new-instance v8, Landroid/content/pm/ResolveInfo;

    iget-object v9, v0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerInfo:Landroid/content/pm/ResolveInfo;

    invoke-direct {v8, v9}, Landroid/content/pm/ResolveInfo;-><init>(Landroid/content/pm/ResolveInfo;)V

    .line 7954
    .local v8, "installerInfo":Landroid/content/pm/ResolveInfo;
    iget-object v9, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v9, v9, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move/from16 v10, p4

    invoke-direct {v0, v9, v10, v3}, Lcom/android/server/pm/PackageManagerService;->findInstallFailureActivity(Ljava/lang/String;II)Landroid/content/ComponentName;

    move-result-object v9

    .line 7956
    .local v9, "installFailureActivity":Landroid/content/ComponentName;
    new-instance v14, Landroid/content/pm/AuxiliaryResolveInfo;

    iget-object v11, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v13, v11, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v11, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v11, v11, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-wide v11, v11, Landroid/content/pm/ApplicationInfo;->longVersionCode:J

    iget-object v15, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v15, v15, Landroid/content/pm/ActivityInfo;->splitName:Ljava/lang/String;

    move-wide/from16 v16, v11

    move-object v11, v14

    move-object v12, v9

    move-object v5, v14

    move-object/from16 v18, v15

    move-wide/from16 v14, v16

    move-object/from16 v16, v18

    invoke-direct/range {v11 .. v16}, Landroid/content/pm/AuxiliaryResolveInfo;-><init>(Landroid/content/ComponentName;Ljava/lang/String;JLjava/lang/String;)V

    iput-object v5, v8, Landroid/content/pm/ResolveInfo;->auxiliaryInfo:Landroid/content/pm/AuxiliaryResolveInfo;

    .line 7962
    new-instance v5, Landroid/content/IntentFilter;

    invoke-direct {v5}, Landroid/content/IntentFilter;-><init>()V

    iput-object v5, v8, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    .line 7967
    invoke-virtual {v7}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v5

    iget-object v5, v5, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    iput-object v5, v8, Landroid/content/pm/ResolveInfo;->resolvePackageName:Ljava/lang/String;

    .line 7968
    invoke-virtual {v7}, Landroid/content/pm/ResolveInfo;->resolveLabelResId()I

    move-result v5

    iput v5, v8, Landroid/content/pm/ResolveInfo;->labelRes:I

    .line 7969
    invoke-virtual {v7}, Landroid/content/pm/ResolveInfo;->resolveIconResId()I

    move-result v5

    iput v5, v8, Landroid/content/pm/ResolveInfo;->icon:I

    .line 7970
    const/4 v5, 0x1

    iput-boolean v5, v8, Landroid/content/pm/ResolveInfo;->isInstantAppAvailable:Z

    .line 7971
    invoke-interface {v1, v6, v8}, Ljava/util/List;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 7972
    goto :goto_11a

    .line 7934
    .end local v8  # "installerInfo":Landroid/content/pm/ResolveInfo;
    .end local v9  # "installFailureActivity":Landroid/content/ComponentName;
    :cond_d3
    move/from16 v10, p4

    goto :goto_d8

    .line 7931
    :cond_d6
    move/from16 v10, p4

    .line 7975
    :goto_d8
    if-nez v2, :cond_db

    .line 7976
    goto :goto_11a

    .line 7977
    :cond_db
    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_e6

    .line 7979
    goto :goto_11a

    .line 7980
    :cond_e6
    if-eqz p5, :cond_103

    .line 7981
    invoke-virtual/range {p7 .. p7}, Landroid/content/Intent;->isWebIntent()Z

    move-result v8

    if-nez v8, :cond_f6

    .line 7982
    invoke-virtual/range {p7 .. p7}, Landroid/content/Intent;->getFlags()I

    move-result v8

    and-int/lit16 v8, v8, 0x800

    if-eqz v8, :cond_103

    .line 7983
    :cond_f6
    invoke-virtual/range {p7 .. p7}, Landroid/content/Intent;->getPackage()Ljava/lang/String;

    move-result-object v8

    if-nez v8, :cond_103

    .line 7984
    invoke-virtual/range {p7 .. p7}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v8

    if-nez v8, :cond_103

    .line 7986
    goto :goto_11a

    .line 7989
    :cond_103
    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v8}, Landroid/content/pm/ApplicationInfo;->isInstantApp()Z

    move-result v8

    .line 7990
    .local v8, "isEphemeralApp":Z
    if-nez v8, :cond_117

    iget-object v9, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget v9, v9, Landroid/content/pm/ActivityInfo;->flags:I

    const/high16 v11, 0x100000

    and-int/2addr v9, v11

    if-eqz v9, :cond_117

    .line 7992
    goto :goto_11a

    .line 7994
    :cond_117
    invoke-interface {v1, v6}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 7923
    .end local v7  # "info":Landroid/content/pm/ResolveInfo;
    .end local v8  # "isEphemeralApp":Z
    :goto_11a
    add-int/lit8 v6, v6, -0x1

    goto/16 :goto_1d

    :cond_11e
    move/from16 v10, p4

    .line 7996
    .end local v6  # "i":I
    return-object v1
.end method

.method private applyPostServiceResolutionFilter(Ljava/util/List;Ljava/lang/String;)Ljava/util/List;
    .registers 14
    .param p2, "instantAppPkgName"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;",
            "Ljava/lang/String;",
            ")",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8698
    .local p1, "resolveInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-nez p2, :cond_3

    .line 8699
    return-object p1

    .line 8701
    :cond_3
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v0

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_9
    if-ltz v0, :cond_89

    .line 8702
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/ResolveInfo;

    .line 8703
    .local v1, "info":Landroid/content/pm/ResolveInfo;
    iget-object v2, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v2, v2, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v2}, Landroid/content/pm/ApplicationInfo;->isInstantApp()Z

    move-result v2

    .line 8705
    .local v2, "isEphemeralApp":Z
    if-eqz v2, :cond_77

    iget-object v3, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v3, v3, Landroid/content/pm/ServiceInfo;->packageName:Ljava/lang/String;

    invoke-virtual {p2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_77

    .line 8706
    iget-object v3, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v3, v3, Landroid/content/pm/ServiceInfo;->splitName:Ljava/lang/String;

    if-eqz v3, :cond_86

    iget-object v3, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v3, v3, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->splitNames:[Ljava/lang/String;

    iget-object v4, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v4, v4, Landroid/content/pm/ServiceInfo;->splitName:Ljava/lang/String;

    .line 8707
    invoke-static {v3, v4}, Lcom/android/internal/util/ArrayUtils;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_86

    .line 8711
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v3, :cond_46

    .line 8712
    const-string v3, "PackageManager"

    const-string v4, "Adding ephemeral installer to the ResolveInfo list"

    invoke-static {v3, v4}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8714
    :cond_46
    new-instance v3, Landroid/content/pm/ResolveInfo;

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerInfo:Landroid/content/pm/ResolveInfo;

    invoke-direct {v3, v4}, Landroid/content/pm/ResolveInfo;-><init>(Landroid/content/pm/ResolveInfo;)V

    .line 8716
    .local v3, "installerInfo":Landroid/content/pm/ResolveInfo;
    new-instance v10, Landroid/content/pm/AuxiliaryResolveInfo;

    const/4 v5, 0x0

    iget-object v4, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v6, v4, Landroid/content/pm/ServiceInfo;->packageName:Ljava/lang/String;

    iget-object v4, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v4, v4, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-wide v7, v4, Landroid/content/pm/ApplicationInfo;->longVersionCode:J

    iget-object v4, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v9, v4, Landroid/content/pm/ServiceInfo;->splitName:Ljava/lang/String;

    move-object v4, v10

    invoke-direct/range {v4 .. v9}, Landroid/content/pm/AuxiliaryResolveInfo;-><init>(Landroid/content/ComponentName;Ljava/lang/String;JLjava/lang/String;)V

    iput-object v10, v3, Landroid/content/pm/ResolveInfo;->auxiliaryInfo:Landroid/content/pm/AuxiliaryResolveInfo;

    .line 8722
    new-instance v4, Landroid/content/IntentFilter;

    invoke-direct {v4}, Landroid/content/IntentFilter;-><init>()V

    iput-object v4, v3, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    .line 8724
    invoke-virtual {v1}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v4

    iget-object v4, v4, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    iput-object v4, v3, Landroid/content/pm/ResolveInfo;->resolvePackageName:Ljava/lang/String;

    .line 8725
    invoke-interface {p1, v0, v3}, Ljava/util/List;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 8726
    .end local v3  # "installerInfo":Landroid/content/pm/ResolveInfo;
    goto :goto_86

    .line 8730
    :cond_77
    if-nez v2, :cond_83

    iget-object v3, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget v3, v3, Landroid/content/pm/ServiceInfo;->flags:I

    const/high16 v4, 0x100000

    and-int/2addr v3, v4

    if-eqz v3, :cond_83

    .line 8732
    goto :goto_86

    .line 8734
    :cond_83
    invoke-interface {p1, v0}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 8701
    .end local v1  # "info":Landroid/content/pm/ResolveInfo;
    .end local v2  # "isEphemeralApp":Z
    :cond_86
    :goto_86
    add-int/lit8 v0, v0, -0x1

    goto :goto_9

    .line 8736
    .end local v0  # "i":I
    :cond_89
    return-object p1
.end method

.method private areWebInstantAppsDisabled(I)Z
    .registers 3
    .param p1, "userId"  # I

    .line 6939
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mWebInstantAppsDisabled:Landroid/util/SparseBooleanArray;

    invoke-virtual {v0, p1}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    return v0
.end method

.method static arrayToString([I)Ljava/lang/String;
    .registers 4
    .param p0, "array"  # [I

    .line 22754
    new-instance v0, Ljava/lang/StringBuilder;

    const/16 v1, 0x80

    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(I)V

    .line 22755
    .local v0, "stringBuilder":Ljava/lang/StringBuilder;
    const/16 v1, 0x5b

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;

    .line 22756
    if-eqz p0, :cond_21

    .line 22757
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_f
    array-length v2, p0

    if-ge v1, v2, :cond_21

    .line 22758
    if-lez v1, :cond_19

    const-string v2, ", "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 22759
    :cond_19
    aget v2, p0, v1

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 22757
    add-int/lit8 v1, v1, 0x1

    goto :goto_f

    .line 22762
    .end local v1  # "i":I
    :cond_21
    const/16 v1, 0x5d

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;

    .line 22763
    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    return-object v1
.end method

.method private static assertCodePolicy(Landroid/content/pm/PackageParser$Package;)V
    .registers 10
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 12056
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v0, v0, 0x4

    const/4 v1, 0x0

    const/4 v2, 0x1

    if-eqz v0, :cond_c

    move v0, v2

    goto :goto_d

    :cond_c
    move v0, v1

    .line 12058
    .local v0, "shouldHaveCode":Z
    :goto_d
    const-string v3, " code is missing"

    const-string v4, "Package "

    const/4 v5, -0x2

    if-eqz v0, :cond_37

    iget-object v6, p0, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-static {v6}, Lcom/android/server/pm/PackageManagerService;->apkHasCode(Ljava/lang/String;)Z

    move-result v6

    if-eqz v6, :cond_1d

    goto :goto_37

    .line 12059
    :cond_1d
    new-instance v1, Lcom/android/server/pm/PackageManagerException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v1, v5, v2}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v1

    .line 12063
    :cond_37
    :goto_37
    iget-object v6, p0, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    invoke-static {v6}, Lcom/android/internal/util/ArrayUtils;->isEmpty([Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_7c

    .line 12064
    const/4 v6, 0x0

    .local v6, "i":I
    :goto_40
    iget-object v7, p0, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    array-length v7, v7

    if-ge v6, v7, :cond_7c

    .line 12065
    iget-object v7, p0, Landroid/content/pm/PackageParser$Package;->splitFlags:[I

    aget v7, v7, v6

    and-int/lit8 v7, v7, 0x4

    if-eqz v7, :cond_4f

    move v7, v2

    goto :goto_50

    :cond_4f
    move v7, v1

    .line 12067
    .local v7, "splitShouldHaveCode":Z
    :goto_50
    if-eqz v7, :cond_79

    iget-object v8, p0, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    aget-object v8, v8, v6

    invoke-static {v8}, Lcom/android/server/pm/PackageManagerService;->apkHasCode(Ljava/lang/String;)Z

    move-result v8

    if-eqz v8, :cond_5d

    goto :goto_79

    .line 12068
    :cond_5d
    new-instance v1, Lcom/android/server/pm/PackageManagerException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    aget-object v4, v4, v6

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v1, v5, v2}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v1

    .line 12064
    .end local v7  # "splitShouldHaveCode":Z
    :cond_79
    :goto_79
    add-int/lit8 v6, v6, 0x1

    goto :goto_40

    .line 12073
    .end local v6  # "i":I
    :cond_7c
    return-void
.end method

.method private static assertNotNull(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/Object;
    .registers 4
    .param p1, "message"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "<T:",
            "Ljava/lang/Object;",
            ">(TT;",
            "Ljava/lang/String;",
            ")TT;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 12203
    .local p0, "object":Ljava/lang/Object;, "TT;"
    if-eqz p0, :cond_3

    .line 12206
    return-object p0

    .line 12204
    :cond_3
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const/16 v1, -0x6e

    invoke-direct {v0, v1, p1}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v0
.end method

.method private assertPackageIsValid(Landroid/content/pm/PackageParser$Package;II)V
    .registers 27
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 12221
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move/from16 v3, p3

    and-int/lit8 v0, p2, 0x40

    if-eqz v0, :cond_d

    .line 12222
    invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->assertCodePolicy(Landroid/content/pm/PackageParser$Package;)V

    .line 12225
    :cond_d
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v0}, Landroid/content/pm/ApplicationInfo;->getCodePath()Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_56b

    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 12226
    invoke-virtual {v0}, Landroid/content/pm/ApplicationInfo;->getResourcePath()Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_56b

    .line 12234
    and-int/lit8 v0, v3, 0x10

    const/4 v4, 0x1

    if-nez v0, :cond_24

    move v0, v4

    goto :goto_25

    :cond_24
    const/4 v0, 0x0

    :goto_25
    move v6, v0

    .line 12235
    .local v6, "isUserInstall":Z
    and-int/lit16 v0, v3, 0x2000

    if-eqz v0, :cond_2b

    goto :goto_2c

    :cond_2b
    const/4 v4, 0x0

    .line 12236
    .local v4, "isFirstBootOrUpgrade":Z
    :goto_2c
    const/4 v0, -0x5

    if-nez v6, :cond_31

    if-eqz v4, :cond_3b

    :cond_31
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 12237
    invoke-virtual {v7, v8}, Lcom/android/server/pm/ApexManager;->isApexPackage(Ljava/lang/String;)Z

    move-result v7

    if-nez v7, :cond_550

    .line 12243
    :cond_3b
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 12244
    .local v7, "ksms":Lcom/android/server/pm/KeySetManagerService;
    invoke-virtual {v7, v2}, Lcom/android/server/pm/KeySetManagerService;->assertScannedPackageValid(Landroid/content/pm/PackageParser$Package;)V

    .line 12247
    iget-object v8, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8

    .line 12249
    :try_start_45
    iget-object v9, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const-string v10, "android"

    invoke-virtual {v9, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v9
    :try_end_4d
    .catchall {:try_start_45 .. :try_end_4d} :catchall_549

    if-eqz v9, :cond_8e

    .line 12250
    :try_start_4f
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mAndroidApplication:Landroid/content/pm/ApplicationInfo;

    if-nez v9, :cond_54

    goto :goto_8e

    .line 12251
    :cond_54
    const-string v5, "PackageManager"

    const-string v9, "*************************************************"

    invoke-static {v5, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12252
    const-string v5, "PackageManager"

    const-string v9, "Core android package being redefined.  Skipping."

    invoke-static {v5, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12253
    const-string v5, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, " codePath="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v5, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12254
    const-string v5, "PackageManager"

    const-string v9, "*************************************************"

    invoke-static {v5, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12255
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    const-string v9, "Core android package being redefined.  Skipping."

    invoke-direct {v5, v0, v9}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v6  # "isUserInstall":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v5

    .line 12565
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :catchall_89
    move-exception v0

    move/from16 v20, v6

    goto/16 :goto_54c

    .line 12261
    :cond_8e
    :goto_8e
    and-int/lit8 v9, v3, 0x4

    if-nez v9, :cond_bb

    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v9

    if-nez v9, :cond_9d

    goto :goto_bb

    .line 12262
    :cond_9d
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Application package "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " already installed.  Skipping duplicate."

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-direct {v5, v0, v9}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v6  # "isUserInstall":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v5
    :try_end_bb
    .catchall {:try_start_4f .. :try_end_bb} :catchall_89

    .line 12267
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_bb
    :goto_bb
    :try_start_bb
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v0}, Landroid/content/pm/ApplicationInfo;->isStaticSharedLibrary()Z

    move-result v0
    :try_end_c1
    .catchall {:try_start_bb .. :try_end_c1} :catchall_549

    if-eqz v0, :cond_244

    .line 12270
    and-int/lit8 v0, v3, 0x4

    if-nez v0, :cond_da

    :try_start_c7
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v9, v2, Landroid/content/pm/PackageParser$Package;->manifestPackageName:Ljava/lang/String;

    .line 12271
    invoke-virtual {v0, v9}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_d2

    goto :goto_da

    .line 12272
    :cond_d2
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Duplicate static shared lib provider package"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v6  # "isUserInstall":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0
    :try_end_da
    .catchall {:try_start_c7 .. :try_end_da} :catchall_89

    .line 12277
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_da
    :goto_da
    :try_start_da
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    const/16 v9, 0x1a

    if-lt v0, v9, :cond_23a

    .line 12283
    and-int/lit16 v0, v3, 0x4000

    if-nez v0, :cond_230

    .line 12290
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    invoke-static {v0}, Lcom/android/internal/util/ArrayUtils;->isEmpty(Ljava/util/Collection;)Z

    move-result v0

    if-eqz v0, :cond_226

    .line 12296
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-static {v0}, Lcom/android/internal/util/ArrayUtils;->isEmpty(Ljava/util/Collection;)Z

    move-result v0

    if-eqz v0, :cond_21c

    .line 12302
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    invoke-static {v0}, Lcom/android/internal/util/ArrayUtils;->isEmpty(Ljava/util/Collection;)Z

    move-result v0

    if-eqz v0, :cond_212

    .line 12308
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    if-nez v0, :cond_208

    .line 12314
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->isEmpty()Z

    move-result v0

    if-eqz v0, :cond_1fe

    .line 12320
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->services:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->isEmpty()Z

    move-result v0

    if-eqz v0, :cond_1f4

    .line 12326
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->providers:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->isEmpty()Z

    move-result v0

    if-eqz v0, :cond_1ea

    .line 12332
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->receivers:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->isEmpty()Z

    move-result v0

    if-eqz v0, :cond_1e0

    .line 12338
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->permissionGroups:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->isEmpty()Z

    move-result v0

    if-eqz v0, :cond_1d6

    .line 12344
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->permissions:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->isEmpty()Z

    move-result v0

    if-eqz v0, :cond_1cc

    .line 12350
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->protectedBroadcasts:Ljava/util/ArrayList;

    if-nez v0, :cond_1c2

    .line 12356
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mOverlayTarget:Ljava/lang/String;

    if-nez v0, :cond_1b8

    .line 12362
    const-wide/high16 v9, -0x8000000000000000L

    .line 12363
    .local v9, "minVersionCode":J
    const-wide v11, 0x7fffffffffffffffL

    .line 12365
    .local v11, "maxVersionCode":J
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    iget-object v13, v2, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    invoke-virtual {v0, v13}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/util/LongSparseArray;

    .line 12367
    .local v0, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-eqz v0, :cond_19c

    .line 12368
    invoke-virtual {v0}, Landroid/util/LongSparseArray;->size()I

    move-result v13

    .line 12369
    .local v13, "versionCount":I
    const/4 v14, 0x0

    .local v14, "i":I
    :goto_152
    if-ge v14, v13, :cond_197

    .line 12370
    invoke-virtual {v0, v14}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Landroid/content/pm/SharedLibraryInfo;

    .line 12371
    .local v15, "libInfo":Landroid/content/pm/SharedLibraryInfo;
    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v16

    .line 12372
    invoke-virtual/range {v16 .. v16}, Landroid/content/pm/VersionedPackage;->getLongVersionCode()J

    move-result-wide v16

    .line 12373
    .local v16, "libVersionCode":J
    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v18
    :try_end_166
    .catchall {:try_start_da .. :try_end_166} :catchall_549

    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .local v20, "isUserInstall":Z
    :try_start_168
    iget-wide v5, v2, Landroid/content/pm/PackageParser$Package;->staticSharedLibVersion:J

    cmp-long v5, v18, v5

    const-wide/16 v18, 0x1

    if-gez v5, :cond_178

    .line 12374
    add-long v5, v16, v18

    invoke-static {v9, v10, v5, v6}, Ljava/lang/Math;->max(JJ)J

    move-result-wide v5

    move-wide v9, v5

    .end local v9  # "minVersionCode":J
    .local v5, "minVersionCode":J
    goto :goto_18d

    .line 12375
    .end local v5  # "minVersionCode":J
    .restart local v9  # "minVersionCode":J
    :cond_178
    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v5

    move-wide/from16 v21, v9

    .end local v9  # "minVersionCode":J
    .local v21, "minVersionCode":J
    iget-wide v9, v2, Landroid/content/pm/PackageParser$Package;->staticSharedLibVersion:J

    cmp-long v5, v5, v9

    if-lez v5, :cond_192

    .line 12376
    sub-long v5, v16, v18

    invoke-static {v11, v12, v5, v6}, Ljava/lang/Math;->min(JJ)J

    move-result-wide v5

    move-wide v11, v5

    move-wide/from16 v9, v21

    .line 12369
    .end local v15  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v16  # "libVersionCode":J
    .end local v21  # "minVersionCode":J
    .restart local v9  # "minVersionCode":J
    :goto_18d
    add-int/lit8 v14, v14, 0x1

    move/from16 v6, v20

    goto :goto_152

    .line 12378
    .end local v9  # "minVersionCode":J
    .restart local v15  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .restart local v16  # "libVersionCode":J
    .restart local v21  # "minVersionCode":J
    :cond_192
    move-wide/from16 v11, v16

    move-wide/from16 v9, v16

    .line 12379
    .end local v21  # "minVersionCode":J
    .restart local v9  # "minVersionCode":J
    goto :goto_19e

    .line 12369
    .end local v15  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v16  # "libVersionCode":J
    .end local v20  # "isUserInstall":Z
    .restart local v6  # "isUserInstall":Z
    :cond_197
    move/from16 v20, v6

    move-wide/from16 v21, v9

    .end local v6  # "isUserInstall":Z
    .end local v9  # "minVersionCode":J
    .restart local v20  # "isUserInstall":Z
    .restart local v21  # "minVersionCode":J
    goto :goto_19e

    .line 12367
    .end local v13  # "versionCount":I
    .end local v14  # "i":I
    .end local v20  # "isUserInstall":Z
    .end local v21  # "minVersionCode":J
    .restart local v6  # "isUserInstall":Z
    .restart local v9  # "minVersionCode":J
    :cond_19c
    move/from16 v20, v6

    .line 12383
    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    :goto_19e
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v5

    cmp-long v5, v5, v9

    if-ltz v5, :cond_1b0

    .line 12384
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v5

    cmp-long v5, v5, v11

    if-gtz v5, :cond_1b0

    goto/16 :goto_246

    .line 12385
    :cond_1b0
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    const-string v6, "Static shared lib version codes must be ordered as lib versions"

    invoke-direct {v5, v6}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v5

    .line 12357
    .end local v0  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v9  # "minVersionCode":J
    .end local v11  # "maxVersionCode":J
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_1b8
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Static shared libs cannot be overlay targets"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12351
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_1c2
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Static shared libs cannot declare protected broadcasts"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12345
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_1cc
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Static shared libs cannot declare permissions"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12339
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_1d6
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Static shared libs cannot declare permission groups"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12333
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_1e0
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Static shared libs cannot declare broadcast receivers"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12327
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_1ea
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Static shared libs cannot declare content providers"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12321
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_1f4
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Static shared libs cannot declare services"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12315
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_1fe
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Static shared libs cannot declare activities"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12309
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_208
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Packages declaring static-shared libs cannot declare shared users"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12303
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_212
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Packages declaring static-shared libs cannot declare dynamic libs"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12297
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_21c
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Packages declaring static-shared libs cannot have child packages"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12291
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_226
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Packages declaring static-shared libs cannot be renamed"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12284
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_230
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Packages declaring static-shared libs cannot be instant apps"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12278
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_23a
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v5, "Packages declaring static-shared libs must target O SDK or higher"

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12267
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v6  # "isUserInstall":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_244
    move/from16 v20, v6

    .line 12391
    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    :goto_246
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_2a9

    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->isEmpty()Z

    move-result v0

    if-nez v0, :cond_2a9

    .line 12392
    const/high16 v0, 0x40000

    and-int/2addr v0, v3

    if-eqz v0, :cond_290

    .line 12396
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 12397
    .local v0, "childCount":I
    const/4 v5, 0x0

    .local v5, "i":I
    :goto_25e
    if-ge v5, v0, :cond_2a9

    .line 12398
    iget-object v6, v2, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/PackageParser$Package;

    .line 12399
    .local v6, "childPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v11, v6, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v9, v10, v11}, Lcom/android/server/pm/Settings;->hasOtherDisabledSystemPkgWithChildLPr(Ljava/lang/String;Ljava/lang/String;)Z

    move-result v9

    if-nez v9, :cond_277

    .line 12397
    .end local v6  # "childPkg":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v5, v5, 0x1

    goto :goto_25e

    .line 12401
    .restart local v6  # "childPkg":Landroid/content/pm/PackageParser$Package;
    :cond_277
    new-instance v9, Lcom/android/server/pm/PackageManagerException;

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Can\'t override child of another disabled app. Ignoring package "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v11, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-direct {v9, v10}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v9

    .line 12393
    .end local v0  # "childCount":I
    .end local v5  # "i":I
    .end local v6  # "childPkg":Landroid/content/pm/PackageParser$Package;
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_290
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Only privileged apps can add child packages. Ignoring package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12419
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_2a9
    and-int/lit16 v0, v3, 0x80

    if-eqz v0, :cond_384

    const/high16 v0, 0x1000000

    and-int/2addr v0, v3

    if-nez v0, :cond_384

    .line 12421
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mExpectingBetter:Landroid/util/ArrayMap;

    iget-object v5, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v5}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_2d5

    .line 12422
    const/4 v0, 0x5

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Relax SCAN_REQUIRE_KNOWN requirement for package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v0, v5}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    goto/16 :goto_384

    .line 12425
    :cond_2d5
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v5}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v0

    .line 12426
    .local v0, "known":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_364

    .line 12427
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z

    if-eqz v5, :cond_30f

    .line 12428
    const-string v5, "PackageManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Examining "

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v2, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " and requiring known paths "

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v0, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " & "

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v0, Lcom/android/server/pm/PackageSetting;->resourcePathString:Ljava/lang/String;

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 12432
    :cond_30f
    iget-object v5, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v5}, Landroid/content/pm/ApplicationInfo;->getCodePath()Ljava/lang/String;

    move-result-object v5

    iget-object v6, v0, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_32c

    iget-object v5, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 12433
    invoke-virtual {v5}, Landroid/content/pm/ApplicationInfo;->getResourcePath()Ljava/lang/String;

    move-result-object v5

    iget-object v6, v0, Lcom/android/server/pm/PackageSetting;->resourcePathString:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_32c

    goto :goto_384

    .line 12435
    :cond_32c
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    const/16 v6, -0x17

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Application package "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " found at "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 12437
    invoke-virtual {v10}, Landroid/content/pm/ApplicationInfo;->getCodePath()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " but expected at "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v0, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, "; ignoring."

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-direct {v5, v6, v9}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v5

    .line 12442
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_364
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    const/16 v6, -0x13

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Application package "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " not found; ignoring."

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-direct {v5, v6, v9}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v5

    .line 12453
    .end local v0  # "known":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_384
    :goto_384
    and-int/lit8 v0, v3, 0x4

    if-eqz v0, :cond_38d

    .line 12454
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, v2}, Lcom/android/server/pm/ComponentResolver;->assertProvidersNotDefined(Landroid/content/pm/PackageParser$Package;)V

    .line 12458
    :cond_38d
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/PackageParser$Package;->isPrivileged()Z

    move-result v0

    if-nez v0, :cond_3fa

    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;
    :try_end_395
    .catchall {:try_start_168 .. :try_end_395} :catchall_54e

    if-eqz v0, :cond_3fa

    .line 12459
    const/4 v5, 0x0

    .line 12461
    .local v5, "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    :try_start_398
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v2, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    const/4 v9, 0x0

    invoke-virtual {v0, v6, v9, v9, v9}, Lcom/android/server/pm/Settings;->getSharedUserLPw(Ljava/lang/String;IIZ)Lcom/android/server/pm/SharedUserSetting;

    move-result-object v0
    :try_end_3a1
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_398 .. :try_end_3a1} :catch_3a3
    .catchall {:try_start_398 .. :try_end_3a1} :catchall_54e

    move-object v5, v0

    goto :goto_3a4

    .line 12462
    :catch_3a3
    move-exception v0

    :goto_3a4
    nop

    .line 12463
    if-eqz v5, :cond_3fa

    :try_start_3a7
    invoke-virtual {v5}, Lcom/android/server/pm/SharedUserSetting;->isPrivileged()Z

    move-result v0

    if-eqz v0, :cond_3fa

    .line 12465
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    const-string v6, "android"

    invoke-virtual {v0, v6}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 12466
    .local v0, "platformPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v6, v0, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v6, v6, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    sget-object v9, Landroid/content/pm/PackageParser$SigningDetails;->UNKNOWN:Landroid/content/pm/PackageParser$SigningDetails;

    if-eq v6, v9, :cond_3fa

    iget-object v6, v0, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v6, v6, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v6, v6, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    iget-object v9, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v9, v9, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .line 12468
    invoke-static {v6, v9}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v6

    if-nez v6, :cond_3d2

    goto :goto_3fa

    .line 12472
    :cond_3d2
    new-instance v6, Lcom/android/server/pm/PackageManagerException;

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Apps that share a user with a privileged app must themselves be marked as privileged. "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " shares privileged user "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, "."

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-direct {v6, v9}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v6

    .line 12481
    .end local v0  # "platformPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_3fa
    :goto_3fa
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mOverlayTarget:Ljava/lang/String;

    if-eqz v0, :cond_547

    .line 12483
    const/high16 v0, 0x20000

    and-int/2addr v0, v3

    if-eqz v0, :cond_48f

    .line 12486
    and-int/lit8 v0, p2, 0x10

    if-nez v0, :cond_547

    .line 12488
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 12489
    invoke-virtual {v0, v5}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v0

    const-string/jumbo v5, "previous package state not present"

    .line 12488
    invoke-static {v0, v5}, Lcom/android/server/pm/PackageManagerService;->assertNotNull(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    move-object v5, v0

    .line 12496
    .local v5, "previousPkg":Lcom/android/server/pm/PackageSetting;
    iget-object v0, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;
    :try_end_41b
    .catchall {:try_start_3a7 .. :try_end_41b} :catchall_54e

    move-object v6, v0

    .line 12497
    .local v6, "ppkg":Landroid/content/pm/PackageParser$Package;
    if-nez v6, :cond_446

    .line 12499
    :try_start_41e
    new-instance v0, Landroid/content/pm/PackageParser;

    invoke-direct {v0}, Landroid/content/pm/PackageParser;-><init>()V

    .line 12500
    .local v0, "pp":Landroid/content/pm/PackageParser;
    iget-object v9, v5, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    or-int/lit8 v10, p2, 0x10

    invoke-virtual {v0, v9, v10}, Landroid/content/pm/PackageParser;->parsePackage(Ljava/io/File;I)Landroid/content/pm/PackageParser$Package;

    move-result-object v9
    :try_end_42b
    .catch Landroid/content/pm/PackageParser$PackageParserException; {:try_start_41e .. :try_end_42b} :catch_42d
    .catchall {:try_start_41e .. :try_end_42b} :catchall_54e

    move-object v6, v9

    .line 12504
    .end local v0  # "pp":Landroid/content/pm/PackageParser;
    goto :goto_446

    .line 12502
    :catch_42d
    move-exception v0

    .line 12503
    .local v0, "e":Landroid/content/pm/PackageParser$PackageParserException;
    :try_start_42e
    const-string v9, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "failed to parse "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v11, v5, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 12508
    .end local v0  # "e":Landroid/content/pm/PackageParser$PackageParserException;
    :cond_446
    :goto_446
    if-eqz v6, :cond_46b

    iget-boolean v0, v6, Landroid/content/pm/PackageParser$Package;->mOverlayIsStatic:Z

    if-nez v0, :cond_44d

    goto :goto_46b

    .line 12509
    :cond_44d
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Overlay "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " is static and cannot be upgraded."

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-direct {v0, v9}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12512
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_46b
    :goto_46b
    iget-boolean v0, v2, Landroid/content/pm/PackageParser$Package;->mOverlayIsStatic:Z

    if-nez v0, :cond_471

    .line 12516
    .end local v5  # "previousPkg":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "ppkg":Landroid/content/pm/PackageParser$Package;
    goto/16 :goto_547

    .line 12513
    .restart local v5  # "previousPkg":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "ppkg":Landroid/content/pm/PackageParser$Package;
    :cond_471
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Overlay "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " cannot be upgraded into a static overlay."

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-direct {v0, v9}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12519
    .end local v5  # "previousPkg":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "ppkg":Landroid/content/pm/PackageParser$Package;
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_48f
    iget-boolean v0, v2, Landroid/content/pm/PackageParser$Package;->mOverlayIsStatic:Z

    if-nez v0, :cond_529

    .line 12527
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    const/16 v5, 0x1d

    if-ge v0, v5, :cond_4da

    .line 12528
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const-string v5, "android"

    .line 12529
    invoke-virtual {v0, v5}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v0

    .line 12530
    .local v0, "platformPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v5, v0, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v5, v5, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    sget-object v6, Landroid/content/pm/PackageParser$SigningDetails;->UNKNOWN:Landroid/content/pm/PackageParser$SigningDetails;

    if-eq v5, v6, :cond_4da

    iget-object v5, v0, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v5, v5, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v5, v5, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    iget-object v6, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v6, v6, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .line 12532
    invoke-static {v5, v6}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v5

    if-nez v5, :cond_4bc

    goto :goto_4da

    .line 12536
    :cond_4bc
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Overlay "

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " must target Q or later, or be signed with the platform certificate"

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v5

    .line 12546
    .end local v0  # "platformPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_4da
    :goto_4da
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mOverlayTargetName:Ljava/lang/String;

    if-nez v0, :cond_547

    .line 12547
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v2, Landroid/content/pm/PackageParser$Package;->mOverlayTarget:Ljava/lang/String;

    .line 12548
    invoke-virtual {v0, v5}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v0

    .line 12549
    .local v0, "targetPkgSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_547

    .line 12550
    iget-object v5, v0, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v5, v5, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    sget-object v6, Landroid/content/pm/PackageParser$SigningDetails;->UNKNOWN:Landroid/content/pm/PackageParser$SigningDetails;

    if-eq v5, v6, :cond_547

    iget-object v5, v0, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v5, v5, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v5, v5, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    iget-object v6, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v6, v6, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .line 12552
    invoke-static {v5, v6}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v5

    if-nez v5, :cond_501

    goto :goto_547

    .line 12556
    :cond_501
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Overlay "

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " and target "

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v2, Landroid/content/pm/PackageParser$Package;->mOverlayTarget:Ljava/lang/String;

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " signed with different certificates, and the overlay lacks <overlay android:targetName>"

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v5

    .line 12520
    .end local v0  # "targetPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_529
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Overlay "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " is static but not pre-installed."

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v0, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    throw v0

    .line 12565
    .restart local v4  # "isFirstBootOrUpgrade":Z
    .restart local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v20  # "isUserInstall":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    :cond_547
    :goto_547
    monitor-exit v8

    .line 12566
    return-void

    .line 12565
    .end local v20  # "isUserInstall":Z
    .local v6, "isUserInstall":Z
    :catchall_549
    move-exception v0

    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    :goto_54c
    monitor-exit v8
    :try_end_54d
    .catchall {:try_start_42e .. :try_end_54d} :catchall_54e

    throw v0

    :catchall_54e
    move-exception v0

    goto :goto_54c

    .line 12238
    .end local v7  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v20  # "isUserInstall":Z
    .restart local v6  # "isUserInstall":Z
    :cond_550
    move/from16 v20, v6

    .end local v6  # "isUserInstall":Z
    .restart local v20  # "isUserInstall":Z
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    iget-object v7, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " is an APEX package and can\'t be installed as an APK."

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v0, v6}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v5

    .line 12228
    .end local v4  # "isFirstBootOrUpgrade":Z
    .end local v20  # "isUserInstall":Z
    :cond_56b
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const/4 v4, -0x2

    const-string v5, "Code and resource paths haven\'t been set correctly"

    invoke-direct {v0, v4, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v0
.end method

.method private assertPackageKnownAndInstalled(Ljava/lang/String;Ljava/lang/String;I)V
    .registers 9
    .param p1, "volumeUuid"  # Ljava/lang/String;
    .param p2, "packageName"  # Ljava/lang/String;
    .param p3, "userId"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 23752
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 23754
    :try_start_3
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->normalizePackageNameLPr(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    move-object p2, v1

    .line 23756
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 23757
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_6c

    .line 23759
    iget-object v2, v1, Lcom/android/server/pm/PackageSetting;->volumeUuid:Ljava/lang/String;

    invoke-static {p1, v2}, Landroid/text/TextUtils;->equals(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Z

    move-result v2

    if-eqz v2, :cond_43

    .line 23763
    invoke-virtual {v1, p3}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v2

    if-eqz v2, :cond_24

    .line 23767
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    monitor-exit v0

    .line 23768
    return-void

    .line 23764
    .restart local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_24
    new-instance v2, Lcom/android/server/pm/PackageManagerException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " not installed for user "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "volumeUuid":Ljava/lang/String;
    .end local p2  # "packageName":Ljava/lang/String;
    .end local p3  # "userId":I
    throw v2

    .line 23760
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "volumeUuid":Ljava/lang/String;
    .restart local p2  # "packageName":Ljava/lang/String;
    .restart local p3  # "userId":I
    :cond_43
    new-instance v2, Lcom/android/server/pm/PackageManagerException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " found on unknown volume "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, "; expected volume "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->volumeUuid:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "volumeUuid":Ljava/lang/String;
    .end local p2  # "packageName":Ljava/lang/String;
    .end local p3  # "userId":I
    throw v2

    .line 23758
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "volumeUuid":Ljava/lang/String;
    .restart local p2  # "packageName":Ljava/lang/String;
    .restart local p3  # "userId":I
    :cond_6c
    new-instance v2, Lcom/android/server/pm/PackageManagerException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " is unknown"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "volumeUuid":Ljava/lang/String;
    .end local p2  # "packageName":Ljava/lang/String;
    .end local p3  # "userId":I
    throw v2

    .line 23767
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "volumeUuid":Ljava/lang/String;
    .restart local p2  # "packageName":Ljava/lang/String;
    .restart local p3  # "userId":I
    :catchall_88
    move-exception v1

    monitor-exit v0
    :try_end_8a
    .catchall {:try_start_3 .. :try_end_8a} :catchall_88

    throw v1
.end method

.method private bestDomainVerificationStatus(II)I
    .registers 4
    .param p1, "status1"  # I
    .param p2, "status2"  # I

    .line 7849
    const/4 v0, 0x3

    if-ne p1, v0, :cond_4

    .line 7850
    return p2

    .line 7852
    :cond_4
    if-ne p2, v0, :cond_7

    .line 7853
    return p1

    .line 7855
    :cond_7
    invoke-static {p1, p2}, Landroid/util/MathUtils;->max(II)F

    move-result v0

    float-to-int v0, v0

    return v0
.end method

.method private broadcastPackageVerified(ILandroid/net/Uri;ILandroid/os/UserHandle;)V
    .registers 8
    .param p1, "verificationId"  # I
    .param p2, "packageUri"  # Landroid/net/Uri;
    .param p3, "verificationCode"  # I
    .param p4, "user"  # Landroid/os/UserHandle;

    .line 14689
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.PACKAGE_VERIFIED"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 14690
    .local v0, "intent":Landroid/content/Intent;
    const-string v1, "application/vnd.android.package-archive"

    invoke-virtual {v0, p2, v1}, Landroid/content/Intent;->setDataAndType(Landroid/net/Uri;Ljava/lang/String;)Landroid/content/Intent;

    .line 14691
    const/4 v1, 0x1

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 14692
    const-string v1, "android.content.pm.extra.VERIFICATION_ID"

    invoke-virtual {v0, v1, p1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 14693
    const-string v1, "android.content.pm.extra.VERIFICATION_RESULT"

    invoke-virtual {v0, v1, p3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 14695
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v2, "android.permission.PACKAGE_VERIFICATION_AGENT"

    invoke-virtual {v1, v0, p4, v2}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;Ljava/lang/String;)V

    .line 14697
    return-void
.end method

.method private static calculateBundledApkRoot(Ljava/lang/String;)Ljava/lang/String;
    .registers 9
    .param p0, "codePathString"  # Ljava/lang/String;

    .line 13142
    const-string v0, "PackageManager"

    new-instance v1, Ljava/io/File;

    invoke-direct {v1, p0}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 13144
    .local v1, "codePath":Ljava/io/File;
    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v2

    invoke-static {v2, v1}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v2

    if-eqz v2, :cond_17

    .line 13145
    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v0

    .local v0, "codeRoot":Ljava/io/File;
    goto/16 :goto_a3

    .line 13146
    .end local v0  # "codeRoot":Ljava/io/File;
    :cond_17
    invoke-static {}, Landroid/os/Environment;->getOemDirectory()Ljava/io/File;

    move-result-object v2

    invoke-static {v2, v1}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v2

    if-eqz v2, :cond_27

    .line 13147
    invoke-static {}, Landroid/os/Environment;->getOemDirectory()Ljava/io/File;

    move-result-object v0

    .restart local v0  # "codeRoot":Ljava/io/File;
    goto/16 :goto_a3

    .line 13148
    .end local v0  # "codeRoot":Ljava/io/File;
    :cond_27
    invoke-static {}, Landroid/os/Environment;->getVendorDirectory()Ljava/io/File;

    move-result-object v2

    invoke-static {v2, v1}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v2

    if-eqz v2, :cond_37

    .line 13149
    invoke-static {}, Landroid/os/Environment;->getVendorDirectory()Ljava/io/File;

    move-result-object v0

    .restart local v0  # "codeRoot":Ljava/io/File;
    goto/16 :goto_a3

    .line 13150
    .end local v0  # "codeRoot":Ljava/io/File;
    :cond_37
    invoke-static {}, Landroid/os/Environment;->getOdmDirectory()Ljava/io/File;

    move-result-object v2

    invoke-static {v2, v1}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v2

    if-eqz v2, :cond_46

    .line 13151
    invoke-static {}, Landroid/os/Environment;->getOdmDirectory()Ljava/io/File;

    move-result-object v0

    .restart local v0  # "codeRoot":Ljava/io/File;
    goto :goto_a3

    .line 13152
    .end local v0  # "codeRoot":Ljava/io/File;
    :cond_46
    invoke-static {}, Landroid/os/Environment;->getProductDirectory()Ljava/io/File;

    move-result-object v2

    invoke-static {v2, v1}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v2

    if-eqz v2, :cond_55

    .line 13153
    invoke-static {}, Landroid/os/Environment;->getProductDirectory()Ljava/io/File;

    move-result-object v0

    .restart local v0  # "codeRoot":Ljava/io/File;
    goto :goto_a3

    .line 13154
    .end local v0  # "codeRoot":Ljava/io/File;
    :cond_55
    invoke-static {}, Landroid/os/Environment;->getProductServicesDirectory()Ljava/io/File;

    move-result-object v2

    invoke-static {v2, v1}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v2

    if-eqz v2, :cond_64

    .line 13155
    invoke-static {}, Landroid/os/Environment;->getProductServicesDirectory()Ljava/io/File;

    move-result-object v0

    .restart local v0  # "codeRoot":Ljava/io/File;
    goto :goto_a3

    .line 13156
    .end local v0  # "codeRoot":Ljava/io/File;
    :cond_64
    invoke-static {}, Landroid/os/Environment;->getOdmDirectory()Ljava/io/File;

    move-result-object v2

    invoke-static {v2, v1}, Landroid/os/FileUtils;->contains(Ljava/io/File;Ljava/io/File;)Z

    move-result v2

    if-eqz v2, :cond_73

    .line 13157
    invoke-static {}, Landroid/os/Environment;->getOdmDirectory()Ljava/io/File;

    move-result-object v0

    .restart local v0  # "codeRoot":Ljava/io/File;
    goto :goto_a3

    .line 13162
    .end local v0  # "codeRoot":Ljava/io/File;
    :cond_73
    :try_start_73
    invoke-virtual {v1}, Ljava/io/File;->getCanonicalFile()Ljava/io/File;

    move-result-object v2

    .line 13163
    .local v2, "f":Ljava/io/File;
    invoke-virtual {v2}, Ljava/io/File;->getParentFile()Ljava/io/File;

    move-result-object v3

    .line 13165
    .local v3, "parent":Ljava/io/File;
    :goto_7b
    invoke-virtual {v3}, Ljava/io/File;->getParentFile()Ljava/io/File;

    move-result-object v4

    move-object v5, v4

    .local v5, "tmp":Ljava/io/File;
    if-eqz v4, :cond_85

    .line 13166
    move-object v2, v3

    .line 13167
    move-object v3, v5

    goto :goto_7b

    .line 13169
    :cond_85
    move-object v4, v2

    .line 13170
    .local v4, "codeRoot":Ljava/io/File;
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unrecognized code path "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v7, " - using "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v0, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_a2
    .catch Ljava/io/IOException; {:try_start_73 .. :try_end_a2} :catch_a8

    .line 13176
    move-object v0, v4

    .line 13178
    .end local v2  # "f":Ljava/io/File;
    .end local v3  # "parent":Ljava/io/File;
    .end local v4  # "codeRoot":Ljava/io/File;
    .end local v5  # "tmp":Ljava/io/File;
    .restart local v0  # "codeRoot":Ljava/io/File;
    :goto_a3
    invoke-virtual {v0}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v2

    return-object v2

    .line 13172
    .end local v0  # "codeRoot":Ljava/io/File;
    :catch_a8
    move-exception v2

    .line 13174
    .local v2, "e":Ljava/io/IOException;
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Can\'t canonicalize code path "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v0, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13175
    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v0

    invoke-virtual {v0}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method private canRequestPackageInstallsInternal(Ljava/lang/String;IIZ)Z
    .registers 14
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I
    .param p4, "throwIfPermNotDeclared"  # Z

    .line 26336
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 26337
    .local v0, "callingUid":I
    const/4 v1, 0x0

    invoke-virtual {p0, p1, v1, p3}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    .line 26338
    .local v2, "uid":I
    if-eq v0, v2, :cond_31

    if-eqz v0, :cond_31

    const/16 v3, 0x3e8

    if-ne v0, v3, :cond_12

    goto :goto_31

    .line 26340
    :cond_12
    new-instance v1, Ljava/lang/SecurityException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Caller uid "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, " does not own package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v1, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 26343
    :cond_31
    :goto_31
    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->getApplicationInfo(Ljava/lang/String;II)Landroid/content/pm/ApplicationInfo;

    move-result-object v3

    .line 26344
    .local v3, "info":Landroid/content/pm/ApplicationInfo;
    if-nez v3, :cond_38

    .line 26345
    return v1

    .line 26347
    :cond_38
    iget v4, v3, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    const/16 v5, 0x1a

    if-ge v4, v5, :cond_3f

    .line 26348
    return v1

    .line 26350
    :cond_3f
    invoke-virtual {p0, p1, p3}, Lcom/android/server/pm/PackageManagerService;->isInstantApp(Ljava/lang/String;I)Z

    move-result v4

    if-eqz v4, :cond_46

    .line 26351
    return v1

    .line 26353
    :cond_46
    const-string v4, "android.permission.REQUEST_INSTALL_PACKAGES"

    .line 26354
    .local v4, "appOpPermission":Ljava/lang/String;
    invoke-virtual {p0, v4}, Lcom/android/server/pm/PackageManagerService;->getAppOpPermissionPackages(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v5

    .line 26355
    .local v5, "packagesDeclaringPermission":[Ljava/lang/String;
    invoke-static {v5, p1}, Lcom/android/internal/util/ArrayUtils;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_88

    .line 26356
    const-string v6, " to call this api"

    const-string v7, "Need to declare "

    if-nez p4, :cond_70

    .line 26360
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v8, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const-string v7, "PackageManager"

    invoke-static {v7, v6}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 26361
    return v1

    .line 26357
    :cond_70
    new-instance v1, Ljava/lang/SecurityException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v8, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v1, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 26364
    :cond_88
    sget-object v6, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    const-string/jumbo v7, "no_install_unknown_sources"

    invoke-virtual {v6, v7, p3}, Lcom/android/server/pm/UserManagerService;->hasUserRestriction(Ljava/lang/String;I)Z

    move-result v6

    if-nez v6, :cond_ac

    sget-object v6, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    .line 26365
    const-string/jumbo v7, "no_install_unknown_sources_globally"

    invoke-virtual {v6, v7, p3}, Lcom/android/server/pm/UserManagerService;->hasUserRestriction(Ljava/lang/String;I)Z

    move-result v6

    if-eqz v6, :cond_9f

    goto :goto_ac

    .line 26369
    :cond_9f
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mExternalSourcesPolicy:Landroid/content/pm/PackageManagerInternal$ExternalSourcesPolicy;

    if-eqz v6, :cond_ab

    .line 26370
    invoke-interface {v6, p1, v2}, Landroid/content/pm/PackageManagerInternal$ExternalSourcesPolicy;->getPackageTrustedToInstallApps(Ljava/lang/String;I)I

    move-result v6

    .line 26371
    .local v6, "isTrusted":I
    if-nez v6, :cond_aa

    const/4 v1, 0x1

    :cond_aa
    return v1

    .line 26373
    .end local v6  # "isTrusted":I
    :cond_ab
    return v1

    .line 26367
    :cond_ac
    :goto_ac
    return v1
.end method

.method private canSkipForcedApkVerification(Ljava/lang/String;)Z
    .registers 6
    .param p1, "apkPath"  # Ljava/lang/String;

    .line 9731
    invoke-static {}, Lcom/android/server/pm/PackageManagerServiceUtils;->isLegacyApkVerityEnabled()Z

    move-result v0

    if-nez v0, :cond_b

    .line 9732
    invoke-static {p1}, Lcom/android/server/security/VerityUtils;->hasFsverity(Ljava/lang/String;)Z

    move-result v0

    return v0

    .line 9736
    :cond_b
    const/4 v0, 0x0

    :try_start_c
    invoke-static {p1}, Lcom/android/server/security/VerityUtils;->generateApkVerityRootHash(Ljava/lang/String;)[B

    move-result-object v1

    .line 9737
    .local v1, "rootHashObserved":[B
    if-nez v1, :cond_13

    .line 9738
    return v0

    .line 9740
    :cond_13
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v2
    :try_end_16
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_c .. :try_end_16} :catch_21
    .catch Ljava/io/IOException; {:try_start_c .. :try_end_16} :catch_21
    .catch Ljava/security/DigestException; {:try_start_c .. :try_end_16} :catch_21
    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_c .. :try_end_16} :catch_21

    .line 9742
    :try_start_16
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v3, p1, v1}, Lcom/android/server/pm/Installer;->assertFsverityRootHashMatches(Ljava/lang/String;[B)V

    .line 9743
    const/4 v3, 0x1

    monitor-exit v2

    return v3

    .line 9744
    :catchall_1e
    move-exception v3

    monitor-exit v2
    :try_end_20
    .catchall {:try_start_16 .. :try_end_20} :catchall_1e

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "apkPath":Ljava/lang/String;
    :try_start_20
    throw v3
    :try_end_21
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_20 .. :try_end_21} :catch_21
    .catch Ljava/io/IOException; {:try_start_20 .. :try_end_21} :catch_21
    .catch Ljava/security/DigestException; {:try_start_20 .. :try_end_21} :catch_21
    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_20 .. :try_end_21} :catch_21

    .line 9745
    .end local v1  # "rootHashObserved":[B
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "apkPath":Ljava/lang/String;
    :catch_21
    move-exception v1

    .line 9747
    .local v1, "e":Ljava/lang/Exception;
    const-string v2, "PackageManager"

    const-string v3, "Error in fsverity check. Fallback to full apk verification."

    invoke-static {v2, v3, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 9749
    .end local v1  # "e":Ljava/lang/Exception;
    return v0
.end method

.method private canSkipForcedPackageVerification(Landroid/content/pm/PackageParser$Package;)Z
    .registers 5
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 9711
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->canSkipForcedApkVerification(Ljava/lang/String;)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    .line 9712
    return v1

    .line 9715
    :cond_a
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    invoke-static {v0}, Lcom/android/internal/util/ArrayUtils;->isEmpty([Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_26

    .line 9716
    const/4 v0, 0x0

    .local v0, "i":I
    :goto_13
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    array-length v2, v2

    if-ge v0, v2, :cond_26

    .line 9717
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    aget-object v2, v2, v0

    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->canSkipForcedApkVerification(Ljava/lang/String;)Z

    move-result v2

    if-nez v2, :cond_23

    .line 9718
    return v1

    .line 9716
    :cond_23
    add-int/lit8 v0, v0, 0x1

    goto :goto_13

    .line 9722
    .end local v0  # "i":I
    :cond_26
    const/4 v0, 0x1

    return v0
.end method

.method private canSuspendPackageForUserInternal([Ljava/lang/String;I)[Z
    .registers 16
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "userId"  # I

    .line 14542
    array-length v0, p1

    new-array v0, v0, [Z

    .line 14543
    .local v0, "canSuspend":[Z
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 14545
    .local v1, "callingId":J
    :try_start_7
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->getActiveLauncherPackageName(I)Ljava/lang/String;

    move-result-object v3

    .line 14546
    .local v3, "activeLauncherPackageName":Ljava/lang/String;
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->getDefaultDialerPackageName(I)Ljava/lang/String;

    move-result-object v4

    .line 14547
    .local v4, "dialerPackageName":Ljava/lang/String;
    const/4 v5, 0x0

    move v6, v5

    .local v6, "i":I
    :goto_11
    array-length v7, p1

    if-ge v6, v7, :cond_19b

    .line 14548
    aput-boolean v5, v0, v6

    .line 14549
    aget-object v7, p1, v6

    .line 14551
    .local v7, "packageName":Ljava/lang/String;
    invoke-direct {p0, v7, p2}, Lcom/android/server/pm/PackageManagerService;->isPackageDeviceAdmin(Ljava/lang/String;I)Z

    move-result v8

    if-eqz v8, :cond_3b

    .line 14552
    const-string v8, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Cannot suspend package \""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, "\": has an active device admin"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14554
    goto/16 :goto_194

    .line 14556
    :cond_3b
    invoke-virtual {v7, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_5e

    .line 14557
    const-string v8, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Cannot suspend package \""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, "\": contains the active launcher"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14559
    goto/16 :goto_194

    .line 14561
    :cond_5e
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_83

    .line 14562
    const-string v8, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Cannot suspend package \""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, "\": required for package installation"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14564
    goto/16 :goto_194

    .line 14566
    :cond_83
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredUninstallerPackage:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_a8

    .line 14567
    const-string v8, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Cannot suspend package \""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, "\": required for package uninstallation"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14569
    goto/16 :goto_194

    .line 14571
    :cond_a8
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_cd

    .line 14572
    const-string v8, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Cannot suspend package \""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, "\": required for package verification"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14574
    goto/16 :goto_194

    .line 14576
    :cond_cd
    invoke-virtual {v7, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_f0

    .line 14577
    const-string v8, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Cannot suspend package \""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, "\": is the default dialer"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14579
    goto/16 :goto_194

    .line 14581
    :cond_f0
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredPermissionControllerPackage:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_115

    .line 14582
    const-string v8, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Cannot suspend package \""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, "\": required for permissions management"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14584
    goto/16 :goto_194

    .line 14586
    :cond_115
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8
    :try_end_118
    .catchall {:try_start_7 .. :try_end_118} :catchall_1a0

    .line 14587
    :try_start_118
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mProtectedPackages:Lcom/android/server/pm/ProtectedPackages;

    invoke-virtual {v9, p2, v7}, Lcom/android/server/pm/ProtectedPackages;->isPackageStateProtected(ILjava/lang/String;)Z

    move-result v9

    if-eqz v9, :cond_13d

    .line 14588
    const-string v9, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Cannot suspend package \""

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, "\": protected package"

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14590
    monitor-exit v8

    goto :goto_194

    .line 14596
    :cond_13d
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v9, v7}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Landroid/content/pm/PackageParser$Package;

    .line 14597
    .local v9, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v9, :cond_171

    iget-object v10, v9, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v10}, Landroid/content/pm/ApplicationInfo;->isStaticSharedLibrary()Z

    move-result v10

    if-eqz v10, :cond_171

    .line 14598
    const-string v10, "PackageManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Cannot suspend package: "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, " providing static shared library: "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v12, v9, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14601
    monitor-exit v8

    goto :goto_194

    .line 14603
    .end local v9  # "pkg":Landroid/content/pm/PackageParser$Package;
    :cond_171
    monitor-exit v8
    :try_end_172
    .catchall {:try_start_118 .. :try_end_172} :catchall_198

    .line 14604
    :try_start_172
    const-string v8, "android"

    invoke-virtual {v8, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_191

    .line 14605
    const-string v8, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Cannot suspend the platform package: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14606
    goto :goto_194

    .line 14608
    :cond_191
    const/4 v8, 0x1

    aput-boolean v8, v0, v6
    :try_end_194
    .catchall {:try_start_172 .. :try_end_194} :catchall_1a0

    .line 14547
    .end local v7  # "packageName":Ljava/lang/String;
    :goto_194
    add-int/lit8 v6, v6, 0x1

    goto/16 :goto_11

    .line 14603
    .restart local v7  # "packageName":Ljava/lang/String;
    :catchall_198
    move-exception v5

    :try_start_199
    monitor-exit v8
    :try_end_19a
    .catchall {:try_start_199 .. :try_end_19a} :catchall_198

    .end local v0  # "canSuspend":[Z
    .end local v1  # "callingId":J
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageNames":[Ljava/lang/String;
    .end local p2  # "userId":I
    :try_start_19a
    throw v5
    :try_end_19b
    .catchall {:try_start_19a .. :try_end_19b} :catchall_1a0

    .line 14611
    .end local v3  # "activeLauncherPackageName":Ljava/lang/String;
    .end local v4  # "dialerPackageName":Ljava/lang/String;
    .end local v6  # "i":I
    .end local v7  # "packageName":Ljava/lang/String;
    .restart local v0  # "canSuspend":[Z
    .restart local v1  # "callingId":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageNames":[Ljava/lang/String;
    .restart local p2  # "userId":I
    :cond_19b
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 14612
    nop

    .line 14613
    return-object v0

    .line 14611
    :catchall_1a0
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v3
.end method

.method private canViewInstantApps(II)Z
    .registers 6
    .param p1, "callingUid"  # I
    .param p2, "userId"  # I

    .line 4276
    const/4 v0, 0x1

    const/16 v1, 0x2710

    if-ge p1, v1, :cond_6

    .line 4277
    return v0

    .line 4279
    :cond_6
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v2, "android.permission.ACCESS_INSTANT_APPS"

    invoke-virtual {v1, v2}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v1

    if-nez v1, :cond_11

    .line 4281
    return v0

    .line 4283
    :cond_11
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v2, "android.permission.VIEW_INSTANT_APPS"

    invoke-virtual {v1, v2}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v1

    if-nez v1, :cond_37

    .line 4285
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->getDefaultHomeActivity(I)Landroid/content/ComponentName;

    move-result-object v1

    .line 4286
    .local v1, "homeComponent":Landroid/content/ComponentName;
    if-eqz v1, :cond_2c

    .line 4287
    invoke-virtual {v1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-direct {p0, v2, p1}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v2

    if-eqz v2, :cond_2c

    .line 4288
    return v0

    .line 4291
    :cond_2c
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mAppPredictionServicePackage:Ljava/lang/String;

    if-eqz v2, :cond_37

    .line 4292
    invoke-direct {p0, v2, p1}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v2

    if-eqz v2, :cond_37

    .line 4293
    return v0

    .line 4296
    .end local v1  # "homeComponent":Landroid/content/ComponentName;
    :cond_37
    const/4 v0, 0x0

    return v0
.end method

.method private capturePerformLog()V
    .registers 5

    .line 26619
    const-string v0, "PackageManager"

    const-string/jumbo v1, "package print systrace capturePerformanceLog."

    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 26620
    new-instance v0, Landroid/content/ComponentName;

    const-string v1, "com.meizu.perfui"

    const-string v2, "com.meizu.perfui.performance_log.PerformanceLogService"

    invoke-direct {v0, v1, v2}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 26622
    .local v0, "cn":Landroid/content/ComponentName;
    new-instance v1, Landroid/content/Intent;

    invoke-direct {v1}, Landroid/content/Intent;-><init>()V

    .line 26623
    .local v1, "intent":Landroid/content/Intent;
    invoke-virtual {v1, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 26624
    const-string/jumbo v2, "perf_ext"

    const/4 v3, 0x1

    invoke-virtual {v1, v2, v3}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 26625
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v2, v1}, Landroid/content/Context;->startService(Landroid/content/Intent;)Landroid/content/ComponentName;

    .line 26626
    return-void
.end method

.method private static checkDowngrade(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageInfoLite;)V
    .registers 10
    .param p0, "before"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "after"  # Landroid/content/pm/PackageInfoLite;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 24939
    invoke-virtual {p1}, Landroid/content/pm/PackageInfoLite;->getLongVersionCode()J

    move-result-wide v0

    invoke-virtual {p0}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v2

    cmp-long v0, v0, v2

    const-string v1, " is older than current "

    const/16 v2, -0x19

    if-ltz v0, :cond_9a

    .line 24943
    invoke-virtual {p1}, Landroid/content/pm/PackageInfoLite;->getLongVersionCode()J

    move-result-wide v3

    invoke-virtual {p0}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v5

    cmp-long v0, v3, v5

    if-nez v0, :cond_99

    .line 24944
    iget v0, p1, Landroid/content/pm/PackageInfoLite;->baseRevisionCode:I

    iget v3, p0, Landroid/content/pm/PackageParser$Package;->baseRevisionCode:I

    if-lt v0, v3, :cond_78

    .line 24950
    iget-object v0, p1, Landroid/content/pm/PackageInfoLite;->splitNames:[Ljava/lang/String;

    invoke-static {v0}, Lcom/android/internal/util/ArrayUtils;->isEmpty([Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_99

    .line 24951
    const/4 v0, 0x0

    .local v0, "i":I
    :goto_2b
    iget-object v3, p1, Landroid/content/pm/PackageInfoLite;->splitNames:[Ljava/lang/String;

    array-length v3, v3

    if-ge v0, v3, :cond_99

    .line 24952
    iget-object v3, p1, Landroid/content/pm/PackageInfoLite;->splitNames:[Ljava/lang/String;

    aget-object v3, v3, v0

    .line 24953
    .local v3, "splitName":Ljava/lang/String;
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->splitNames:[Ljava/lang/String;

    invoke-static {v4, v3}, Lcom/android/internal/util/ArrayUtils;->indexOf([Ljava/lang/Object;Ljava/lang/Object;)I

    move-result v4

    .line 24954
    .local v4, "j":I
    const/4 v5, -0x1

    if-eq v4, v5, :cond_75

    .line 24955
    iget-object v5, p1, Landroid/content/pm/PackageInfoLite;->splitRevisionCodes:[I

    aget v5, v5, v0

    iget-object v6, p0, Landroid/content/pm/PackageParser$Package;->splitRevisionCodes:[I

    aget v6, v6, v4

    if-lt v5, v6, :cond_48

    goto :goto_75

    .line 24956
    :cond_48
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Update split "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " revision code "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, p1, Landroid/content/pm/PackageInfoLite;->splitRevisionCodes:[I

    aget v7, v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->splitRevisionCodes:[I

    aget v1, v1, v4

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v5, v2, v1}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v5

    .line 24951
    .end local v3  # "splitName":Ljava/lang/String;
    .end local v4  # "j":I
    :cond_75
    :goto_75
    add-int/lit8 v0, v0, 0x1

    goto :goto_2b

    .line 24945
    .end local v0  # "i":I
    :cond_78
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Update base revision code "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v4, p1, Landroid/content/pm/PackageInfoLite;->baseRevisionCode:I

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v1, p0, Landroid/content/pm/PackageParser$Package;->baseRevisionCode:I

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v2, v1}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v0

    .line 24965
    :cond_99
    return-void

    .line 24940
    :cond_9a
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Update version code "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v4, p1, Landroid/content/pm/PackageInfoLite;->versionCode:I

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 24942
    invoke-virtual {p0}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v4

    invoke-virtual {v3, v4, v5}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v2, v1}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v0
.end method

.method private checkExistsAndEnforceCannotModifyImmutablyRestrictedPermission(Ljava/lang/String;)Z
    .registers 7
    .param p1, "permission"  # Ljava/lang/String;

    .line 6184
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 6185
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-virtual {v1, p1}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getPermissionTEMP(Ljava/lang/String;)Lcom/android/server/pm/permission/BasePermission;

    move-result-object v1

    .line 6186
    .local v1, "bp":Lcom/android/server/pm/permission/BasePermission;
    if-nez v1, :cond_24

    .line 6187
    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "No such permissions: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6188
    const/4 v2, 0x0

    monitor-exit v0

    return v2

    .line 6190
    :cond_24
    invoke-virtual {v1}, Lcom/android/server/pm/permission/BasePermission;->isHardOrSoftRestricted()Z

    move-result v2

    if-eqz v2, :cond_52

    invoke-virtual {v1}, Lcom/android/server/pm/permission/BasePermission;->isImmutablyRestricted()Z

    move-result v2

    if-eqz v2, :cond_52

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v3, "android.permission.WHITELIST_RESTRICTED_PERMISSIONS"

    .line 6191
    invoke-virtual {v2, v3}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v2

    if-nez v2, :cond_3b

    goto :goto_52

    .line 6194
    :cond_3b
    new-instance v2, Ljava/lang/SecurityException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Cannot modify whitelisting of an immutably restricted permission: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "permission":Ljava/lang/String;
    throw v2

    .line 6197
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "permission":Ljava/lang/String;
    :cond_52
    :goto_52
    const/4 v2, 0x1

    monitor-exit v0

    return v2

    .line 6198
    .end local v1  # "bp":Lcom/android/server/pm/permission/BasePermission;
    :catchall_55
    move-exception v1

    monitor-exit v0
    :try_end_57
    .catchall {:try_start_3 .. :try_end_57} :catchall_55

    throw v1
.end method

.method private checkPackageFrozen(Ljava/lang/String;)V
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;

    .line 24277
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 24278
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mFrozenPackages:Landroid/util/ArraySet;

    invoke-virtual {v1, p1}, Landroid/util/ArraySet;->contains(Ljava/lang/Object;)Z

    move-result v1

    if-nez v1, :cond_2b

    .line 24279
    const-string v1, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Expected "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " to be frozen!"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    new-instance v3, Ljava/lang/Throwable;

    invoke-direct {v3}, Ljava/lang/Throwable;-><init>()V

    invoke-static {v1, v2, v3}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 24281
    :cond_2b
    monitor-exit v0

    .line 24282
    return-void

    .line 24281
    :catchall_2d
    move-exception v1

    monitor-exit v0
    :try_end_2f
    .catchall {:try_start_3 .. :try_end_2f} :catchall_2d

    throw v1
.end method

.method private checkPermissionImpl(Ljava/lang/String;Ljava/lang/String;I)I
    .registers 6
    .param p1, "permName"  # Ljava/lang/String;
    .param p2, "pkgName"  # Ljava/lang/String;
    .param p3, "userId"  # I

    .line 5871
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, p1, p2, v1, p3}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->checkPermission(Ljava/lang/String;Ljava/lang/String;II)I

    move-result v0

    return v0
.end method

.method private checkUidPermissionImpl(Ljava/lang/String;I)I
    .registers 10
    .param p1, "permName"  # Ljava/lang/String;
    .param p2, "uid"  # I

    .line 5895
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5896
    :try_start_3
    invoke-virtual {p0, p2}, Lcom/android/server/pm/PackageManagerService;->getPackagesForUid(I)[Ljava/lang/String;

    move-result-object v1

    .line 5897
    .local v1, "packageNames":[Ljava/lang/String;
    const/4 v2, 0x0

    .line 5898
    .local v2, "pkg":Landroid/content/pm/PackageParser$Package;
    if-nez v1, :cond_c

    const/4 v3, 0x0

    goto :goto_d

    :cond_c
    array-length v3, v1

    .line 5899
    .local v3, "N":I
    :goto_d
    const/4 v4, 0x0

    .local v4, "i":I
    :goto_e
    if-nez v2, :cond_20

    if-ge v4, v3, :cond_20

    .line 5900
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    aget-object v6, v1, v4

    invoke-virtual {v5, v6}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Package;

    move-object v2, v5

    .line 5899
    add-int/lit8 v4, v4, 0x1

    goto :goto_e

    .line 5902
    .end local v4  # "i":I
    :cond_20
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v5

    invoke-virtual {v4, p1, v2, p2, v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->checkUidPermission(Ljava/lang/String;Landroid/content/pm/PackageParser$Package;II)I

    move-result v4

    monitor-exit v0

    return v4

    .line 5903
    .end local v1  # "packageNames":[Ljava/lang/String;
    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "N":I
    :catchall_2c
    move-exception v1

    monitor-exit v0
    :try_end_2e
    .catchall {:try_start_3 .. :try_end_2e} :catchall_2c

    throw v1
.end method

.method private chooseBestActivity(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;I)Landroid/content/pm/ResolveInfo;
    .registers 25
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p5, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "I",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;I)",
            "Landroid/content/pm/ResolveInfo;"
        }
    .end annotation

    .line 7022
    .local p4, "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    move-object/from16 v10, p0

    move/from16 v11, p3

    move-object/from16 v12, p4

    move/from16 v13, p5

    const/4 v14, 0x0

    const/4 v15, 0x1

    if-eqz v12, :cond_176

    .line 7023
    invoke-interface/range {p4 .. p4}, Ljava/util/List;->size()I

    move-result v9

    .line 7024
    .local v9, "N":I
    if-ne v9, v15, :cond_19

    .line 7025
    invoke-interface {v12, v14}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/ResolveInfo;

    return-object v0

    .line 7026
    :cond_19
    if-le v9, v15, :cond_173

    .line 7027
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getFlags()I

    move-result v0

    and-int/lit8 v0, v0, 0x8

    if-eqz v0, :cond_25

    move v0, v15

    goto :goto_26

    :cond_25
    move v0, v14

    :goto_26
    move/from16 v16, v0

    .line 7030
    .local v16, "debug":Z
    invoke-interface {v12, v14}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    move-object v8, v0

    check-cast v8, Landroid/content/pm/ResolveInfo;

    .line 7031
    .local v8, "r0":Landroid/content/pm/ResolveInfo;
    invoke-interface {v12, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    move-object v7, v0

    check-cast v7, Landroid/content/pm/ResolveInfo;

    .line 7032
    .local v7, "r1":Landroid/content/pm/ResolveInfo;
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INTENT_MATCHING:Z

    if-nez v0, :cond_3c

    if-eqz v16, :cond_6f

    .line 7033
    :cond_3c
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    iget-object v1, v8, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v2, v8, Landroid/content/pm/ResolveInfo;->priority:I

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, " vs "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v1, v7, Landroid/content/pm/ResolveInfo;->priority:I

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7038
    :cond_6f
    iget v0, v8, Landroid/content/pm/ResolveInfo;->priority:I

    iget v1, v7, Landroid/content/pm/ResolveInfo;->priority:I

    if-ne v0, v1, :cond_167

    iget v0, v8, Landroid/content/pm/ResolveInfo;->preferredOrder:I

    iget v1, v7, Landroid/content/pm/ResolveInfo;->preferredOrder:I

    if-ne v0, v1, :cond_167

    iget-boolean v0, v8, Landroid/content/pm/ResolveInfo;->isDefault:Z

    iget-boolean v1, v7, Landroid/content/pm/ResolveInfo;->isDefault:Z

    if-eq v0, v1, :cond_88

    move-object/from16 v18, v7

    move-object/from16 v17, v8

    move v15, v9

    goto/16 :goto_16c

    .line 7045
    :cond_88
    iget v5, v8, Landroid/content/pm/ResolveInfo;->priority:I

    const/4 v6, 0x1

    const/16 v17, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    move/from16 v3, p3

    move-object/from16 v4, p4

    move-object/from16 v18, v7

    .end local v7  # "r1":Landroid/content/pm/ResolveInfo;
    .local v18, "r1":Landroid/content/pm/ResolveInfo;
    move/from16 v7, v17

    move-object/from16 v17, v8

    .end local v8  # "r0":Landroid/content/pm/ResolveInfo;
    .local v17, "r0":Landroid/content/pm/ResolveInfo;
    move/from16 v8, v16

    move v15, v9

    .end local v9  # "N":I
    .local v15, "N":I
    move/from16 v9, p5

    invoke-virtual/range {v0 .. v9}, Lcom/android/server/pm/PackageManagerService;->findPreferredActivityNotLocked(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;IZZZI)Landroid/content/pm/ResolveInfo;

    move-result-object v0

    .line 7047
    .local v0, "ri":Landroid/content/pm/ResolveInfo;
    if-eqz v0, :cond_a9

    .line 7048
    return-object v0

    .line 7051
    :cond_a9
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_aa
    if-ge v1, v15, :cond_db

    .line 7052
    invoke-interface {v12, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    move-object v0, v2

    check-cast v0, Landroid/content/pm/ResolveInfo;

    .line 7053
    iget-object v2, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v2}, Landroid/content/pm/ApplicationInfo;->isInstantApp()Z

    move-result v2

    if-eqz v2, :cond_d8

    .line 7054
    iget-object v2, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    .line 7055
    .local v2, "packageName":Ljava/lang/String;
    iget-object v3, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 7056
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {v10, v3, v13}, Lcom/android/server/pm/PackageManagerService;->getDomainVerificationStatusLPr(Lcom/android/server/pm/PackageSetting;I)J

    move-result-wide v4

    .line 7057
    .local v4, "packedStatus":J
    const/16 v6, 0x20

    shr-long v6, v4, v6

    long-to-int v6, v6

    .line 7058
    .local v6, "status":I
    const/4 v7, 0x4

    if-eq v6, v7, :cond_d8

    .line 7059
    return-object v0

    .line 7051
    .end local v2  # "packageName":Ljava/lang/String;
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "packedStatus":J
    .end local v6  # "status":I
    :cond_d8
    add-int/lit8 v1, v1, 0x1

    goto :goto_aa

    .line 7063
    .end local v1  # "i":I
    :cond_db
    new-instance v1, Landroid/content/pm/ResolveInfo;

    iget-object v2, v10, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    invoke-direct {v1, v2}, Landroid/content/pm/ResolveInfo;-><init>(Landroid/content/pm/ResolveInfo;)V

    move-object v0, v1

    .line 7064
    new-instance v1, Landroid/content/pm/ActivityInfo;

    iget-object v2, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    invoke-direct {v1, v2}, Landroid/content/pm/ActivityInfo;-><init>(Landroid/content/pm/ActivityInfo;)V

    iput-object v1, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 7065
    iget-object v1, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v2

    invoke-static {v2}, Lcom/android/internal/app/ResolverActivity;->getLabelRes(Ljava/lang/String;)I

    move-result v2

    iput v2, v1, Landroid/content/pm/ActivityInfo;->labelRes:I

    .line 7073
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getPackage()Ljava/lang/String;

    move-result-object v1

    .line 7074
    .local v1, "intentPackage":Ljava/lang/String;
    invoke-static {v1}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v2

    if-nez v2, :cond_12a

    invoke-direct {v10, v12, v1}, Lcom/android/server/pm/PackageManagerService;->allHavePackage(Ljava/util/List;Ljava/lang/String;)Z

    move-result v2

    if-eqz v2, :cond_12a

    .line 7075
    invoke-interface {v12, v14}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ResolveInfo;

    iget-object v2, v2, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 7076
    .local v2, "appi":Landroid/content/pm/ApplicationInfo;
    iput-object v1, v0, Landroid/content/pm/ResolveInfo;->resolvePackageName:Ljava/lang/String;

    .line 7077
    invoke-direct {v10, v13}, Lcom/android/server/pm/PackageManagerService;->userNeedsBadging(I)Z

    move-result v3

    if-eqz v3, :cond_11e

    .line 7078
    const/4 v3, 0x1

    iput-boolean v3, v0, Landroid/content/pm/ResolveInfo;->noResourceId:Z

    goto :goto_122

    .line 7080
    :cond_11e
    iget v3, v2, Landroid/content/pm/ApplicationInfo;->icon:I

    iput v3, v0, Landroid/content/pm/ResolveInfo;->icon:I

    .line 7082
    :goto_122
    iget v3, v2, Landroid/content/pm/ApplicationInfo;->icon:I

    iput v3, v0, Landroid/content/pm/ResolveInfo;->iconResourceId:I

    .line 7083
    iget v3, v2, Landroid/content/pm/ApplicationInfo;->labelRes:I

    iput v3, v0, Landroid/content/pm/ResolveInfo;->labelRes:I

    .line 7085
    .end local v2  # "appi":Landroid/content/pm/ApplicationInfo;
    :cond_12a
    iget-object v2, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    new-instance v3, Landroid/content/pm/ApplicationInfo;

    iget-object v4, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-direct {v3, v4}, Landroid/content/pm/ApplicationInfo;-><init>(Landroid/content/pm/ApplicationInfo;)V

    iput-object v3, v2, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 7087
    if-eqz v13, :cond_14d

    .line 7088
    iget-object v2, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    .line 7089
    invoke-static {v3}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v3

    .line 7088
    invoke-static {v13, v3}, Landroid/os/UserHandle;->getUid(II)I

    move-result v3

    iput v3, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    .line 7092
    :cond_14d
    iget-object v2, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->metaData:Landroid/os/Bundle;

    if-nez v2, :cond_15c

    iget-object v2, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    new-instance v3, Landroid/os/Bundle;

    invoke-direct {v3}, Landroid/os/Bundle;-><init>()V

    iput-object v3, v2, Landroid/content/pm/ActivityInfo;->metaData:Landroid/os/Bundle;

    .line 7093
    :cond_15c
    iget-object v2, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->metaData:Landroid/os/Bundle;

    const-string v3, "android.dock_home"

    const/4 v4, 0x1

    invoke-virtual {v2, v3, v4}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V

    .line 7094
    return-object v0

    .line 7038
    .end local v0  # "ri":Landroid/content/pm/ResolveInfo;
    .end local v1  # "intentPackage":Ljava/lang/String;
    .end local v15  # "N":I
    .end local v17  # "r0":Landroid/content/pm/ResolveInfo;
    .end local v18  # "r1":Landroid/content/pm/ResolveInfo;
    .restart local v7  # "r1":Landroid/content/pm/ResolveInfo;
    .restart local v8  # "r0":Landroid/content/pm/ResolveInfo;
    .restart local v9  # "N":I
    :cond_167
    move-object/from16 v18, v7

    move-object/from16 v17, v8

    move v15, v9

    .line 7041
    .end local v7  # "r1":Landroid/content/pm/ResolveInfo;
    .end local v8  # "r0":Landroid/content/pm/ResolveInfo;
    .end local v9  # "N":I
    .restart local v15  # "N":I
    .restart local v17  # "r0":Landroid/content/pm/ResolveInfo;
    .restart local v18  # "r1":Landroid/content/pm/ResolveInfo;
    :goto_16c
    invoke-interface {v12, v14}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/ResolveInfo;

    return-object v0

    .line 7026
    .end local v15  # "N":I
    .end local v16  # "debug":Z
    .end local v17  # "r0":Landroid/content/pm/ResolveInfo;
    .end local v18  # "r1":Landroid/content/pm/ResolveInfo;
    .restart local v9  # "N":I
    :cond_173
    move v4, v15

    move v15, v9

    .end local v9  # "N":I
    .restart local v15  # "N":I
    goto :goto_177

    .line 7022
    .end local v15  # "N":I
    :cond_176
    move v4, v15

    .line 7098
    :goto_177
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v0

    const/4 v1, 0x0

    if-eqz v0, :cond_1d1

    .line 7099
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v0

    const-string v2, "android.intent.action.VIEW"

    invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1cc

    .line 7100
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v0, v13}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PreferredIntentResolver;

    .line 7101
    .local v0, "pir":Lcom/android/server/pm/PreferredIntentResolver;
    if-eqz v0, :cond_1a6

    const/high16 v2, 0x10000

    and-int/2addr v2, v11

    if-eqz v2, :cond_19c

    goto :goto_19d

    :cond_19c
    move v4, v14

    :goto_19d
    move-object/from16 v2, p1

    move-object/from16 v3, p2

    invoke-virtual {v0, v2, v3, v4, v13}, Lcom/android/server/pm/PreferredIntentResolver;->queryIntent(Landroid/content/Intent;Ljava/lang/String;ZI)Ljava/util/List;

    move-result-object v4

    goto :goto_1ab

    .line 7103
    :cond_1a6
    move-object/from16 v2, p1

    move-object/from16 v3, p2

    move-object v4, v1

    :goto_1ab
    nop

    .line 7104
    .local v4, "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    if-eqz v4, :cond_1d5

    invoke-interface {v4}, Ljava/util/List;->size()I

    move-result v5

    if-lez v5, :cond_1d5

    .line 7105
    invoke-interface {v4, v14}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PreferredActivity;

    .line 7106
    .local v5, "pa":Lcom/android/server/pm/PreferredActivity;
    iget-object v6, v5, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v6, v6, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v10, v6, v11, v13}, Lcom/android/server/pm/PackageManagerService;->getActivityInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ActivityInfo;

    move-result-object v6

    .line 7108
    .local v6, "ai":Landroid/content/pm/ActivityInfo;
    if-eqz v6, :cond_1d5

    .line 7109
    new-instance v1, Landroid/content/pm/ResolveInfo;

    invoke-direct {v1}, Landroid/content/pm/ResolveInfo;-><init>()V

    .line 7110
    .local v1, "ri":Landroid/content/pm/ResolveInfo;
    iput-object v6, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 7111
    return-object v1

    .line 7099
    .end local v0  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    .end local v1  # "ri":Landroid/content/pm/ResolveInfo;
    .end local v4  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .end local v5  # "pa":Lcom/android/server/pm/PreferredActivity;
    .end local v6  # "ai":Landroid/content/pm/ActivityInfo;
    :cond_1cc
    move-object/from16 v2, p1

    move-object/from16 v3, p2

    goto :goto_1d5

    .line 7098
    :cond_1d1
    move-object/from16 v2, p1

    move-object/from16 v3, p2

    .line 7116
    :cond_1d5
    :goto_1d5
    return-object v1
.end method

.method private cleanUpAppIdCreation(Lcom/android/server/pm/PackageManagerService$ScanResult;)V
    .registers 4
    .param p1, "result"  # Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 11484
    iget-object v0, p1, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget v0, v0, Lcom/android/server/pm/PackageSetting;->appId:I

    if-lez v0, :cond_f

    .line 11485
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, p1, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget v1, v1, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-virtual {v0, v1}, Lcom/android/server/pm/Settings;->removeAppIdLPw(I)V

    .line 11487
    :cond_f
    return-void
.end method

.method private clearAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V
    .registers 7
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I
    .param p3, "flags"  # I

    .line 10783
    if-nez p1, :cond_f

    .line 10784
    new-instance v0, Ljava/lang/Throwable;

    invoke-direct {v0}, Ljava/lang/Throwable;-><init>()V

    const-string v1, "PackageManager"

    const-string v2, "Package was null!"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10785
    return-void

    .line 10787
    :cond_f
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->clearAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 10788
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_1d

    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_1e

    :cond_1d
    const/4 v0, 0x0

    .line 10789
    .local v0, "childCount":I
    :goto_1e
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_1f
    if-ge v1, v0, :cond_2f

    .line 10790
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    invoke-direct {p0, v2, p2, p3}, Lcom/android/server/pm/PackageManagerService;->clearAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 10789
    add-int/lit8 v1, v1, 0x1

    goto :goto_1f

    .line 10793
    .end local v1  # "i":I
    :cond_2f
    const/4 v1, -0x1

    invoke-direct {p0, p1, v1}, Lcom/android/server/pm/PackageManagerService;->clearAppProfilesLIF(Landroid/content/pm/PackageParser$Package;I)V

    .line 10794
    return-void
.end method

.method private clearAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V
    .registers 16
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I
    .param p3, "flags"  # I

    .line 10798
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 10799
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 10800
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    monitor-exit v0
    :try_end_10
    .catchall {:try_start_3 .. :try_end_10} :catchall_3e

    .line 10801
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->resolveUserIds(I)[I

    move-result-object v0

    array-length v2, v0

    const/4 v3, 0x0

    :goto_16
    if-ge v3, v2, :cond_3d

    aget v11, v0, v3

    .line 10802
    .local v11, "realUserId":I
    if-eqz v1, :cond_21

    invoke-virtual {v1, v11}, Lcom/android/server/pm/PackageSetting;->getCeDataInode(I)J

    move-result-wide v4

    goto :goto_23

    :cond_21
    const-wide/16 v4, 0x0

    :goto_23
    move-wide v9, v4

    .line 10804
    .local v9, "ceDataInode":J
    :try_start_24
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->volumeUuid:Ljava/lang/String;

    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    move v7, v11

    move v8, p3

    invoke-virtual/range {v4 .. v10}, Lcom/android/server/pm/Installer;->clearAppData(Ljava/lang/String;Ljava/lang/String;IIJ)V
    :try_end_2f
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_24 .. :try_end_2f} :catch_30

    .line 10808
    goto :goto_3a

    .line 10806
    :catch_30
    move-exception v4

    .line 10807
    .local v4, "e":Lcom/android/server/pm/Installer$InstallerException;
    invoke-static {v4}, Ljava/lang/String;->valueOf(Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    const-string v6, "PackageManager"

    invoke-static {v6, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10801
    .end local v4  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .end local v9  # "ceDataInode":J
    .end local v11  # "realUserId":I
    :goto_3a
    add-int/lit8 v3, v3, 0x1

    goto :goto_16

    .line 10810
    :cond_3d
    return-void

    .line 10800
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_3e
    move-exception v1

    :try_start_3f
    monitor-exit v0
    :try_end_40
    .catchall {:try_start_3f .. :try_end_40} :catchall_3e

    throw v1
.end method

.method private clearAppProfilesLIF(Landroid/content/pm/PackageParser$Package;I)V
    .registers 7
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I

    .line 10862
    if-nez p1, :cond_f

    .line 10863
    new-instance v0, Ljava/lang/Throwable;

    invoke-direct {v0}, Ljava/lang/Throwable;-><init>()V

    const-string v1, "PackageManager"

    const-string v2, "Package was null!"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10864
    return-void

    .line 10866
    :cond_f
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mArtManagerService:Lcom/android/server/pm/dex/ArtManagerService;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/dex/ArtManagerService;->clearAppProfiles(Landroid/content/pm/PackageParser$Package;)V

    .line 10867
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_1f

    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_20

    :cond_1f
    const/4 v0, 0x0

    .line 10868
    .local v0, "childCount":I
    :goto_20
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_21
    if-ge v1, v0, :cond_33

    .line 10869
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mArtManagerService:Lcom/android/server/pm/dex/ArtManagerService;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    invoke-virtual {v2, v3}, Lcom/android/server/pm/dex/ArtManagerService;->clearAppProfiles(Landroid/content/pm/PackageParser$Package;)V

    .line 10868
    add-int/lit8 v1, v1, 0x1

    goto :goto_21

    .line 10871
    .end local v1  # "i":I
    :cond_33
    return-void
.end method

.method private clearApplicationUserDataLIF(Ljava/lang/String;I)Z
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 20706
    const/4 v0, 0x0

    if-nez p1, :cond_b

    .line 20707
    const-string v1, "PackageManager"

    const-string v2, "Attempt to delete null packageName."

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 20708
    return v0

    .line 20713
    :cond_b
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20714
    :try_start_e
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 20715
    .local v2, "pkg":Landroid/content/pm/PackageParser$Package;
    if-nez v2, :cond_27

    .line 20716
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 20717
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_27

    .line 20718
    iget-object v4, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    move-object v2, v4

    .line 20722
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_27
    if-nez v2, :cond_46

    .line 20723
    const-string v3, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Package named \'"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, "\' doesn\'t exist."

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 20724
    monitor-exit v1

    return v0

    .line 20727
    :cond_46
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 20728
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v0, p2}, Lcom/android/server/pm/PackageManagerService;->resetUserChangesToRuntimePermissionsAndFlagsLPw(Lcom/android/server/pm/PackageSetting;I)V

    .line 20729
    .end local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    monitor-exit v1
    :try_end_4e
    .catchall {:try_start_e .. :try_end_4e} :catchall_77

    .line 20731
    const/4 v0, 0x7

    invoke-direct {p0, v2, p2, v0}, Lcom/android/server/pm/PackageManagerService;->clearAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 20734
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v0}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v0

    .line 20735
    .local v0, "appId":I
    invoke-static {p2, v0}, Lcom/android/server/pm/PackageManagerService;->removeKeystoreDataIfNeeded(II)V

    .line 20737
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getUserManagerInternal()Landroid/os/UserManagerInternal;

    move-result-object v1

    .line 20739
    .local v1, "umInternal":Landroid/os/UserManagerInternal;
    invoke-virtual {v1, p2}, Landroid/os/UserManagerInternal;->isUserUnlockingOrUnlocked(I)Z

    move-result v3

    if-eqz v3, :cond_69

    .line 20740
    const/4 v3, 0x3

    .local v3, "flags":I
    goto :goto_72

    .line 20741
    .end local v3  # "flags":I
    :cond_69
    invoke-virtual {v1, p2}, Landroid/os/UserManagerInternal;->isUserRunning(I)Z

    move-result v3

    if-eqz v3, :cond_71

    .line 20742
    const/4 v3, 0x1

    .restart local v3  # "flags":I
    goto :goto_72

    .line 20744
    .end local v3  # "flags":I
    :cond_71
    const/4 v3, 0x0

    .line 20746
    .restart local v3  # "flags":I
    :goto_72
    invoke-direct {p0, v2, p2, v3}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataContentsLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 20748
    const/4 v4, 0x1

    return v4

    .line 20729
    .end local v0  # "appId":I
    .end local v1  # "umInternal":Landroid/os/UserManagerInternal;
    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "flags":I
    :catchall_77
    move-exception v0

    :try_start_78
    monitor-exit v1
    :try_end_79
    .catchall {:try_start_78 .. :try_end_79} :catchall_77

    throw v0
.end method

.method private clearDefaultBrowserIfNeededForUser(Ljava/lang/String;I)V
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 21379
    invoke-virtual {p0, p2}, Lcom/android/server/pm/PackageManagerService;->getDefaultBrowserPackageName(I)Ljava/lang/String;

    move-result-object v0

    .line 21380
    .local v0, "defaultBrowserPackageName":Ljava/lang/String;
    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v1

    if-nez v1, :cond_14

    .line 21381
    invoke-virtual {p1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_14

    .line 21382
    const/4 v1, 0x0

    invoke-virtual {p0, v1, p2}, Lcom/android/server/pm/PackageManagerService;->setDefaultBrowserPackageName(Ljava/lang/String;I)Z

    .line 21385
    :cond_14
    return-void
.end method

.method private clearIntentFilterVerificationsLPw(I)V
    .registers 7
    .param p1, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 21345
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v0

    .line 21346
    .local v0, "packageCount":I
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_7
    if-ge v1, v0, :cond_1a

    .line 21347
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, v1}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 21348
    .local v2, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v3, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v4, 0x1

    invoke-virtual {p0, v3, p1, v4}, Lcom/android/server/pm/PackageManagerService;->clearIntentFilterVerificationsLPw(Ljava/lang/String;IZ)V

    .line 21346
    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v1, v1, 0x1

    goto :goto_7

    .line 21350
    .end local v1  # "i":I
    :cond_1a
    return-void
.end method

.method private clearPackagePreferredActivitiesLPw(Ljava/lang/String;Landroid/util/SparseBooleanArray;I)V
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "outUserChanged"  # Landroid/util/SparseBooleanArray;
    .param p3, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 21311
    const/4 v0, 0x0

    .line 21312
    .local v0, "removed":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PreferredActivity;>;"
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_2
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v2}, Landroid/util/SparseArray;->size()I

    move-result v2

    if-ge v1, v2, :cond_72

    .line 21313
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v2, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v2

    .line 21314
    .local v2, "thisUserId":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v3, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PreferredIntentResolver;

    .line 21315
    .local v3, "pir":Lcom/android/server/pm/PreferredIntentResolver;
    const/4 v4, -0x1

    if-eq p3, v4, :cond_24

    if-eq p3, v2, :cond_24

    .line 21316
    goto :goto_6f

    .line 21318
    :cond_24
    invoke-virtual {v3}, Lcom/android/server/pm/PreferredIntentResolver;->filterIterator()Ljava/util/Iterator;

    move-result-object v4

    .line 21319
    .local v4, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PreferredActivity;>;"
    :goto_28
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_56

    .line 21320
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PreferredActivity;

    .line 21323
    .local v5, "pa":Lcom/android/server/pm/PreferredActivity;
    if-eqz p1, :cond_4a

    iget-object v6, v5, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v6, v6, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    .line 21324
    invoke-virtual {v6}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_55

    iget-object v6, v5, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-boolean v6, v6, Lcom/android/server/pm/PreferredComponent;->mAlways:Z

    if-eqz v6, :cond_55

    .line 21326
    :cond_4a
    if-nez v0, :cond_52

    .line 21327
    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V

    move-object v0, v6

    .line 21329
    :cond_52
    invoke-virtual {v0, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 21331
    .end local v5  # "pa":Lcom/android/server/pm/PreferredActivity;
    :cond_55
    goto :goto_28

    .line 21332
    :cond_56
    if-eqz v0, :cond_6f

    .line 21333
    const/4 v5, 0x0

    .local v5, "j":I
    :goto_59
    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v6

    if-ge v5, v6, :cond_6b

    .line 21334
    invoke-virtual {v0, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/pm/PreferredActivity;

    .line 21335
    .local v6, "pa":Lcom/android/server/pm/PreferredActivity;
    invoke-virtual {v3, v6}, Lcom/android/server/pm/PreferredIntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 21333
    .end local v6  # "pa":Lcom/android/server/pm/PreferredActivity;
    add-int/lit8 v5, v5, 0x1

    goto :goto_59

    .line 21337
    .end local v5  # "j":I
    :cond_6b
    const/4 v5, 0x1

    invoke-virtual {p2, v2, v5}, Landroid/util/SparseBooleanArray;->put(IZ)V

    .line 21312
    .end local v2  # "thisUserId":I
    .end local v3  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    .end local v4  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PreferredActivity;>;"
    :cond_6f
    :goto_6f
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .line 21340
    .end local v1  # "i":I
    :cond_72
    return-void
.end method

.method private clearPackageStateForUserLIF(Lcom/android/server/pm/PackageSetting;ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;I)V
    .registers 16
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "userId"  # I
    .param p3, "outInfo"  # Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .param p4, "flags"  # I

    .line 20581
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 20582
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 20583
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    monitor-exit v0
    :try_end_e
    .catchall {:try_start_3 .. :try_end_e} :catchall_ce

    .line 20585
    invoke-direct {p0, v1}, Lcom/android/server/pm/PackageManagerService;->destroyAppProfilesLIF(Landroid/content/pm/PackageParser$Package;)V

    .line 20587
    const/4 v0, -0x1

    const/4 v2, 0x0

    const/4 v3, 0x1

    if-ne p2, v0, :cond_1d

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0

    goto :goto_21

    .line 20588
    :cond_1d
    new-array v0, v3, [I

    aput p2, v0, v2

    :goto_21
    nop

    .line 20589
    .local v0, "userIds":[I
    array-length v4, v0

    move v5, v2

    :goto_24
    if-ge v5, v4, :cond_b2

    aget v6, v0, v5

    .line 20590
    .local v6, "nextUserId":I
    sget-boolean v7, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v7, :cond_4c

    .line 20591
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Updating package:"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v8, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, " install state for user:"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    const-string v8, "PackageManager"

    invoke-static {v8, v7}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20595
    :cond_4c
    const/4 v7, 0x7

    invoke-direct {p0, v1, v6, v7}, Lcom/android/server/pm/PackageManagerService;->destroyAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 20597
    iget-object v7, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-direct {p0, v7, v6}, Lcom/android/server/pm/PackageManagerService;->clearDefaultBrowserIfNeededForUser(Ljava/lang/String;I)V

    .line 20598
    iget v7, p1, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-static {v6, v7}, Lcom/android/server/pm/PackageManagerService;->removeKeystoreDataIfNeeded(II)V

    .line 20599
    new-instance v7, Landroid/util/SparseBooleanArray;

    invoke-direct {v7}, Landroid/util/SparseBooleanArray;-><init>()V

    .line 20600
    .local v7, "changedUsers":Landroid/util/SparseBooleanArray;
    iget-object v8, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-direct {p0, v8, v7, v6}, Lcom/android/server/pm/PackageManagerService;->clearPackagePreferredActivitiesLPw(Ljava/lang/String;Landroid/util/SparseBooleanArray;I)V

    .line 20601
    invoke-virtual {v7}, Landroid/util/SparseBooleanArray;->size()I

    move-result v8

    if-lez v8, :cond_7b

    .line 20602
    invoke-direct {p0, v7}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(Landroid/util/SparseBooleanArray;)V

    .line 20603
    invoke-direct {p0, v6}, Lcom/android/server/pm/PackageManagerService;->postPreferredActivityChangedBroadcast(I)V

    .line 20604
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8

    .line 20605
    :try_start_73
    invoke-virtual {p0, v6}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 20606
    monitor-exit v8

    goto :goto_7b

    :catchall_78
    move-exception v2

    monitor-exit v8
    :try_end_7a
    .catchall {:try_start_73 .. :try_end_7a} :catchall_78

    throw v2

    .line 20608
    :cond_7b
    :goto_7b
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8

    .line 20609
    :try_start_7e
    invoke-direct {p0, p1, v6}, Lcom/android/server/pm/PackageManagerService;->resetUserChangesToRuntimePermissionsAndFlagsLPw(Lcom/android/server/pm/PackageSetting;I)V

    .line 20610
    monitor-exit v8
    :try_end_82
    .catchall {:try_start_7e .. :try_end_82} :catchall_af

    .line 20612
    and-int/lit8 v8, p4, 0x10

    if-eqz v8, :cond_ab

    .line 20614
    :try_start_86
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    iget-object v9, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-static {v6}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;

    move-result-object v10

    invoke-static {v8, v9, v10}, Landroid/provider/MediaStore;->deleteContributedMedia(Landroid/content/Context;Ljava/lang/String;Landroid/os/UserHandle;)V
    :try_end_91
    .catch Ljava/io/IOException; {:try_start_86 .. :try_end_91} :catch_92

    .line 20617
    goto :goto_ab

    .line 20615
    :catch_92
    move-exception v8

    .line 20616
    .local v8, "e":Ljava/io/IOException;
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Failed to delete contributed media for "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    const-string v10, "PackageManager"

    invoke-static {v10, v9, v8}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 20589
    .end local v6  # "nextUserId":I
    .end local v7  # "changedUsers":Landroid/util/SparseBooleanArray;
    .end local v8  # "e":Ljava/io/IOException;
    :cond_ab
    :goto_ab
    add-int/lit8 v5, v5, 0x1

    goto/16 :goto_24

    .line 20610
    .restart local v6  # "nextUserId":I
    .restart local v7  # "changedUsers":Landroid/util/SparseBooleanArray;
    :catchall_af
    move-exception v2

    :try_start_b0
    monitor-exit v8
    :try_end_b1
    .catchall {:try_start_b0 .. :try_end_b1} :catchall_af

    throw v2

    .line 20621
    .end local v6  # "nextUserId":I
    .end local v7  # "changedUsers":Landroid/util/SparseBooleanArray;
    :cond_b2
    if-eqz p3, :cond_cd

    .line 20622
    iget-object v4, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    iput-object v4, p3, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    .line 20623
    iget-object v4, p1, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    iput-object v4, p3, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installerPackageName:Ljava/lang/String;

    .line 20624
    if-eqz v1, :cond_c3

    iget-object v4, v1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-eqz v4, :cond_c3

    move v2, v3

    :cond_c3
    iput-boolean v2, p3, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->isStaticSharedLib:Z

    .line 20625
    iget v2, p1, Lcom/android/server/pm/PackageSetting;->appId:I

    iput v2, p3, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedAppId:I

    .line 20626
    iput-object v0, p3, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedUsers:[I

    .line 20627
    iput-object v0, p3, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->broadcastUsers:[I

    .line 20629
    :cond_cd
    return-void

    .line 20583
    .end local v0  # "userIds":[I
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_ce
    move-exception v1

    :try_start_cf
    monitor-exit v0
    :try_end_d0
    .catchall {:try_start_cf .. :try_end_d0} :catchall_ce

    throw v1
.end method

.method private collectAbsoluteCodePaths()Ljava/util/List;
    .registers 7
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 23771
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 23772
    :try_start_3
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 23773
    .local v1, "codePaths":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->size()I

    move-result v2

    .line 23774
    .local v2, "packageCount":I
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_11
    if-ge v3, v2, :cond_2a

    .line 23775
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4, v3}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 23776
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v5, v4, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    invoke-virtual {v5}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v5

    invoke-interface {v1, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 23774
    nop

    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    add-int/lit8 v3, v3, 0x1

    goto :goto_11

    .line 23778
    .end local v3  # "i":I
    :cond_2a
    monitor-exit v0

    return-object v1

    .line 23779
    .end local v1  # "codePaths":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v2  # "packageCount":I
    :catchall_2c
    move-exception v1

    monitor-exit v0
    :try_end_2e
    .catchall {:try_start_3 .. :try_end_2e} :catchall_2c

    throw v1
.end method

.method private collectCertificatesLI(Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$Package;ZZ)V
    .registers 12
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p3, "forceCollect"  # Z
    .param p4, "skipVerify"  # Z
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 9559
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mIsPreNMR1Upgrade:Z

    if-eqz v0, :cond_10

    .line 9560
    new-instance v0, Ljava/io/File;

    iget-object v1, p2, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-direct {v0, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-virtual {v0}, Ljava/io/File;->lastModified()J

    move-result-wide v0

    goto :goto_14

    :cond_10
    invoke-static {p2}, Lcom/android/server/pm/PackageManagerServiceUtils;->getLastModifiedTime(Landroid/content/pm/PackageParser$Package;)J

    move-result-wide v0

    .line 9561
    .local v0, "lastModifiedTime":J
    :goto_14
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->getSettingsVersionForPackage(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v2

    .line 9562
    .local v2, "settingsVersionForPackage":Lcom/android/server/pm/Settings$VersionInfo;
    const-string v3, "PackageManager"

    if-eqz p1, :cond_7b

    if-nez p3, :cond_7b

    iget-object v4, p1, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    iget-object v5, p2, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    .line 9563
    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_7b

    iget-wide v4, p1, Lcom/android/server/pm/PackageSetting;->timeStamp:J

    cmp-long v4, v4, v0

    if-nez v4, :cond_7b

    .line 9565
    invoke-static {v2}, Lcom/android/server/pm/PackageManagerService;->isCompatSignatureUpdateNeeded(Lcom/android/server/pm/Settings$VersionInfo;)Z

    move-result v4

    if-nez v4, :cond_7b

    .line 9566
    invoke-static {v2}, Lcom/android/server/pm/PackageManagerService;->isRecoverSignatureUpdateNeeded(Lcom/android/server/pm/Settings$VersionInfo;)Z

    move-result v4

    if-nez v4, :cond_7b

    .line 9567
    iget-object v4, p1, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v4, v4, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v4, v4, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    if-eqz v4, :cond_5f

    iget-object v4, p1, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v4, v4, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v4, v4, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    array-length v4, v4

    if-eqz v4, :cond_5f

    iget-object v4, p1, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v4, v4, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget v4, v4, Landroid/content/pm/PackageParser$SigningDetails;->signatureSchemeVersion:I

    if-eqz v4, :cond_5f

    .line 9573
    new-instance v3, Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v4, p1, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v4, v4, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    invoke-direct {v3, v4}, Landroid/content/pm/PackageParser$SigningDetails;-><init>(Landroid/content/pm/PackageParser$SigningDetails;)V

    iput-object v3, p2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    .line 9575
    return-void

    .line 9578
    :cond_5f
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "PackageSetting for "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " is missing signatures.  Collecting certs again to recover them."

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_9b

    .line 9581
    :cond_7b
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    iget-object v5, p2, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " changed; collecting certs"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9582
    if-eqz p3, :cond_8f

    const-string v5, " (forced)"

    goto :goto_91

    :cond_8f
    const-string v5, ""

    :goto_91
    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    .line 9581
    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 9586
    :goto_9b
    const-wide/32 v3, 0x40000

    :try_start_9e
    const-string v5, "collectCertificates"

    invoke-static {v3, v4, v5}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 9587
    invoke-static {p2, p4}, Landroid/content/pm/PackageParser;->collectCertificates(Landroid/content/pm/PackageParser$Package;Z)V
    :try_end_a6
    .catch Landroid/content/pm/PackageParser$PackageParserException; {:try_start_9e .. :try_end_a6} :catch_ad
    .catchall {:try_start_9e .. :try_end_a6} :catchall_ab

    .line 9591
    invoke-static {v3, v4}, Landroid/os/Trace;->traceEnd(J)V

    .line 9592
    nop

    .line 9593
    return-void

    .line 9591
    :catchall_ab
    move-exception v5

    goto :goto_b3

    .line 9588
    :catch_ad
    move-exception v5

    .line 9589
    .local v5, "e":Landroid/content/pm/PackageParser$PackageParserException;
    :try_start_ae
    invoke-static {v5}, Lcom/android/server/pm/PackageManagerException;->from(Landroid/content/pm/PackageParser$PackageParserException;)Lcom/android/server/pm/PackageManagerException;

    move-result-object v6

    .end local v0  # "lastModifiedTime":J
    .end local v2  # "settingsVersionForPackage":Lcom/android/server/pm/Settings$VersionInfo;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local p2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p3  # "forceCollect":Z
    .end local p4  # "skipVerify":Z
    throw v6
    :try_end_b3
    .catchall {:try_start_ae .. :try_end_b3} :catchall_ab

    .line 9591
    .end local v5  # "e":Landroid/content/pm/PackageParser$PackageParserException;
    .restart local v0  # "lastModifiedTime":J
    .restart local v2  # "settingsVersionForPackage":Lcom/android/server/pm/Settings$VersionInfo;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local p2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p3  # "forceCollect":Z
    .restart local p4  # "skipVerify":Z
    :goto_b3
    invoke-static {v3, v4}, Landroid/os/Trace;->traceEnd(J)V

    throw v5
.end method

.method private static collectSharedLibraryInfos(Landroid/content/pm/PackageParser$Package;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;)Ljava/util/ArrayList;
    .registers 16
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageParser$Package;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/content/pm/PackageParser$Package;",
            ">;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;)",
            "Ljava/util/ArrayList<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 10965
    .local p1, "availablePackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .local p2, "existingLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .local p3, "newLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    if-nez p0, :cond_4

    .line 10966
    const/4 v0, 0x0

    return-object v0

    .line 10971
    :cond_4
    const/4 v0, 0x0

    .line 10972
    .local v0, "usesLibraryInfos":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->usesLibraries:Ljava/util/ArrayList;

    if-eqz v1, :cond_1c

    .line 10973
    iget-object v2, p0, Landroid/content/pm/PackageParser$Package;->usesLibraries:Ljava/util/ArrayList;

    const/4 v3, 0x0

    const/4 v4, 0x0

    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v6, 0x1

    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v1, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    const/4 v8, 0x0

    move-object v9, p1

    move-object v10, p2

    move-object v11, p3

    invoke-static/range {v2 .. v11}, Lcom/android/server/pm/PackageManagerService;->collectSharedLibraryInfos(Ljava/util/List;[J[[Ljava/lang/String;Ljava/lang/String;ZILjava/util/ArrayList;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;)Ljava/util/ArrayList;

    move-result-object v0

    .line 10977
    :cond_1c
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->usesStaticLibraries:Ljava/util/ArrayList;

    if-eqz v1, :cond_35

    .line 10978
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->usesStaticLibraries:Ljava/util/ArrayList;

    iget-object v2, p0, Landroid/content/pm/PackageParser$Package;->usesStaticLibrariesVersions:[J

    iget-object v3, p0, Landroid/content/pm/PackageParser$Package;->usesStaticLibrariesCertDigests:[[Ljava/lang/String;

    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v5, 0x1

    iget-object v6, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    move-object v7, v0

    move-object v8, p1

    move-object v9, p2

    move-object v10, p3

    invoke-static/range {v1 .. v10}, Lcom/android/server/pm/PackageManagerService;->collectSharedLibraryInfos(Ljava/util/List;[J[[Ljava/lang/String;Ljava/lang/String;ZILjava/util/ArrayList;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;)Ljava/util/ArrayList;

    move-result-object v0

    .line 10983
    :cond_35
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->usesOptionalLibraries:Ljava/util/ArrayList;

    if-eqz v1, :cond_4c

    .line 10984
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->usesOptionalLibraries:Ljava/util/ArrayList;

    const/4 v2, 0x0

    const/4 v3, 0x0

    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v5, 0x0

    iget-object v6, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    move-object v7, v0

    move-object v8, p1

    move-object v9, p2

    move-object v10, p3

    invoke-static/range {v1 .. v10}, Lcom/android/server/pm/PackageManagerService;->collectSharedLibraryInfos(Ljava/util/List;[J[[Ljava/lang/String;Ljava/lang/String;ZILjava/util/ArrayList;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;)Ljava/util/ArrayList;

    move-result-object v0

    .line 10988
    :cond_4c
    return-object v0
.end method

.method private static collectSharedLibraryInfos(Ljava/util/List;[J[[Ljava/lang/String;Ljava/lang/String;ZILjava/util/ArrayList;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;)Ljava/util/ArrayList;
    .registers 30
    .param p1, "requiredVersions"  # [J
    .param p2, "requiredCertDigests"  # [[Ljava/lang/String;
    .param p3, "packageName"  # Ljava/lang/String;
    .param p4, "required"  # Z
    .param p5, "targetSdk"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;[J[[",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "ZI",
            "Ljava/util/ArrayList<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/content/pm/PackageParser$Package;",
            ">;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;)",
            "Ljava/util/ArrayList<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 11023
    .local p0, "requestedLibraries":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local p6, "outUsedLibraries":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    .local p7, "availablePackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .local p8, "existingLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .local p9, "newLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    move-object/from16 v0, p3

    invoke-interface/range {p0 .. p0}, Ljava/util/List;->size()I

    move-result v1

    .line 11024
    .local v1, "libCount":I
    const/4 v2, 0x0

    move-object/from16 v3, p6

    .end local p6  # "outUsedLibraries":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    .local v2, "i":I
    .local v3, "outUsedLibraries":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    :goto_9
    if-ge v2, v1, :cond_1ae

    .line 11025
    move-object/from16 v4, p0

    invoke-interface {v4, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/String;

    .line 11026
    .local v5, "libName":Ljava/lang/String;
    if-eqz p1, :cond_18

    aget-wide v6, p1, v2

    goto :goto_1a

    .line 11027
    :cond_18
    const-wide/16 v6, -0x1

    :goto_1a
    nop

    .line 11028
    .local v6, "libVersion":J
    move-object/from16 v8, p8

    move-object/from16 v9, p9

    invoke-static {v5, v6, v7, v8, v9}, Lcom/android/server/pm/PackageManagerService;->getSharedLibraryInfo(Ljava/lang/String;JLjava/util/Map;Ljava/util/Map;)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v10

    .line 11030
    .local v10, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    const-string v11, "; failing!"

    const/16 v12, -0x9

    const-string v13, "Package "

    if-nez v10, :cond_78

    .line 11031
    if-nez p4, :cond_58

    .line 11035
    sget-boolean v11, Lcom/android/server/pm/PackageManagerService;->DEBUG_SHARED_LIBRARIES:Z

    if-eqz v11, :cond_52

    .line 11036
    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, " desires unavailable shared library "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, "; ignoring!"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    const-string v12, "PackageManager"

    invoke-static {v12, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 11024
    .end local v5  # "libName":Ljava/lang/String;
    .end local v6  # "libVersion":J
    .end local v10  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    :cond_52
    move-object/from16 v14, p7

    move/from16 v16, v1

    goto/16 :goto_1a8

    .line 11032
    .restart local v5  # "libName":Ljava/lang/String;
    .restart local v6  # "libVersion":J
    .restart local v10  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    :cond_58
    new-instance v14, Lcom/android/server/pm/PackageManagerException;

    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v15, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v13, " requires unavailable shared library "

    invoke-virtual {v15, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-direct {v14, v12, v11}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v14

    .line 11041
    :cond_78
    if-eqz p1, :cond_197

    if-eqz p2, :cond_197

    .line 11042
    invoke-virtual {v10}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v14

    aget-wide v16, p1, v2

    cmp-long v14, v14, v16

    if-nez v14, :cond_165

    .line 11048
    nop

    .line 11049
    invoke-virtual {v10}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v11

    move-object/from16 v14, p7

    invoke-interface {v14, v11}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/content/pm/PackageParser$Package;

    .line 11050
    .local v11, "libPkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v11, :cond_146

    .line 11055
    aget-object v15, p2, v2

    .line 11056
    .local v15, "expectedCertDigests":[Ljava/lang/String;
    array-length v12, v15

    move/from16 v16, v1

    .end local v1  # "libCount":I
    .local v16, "libCount":I
    const-string v1, " requires differently signed static shared library; failing!"

    const/16 v17, 0x0

    const/4 v4, 0x1

    if-le v12, v4, :cond_11b

    .line 11058
    const/16 v12, 0x1b

    move/from16 v4, p5

    if-lt v4, v12, :cond_b0

    .line 11059
    iget-object v12, v11, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v12, v12, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    invoke-static {v12}, Landroid/util/PackageUtils;->computeSignaturesSha256Digests([Landroid/content/pm/Signature;)[Ljava/lang/String;

    move-result-object v12

    goto :goto_bf

    .line 11061
    :cond_b0
    const/4 v12, 0x1

    new-array v12, v12, [Landroid/content/pm/Signature;

    iget-object v4, v11, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v4, v4, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    aget-object v4, v4, v17

    aput-object v4, v12, v17

    invoke-static {v12}, Landroid/util/PackageUtils;->computeSignaturesSha256Digests([Landroid/content/pm/Signature;)[Ljava/lang/String;

    move-result-object v12

    :goto_bf
    move-object v4, v12

    .line 11068
    .local v4, "libCertDigests":[Ljava/lang/String;
    array-length v12, v15

    move-wide/from16 v18, v6

    .end local v6  # "libVersion":J
    .local v18, "libVersion":J
    array-length v6, v4

    if-ne v12, v6, :cond_ff

    .line 11075
    invoke-static {v4}, Ljava/util/Arrays;->sort([Ljava/lang/Object;)V

    .line 11076
    invoke-static {v15}, Ljava/util/Arrays;->sort([Ljava/lang/Object;)V

    .line 11078
    array-length v6, v4

    .line 11079
    .local v6, "certCount":I
    const/4 v7, 0x0

    .local v7, "j":I
    :goto_ce
    if-ge v7, v6, :cond_fb

    .line 11080
    aget-object v12, v4, v7

    move-object/from16 v17, v4

    .end local v4  # "libCertDigests":[Ljava/lang/String;
    .local v17, "libCertDigests":[Ljava/lang/String;
    aget-object v4, v15, v7

    invoke-virtual {v12, v4}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v4

    if-eqz v4, :cond_e1

    .line 11079
    add-int/lit8 v7, v7, 0x1

    move-object/from16 v4, v17

    goto :goto_ce

    .line 11081
    :cond_e1
    new-instance v4, Lcom/android/server/pm/PackageManagerException;

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const/16 v12, -0x9

    invoke-direct {v4, v12, v1}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v4

    .line 11079
    .end local v17  # "libCertDigests":[Ljava/lang/String;
    .restart local v4  # "libCertDigests":[Ljava/lang/String;
    :cond_fb
    move-object/from16 v17, v4

    .line 11087
    .end local v4  # "libCertDigests":[Ljava/lang/String;
    .end local v6  # "certCount":I
    .end local v7  # "j":I
    goto/16 :goto_19d

    .line 11069
    .restart local v4  # "libCertDigests":[Ljava/lang/String;
    :cond_ff
    move-object/from16 v17, v4

    .end local v4  # "libCertDigests":[Ljava/lang/String;
    .restart local v17  # "libCertDigests":[Ljava/lang/String;
    new-instance v4, Lcom/android/server/pm/PackageManagerException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v6, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const/16 v6, -0x9

    invoke-direct {v4, v6, v1}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v4

    .line 11090
    .end local v17  # "libCertDigests":[Ljava/lang/String;
    .end local v18  # "libVersion":J
    .local v6, "libVersion":J
    :cond_11b
    move-wide/from16 v18, v6

    .end local v6  # "libVersion":J
    .restart local v18  # "libVersion":J
    iget-object v4, v11, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    aget-object v6, v15, v17

    .line 11091
    invoke-static {v6}, Landroid/util/ByteStringUtils;->fromHexToByteArray(Ljava/lang/String;)[B

    move-result-object v6

    .line 11090
    invoke-virtual {v4, v6}, Landroid/content/pm/PackageParser$SigningDetails;->hasSha256Certificate([B)Z

    move-result v4

    if-eqz v4, :cond_12c

    goto :goto_19d

    .line 11092
    :cond_12c
    new-instance v4, Lcom/android/server/pm/PackageManagerException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v6, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const/16 v6, -0x9

    invoke-direct {v4, v6, v1}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v4

    .line 11051
    .end local v15  # "expectedCertDigests":[Ljava/lang/String;
    .end local v16  # "libCount":I
    .end local v18  # "libVersion":J
    .restart local v1  # "libCount":I
    .restart local v6  # "libVersion":J
    :cond_146
    move/from16 v16, v1

    move-wide/from16 v18, v6

    move v6, v12

    .end local v1  # "libCount":I
    .end local v6  # "libVersion":J
    .restart local v16  # "libCount":I
    .restart local v18  # "libVersion":J
    new-instance v1, Lcom/android/server/pm/PackageManagerException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " requires unavailable static shared library; failing!"

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v1, v6, v4}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v1

    .line 11043
    .end local v11  # "libPkg":Landroid/content/pm/PackageParser$Package;
    .end local v16  # "libCount":I
    .end local v18  # "libVersion":J
    .restart local v1  # "libCount":I
    .restart local v6  # "libVersion":J
    :cond_165
    move/from16 v16, v1

    move-wide/from16 v18, v6

    .end local v1  # "libCount":I
    .end local v6  # "libVersion":J
    .restart local v16  # "libCount":I
    .restart local v18  # "libVersion":J
    new-instance v1, Lcom/android/server/pm/PackageManagerException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " requires unavailable static shared library "

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " version "

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 11046
    invoke-virtual {v10}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v6

    invoke-virtual {v4, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    const/16 v6, -0x9

    invoke-direct {v1, v6, v4}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v1

    .line 11041
    .end local v16  # "libCount":I
    .end local v18  # "libVersion":J
    .restart local v1  # "libCount":I
    .restart local v6  # "libVersion":J
    :cond_197
    move-object/from16 v14, p7

    move/from16 v16, v1

    move-wide/from16 v18, v6

    .line 11099
    .end local v1  # "libCount":I
    .end local v6  # "libVersion":J
    .restart local v16  # "libCount":I
    .restart local v18  # "libVersion":J
    :goto_19d
    if-nez v3, :cond_1a5

    .line 11100
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    move-object v3, v1

    .line 11102
    :cond_1a5
    invoke-virtual {v3, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11024
    .end local v5  # "libName":Ljava/lang/String;
    .end local v10  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v18  # "libVersion":J
    :goto_1a8
    add-int/lit8 v2, v2, 0x1

    move/from16 v1, v16

    goto/16 :goto_9

    .line 11105
    .end local v2  # "i":I
    .end local v16  # "libCount":I
    .restart local v1  # "libCount":I
    :cond_1ae
    return-object v3
.end method

.method private commitPackageSettings(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/PackageSetting;IZLcom/android/server/pm/PackageManagerService$ReconciledPackage;)V
    .registers 24
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "oldPkg"  # Landroid/content/pm/PackageParser$Package;
    .param p3, "pkgSetting"  # Lcom/android/server/pm/PackageSetting;
    .param p4, "scanFlags"  # I
    .param p5, "chatty"  # Z
    .param p6, "reconciledPkg"  # Lcom/android/server/pm/PackageManagerService$ReconciledPackage;

    .line 12640
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move-object/from16 v3, p2

    move/from16 v4, p4

    move/from16 v5, p5

    move-object/from16 v6, p6

    iget-object v7, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 12641
    .local v7, "pkgName":Ljava/lang/String;
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mCustomResolverComponentName:Landroid/content/ComponentName;

    if-eqz v0, :cond_21

    .line 12642
    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_21

    .line 12643
    invoke-direct/range {p0 .. p1}, Lcom/android/server/pm/PackageManagerService;->setUpCustomResolverActivity(Landroid/content/pm/PackageParser$Package;)V

    .line 12646
    :cond_21
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const-string v8, "android"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    const/16 v8, 0x20

    if-eqz v0, :cond_b5

    .line 12647
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v9

    .line 12648
    and-int/lit16 v0, v4, 0x400

    if-nez v0, :cond_b0

    .line 12650
    :try_start_34
    iput-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mPlatformPackage:Landroid/content/pm/PackageParser$Package;

    .line 12651
    iget v0, v1, Lcom/android/server/pm/PackageManagerService;->mSdkVersion:I

    iput v0, v2, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    .line 12652
    const/4 v0, 0x0

    iput v0, v2, Landroid/content/pm/PackageParser$Package;->mVersionCodeMajor:I

    .line 12653
    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mAndroidApplication:Landroid/content/pm/ApplicationInfo;

    .line 12654
    iget-boolean v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolverReplaced:Z

    if-nez v10, :cond_b0

    .line 12655
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iget-object v11, v1, Lcom/android/server/pm/PackageManagerService;->mAndroidApplication:Landroid/content/pm/ApplicationInfo;

    iput-object v11, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 12656
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const-class v11, Lcom/android/internal/app/ResolverActivity;

    invoke-virtual {v11}, Ljava/lang/Class;->getName()Ljava/lang/String;

    move-result-object v11

    iput-object v11, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    .line 12657
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iget-object v11, v1, Lcom/android/server/pm/PackageManagerService;->mAndroidApplication:Landroid/content/pm/ApplicationInfo;

    iget-object v11, v11, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v11, v10, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    .line 12658
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const-string/jumbo v11, "system:ui"

    iput-object v11, v10, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    .line 12659
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iput v0, v10, Landroid/content/pm/ActivityInfo;->launchMode:I

    .line 12660
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const/4 v11, 0x3

    iput v11, v10, Landroid/content/pm/ActivityInfo;->documentLaunchMode:I

    .line 12661
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iput v8, v10, Landroid/content/pm/ActivityInfo;->flags:I

    .line 12662
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const v11, 0x1030226

    iput v11, v10, Landroid/content/pm/ActivityInfo;->theme:I

    .line 12663
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const/4 v11, 0x1

    iput-boolean v11, v10, Landroid/content/pm/ActivityInfo;->exported:Z

    .line 12664
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iput-boolean v11, v10, Landroid/content/pm/ActivityInfo;->enabled:Z

    .line 12665
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const/4 v11, 0x2

    iput v11, v10, Landroid/content/pm/ActivityInfo;->resizeMode:I

    .line 12666
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const/16 v11, 0xdb0

    iput v11, v10, Landroid/content/pm/ActivityInfo;->configChanges:I

    .line 12672
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    iget-object v11, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iput-object v11, v10, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 12673
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    iput v0, v10, Landroid/content/pm/ResolveInfo;->priority:I

    .line 12674
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    iput v0, v10, Landroid/content/pm/ResolveInfo;->preferredOrder:I

    .line 12675
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    iput v0, v10, Landroid/content/pm/ResolveInfo;->match:I

    .line 12677
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getResolverActivityName()V

    .line 12679
    new-instance v0, Landroid/content/ComponentName;

    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mAndroidApplication:Landroid/content/pm/ApplicationInfo;

    iget-object v10, v10, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v11, v1, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iget-object v11, v11, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v0, v10, v11}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    iput-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mResolveComponentName:Landroid/content/ComponentName;

    .line 12683
    :cond_b0
    monitor-exit v9

    goto :goto_b5

    :catchall_b2
    move-exception v0

    monitor-exit v9
    :try_end_b4
    .catchall {:try_start_34 .. :try_end_b4} :catchall_b2

    throw v0

    .line 12686
    :cond_b5
    :goto_b5
    const/4 v9, 0x0

    .line 12688
    .local v9, "clientLibPkgs":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v10

    .line 12689
    :try_start_b9
    iget-object v0, v6, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->allowedSharedLibraryInfos:Ljava/util/List;

    invoke-static {v0}, Lcom/android/internal/util/ArrayUtils;->isEmpty(Ljava/util/Collection;)Z

    move-result v0

    if-nez v0, :cond_f6

    .line 12690
    iget-object v0, v6, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->allowedSharedLibraryInfos:Ljava/util/List;

    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_c7
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v11

    if-eqz v11, :cond_d7

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/content/pm/SharedLibraryInfo;

    .line 12691
    .local v11, "info":Landroid/content/pm/SharedLibraryInfo;
    invoke-direct {v1, v11}, Lcom/android/server/pm/PackageManagerService;->commitSharedLibraryInfoLocked(Landroid/content/pm/SharedLibraryInfo;)V

    .line 12692
    .end local v11  # "info":Landroid/content/pm/SharedLibraryInfo;
    goto :goto_c7

    .line 12693
    :cond_d7
    nop

    .line 12694
    invoke-static/range {p6 .. p6}, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->access$2300(Lcom/android/server/pm/PackageManagerService$ReconciledPackage;)Ljava/util/Map;

    move-result-object v0
    :try_end_dc
    .catchall {:try_start_b9 .. :try_end_dc} :catchall_2d2

    move-object v11, v0

    .line 12697
    .local v11, "combinedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    const/4 v0, 0x0

    :try_start_de
    invoke-direct {v1, v2, v0, v11}, Lcom/android/server/pm/PackageManagerService;->updateSharedLibrariesLocked(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/Map;)V
    :try_end_e1
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_de .. :try_end_e1} :catch_e2
    .catchall {:try_start_de .. :try_end_e1} :catchall_2d2

    .line 12700
    goto :goto_ed

    .line 12698
    :catch_e2
    move-exception v0

    move-object v12, v0

    move-object v0, v12

    .line 12699
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    :try_start_e5
    const-string v12, "PackageManager"

    const-string/jumbo v13, "updateSharedLibrariesLPr failed: "

    invoke-static {v12, v13, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 12703
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    :goto_ed
    and-int/lit8 v0, v4, 0x10

    if-nez v0, :cond_f6

    .line 12704
    invoke-direct {v1, v2, v11}, Lcom/android/server/pm/PackageManagerService;->updateAllSharedLibrariesLocked(Landroid/content/pm/PackageParser$Package;Ljava/util/Map;)Ljava/util/ArrayList;

    move-result-object v0

    move-object v9, v0

    .line 12707
    .end local v11  # "combinedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    :cond_f6
    monitor-exit v10
    :try_end_f7
    .catchall {:try_start_e5 .. :try_end_f7} :catchall_2d2

    .line 12709
    and-int/lit8 v0, v4, 0x10

    if-eqz v0, :cond_fc

    goto :goto_109

    .line 12711
    :cond_fc
    and-int/lit16 v0, v4, 0x800

    if-eqz v0, :cond_101

    goto :goto_109

    .line 12713
    :cond_101
    and-int/lit16 v0, v4, 0x1000

    if-eqz v0, :cond_106

    goto :goto_109

    .line 12719
    :cond_106
    invoke-direct {v1, v7}, Lcom/android/server/pm/PackageManagerService;->checkPackageFrozen(Ljava/lang/String;)V

    .line 12723
    :goto_109
    if-eqz v9, :cond_129

    .line 12724
    const/4 v0, 0x0

    .local v0, "i":I
    :goto_10c
    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v0, v10, :cond_129

    .line 12725
    invoke-virtual {v9, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Landroid/content/pm/PackageParser$Package;

    .line 12726
    .local v10, "clientPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v11, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v11, v11, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v12, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v12, v12, Landroid/content/pm/ApplicationInfo;->uid:I

    const-string/jumbo v13, "update lib"

    invoke-direct {v1, v11, v12, v13}, Lcom/android/server/pm/PackageManagerService;->killApplication(Ljava/lang/String;ILjava/lang/String;)V

    .line 12724
    .end local v10  # "clientPkg":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v0, v0, 0x1

    goto :goto_10c

    .line 12732
    .end local v0  # "i":I
    :cond_129
    const-wide/32 v10, 0x40000

    const-string/jumbo v0, "updateSettings"

    invoke-static {v10, v11, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 12734
    iget-object v12, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v12

    .line 12738
    :try_start_135
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;
    :try_end_137
    .catchall {:try_start_135 .. :try_end_137} :catchall_2cd

    move-object/from16 v13, p3

    :try_start_139
    invoke-virtual {v0, v13, v2}, Lcom/android/server/pm/Settings;->insertPackageSettingLPw(Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$Package;)V

    .line 12740
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v14, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v14, v14, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v14, v2}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 12743
    sget v0, Landroid/os/Process;->SYSTEM_LAUNCHER_UID:I

    if-gez v0, :cond_15b

    const-string v0, "com.meizu.flyme.launcher"

    iget-object v14, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v14, v14, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 12744
    invoke-virtual {v0, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_15b

    .line 12745
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    sput v0, Landroid/os/Process;->SYSTEM_LAUNCHER_UID:I

    .line 12749
    :cond_15b
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    move-object v14, v0

    .line 12750
    .local v14, "ksms":Lcom/android/server/pm/KeySetManagerService;
    invoke-virtual {v14, v2}, Lcom/android/server/pm/KeySetManagerService;->addScannedPackageLPw(Landroid/content/pm/PackageParser$Package;)V

    .line 12752
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, v2, v5}, Lcom/android/server/pm/ComponentResolver;->addAllComponents(Landroid/content/pm/PackageParser$Package;Z)V

    .line 12755
    and-int/lit16 v0, v4, 0x4000

    if-eqz v0, :cond_18a

    .line 12756
    const-string v0, "PackageManager"

    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Permission groups from package "

    invoke-virtual {v15, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v15, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " ignored: instant apps cannot define new permission groups."

    invoke-virtual {v15, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v0, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_18f

    .line 12759
    :cond_18a
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-virtual {v0, v2, v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->addAllPermissionGroups(Landroid/content/pm/PackageParser$Package;Z)V

    .line 12763
    :goto_18f
    and-int/lit16 v0, v4, 0x4000

    if-eqz v0, :cond_1b1

    .line 12764
    const-string v0, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Permissions from package "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v11, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, " ignored: instant apps cannot define new permissions."

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v0, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_1b6

    .line 12767
    :cond_1b1
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-virtual {v0, v2, v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->addAllPermissions(Landroid/content/pm/PackageParser$Package;Z)V

    .line 12770
    :goto_1b6
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->instrumentation:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 12771
    .local v0, "collectionSize":I
    const/4 v10, 0x0

    .line 12773
    .local v10, "r":Ljava/lang/StringBuilder;
    const/4 v11, 0x0

    .local v11, "i":I
    :goto_1be
    if-ge v11, v0, :cond_265

    .line 12774
    iget-object v15, v2, Landroid/content/pm/PackageParser$Package;->instrumentation:Ljava/util/ArrayList;

    invoke-virtual {v15, v11}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Landroid/content/pm/PackageParser$Instrumentation;

    .line 12775
    .local v15, "a":Landroid/content/pm/PackageParser$Instrumentation;
    iget-object v8, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    move/from16 v16, v0

    .end local v0  # "collectionSize":I
    .local v16, "collectionSize":I
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v0, v8, Landroid/content/pm/InstrumentationInfo;->packageName:Ljava/lang/String;

    .line 12776
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->sourceDir:Ljava/lang/String;

    .line 12777
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->publicSourceDir:Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->publicSourceDir:Ljava/lang/String;

    .line 12778
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->splitNames:[Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->splitNames:[Ljava/lang/String;

    .line 12779
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->splitSourceDirs:[Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->splitSourceDirs:[Ljava/lang/String;

    .line 12780
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->splitPublicSourceDirs:[Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->splitPublicSourceDirs:[Ljava/lang/String;

    .line 12781
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->splitDependencies:Landroid/util/SparseArray;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->splitDependencies:Landroid/util/SparseArray;

    .line 12782
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->dataDir:Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->dataDir:Ljava/lang/String;

    .line 12783
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->deviceProtectedDataDir:Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->deviceProtectedDataDir:Ljava/lang/String;

    .line 12784
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->credentialProtectedDataDir:Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->credentialProtectedDataDir:Ljava/lang/String;

    .line 12785
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 12786
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->secondaryCpuAbi:Ljava/lang/String;

    .line 12787
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->nativeLibraryDir:Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->nativeLibraryDir:Ljava/lang/String;

    .line 12788
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->secondaryNativeLibraryDir:Ljava/lang/String;

    iput-object v8, v0, Landroid/content/pm/InstrumentationInfo;->secondaryNativeLibraryDir:Ljava/lang/String;

    .line 12789
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mInstrumentation:Landroid/util/ArrayMap;

    invoke-virtual {v15}, Landroid/content/pm/PackageParser$Instrumentation;->getComponentName()Landroid/content/ComponentName;

    move-result-object v8

    invoke-virtual {v0, v8, v15}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 12790
    if-eqz v5, :cond_25d

    .line 12791
    if-nez v10, :cond_250

    .line 12792
    new-instance v0, Ljava/lang/StringBuilder;

    const/16 v8, 0x100

    invoke-direct {v0, v8}, Ljava/lang/StringBuilder;-><init>(I)V

    move-object v10, v0

    const/16 v8, 0x20

    goto :goto_255

    .line 12794
    :cond_250
    const/16 v8, 0x20

    invoke-virtual {v10, v8}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;

    .line 12796
    :goto_255
    iget-object v0, v15, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v0, v0, Landroid/content/pm/InstrumentationInfo;->name:Ljava/lang/String;

    invoke-virtual {v10, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_25f

    .line 12790
    :cond_25d
    const/16 v8, 0x20

    .line 12773
    .end local v15  # "a":Landroid/content/pm/PackageParser$Instrumentation;
    :goto_25f
    add-int/lit8 v11, v11, 0x1

    move/from16 v0, v16

    goto/16 :goto_1be

    .line 12799
    .end local v16  # "collectionSize":I
    .restart local v0  # "collectionSize":I
    :cond_265
    move/from16 v16, v0

    .end local v0  # "collectionSize":I
    .restart local v16  # "collectionSize":I
    if-eqz v10, :cond_283

    .line 12800
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z

    if-eqz v0, :cond_283

    const-string v0, "PackageManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "  Instrumentation: "

    invoke-virtual {v8, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v0, v8}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 12803
    :cond_283
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->protectedBroadcasts:Ljava/util/ArrayList;

    if-eqz v0, :cond_2ae

    .line 12804
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->protectedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    move v8, v0

    .line 12805
    .end local v16  # "collectionSize":I
    .local v8, "collectionSize":I
    iget-object v15, v1, Lcom/android/server/pm/PackageManagerService;->mProtectedBroadcasts:Landroid/util/ArraySet;

    monitor-enter v15
    :try_end_291
    .catchall {:try_start_139 .. :try_end_291} :catchall_2cb

    .line 12806
    const/4 v0, 0x0

    move v11, v0

    :goto_293
    if-ge v11, v8, :cond_2a7

    .line 12807
    :try_start_295
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mProtectedBroadcasts:Landroid/util/ArraySet;

    iget-object v4, v2, Landroid/content/pm/PackageParser$Package;->protectedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v4, v11}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/String;

    invoke-virtual {v0, v4}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 12806
    add-int/lit8 v11, v11, 0x1

    move/from16 v4, p4

    goto :goto_293

    .line 12809
    :cond_2a7
    monitor-exit v15

    move/from16 v16, v8

    goto :goto_2ae

    :catchall_2ab
    move-exception v0

    monitor-exit v15
    :try_end_2ad
    .catchall {:try_start_295 .. :try_end_2ad} :catchall_2ab

    .end local v7  # "pkgName":Ljava/lang/String;
    .end local v9  # "clientLibPkgs":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p2  # "oldPkg":Landroid/content/pm/PackageParser$Package;
    .end local p3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local p4  # "scanFlags":I
    .end local p5  # "chatty":Z
    .end local p6  # "reconciledPkg":Lcom/android/server/pm/PackageManagerService$ReconciledPackage;
    :try_start_2ad
    throw v0

    .line 12812
    .end local v8  # "collectionSize":I
    .restart local v7  # "pkgName":Ljava/lang/String;
    .restart local v9  # "clientLibPkgs":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    .restart local v16  # "collectionSize":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p2  # "oldPkg":Landroid/content/pm/PackageParser$Package;
    .restart local p3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local p4  # "scanFlags":I
    .restart local p5  # "chatty":Z
    .restart local p6  # "reconciledPkg":Lcom/android/server/pm/PackageManagerService$ReconciledPackage;
    :cond_2ae
    :goto_2ae
    if-eqz v3, :cond_2c3

    .line 12821
    new-instance v0, Ljava/util/ArrayList;

    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4}, Landroid/util/ArrayMap;->keySet()Ljava/util/Set;

    move-result-object v4

    invoke-direct {v0, v4}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    .line 12823
    .local v0, "allPackageNames":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    new-instance v4, Lcom/android/server/pm/-$$Lambda$PackageManagerService$flUQp0qTsxUQY0aupDT6UsHb48I;

    invoke-direct {v4, v1, v2, v3, v0}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$flUQp0qTsxUQY0aupDT6UsHb48I;-><init>(Lcom/android/server/pm/PackageManagerService;Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/ArrayList;)V

    invoke-static {v4}, Landroid/os/AsyncTask;->execute(Ljava/lang/Runnable;)V

    .line 12827
    .end local v0  # "allPackageNames":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    .end local v10  # "r":Ljava/lang/StringBuilder;
    .end local v11  # "i":I
    .end local v14  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v16  # "collectionSize":I
    :cond_2c3
    monitor-exit v12
    :try_end_2c4
    .catchall {:try_start_2ad .. :try_end_2c4} :catchall_2cb

    .line 12829
    const-wide/32 v10, 0x40000

    invoke-static {v10, v11}, Landroid/os/Trace;->traceEnd(J)V

    .line 12830
    return-void

    .line 12827
    :catchall_2cb
    move-exception v0

    goto :goto_2d0

    :catchall_2cd
    move-exception v0

    move-object/from16 v13, p3

    :goto_2d0
    :try_start_2d0
    monitor-exit v12
    :try_end_2d1
    .catchall {:try_start_2d0 .. :try_end_2d1} :catchall_2cb

    throw v0

    .line 12707
    :catchall_2d2
    move-exception v0

    move-object/from16 v13, p3

    :goto_2d5
    :try_start_2d5
    monitor-exit v10
    :try_end_2d6
    .catchall {:try_start_2d5 .. :try_end_2d6} :catchall_2d7

    throw v0

    :catchall_2d7
    move-exception v0

    goto :goto_2d5
.end method

.method private commitPackagesLocked(Lcom/android/server/pm/PackageManagerService$CommitRequest;)V
    .registers 30
    .param p1, "request"  # Lcom/android/server/pm/PackageManagerService$CommitRequest;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 17474
    move-object/from16 v8, p0

    move-object/from16 v9, p1

    iget-object v0, v9, Lcom/android/server/pm/PackageManagerService$CommitRequest;->reconciledPackages:Ljava/util/Map;

    invoke-interface {v0}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v10

    :goto_e
    invoke-interface {v10}, Ljava/util/Iterator;->hasNext()Z

    move-result v0

    if-eqz v0, :cond_30b

    invoke-interface {v10}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    move-object v11, v0

    check-cast v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;

    .line 17475
    .local v11, "reconciledPkg":Lcom/android/server/pm/PackageManagerService$ReconciledPackage;
    iget-object v12, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->scanResult:Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17476
    .local v12, "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v13, v12, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    .line 17477
    .local v13, "scanRequest":Lcom/android/server/pm/PackageManagerService$ScanRequest;
    iget-object v14, v13, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 17478
    .local v14, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v15, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 17479
    .local v15, "packageName":Ljava/lang/String;
    iget-object v7, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    .line 17481
    .local v7, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->prepareResult:Lcom/android/server/pm/PackageManagerService$PrepareResult;

    iget-boolean v0, v0, Lcom/android/server/pm/PackageManagerService$PrepareResult;->replace:Z

    const/4 v5, 0x0

    const/4 v6, 0x1

    if-eqz v0, :cond_283

    .line 17482
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v15}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    move-object v3, v0

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 17485
    .local v3, "oldPackage":Landroid/content/pm/PackageParser$Package;
    iget-object v0, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    move-object v4, v0

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 17486
    .local v4, "deletedPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-wide v0, v4, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    .line 17487
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v16

    .line 17486
    move-wide/from16 v18, v0

    move-object/from16 v1, p0

    move-object v2, v14

    move-object/from16 v21, v4

    move-object/from16 v20, v10

    move-object v10, v3

    .end local v3  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "deletedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v10, "oldPackage":Landroid/content/pm/PackageParser$Package;
    .local v21, "deletedPkgSetting":Lcom/android/server/pm/PackageSetting;
    move-wide/from16 v3, v18

    move-object/from16 v18, v12

    move v12, v6

    .end local v12  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .local v18, "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    move-wide/from16 v5, v16

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->setInstallAndUpdateTime(Landroid/content/pm/PackageParser$Package;JJ)V

    .line 17489
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->prepareResult:Lcom/android/server/pm/PackageManagerService$PrepareResult;

    iget-boolean v0, v0, Lcom/android/server/pm/PackageManagerService$PrepareResult;->system:Z

    const/4 v6, 0x0

    if-eqz v0, :cond_13d

    .line 17491
    invoke-direct {v8, v10, v12}, Lcom/android/server/pm/PackageManagerService;->removePackageLI(Landroid/content/pm/PackageParser$Package;Z)V

    .line 17492
    invoke-direct {v8, v10, v14}, Lcom/android/server/pm/PackageManagerService;->disableSystemPackageLPw(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-nez v0, :cond_80

    .line 17496
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v1, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 17497
    invoke-virtual {v1}, Landroid/content/pm/ApplicationInfo;->getCodePath()Ljava/lang/String;

    move-result-object v1

    iget-object v2, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 17498
    invoke-virtual {v2}, Landroid/content/pm/ApplicationInfo;->getResourcePath()Ljava/lang/String;

    move-result-object v2

    iget-object v3, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 17499
    invoke-static {v3}, Lcom/android/server/pm/InstructionSets;->getAppDexInstructionSets(Landroid/content/pm/ApplicationInfo;)[Ljava/lang/String;

    move-result-object v3

    .line 17496
    invoke-direct {v8, v1, v2, v3}, Lcom/android/server/pm/PackageManagerService;->createInstallArgsForExisting(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$InstallArgs;

    move-result-object v1

    iput-object v1, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    goto :goto_84

    .line 17501
    :cond_80
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iput-object v6, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    .line 17507
    :goto_84
    iget-object v0, v10, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_8f

    .line 17508
    iget-object v0, v10, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v5

    goto :goto_90

    :cond_8f
    const/4 v5, 0x0

    :goto_90
    move v0, v5

    .line 17509
    .local v0, "deletedChildCount":I
    iget-object v1, v14, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v1, :cond_9c

    .line 17510
    iget-object v1, v14, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v5

    goto :goto_9d

    :cond_9c
    const/4 v5, 0x0

    :goto_9d
    move v6, v5

    .line 17511
    .local v6, "newChildCount":I
    const/4 v1, 0x0

    move v5, v1

    .local v5, "i":I
    :goto_a0
    if-ge v5, v0, :cond_134

    .line 17512
    iget-object v1, v10, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    move-object v4, v1

    check-cast v4, Landroid/content/pm/PackageParser$Package;

    .line 17513
    .local v4, "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    const/4 v1, 0x1

    .line 17514
    .local v1, "childPackageDeleted":Z
    const/4 v2, 0x0

    .local v2, "j":I
    :goto_ad
    if-ge v2, v6, :cond_cc

    .line 17515
    iget-object v3, v14, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 17516
    .local v3, "newChildPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v12, v4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    move/from16 v17, v0

    .end local v0  # "deletedChildCount":I
    .local v17, "deletedChildCount":I
    iget-object v0, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v12, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_c6

    .line 17517
    const/4 v1, 0x0

    .line 17518
    move v0, v1

    goto :goto_cf

    .line 17514
    .end local v3  # "newChildPkg":Landroid/content/pm/PackageParser$Package;
    :cond_c6
    add-int/lit8 v2, v2, 0x1

    move/from16 v0, v17

    const/4 v12, 0x1

    goto :goto_ad

    .end local v17  # "deletedChildCount":I
    .restart local v0  # "deletedChildCount":I
    :cond_cc
    move/from16 v17, v0

    .end local v0  # "deletedChildCount":I
    .restart local v17  # "deletedChildCount":I
    move v0, v1

    .line 17521
    .end local v1  # "childPackageDeleted":Z
    .end local v2  # "j":I
    .local v0, "childPackageDeleted":Z
    :goto_cf
    if-eqz v0, :cond_125

    .line 17522
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v12

    .line 17524
    .local v12, "ps1":Lcom/android/server/pm/PackageSetting;
    if-eqz v12, :cond_11e

    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v1, v1, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    if-eqz v1, :cond_11e

    .line 17525
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v1, v1, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    iget-object v2, v4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 17526
    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    move-object v3, v1

    check-cast v3, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    .line 17527
    .local v3, "removedChildRes":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    iget-object v2, v9, Lcom/android/server/pm/PackageManagerService$CommitRequest;->mAllUsers:[I

    const/16 v22, 0x0

    const/16 v23, 0x0

    move-object/from16 v1, p0

    move-object/from16 v24, v2

    move-object v2, v12

    move-object/from16 v25, v3

    .end local v3  # "removedChildRes":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .local v25, "removedChildRes":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    move-object/from16 v3, v24

    move-object/from16 v24, v4

    .end local v4  # "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    .local v24, "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    move-object/from16 v4, v25

    move/from16 v26, v5

    .end local v5  # "i":I
    .local v26, "i":I
    move/from16 v5, v22

    move/from16 v22, v6

    .end local v6  # "newChildCount":I
    .local v22, "newChildCount":I
    move/from16 v6, v23

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->removePackageDataLIF(Lcom/android/server/pm/PackageSetting;[ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;IZ)V

    .line 17529
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, v12, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    if-nez v1, :cond_118

    const/4 v1, 0x1

    goto :goto_119

    :cond_118
    const/4 v1, 0x0

    :goto_119
    move-object/from16 v2, v25

    .end local v25  # "removedChildRes":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .local v2, "removedChildRes":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    iput-boolean v1, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedForAllUsers:Z

    goto :goto_12b

    .line 17524
    .end local v2  # "removedChildRes":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v22  # "newChildCount":I
    .end local v24  # "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    .end local v26  # "i":I
    .restart local v4  # "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    .restart local v5  # "i":I
    .restart local v6  # "newChildCount":I
    :cond_11e
    move-object/from16 v24, v4

    move/from16 v26, v5

    move/from16 v22, v6

    .end local v4  # "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "i":I
    .end local v6  # "newChildCount":I
    .restart local v22  # "newChildCount":I
    .restart local v24  # "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    .restart local v26  # "i":I
    goto :goto_12b

    .line 17521
    .end local v12  # "ps1":Lcom/android/server/pm/PackageSetting;
    .end local v22  # "newChildCount":I
    .end local v24  # "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    .end local v26  # "i":I
    .restart local v4  # "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    .restart local v5  # "i":I
    .restart local v6  # "newChildCount":I
    :cond_125
    move-object/from16 v24, v4

    move/from16 v26, v5

    move/from16 v22, v6

    .line 17511
    .end local v0  # "childPackageDeleted":Z
    .end local v4  # "deletedChildPkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "i":I
    .end local v6  # "newChildCount":I
    .restart local v22  # "newChildCount":I
    .restart local v26  # "i":I
    :goto_12b
    add-int/lit8 v5, v26, 0x1

    move/from16 v0, v17

    move/from16 v6, v22

    const/4 v12, 0x1

    .end local v26  # "i":I
    .restart local v5  # "i":I
    goto/16 :goto_a0

    .end local v17  # "deletedChildCount":I
    .end local v22  # "newChildCount":I
    .local v0, "deletedChildCount":I
    .restart local v6  # "newChildCount":I
    :cond_134
    move/from16 v17, v0

    move/from16 v26, v5

    move/from16 v22, v6

    .line 17534
    .end local v0  # "deletedChildCount":I
    .end local v5  # "i":I
    .end local v6  # "newChildCount":I
    move-object v12, v7

    goto/16 :goto_288

    .line 17536
    :cond_13d
    :try_start_13d
    iget-object v2, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->deletePackageAction:Lcom/android/server/pm/PackageManagerService$DeletePackageAction;

    const/4 v4, 0x1

    iget-object v5, v9, Lcom/android/server/pm/PackageManagerService$CommitRequest;->mAllUsers:[I
    :try_end_142
    .catch Lcom/android/server/pm/PackageManagerService$SystemDeleteException; {:try_start_13d .. :try_end_142} :catch_151

    const/4 v0, 0x1

    move-object/from16 v1, p0

    move-object v3, v15

    move-object v12, v6

    move v6, v0

    move-object/from16 v27, v7

    .end local v7  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .local v27, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    move-object v7, v14

    :try_start_14b
    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->executeDeletePackageLIF(Lcom/android/server/pm/PackageManagerService$DeletePackageAction;Ljava/lang/String;Z[IZLandroid/content/pm/PackageParser$Package;)V
    :try_end_14e
    .catch Lcom/android/server/pm/PackageManagerService$SystemDeleteException; {:try_start_14b .. :try_end_14e} :catch_14f

    .line 17543
    goto :goto_159

    .line 17538
    :catch_14f
    move-exception v0

    goto :goto_155

    .end local v27  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .restart local v7  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catch_151
    move-exception v0

    move-object v12, v6

    move-object/from16 v27, v7

    .line 17539
    .end local v7  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .local v0, "e":Lcom/android/server/pm/PackageManagerService$SystemDeleteException;
    .restart local v27  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :goto_155
    sget-boolean v1, Landroid/os/Build;->IS_ENG:Z

    if-nez v1, :cond_27b

    .line 17548
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerService$SystemDeleteException;
    :goto_159
    invoke-virtual {v10}, Landroid/content/pm/PackageParser$Package;->isForwardLocked()Z

    move-result v0

    if-nez v0, :cond_165

    invoke-static {v10}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-eqz v0, :cond_1a4

    .line 17549
    :cond_165
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_185

    .line 17550
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v1, "upgrading pkg "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v1, " is ASEC-hosted -> UNAVAILABLE"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 17553
    :cond_185
    const/4 v1, 0x1

    new-array v5, v1, [I

    iget-object v0, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    const/4 v2, 0x0

    aput v0, v5, v2

    .line 17554
    .local v5, "uidArray":[I
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    .line 17555
    .local v0, "pkgList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    iget-object v1, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 17556
    const/4 v2, 0x0

    const/4 v3, 0x1

    const/4 v6, 0x0

    move-object/from16 v1, p0

    move-object v4, v0

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->sendResourcesChangedBroadcast(ZZLjava/util/ArrayList;[ILandroid/content/IIntentReceiver;)V

    .line 17560
    .end local v0  # "pkgList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    .end local v5  # "uidArray":[I
    :cond_1a4
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v1, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->prepareResult:Lcom/android/server/pm/PackageManagerService$PrepareResult;

    iget-object v1, v1, Lcom/android/server/pm/PackageManagerService$PrepareResult;->existingPackage:Landroid/content/pm/PackageParser$Package;

    iget-object v1, v1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 17562
    .local v0, "ps1":Lcom/android/server/pm/PackageSetting;
    iget-object v1, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->installArgs:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget v1, v1, Lcom/android/server/pm/PackageManagerService$InstallArgs;->installFlags:I

    const/4 v2, 0x1

    and-int/2addr v1, v2

    if-nez v1, :cond_1e0

    .line 17564
    iget-object v1, v0, Lcom/android/server/pm/PackageSetting;->mOldCodePaths:Ljava/util/Set;

    if-nez v1, :cond_1c7

    .line 17565
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    iput-object v1, v0, Lcom/android/server/pm/PackageSetting;->mOldCodePaths:Ljava/util/Set;

    .line 17567
    :cond_1c7
    iget-object v1, v0, Lcom/android/server/pm/PackageSetting;->mOldCodePaths:Ljava/util/Set;

    const/4 v2, 0x1

    new-array v3, v2, [Ljava/lang/String;

    iget-object v2, v10, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    const/4 v4, 0x0

    aput-object v2, v3, v4

    invoke-static {v1, v3}, Ljava/util/Collections;->addAll(Ljava/util/Collection;[Ljava/lang/Object;)Z

    .line 17568
    iget-object v1, v10, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    if-eqz v1, :cond_1e2

    .line 17569
    iget-object v1, v0, Lcom/android/server/pm/PackageSetting;->mOldCodePaths:Ljava/util/Set;

    iget-object v2, v10, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    invoke-static {v1, v2}, Ljava/util/Collections;->addAll(Ljava/util/Collection;[Ljava/lang/Object;)Z

    goto :goto_1e2

    .line 17572
    :cond_1e0
    iput-object v12, v0, Lcom/android/server/pm/PackageSetting;->mOldCodePaths:Ljava/util/Set;

    .line 17574
    :cond_1e2
    :goto_1e2
    iget-object v1, v0, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v1, :cond_209

    .line 17575
    iget-object v1, v0, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v1

    const/4 v2, 0x1

    sub-int/2addr v1, v2

    .local v1, "i":I
    :goto_1ee
    if-ltz v1, :cond_209

    .line 17576
    iget-object v2, v0, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v2, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/String;

    .line 17577
    .local v2, "childPkgName":Ljava/lang/String;
    iget-object v3, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 17578
    .local v3, "childPs":Lcom/android/server/pm/PackageSetting;
    iget-object v4, v0, Lcom/android/server/pm/PackageSetting;->mOldCodePaths:Ljava/util/Set;

    iput-object v4, v3, Lcom/android/server/pm/PackageSetting;->mOldCodePaths:Ljava/util/Set;

    .line 17575
    .end local v2  # "childPkgName":Ljava/lang/String;
    .end local v3  # "childPs":Lcom/android/server/pm/PackageSetting;
    add-int/lit8 v1, v1, -0x1

    goto :goto_1ee

    .line 17582
    .end local v1  # "i":I
    :cond_209
    iget-object v1, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v1, v1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    const/4 v2, 0x1

    if-ne v1, v2, :cond_278

    .line 17584
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v1

    .line 17585
    .local v1, "ps2":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_275

    .line 17586
    move-object/from16 v12, v27

    .end local v27  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .local v12, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    iget-object v2, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v3, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    if-nez v3, :cond_22a

    const/4 v3, 0x1

    goto :goto_22b

    :cond_22a
    const/4 v3, 0x0

    :goto_22b
    iput-boolean v3, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedForAllUsers:Z

    .line 17587
    iget-object v2, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v2, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    if-eqz v2, :cond_288

    .line 17588
    iget-object v2, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v2, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->size()I

    move-result v2

    .line 17590
    .local v2, "childCount1":I
    add-int/lit8 v3, v2, -0x1

    .local v3, "i":I
    :goto_23d
    if-ltz v3, :cond_288

    .line 17591
    iget-object v4, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    .line 17592
    invoke-virtual {v4, v3}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/String;

    .line 17593
    .local v4, "childPackageName":Ljava/lang/String;
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->addedChildPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v4}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_259

    .line 17594
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v5, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v3}, Landroid/util/ArrayMap;->removeAt(I)Ljava/lang/Object;

    goto :goto_272

    .line 17596
    :cond_259
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v5, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    .line 17597
    invoke-virtual {v5, v3}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    .line 17598
    .local v5, "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    iget-object v6, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v7, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    invoke-virtual {v6, v7}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    if-nez v6, :cond_26f

    const/4 v6, 0x1

    goto :goto_270

    :cond_26f
    const/4 v6, 0x0

    :goto_270
    iput-boolean v6, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedForAllUsers:Z

    .line 17590
    .end local v4  # "childPackageName":Ljava/lang/String;
    .end local v5  # "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :goto_272
    add-int/lit8 v3, v3, -0x1

    goto :goto_23d

    .line 17585
    .end local v2  # "childCount1":I
    .end local v3  # "i":I
    .end local v12  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .restart local v27  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :cond_275
    move-object/from16 v12, v27

    .end local v27  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .restart local v12  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    goto :goto_288

    .line 17582
    .end local v1  # "ps2":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .restart local v27  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :cond_278
    move-object/from16 v12, v27

    .end local v27  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .restart local v12  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    goto :goto_288

    .line 17540
    .end local v12  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .local v0, "e":Lcom/android/server/pm/PackageManagerService$SystemDeleteException;
    .restart local v27  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :cond_27b
    new-instance v1, Ljava/lang/RuntimeException;

    const-string v2, "Unexpected failure"

    invoke-direct {v1, v2, v0}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V

    throw v1

    .line 17481
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerService$SystemDeleteException;
    .end local v10  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .end local v21  # "deletedPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v27  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .restart local v7  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .local v12, "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_283
    move-object/from16 v20, v10

    move-object/from16 v18, v12

    move-object v12, v7

    .line 17608
    .end local v7  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .local v12, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .restart local v18  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_288
    :goto_288
    invoke-direct {v8, v11}, Lcom/android/server/pm/PackageManagerService;->commitReconciledScanResultLocked(Lcom/android/server/pm/PackageManagerService$ReconciledPackage;)V

    .line 17609
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->installArgs:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService$InstallArgs;->installerPackageName:Ljava/lang/String;

    iget-object v4, v9, Lcom/android/server/pm/PackageManagerService$CommitRequest;->mAllUsers:[I

    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->installArgs:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v6, v0, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;

    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->installArgs:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget v7, v0, Lcom/android/server/pm/PackageManagerService$InstallArgs;->installReason:I

    move-object/from16 v1, p0

    move-object v2, v14

    move-object v5, v12

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->updateSettingsLI(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;[ILcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/os/UserHandle;I)V

    .line 17612
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v15}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 17613
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_2be

    .line 17614
    sget-object v1, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v1

    const/4 v2, 0x1

    invoke-virtual {v0, v1, v2}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v1

    iput-object v1, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    .line 17615
    const/4 v2, 0x0

    invoke-virtual {v0, v2}, Lcom/android/server/pm/PackageSetting;->setUpdateAvailable(Z)V

    goto :goto_2bf

    .line 17613
    :cond_2be
    const/4 v2, 0x0

    .line 17617
    :goto_2bf
    iget-object v1, v14, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v1, :cond_2ca

    iget-object v1, v14, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v5

    move v2, v5

    :cond_2ca
    move v1, v2

    .line 17618
    .local v1, "childCount":I
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_2cc
    if-ge v2, v1, :cond_2fa

    .line 17619
    iget-object v3, v14, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 17620
    .local v3, "childPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v4, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->addedChildPackages:Landroid/util/ArrayMap;

    iget-object v5, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    .line 17622
    .local v4, "childRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v5

    .line 17623
    .local v5, "childPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v5, :cond_2f7

    .line 17624
    sget-object v6, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    .line 17625
    invoke-virtual {v6}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v6

    .line 17624
    const/4 v7, 0x1

    invoke-virtual {v5, v6, v7}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v6

    iput-object v6, v4, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    .line 17618
    .end local v3  # "childPkg":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "childRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .end local v5  # "childPs":Lcom/android/server/pm/PackageSetting;
    :cond_2f7
    add-int/lit8 v2, v2, 0x1

    goto :goto_2cc

    .line 17628
    .end local v2  # "i":I
    :cond_2fa
    iget v2, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    const/4 v3, 0x1

    if-ne v2, v3, :cond_307

    .line 17629
    iget-object v2, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    invoke-direct {v8, v0, v2}, Lcom/android/server/pm/PackageManagerService;->updateSequenceNumberLP(Lcom/android/server/pm/PackageSetting;[I)V

    .line 17630
    invoke-direct {v8, v15}, Lcom/android/server/pm/PackageManagerService;->updateInstantAppInstallerLocked(Ljava/lang/String;)V

    .line 17632
    .end local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v1  # "childCount":I
    .end local v11  # "reconciledPkg":Lcom/android/server/pm/PackageManagerService$ReconciledPackage;
    .end local v12  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .end local v13  # "scanRequest":Lcom/android/server/pm/PackageManagerService$ScanRequest;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v15  # "packageName":Ljava/lang/String;
    .end local v18  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_307
    move-object/from16 v10, v20

    goto/16 :goto_e

    .line 17633
    :cond_30b
    return-void
.end method

.method private commitReconciledScanResultLocked(Lcom/android/server/pm/PackageManagerService$ReconciledPackage;)V
    .registers 25
    .param p1, "reconciledPkg"  # Lcom/android/server/pm/PackageManagerService$ReconciledPackage;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages",
            "mInstallLock"
        }
    .end annotation

    .line 11498
    move-object/from16 v8, p0

    move-object/from16 v9, p1

    iget-object v10, v9, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->scanResult:Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 11499
    .local v10, "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v11, v10, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    .line 11500
    .local v11, "request":Lcom/android/server/pm/PackageManagerService$ScanRequest;
    iget-object v12, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 11501
    .local v12, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v13, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->oldPkg:Landroid/content/pm/PackageParser$Package;

    .line 11502
    .local v13, "oldPkg":Landroid/content/pm/PackageParser$Package;
    iget v14, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->parseFlags:I

    .line 11503
    .local v14, "parseFlags":I
    iget v15, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->scanFlags:I

    .line 11504
    .local v15, "scanFlags":I
    iget-object v7, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->oldPkgSetting:Lcom/android/server/pm/PackageSetting;

    .line 11505
    .local v7, "oldPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v6, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->originalPkgSetting:Lcom/android/server/pm/PackageSetting;

    .line 11506
    .local v6, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v5, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->user:Landroid/os/UserHandle;

    .line 11507
    .local v5, "user":Landroid/os/UserHandle;
    iget-object v4, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->realPkgName:Ljava/lang/String;

    .line 11508
    .local v4, "realPkgName":Ljava/lang/String;
    iget-object v3, v10, Lcom/android/server/pm/PackageManagerService$ScanResult;->changedAbiCodePath:Ljava/util/List;

    .line 11510
    .local v3, "changedAbiCodePath":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    if-eqz v0, :cond_37

    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v0, v0, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eqz v0, :cond_37

    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v0, v0, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v1, v1, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eq v0, v1, :cond_37

    .line 11513
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v0, v0, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v1, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/SharedUserSetting;->removePackage(Lcom/android/server/pm/PackageSetting;)Z

    .line 11515
    :cond_37
    iget-boolean v0, v10, Lcom/android/server/pm/PackageManagerService$ScanResult;->existingSettingCopied:Z

    if-eqz v0, :cond_46

    .line 11516
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    .line 11517
    .local v0, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageSetting;->updateFrom(Lcom/android/server/pm/PackageSetting;)V

    .line 11518
    iput-object v0, v12, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    move-object v2, v0

    goto :goto_67

    .line 11520
    .end local v0  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_46
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    .line 11521
    .restart local v0  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v6, :cond_56

    .line 11522
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v12, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    move-object/from16 v16, v0

    .end local v0  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v16, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v0, v6, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2, v0}, Lcom/android/server/pm/Settings;->addRenamedPackageLPw(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    goto :goto_58

    .line 11521
    .end local v16  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v0  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_56
    move-object/from16 v16, v0

    .line 11524
    .end local v0  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v16  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_58
    if-eqz v6, :cond_65

    and-int/lit16 v0, v15, 0x400

    if-nez v0, :cond_65

    .line 11525
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mTransferedPackages:Landroid/util/ArraySet;

    iget-object v1, v6, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v0, v1}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 11528
    :cond_65
    move-object/from16 v2, v16

    .end local v16  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v2, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_67
    iget-object v0, v2, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eqz v0, :cond_70

    .line 11529
    iget-object v0, v2, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    invoke-virtual {v0, v2}, Lcom/android/server/pm/SharedUserSetting;->addPackage(Lcom/android/server/pm/PackageSetting;)V

    .line 11537
    :cond_70
    iget-object v0, v12, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v2, Lcom/android/server/pm/PackageSetting;->appId:I

    iput v1, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    .line 11539
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v2, v7}, Lcom/android/server/pm/Settings;->writeUserRestrictionsLPw(Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;)V

    .line 11541
    and-int/lit16 v0, v15, 0x400

    if-nez v0, :cond_88

    if-eqz v4, :cond_88

    .line 11542
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mTransferedPackages:Landroid/util/ArraySet;

    iget-object v1, v12, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 11545
    :cond_88
    iget-object v0, v9, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->collectedSharedLibraryInfos:Ljava/util/ArrayList;

    if-eqz v0, :cond_92

    .line 11546
    const/4 v0, 0x0

    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->collectedSharedLibraryInfos:Ljava/util/ArrayList;

    invoke-direct {v8, v12, v0, v1}, Lcom/android/server/pm/PackageManagerService;->executeSharedLibrariesUpdateLPr(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/ArrayList;)V

    .line 11549
    :cond_92
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v0, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 11550
    .local v1, "ksms":Lcom/android/server/pm/KeySetManagerService;
    iget-boolean v0, v9, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->removeAppKeySetData:Z

    if-eqz v0, :cond_9f

    .line 11551
    iget-object v0, v12, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v0}, Lcom/android/server/pm/KeySetManagerService;->removeAppKeySetDataLPw(Ljava/lang/String;)V

    .line 11553
    :cond_9f
    iget-boolean v0, v9, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->sharedUserSignaturesChanged:Z

    if-eqz v0, :cond_b4

    .line 11554
    iget-object v0, v2, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    move-object/from16 v16, v1

    .end local v1  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .local v16, "ksms":Lcom/android/server/pm/KeySetManagerService;
    sget-object v1, Ljava/lang/Boolean;->TRUE:Ljava/lang/Boolean;

    iput-object v1, v0, Lcom/android/server/pm/SharedUserSetting;->signaturesChanged:Ljava/lang/Boolean;

    .line 11555
    iget-object v0, v2, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v0, v0, Lcom/android/server/pm/SharedUserSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->signingDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iput-object v1, v0, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    goto :goto_b6

    .line 11553
    .end local v16  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v1  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_b4
    move-object/from16 v16, v1

    .line 11557
    .end local v1  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v16  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :goto_b6
    iget-object v0, v2, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->signingDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iput-object v1, v0, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    .line 11559
    and-int/lit16 v0, v15, 0x400

    const/4 v1, 0x1

    if-nez v0, :cond_12a

    iget-object v0, v12, Landroid/content/pm/PackageParser$Package;->mAdoptPermissions:Ljava/util/ArrayList;

    if-eqz v0, :cond_12a

    .line 11562
    iget-object v0, v12, Landroid/content/pm/PackageParser$Package;->mAdoptPermissions:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    sub-int/2addr v0, v1

    .local v0, "i":I
    :goto_cc
    if-ltz v0, :cond_125

    .line 11563
    iget-object v1, v12, Landroid/content/pm/PackageParser$Package;->mAdoptPermissions:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/lang/String;

    .line 11564
    .local v1, "origName":Ljava/lang/String;
    move-object/from16 v18, v2

    .end local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v18, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v1}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v2

    .line 11565
    .local v2, "orig":Lcom/android/server/pm/PackageSetting;
    if-eqz v2, :cond_119

    .line 11566
    invoke-direct {v8, v2, v12}, Lcom/android/server/pm/PackageManagerService;->verifyPackageUpdateLPr(Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$Package;)Z

    move-result v19

    if-eqz v19, :cond_114

    .line 11567
    move-object/from16 v19, v2

    .end local v2  # "orig":Lcom/android/server/pm/PackageSetting;
    .local v19, "orig":Lcom/android/server/pm/PackageSetting;
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v20, v4

    .end local v4  # "realPkgName":Ljava/lang/String;
    .local v20, "realPkgName":Ljava/lang/String;
    const-string v4, "Adopting permissions from "

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " to "

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v12, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v4, "PackageManager"

    invoke-static {v4, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 11569
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPermissions:Lcom/android/server/pm/permission/PermissionSettings;

    iget-object v4, v12, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v1, v4}, Lcom/android/server/pm/permission/PermissionSettings;->transferPermissions(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_11d

    .line 11566
    .end local v19  # "orig":Lcom/android/server/pm/PackageSetting;
    .end local v20  # "realPkgName":Ljava/lang/String;
    .restart local v2  # "orig":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "realPkgName":Ljava/lang/String;
    :cond_114
    move-object/from16 v19, v2

    move-object/from16 v20, v4

    .end local v2  # "orig":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "realPkgName":Ljava/lang/String;
    .restart local v19  # "orig":Lcom/android/server/pm/PackageSetting;
    .restart local v20  # "realPkgName":Ljava/lang/String;
    goto :goto_11d

    .line 11565
    .end local v19  # "orig":Lcom/android/server/pm/PackageSetting;
    .end local v20  # "realPkgName":Ljava/lang/String;
    .restart local v2  # "orig":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "realPkgName":Ljava/lang/String;
    :cond_119
    move-object/from16 v19, v2

    move-object/from16 v20, v4

    .line 11562
    .end local v1  # "origName":Ljava/lang/String;
    .end local v2  # "orig":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "realPkgName":Ljava/lang/String;
    .restart local v20  # "realPkgName":Ljava/lang/String;
    :goto_11d
    add-int/lit8 v0, v0, -0x1

    move-object/from16 v2, v18

    move-object/from16 v4, v20

    const/4 v1, 0x1

    goto :goto_cc

    .end local v18  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v20  # "realPkgName":Ljava/lang/String;
    .local v2, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "realPkgName":Ljava/lang/String;
    :cond_125
    move-object/from16 v18, v2

    move-object/from16 v20, v4

    .end local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "realPkgName":Ljava/lang/String;
    .restart local v18  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v20  # "realPkgName":Ljava/lang/String;
    goto :goto_12e

    .line 11559
    .end local v0  # "i":I
    .end local v18  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v20  # "realPkgName":Ljava/lang/String;
    .restart local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "realPkgName":Ljava/lang/String;
    :cond_12a
    move-object/from16 v18, v2

    move-object/from16 v20, v4

    .line 11575
    .end local v2  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "realPkgName":Ljava/lang/String;
    .restart local v18  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v20  # "realPkgName":Ljava/lang/String;
    :goto_12e
    if-eqz v3, :cond_159

    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v0

    if-lez v0, :cond_159

    .line 11576
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v0

    const/4 v1, 0x1

    sub-int/2addr v0, v1

    move v2, v0

    .local v2, "i":I
    :goto_13d
    if-ltz v2, :cond_159

    .line 11577
    invoke-interface {v3, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    move-object v4, v0

    check-cast v4, Ljava/lang/String;

    .line 11579
    .local v4, "codePathString":Ljava/lang/String;
    :try_start_146
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    .line 11580
    invoke-static {}, Lcom/android/server/pm/InstructionSets;->getPreferredInstructionSet()Ljava/lang/String;

    move-result-object v17

    invoke-static/range {v17 .. v17}, Lcom/android/server/pm/InstructionSets;->getDexCodeInstructionSet(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    .line 11579
    invoke-virtual {v0, v4, v1}, Lcom/android/server/pm/Installer;->rmdex(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_153
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_146 .. :try_end_153} :catch_154

    .line 11582
    goto :goto_155

    .line 11581
    :catch_154
    move-exception v0

    .line 11576
    .end local v4  # "codePathString":Ljava/lang/String;
    :goto_155
    add-int/lit8 v2, v2, -0x1

    const/4 v1, 0x1

    goto :goto_13d

    .line 11586
    .end local v2  # "i":I
    :cond_159
    and-int/lit16 v0, v15, 0x400

    if-eqz v0, :cond_189

    .line 11587
    if-eqz v7, :cond_17c

    .line 11588
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 11589
    :try_start_162
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, v7, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v0, v2, v7}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 11590
    monitor-exit v1

    move-object/from16 v21, v6

    move-object/from16 v22, v7

    move-object/from16 v1, v18

    move-object/from16 v19, v20

    move-object/from16 v18, v3

    move-object/from16 v20, v5

    goto :goto_1c2

    :catchall_179
    move-exception v0

    monitor-exit v1
    :try_end_17b
    .catchall {:try_start_162 .. :try_end_17b} :catchall_179

    throw v0

    .line 11587
    :cond_17c
    move-object/from16 v21, v6

    move-object/from16 v22, v7

    move-object/from16 v1, v18

    move-object/from16 v19, v20

    move-object/from16 v18, v3

    move-object/from16 v20, v5

    goto :goto_1c2

    .line 11593
    :cond_189
    const/4 v0, 0x0

    if-nez v5, :cond_18e

    move v1, v0

    goto :goto_192

    :cond_18e
    invoke-virtual {v5}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v1

    :goto_192
    move v4, v1

    .line 11595
    .local v4, "userId":I
    const/high16 v1, -0x80000000

    and-int/2addr v1, v14

    if-eqz v1, :cond_199

    const/4 v0, 0x1

    :cond_199
    move-object/from16 v1, p0

    move-object/from16 v17, v18

    .end local v18  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v17, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object v2, v12

    move-object/from16 v18, v3

    .end local v3  # "changedAbiCodePath":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v18, "changedAbiCodePath":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move-object v3, v13

    move v9, v4

    move-object/from16 v19, v20

    .end local v4  # "userId":I
    .end local v20  # "realPkgName":Ljava/lang/String;
    .local v9, "userId":I
    .local v19, "realPkgName":Ljava/lang/String;
    move-object/from16 v4, v17

    move-object/from16 v20, v5

    .end local v5  # "user":Landroid/os/UserHandle;
    .local v20, "user":Landroid/os/UserHandle;
    move v5, v15

    move-object/from16 v21, v6

    .end local v6  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v21, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    move v6, v0

    move-object/from16 v22, v7

    .end local v7  # "oldPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v22, "oldPkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v7, p1

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->commitPackageSettings(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/PackageSetting;IZLcom/android/server/pm/PackageManagerService$ReconciledPackage;)V

    .line 11597
    move-object/from16 v1, v17

    .end local v17  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v1, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v1, v9}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v0

    if-eqz v0, :cond_1c2

    .line 11598
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    iget v2, v1, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-virtual {v0, v9, v2}, Lcom/android/server/pm/InstantAppRegistry;->addInstantAppLPw(II)V

    .line 11601
    .end local v9  # "userId":I
    :cond_1c2
    :goto_1c2
    return-void
.end method

.method private commitSharedLibraryInfoLocked(Landroid/content/pm/SharedLibraryInfo;)V
    .registers 7
    .param p1, "libraryInfo"  # Landroid/content/pm/SharedLibraryInfo;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 12599
    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v0

    .line 12600
    .local v0, "name":Ljava/lang/String;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v1, v0}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/util/LongSparseArray;

    .line 12601
    .local v1, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-nez v1, :cond_19

    .line 12602
    new-instance v2, Landroid/util/LongSparseArray;

    invoke-direct {v2}, Landroid/util/LongSparseArray;-><init>()V

    move-object v1, v2

    .line 12603
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v2, v0, v1}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 12605
    :cond_19
    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v2

    invoke-virtual {v2}, Landroid/content/pm/VersionedPackage;->getPackageName()Ljava/lang/String;

    move-result-object v2

    .line 12606
    .local v2, "declaringPackageName":Ljava/lang/String;
    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getType()I

    move-result v3

    const/4 v4, 0x2

    if-ne v3, v4, :cond_2d

    .line 12607
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mStaticLibsByDeclaringPackage:Landroid/util/ArrayMap;

    invoke-virtual {v3, v2, v1}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 12609
    :cond_2d
    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v3

    invoke-virtual {v1, v3, v4, p1}, Landroid/util/LongSparseArray;->put(JLjava/lang/Object;)V

    .line 12610
    return-void
.end method

.method private createForwardingResolveInfo(Lcom/android/server/pm/CrossProfileIntentFilter;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;
    .registers 11
    .param p1, "filter"  # Lcom/android/server/pm/CrossProfileIntentFilter;
    .param p2, "intent"  # Landroid/content/Intent;
    .param p3, "resolvedType"  # Ljava/lang/String;
    .param p4, "flags"  # I
    .param p5, "sourceUserId"  # I

    .line 8265
    invoke-virtual {p1}, Lcom/android/server/pm/CrossProfileIntentFilter;->getTargetUserId()I

    move-result v0

    .line 8266
    .local v0, "targetUserId":I
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v1, p2, p3, p4, v0}, Lcom/android/server/pm/ComponentResolver;->queryActivities(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v1

    .line 8268
    .local v1, "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-eqz v1, :cond_33

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->isUserEnabled(I)Z

    move-result v2

    if-eqz v2, :cond_33

    .line 8270
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v2

    add-int/lit8 v2, v2, -0x1

    .local v2, "i":I
    :goto_18
    if-ltz v2, :cond_33

    .line 8271
    invoke-interface {v1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    iget-object v3, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->flags:I

    const/high16 v4, 0x40000000  # 2.0f

    and-int/2addr v3, v4

    if-nez v3, :cond_30

    .line 8273
    invoke-direct {p0, p1, p5, v0}, Lcom/android/server/pm/PackageManagerService;->createForwardingResolveInfoUnchecked(Landroid/content/IntentFilter;II)Landroid/content/pm/ResolveInfo;

    move-result-object v3

    return-object v3

    .line 8270
    :cond_30
    add-int/lit8 v2, v2, -0x1

    goto :goto_18

    .line 8278
    .end local v2  # "i":I
    :cond_33
    const/4 v2, 0x0

    return-object v2
.end method

.method private createForwardingResolveInfoUnchecked(Landroid/content/IntentFilter;II)Landroid/content/pm/ResolveInfo;
    .registers 13
    .param p1, "filter"  # Landroid/content/IntentFilter;
    .param p2, "sourceUserId"  # I
    .param p3, "targetUserId"  # I

    .line 8283
    new-instance v0, Landroid/content/pm/ResolveInfo;

    invoke-direct {v0}, Landroid/content/pm/ResolveInfo;-><init>()V

    .line 8284
    .local v0, "forwardingResolveInfo":Landroid/content/pm/ResolveInfo;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 8287
    .local v1, "ident":J
    :try_start_9
    sget-object v3, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v3, p3}, Lcom/android/server/pm/UserManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;

    move-result-object v3

    invoke-virtual {v3}, Landroid/content/pm/UserInfo;->isManagedProfile()Z

    move-result v3
    :try_end_13
    .catchall {:try_start_9 .. :try_end_13} :catchall_44

    .line 8289
    .local v3, "targetIsProfile":Z
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8290
    nop

    .line 8292
    if-eqz v3, :cond_1c

    .line 8293
    sget-object v4, Lcom/android/internal/app/IntentForwarderActivity;->FORWARD_INTENT_TO_MANAGED_PROFILE:Ljava/lang/String;

    .local v4, "className":Ljava/lang/String;
    goto :goto_1e

    .line 8295
    .end local v4  # "className":Ljava/lang/String;
    :cond_1c
    sget-object v4, Lcom/android/internal/app/IntentForwarderActivity;->FORWARD_INTENT_TO_PARENT:Ljava/lang/String;

    .line 8297
    .restart local v4  # "className":Ljava/lang/String;
    :goto_1e
    new-instance v5, Landroid/content/ComponentName;

    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mAndroidApplication:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-direct {v5, v6, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 8299
    .local v5, "forwardingActivityComponentName":Landroid/content/ComponentName;
    const/4 v6, 0x0

    invoke-virtual {p0, v5, v6, p2}, Lcom/android/server/pm/PackageManagerService;->getActivityInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ActivityInfo;

    move-result-object v7

    .line 8301
    .local v7, "forwardingActivityInfo":Landroid/content/pm/ActivityInfo;
    const/4 v8, 0x1

    if-nez v3, :cond_35

    if-eqz v7, :cond_35

    .line 8306
    iput p3, v7, Landroid/content/pm/ActivityInfo;->showUserIcon:I

    .line 8307
    iput-boolean v8, v0, Landroid/content/pm/ResolveInfo;->noResourceId:Z

    .line 8309
    :cond_35
    iput-object v7, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 8310
    iput v6, v0, Landroid/content/pm/ResolveInfo;->priority:I

    .line 8311
    iput v6, v0, Landroid/content/pm/ResolveInfo;->preferredOrder:I

    .line 8312
    iput v6, v0, Landroid/content/pm/ResolveInfo;->match:I

    .line 8313
    iput-boolean v8, v0, Landroid/content/pm/ResolveInfo;->isDefault:Z

    .line 8314
    iput-object p1, v0, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    .line 8315
    iput p3, v0, Landroid/content/pm/ResolveInfo;->targetUserId:I

    .line 8316
    return-object v0

    .line 8289
    .end local v3  # "targetIsProfile":Z
    .end local v4  # "className":Ljava/lang/String;
    .end local v5  # "forwardingActivityComponentName":Landroid/content/ComponentName;
    .end local v7  # "forwardingActivityInfo":Landroid/content/pm/ActivityInfo;
    :catchall_44
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v3
.end method

.method private createInstallArgs(Lcom/android/server/pm/PackageManagerService$InstallParams;)Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .registers 3
    .param p1, "params"  # Lcom/android/server/pm/PackageManagerService$InstallParams;

    .line 16245
    iget-object v0, p1, Lcom/android/server/pm/PackageManagerService$InstallParams;->move:Lcom/android/server/pm/PackageManagerService$MoveInfo;

    if-eqz v0, :cond_a

    .line 16246
    new-instance v0, Lcom/android/server/pm/PackageManagerService$MoveInstallArgs;

    invoke-direct {v0, p0, p1}, Lcom/android/server/pm/PackageManagerService$MoveInstallArgs;-><init>(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$InstallParams;)V

    return-object v0

    .line 16248
    :cond_a
    new-instance v0, Lcom/android/server/pm/PackageManagerService$FileInstallArgs;

    invoke-direct {v0, p0, p1}, Lcom/android/server/pm/PackageManagerService$FileInstallArgs;-><init>(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$InstallParams;)V

    return-object v0
.end method

.method private createInstallArgsForExisting(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .registers 5
    .param p1, "codePath"  # Ljava/lang/String;
    .param p2, "resourcePath"  # Ljava/lang/String;
    .param p3, "instructionSets"  # [Ljava/lang/String;

    .line 16258
    new-instance v0, Lcom/android/server/pm/PackageManagerService$FileInstallArgs;

    invoke-direct {v0, p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService$FileInstallArgs;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)V

    return-object v0
.end method

.method private createPackageInstalledInfo(I)Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .registers 4
    .param p1, "currentStatus"  # I

    .line 15237
    new-instance v0, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    invoke-direct {v0}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;-><init>()V

    .line 15238
    .local v0, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    invoke-virtual {v0, p1}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setReturnCode(I)V

    .line 15239
    const/4 v1, -0x1

    iput v1, v0, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->uid:I

    .line 15240
    const/4 v1, 0x0

    iput-object v1, v0, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 15241
    iput-object v1, v0, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    .line 15242
    return-object v0
.end method

.method private decompressPackage(Ljava/lang/String;Ljava/lang/String;)Ljava/io/File;
    .registers 20
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "codePath"  # Ljava/lang/String;

    .line 3741
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    const-string v3, "Failed to decompress; pkg: "

    invoke-static/range {p2 .. p2}, Lcom/android/server/pm/PackageManagerServiceUtils;->getCompressedFiles(Ljava/lang/String;)[Ljava/io/File;

    move-result-object v4

    .line 3742
    .local v4, "compressedFiles":[Ljava/io/File;
    const/4 v5, 0x0

    if-eqz v4, :cond_dc

    array-length v0, v4

    if-nez v0, :cond_12

    goto/16 :goto_dc

    .line 3748
    :cond_12
    nop

    .line 3749
    invoke-static {v5}, Landroid/os/Environment;->getDataAppDirectory(Ljava/lang/String;)Ljava/io/File;

    move-result-object v0

    invoke-direct {v1, v0, v2}, Lcom/android/server/pm/PackageManagerService;->getNextCodePath(Ljava/io/File;Ljava/lang/String;)Ljava/io/File;

    move-result-object v6

    .line 3750
    .local v6, "dstCodePath":Ljava/io/File;
    const/4 v7, 0x1

    .line 3752
    .local v7, "ret":I
    const/4 v8, 0x6

    const/4 v9, 0x1

    :try_start_1e
    invoke-virtual {v6}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v0

    const/16 v10, 0x1ed

    invoke-static {v0, v10}, Landroid/system/Os;->mkdir(Ljava/lang/String;I)V

    .line 3753
    invoke-virtual {v6}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v0

    invoke-static {v0, v10}, Landroid/system/Os;->chmod(Ljava/lang/String;I)V

    .line 3754
    array-length v0, v4
    :try_end_2f
    .catch Landroid/system/ErrnoException; {:try_start_1e .. :try_end_2f} :catch_78

    const/4 v10, 0x0

    move v11, v7

    move v7, v10

    .end local v7  # "ret":I
    .local v11, "ret":I
    :goto_32
    if-ge v7, v0, :cond_77

    :try_start_34
    aget-object v12, v4, v7

    .line 3755
    .local v12, "srcFile":Ljava/io/File;
    invoke-virtual {v12}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v13

    .line 3756
    .local v13, "srcFileName":Ljava/lang/String;
    nop

    .line 3757
    invoke-virtual {v13}, Ljava/lang/String;->length()I

    move-result v14

    const-string v15, ".gz"

    invoke-virtual {v15}, Ljava/lang/String;->length()I

    move-result v15

    sub-int/2addr v14, v15

    .line 3756
    invoke-virtual {v13, v10, v14}, Ljava/lang/String;->substring(II)Ljava/lang/String;

    move-result-object v14

    .line 3758
    .local v14, "dstFileName":Ljava/lang/String;
    new-instance v15, Ljava/io/File;

    invoke-direct {v15, v6, v14}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 3759
    .local v15, "dstFile":Ljava/io/File;
    invoke-static {v12, v15}, Lcom/android/server/pm/PackageManagerServiceUtils;->decompressFile(Ljava/io/File;Ljava/io/File;)I

    move-result v16

    move/from16 v11, v16

    .line 3760
    if-eq v11, v9, :cond_72

    .line 3761
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, ", file: "

    invoke-virtual {v0, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v8, v0}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V
    :try_end_71
    .catch Landroid/system/ErrnoException; {:try_start_34 .. :try_end_71} :catch_75

    .line 3764
    goto :goto_77

    .line 3754
    .end local v12  # "srcFile":Ljava/io/File;
    .end local v13  # "srcFileName":Ljava/lang/String;
    .end local v14  # "dstFileName":Ljava/lang/String;
    .end local v15  # "dstFile":Ljava/io/File;
    :cond_72
    add-int/lit8 v7, v7, 0x1

    goto :goto_32

    .line 3767
    :catch_75
    move-exception v0

    goto :goto_7a

    .line 3771
    :cond_77
    :goto_77
    goto :goto_96

    .line 3767
    .end local v11  # "ret":I
    .restart local v7  # "ret":I
    :catch_78
    move-exception v0

    move v11, v7

    .line 3768
    .end local v7  # "ret":I
    .local v0, "e":Landroid/system/ErrnoException;
    .restart local v11  # "ret":I
    :goto_7a
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, ", err: "

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v3, v0, Landroid/system/ErrnoException;->errno:I

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v8, v3}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 3772
    .end local v0  # "e":Landroid/system/ErrnoException;
    :goto_96
    if-ne v11, v9, :cond_ce

    .line 3773
    new-instance v0, Ljava/io/File;

    const-string/jumbo v3, "lib"

    invoke-direct {v0, v6, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    move-object v3, v0

    .line 3774
    .local v3, "libraryRoot":Ljava/io/File;
    const/4 v7, 0x0

    .line 3776
    .local v7, "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    :try_start_a2
    invoke-static {v6}, Lcom/android/internal/content/NativeLibraryHelper$Handle;->create(Ljava/io/File;)Lcom/android/internal/content/NativeLibraryHelper$Handle;

    move-result-object v0

    move-object v7, v0

    .line 3777
    invoke-static {v7, v3, v5}, Lcom/android/internal/content/NativeLibraryHelper;->copyNativeBinariesWithOverride(Lcom/android/internal/content/NativeLibraryHelper$Handle;Ljava/io/File;Ljava/lang/String;)I

    move-result v0
    :try_end_ab
    .catch Ljava/io/IOException; {:try_start_a2 .. :try_end_ab} :catch_b2
    .catchall {:try_start_a2 .. :try_end_ab} :catchall_b0

    move v11, v0

    .line 3784
    :goto_ac
    invoke-static {v7}, Llibcore/io/IoUtils;->closeQuietly(Ljava/lang/AutoCloseable;)V

    .line 3785
    goto :goto_ce

    .line 3784
    :catchall_b0
    move-exception v0

    goto :goto_ca

    .line 3779
    :catch_b2
    move-exception v0

    .line 3780
    .local v0, "e":Ljava/io/IOException;
    :try_start_b3
    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Failed to extract native libraries; pkg: "

    invoke-virtual {v10, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v8, v10}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V
    :try_end_c7
    .catchall {:try_start_b3 .. :try_end_c7} :catchall_b0

    .line 3782
    const/16 v11, -0x6e

    .end local v0  # "e":Ljava/io/IOException;
    goto :goto_ac

    .line 3784
    :goto_ca
    invoke-static {v7}, Llibcore/io/IoUtils;->closeQuietly(Ljava/lang/AutoCloseable;)V

    throw v0

    .line 3787
    .end local v3  # "libraryRoot":Ljava/io/File;
    .end local v7  # "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    :cond_ce
    :goto_ce
    if-eq v11, v9, :cond_db

    .line 3788
    invoke-virtual {v6}, Ljava/io/File;->exists()Z

    move-result v0

    if-nez v0, :cond_d7

    .line 3789
    return-object v5

    .line 3791
    :cond_d7
    invoke-virtual {v1, v6}, Lcom/android/server/pm/PackageManagerService;->removeCodePathLI(Ljava/io/File;)V

    .line 3792
    return-object v5

    .line 3795
    :cond_db
    return-object v6

    .line 3743
    .end local v6  # "dstCodePath":Ljava/io/File;
    .end local v11  # "ret":I
    :cond_dc
    :goto_dc
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_COMPRESSION:Z

    if-eqz v0, :cond_f9

    .line 3744
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "No files to decompress: "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v3, p2

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v6, "PackageManager"

    invoke-static {v6, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_fb

    .line 3743
    :cond_f9
    move-object/from16 v3, p2

    .line 3746
    :goto_fb
    return-object v5
.end method

.method private deleteInstalledPackageLIF(Lcom/android/server/pm/PackageSetting;ZI[ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ZLandroid/content/pm/PackageParser$Package;)V
    .registers 21
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "deleteCodeAndResources"  # Z
    .param p3, "flags"  # I
    .param p4, "allUserHandles"  # [I
    .param p5, "outInfo"  # Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .param p6, "writeSettings"  # Z
    .param p7, "replacingPackage"  # Landroid/content/pm/PackageParser$Package;

    .line 20150
    move-object v7, p0

    move-object v8, p1

    move-object/from16 v9, p5

    move-object/from16 v10, p7

    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20151
    if-eqz v9, :cond_13

    .line 20152
    :try_start_b
    iget v0, v8, Lcom/android/server/pm/PackageSetting;->appId:I

    iput v0, v9, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->uid:I

    goto :goto_13

    .line 20174
    :catchall_10
    move-exception v0

    goto/16 :goto_e2

    .line 20155
    :cond_13
    :goto_13
    const/4 v0, 0x0

    if-eqz v9, :cond_4c

    iget-object v2, v9, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    if-eqz v2, :cond_4c

    .line 20156
    iget-object v2, v8, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v2, :cond_25

    .line 20157
    iget-object v2, v8, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v2

    goto :goto_26

    :cond_25
    move v2, v0

    .line 20158
    .local v2, "childCount":I
    :goto_26
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_27
    if-ge v3, v2, :cond_4c

    .line 20159
    iget-object v4, v8, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v4, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/String;

    .line 20160
    .local v4, "childPackageName":Ljava/lang/String;
    iget-object v5, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 20161
    .local v5, "childPs":Lcom/android/server/pm/PackageSetting;
    iget-object v6, v9, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    invoke-virtual {v6, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    .line 20163
    .local v6, "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    if-eqz v6, :cond_49

    .line 20164
    iget v11, v5, Lcom/android/server/pm/PackageSetting;->appId:I

    iput v11, v6, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->uid:I

    .line 20158
    .end local v4  # "childPackageName":Ljava/lang/String;
    .end local v5  # "childPs":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :cond_49
    add-int/lit8 v3, v3, 0x1

    goto :goto_27

    .line 20169
    .end local v2  # "childCount":I
    .end local v3  # "i":I
    :cond_4c
    iget-boolean v2, v8, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    if-eqz v2, :cond_64

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->inCts()Z

    move-result v2

    if-nez v2, :cond_64

    .line 20170
    iget-object v2, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v8, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v2, v3, v0}, Lcom/android/server/pm/Settings;->setMzAppInstalled(Ljava/lang/String;Z)V

    .line 20171
    iget-object v2, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v8, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v2, v3}, Lcom/android/server/pm/Settings;->removeDisabledSystemPackageLPw(Ljava/lang/String;)V

    .line 20174
    :cond_64
    monitor-exit v1
    :try_end_65
    .catchall {:try_start_b .. :try_end_65} :catchall_10

    .line 20177
    move-object v1, p0

    move-object v2, p1

    move-object/from16 v3, p4

    move-object/from16 v4, p5

    move/from16 v5, p3

    move/from16 v6, p6

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->removePackageDataLIF(Lcom/android/server/pm/PackageSetting;[ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;IZ)V

    .line 20180
    iget-object v1, v8, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v1, :cond_7c

    iget-object v0, v8, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v0

    :cond_7c
    move v11, v0

    .line 20181
    .local v11, "childCount":I
    const/4 v0, 0x0

    move v12, v0

    .local v12, "i":I
    :goto_7f
    if-ge v12, v11, :cond_cb

    .line 20183
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20184
    :try_start_84
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v8, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v2, v12}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/String;

    invoke-virtual {v0, v2}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v0

    .line 20185
    .local v0, "childPs":Lcom/android/server/pm/PackageSetting;
    monitor-exit v1
    :try_end_93
    .catchall {:try_start_84 .. :try_end_93} :catchall_c8

    .line 20186
    if-eqz v0, :cond_c5

    .line 20187
    if-eqz v9, :cond_a6

    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    if-eqz v1, :cond_a6

    .line 20189
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    iget-object v2, v0, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    goto :goto_a7

    :cond_a6
    const/4 v1, 0x0

    :goto_a7
    move-object v4, v1

    .line 20191
    .local v4, "childOutInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    and-int/lit8 v1, p3, 0x1

    if-eqz v1, :cond_ba

    if-eqz v10, :cond_ba

    iget-object v1, v0, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    .line 20192
    invoke-virtual {v10, v1}, Landroid/content/pm/PackageParser$Package;->hasChildPackage(Ljava/lang/String;)Z

    move-result v1

    if-nez v1, :cond_ba

    .line 20193
    and-int/lit8 v1, p3, -0x2

    move v5, v1

    goto :goto_bc

    :cond_ba
    move/from16 v5, p3

    .line 20194
    .local v5, "deleteFlags":I
    :goto_bc
    move-object v1, p0

    move-object v2, v0

    move-object/from16 v3, p4

    move/from16 v6, p6

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->removePackageDataLIF(Lcom/android/server/pm/PackageSetting;[ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;IZ)V

    .line 20181
    .end local v0  # "childPs":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "childOutInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v5  # "deleteFlags":I
    :cond_c5
    add-int/lit8 v12, v12, 0x1

    goto :goto_7f

    .line 20185
    :catchall_c8
    move-exception v0

    :try_start_c9
    monitor-exit v1
    :try_end_ca
    .catchall {:try_start_c9 .. :try_end_ca} :catchall_c8

    throw v0

    .line 20200
    .end local v12  # "i":I
    :cond_cb
    iget-object v0, v8, Lcom/android/server/pm/PackageSetting;->parentPackageName:Ljava/lang/String;

    if-nez v0, :cond_e1

    .line 20201
    if-eqz p2, :cond_e1

    if-eqz v9, :cond_e1

    .line 20202
    iget-object v0, v8, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    iget-object v1, v8, Lcom/android/server/pm/PackageSetting;->resourcePathString:Ljava/lang/String;

    .line 20203
    invoke-static {p1}, Lcom/android/server/pm/InstructionSets;->getAppDexInstructionSets(Lcom/android/server/pm/PackageSetting;)[Ljava/lang/String;

    move-result-object v2

    .line 20202
    invoke-direct {p0, v0, v1, v2}, Lcom/android/server/pm/PackageManagerService;->createInstallArgsForExisting(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$InstallArgs;

    move-result-object v0

    iput-object v0, v9, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    .line 20207
    :cond_e1
    return-void

    .line 20174
    .end local v11  # "childCount":I
    :goto_e2
    :try_start_e2
    monitor-exit v1
    :try_end_e3
    .catchall {:try_start_e2 .. :try_end_e3} :catchall_10

    throw v0
.end method

.method private deletePackageIfUnusedLPr(Ljava/lang/String;)V
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 24920
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 24921
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v0, :cond_d

    .line 24922
    return-void

    .line 24924
    :cond_d
    sget-object v1, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v1

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageSetting;->isAnyInstalled([I)Z

    move-result v1

    if-nez v1, :cond_23

    .line 24928
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v2, Lcom/android/server/pm/-$$Lambda$PackageManagerService$5ZIUWyGNHzwepbT1-3GAaLSTvy4;

    invoke-direct {v2, p0, p1}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$5ZIUWyGNHzwepbT1-3GAaLSTvy4;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;)V

    invoke-virtual {v1, v2}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 24931
    :cond_23
    return-void
.end method

.method private deletePackageLIF(Ljava/lang/String;Landroid/os/UserHandle;Z[IILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ZLandroid/content/pm/PackageParser$Package;)Z
    .registers 22
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "user"  # Landroid/os/UserHandle;
    .param p3, "deleteCodeAndResources"  # Z
    .param p4, "allUserHandles"  # [I
    .param p5, "flags"  # I
    .param p6, "outInfo"  # Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .param p7, "writeSettings"  # Z
    .param p8, "replacingPackage"  # Landroid/content/pm/PackageParser$Package;

    .line 20336
    move-object v8, p0

    move-object v9, p1

    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20337
    :try_start_5
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 20338
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v0}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Lcom/android/server/pm/PackageSetting;)Lcom/android/server/pm/PackageSetting;

    move-result-object v4

    .line 20339
    .local v4, "disabledPs":Lcom/android/server/pm/PackageSetting;
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v0}, Lcom/android/server/pm/Settings;->getChildSettingsLPr(Lcom/android/server/pm/PackageSetting;)[Lcom/android/server/pm/PackageSetting;

    move-result-object v5

    .line 20340
    .local v5, "children":[Lcom/android/server/pm/PackageSetting;
    move-object/from16 v2, p6

    move-object v3, v0

    move/from16 v6, p5

    move-object v7, p2

    invoke-static/range {v2 .. v7}, Lcom/android/server/pm/PackageManagerService;->mayDeletePackageLocked(Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;[Lcom/android/server/pm/PackageSetting;ILandroid/os/UserHandle;)Lcom/android/server/pm/PackageManagerService$DeletePackageAction;

    move-result-object v2

    move-object v10, v2

    .line 20341
    .end local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "children":[Lcom/android/server/pm/PackageSetting;
    .local v10, "action":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    monitor-exit v1
    :try_end_27
    .catchall {:try_start_5 .. :try_end_27} :catchall_7b

    .line 20342
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v0, :cond_4b

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "deletePackageLI: "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " user "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object v11, p2

    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_4c

    :cond_4b
    move-object v11, p2

    .line 20343
    :goto_4c
    const/4 v12, 0x0

    if-nez v10, :cond_5b

    .line 20344
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v0, :cond_5a

    const-string v0, "PackageManager"

    const-string v1, "deletePackageLI: action was null"

    invoke-static {v0, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20345
    :cond_5a
    return v12

    .line 20350
    :cond_5b
    move-object v1, p0

    move-object v2, v10

    move-object v3, p1

    move/from16 v4, p3

    move-object/from16 v5, p4

    move/from16 v6, p7

    move-object/from16 v7, p8

    :try_start_66
    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->executeDeletePackageLIF(Lcom/android/server/pm/PackageManagerService$DeletePackageAction;Ljava/lang/String;Z[IZLandroid/content/pm/PackageParser$Package;)V
    :try_end_69
    .catch Lcom/android/server/pm/PackageManagerService$SystemDeleteException; {:try_start_66 .. :try_end_69} :catch_6c

    .line 20355
    nop

    .line 20356
    const/4 v0, 0x1

    return v0

    .line 20352
    :catch_6c
    move-exception v0

    move-object v1, v0

    move-object v0, v1

    .line 20353
    .local v0, "e":Lcom/android/server/pm/PackageManagerService$SystemDeleteException;
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v1, :cond_7a

    const-string v1, "PackageManager"

    const-string v2, "deletePackageLI: system deletion failure"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 20354
    :cond_7a
    return v12

    .line 20341
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerService$SystemDeleteException;
    .end local v10  # "action":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    :catchall_7b
    move-exception v0

    move-object v11, p2

    :goto_7d
    :try_start_7d
    monitor-exit v1
    :try_end_7e
    .catchall {:try_start_7d .. :try_end_7e} :catchall_7f

    throw v0

    :catchall_7f
    move-exception v0

    goto :goto_7d
.end method

.method private deleteSystemPackageLIF(Lcom/android/server/pm/PackageManagerService$DeletePackageAction;Lcom/android/server/pm/PackageSetting;[IILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;Z)V
    .registers 24
    .param p1, "action"  # Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    .param p2, "deletedPs"  # Lcom/android/server/pm/PackageSetting;
    .param p3, "allUserHandles"  # [I
    .param p4, "flags"  # I
    .param p5, "outInfo"  # Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .param p6, "writeSettings"  # Z
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerService$SystemDeleteException;
        }
    .end annotation

    .line 19961
    move-object/from16 v9, p0

    move-object/from16 v10, p2

    move-object/from16 v11, p3

    move-object/from16 v12, p5

    const/4 v0, 0x1

    if-eqz v11, :cond_13

    if-eqz v12, :cond_13

    iget-object v1, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->origUsers:[I

    if-eqz v1, :cond_13

    move v1, v0

    goto :goto_14

    :cond_13
    const/4 v1, 0x0

    :goto_14
    move v14, v1

    .line 19963
    .local v14, "applyUserRestrictions":Z
    iget-object v15, v10, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 19968
    .local v15, "deletedPkg":Landroid/content/pm/PackageParser$Package;
    move-object/from16 v8, p1

    iget-object v7, v8, Lcom/android/server/pm/PackageManagerService$DeletePackageAction;->disabledPs:Lcom/android/server/pm/PackageSetting;

    .line 19969
    .local v7, "disabledPs":Lcom/android/server/pm/PackageSetting;
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v1, :cond_3f

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "deleteSystemPackageLI: newPs="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v15, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " disabledPs="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 19971
    :cond_3f
    const-string v1, "PackageManager"

    const-string v2, "Deleting system pkg from data partition"

    invoke-static {v1, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 19973
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v1, :cond_80

    .line 19974
    if-eqz v14, :cond_80

    .line 19975
    const-string v1, "PackageManager"

    const-string v2, "Remembering install states:"

    invoke-static {v1, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 19976
    array-length v1, v11

    const/4 v2, 0x0

    :goto_55
    if-ge v2, v1, :cond_80

    aget v3, v11, v2

    .line 19977
    .local v3, "userId":I
    iget-object v4, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->origUsers:[I

    invoke-static {v4, v3}, Lcom/android/internal/util/ArrayUtils;->contains([II)Z

    move-result v4

    .line 19978
    .local v4, "finstalled":Z
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "   u="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, " inst="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v6, "PackageManager"

    invoke-static {v6, v5}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 19976
    .end local v3  # "userId":I
    .end local v4  # "finstalled":Z
    add-int/lit8 v2, v2, 0x1

    goto :goto_55

    .line 19983
    :cond_80
    if-eqz v12, :cond_ba

    .line 19985
    iput-boolean v0, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->isRemovedPackageSystemUpdate:Z

    .line 19986
    iget-object v1, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    if-eqz v1, :cond_ba

    .line 19987
    iget-object v1, v10, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v1, :cond_93

    .line 19988
    iget-object v1, v10, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v1

    goto :goto_94

    :cond_93
    const/4 v1, 0x0

    .line 19989
    .local v1, "childCount":I
    :goto_94
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_95
    if-ge v2, v1, :cond_ba

    .line 19990
    iget-object v3, v10, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v3, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    .line 19991
    .local v3, "childPackageName":Ljava/lang/String;
    iget-object v4, v7, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v4, :cond_b7

    iget-object v4, v7, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    .line 19992
    invoke-interface {v4, v3}, Ljava/util/List;->contains(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_b7

    .line 19993
    iget-object v4, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    .line 19995
    .local v4, "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    if-eqz v4, :cond_b7

    .line 19996
    iput-boolean v0, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->isRemovedPackageSystemUpdate:Z

    .line 19989
    .end local v3  # "childPackageName":Ljava/lang/String;
    .end local v4  # "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :cond_b7
    add-int/lit8 v2, v2, 0x1

    goto :goto_95

    .line 20003
    .end local v1  # "childCount":I
    .end local v2  # "i":I
    :cond_ba
    iget-wide v1, v7, Lcom/android/server/pm/PackageSetting;->versionCode:J

    iget-wide v3, v10, Lcom/android/server/pm/PackageSetting;->versionCode:J

    cmp-long v1, v1, v3

    if-gez v1, :cond_c7

    .line 20005
    and-int/lit8 v0, p4, -0x2

    move/from16 v16, v0

    .end local p4  # "flags":I
    .local v0, "flags":I
    goto :goto_cb

    .line 20008
    .end local v0  # "flags":I
    .restart local p4  # "flags":I
    :cond_c7
    or-int/lit8 v0, p4, 0x1

    move/from16 v16, v0

    .line 20011
    .end local p4  # "flags":I
    .local v16, "flags":I
    :goto_cb
    const/4 v3, 0x1

    iget-object v0, v7, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    move-object/from16 v1, p0

    move-object/from16 v2, p2

    move/from16 v4, v16

    move-object/from16 v5, p3

    move-object/from16 v6, p5

    move-object v13, v7

    .end local v7  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .local v13, "disabledPs":Lcom/android/server/pm/PackageSetting;
    move/from16 v7, p6

    move-object v8, v0

    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->deleteInstalledPackageLIF(Lcom/android/server/pm/PackageSetting;ZI[ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ZLandroid/content/pm/PackageParser$Package;)V

    .line 20015
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20021
    :try_start_e2
    iget-object v0, v13, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-direct {v9, v0}, Lcom/android/server/pm/PackageManagerService;->enableSystemPackageLPw(Landroid/content/pm/PackageParser$Package;)V

    .line 20023
    invoke-direct {v9, v10}, Lcom/android/server/pm/PackageManagerService;->removeNativeBinariesLI(Lcom/android/server/pm/PackageSetting;)V

    .line 20024
    monitor-exit v1
    :try_end_eb
    .catchall {:try_start_e2 .. :try_end_eb} :catchall_180

    .line 20027
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v0, :cond_105

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Re-installing system package: "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20029
    :cond_105
    const/4 v7, 0x2

    const/4 v8, 0x0

    :try_start_107
    iget-object v2, v13, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    .line 20030
    if-nez v12, :cond_10d

    move-object v4, v8

    goto :goto_110

    :cond_10d
    iget-object v0, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->origUsers:[I

    move-object v4, v0

    :goto_110
    invoke-virtual/range {p2 .. p2}, Lcom/android/server/pm/PackageSetting;->getPermissionsState()Lcom/android/server/pm/permission/PermissionsState;

    move-result-object v5

    .line 20029
    move-object/from16 v1, p0

    move-object/from16 v3, p3

    move/from16 v6, p6

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->installPackageFromSystemLIF(Ljava/lang/String;[I[ILcom/android/server/pm/permission/PermissionsState;Z)Landroid/content/pm/PackageParser$Package;
    :try_end_11d
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_107 .. :try_end_11d} :catch_13a
    .catchall {:try_start_107 .. :try_end_11d} :catchall_138

    .line 20038
    iget-object v0, v13, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-boolean v0, v0, Landroid/content/pm/PackageParser$Package;->isStub:Z

    if-eqz v0, :cond_137

    .line 20042
    iget-object v0, v9, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v1, v15, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 20043
    .local v0, "stubPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_137

    .line 20044
    const-string v1, "android"

    const/4 v2, 0x0

    invoke-virtual {v0, v7, v2, v1}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    .line 20049
    .end local v0  # "stubPs":Lcom/android/server/pm/PackageSetting;
    :cond_137
    return-void

    .line 20038
    :catchall_138
    move-exception v0

    goto :goto_165

    .line 20032
    :catch_13a
    move-exception v0

    .line 20033
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    :try_start_13b
    const-string v1, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Failed to restore system package:"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v15, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, ": "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 20034
    invoke-virtual {v0}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 20033
    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 20036
    new-instance v1, Lcom/android/server/pm/PackageManagerService$SystemDeleteException;

    invoke-direct {v1, v0, v8}, Lcom/android/server/pm/PackageManagerService$SystemDeleteException;-><init>(Lcom/android/server/pm/PackageManagerException;Lcom/android/server/pm/PackageManagerService$1;)V

    .end local v13  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v14  # "applyUserRestrictions":Z
    .end local v15  # "deletedPkg":Landroid/content/pm/PackageParser$Package;
    .end local v16  # "flags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "action":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    .end local p2  # "deletedPs":Lcom/android/server/pm/PackageSetting;
    .end local p3  # "allUserHandles":[I
    .end local p5  # "outInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local p6  # "writeSettings":Z
    throw v1
    :try_end_165
    .catchall {:try_start_13b .. :try_end_165} :catchall_138

    .line 20038
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v13  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v14  # "applyUserRestrictions":Z
    .restart local v15  # "deletedPkg":Landroid/content/pm/PackageParser$Package;
    .restart local v16  # "flags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "action":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    .restart local p2  # "deletedPs":Lcom/android/server/pm/PackageSetting;
    .restart local p3  # "allUserHandles":[I
    .restart local p5  # "outInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local p6  # "writeSettings":Z
    :goto_165
    iget-object v1, v13, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-boolean v1, v1, Landroid/content/pm/PackageParser$Package;->isStub:Z

    if-eqz v1, :cond_17f

    .line 20042
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, v15, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 20043
    .local v1, "stubPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_17f

    .line 20044
    const-string v2, "android"

    const/4 v3, 0x0

    invoke-virtual {v1, v7, v3, v2}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    .line 20047
    .end local v1  # "stubPs":Lcom/android/server/pm/PackageSetting;
    :cond_17f
    throw v0

    .line 20024
    :catchall_180
    move-exception v0

    :try_start_181
    monitor-exit v1
    :try_end_182
    .catchall {:try_start_181 .. :try_end_182} :catchall_180

    throw v0
.end method

.method private deleteTempPackageFiles()V
    .registers 2

    .line 19064
    sget-object v0, Lcom/android/server/pm/-$$Lambda$PackageManagerService$InxwP9v95IsHM1A-IPecZaxo-1Q;->INSTANCE:Lcom/android/server/pm/-$$Lambda$PackageManagerService$InxwP9v95IsHM1A-IPecZaxo-1Q;

    .line 19066
    .local v0, "filter":Ljava/io/FilenameFilter;
    return-void
.end method

.method static deriveCodePathName(Ljava/lang/String;)Ljava/lang/String;
    .registers 6
    .param p0, "codePath"  # Ljava/lang/String;

    .line 16717
    const/4 v0, 0x0

    if-nez p0, :cond_4

    .line 16718
    return-object v0

    .line 16720
    :cond_4
    new-instance v1, Ljava/io/File;

    invoke-direct {v1, p0}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 16721
    .local v1, "codeFile":Ljava/io/File;
    invoke-virtual {v1}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v2

    .line 16722
    .local v2, "name":Ljava/lang/String;
    invoke-virtual {v1}, Ljava/io/File;->isDirectory()Z

    move-result v3

    if-eqz v3, :cond_14

    .line 16723
    return-object v2

    .line 16724
    :cond_14
    const-string v3, ".apk"

    invoke-virtual {v2, v3}, Ljava/lang/String;->endsWith(Ljava/lang/String;)Z

    move-result v3

    if-nez v3, :cond_41

    const-string v3, ".tmp"

    invoke-virtual {v2, v3}, Ljava/lang/String;->endsWith(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_25

    goto :goto_41

    .line 16728
    :cond_25
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Odd, "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " doesn\'t look like an APK"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 16729
    return-object v0

    .line 16725
    :cond_41
    :goto_41
    const/16 v0, 0x2e

    invoke-virtual {v2, v0}, Ljava/lang/String;->lastIndexOf(I)I

    move-result v0

    .line 16726
    .local v0, "lastDot":I
    const/4 v3, 0x0

    invoke-virtual {v2, v3, v0}, Ljava/lang/String;->substring(II)Ljava/lang/String;

    move-result-object v3

    return-object v3
.end method

.method private static derivePackageAbi(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;Z)V
    .registers 20
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "cpuAbiOverride"  # Ljava/lang/String;
    .param p2, "extractLibs"  # Z
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 12844
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    const-string v3, "PackageManager"

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sAppLib32InstallDir:Ljava/io/File;

    invoke-static {v1, v0}, Lcom/android/server/pm/PackageManagerService;->setNativeLibraryPaths(Landroid/content/pm/PackageParser$Package;Ljava/io/File;)V

    .line 12847
    invoke-static/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-eqz v0, :cond_1a

    invoke-virtual/range {p0 .. p0}, Landroid/content/pm/PackageParser$Package;->isUpdatedSystemApp()Z

    move-result v0

    if-nez v0, :cond_1a

    .line 12848
    const/4 v0, 0x0

    move v4, v0

    .end local p2  # "extractLibs":Z
    .local v0, "extractLibs":Z
    goto :goto_1c

    .line 12851
    .end local v0  # "extractLibs":Z
    .restart local p2  # "extractLibs":Z
    :cond_1a
    move/from16 v4, p2

    .end local p2  # "extractLibs":Z
    .local v4, "extractLibs":Z
    :goto_1c
    iget-object v0, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v0, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    .line 12852
    .local v5, "nativeLibraryRootStr":Ljava/lang/String;
    iget-object v0, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-boolean v6, v0, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootRequiresIsa:Z

    .line 12854
    .local v6, "useIsaSpecificSubdirs":Z
    const/4 v7, 0x0

    .line 12856
    .local v7, "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    :try_start_25
    invoke-static/range {p0 .. p0}, Lcom/android/internal/content/NativeLibraryHelper$Handle;->create(Landroid/content/pm/PackageParser$Package;)Lcom/android/internal/content/NativeLibraryHelper$Handle;

    move-result-object v0

    move-object v7, v0

    .line 12863
    new-instance v0, Ljava/io/File;

    invoke-direct {v0, v5}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 12866
    .local v0, "nativeLibraryRoot":Ljava/io/File;
    iget-object v8, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v9, 0x0

    iput-object v9, v8, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 12867
    iget-object v8, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v9, v8, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    .line 12868
    iget-object v8, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-static {v8}, Lcom/android/server/pm/PackageManagerService;->isMultiArch(Landroid/content/pm/ApplicationInfo;)Z

    move-result v8
    :try_end_3e
    .catch Ljava/io/IOException; {:try_start_25 .. :try_end_3e} :catch_178
    .catchall {:try_start_25 .. :try_end_3e} :catchall_176

    const-string v9, "copyNativeBinaries"

    const-string v10, "findSupportedAbi"

    const/16 v11, -0x6e

    const-wide/32 v12, 0x40000

    if-eqz v8, :cond_fa

    .line 12872
    :try_start_49
    iget-object v8, v1, Landroid/content/pm/PackageParser$Package;->cpuAbiOverride:Ljava/lang/String;

    if-eqz v8, :cond_5c

    const-string v8, "-"

    iget-object v14, v1, Landroid/content/pm/PackageParser$Package;->cpuAbiOverride:Ljava/lang/String;

    .line 12873
    invoke-virtual {v8, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-nez v8, :cond_5c

    .line 12874
    const-string v8, "Ignoring abiOverride for multi arch application."

    invoke-static {v3, v8}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12877
    :cond_5c
    const/16 v8, -0x72

    .line 12878
    .local v8, "abi32":I
    const/16 v14, -0x72

    .line 12879
    .local v14, "abi64":I
    sget-object v15, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    array-length v15, v15

    if-lez v15, :cond_7f

    .line 12880
    if-eqz v4, :cond_72

    .line 12881
    invoke-static {v12, v13, v9}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 12882
    sget-object v15, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    invoke-static {v7, v0, v15, v6}, Lcom/android/internal/content/NativeLibraryHelper;->copyNativeBinariesForSupportedAbi(Lcom/android/internal/content/NativeLibraryHelper$Handle;Ljava/io/File;[Ljava/lang/String;Z)I

    move-result v15

    move v8, v15

    goto :goto_7c

    .line 12886
    :cond_72
    invoke-static {v12, v13, v10}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 12887
    sget-object v15, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    invoke-static {v7, v15}, Lcom/android/internal/content/NativeLibraryHelper;->findSupportedAbi(Lcom/android/internal/content/NativeLibraryHelper$Handle;[Ljava/lang/String;)I

    move-result v15

    move v8, v15

    .line 12889
    :goto_7c
    invoke-static {v12, v13}, Landroid/os/Trace;->traceEnd(J)V
    :try_end_7f
    .catch Ljava/io/IOException; {:try_start_49 .. :try_end_7f} :catch_178
    .catchall {:try_start_49 .. :try_end_7f} :catchall_176

    .line 12893
    :cond_7f
    const-string v15, "Shared library native lib extraction not supported"

    if-ltz v8, :cond_92

    :try_start_83
    invoke-virtual/range {p0 .. p0}, Landroid/content/pm/PackageParser$Package;->isLibrary()Z

    move-result v16

    if-eqz v16, :cond_92

    if-nez v4, :cond_8c

    goto :goto_92

    .line 12894
    :cond_8c
    new-instance v9, Lcom/android/server/pm/PackageManagerException;

    invoke-direct {v9, v11, v15}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v4  # "extractLibs":Z
    .end local v5  # "nativeLibraryRootStr":Ljava/lang/String;
    .end local v6  # "useIsaSpecificSubdirs":Z
    .end local v7  # "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    .end local p0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p1  # "cpuAbiOverride":Ljava/lang/String;
    throw v9

    .line 12898
    .restart local v4  # "extractLibs":Z
    .restart local v5  # "nativeLibraryRootStr":Ljava/lang/String;
    .restart local v6  # "useIsaSpecificSubdirs":Z
    .restart local v7  # "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    .restart local p0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p1  # "cpuAbiOverride":Ljava/lang/String;
    :cond_92
    :goto_92
    const-string v11, "Error unpackaging 32 bit native libs for multiarch app."

    invoke-static {v11, v8}, Lcom/android/server/pm/PackageManagerService;->maybeThrowExceptionForMultiArchCopy(Ljava/lang/String;I)V

    .line 12901
    sget-object v11, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    array-length v11, v11

    if-lez v11, :cond_b6

    .line 12902
    if-eqz v4, :cond_a9

    .line 12903
    invoke-static {v12, v13, v9}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 12904
    sget-object v9, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    invoke-static {v7, v0, v9, v6}, Lcom/android/internal/content/NativeLibraryHelper;->copyNativeBinariesForSupportedAbi(Lcom/android/internal/content/NativeLibraryHelper$Handle;Ljava/io/File;[Ljava/lang/String;Z)I

    move-result v9

    move v14, v9

    .end local v14  # "abi64":I
    .local v9, "abi64":I
    goto :goto_b3

    .line 12908
    .end local v9  # "abi64":I
    .restart local v14  # "abi64":I
    :cond_a9
    invoke-static {v12, v13, v10}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 12909
    sget-object v9, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    invoke-static {v7, v9}, Lcom/android/internal/content/NativeLibraryHelper;->findSupportedAbi(Lcom/android/internal/content/NativeLibraryHelper$Handle;[Ljava/lang/String;)I

    move-result v9

    .end local v14  # "abi64":I
    .restart local v9  # "abi64":I
    move v14, v9

    .line 12911
    .end local v9  # "abi64":I
    .restart local v14  # "abi64":I
    :goto_b3
    invoke-static {v12, v13}, Landroid/os/Trace;->traceEnd(J)V

    .line 12914
    :cond_b6
    const-string v9, "Error unpackaging 64 bit native libs for multiarch app."

    invoke-static {v9, v14}, Lcom/android/server/pm/PackageManagerService;->maybeThrowExceptionForMultiArchCopy(Ljava/lang/String;I)V

    .line 12917
    if-ltz v14, :cond_d6

    .line 12919
    if-eqz v4, :cond_ce

    invoke-virtual/range {p0 .. p0}, Landroid/content/pm/PackageParser$Package;->isLibrary()Z

    move-result v9

    if-nez v9, :cond_c6

    goto :goto_ce

    .line 12920
    :cond_c6
    new-instance v9, Lcom/android/server/pm/PackageManagerException;

    const/16 v10, -0x6e

    invoke-direct {v9, v10, v15}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v4  # "extractLibs":Z
    .end local v5  # "nativeLibraryRootStr":Ljava/lang/String;
    .end local v6  # "useIsaSpecificSubdirs":Z
    .end local v7  # "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    .end local p0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p1  # "cpuAbiOverride":Ljava/lang/String;
    throw v9

    .line 12923
    .restart local v4  # "extractLibs":Z
    .restart local v5  # "nativeLibraryRootStr":Ljava/lang/String;
    .restart local v6  # "useIsaSpecificSubdirs":Z
    .restart local v7  # "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    .restart local p0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p1  # "cpuAbiOverride":Ljava/lang/String;
    :cond_ce
    :goto_ce
    iget-object v9, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    sget-object v10, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    aget-object v10, v10, v14

    iput-object v10, v9, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 12926
    :cond_d6
    if-ltz v8, :cond_f8

    .line 12927
    sget-object v9, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    aget-object v9, v9, v8

    .line 12928
    .local v9, "abi":Ljava/lang/String;
    if-ltz v14, :cond_f4

    .line 12929
    iget-boolean v10, v1, Landroid/content/pm/PackageParser$Package;->use32bitAbi:Z

    if-eqz v10, :cond_ef

    .line 12930
    iget-object v10, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v11, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v11, v11, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    iput-object v11, v10, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    .line 12931
    iget-object v10, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v9, v10, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    goto :goto_f8

    .line 12933
    :cond_ef
    iget-object v10, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v9, v10, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    goto :goto_f8

    .line 12936
    :cond_f4
    iget-object v10, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v9, v10, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 12939
    .end local v8  # "abi32":I
    .end local v9  # "abi":Ljava/lang/String;
    .end local v14  # "abi64":I
    :cond_f8
    :goto_f8
    goto/16 :goto_175

    .line 12940
    :cond_fa
    const/4 v8, 0x0

    if-eqz v2, :cond_103

    .line 12941
    const/4 v11, 0x1

    new-array v11, v11, [Ljava/lang/String;

    aput-object v2, v11, v8

    goto :goto_105

    :cond_103
    sget-object v11, Landroid/os/Build;->SUPPORTED_ABIS:[Ljava/lang/String;

    .line 12947
    .local v11, "abiList":[Ljava/lang/String;
    :goto_105
    const/4 v14, 0x0

    .line 12948
    .local v14, "needsRenderScriptOverride":Z
    sget-object v15, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    array-length v15, v15

    if-lez v15, :cond_117

    if-nez v2, :cond_117

    .line 12949
    invoke-static {v7}, Lcom/android/internal/content/NativeLibraryHelper;->hasRenderscriptBitcode(Lcom/android/internal/content/NativeLibraryHelper$Handle;)Z

    move-result v15

    if-eqz v15, :cond_117

    .line 12950
    sget-object v15, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    move-object v11, v15

    .line 12951
    const/4 v14, 0x1

    .line 12955
    :cond_117
    if-eqz v4, :cond_121

    .line 12956
    invoke-static {v12, v13, v9}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 12957
    invoke-static {v7, v0, v11, v6}, Lcom/android/internal/content/NativeLibraryHelper;->copyNativeBinariesForSupportedAbi(Lcom/android/internal/content/NativeLibraryHelper$Handle;Ljava/io/File;[Ljava/lang/String;Z)I

    move-result v9

    .local v9, "copyRet":I
    goto :goto_128

    .line 12960
    .end local v9  # "copyRet":I
    :cond_121
    invoke-static {v12, v13, v10}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 12961
    invoke-static {v7, v11}, Lcom/android/internal/content/NativeLibraryHelper;->findSupportedAbi(Lcom/android/internal/content/NativeLibraryHelper$Handle;[Ljava/lang/String;)I

    move-result v9

    .line 12963
    .restart local v9  # "copyRet":I
    :goto_128
    invoke-static {v12, v13}, Landroid/os/Trace;->traceEnd(J)V

    .line 12965
    const/16 v10, -0x72

    if-gez v9, :cond_14b

    if-ne v9, v10, :cond_132

    goto :goto_14b

    .line 12966
    :cond_132
    new-instance v8, Lcom/android/server/pm/PackageManagerException;

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Error unpackaging native libs for app, errorCode="

    invoke-virtual {v10, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    const/16 v12, -0x6e

    invoke-direct {v8, v12, v10}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v4  # "extractLibs":Z
    .end local v5  # "nativeLibraryRootStr":Ljava/lang/String;
    .end local v6  # "useIsaSpecificSubdirs":Z
    .end local v7  # "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    .end local p0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p1  # "cpuAbiOverride":Ljava/lang/String;
    throw v8

    .line 12970
    .restart local v4  # "extractLibs":Z
    .restart local v5  # "nativeLibraryRootStr":Ljava/lang/String;
    .restart local v6  # "useIsaSpecificSubdirs":Z
    .restart local v7  # "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    .restart local p0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p1  # "cpuAbiOverride":Ljava/lang/String;
    :cond_14b
    :goto_14b
    if-ltz v9, :cond_164

    .line 12972
    invoke-virtual/range {p0 .. p0}, Landroid/content/pm/PackageParser$Package;->isLibrary()Z

    move-result v8

    if-nez v8, :cond_15a

    .line 12976
    iget-object v8, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    aget-object v10, v11, v9

    iput-object v10, v8, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    goto :goto_175

    .line 12973
    :cond_15a
    new-instance v8, Lcom/android/server/pm/PackageManagerException;

    const-string v10, "Shared library with native libs must be multiarch"

    const/16 v12, -0x6e

    invoke-direct {v8, v12, v10}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v4  # "extractLibs":Z
    .end local v5  # "nativeLibraryRootStr":Ljava/lang/String;
    .end local v6  # "useIsaSpecificSubdirs":Z
    .end local v7  # "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    .end local p0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p1  # "cpuAbiOverride":Ljava/lang/String;
    throw v8

    .line 12977
    .restart local v4  # "extractLibs":Z
    .restart local v5  # "nativeLibraryRootStr":Ljava/lang/String;
    .restart local v6  # "useIsaSpecificSubdirs":Z
    .restart local v7  # "handle":Lcom/android/internal/content/NativeLibraryHelper$Handle;
    .restart local p0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p1  # "cpuAbiOverride":Ljava/lang/String;
    :cond_164
    if-ne v9, v10, :cond_16d

    if-eqz v2, :cond_16d

    .line 12978
    iget-object v8, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v2, v8, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    goto :goto_175

    .line 12979
    :cond_16d
    if-eqz v14, :cond_175

    .line 12980
    iget-object v10, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    aget-object v8, v11, v8

    iput-object v8, v10, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;
    :try_end_175
    .catch Ljava/io/IOException; {:try_start_83 .. :try_end_175} :catch_178
    .catchall {:try_start_83 .. :try_end_175} :catchall_176

    .line 12986
    .end local v0  # "nativeLibraryRoot":Ljava/io/File;
    .end local v9  # "copyRet":I
    .end local v11  # "abiList":[Ljava/lang/String;
    .end local v14  # "needsRenderScriptOverride":Z
    :cond_175
    :goto_175
    goto :goto_192

    :catchall_176
    move-exception v0

    goto :goto_19c

    .line 12983
    :catch_178
    move-exception v0

    .line 12984
    .local v0, "ioe":Ljava/io/IOException;
    :try_start_179
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Unable to get canonical file "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/io/IOException;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v3, v8}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_191
    .catchall {:try_start_179 .. :try_end_191} :catchall_176

    .line 12986
    nop

    .end local v0  # "ioe":Ljava/io/IOException;
    :goto_192
    invoke-static {v7}, Llibcore/io/IoUtils;->closeQuietly(Ljava/lang/AutoCloseable;)V

    .line 12987
    nop

    .line 12991
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sAppLib32InstallDir:Ljava/io/File;

    invoke-static {v1, v0}, Lcom/android/server/pm/PackageManagerService;->setNativeLibraryPaths(Landroid/content/pm/PackageParser$Package;Ljava/io/File;)V

    .line 12992
    return-void

    .line 12986
    :goto_19c
    invoke-static {v7}, Llibcore/io/IoUtils;->closeQuietly(Ljava/lang/AutoCloseable;)V

    throw v0
.end method

.method private destroyAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V
    .registers 7
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I
    .param p3, "flags"  # I

    .line 10813
    if-nez p1, :cond_f

    .line 10814
    new-instance v0, Ljava/lang/Throwable;

    invoke-direct {v0}, Ljava/lang/Throwable;-><init>()V

    const-string v1, "PackageManager"

    const-string v2, "Package was null!"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10815
    return-void

    .line 10817
    :cond_f
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->destroyAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 10818
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_1d

    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_1e

    :cond_1d
    const/4 v0, 0x0

    .line 10819
    .local v0, "childCount":I
    :goto_1e
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_1f
    if-ge v1, v0, :cond_2f

    .line 10820
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    invoke-direct {p0, v2, p2, p3}, Lcom/android/server/pm/PackageManagerService;->destroyAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 10819
    add-int/lit8 v1, v1, 0x1

    goto :goto_1f

    .line 10822
    .end local v1  # "i":I
    :cond_2f
    return-void
.end method

.method private destroyAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V
    .registers 16
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I
    .param p3, "flags"  # I

    .line 10826
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 10827
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 10828
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    monitor-exit v0
    :try_end_10
    .catchall {:try_start_3 .. :try_end_10} :catchall_45

    .line 10829
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->resolveUserIds(I)[I

    move-result-object v0

    array-length v2, v0

    const/4 v3, 0x0

    :goto_16
    if-ge v3, v2, :cond_44

    aget v11, v0, v3

    .line 10830
    .local v11, "realUserId":I
    if-eqz v1, :cond_21

    invoke-virtual {v1, v11}, Lcom/android/server/pm/PackageSetting;->getCeDataInode(I)J

    move-result-wide v4

    goto :goto_23

    :cond_21
    const-wide/16 v4, 0x0

    :goto_23
    move-wide v9, v4

    .line 10832
    .local v9, "ceDataInode":J
    :try_start_24
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->volumeUuid:Ljava/lang/String;

    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    move v7, v11

    move v8, p3

    invoke-virtual/range {v4 .. v10}, Lcom/android/server/pm/Installer;->destroyAppData(Ljava/lang/String;Ljava/lang/String;IIJ)V
    :try_end_2f
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_24 .. :try_end_2f} :catch_30

    .line 10836
    goto :goto_3a

    .line 10834
    :catch_30
    move-exception v4

    .line 10835
    .local v4, "e":Lcom/android/server/pm/Installer$InstallerException;
    invoke-static {v4}, Ljava/lang/String;->valueOf(Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    const-string v6, "PackageManager"

    invoke-static {v6, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10837
    .end local v4  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :goto_3a
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5, p2}, Lcom/android/server/pm/dex/DexManager;->notifyPackageDataDestroyed(Ljava/lang/String;I)V

    .line 10829
    .end local v9  # "ceDataInode":J
    .end local v11  # "realUserId":I
    add-int/lit8 v3, v3, 0x1

    goto :goto_16

    .line 10839
    :cond_44
    return-void

    .line 10828
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_45
    move-exception v1

    :try_start_46
    monitor-exit v0
    :try_end_47
    .catchall {:try_start_46 .. :try_end_47} :catchall_45

    throw v1
.end method

.method private destroyAppProfilesLIF(Landroid/content/pm/PackageParser$Package;)V
    .registers 5
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 10842
    if-nez p1, :cond_f

    .line 10843
    new-instance v0, Ljava/lang/Throwable;

    invoke-direct {v0}, Ljava/lang/Throwable;-><init>()V

    const-string v1, "PackageManager"

    const-string v2, "Package was null!"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10844
    return-void

    .line 10846
    :cond_f
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->destroyAppProfilesLeafLIF(Landroid/content/pm/PackageParser$Package;)V

    .line 10847
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_1d

    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_1e

    :cond_1d
    const/4 v0, 0x0

    .line 10848
    .local v0, "childCount":I
    :goto_1e
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_1f
    if-ge v1, v0, :cond_2f

    .line 10849
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->destroyAppProfilesLeafLIF(Landroid/content/pm/PackageParser$Package;)V

    .line 10848
    add-int/lit8 v1, v1, 0x1

    goto :goto_1f

    .line 10851
    .end local v1  # "i":I
    :cond_2f
    return-void
.end method

.method private destroyAppProfilesLeafLIF(Landroid/content/pm/PackageParser$Package;)V
    .registers 5
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 10855
    :try_start_0
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/Installer;->destroyAppProfiles(Ljava/lang/String;)V
    :try_end_7
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_0 .. :try_end_7} :catch_8

    .line 10858
    goto :goto_12

    .line 10856
    :catch_8
    move-exception v0

    .line 10857
    .local v0, "e":Lcom/android/server/pm/Installer$InstallerException;
    invoke-static {v0}, Ljava/lang/String;->valueOf(Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10859
    .end local v0  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :goto_12
    return-void
.end method

.method private disableSkuSpecificApps()V
    .registers 11

    .line 23345
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v0

    const v1, 0x1070029

    invoke-virtual {v0, v1}, Landroid/content/res/Resources;->getStringArray(I)[Ljava/lang/String;

    move-result-object v0

    .line 23347
    .local v0, "apkList":[Ljava/lang/String;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v1

    const v2, 0x1070028

    invoke-virtual {v1, v2}, Landroid/content/res/Resources;->getStringArray(I)[Ljava/lang/String;

    move-result-object v1

    .line 23349
    .local v1, "skuArray":[Ljava/lang/String;
    invoke-static {v0}, Lcom/android/internal/util/ArrayUtils;->isEmpty([Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_21

    .line 23350
    return-void

    .line 23352
    :cond_21
    const-string/jumbo v2, "ro.boot.hardware.sku"

    invoke-static {v2}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 23353
    .local v2, "sku":Ljava/lang/String;
    invoke-static {v2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v3

    if-nez v3, :cond_35

    invoke-static {v1, v2}, Lcom/android/internal/util/ArrayUtils;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_35

    .line 23354
    return-void

    .line 23356
    :cond_35
    array-length v3, v0

    const/4 v4, 0x0

    move v5, v4

    :goto_38
    if-ge v5, v3, :cond_5f

    aget-object v6, v0, v5

    .line 23357
    .local v6, "packageName":Ljava/lang/String;
    const/4 v7, 0x1

    invoke-virtual {p0, v6, v7}, Lcom/android/server/pm/PackageManagerService;->setSystemAppHiddenUntilInstalled(Ljava/lang/String;Z)V

    .line 23358
    sget-object v7, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v7, v4}, Lcom/android/server/pm/UserManagerService;->getUsers(Z)Ljava/util/List;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v7

    :goto_4a
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_5c

    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/pm/UserInfo;

    .line 23359
    .local v8, "user":Landroid/content/pm/UserInfo;
    iget v9, v8, Landroid/content/pm/UserInfo;->id:I

    invoke-virtual {p0, v6, v4, v9}, Lcom/android/server/pm/PackageManagerService;->setSystemAppInstallState(Ljava/lang/String;ZI)Z

    .line 23360
    .end local v8  # "user":Landroid/content/pm/UserInfo;
    goto :goto_4a

    .line 23356
    .end local v6  # "packageName":Ljava/lang/String;
    :cond_5c
    add-int/lit8 v5, v5, 0x1

    goto :goto_38

    .line 23362
    :cond_5f
    return-void
.end method

.method private disableSystemPackageLPw(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;)Z
    .registers 10
    .param p1, "oldPkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "newPkg"  # Landroid/content/pm/PackageParser$Package;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 16867
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v2, 0x1

    invoke-virtual {v0, v1, v2}, Lcom/android/server/pm/Settings;->disableSystemPackageLPw(Ljava/lang/String;Z)Z

    move-result v0

    .line 16869
    .local v0, "disabled":Z
    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v1, :cond_14

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    goto :goto_15

    :cond_14
    const/4 v1, 0x0

    .line 16870
    .local v1, "childCount":I
    :goto_15
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_16
    if-ge v2, v1, :cond_32

    .line 16871
    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 16872
    .local v3, "childPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {p2, v4}, Landroid/content/pm/PackageParser$Package;->hasChildPackage(Ljava/lang/String;)Z

    move-result v4

    .line 16873
    .local v4, "replace":Z
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6, v4}, Lcom/android/server/pm/Settings;->disableSystemPackageLPw(Ljava/lang/String;Z)Z

    move-result v5

    or-int/2addr v0, v5

    .line 16870
    .end local v3  # "childPkg":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "replace":Z
    add-int/lit8 v2, v2, 0x1

    goto :goto_16

    .line 16875
    .end local v2  # "i":I
    :cond_32
    return v0
.end method

.method private doSendBroadcast(Landroid/app/IActivityManager;Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[IZ)V
    .registers 36
    .param p1, "am"  # Landroid/app/IActivityManager;
    .param p2, "action"  # Ljava/lang/String;
    .param p3, "pkg"  # Ljava/lang/String;
    .param p4, "extras"  # Landroid/os/Bundle;
    .param p5, "flags"  # I
    .param p6, "targetPkg"  # Ljava/lang/String;
    .param p7, "finishedReceiver"  # Landroid/content/IIntentReceiver;
    .param p8, "userIds"  # [I
    .param p9, "isInstantApp"  # Z
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .line 13577
    move-object/from16 v0, p3

    move-object/from16 v1, p4

    move-object/from16 v2, p6

    move-object/from16 v3, p8

    array-length v4, v3

    const/4 v5, 0x0

    move v6, v5

    :goto_b
    if-ge v6, v4, :cond_d2

    aget v14, v3, v6

    .line 13578
    .local v14, "id":I
    new-instance v7, Landroid/content/Intent;

    .line 13579
    const/4 v8, 0x0

    if-eqz v0, :cond_1c

    const-string/jumbo v9, "package"

    invoke-static {v9, v0, v8}, Landroid/net/Uri;->fromParts(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v9

    goto :goto_1d

    :cond_1c
    move-object v9, v8

    :goto_1d
    move-object/from16 v13, p2

    invoke-direct {v7, v13, v9}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    move-object v12, v7

    .line 13581
    .local v12, "intent":Landroid/content/Intent;
    if-eqz p9, :cond_29

    sget-object v7, Lcom/android/server/pm/PackageManagerService;->INSTANT_APP_BROADCAST_PERMISSION:[Ljava/lang/String;

    move-object v15, v7

    goto :goto_2a

    :cond_29
    move-object v15, v8

    .line 13582
    .local v15, "requiredPermissions":[Ljava/lang/String;
    :goto_2a
    if-eqz v1, :cond_2f

    .line 13583
    invoke-virtual {v12, v1}, Landroid/content/Intent;->putExtras(Landroid/os/Bundle;)Landroid/content/Intent;

    .line 13585
    :cond_2f
    if-eqz v2, :cond_34

    .line 13586
    invoke-virtual {v12, v2}, Landroid/content/Intent;->setPackage(Ljava/lang/String;)Landroid/content/Intent;

    .line 13589
    :cond_34
    const/4 v7, -0x1

    const-string v8, "android.intent.extra.UID"

    invoke-virtual {v12, v8, v7}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I

    move-result v7

    .line 13590
    .local v7, "uid":I
    if-lez v7, :cond_51

    invoke-static {v7}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v9

    if-eq v9, v14, :cond_51

    .line 13591
    invoke-static {v7}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v9

    invoke-static {v14, v9}, Landroid/os/UserHandle;->getUid(II)I

    move-result v7

    .line 13592
    invoke-virtual {v12, v8, v7}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    move/from16 v21, v7

    goto :goto_53

    .line 13594
    :cond_51
    move/from16 v21, v7

    .end local v7  # "uid":I
    .local v21, "uid":I
    :goto_53
    const-string v7, "android.intent.extra.user_handle"

    invoke-virtual {v12, v7, v14}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 13595
    const/high16 v7, 0x4000000

    or-int v7, p5, v7

    invoke-virtual {v12, v7}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 13596
    sget-boolean v7, Lcom/android/server/pm/PackageManagerService;->DEBUG_BROADCASTS:Z

    const/4 v8, 0x1

    if-eqz v7, :cond_9c

    .line 13597
    new-instance v7, Ljava/lang/RuntimeException;

    const-string v9, "here"

    invoke-direct {v7, v9}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    .line 13598
    .local v7, "here":Ljava/lang/RuntimeException;
    invoke-virtual {v7}, Ljava/lang/RuntimeException;->fillInStackTrace()Ljava/lang/Throwable;

    .line 13599
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Sending to user "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v10, ": "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 13600
    invoke-virtual {v12, v5, v8, v5, v5}, Landroid/content/Intent;->toShortString(ZZZZ)Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 13601
    invoke-virtual {v12}, Landroid/content/Intent;->getExtras()Landroid/os/Bundle;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    .line 13599
    const-string v10, "PackageManager"

    invoke-static {v10, v9, v7}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 13603
    .end local v7  # "here":Ljava/lang/RuntimeException;
    :cond_9c
    const/4 v9, 0x0

    const/4 v10, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, 0x0

    const/16 v19, -0x1

    const/16 v20, 0x0

    if-eqz p7, :cond_ad

    move/from16 v22, v8

    goto :goto_af

    :cond_ad
    move/from16 v22, v5

    :goto_af
    const/16 v23, 0x0

    move-object/from16 v7, p1

    move-object v8, v9

    move-object v9, v12

    move-object/from16 v11, p7

    move-object/from16 v24, v12

    .end local v12  # "intent":Landroid/content/Intent;
    .local v24, "intent":Landroid/content/Intent;
    move/from16 v12, v16

    move-object/from16 v13, v17

    move/from16 v25, v14

    .end local v14  # "id":I
    .local v25, "id":I
    move-object/from16 v14, v18

    move/from16 v16, v19

    move-object/from16 v17, v20

    move/from16 v18, v22

    move/from16 v19, v23

    move/from16 v20, v25

    invoke-interface/range {v7 .. v20}, Landroid/app/IActivityManager;->broadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;[Ljava/lang/String;ILandroid/os/Bundle;ZZI)I

    .line 13577
    .end local v15  # "requiredPermissions":[Ljava/lang/String;
    .end local v21  # "uid":I
    .end local v24  # "intent":Landroid/content/Intent;
    .end local v25  # "id":I
    add-int/lit8 v6, v6, 0x1

    goto/16 :goto_b

    .line 13607
    :cond_d2
    return-void
.end method

.method private dumpCompilerStatsLPr(Ljava/io/PrintWriter;Ljava/lang/String;)V
    .registers 9
    .param p1, "pw"  # Ljava/io/PrintWriter;
    .param p2, "packageName"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 23471
    new-instance v0, Lcom/android/internal/util/IndentingPrintWriter;

    const-string v1, "  "

    invoke-direct {v0, p1, v1}, Lcom/android/internal/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;)V

    .line 23472
    .local v0, "ipw":Lcom/android/internal/util/IndentingPrintWriter;
    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V

    .line 23473
    const-string v1, "Compiler stats:"

    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23474
    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23476
    if-eqz p2, :cond_38

    .line 23477
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 23478
    .local v1, "targetPackage":Landroid/content/pm/PackageParser$Package;
    if-eqz v1, :cond_23

    .line 23479
    invoke-static {v1}, Ljava/util/Collections;->singletonList(Ljava/lang/Object;)Ljava/util/List;

    move-result-object v2

    .line 23484
    .end local v1  # "targetPackage":Landroid/content/pm/PackageParser$Package;
    .local v2, "packages":Ljava/util/Collection;, "Ljava/util/Collection<Landroid/content/pm/PackageParser$Package;>;"
    goto :goto_3e

    .line 23481
    .end local v2  # "packages":Ljava/util/Collection;, "Ljava/util/Collection<Landroid/content/pm/PackageParser$Package;>;"
    .restart local v1  # "targetPackage":Landroid/content/pm/PackageParser$Package;
    :cond_23
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Unable to find package: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23482
    return-void

    .line 23485
    .end local v1  # "targetPackage":Landroid/content/pm/PackageParser$Package;
    :cond_38
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v2

    .line 23488
    .restart local v2  # "packages":Ljava/util/Collection;, "Ljava/util/Collection<Landroid/content/pm/PackageParser$Package;>;"
    :goto_3e
    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_42
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_81

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 23489
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "["

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, "]"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23490
    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23492
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {p0, v4}, Lcom/android/server/pm/PackageManagerService;->getCompilerPackageStats(Ljava/lang/String;)Lcom/android/server/pm/CompilerStats$PackageStats;

    move-result-object v4

    .line 23493
    .local v4, "stats":Lcom/android/server/pm/CompilerStats$PackageStats;
    if-nez v4, :cond_7a

    .line 23494
    const-string v5, "(No recorded stats)"

    invoke-virtual {v0, v5}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    goto :goto_7d

    .line 23496
    :cond_7a
    invoke-virtual {v4, v0}, Lcom/android/server/pm/CompilerStats$PackageStats;->dump(Lcom/android/internal/util/IndentingPrintWriter;)V

    .line 23498
    :goto_7d
    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23499
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "stats":Lcom/android/server/pm/CompilerStats$PackageStats;
    goto :goto_42

    .line 23500
    :cond_81
    return-void
.end method

.method private dumpDexoptStateLPr(Ljava/io/PrintWriter;Ljava/lang/String;)V
    .registers 10
    .param p1, "pw"  # Ljava/io/PrintWriter;
    .param p2, "packageName"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 23442
    new-instance v0, Lcom/android/internal/util/IndentingPrintWriter;

    const-string v1, "  "

    invoke-direct {v0, p1, v1}, Lcom/android/internal/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;)V

    .line 23443
    .local v0, "ipw":Lcom/android/internal/util/IndentingPrintWriter;
    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->println()V

    .line 23444
    const-string v1, "Dexopt state:"

    invoke-virtual {v0, v1}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23445
    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23447
    if-eqz p2, :cond_38

    .line 23448
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 23449
    .local v1, "targetPackage":Landroid/content/pm/PackageParser$Package;
    if-eqz v1, :cond_23

    .line 23450
    invoke-static {v1}, Ljava/util/Collections;->singletonList(Ljava/lang/Object;)Ljava/util/List;

    move-result-object v2

    .line 23455
    .end local v1  # "targetPackage":Landroid/content/pm/PackageParser$Package;
    .local v2, "packages":Ljava/util/Collection;, "Ljava/util/Collection<Landroid/content/pm/PackageParser$Package;>;"
    goto :goto_3e

    .line 23452
    .end local v2  # "packages":Ljava/util/Collection;, "Ljava/util/Collection<Landroid/content/pm/PackageParser$Package;>;"
    .restart local v1  # "targetPackage":Landroid/content/pm/PackageParser$Package;
    :cond_23
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Unable to find package: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v0, v2}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23453
    return-void

    .line 23456
    .end local v1  # "targetPackage":Landroid/content/pm/PackageParser$Package;
    :cond_38
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v2

    .line 23459
    .restart local v2  # "packages":Ljava/util/Collection;, "Ljava/util/Collection<Landroid/content/pm/PackageParser$Package;>;"
    :goto_3e
    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_42
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_7d

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 23460
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "["

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, "]"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v0, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23461
    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23462
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDexOptimizer:Lcom/android/server/pm/PackageDexOptimizer;

    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    iget-object v6, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 23463
    invoke-virtual {v5, v6}, Lcom/android/server/pm/dex/DexManager;->getPackageUseInfoOrDefault(Ljava/lang/String;)Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;

    move-result-object v5

    .line 23462
    invoke-virtual {v4, v0, v3, v5}, Lcom/android/server/pm/PackageDexOptimizer;->dumpDexoptState(Lcom/android/internal/util/IndentingPrintWriter;Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;)V

    .line 23464
    invoke-virtual {v0}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23465
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    goto :goto_42

    .line 23466
    :cond_7d
    return-void
.end method

.method private dumpDomainString(Ljava/lang/String;)Ljava/lang/String;
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;

    .line 23503
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getIntentFilterVerifications(Ljava/lang/String;)Landroid/content/pm/ParceledListSlice;

    move-result-object v0

    .line 23504
    invoke-virtual {v0}, Landroid/content/pm/ParceledListSlice;->getList()Ljava/util/List;

    move-result-object v0

    .line 23505
    .local v0, "iviList":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/IntentFilterVerificationInfo;>;"
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getAllIntentFilters(Ljava/lang/String;)Landroid/content/pm/ParceledListSlice;

    move-result-object v1

    invoke-virtual {v1}, Landroid/content/pm/ParceledListSlice;->getList()Ljava/util/List;

    move-result-object v1

    .line 23507
    .local v1, "filters":Ljava/util/List;, "Ljava/util/List<Landroid/content/IntentFilter;>;"
    new-instance v2, Landroid/util/ArraySet;

    invoke-direct {v2}, Landroid/util/ArraySet;-><init>()V

    .line 23508
    .local v2, "result":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_33

    .line 23509
    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :goto_1f
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_33

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/IntentFilterVerificationInfo;

    .line 23510
    .local v4, "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    invoke-virtual {v4}, Landroid/content/pm/IntentFilterVerificationInfo;->getDomains()Ljava/util/Set;

    move-result-object v5

    invoke-virtual {v2, v5}, Landroid/util/ArraySet;->addAll(Ljava/util/Collection;)Z

    .line 23511
    .end local v4  # "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    goto :goto_1f

    .line 23513
    :cond_33
    if-eqz v1, :cond_6b

    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_6b

    .line 23514
    invoke-interface {v1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :goto_3f
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_6b

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/IntentFilter;

    .line 23515
    .local v4, "filter":Landroid/content/IntentFilter;
    const-string v5, "android.intent.category.BROWSABLE"

    invoke-virtual {v4, v5}, Landroid/content/IntentFilter;->hasCategory(Ljava/lang/String;)Z

    move-result v5

    if-eqz v5, :cond_6a

    .line 23516
    const-string v5, "http"

    invoke-virtual {v4, v5}, Landroid/content/IntentFilter;->hasDataScheme(Ljava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_63

    .line 23517
    const-string v5, "https"

    invoke-virtual {v4, v5}, Landroid/content/IntentFilter;->hasDataScheme(Ljava/lang/String;)Z

    move-result v5

    if-eqz v5, :cond_6a

    .line 23518
    :cond_63
    invoke-virtual {v4}, Landroid/content/IntentFilter;->getHostsList()Ljava/util/ArrayList;

    move-result-object v5

    invoke-virtual {v2, v5}, Landroid/util/ArraySet;->addAll(Ljava/util/Collection;)Z

    .line 23520
    .end local v4  # "filter":Landroid/content/IntentFilter;
    :cond_6a
    goto :goto_3f

    .line 23523
    :cond_6b
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Landroid/util/ArraySet;->size()I

    move-result v4

    mul-int/lit8 v4, v4, 0x10

    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(I)V

    .line 23524
    .local v3, "sb":Ljava/lang/StringBuilder;
    invoke-virtual {v2}, Landroid/util/ArraySet;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_7a
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_95

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/String;

    .line 23525
    .local v5, "domain":Ljava/lang/String;
    invoke-virtual {v3}, Ljava/lang/StringBuilder;->length()I

    move-result v6

    if-lez v6, :cond_91

    const-string v6, " "

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 23526
    :cond_91
    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 23527
    .end local v5  # "domain":Ljava/lang/String;
    goto :goto_7a

    .line 23528
    :cond_95
    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    return-object v4
.end method

.method private dumpFeaturesProto(Landroid/util/proto/ProtoOutputStream;)V
    .registers 8
    .param p1, "proto"  # Landroid/util/proto/ProtoOutputStream;

    .line 23403
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 23404
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/util/ArrayMap;->size()I

    move-result v1

    .line 23405
    .local v1, "count":I
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_a
    if-ge v2, v1, :cond_1f

    .line 23406
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    invoke-virtual {v3, v2}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/FeatureInfo;

    const-wide v4, 0x20b00000004L

    invoke-virtual {v3, p1, v4, v5}, Landroid/content/pm/FeatureInfo;->writeToProto(Landroid/util/proto/ProtoOutputStream;J)V

    .line 23405
    add-int/lit8 v2, v2, 0x1

    goto :goto_a

    .line 23408
    .end local v1  # "count":I
    .end local v2  # "i":I
    :cond_1f
    monitor-exit v0

    .line 23409
    return-void

    .line 23408
    :catchall_21
    move-exception v1

    monitor-exit v0
    :try_end_23
    .catchall {:try_start_3 .. :try_end_23} :catchall_21

    throw v1
.end method

.method private dumpProto(Ljava/io/FileDescriptor;)V
    .registers 15
    .param p1, "fd"  # Ljava/io/FileDescriptor;

    .line 23365
    new-instance v0, Landroid/util/proto/ProtoOutputStream;

    invoke-direct {v0, p1}, Landroid/util/proto/ProtoOutputStream;-><init>(Ljava/io/FileDescriptor;)V

    .line 23367
    .local v0, "proto":Landroid/util/proto/ProtoOutputStream;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 23368
    const-wide v2, 0x10b00000001L

    .line 23369
    :try_start_d
    invoke-virtual {v0, v2, v3}, Landroid/util/proto/ProtoOutputStream;->start(J)J

    move-result-wide v2

    .line 23370
    .local v2, "requiredVerifierPackageToken":J
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    const-wide v5, 0x10900000001L

    invoke-virtual {v0, v5, v6, v4}, Landroid/util/proto/ProtoOutputStream;->write(JLjava/lang/String;)V

    .line 23371
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    .line 23373
    const/4 v7, 0x0

    const/high16 v8, 0x10000000

    invoke-virtual {p0, v4, v8, v7}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v4

    .line 23371
    const-wide v9, 0x10500000002L

    invoke-virtual {v0, v9, v10, v4}, Landroid/util/proto/ProtoOutputStream;->write(JI)V

    .line 23377
    invoke-virtual {v0, v2, v3}, Landroid/util/proto/ProtoOutputStream;->end(J)V

    .line 23379
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifierComponent:Landroid/content/ComponentName;

    if-eqz v4, :cond_50

    .line 23380
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifierComponent:Landroid/content/ComponentName;

    invoke-virtual {v4}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v4

    .line 23381
    .local v4, "verifierPackageName":Ljava/lang/String;
    const-wide v11, 0x10b00000002L

    .line 23382
    invoke-virtual {v0, v11, v12}, Landroid/util/proto/ProtoOutputStream;->start(J)J

    move-result-wide v11

    .line 23383
    .local v11, "verifierPackageToken":J
    invoke-virtual {v0, v5, v6, v4}, Landroid/util/proto/ProtoOutputStream;->write(JLjava/lang/String;)V

    .line 23384
    nop

    .line 23386
    invoke-virtual {p0, v4, v8, v7}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v5

    .line 23384
    invoke-virtual {v0, v9, v10, v5}, Landroid/util/proto/ProtoOutputStream;->write(JI)V

    .line 23390
    invoke-virtual {v0, v11, v12}, Landroid/util/proto/ProtoOutputStream;->end(J)V

    .line 23393
    .end local v4  # "verifierPackageName":Ljava/lang/String;
    .end local v11  # "verifierPackageToken":J
    :cond_50
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->dumpSharedLibrariesProto(Landroid/util/proto/ProtoOutputStream;)V

    .line 23394
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->dumpFeaturesProto(Landroid/util/proto/ProtoOutputStream;)V

    .line 23395
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, v0}, Lcom/android/server/pm/Settings;->dumpPackagesProto(Landroid/util/proto/ProtoOutputStream;)V

    .line 23396
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, v0}, Lcom/android/server/pm/Settings;->dumpSharedUsersProto(Landroid/util/proto/ProtoOutputStream;)V

    .line 23397
    invoke-static {v0}, Lcom/android/server/pm/PackageManagerServiceUtils;->dumpCriticalInfo(Landroid/util/proto/ProtoOutputStream;)V

    .line 23398
    .end local v2  # "requiredVerifierPackageToken":J
    monitor-exit v1
    :try_end_64
    .catchall {:try_start_d .. :try_end_64} :catchall_68

    .line 23399
    invoke-virtual {v0}, Landroid/util/proto/ProtoOutputStream;->flush()V

    .line 23400
    return-void

    .line 23398
    :catchall_68
    move-exception v2

    :try_start_69
    monitor-exit v1
    :try_end_6a
    .catchall {:try_start_69 .. :try_end_6a} :catchall_68

    throw v2
.end method

.method private dumpSharedLibrariesProto(Landroid/util/proto/ProtoOutputStream;)V
    .registers 15
    .param p1, "proto"  # Landroid/util/proto/ProtoOutputStream;

    .line 23412
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v0

    .line 23413
    .local v0, "count":I
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_7
    if-ge v1, v0, :cond_73

    .line 23414
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v2, v1}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/String;

    .line 23415
    .local v2, "libName":Ljava/lang/String;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v3, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/util/LongSparseArray;

    .line 23416
    .local v3, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-nez v3, :cond_1c

    .line 23417
    goto :goto_70

    .line 23419
    :cond_1c
    invoke-virtual {v3}, Landroid/util/LongSparseArray;->size()I

    move-result v4

    .line 23420
    .local v4, "versionCount":I
    const/4 v5, 0x0

    .local v5, "j":I
    :goto_21
    if-ge v5, v4, :cond_70

    .line 23421
    invoke-virtual {v3, v5}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/SharedLibraryInfo;

    .line 23422
    .local v6, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    const-wide v7, 0x20b00000003L

    .line 23423
    invoke-virtual {p1, v7, v8}, Landroid/util/proto/ProtoOutputStream;->start(J)J

    move-result-wide v7

    .line 23424
    .local v7, "sharedLibraryToken":J
    const-wide v9, 0x10900000001L

    invoke-virtual {v6}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v11

    invoke-virtual {p1, v9, v10, v11}, Landroid/util/proto/ProtoOutputStream;->write(JLjava/lang/String;)V

    .line 23425
    invoke-virtual {v6}, Landroid/content/pm/SharedLibraryInfo;->getPath()Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_46

    const/4 v9, 0x1

    goto :goto_47

    :cond_46
    const/4 v9, 0x0

    .line 23426
    .local v9, "isJar":Z
    :goto_47
    const-wide v10, 0x10800000002L

    invoke-virtual {p1, v10, v11, v9}, Landroid/util/proto/ProtoOutputStream;->write(JZ)V

    .line 23427
    if-eqz v9, :cond_5e

    .line 23428
    const-wide v10, 0x10900000003L

    .line 23429
    invoke-virtual {v6}, Landroid/content/pm/SharedLibraryInfo;->getPath()Ljava/lang/String;

    move-result-object v12

    .line 23428
    invoke-virtual {p1, v10, v11, v12}, Landroid/util/proto/ProtoOutputStream;->write(JLjava/lang/String;)V

    goto :goto_6a

    .line 23431
    :cond_5e
    const-wide v10, 0x10900000004L

    .line 23432
    invoke-virtual {v6}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v12

    .line 23431
    invoke-virtual {p1, v10, v11, v12}, Landroid/util/proto/ProtoOutputStream;->write(JLjava/lang/String;)V

    .line 23434
    :goto_6a
    invoke-virtual {p1, v7, v8}, Landroid/util/proto/ProtoOutputStream;->end(J)V

    .line 23420
    .end local v6  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v7  # "sharedLibraryToken":J
    .end local v9  # "isJar":Z
    add-int/lit8 v5, v5, 0x1

    goto :goto_21

    .line 23413
    .end local v2  # "libName":Ljava/lang/String;
    .end local v3  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v4  # "versionCount":I
    .end local v5  # "j":I
    :cond_70
    :goto_70
    add-int/lit8 v1, v1, 0x1

    goto :goto_7

    .line 23437
    .end local v1  # "i":I
    :cond_73
    return-void
.end method

.method private enableCompressedPackage(Landroid/content/pm/PackageParser$Package;)Z
    .registers 16
    .param p1, "stubPkg"  # Landroid/content/pm/PackageParser$Package;

    .line 3655
    iget v0, p0, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    const/high16 v1, -0x80000000

    or-int/2addr v0, v1

    or-int/lit8 v0, v0, 0x40

    .line 3657
    .local v0, "parseFlags":I
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v1

    .line 3659
    const/4 v2, 0x0

    const/4 v3, 0x0

    :try_start_c
    iget-object v4, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const-string/jumbo v5, "setEnabledSetting"

    .line 3660
    invoke-virtual {p0, v4, v5}, Lcom/android/server/pm/PackageManagerService;->freezePackage(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v4
    :try_end_15
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_c .. :try_end_15} :catch_6f
    .catchall {:try_start_c .. :try_end_15} :catchall_6c

    .line 3659
    .local v4, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    nop

    .line 3661
    :try_start_16
    invoke-direct {p0, p1, v0, v3}, Lcom/android/server/pm/PackageManagerService;->installStubPackageLI(Landroid/content/pm/PackageParser$Package;II)Landroid/content/pm/PackageParser$Package;

    move-result-object v5

    .line 3662
    .local v5, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v12, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v12
    :try_end_1d
    .catchall {:try_start_16 .. :try_end_1d} :catchall_63

    .line 3663
    :try_start_1d
    invoke-direct {p0, v5}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataAfterInstallLIF(Landroid/content/pm/PackageParser$Package;)V
    :try_end_20
    .catchall {:try_start_1d .. :try_end_20} :catchall_60

    .line 3665
    :try_start_20
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-direct {p0, v5, v2, v6}, Lcom/android/server/pm/PackageManagerService;->updateSharedLibrariesLocked(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/Map;)V
    :try_end_25
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_20 .. :try_end_25} :catch_26
    .catchall {:try_start_20 .. :try_end_25} :catchall_60

    .line 3668
    goto :goto_2f

    .line 3666
    :catch_26
    move-exception v6

    .line 3667
    .local v6, "e":Lcom/android/server/pm/PackageManagerException;
    :try_start_27
    const-string v7, "PackageManager"

    const-string/jumbo v8, "updateAllSharedLibrariesLPw failed: "

    invoke-static {v7, v8, v6}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 3669
    .end local v6  # "e":Lcom/android/server/pm/PackageManagerException;
    :goto_2f
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v7, v5, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v9, 0x1

    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 3670
    invoke-virtual {v8}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v10

    iget-object v11, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 3669
    move-object v8, v5

    invoke-virtual/range {v6 .. v11}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updatePermissions(Ljava/lang/String;Landroid/content/pm/PackageParser$Package;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 3672
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v6}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 3673
    monitor-exit v12
    :try_end_46
    .catchall {:try_start_27 .. :try_end_46} :catchall_60

    .line 3674
    if-eqz v4, :cond_4b

    :try_start_48
    invoke-static {v2, v4}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V
    :try_end_4b
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_48 .. :try_end_4b} :catch_6f
    .catchall {:try_start_48 .. :try_end_4b} :catchall_6c

    .line 3701
    .end local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :cond_4b
    nop

    .line 3702
    const/4 v2, -0x1

    const/16 v3, 0x27

    :try_start_4f
    invoke-direct {p0, v5, v2, v3}, Lcom/android/server/pm/PackageManagerService;->clearAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 3704
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    iget-object v3, v5, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v4, v5, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    iget-object v6, v5, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    invoke-virtual {v2, v3, v4, v6}, Lcom/android/server/pm/dex/DexManager;->notifyPackageUpdated(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)V

    .line 3706
    .end local v5  # "pkg":Landroid/content/pm/PackageParser$Package;
    monitor-exit v1
    :try_end_5e
    .catchall {:try_start_4f .. :try_end_5e} :catchall_6c

    .line 3707
    const/4 v1, 0x1

    return v1

    .line 3673
    .restart local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v5  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_60
    move-exception v6

    :try_start_61
    monitor-exit v12
    :try_end_62
    .catchall {:try_start_61 .. :try_end_62} :catchall_60

    .end local v0  # "parseFlags":I
    .end local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :try_start_62
    throw v6
    :try_end_63
    .catchall {:try_start_62 .. :try_end_63} :catchall_63

    .line 3659
    .end local v5  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v0  # "parseFlags":I
    .restart local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :catchall_63
    move-exception v5

    .end local v0  # "parseFlags":I
    .end local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :try_start_64
    throw v5
    :try_end_65
    .catchall {:try_start_64 .. :try_end_65} :catchall_65

    .line 3674
    .restart local v0  # "parseFlags":I
    .restart local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :catchall_65
    move-exception v6

    if-eqz v4, :cond_6b

    :try_start_68
    invoke-static {v5, v4}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    .end local v0  # "parseFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :cond_6b
    throw v6
    :try_end_6c
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_68 .. :try_end_6c} :catch_6f
    .catchall {:try_start_68 .. :try_end_6c} :catchall_6c

    .line 3706
    .end local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v0  # "parseFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :catchall_6c
    move-exception v2

    goto/16 :goto_11b

    .line 3674
    :catch_6f
    move-exception v4

    .line 3676
    .local v4, "e":Lcom/android/server/pm/PackageManagerException;
    const/4 v5, 0x2

    :try_start_71
    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const-string/jumbo v7, "setEnabledSetting"

    .line 3677
    invoke-virtual {p0, v6, v7}, Lcom/android/server/pm/PackageManagerService;->freezePackage(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v6
    :try_end_7a
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_71 .. :try_end_7a} :catch_bf
    .catchall {:try_start_71 .. :try_end_7a} :catchall_bd

    .line 3676
    .local v6, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    nop

    .line 3678
    :try_start_7b
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v7
    :try_end_7e
    .catchall {:try_start_7b .. :try_end_7e} :catchall_b4

    .line 3681
    :try_start_7e
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->enableSystemPackageLPw(Landroid/content/pm/PackageParser$Package;)V

    .line 3682
    monitor-exit v7
    :try_end_82
    .catchall {:try_start_7e .. :try_end_82} :catchall_b1

    .line 3683
    :try_start_82
    iget-object v9, p1, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x1

    move-object v8, p0

    invoke-direct/range {v8 .. v13}, Lcom/android/server/pm/PackageManagerService;->installPackageFromSystemLIF(Ljava/lang/String;[I[ILcom/android/server/pm/permission/PermissionsState;Z)Landroid/content/pm/PackageParser$Package;
    :try_end_8c
    .catchall {:try_start_82 .. :try_end_8c} :catchall_b4

    .line 3686
    if-eqz v6, :cond_91

    :try_start_8e
    invoke-static {v2, v6}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V
    :try_end_91
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_8e .. :try_end_91} :catch_bf
    .catchall {:try_start_8e .. :try_end_91} :catchall_bd

    .line 3691
    .end local v6  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :cond_91
    :try_start_91
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2
    :try_end_94
    .catchall {:try_start_91 .. :try_end_94} :catchall_6c

    .line 3692
    :try_start_94
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v6, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v7, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    .line 3693
    .local v6, "stubPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v6, :cond_a7

    .line 3694
    const-string v7, "android"

    invoke-virtual {v6, v5, v3, v7}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    .line 3697
    :cond_a7
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v5}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 3698
    .end local v6  # "stubPs":Lcom/android/server/pm/PackageSetting;
    monitor-exit v2

    goto :goto_f5

    :catchall_ae
    move-exception v3

    monitor-exit v2
    :try_end_b0
    .catchall {:try_start_94 .. :try_end_b0} :catchall_ae

    .end local v0  # "parseFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :goto_b0
    :try_start_b0
    throw v3
    :try_end_b1
    .catchall {:try_start_b0 .. :try_end_b1} :catchall_6c

    .line 3682
    .restart local v0  # "parseFlags":I
    .local v6, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :catchall_b1
    move-exception v2

    :try_start_b2
    monitor-exit v7
    :try_end_b3
    .catchall {:try_start_b2 .. :try_end_b3} :catchall_b1

    .end local v0  # "parseFlags":I
    .end local v4  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v6  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :try_start_b3
    throw v2
    :try_end_b4
    .catchall {:try_start_b3 .. :try_end_b4} :catchall_b4

    .line 3676
    .restart local v0  # "parseFlags":I
    .restart local v4  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v6  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :catchall_b4
    move-exception v2

    .end local v0  # "parseFlags":I
    .end local v4  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v6  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :try_start_b5
    throw v2
    :try_end_b6
    .catchall {:try_start_b5 .. :try_end_b6} :catchall_b6

    .line 3686
    .restart local v0  # "parseFlags":I
    .restart local v4  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v6  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :catchall_b6
    move-exception v7

    if-eqz v6, :cond_bc

    :try_start_b9
    invoke-static {v2, v6}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    .end local v0  # "parseFlags":I
    .end local v4  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :cond_bc
    throw v7
    :try_end_bd
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_b9 .. :try_end_bd} :catch_bf
    .catchall {:try_start_b9 .. :try_end_bd} :catchall_bd

    .line 3691
    .end local v6  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v0  # "parseFlags":I
    .restart local v4  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :catchall_bd
    move-exception v2

    goto :goto_fb

    .line 3686
    :catch_bf
    move-exception v2

    .line 3688
    .local v2, "pme":Lcom/android/server/pm/PackageManagerException;
    :try_start_c0
    const-string v6, "PackageManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Failed to restore system package:"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v8, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7, v2}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_d8
    .catchall {:try_start_c0 .. :try_end_d8} :catchall_bd

    .line 3691
    nop

    .end local v2  # "pme":Lcom/android/server/pm/PackageManagerException;
    :try_start_d9
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2
    :try_end_dc
    .catchall {:try_start_d9 .. :try_end_dc} :catchall_6c

    .line 3692
    :try_start_dc
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v6, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v7, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    .line 3693
    .local v6, "stubPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v6, :cond_ef

    .line 3694
    const-string v7, "android"

    invoke-virtual {v6, v5, v3, v7}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    .line 3697
    :cond_ef
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v5}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 3698
    .end local v6  # "stubPs":Lcom/android/server/pm/PackageSetting;
    monitor-exit v2
    :try_end_f5
    .catchall {:try_start_dc .. :try_end_f5} :catchall_f8

    .line 3699
    :goto_f5
    nop

    .line 3700
    :try_start_f6
    monitor-exit v1
    :try_end_f7
    .catchall {:try_start_f6 .. :try_end_f7} :catchall_6c

    return v3

    .line 3698
    :catchall_f8
    move-exception v3

    :try_start_f9
    monitor-exit v2
    :try_end_fa
    .catchall {:try_start_f9 .. :try_end_fa} :catchall_f8

    goto :goto_b0

    .line 3691
    :goto_fb
    :try_start_fb
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6
    :try_end_fe
    .catchall {:try_start_fb .. :try_end_fe} :catchall_6c

    .line 3692
    :try_start_fe
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v8, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 3693
    .local v7, "stubPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v7, :cond_111

    .line 3694
    const-string v8, "android"

    invoke-virtual {v7, v5, v3, v8}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    .line 3697
    :cond_111
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 3698
    .end local v7  # "stubPs":Lcom/android/server/pm/PackageSetting;
    monitor-exit v6
    :try_end_117
    .catchall {:try_start_fe .. :try_end_117} :catchall_118

    .end local v0  # "parseFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :goto_117
    :try_start_117
    throw v2
    :try_end_118
    .catchall {:try_start_117 .. :try_end_118} :catchall_6c

    .restart local v0  # "parseFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    :catchall_118
    move-exception v2

    :try_start_119
    monitor-exit v6
    :try_end_11a
    .catchall {:try_start_119 .. :try_end_11a} :catchall_118

    goto :goto_117

    .line 3706
    .end local v4  # "e":Lcom/android/server/pm/PackageManagerException;
    :goto_11b
    :try_start_11b
    monitor-exit v1
    :try_end_11c
    .catchall {:try_start_11b .. :try_end_11c} :catchall_6c

    throw v2
.end method

.method private enableSystemPackageLPw(Landroid/content/pm/PackageParser$Package;)V
    .registers 7
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 16854
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/Settings;->enableSystemPackageLPw(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    .line 16856
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_12

    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_13

    :cond_12
    const/4 v0, 0x0

    .line 16857
    .local v0, "childCount":I
    :goto_13
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_14
    if-ge v1, v0, :cond_28

    .line 16858
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 16859
    .local v2, "childPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Lcom/android/server/pm/Settings;->enableSystemPackageLPw(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    .line 16857
    .end local v2  # "childPkg":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v1, v1, 0x1

    goto :goto_14

    .line 16861
    .end local v1  # "i":I
    :cond_28
    return-void
.end method

.method private enableSystemUserPackages()V
    .registers 16

    .line 2414
    invoke-static {}, Landroid/os/UserManager;->isSplitSystemUser()Z

    move-result v0

    if-nez v0, :cond_7

    .line 2415
    return-void

    .line 2423
    :cond_7
    new-instance v0, Landroid/content/pm/AppsQueryHelper;

    invoke-direct {v0, p0}, Landroid/content/pm/AppsQueryHelper;-><init>(Landroid/content/pm/IPackageManager;)V

    .line 2424
    .local v0, "queryHelper":Landroid/content/pm/AppsQueryHelper;
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    .line 2425
    .local v1, "enableApps":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    sget v2, Landroid/content/pm/AppsQueryHelper;->GET_NON_LAUNCHABLE_APPS:I

    sget v3, Landroid/content/pm/AppsQueryHelper;->GET_APPS_WITH_INTERACT_ACROSS_USERS_PERM:I

    or-int/2addr v2, v3

    sget v3, Landroid/content/pm/AppsQueryHelper;->GET_IMES:I

    or-int/2addr v2, v3

    sget-object v3, Landroid/os/UserHandle;->SYSTEM:Landroid/os/UserHandle;

    const/4 v4, 0x1

    invoke-virtual {v0, v2, v4, v3}, Landroid/content/pm/AppsQueryHelper;->queryApps(IZLandroid/os/UserHandle;)Ljava/util/List;

    move-result-object v2

    invoke-interface {v1, v2}, Ljava/util/Set;->addAll(Ljava/util/Collection;)Z

    .line 2428
    invoke-static {}, Lcom/android/server/SystemConfig;->getInstance()Lcom/android/server/SystemConfig;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/SystemConfig;->getSystemUserWhitelistedApps()Landroid/util/ArraySet;

    move-result-object v2

    .line 2429
    .local v2, "wlApps":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    invoke-interface {v1, v2}, Ljava/util/Set;->addAll(Ljava/util/Collection;)Z

    .line 2430
    sget v3, Landroid/content/pm/AppsQueryHelper;->GET_REQUIRED_FOR_SYSTEM_USER:I

    sget-object v4, Landroid/os/UserHandle;->SYSTEM:Landroid/os/UserHandle;

    const/4 v5, 0x0

    invoke-virtual {v0, v3, v5, v4}, Landroid/content/pm/AppsQueryHelper;->queryApps(IZLandroid/os/UserHandle;)Ljava/util/List;

    move-result-object v3

    invoke-interface {v1, v3}, Ljava/util/Set;->addAll(Ljava/util/Collection;)Z

    .line 2432
    invoke-static {}, Lcom/android/server/SystemConfig;->getInstance()Lcom/android/server/SystemConfig;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/SystemConfig;->getSystemUserBlacklistedApps()Landroid/util/ArraySet;

    move-result-object v3

    .line 2433
    .local v3, "blApps":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    invoke-interface {v1, v3}, Ljava/util/Set;->removeAll(Ljava/util/Collection;)Z

    .line 2434
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Applications installed for system user: "

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v6, "PackageManager"

    invoke-static {v6, v4}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2435
    sget-object v4, Landroid/os/UserHandle;->SYSTEM:Landroid/os/UserHandle;

    invoke-virtual {v0, v5, v5, v4}, Landroid/content/pm/AppsQueryHelper;->queryApps(IZLandroid/os/UserHandle;)Ljava/util/List;

    move-result-object v4

    .line 2437
    .local v4, "allAps":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    invoke-interface {v4}, Ljava/util/List;->size()I

    move-result v6

    .line 2438
    .local v6, "allAppsSize":I
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v7

    .line 2439
    const/4 v8, 0x0

    .local v8, "i":I
    :goto_69
    if-ge v8, v6, :cond_ae

    .line 2440
    :try_start_6b
    invoke-interface {v4, v8}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/String;

    .line 2441
    .local v9, "pName":Ljava/lang/String;
    iget-object v10, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v10, v10, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v10, v9}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/pm/PackageSetting;

    .line 2443
    .local v10, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-nez v10, :cond_7e

    .line 2444
    goto :goto_ab

    .line 2446
    :cond_7e
    invoke-interface {v1, v9}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v11

    .line 2447
    .local v11, "install":Z
    invoke-virtual {v10, v5}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v12

    if-eq v12, v11, :cond_ab

    .line 2448
    const-string v12, "PackageManager"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    if-eqz v11, :cond_94

    const-string v14, "Installing "

    goto :goto_96

    :cond_94
    const-string v14, "Uninstalling "

    :goto_96
    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v14, " for system user"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-static {v12, v13}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2450
    invoke-virtual {v10, v11, v5}, Lcom/android/server/pm/PackageSetting;->setInstalled(ZI)V

    .line 2439
    .end local v9  # "pName":Ljava/lang/String;
    .end local v10  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v11  # "install":Z
    :cond_ab
    :goto_ab
    add-int/lit8 v8, v8, 0x1

    goto :goto_69

    .line 2453
    .end local v8  # "i":I
    :cond_ae
    invoke-virtual {p0, v5}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 2454
    monitor-exit v7

    .line 2455
    return-void

    .line 2454
    :catchall_b3
    move-exception v5

    monitor-exit v7
    :try_end_b5
    .catchall {:try_start_6b .. :try_end_b5} :catchall_b3

    throw v5
.end method

.method private enforceCanSetPackagesSuspendedAsUser(Ljava/lang/String;IILjava/lang/String;)V
    .registers 12
    .param p1, "callingPackage"  # Ljava/lang/String;
    .param p2, "callingUid"  # I
    .param p3, "userId"  # I
    .param p4, "callingMethod"  # Ljava/lang/String;

    .line 14291
    if-eqz p2, :cond_88

    const/16 v0, 0x3e8

    if-ne p2, v0, :cond_8

    goto/16 :goto_88

    .line 14295
    :cond_8
    const-string v0, "com.meizu.sceneinfo"

    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_11

    .line 14296
    return-void

    .line 14299
    :cond_11
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mProtectedPackages:Lcom/android/server/pm/ProtectedPackages;

    invoke-virtual {v0, p3}, Lcom/android/server/pm/ProtectedPackages;->getDeviceOwnerOrProfileOwnerPackage(I)Ljava/lang/String;

    move-result-object v0

    .line 14300
    .local v0, "ownerPackage":Ljava/lang/String;
    const/4 v1, 0x0

    if-eqz v0, :cond_3d

    .line 14301
    invoke-virtual {p0, v0, v1, p3}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v1

    .line 14302
    .local v1, "ownerUid":I
    if-ne v1, p2, :cond_21

    .line 14303
    return-void

    .line 14305
    :cond_21
    new-instance v2, Ljava/lang/UnsupportedOperationException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Cannot suspend/unsuspend packages. User "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, " has an active DO or PO"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/UnsupportedOperationException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 14309
    .end local v1  # "ownerUid":I
    :cond_3d
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v3, "android.permission.SUSPEND_APPS"

    invoke-virtual {v2, v3, p4}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 14312
    invoke-virtual {p0, p1, v1, p3}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    .line 14313
    .local v2, "packageUid":I
    const/4 v3, 0x1

    if-ne v2, p2, :cond_4d

    move v4, v3

    goto :goto_4e

    :cond_4d
    move v4, v1

    .line 14314
    .local v4, "allowedPackageUid":Z
    :goto_4e
    const/16 v5, 0x7d0

    if-ne p2, v5, :cond_5a

    .line 14315
    invoke-static {v2, p2}, Landroid/os/UserHandle;->isSameApp(II)Z

    move-result v5

    if-eqz v5, :cond_5a

    move v1, v3

    goto :goto_5b

    :cond_5a
    nop

    .line 14317
    .local v1, "allowedShell":Z
    :goto_5b
    if-nez v1, :cond_87

    if-eqz v4, :cond_60

    goto :goto_87

    .line 14318
    :cond_60
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Calling package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " in user "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, " does not belong to calling uid "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v3, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 14321
    :cond_87
    :goto_87
    return-void

    .line 14292
    .end local v0  # "ownerPackage":Ljava/lang/String;
    .end local v1  # "allowedShell":Z
    .end local v2  # "packageUid":I
    .end local v4  # "allowedPackageUid":Z
    :cond_88
    :goto_88
    return-void
.end method

.method private enforceOwnerRights(Ljava/lang/String;I)V
    .registers 8
    .param p1, "pkg"  # Ljava/lang/String;
    .param p2, "callingUid"  # I

    .line 21794
    invoke-static {p2}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v0

    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_9

    .line 21795
    return-void

    .line 21797
    :cond_9
    invoke-static {p2}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v0

    .line 21798
    .local v0, "callingUserId":I
    const/4 v1, 0x0

    invoke-virtual {p0, p1, v1, v0}, Lcom/android/server/pm/PackageManagerService;->getPackageInfo(Ljava/lang/String;II)Landroid/content/pm/PackageInfo;

    move-result-object v1

    .line 21799
    .local v1, "pi":Landroid/content/pm/PackageInfo;
    if-eqz v1, :cond_3e

    .line 21803
    iget-object v2, v1, Landroid/content/pm/PackageInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v2, p2}, Landroid/os/UserHandle;->isSameApp(II)Z

    move-result v2

    if-eqz v2, :cond_1f

    .line 21807
    return-void

    .line 21804
    :cond_1f
    new-instance v2, Ljava/lang/SecurityException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Calling uid "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, " does not own package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 21800
    :cond_3e
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unknown package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " on user "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2
.end method

.method private static enforceSystemOrPhoneCaller(Ljava/lang/String;)V
    .registers 5
    .param p0, "tag"  # Ljava/lang/String;

    .line 26220
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 26221
    .local v0, "callingUid":I
    const/16 v1, 0x3e9

    if-eq v0, v1, :cond_2c

    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_d

    goto :goto_2c

    .line 26222
    :cond_d
    new-instance v1, Ljava/lang/SecurityException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Cannot call "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " from UID "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 26225
    :cond_2c
    :goto_2c
    return-void
.end method

.method private static enforceSystemOrRoot(Ljava/lang/String;)V
    .registers 3
    .param p0, "message"  # Ljava/lang/String;

    .line 10027
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 10028
    .local v0, "uid":I
    const/16 v1, 0x3e8

    if-eq v0, v1, :cond_11

    if-nez v0, :cond_b

    goto :goto_11

    .line 10029
    :cond_b
    new-instance v1, Ljava/lang/SecurityException;

    invoke-direct {v1, p0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 10031
    :cond_11
    :goto_11
    return-void
.end method

.method private static enforceSystemOrRootOrShell(Ljava/lang/String;)V
    .registers 3
    .param p0, "message"  # Ljava/lang/String;

    .line 10041
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 10042
    .local v0, "uid":I
    const/16 v1, 0x3e8

    if-eq v0, v1, :cond_15

    if-eqz v0, :cond_15

    const/16 v1, 0x7d0

    if-ne v0, v1, :cond_f

    goto :goto_15

    .line 10043
    :cond_f
    new-instance v1, Ljava/lang/SecurityException;

    invoke-direct {v1, p0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 10045
    :cond_15
    :goto_15
    return-void
.end method

.method private static ensurePackageRenamed(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)V
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "renamedPackageName"  # Ljava/lang/String;

    .line 11671
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_19

    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    .line 11672
    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_19

    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 11673
    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_15

    goto :goto_19

    .line 11676
    :cond_15
    invoke-virtual {p0, p1}, Landroid/content/pm/PackageParser$Package;->setPackageName(Ljava/lang/String;)V

    .line 11677
    return-void

    .line 11674
    :cond_19
    :goto_19
    return-void
.end method

.method private ensureSystemPackageName(Ljava/lang/String;)Ljava/lang/String;
    .registers 10
    .param p1, "packageName"  # Ljava/lang/String;

    .line 22147
    const/4 v0, 0x0

    if-nez p1, :cond_4

    .line 22148
    return-object v0

    .line 22150
    :cond_4
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 22152
    .local v1, "token":J
    const/high16 v3, 0x200000

    const/4 v4, 0x0

    :try_start_b
    invoke-virtual {p0, p1, v3, v4}, Lcom/android/server/pm/PackageManagerService;->getPackageInfo(Ljava/lang/String;II)Landroid/content/pm/PackageInfo;

    move-result-object v3

    if-nez v3, :cond_39

    .line 22153
    invoke-virtual {p0, p1, v4, v4}, Lcom/android/server/pm/PackageManagerService;->getPackageInfo(Ljava/lang/String;II)Landroid/content/pm/PackageInfo;

    move-result-object v3

    .line 22154
    .local v3, "packageInfo":Landroid/content/pm/PackageInfo;
    if-eqz v3, :cond_34

    .line 22155
    const v5, 0x534e4554

    const/4 v6, 0x3

    new-array v6, v6, [Ljava/lang/Object;

    const-string v7, "145981139"

    aput-object v7, v6, v4

    const/4 v4, 0x1

    iget-object v7, v3, Landroid/content/pm/PackageInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v6, v4

    const/4 v4, 0x2

    const-string v7, ""

    aput-object v7, v6, v4

    invoke-static {v5, v6}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I
    :try_end_34
    .catchall {:try_start_b .. :try_end_34} :catchall_3e

    .line 22158
    :cond_34
    nop

    .line 22161
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 22158
    return-object v0

    .line 22161
    .end local v3  # "packageInfo":Landroid/content/pm/PackageInfo;
    :cond_39
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 22162
    nop

    .line 22163
    return-object p1

    .line 22161
    :catchall_3e
    move-exception v0

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0
.end method

.method private executeDeletePackageLIF(Lcom/android/server/pm/PackageManagerService$DeletePackageAction;Ljava/lang/String;Z[IZLandroid/content/pm/PackageParser$Package;)V
    .registers 27
    .param p1, "action"  # Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    .param p2, "packageName"  # Ljava/lang/String;
    .param p3, "deleteCodeAndResources"  # Z
    .param p4, "allUserHandles"  # [I
    .param p5, "writeSettings"  # Z
    .param p6, "replacingPackage"  # Landroid/content/pm/PackageParser$Package;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerService$SystemDeleteException;
        }
    .end annotation

    .line 20372
    move-object/from16 v9, p0

    move-object/from16 v10, p1

    move-object/from16 v11, p2

    move-object/from16 v12, p4

    iget-object v13, v10, Lcom/android/server/pm/PackageManagerService$DeletePackageAction;->deletingPs:Lcom/android/server/pm/PackageSetting;

    .line 20373
    .local v13, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v14, v10, Lcom/android/server/pm/PackageManagerService$DeletePackageAction;->outInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    .line 20374
    .local v14, "outInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    iget-object v15, v10, Lcom/android/server/pm/PackageManagerService$DeletePackageAction;->user:Landroid/os/UserHandle;

    .line 20375
    .local v15, "user":Landroid/os/UserHandle;
    iget v8, v10, Lcom/android/server/pm/PackageManagerService$DeletePackageAction;->flags:I

    .line 20376
    .local v8, "flags":I
    invoke-static {v13}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Lcom/android/server/pm/PackageSetting;)Z

    move-result v16

    .line 20378
    .local v16, "systemApp":Z
    iget-object v0, v13, Lcom/android/server/pm/PackageSetting;->parentPackageName:Ljava/lang/String;

    const/4 v1, -0x1

    if-eqz v0, :cond_63

    if-eqz v16, :cond_1f

    and-int/lit8 v0, v8, 0x4

    if-eqz v0, :cond_63

    .line 20380
    :cond_1f
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v0, :cond_49

    .line 20381
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Uninstalled child package:"

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " for user:"

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 20382
    if-nez v15, :cond_3c

    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    goto :goto_3d

    :cond_3c
    move-object v2, v15

    :goto_3d
    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 20381
    const-string v2, "PackageManager"

    invoke-static {v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20384
    :cond_49
    if-eqz v15, :cond_50

    invoke-virtual {v15}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v1

    goto :goto_51

    .line 20385
    :cond_50
    nop

    :goto_51
    move v2, v1

    .line 20387
    .local v2, "removedUserId":I
    invoke-direct {v9, v13, v2, v14, v8}, Lcom/android/server/pm/PackageManagerService;->clearPackageStateForUserLIF(Lcom/android/server/pm/PackageSetting;ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;I)V

    .line 20388
    iget-object v3, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 20389
    :try_start_58
    invoke-direct {v9, v13, v15}, Lcom/android/server/pm/PackageManagerService;->markPackageUninstalledForUserLPw(Lcom/android/server/pm/PackageSetting;Landroid/os/UserHandle;)V

    .line 20390
    invoke-virtual {v9, v15}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(Landroid/os/UserHandle;)V

    .line 20391
    monitor-exit v3

    .line 20392
    return-void

    .line 20391
    :catchall_60
    move-exception v0

    monitor-exit v3
    :try_end_62
    .catchall {:try_start_58 .. :try_end_62} :catchall_60

    throw v0

    .line 20395
    .end local v2  # "removedUserId":I
    :cond_63
    if-nez v15, :cond_67

    move v0, v1

    goto :goto_6b

    :cond_67
    invoke-virtual {v15}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v0

    :goto_6b
    move v7, v0

    .line 20396
    .local v7, "userId":I
    invoke-virtual {v13}, Lcom/android/server/pm/PackageSetting;->getPermissionsState()Lcom/android/server/pm/permission/PermissionsState;

    move-result-object v0

    const-string v2, "android.permission.SUSPEND_APPS"

    invoke-virtual {v0, v2, v7}, Lcom/android/server/pm/permission/PermissionsState;->hasPermission(Ljava/lang/String;I)Z

    move-result v0

    if-eqz v0, :cond_7b

    .line 20397
    invoke-virtual {v9, v11, v7}, Lcom/android/server/pm/PackageManagerService;->unsuspendForSuspendingPackage(Ljava/lang/String;I)V

    .line 20400
    :cond_7b
    const/4 v0, 0x1

    if-eqz v16, :cond_82

    and-int/lit8 v2, v8, 0x4

    if-eqz v2, :cond_f6

    :cond_82
    if-eq v7, v1, :cond_f6

    .line 20411
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20412
    :try_start_87
    invoke-direct {v9, v13, v15}, Lcom/android/server/pm/PackageManagerService;->markPackageUninstalledForUserLPw(Lcom/android/server/pm/PackageSetting;Landroid/os/UserHandle;)V

    .line 20413
    if-nez v16, :cond_c2

    .line 20415
    invoke-direct {v9, v11}, Lcom/android/server/pm/PackageManagerService;->shouldKeepUninstalledPackageLPr(Ljava/lang/String;)Z

    move-result v2

    .line 20416
    .local v2, "keepUninstalledPackage":Z
    sget-object v3, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v3}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v3

    invoke-virtual {v13, v3}, Lcom/android/server/pm/PackageSetting;->isAnyInstalled([I)Z

    move-result v3

    if-nez v3, :cond_b4

    if-eqz v2, :cond_9f

    goto :goto_b4

    .line 20425
    :cond_9f
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v3, :cond_aa

    const-string v3, "PackageManager"

    const-string v4, "Not installed by other users, full delete"

    invoke-static {v3, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20426
    :cond_aa
    invoke-virtual {v13, v0, v7}, Lcom/android/server/pm/PackageSetting;->setInstalled(ZI)V

    .line 20427
    iget-object v3, v9, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, v13}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V

    .line 20428
    const/4 v2, 0x0

    .local v2, "clearPackageStateAndReturn":Z
    goto :goto_c1

    .line 20420
    .local v2, "keepUninstalledPackage":Z
    :cond_b4
    :goto_b4
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v3, :cond_bf

    const-string v3, "PackageManager"

    const-string v4, "Still installed by other users"

    invoke-static {v3, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20421
    :cond_bf
    const/4 v3, 0x1

    move v2, v3

    .line 20430
    .local v2, "clearPackageStateAndReturn":Z
    :goto_c1
    goto :goto_e2

    .line 20435
    .end local v2  # "clearPackageStateAndReturn":Z
    :cond_c2
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v2, :cond_cd

    const-string v2, "PackageManager"

    const-string v3, "Deleting system app"

    invoke-static {v2, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20438
    :cond_cd
    iget-boolean v2, v13, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    if-eqz v2, :cond_e1

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->inCts()Z

    move-result v2

    if-nez v2, :cond_e1

    .line 20439
    const/4 v2, 0x0

    .line 20440
    .restart local v2  # "clearPackageStateAndReturn":Z
    invoke-virtual {v13, v0, v7}, Lcom/android/server/pm/PackageSetting;->setInstalled(ZI)V

    .line 20441
    iget-object v3, v9, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, v13}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V

    goto :goto_e2

    .line 20443
    .end local v2  # "clearPackageStateAndReturn":Z
    :cond_e1
    move v2, v0

    .line 20447
    .restart local v2  # "clearPackageStateAndReturn":Z
    :goto_e2
    monitor-exit v1
    :try_end_e3
    .catchall {:try_start_87 .. :try_end_e3} :catchall_f3

    .line 20448
    if-eqz v2, :cond_f6

    .line 20449
    invoke-direct {v9, v13, v7, v14, v8}, Lcom/android/server/pm/PackageManagerService;->clearPackageStateForUserLIF(Lcom/android/server/pm/PackageSetting;ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;I)V

    .line 20450
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20451
    :try_start_eb
    invoke-virtual {v9, v15}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(Landroid/os/UserHandle;)V

    .line 20452
    monitor-exit v1

    .line 20453
    return-void

    .line 20452
    :catchall_f0
    move-exception v0

    monitor-exit v1
    :try_end_f2
    .catchall {:try_start_eb .. :try_end_f2} :catchall_f0

    throw v0

    .line 20447
    .end local v2  # "clearPackageStateAndReturn":Z
    :catchall_f3
    move-exception v0

    :try_start_f4
    monitor-exit v1
    :try_end_f5
    .catchall {:try_start_f4 .. :try_end_f5} :catchall_f3

    throw v0

    .line 20459
    :cond_f6
    iget-object v1, v13, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v1, :cond_146

    if-eqz v14, :cond_146

    .line 20460
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20461
    :try_start_ff
    iget-object v2, v13, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v2

    .line 20462
    .local v2, "childCount":I
    new-instance v3, Landroid/util/ArrayMap;

    invoke-direct {v3, v2}, Landroid/util/ArrayMap;-><init>(I)V

    iput-object v3, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    .line 20463
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_10d
    if-ge v3, v2, :cond_13f

    .line 20464
    iget-object v4, v13, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v4, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/String;

    .line 20465
    .local v4, "childPackageName":Ljava/lang/String;
    new-instance v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    invoke-direct {v5, v9}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;-><init>(Lcom/android/server/pm/PackageSender;)V

    .line 20466
    .local v5, "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    iput-object v4, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    .line 20467
    iget-object v6, v13, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    iput-object v6, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installerPackageName:Ljava/lang/String;

    .line 20468
    iget-object v6, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    invoke-virtual {v6, v4, v5}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 20469
    iget-object v6, v9, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v6, v4}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v6

    .line 20470
    .local v6, "childPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v6, :cond_138

    .line 20471
    move/from16 v17, v2

    .end local v2  # "childCount":I
    .local v17, "childCount":I
    invoke-virtual {v6, v12, v0}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v2

    iput-object v2, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->origUsers:[I

    goto :goto_13a

    .line 20470
    .end local v17  # "childCount":I
    .restart local v2  # "childCount":I
    :cond_138
    move/from16 v17, v2

    .line 20463
    .end local v2  # "childCount":I
    .end local v4  # "childPackageName":Ljava/lang/String;
    .end local v5  # "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v6  # "childPs":Lcom/android/server/pm/PackageSetting;
    .restart local v17  # "childCount":I
    :goto_13a
    add-int/lit8 v3, v3, 0x1

    move/from16 v2, v17

    goto :goto_10d

    .end local v17  # "childCount":I
    .restart local v2  # "childCount":I
    :cond_13f
    move/from16 v17, v2

    .line 20474
    .end local v2  # "childCount":I
    .end local v3  # "i":I
    monitor-exit v1

    goto :goto_146

    :catchall_143
    move-exception v0

    monitor-exit v1
    :try_end_145
    .catchall {:try_start_ff .. :try_end_145} :catchall_143

    throw v0

    .line 20478
    :cond_146
    :goto_146
    if-eqz v16, :cond_199

    .line 20479
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v1, :cond_164

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Removing system package: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20484
    :cond_164
    iget-boolean v1, v13, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    if-eqz v1, :cond_185

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->inCts()Z

    move-result v1

    if-nez v1, :cond_185

    .line 20485
    const/16 v17, 0x0

    move-object/from16 v1, p0

    move-object v2, v13

    move/from16 v3, p3

    move v4, v8

    move-object/from16 v5, p4

    move-object v6, v14

    move/from16 v18, v7

    .end local v7  # "userId":I
    .local v18, "userId":I
    move/from16 v7, p5

    move/from16 v19, v8

    .end local v8  # "flags":I
    .local v19, "flags":I
    move-object/from16 v8, v17

    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->deleteInstalledPackageLIF(Lcom/android/server/pm/PackageSetting;ZI[ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ZLandroid/content/pm/PackageParser$Package;)V

    goto :goto_1ca

    .line 20484
    .end local v18  # "userId":I
    .end local v19  # "flags":I
    .restart local v7  # "userId":I
    .restart local v8  # "flags":I
    :cond_185
    move/from16 v18, v7

    move/from16 v19, v8

    .line 20488
    .end local v7  # "userId":I
    .end local v8  # "flags":I
    .restart local v18  # "userId":I
    .restart local v19  # "flags":I
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move-object v3, v13

    move-object/from16 v4, p4

    move/from16 v5, v19

    move-object v6, v14

    move/from16 v7, p5

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->deleteSystemPackageLIF(Lcom/android/server/pm/PackageManagerService$DeletePackageAction;Lcom/android/server/pm/PackageSetting;[IILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;Z)V

    goto :goto_1ca

    .line 20492
    .end local v18  # "userId":I
    .end local v19  # "flags":I
    .restart local v7  # "userId":I
    .restart local v8  # "flags":I
    :cond_199
    move/from16 v18, v7

    move/from16 v19, v8

    .end local v7  # "userId":I
    .end local v8  # "flags":I
    .restart local v18  # "userId":I
    .restart local v19  # "flags":I
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v1, :cond_1b9

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Removing non-system package: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20493
    :cond_1b9
    move-object/from16 v1, p0

    move-object v2, v13

    move/from16 v3, p3

    move/from16 v4, v19

    move-object/from16 v5, p4

    move-object v6, v14

    move/from16 v7, p5

    move-object/from16 v8, p6

    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->deleteInstalledPackageLIF(Lcom/android/server/pm/PackageSetting;ZI[ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ZLandroid/content/pm/PackageParser$Package;)V

    .line 20498
    :goto_1ca
    if-eqz v14, :cond_286

    .line 20499
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    const/4 v2, 0x0

    if-nez v1, :cond_1d9

    move v1, v0

    goto :goto_1da

    :cond_1d9
    move v1, v2

    :goto_1da
    iput-boolean v1, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedForAllUsers:Z

    .line 20500
    iget-object v1, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    if-eqz v1, :cond_20d

    .line 20501
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20502
    :try_start_1e3
    iget-object v3, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->size()I

    move-result v3

    .line 20503
    .local v3, "childCount":I
    const/4 v4, 0x0

    .local v4, "i":I
    :goto_1ea
    if-ge v4, v3, :cond_208

    .line 20504
    iget-object v5, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v4}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    .line 20505
    .restart local v5  # "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    if-eqz v5, :cond_205

    .line 20506
    iget-object v6, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v7, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    invoke-virtual {v6, v7}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    if-nez v6, :cond_202

    move v6, v0

    goto :goto_203

    :cond_202
    move v6, v2

    :goto_203
    iput-boolean v6, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedForAllUsers:Z

    .line 20503
    .end local v5  # "childInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :cond_205
    add-int/lit8 v4, v4, 0x1

    goto :goto_1ea

    .line 20510
    .end local v3  # "childCount":I
    .end local v4  # "i":I
    :cond_208
    monitor-exit v1

    goto :goto_20d

    :catchall_20a
    move-exception v0

    monitor-exit v1
    :try_end_20c
    .catchall {:try_start_1e3 .. :try_end_20c} :catchall_20a

    throw v0

    .line 20517
    :cond_20d
    :goto_20d
    if-eqz v16, :cond_286

    iget-boolean v1, v13, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    if-eqz v1, :cond_219

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->inCts()Z

    move-result v1

    if-eqz v1, :cond_286

    .line 20519
    :cond_219
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 20520
    :try_start_21c
    iget-object v3, v9, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v13, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v3, v4}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v3

    .line 20521
    .local v3, "updatedPs":Lcom/android/server/pm/PackageSetting;
    iget-object v4, v3, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v4, :cond_22e

    .line 20522
    iget-object v2, v3, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v2

    :cond_22e
    nop

    .line 20523
    .restart local v2  # "childCount":I
    const/4 v4, 0x0

    .restart local v4  # "i":I
    :goto_230
    if-ge v4, v2, :cond_281

    .line 20524
    iget-object v5, v3, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v5, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/String;

    .line 20525
    .local v5, "childPackageName":Ljava/lang/String;
    iget-object v6, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    if-eqz v6, :cond_246

    iget-object v6, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    .line 20526
    invoke-virtual {v6, v5}, Landroid/util/ArrayMap;->indexOfKey(Ljava/lang/Object;)I

    move-result v6

    if-gez v6, :cond_27e

    .line 20527
    :cond_246
    iget-object v6, v9, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v6, v5}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v6

    .line 20528
    .restart local v6  # "childPs":Lcom/android/server/pm/PackageSetting;
    if-nez v6, :cond_24f

    .line 20529
    goto :goto_27e

    .line 20531
    :cond_24f
    new-instance v7, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    invoke-direct {v7}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;-><init>()V

    .line 20532
    .local v7, "installRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    iput-object v5, v7, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->name:Ljava/lang/String;

    .line 20533
    invoke-virtual {v6, v12, v0}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v8

    iput-object v8, v7, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    .line 20534
    iget-object v8, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v8, v5}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/pm/PackageParser$Package;

    iput-object v8, v7, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 20535
    iget-object v8, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v8, v8, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v8, v7, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->uid:I

    .line 20536
    iget-object v8, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->appearedChildPackages:Landroid/util/ArrayMap;

    if-nez v8, :cond_279

    .line 20537
    new-instance v8, Landroid/util/ArrayMap;

    invoke-direct {v8}, Landroid/util/ArrayMap;-><init>()V

    iput-object v8, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->appearedChildPackages:Landroid/util/ArrayMap;

    .line 20539
    :cond_279
    iget-object v8, v14, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->appearedChildPackages:Landroid/util/ArrayMap;

    invoke-virtual {v8, v5, v7}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 20523
    .end local v5  # "childPackageName":Ljava/lang/String;
    .end local v6  # "childPs":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "installRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :cond_27e
    :goto_27e
    add-int/lit8 v4, v4, 0x1

    goto :goto_230

    .line 20542
    .end local v2  # "childCount":I
    .end local v3  # "updatedPs":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "i":I
    :cond_281
    monitor-exit v1

    goto :goto_286

    :catchall_283
    move-exception v0

    monitor-exit v1
    :try_end_285
    .catchall {:try_start_21c .. :try_end_285} :catchall_283

    throw v0

    .line 20545
    :cond_286
    :goto_286
    return-void
.end method

.method private executePostCommitSteps(Lcom/android/server/pm/PackageManagerService$CommitRequest;)V
    .registers 20
    .param p1, "commitRequest"  # Lcom/android/server/pm/PackageManagerService$CommitRequest;

    .line 17787
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService$CommitRequest;->reconciledPackages:Ljava/util/Map;

    invoke-interface {v2}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_e
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_bf

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;

    .line 17788
    .local v3, "reconciledPkg":Lcom/android/server/pm/PackageManagerService$ReconciledPackage;
    iget-object v4, v3, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->scanResult:Lcom/android/server/pm/PackageManagerService$ScanResult;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget v4, v4, Lcom/android/server/pm/PackageManagerService$ScanRequest;->scanFlags:I

    and-int/lit16 v4, v4, 0x4000

    const/4 v5, 0x1

    const/4 v6, 0x0

    if-eqz v4, :cond_28

    move v4, v5

    goto :goto_29

    :cond_28
    move v4, v6

    .line 17790
    .local v4, "instantApp":Z
    :goto_29
    iget-object v7, v3, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v7, v7, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 17791
    .local v7, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v14, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 17792
    .local v14, "packageName":Ljava/lang/String;
    invoke-direct {v0, v7}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataAfterInstallLIF(Landroid/content/pm/PackageParser$Package;)V

    .line 17793
    iget-object v8, v3, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->prepareResult:Lcom/android/server/pm/PackageManagerService$PrepareResult;

    iget-boolean v8, v8, Lcom/android/server/pm/PackageManagerService$PrepareResult;->clearCodeCache:Z

    if-eqz v8, :cond_3e

    .line 17794
    const/4 v8, -0x1

    const/16 v9, 0x27

    invoke-direct {v0, v7, v8, v9}, Lcom/android/server/pm/PackageManagerService;->clearAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 17797
    :cond_3e
    iget-object v8, v3, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->prepareResult:Lcom/android/server/pm/PackageManagerService$PrepareResult;

    iget-boolean v8, v8, Lcom/android/server/pm/PackageManagerService$PrepareResult;->replace:Z

    if-eqz v8, :cond_4f

    .line 17798
    iget-object v8, v0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    iget-object v9, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v10, v7, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    iget-object v11, v7, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    invoke-virtual {v8, v9, v10, v11}, Lcom/android/server/pm/dex/DexManager;->notifyPackageUpdated(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)V

    .line 17805
    :cond_4f
    iget-object v8, v0, Lcom/android/server/pm/PackageManagerService;->mArtManagerService:Lcom/android/server/pm/dex/ArtManagerService;

    iget-object v9, v3, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->installArgs:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v9, v9, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;

    .line 17807
    invoke-virtual {v9}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v9

    invoke-direct {v0, v9}, Lcom/android/server/pm/PackageManagerService;->resolveUserIds(I)[I

    move-result-object v9

    .line 17805
    invoke-virtual {v8, v7, v9, v5}, Lcom/android/server/pm/dex/ArtManagerService;->prepareAppProfiles(Landroid/content/pm/PackageParser$Package;[IZ)V

    .line 17829
    const/4 v8, 0x2

    if-eqz v4, :cond_72

    iget-object v9, v0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 17830
    invoke-virtual {v9}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v9

    const-string/jumbo v10, "instant_app_dexopt_enabled"

    invoke-static {v9, v10, v6}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v9

    if-eqz v9, :cond_7a

    :cond_72
    iget-object v9, v7, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/2addr v9, v8

    if-nez v9, :cond_7a

    goto :goto_7b

    :cond_7a
    move v5, v6

    .line 17834
    .local v5, "performDexopt":Z
    :goto_7b
    if-eqz v5, :cond_ba

    .line 17836
    const-string/jumbo v9, "pm.precompile_layouts"

    invoke-static {v9, v6}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z

    move-result v6

    const-wide/32 v11, 0x40000

    if-eqz v6, :cond_96

    .line 17837
    const-string v6, "compileLayouts"

    invoke-static {v11, v12, v6}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 17838
    iget-object v6, v0, Lcom/android/server/pm/PackageManagerService;->mViewCompiler:Lcom/android/server/pm/dex/ViewCompiler;

    invoke-virtual {v6, v7}, Lcom/android/server/pm/dex/ViewCompiler;->compileLayouts(Landroid/content/pm/PackageParser$Package;)Z

    .line 17839
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V

    .line 17842
    :cond_96
    const-string v6, "dexopt"

    invoke-static {v11, v12, v6}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 17847
    new-instance v13, Lcom/android/server/pm/dex/DexoptOptions;

    const/16 v6, 0x404

    invoke-direct {v13, v14, v8, v6}, Lcom/android/server/pm/dex/DexoptOptions;-><init>(Ljava/lang/String;II)V

    .line 17851
    .local v13, "dexoptOptions":Lcom/android/server/pm/dex/DexoptOptions;
    iget-object v8, v0, Lcom/android/server/pm/PackageManagerService;->mPackageDexOptimizer:Lcom/android/server/pm/PackageDexOptimizer;

    const/4 v10, 0x0

    .line 17853
    invoke-virtual {v0, v7}, Lcom/android/server/pm/PackageManagerService;->getOrCreateCompilerPackageStats(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/CompilerStats$PackageStats;

    move-result-object v6

    iget-object v9, v0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    .line 17854
    invoke-virtual {v9, v14}, Lcom/android/server/pm/dex/DexManager;->getPackageUseInfoOrDefault(Ljava/lang/String;)Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;

    move-result-object v15

    .line 17851
    move-object v9, v7

    move-wide/from16 v16, v11

    move-object v11, v6

    move-object v12, v15

    invoke-virtual/range {v8 .. v13}, Lcom/android/server/pm/PackageDexOptimizer;->performDexOpt(Landroid/content/pm/PackageParser$Package;[Ljava/lang/String;Lcom/android/server/pm/CompilerStats$PackageStats;Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;Lcom/android/server/pm/dex/DexoptOptions;)I

    .line 17856
    invoke-static/range {v16 .. v17}, Landroid/os/Trace;->traceEnd(J)V

    .line 17863
    .end local v13  # "dexoptOptions":Lcom/android/server/pm/dex/DexoptOptions;
    :cond_ba
    invoke-static {v14}, Lcom/android/server/pm/BackgroundDexOptService;->notifyPackageChanged(Ljava/lang/String;)V

    .line 17864
    .end local v3  # "reconciledPkg":Lcom/android/server/pm/PackageManagerService$ReconciledPackage;
    .end local v4  # "instantApp":Z
    .end local v5  # "performDexopt":Z
    .end local v7  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v14  # "packageName":Ljava/lang/String;
    goto/16 :goto_e

    .line 17865
    :cond_bf
    return-void
.end method

.method private executeSharedLibrariesUpdateLPr(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/ArrayList;)V
    .registers 7
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "changingLib"  # Landroid/content/pm/PackageParser$Package;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageParser$Package;",
            "Landroid/content/pm/PackageParser$Package;",
            "Ljava/util/ArrayList<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;)V"
        }
    .end annotation

    .line 10995
    .local p3, "usesLibraryInfos":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    sget-object v0, Lcom/android/server/pm/-$$Lambda$PackageManagerService$JUo3M6zuPH65x1voKjSOJvOMHRw;->INSTANCE:Lcom/android/server/pm/-$$Lambda$PackageManagerService$JUo3M6zuPH65x1voKjSOJvOMHRw;

    const/4 v1, 0x0

    invoke-direct {p0, p1, v1, v0}, Lcom/android/server/pm/PackageManagerService;->applyDefiningSharedLibraryUpdateLocked(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/SharedLibraryInfo;Ljava/util/function/BiConsumer;)V

    .line 10998
    if-eqz p3, :cond_32

    .line 10999
    iput-object p3, p1, Landroid/content/pm/PackageParser$Package;->usesLibraryInfos:Ljava/util/ArrayList;

    .line 11002
    new-instance v0, Ljava/util/LinkedHashSet;

    invoke-direct {v0}, Ljava/util/LinkedHashSet;-><init>()V

    .line 11003
    .local v0, "usesLibraryFiles":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    invoke-virtual {p3}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_13
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_23

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/SharedLibraryInfo;

    .line 11004
    .local v2, "libInfo":Landroid/content/pm/SharedLibraryInfo;
    invoke-direct {p0, p1, v0, v2, p2}, Lcom/android/server/pm/PackageManagerService;->addSharedLibraryLPr(Landroid/content/pm/PackageParser$Package;Ljava/util/Set;Landroid/content/pm/SharedLibraryInfo;Landroid/content/pm/PackageParser$Package;)V

    .line 11005
    .end local v2  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    goto :goto_13

    .line 11006
    :cond_23
    invoke-interface {v0}, Ljava/util/Set;->size()I

    move-result v1

    new-array v1, v1, [Ljava/lang/String;

    invoke-interface {v0, v1}, Ljava/util/Set;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v1

    check-cast v1, [Ljava/lang/String;

    iput-object v1, p1, Landroid/content/pm/PackageParser$Package;->usesLibraryFiles:[Ljava/lang/String;

    .line 11007
    .end local v0  # "usesLibraryFiles":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    goto :goto_36

    .line 11008
    :cond_32
    iput-object v1, p1, Landroid/content/pm/PackageParser$Package;->usesLibraryInfos:Ljava/util/ArrayList;

    .line 11009
    iput-object v1, p1, Landroid/content/pm/PackageParser$Package;->usesLibraryFiles:[Ljava/lang/String;

    .line 11011
    :goto_36
    return-void
.end method

.method private filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z
    .registers 10
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "callingUid"  # I
    .param p3, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 4637
    const/4 v3, 0x0

    const/4 v4, 0x0

    move-object v0, p0

    move-object v1, p1

    move v2, p2

    move v5, p3

    invoke-direct/range {v0 .. v5}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v0

    return v0
.end method

.method private filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z
    .registers 12
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "callingUid"  # I
    .param p3, "component"  # Landroid/content/ComponentName;
    .param p4, "componentType"  # I
    .param p5, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 4581
    invoke-static {p2}, Landroid/os/Process;->isIsolated(I)Z

    move-result v0

    if-eqz v0, :cond_c

    .line 4582
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mIsolatedOwners:Landroid/util/SparseIntArray;

    invoke-virtual {v0, p2}, Landroid/util/SparseIntArray;->get(I)I

    move-result p2

    .line 4584
    :cond_c
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    .line 4585
    .local v0, "instantAppPkgName":Ljava/lang/String;
    const/4 v1, 0x0

    const/4 v2, 0x1

    if-eqz v0, :cond_16

    move v3, v2

    goto :goto_17

    :cond_16
    move v3, v1

    .line 4586
    .local v3, "callerIsInstantApp":Z
    :goto_17
    if-nez p1, :cond_1d

    .line 4587
    if-eqz v3, :cond_1c

    .line 4589
    return v2

    .line 4591
    :cond_1c
    return v1

    .line 4594
    :cond_1d
    iget-object v4, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-direct {p0, v4, p2}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v4

    if-eqz v4, :cond_26

    .line 4595
    return v1

    .line 4597
    :cond_26
    if-eqz v3, :cond_52

    .line 4599
    invoke-virtual {p1, p5}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v4

    if-eqz v4, :cond_2f

    .line 4600
    return v2

    .line 4604
    :cond_2f
    if-eqz p3, :cond_4c

    .line 4605
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstrumentation:Landroid/util/ArrayMap;

    .line 4606
    invoke-virtual {v4, p3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/PackageParser$Instrumentation;

    .line 4607
    .local v4, "instrumentation":Landroid/content/pm/PackageParser$Instrumentation;
    if-eqz v4, :cond_46

    iget-object v5, v4, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v5, v5, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    .line 4608
    invoke-direct {p0, v5, p2}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v5

    if-eqz v5, :cond_46

    .line 4609
    return v1

    .line 4611
    :cond_46
    invoke-direct {p0, p3, p4}, Lcom/android/server/pm/PackageManagerService;->isComponentVisibleToInstantApp(Landroid/content/ComponentName;I)Z

    move-result v1

    xor-int/2addr v1, v2

    return v1

    .line 4614
    .end local v4  # "instrumentation":Landroid/content/pm/PackageParser$Instrumentation;
    :cond_4c
    iget-object v1, p1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-boolean v1, v1, Landroid/content/pm/PackageParser$Package;->visibleToInstantApps:Z

    xor-int/2addr v1, v2

    return v1

    .line 4616
    :cond_52
    invoke-virtual {p1, p5}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v4

    if-eqz v4, :cond_70

    .line 4618
    invoke-direct {p0, p2, p5}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v4

    if-eqz v4, :cond_5f

    .line 4619
    return v1

    .line 4622
    :cond_5f
    if-eqz p3, :cond_62

    .line 4623
    return v2

    .line 4626
    :cond_62
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    .line 4627
    invoke-static {p2}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v4

    iget v5, p1, Lcom/android/server/pm/PackageSetting;->appId:I

    .line 4626
    invoke-virtual {v1, p5, v4, v5}, Lcom/android/server/pm/InstantAppRegistry;->isInstantAccessGranted(III)Z

    move-result v1

    xor-int/2addr v1, v2

    return v1

    .line 4629
    :cond_70
    return v1
.end method

.method private filterCandidatesWithDomainPreferredActivitiesLPr(Landroid/content/Intent;ILjava/util/List;Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;I)Ljava/util/List;
    .registers 33
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "matchFlags"  # I
    .param p4, "xpDomainInfo"  # Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .param p5, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "I",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;",
            "Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;",
            "I)",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8038
    .local p3, "candidates":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    move-object/from16 v1, p0

    move-object/from16 v2, p3

    move-object/from16 v3, p4

    move/from16 v4, p5

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getFlags()I

    move-result v0

    and-int/lit8 v0, v0, 0x8

    if-eqz v0, :cond_12

    const/4 v0, 0x1

    goto :goto_13

    :cond_12
    const/4 v0, 0x0

    :goto_13
    move v7, v0

    .line 8040
    .local v7, "debug":Z
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v0, :cond_1c

    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v0, :cond_36

    .line 8041
    :cond_1c
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Filtering results with preferred activities. Candidates count: "

    invoke-virtual {v0, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 8042
    invoke-interface/range {p3 .. p3}, Ljava/util/List;->size()I

    move-result v8

    invoke-virtual {v0, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 8041
    const-string v8, "PackageManager"

    invoke-static {v8, v0}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8045
    :cond_36
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    move-object v8, v0

    .line 8046
    .local v8, "result":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ResolveInfo;>;"
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    move-object v9, v0

    .line 8047
    .local v9, "alwaysList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ResolveInfo;>;"
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    move-object v10, v0

    .line 8048
    .local v10, "undefinedList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ResolveInfo;>;"
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    move-object v11, v0

    .line 8049
    .local v11, "alwaysAskList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ResolveInfo;>;"
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    move-object v12, v0

    .line 8050
    .local v12, "neverList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ResolveInfo;>;"
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    move-object v13, v0

    .line 8052
    .local v13, "matchAllList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ResolveInfo;>;"
    iget-object v14, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v14

    .line 8053
    :try_start_5d
    invoke-interface/range {p3 .. p3}, Ljava/util/List;->size()I

    move-result v0
    :try_end_61
    .catchall {:try_start_5d .. :try_end_61} :catchall_2a6

    .line 8057
    .local v0, "count":I
    const/4 v15, 0x0

    .local v15, "n":I
    :goto_62
    if-ge v15, v0, :cond_156

    .line 8058
    :try_start_64
    invoke-interface {v2, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v17

    check-cast v17, Landroid/content/pm/ResolveInfo;

    move-object/from16 v18, v17

    .line 8059
    .local v18, "info":Landroid/content/pm/ResolveInfo;
    move-object/from16 v6, v18

    .end local v18  # "info":Landroid/content/pm/ResolveInfo;
    .local v6, "info":Landroid/content/pm/ResolveInfo;
    iget-object v5, v6, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    .line 8060
    .local v5, "packageName":Ljava/lang/String;
    move/from16 v19, v0

    .end local v0  # "count":I
    .local v19, "count":I
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v5}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 8061
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_146

    .line 8063
    move-object/from16 v20, v5

    .end local v5  # "packageName":Ljava/lang/String;
    .local v20, "packageName":Ljava/lang/String;
    iget-boolean v5, v6, Landroid/content/pm/ResolveInfo;->handleAllWebDataURI:Z
    :try_end_84
    .catchall {:try_start_64 .. :try_end_84} :catchall_2a2

    if-eqz v5, :cond_8b

    .line 8064
    :try_start_86
    invoke-virtual {v13, v6}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_89
    .catchall {:try_start_86 .. :try_end_89} :catchall_2a6

    .line 8065
    goto/16 :goto_14a

    .line 8068
    :cond_8b
    :try_start_8b
    invoke-direct {v1, v0, v4}, Lcom/android/server/pm/PackageManagerService;->getDomainVerificationStatusLPr(Lcom/android/server/pm/PackageSetting;I)J

    move-result-wide v21

    .line 8069
    .local v21, "packedStatus":J
    const/16 v5, 0x20

    move-object/from16 v23, v0

    .end local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v23, "ps":Lcom/android/server/pm/PackageSetting;
    shr-long v0, v21, v5

    long-to-int v0, v0

    .line 8070
    .local v0, "status":I
    const-wide/16 v24, -0x1

    and-long v1, v21, v24

    long-to-int v1, v1

    .line 8071
    .local v1, "linkGeneration":I
    const/4 v2, 0x2

    if-ne v0, v2, :cond_cd

    .line 8072
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-nez v2, :cond_a4

    if-eqz v7, :cond_c6

    .line 8073
    :cond_a4
    const-string v2, "PackageManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  + always: "

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v6, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " : linkgen="

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v2, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8078
    :cond_c6
    iput v1, v6, Landroid/content/pm/ResolveInfo;->preferredOrder:I

    .line 8079
    invoke-virtual {v9, v6}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto/16 :goto_14a

    .line 8080
    :cond_cd
    const/4 v2, 0x3

    if-ne v0, v2, :cond_f4

    .line 8081
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-nez v2, :cond_d6

    if-eqz v7, :cond_f0

    .line 8082
    :cond_d6
    const-string v2, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "  + never: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v6, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v2, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8084
    :cond_f0
    invoke-virtual {v12, v6}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_14a

    .line 8085
    :cond_f4
    const/4 v2, 0x4

    if-ne v0, v2, :cond_11b

    .line 8086
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-nez v2, :cond_fd

    if-eqz v7, :cond_117

    .line 8087
    :cond_fd
    const-string v2, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "  + always-ask: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v6, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v2, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8089
    :cond_117
    invoke-virtual {v11, v6}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_14a

    .line 8090
    :cond_11b
    if-eqz v0, :cond_121

    const/4 v2, 0x1

    if-ne v0, v2, :cond_14a

    goto :goto_122

    :cond_121
    const/4 v2, 0x1

    .line 8092
    :goto_122
    sget-boolean v4, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-nez v4, :cond_128

    if-eqz v7, :cond_142

    .line 8093
    :cond_128
    const-string v4, "PackageManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "  + ask: "

    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v6, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v4, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8095
    :cond_142
    invoke-virtual {v10, v6}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_14a

    .line 8061
    .end local v1  # "linkGeneration":I
    .end local v20  # "packageName":Ljava/lang/String;
    .end local v21  # "packedStatus":J
    .end local v23  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "packageName":Ljava/lang/String;
    :cond_146
    move-object/from16 v23, v0

    move-object/from16 v20, v5

    .line 8057
    .end local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "packageName":Ljava/lang/String;
    .end local v6  # "info":Landroid/content/pm/ResolveInfo;
    :cond_14a
    :goto_14a
    add-int/lit8 v15, v15, 0x1

    move-object/from16 v1, p0

    move-object/from16 v2, p3

    move/from16 v4, p5

    move/from16 v0, v19

    goto/16 :goto_62

    .end local v19  # "count":I
    .local v0, "count":I
    :cond_156
    move/from16 v19, v0

    .line 8101
    .end local v0  # "count":I
    .end local v15  # "n":I
    .restart local v19  # "count":I
    const/4 v0, 0x0

    .line 8104
    .local v0, "includeBrowser":Z
    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_163

    .line 8105
    invoke-virtual {v8, v9}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    goto :goto_173

    .line 8108
    :cond_163
    invoke-virtual {v8, v10}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    .line 8110
    if-eqz v3, :cond_172

    iget v1, v3, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;->bestDomainVerificationStatus:I

    const/4 v2, 0x3

    if-eq v1, v2, :cond_172

    .line 8113
    iget-object v1, v3, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;->resolveInfo:Landroid/content/pm/ResolveInfo;

    invoke-virtual {v8, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 8115
    :cond_172
    const/4 v0, 0x1

    .line 8121
    :goto_173
    invoke-virtual {v11}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_191

    .line 8122
    invoke-virtual {v8}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_17d
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_18d

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ResolveInfo;

    .line 8123
    .local v2, "i":Landroid/content/pm/ResolveInfo;
    const/4 v4, 0x0

    iput v4, v2, Landroid/content/pm/ResolveInfo;->preferredOrder:I

    .line 8124
    .end local v2  # "i":Landroid/content/pm/ResolveInfo;
    goto :goto_17d

    .line 8125
    :cond_18d
    invoke-virtual {v8, v11}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    .line 8126
    const/4 v0, 0x1

    .line 8129
    :cond_191
    if-eqz v0, :cond_251

    .line 8131
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v1, :cond_19e

    .line 8132
    const-string v1, "PackageManager"

    const-string v2, "   ...including browsers in candidate set"

    invoke-static {v1, v2}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8134
    :cond_19e
    const/high16 v1, 0x20000

    and-int v1, p2, v1

    if-eqz v1, :cond_1ab

    .line 8135
    invoke-virtual {v8, v13}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    move/from16 v16, v0

    goto/16 :goto_23f

    .line 8139
    :cond_1ab
    move-object/from16 v1, p0

    move/from16 v2, p5

    invoke-virtual {v1, v2}, Lcom/android/server/pm/PackageManagerService;->getDefaultBrowserPackageName(I)Ljava/lang/String;

    move-result-object v4

    .line 8140
    .local v4, "defaultBrowserPackageName":Ljava/lang/String;
    const/4 v5, 0x0

    .line 8141
    .local v5, "maxMatchPrio":I
    const/4 v6, 0x0

    .line 8142
    .local v6, "defaultBrowserMatch":Landroid/content/pm/ResolveInfo;
    invoke-virtual {v13}, Ljava/util/ArrayList;->size()I

    move-result v15

    .line 8143
    .local v15, "numCandidates":I
    const/16 v16, 0x0

    move/from16 v26, v16

    move/from16 v16, v0

    move v0, v5

    move/from16 v5, v26

    .local v0, "maxMatchPrio":I
    .local v5, "n":I
    .local v16, "includeBrowser":Z
    :goto_1c2
    if-ge v5, v15, :cond_214

    .line 8144
    invoke-virtual {v13, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v17

    check-cast v17, Landroid/content/pm/ResolveInfo;

    move-object/from16 v18, v17

    .line 8146
    .restart local v18  # "info":Landroid/content/pm/ResolveInfo;
    move-object/from16 v1, v18

    .end local v18  # "info":Landroid/content/pm/ResolveInfo;
    .local v1, "info":Landroid/content/pm/ResolveInfo;
    iget v2, v1, Landroid/content/pm/ResolveInfo;->priority:I

    if-le v2, v0, :cond_1d5

    .line 8147
    iget v2, v1, Landroid/content/pm/ResolveInfo;->priority:I

    move v0, v2

    .line 8150
    :cond_1d5
    iget-object v2, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_207

    .line 8151
    if-eqz v6, :cond_1ea

    iget v2, v6, Landroid/content/pm/ResolveInfo;->priority:I

    move/from16 v17, v0

    .end local v0  # "maxMatchPrio":I
    .local v17, "maxMatchPrio":I
    iget v0, v1, Landroid/content/pm/ResolveInfo;->priority:I

    if-ge v2, v0, :cond_209

    goto :goto_1ec

    .end local v17  # "maxMatchPrio":I
    .restart local v0  # "maxMatchPrio":I
    :cond_1ea
    move/from16 v17, v0

    .line 8153
    .end local v0  # "maxMatchPrio":I
    .restart local v17  # "maxMatchPrio":I
    :goto_1ec
    if-eqz v7, :cond_204

    .line 8154
    const-string v0, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Considering default browser match "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8156
    :cond_204
    move-object v0, v1

    move-object v6, v0

    .end local v6  # "defaultBrowserMatch":Landroid/content/pm/ResolveInfo;
    .local v0, "defaultBrowserMatch":Landroid/content/pm/ResolveInfo;
    goto :goto_209

    .line 8150
    .end local v17  # "maxMatchPrio":I
    .local v0, "maxMatchPrio":I
    .restart local v6  # "defaultBrowserMatch":Landroid/content/pm/ResolveInfo;
    :cond_207
    move/from16 v17, v0

    .line 8143
    .end local v0  # "maxMatchPrio":I
    .end local v1  # "info":Landroid/content/pm/ResolveInfo;
    .restart local v17  # "maxMatchPrio":I
    :cond_209
    :goto_209
    add-int/lit8 v5, v5, 0x1

    move-object/from16 v1, p0

    move-object/from16 v3, p4

    move/from16 v2, p5

    move/from16 v0, v17

    goto :goto_1c2

    .line 8160
    .end local v5  # "n":I
    .end local v17  # "maxMatchPrio":I
    .restart local v0  # "maxMatchPrio":I
    :cond_214
    if-eqz v6, :cond_23c

    iget v1, v6, Landroid/content/pm/ResolveInfo;->priority:I

    if-lt v1, v0, :cond_23c

    .line 8162
    invoke-static {v4}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v1

    if-nez v1, :cond_23c

    .line 8164
    if-eqz v7, :cond_238

    .line 8165
    const-string v1, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Default browser match "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8167
    :cond_238
    invoke-virtual {v8, v6}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_23f

    .line 8169
    :cond_23c
    invoke-virtual {v8, v13}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    .line 8175
    .end local v0  # "maxMatchPrio":I
    .end local v4  # "defaultBrowserPackageName":Ljava/lang/String;
    .end local v6  # "defaultBrowserMatch":Landroid/content/pm/ResolveInfo;
    .end local v15  # "numCandidates":I
    :goto_23f
    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v0
    :try_end_243
    .catchall {:try_start_8b .. :try_end_243} :catchall_2a2

    if-nez v0, :cond_24e

    .line 8176
    move-object/from16 v1, p3

    :try_start_247
    invoke-virtual {v8, v1}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    .line 8177
    invoke-virtual {v8, v12}, Ljava/util/ArrayList;->removeAll(Ljava/util/Collection;)Z

    goto :goto_255

    .line 8175
    :cond_24e
    move-object/from16 v1, p3

    goto :goto_255

    .line 8129
    .end local v16  # "includeBrowser":Z
    .local v0, "includeBrowser":Z
    :cond_251
    move-object/from16 v1, p3

    move/from16 v16, v0

    .line 8180
    .end local v0  # "includeBrowser":Z
    .end local v19  # "count":I
    :goto_255
    monitor-exit v14
    :try_end_256
    .catchall {:try_start_247 .. :try_end_256} :catchall_2aa

    .line 8181
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v0, :cond_25e

    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v0, :cond_2a1

    .line 8182
    :cond_25e
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Filtered results with preferred activities. New candidates count: "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 8183
    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v2

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 8182
    const-string v2, "PackageManager"

    invoke-static {v2, v0}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8184
    invoke-virtual {v8}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_27c
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_2a1

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ResolveInfo;

    .line 8185
    .local v2, "info":Landroid/content/pm/ResolveInfo;
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  + "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v2, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8186
    .end local v2  # "info":Landroid/content/pm/ResolveInfo;
    goto :goto_27c

    .line 8188
    :cond_2a1
    return-object v8

    .line 8180
    :catchall_2a2
    move-exception v0

    move-object/from16 v1, p3

    goto :goto_2a8

    :catchall_2a6
    move-exception v0

    move-object v1, v2

    :goto_2a8
    :try_start_2a8
    monitor-exit v14
    :try_end_2a9
    .catchall {:try_start_2a8 .. :try_end_2a9} :catchall_2aa

    throw v0

    :catchall_2aa
    move-exception v0

    goto :goto_2a8
.end method

.method private filterIfNotSystemUser(Ljava/util/List;I)Ljava/util/List;
    .registers 7
    .param p2, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;I)",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 7874
    .local p1, "resolveInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-nez p2, :cond_3

    .line 7875
    return-object p1

    .line 7879
    :cond_3
    const-string v0, "PackageManager"

    if-nez p1, :cond_14

    .line 7880
    const-string/jumbo v1, "patch system: resolveInfos is null!"

    invoke-static {v0, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7881
    new-instance v0, Ljava/util/ArrayList;

    const/4 v1, 0x0

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    return-object v0

    .line 7883
    :cond_14
    instance-of v1, p1, Ljava/util/ArrayList;

    if-eqz v1, :cond_19

    goto :goto_2c

    .line 7886
    :cond_19
    const-string/jumbo v1, "patch system: resolveInfos instanceof SingletonList, but will be modified!"

    invoke-static {v0, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7887
    new-instance v0, Ljava/util/ArrayList;

    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v1

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    .line 7888
    .local v0, "resolveInfosTmp":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ResolveInfo;>;"
    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    .line 7889
    move-object p1, v0

    .line 7893
    .end local v0  # "resolveInfosTmp":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ResolveInfo;>;"
    :goto_2c
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v0

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_32
    if-ltz v0, :cond_55

    .line 7894
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/ResolveInfo;

    .line 7896
    .local v1, "info":Landroid/content/pm/ResolveInfo;
    if-eqz v1, :cond_4e

    iget-object v2, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    if-nez v2, :cond_41

    goto :goto_4e

    .line 7901
    :cond_41
    iget-object v2, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget v2, v2, Landroid/content/pm/ActivityInfo;->flags:I

    const/high16 v3, 0x20000000

    and-int/2addr v2, v3

    if-eqz v2, :cond_52

    .line 7902
    invoke-interface {p1, v0}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    goto :goto_52

    .line 7897
    :cond_4e
    :goto_4e
    invoke-interface {p1, v0}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 7898
    nop

    .line 7893
    .end local v1  # "info":Landroid/content/pm/ResolveInfo;
    :cond_52
    :goto_52
    add-int/lit8 v0, v0, -0x1

    goto :goto_32

    .line 7905
    .end local v0  # "i":I
    :cond_55
    return-object p1
.end method

.method private filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z
    .registers 23
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "uid"  # I
    .param p3, "userId"  # I
    .param p4, "flags"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 4645
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    const/high16 v2, 0x4000000

    and-int v2, p4, v2

    const/4 v3, 0x0

    if-eqz v2, :cond_2b

    .line 4647
    invoke-static/range {p2 .. p2}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v2

    .line 4648
    .local v2, "appId":I
    const/16 v4, 0x3e8

    if-eq v2, v4, :cond_28

    const/16 v4, 0x7d0

    if-eq v2, v4, :cond_28

    if-nez v2, :cond_1c

    move/from16 v5, p2

    goto :goto_2a

    .line 4653
    :cond_1c
    nop

    .line 4654
    const-string v4, "android.permission.INSTALL_PACKAGES"

    move/from16 v5, p2

    invoke-virtual {v0, v4, v5}, Lcom/android/server/pm/PackageManagerService;->checkUidPermission(Ljava/lang/String;I)I

    move-result v4

    if-nez v4, :cond_2d

    .line 4655
    return v3

    .line 4648
    :cond_28
    move/from16 v5, p2

    .line 4650
    :goto_2a
    return v3

    .line 4645
    .end local v2  # "appId":I
    :cond_2b
    move/from16 v5, p2

    .line 4660
    :cond_2d
    if-eqz v1, :cond_98

    iget-object v2, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v2, :cond_98

    iget-object v2, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v2}, Landroid/content/pm/ApplicationInfo;->isStaticSharedLibrary()Z

    move-result v2

    if-nez v2, :cond_40

    move/from16 v6, p3

    goto :goto_9a

    .line 4664
    :cond_40
    iget-object v2, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v2, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-wide v6, v4, Landroid/content/pm/PackageParser$Package;->staticSharedLibVersion:J

    invoke-direct {v0, v2, v6, v7}, Lcom/android/server/pm/PackageManagerService;->getSharedLibraryInfoLPr(Ljava/lang/String;J)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v2

    .line 4666
    .local v2, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    if-nez v2, :cond_4f

    .line 4667
    return v3

    .line 4670
    :cond_4f
    invoke-static/range {p2 .. p2}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v4

    move/from16 v6, p3

    invoke-static {v6, v4}, Landroid/os/UserHandle;->getUid(II)I

    move-result v4

    .line 4671
    .local v4, "resolvedUid":I
    invoke-virtual {v0, v4}, Lcom/android/server/pm/PackageManagerService;->getPackagesForUid(I)[Ljava/lang/String;

    move-result-object v7

    .line 4672
    .local v7, "uidPackageNames":[Ljava/lang/String;
    const/4 v8, 0x1

    if-nez v7, :cond_61

    .line 4673
    return v8

    .line 4676
    :cond_61
    array-length v9, v7

    move v10, v3

    :goto_63
    if-ge v10, v9, :cond_97

    aget-object v11, v7, v10

    .line 4677
    .local v11, "uidPackageName":Ljava/lang/String;
    iget-object v12, v1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v12, v11}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v12

    if-eqz v12, :cond_70

    .line 4678
    return v3

    .line 4680
    :cond_70
    iget-object v12, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v12, v11}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v12

    .line 4681
    .local v12, "uidPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v12, :cond_94

    .line 4682
    iget-object v13, v12, Lcom/android/server/pm/PackageSetting;->usesStaticLibraries:[Ljava/lang/String;

    .line 4683
    invoke-virtual {v2}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v14

    .line 4682
    invoke-static {v13, v14}, Lcom/android/internal/util/ArrayUtils;->indexOf([Ljava/lang/Object;Ljava/lang/Object;)I

    move-result v13

    .line 4684
    .local v13, "index":I
    if-gez v13, :cond_85

    .line 4685
    goto :goto_94

    .line 4687
    :cond_85
    iget-object v14, v12, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v14, v14, Landroid/content/pm/PackageParser$Package;->usesStaticLibrariesVersions:[J

    aget-wide v14, v14, v13

    invoke-virtual {v2}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v16

    cmp-long v14, v14, v16

    if-nez v14, :cond_94

    .line 4688
    return v3

    .line 4676
    .end local v11  # "uidPackageName":Ljava/lang/String;
    .end local v12  # "uidPs":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "index":I
    :cond_94
    :goto_94
    add-int/lit8 v10, v10, 0x1

    goto :goto_63

    .line 4692
    :cond_97
    return v8

    .line 4660
    .end local v2  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v4  # "resolvedUid":I
    .end local v7  # "uidPackageNames":[Ljava/lang/String;
    :cond_98
    move/from16 v6, p3

    .line 4661
    :goto_9a
    return v3
.end method

.method private findInstallFailureActivity(Ljava/lang/String;II)Landroid/content/ComponentName;
    .registers 14
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "filterCallingUid"  # I
    .param p3, "userId"  # I

    .line 8008
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.INSTALL_FAILURE"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 8009
    .local v0, "failureActivityIntent":Landroid/content/Intent;
    invoke-virtual {v0, p1}, Landroid/content/Intent;->setPackage(Ljava/lang/String;)Landroid/content/Intent;

    .line 8011
    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    move-object v2, p0

    move-object v3, v0

    move v6, p2

    move v7, p3

    invoke-direct/range {v2 .. v9}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZZ)Ljava/util/List;

    move-result-object v1

    .line 8014
    .local v1, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v2

    .line 8015
    .local v2, "NR":I
    if-lez v2, :cond_39

    .line 8016
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_1d
    if-ge v3, v2, :cond_39

    .line 8017
    invoke-interface {v1, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/ResolveInfo;

    .line 8018
    .local v4, "info":Landroid/content/pm/ResolveInfo;
    iget-object v5, v4, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->splitName:Ljava/lang/String;

    if-eqz v5, :cond_2f

    .line 8019
    nop

    .line 8016
    .end local v4  # "info":Landroid/content/pm/ResolveInfo;
    add-int/lit8 v3, v3, 0x1

    goto :goto_1d

    .line 8021
    .restart local v4  # "info":Landroid/content/pm/ResolveInfo;
    :cond_2f
    new-instance v5, Landroid/content/ComponentName;

    iget-object v6, v4, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v5, p1, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    return-object v5

    .line 8024
    .end local v3  # "i":I
    .end local v4  # "info":Landroid/content/pm/ResolveInfo;
    :cond_39
    const/4 v3, 0x0

    return-object v3
.end method

.method private findPersistentPreferredActivityLP(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;ZI)Landroid/content/pm/ResolveInfo;
    .registers 23
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p5, "debug"  # Z
    .param p6, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "I",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;ZI)",
            "Landroid/content/pm/ResolveInfo;"
        }
    .end annotation

    .line 7140
    .local p4, "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    move-object/from16 v0, p0

    move/from16 v1, p3

    move/from16 v2, p6

    invoke-interface/range {p4 .. p4}, Ljava/util/List;->size()I

    move-result v3

    .line 7141
    .local v3, "N":I
    iget-object v4, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPersistentPreferredActivities:Landroid/util/SparseArray;

    .line 7142
    invoke-virtual {v4, v2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PersistentPreferredIntentResolver;

    .line 7144
    .local v4, "ppir":Lcom/android/server/pm/PersistentPreferredIntentResolver;
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    const-string v6, "PackageManager"

    if-nez v5, :cond_1c

    if-eqz p5, :cond_21

    :cond_1c
    const-string v5, "Looking for presistent preferred activities..."

    invoke-static {v6, v5}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7145
    :cond_21
    const/4 v5, 0x0

    if-eqz v4, :cond_35

    .line 7146
    const/high16 v8, 0x10000

    and-int/2addr v8, v1

    if-eqz v8, :cond_2b

    const/4 v8, 0x1

    goto :goto_2c

    :cond_2b
    move v8, v5

    :goto_2c
    move-object/from16 v9, p1

    move-object/from16 v10, p2

    invoke-virtual {v4, v9, v10, v8, v2}, Lcom/android/server/pm/PersistentPreferredIntentResolver;->queryIntent(Landroid/content/Intent;Ljava/lang/String;ZI)Ljava/util/List;

    move-result-object v8

    goto :goto_3a

    .line 7149
    :cond_35
    move-object/from16 v9, p1

    move-object/from16 v10, p2

    const/4 v8, 0x0

    :goto_3a
    nop

    .line 7150
    .local v8, "pprefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PersistentPreferredActivity;>;"
    if-eqz v8, :cond_11e

    invoke-interface {v8}, Ljava/util/List;->size()I

    move-result v11

    if-lez v11, :cond_11e

    .line 7151
    invoke-interface {v8}, Ljava/util/List;->size()I

    move-result v11

    .line 7152
    .local v11, "M":I
    const/4 v12, 0x0

    .local v12, "i":I
    :goto_48
    if-ge v12, v11, :cond_11b

    .line 7153
    invoke-interface {v8, v12}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/pm/PersistentPreferredActivity;

    .line 7154
    .local v13, "ppa":Lcom/android/server/pm/PersistentPreferredActivity;
    sget-boolean v14, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    const-string v15, "  "

    if-nez v14, :cond_58

    if-eqz p5, :cond_8d

    .line 7155
    :cond_58
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Checking PersistentPreferredActivity ds="

    invoke-virtual {v14, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 7156
    invoke-virtual {v13}, Lcom/android/server/pm/PersistentPreferredActivity;->countDataSchemes()I

    move-result v7

    if-lez v7, :cond_6d

    invoke-virtual {v13, v5}, Lcom/android/server/pm/PersistentPreferredActivity;->getDataScheme(I)Ljava/lang/String;

    move-result-object v7

    goto :goto_6f

    :cond_6d
    const-string v7, "<none>"

    :goto_6f
    invoke-virtual {v14, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, "\n  component="

    invoke-virtual {v14, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v13, Lcom/android/server/pm/PersistentPreferredActivity;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v14, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    .line 7155
    invoke-static {v6, v7}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7158
    new-instance v7, Landroid/util/LogPrinter;

    const/4 v5, 0x2

    const/4 v14, 0x3

    invoke-direct {v7, v5, v6, v14}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;I)V

    invoke-virtual {v13, v7, v15}, Lcom/android/server/pm/PersistentPreferredActivity;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 7160
    :cond_8d
    iget-object v5, v13, Lcom/android/server/pm/PersistentPreferredActivity;->mComponent:Landroid/content/ComponentName;

    or-int/lit16 v7, v1, 0x200

    invoke-virtual {v0, v5, v7, v2}, Lcom/android/server/pm/PackageManagerService;->getActivityInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ActivityInfo;

    move-result-object v5

    .line 7162
    .local v5, "ai":Landroid/content/pm/ActivityInfo;
    sget-boolean v7, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v7, :cond_9b

    if-eqz p5, :cond_b2

    .line 7163
    :cond_9b
    const-string v7, "Found persistent preferred activity:"

    invoke-static {v6, v7}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7164
    if-eqz v5, :cond_ad

    .line 7165
    new-instance v7, Landroid/util/LogPrinter;

    const/4 v0, 0x2

    const/4 v14, 0x3

    invoke-direct {v7, v0, v6, v14}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;I)V

    invoke-virtual {v5, v7, v15}, Landroid/content/pm/ActivityInfo;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    goto :goto_b2

    .line 7167
    :cond_ad
    const-string v0, "  null"

    invoke-static {v6, v0}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7170
    :cond_b2
    :goto_b2
    if-nez v5, :cond_b7

    .line 7173
    move-object/from16 v7, p4

    goto :goto_112

    .line 7175
    :cond_b7
    const/4 v0, 0x0

    .local v0, "j":I
    :goto_b8
    if-ge v0, v3, :cond_110

    .line 7176
    move-object/from16 v7, p4

    invoke-interface {v7, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Landroid/content/pm/ResolveInfo;

    .line 7177
    .local v14, "ri":Landroid/content/pm/ResolveInfo;
    iget-object v15, v14, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v15, v15, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v15, v15, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v1, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 7178
    invoke-virtual {v15, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-nez v1, :cond_d3

    .line 7179
    goto :goto_e0

    .line 7181
    :cond_d3
    iget-object v1, v14, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    iget-object v15, v5, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v1, v15}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-nez v1, :cond_e5

    .line 7182
    nop

    .line 7175
    .end local v14  # "ri":Landroid/content/pm/ResolveInfo;
    :goto_e0
    add-int/lit8 v0, v0, 0x1

    move/from16 v1, p3

    goto :goto_b8

    .line 7185
    .restart local v14  # "ri":Landroid/content/pm/ResolveInfo;
    :cond_e5
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v1, :cond_eb

    if-eqz p5, :cond_10f

    .line 7186
    :cond_eb
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Returning persistent preferred activity: "

    invoke-virtual {v1, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v15, v14, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v15, v15, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, "/"

    invoke-virtual {v1, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v15, v14, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v15, v15, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v1, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v6, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7189
    :cond_10f
    return-object v14

    .line 7175
    .end local v14  # "ri":Landroid/content/pm/ResolveInfo;
    :cond_110
    move-object/from16 v7, p4

    .line 7152
    .end local v0  # "j":I
    .end local v5  # "ai":Landroid/content/pm/ActivityInfo;
    .end local v13  # "ppa":Lcom/android/server/pm/PersistentPreferredActivity;
    :goto_112
    add-int/lit8 v12, v12, 0x1

    const/4 v5, 0x0

    move-object/from16 v0, p0

    move/from16 v1, p3

    goto/16 :goto_48

    :cond_11b
    move-object/from16 v7, p4

    goto :goto_120

    .line 7150
    .end local v11  # "M":I
    .end local v12  # "i":I
    :cond_11e
    move-object/from16 v7, p4

    .line 7193
    :goto_120
    const/4 v0, 0x0

    return-object v0
.end method

.method private static findSharedLibraries(Landroid/content/pm/PackageParser$Package;)Ljava/util/List;
    .registers 5
    .param p0, "p"  # Landroid/content/pm/PackageParser$Package;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageParser$Package;",
            ")",
            "Ljava/util/List<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;"
        }
    .end annotation

    .line 10572
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->usesLibraryInfos:Ljava/util/ArrayList;

    if-eqz v0, :cond_25

    .line 10573
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 10574
    .local v0, "retValue":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    new-instance v1, Ljava/util/HashSet;

    invoke-direct {v1}, Ljava/util/HashSet;-><init>()V

    .line 10575
    .local v1, "collectedNames":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    iget-object v2, p0, Landroid/content/pm/PackageParser$Package;->usesLibraryInfos:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_14
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_24

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/SharedLibraryInfo;

    .line 10576
    .local v3, "info":Landroid/content/pm/SharedLibraryInfo;
    invoke-static {v3, v0, v1}, Lcom/android/server/pm/PackageManagerService;->findSharedLibrariesRecursive(Landroid/content/pm/SharedLibraryInfo;Ljava/util/ArrayList;Ljava/util/Set;)V

    .line 10577
    .end local v3  # "info":Landroid/content/pm/SharedLibraryInfo;
    goto :goto_14

    .line 10578
    :cond_24
    return-object v0

    .line 10580
    .end local v0  # "retValue":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v1  # "collectedNames":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    :cond_25
    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method private static findSharedLibrariesRecursive(Landroid/content/pm/SharedLibraryInfo;Ljava/util/ArrayList;Ljava/util/Set;)V
    .registers 5
    .param p0, "info"  # Landroid/content/pm/SharedLibraryInfo;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/SharedLibraryInfo;",
            "Ljava/util/ArrayList<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;",
            "Ljava/util/Set<",
            "Ljava/lang/String;",
            ">;)V"
        }
    .end annotation

    .line 10586
    .local p1, "collected":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    .local p2, "collectedNames":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    invoke-virtual {p0}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v0

    invoke-interface {p2, v0}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_32

    .line 10587
    invoke-virtual {p0}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v0

    invoke-interface {p2, v0}, Ljava/util/Set;->add(Ljava/lang/Object;)Z

    .line 10588
    invoke-virtual {p1, p0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10590
    invoke-virtual {p0}, Landroid/content/pm/SharedLibraryInfo;->getDependencies()Ljava/util/List;

    move-result-object v0

    if-eqz v0, :cond_32

    .line 10591
    invoke-virtual {p0}, Landroid/content/pm/SharedLibraryInfo;->getDependencies()Ljava/util/List;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_22
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_32

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/SharedLibraryInfo;

    .line 10592
    .local v1, "dep":Landroid/content/pm/SharedLibraryInfo;
    invoke-static {v1, p1, p2}, Lcom/android/server/pm/PackageManagerService;->findSharedLibrariesRecursive(Landroid/content/pm/SharedLibraryInfo;Ljava/util/ArrayList;Ljava/util/Set;)V

    .line 10593
    .end local v1  # "dep":Landroid/content/pm/SharedLibraryInfo;
    goto :goto_22

    .line 10596
    :cond_32
    return-void
.end method

.method static fixProcessName(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
    .registers 2
    .param p0, "defProcessName"  # Ljava/lang/String;
    .param p1, "processName"  # Ljava/lang/String;

    .line 10013
    if-nez p1, :cond_3

    .line 10014
    return-object p0

    .line 10016
    :cond_3
    return-object p1
.end method

.method private fixUpInstallReason(Ljava/lang/String;II)I
    .registers 7
    .param p1, "installerPackageName"  # Ljava/lang/String;
    .param p2, "installerUid"  # I
    .param p3, "installReason"  # I

    .line 13640
    const-string v0, "android.permission.INSTALL_PACKAGES"

    invoke-virtual {p0, v0, p2}, Lcom/android/server/pm/PackageManagerService;->checkUidPermission(Ljava/lang/String;I)I

    move-result v0

    if-nez v0, :cond_9

    .line 13644
    return p3

    .line 13646
    :cond_9
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mProtectedPackages:Lcom/android/server/pm/ProtectedPackages;

    .line 13647
    invoke-static {p2}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    .line 13646
    invoke-virtual {v0, v1}, Lcom/android/server/pm/ProtectedPackages;->getDeviceOwnerOrProfileOwnerPackage(I)Ljava/lang/String;

    move-result-object v0

    .line 13648
    .local v0, "ownerPackage":Ljava/lang/String;
    const/4 v1, 0x1

    if-eqz v0, :cond_1d

    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_1d

    .line 13651
    return v1

    .line 13655
    :cond_1d
    if-ne p3, v1, :cond_21

    .line 13660
    const/4 v1, 0x0

    return v1

    .line 13665
    :cond_21
    return p3
.end method

.method private generateApplicationInfoFromSettingsLPw(Ljava/lang/String;III)Landroid/content/pm/ApplicationInfo;
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "filterCallingUid"  # I
    .param p4, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 4891
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p4}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    return-object v1

    .line 4892
    :cond_a
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 4893
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_47

    .line 4894
    invoke-direct {p0, v0, p3, p4, p2}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v2

    if-eqz v2, :cond_1d

    .line 4895
    return-object v1

    .line 4897
    :cond_1d
    invoke-direct {p0, v0, p3, p4}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v2

    if-eqz v2, :cond_24

    .line 4898
    return-object v1

    .line 4900
    :cond_24
    iget-object v2, v0, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-nez v2, :cond_32

    .line 4901
    invoke-direct {p0, v0, p2, p4}, Lcom/android/server/pm/PackageManagerService;->generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;

    move-result-object v2

    .line 4902
    .local v2, "pInfo":Landroid/content/pm/PackageInfo;
    if-eqz v2, :cond_31

    .line 4903
    iget-object v1, v2, Landroid/content/pm/PackageInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    return-object v1

    .line 4905
    :cond_31
    return-object v1

    .line 4907
    .end local v2  # "pInfo":Landroid/content/pm/PackageInfo;
    :cond_32
    iget-object v1, v0, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 4908
    invoke-virtual {v0, p4}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v2

    .line 4907
    invoke-static {v1, p2, v2, p4}, Landroid/content/pm/PackageParser;->generateApplicationInfo(Landroid/content/pm/PackageParser$Package;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    .line 4909
    .local v1, "ai":Landroid/content/pm/ApplicationInfo;
    if-eqz v1, :cond_46

    .line 4910
    iget-object v2, v0, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->resolveExternalPackageNameLPr(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;

    move-result-object v2

    iput-object v2, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 4912
    :cond_46
    return-object v1

    .line 4914
    .end local v1  # "ai":Landroid/content/pm/ApplicationInfo;
    :cond_47
    return-object v1
.end method

.method private generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;
    .registers 22
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 4300
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move/from16 v12, p3

    sget-object v3, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v3, v12}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v3

    const/4 v13, 0x0

    if-nez v3, :cond_12

    return-object v13

    .line 4301
    :cond_12
    if-nez v1, :cond_15

    .line 4302
    return-object v13

    .line 4304
    :cond_15
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v14

    .line 4311
    .local v14, "callingUid":I
    invoke-direct {v0, v1, v14, v12}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-eqz v3, :cond_20

    .line 4312
    return-object v13

    .line 4315
    :cond_20
    and-int/lit16 v3, v2, 0x2000

    if-eqz v3, :cond_2f

    .line 4316
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/pm/PackageSetting;->isSystem()Z

    move-result v3

    if-eqz v3, :cond_2f

    .line 4317
    const/high16 v3, 0x400000

    or-int/2addr v2, v3

    move v15, v2

    .end local p2  # "flags":I
    .local v2, "flags":I
    goto :goto_30

    .line 4320
    .end local v2  # "flags":I
    .restart local p2  # "flags":I
    :cond_2f
    move v15, v2

    .end local p2  # "flags":I
    .local v15, "flags":I
    :goto_30
    invoke-virtual {v1, v12}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v11

    .line 4321
    .local v11, "state":Landroid/content/pm/PackageUserState;
    iget-object v10, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 4322
    .local v10, "p":Landroid/content/pm/PackageParser$Package;
    if-eqz v10, :cond_7d

    .line 4323
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/pm/PackageSetting;->getPermissionsState()Lcom/android/server/pm/permission/PermissionsState;

    move-result-object v7

    .line 4326
    .local v7, "permissionsState":Lcom/android/server/pm/permission/PermissionsState;
    and-int/lit16 v2, v15, 0x100

    if-nez v2, :cond_43

    .line 4327
    sget-object v2, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    goto :goto_47

    :cond_43
    invoke-virtual {v7, v12}, Lcom/android/server/pm/permission/PermissionsState;->computeGids(I)[I

    move-result-object v2

    :goto_47
    move-object v3, v2

    .line 4329
    .local v3, "gids":[I
    iget-object v2, v10, Landroid/content/pm/PackageParser$Package;->requestedPermissions:Ljava/util/ArrayList;

    invoke-static {v2}, Lcom/android/internal/util/ArrayUtils;->isEmpty(Ljava/util/Collection;)Z

    move-result v2

    if-eqz v2, :cond_55

    .line 4330
    invoke-static {}, Ljava/util/Collections;->emptySet()Ljava/util/Set;

    move-result-object v2

    goto :goto_59

    :cond_55
    invoke-virtual {v7, v12}, Lcom/android/server/pm/permission/PermissionsState;->getPermissions(I)Ljava/util/Set;

    move-result-object v2

    :goto_59
    move-object v9, v2

    .line 4332
    .local v9, "permissions":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    iget-wide v5, v1, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    move/from16 v16, v14

    .end local v14  # "callingUid":I
    .local v16, "callingUid":I
    iget-wide v13, v1, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J

    move-object v2, v10

    move v4, v15

    move-object/from16 v17, v7

    .end local v7  # "permissionsState":Lcom/android/server/pm/permission/PermissionsState;
    .local v17, "permissionsState":Lcom/android/server/pm/permission/PermissionsState;
    move-wide v7, v13

    move-object v13, v10

    .end local v10  # "p":Landroid/content/pm/PackageParser$Package;
    .local v13, "p":Landroid/content/pm/PackageParser$Package;
    move-object v10, v11

    move-object v14, v11

    .end local v11  # "state":Landroid/content/pm/PackageUserState;
    .local v14, "state":Landroid/content/pm/PackageUserState;
    move/from16 v11, p3

    invoke-static/range {v2 .. v11}, Landroid/content/pm/PackageParser;->generatePackageInfo(Landroid/content/pm/PackageParser$Package;[IIJJLjava/util/Set;Landroid/content/pm/PackageUserState;I)Landroid/content/pm/PackageInfo;

    move-result-object v2

    .line 4335
    .local v2, "packageInfo":Landroid/content/pm/PackageInfo;
    if-nez v2, :cond_72

    .line 4336
    const/4 v4, 0x0

    return-object v4

    .line 4339
    :cond_72
    iget-object v4, v2, Landroid/content/pm/PackageInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 4340
    invoke-direct {v0, v13}, Lcom/android/server/pm/PackageManagerService;->resolveExternalPackageNameLPr(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;

    move-result-object v5

    iput-object v5, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v5, v2, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    .line 4342
    return-object v2

    .line 4343
    .end local v2  # "packageInfo":Landroid/content/pm/PackageInfo;
    .end local v3  # "gids":[I
    .end local v9  # "permissions":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    .end local v13  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v16  # "callingUid":I
    .end local v17  # "permissionsState":Lcom/android/server/pm/permission/PermissionsState;
    .restart local v10  # "p":Landroid/content/pm/PackageParser$Package;
    .restart local v11  # "state":Landroid/content/pm/PackageUserState;
    .local v14, "callingUid":I
    :cond_7d
    move-object v13, v10

    move/from16 v16, v14

    move-object v14, v11

    .end local v10  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v11  # "state":Landroid/content/pm/PackageUserState;
    .restart local v13  # "p":Landroid/content/pm/PackageParser$Package;
    .local v14, "state":Landroid/content/pm/PackageUserState;
    .restart local v16  # "callingUid":I
    and-int/lit16 v2, v15, 0x2000

    if-eqz v2, :cond_fc

    invoke-virtual {v14, v15}, Landroid/content/pm/PackageUserState;->isAvailable(I)Z

    move-result v2

    if-eqz v2, :cond_fc

    .line 4344
    new-instance v2, Landroid/content/pm/PackageInfo;

    invoke-direct {v2}, Landroid/content/pm/PackageInfo;-><init>()V

    .line 4345
    .local v2, "pi":Landroid/content/pm/PackageInfo;
    iget-object v3, v1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    iput-object v3, v2, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    .line 4346
    iget-wide v3, v1, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-virtual {v2, v3, v4}, Landroid/content/pm/PackageInfo;->setLongVersionCode(J)V

    .line 4347
    iget-object v3, v1, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eqz v3, :cond_a2

    iget-object v3, v1, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v3, v3, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    goto :goto_a3

    :cond_a2
    const/4 v3, 0x0

    :goto_a3
    iput-object v3, v2, Landroid/content/pm/PackageInfo;->sharedUserId:Ljava/lang/String;

    .line 4348
    iget-wide v3, v1, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    iput-wide v3, v2, Landroid/content/pm/PackageInfo;->firstInstallTime:J

    .line 4349
    iget-wide v3, v1, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J

    iput-wide v3, v2, Landroid/content/pm/PackageInfo;->lastUpdateTime:J

    .line 4351
    new-instance v3, Landroid/content/pm/ApplicationInfo;

    invoke-direct {v3}, Landroid/content/pm/ApplicationInfo;-><init>()V

    .line 4352
    .local v3, "ai":Landroid/content/pm/ApplicationInfo;
    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    iput-object v4, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 4353
    iget v4, v1, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-static {v12, v4}, Landroid/os/UserHandle;->getUid(II)I

    move-result v4

    iput v4, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    .line 4354
    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    iput-object v4, v3, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 4355
    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->secondaryCpuAbiString:Ljava/lang/String;

    iput-object v4, v3, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    .line 4356
    iget-wide v4, v1, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-virtual {v3, v4, v5}, Landroid/content/pm/ApplicationInfo;->setVersionCode(J)V

    .line 4357
    iget v4, v1, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    iput v4, v3, Landroid/content/pm/ApplicationInfo;->flags:I

    .line 4358
    iget v4, v1, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    iput v4, v3, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 4359
    invoke-static {v3, v15, v14, v12}, Landroid/content/pm/PackageParser;->generateApplicationInfo(Landroid/content/pm/ApplicationInfo;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v4

    iput-object v4, v2, Landroid/content/pm/PackageInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 4361
    sget-boolean v4, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_INFO:Z

    if-eqz v4, :cond_fb

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v5, "ps.pkg is n/a for ["

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, "]. Provides a minimum info."

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v5, "PackageManager"

    invoke-static {v5, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 4363
    :cond_fb
    return-object v2

    .line 4365
    .end local v2  # "pi":Landroid/content/pm/PackageInfo;
    .end local v3  # "ai":Landroid/content/pm/ApplicationInfo;
    :cond_fc
    const/4 v2, 0x0

    return-object v2
.end method

.method private getActiveLauncherPackageName(I)Ljava/lang/String;
    .registers 5
    .param p1, "userId"  # I

    .line 14617
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.MAIN"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 14618
    .local v0, "intent":Landroid/content/Intent;
    const-string v1, "android.intent.category.HOME"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 14619
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 14621
    invoke-virtual {v1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v1

    invoke-virtual {v0, v1}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;

    move-result-object v1

    .line 14619
    const/high16 v2, 0x10000

    invoke-virtual {p0, v0, v1, v2, p1}, Lcom/android/server/pm/PackageManagerService;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;

    move-result-object v1

    .line 14625
    .local v1, "resolveInfo":Landroid/content/pm/ResolveInfo;
    if-nez v1, :cond_20

    const/4 v2, 0x0

    goto :goto_24

    :cond_20
    iget-object v2, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    :goto_24
    return-object v2
.end method

.method private getActivityInfoInternal(Landroid/content/ComponentName;III)Landroid/content/pm/ActivityInfo;
    .registers 19
    .param p1, "component"  # Landroid/content/ComponentName;
    .param p2, "flags"  # I
    .param p3, "filterCallingUid"  # I
    .param p4, "userId"  # I

    .line 5364
    move-object v7, p0

    move/from16 v8, p4

    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->mzReplaceResolverName(Landroid/content/ComponentName;)Landroid/content/ComponentName;

    move-result-object v9

    .line 5366
    .end local p1  # "component":Landroid/content/ComponentName;
    .local v9, "component":Landroid/content/ComponentName;
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v8}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v10, 0x0

    if-nez v0, :cond_11

    return-object v10

    .line 5367
    :cond_11
    move/from16 v0, p2

    invoke-direct {p0, v0, v8, v9}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForComponent(IILjava/lang/Object;)I

    move-result v11

    .line 5369
    .end local p2  # "flags":I
    .local v11, "flags":I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0, v8}, Lcom/android/server/pm/PackageManagerService;->isRecentsAccessingChildProfiles(II)Z

    move-result v0

    if-nez v0, :cond_30

    .line 5370
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    const/4 v4, 0x0

    const/4 v5, 0x0

    const-string v6, "get activity info"

    move/from16 v3, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 5374
    :cond_30
    iget-object v12, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v12

    .line 5375
    :try_start_33
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, v9}, Lcom/android/server/pm/ComponentResolver;->getActivity(Landroid/content/ComponentName;)Landroid/content/pm/PackageParser$Activity;

    move-result-object v0

    .line 5377
    .local v0, "a":Landroid/content/pm/PackageParser$Activity;
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_INFO:Z

    if-eqz v1, :cond_5b

    const-string v1, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "getActivityInfo "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v3, ": "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 5378
    :cond_5b
    if-eqz v0, :cond_95

    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v0, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    invoke-virtual {v1, v2, v11, v8}, Lcom/android/server/pm/Settings;->isEnabledAndMatchLPr(Landroid/content/pm/ComponentInfo;II)Z

    move-result v1

    if-eqz v1, :cond_95

    .line 5379
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v9}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    move-object v13, v1

    .line 5380
    .local v13, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v13, :cond_7a

    monitor-exit v12

    return-object v10

    .line 5381
    :cond_7a
    const/4 v5, 0x1

    move-object v1, p0

    move-object v2, v13

    move/from16 v3, p3

    move-object v4, v9

    move/from16 v6, p4

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v1

    if-eqz v1, :cond_8a

    .line 5382
    monitor-exit v12

    return-object v10

    .line 5384
    :cond_8a
    nop

    .line 5385
    invoke-virtual {v13, v8}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v1

    .line 5384
    invoke-static {v0, v11, v1, v8}, Landroid/content/pm/PackageParser;->generateActivityInfo(Landroid/content/pm/PackageParser$Activity;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ActivityInfo;

    move-result-object v1

    monitor-exit v12

    return-object v1

    .line 5387
    .end local v13  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_95
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mResolveComponentName:Landroid/content/ComponentName;

    invoke-virtual {v1, v9}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_aa

    .line 5388
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    new-instance v2, Landroid/content/pm/PackageUserState;

    invoke-direct {v2}, Landroid/content/pm/PackageUserState;-><init>()V

    invoke-static {v1, v11, v2, v8}, Landroid/content/pm/PackageParser;->generateActivityInfo(Landroid/content/pm/ActivityInfo;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ActivityInfo;

    move-result-object v1

    monitor-exit v12

    return-object v1

    .line 5391
    .end local v0  # "a":Landroid/content/pm/PackageParser$Activity;
    :cond_aa
    monitor-exit v12

    .line 5392
    return-object v10

    .line 5391
    :catchall_ac
    move-exception v0

    monitor-exit v12
    :try_end_ae
    .catchall {:try_start_33 .. :try_end_ae} :catchall_ac

    throw v0
.end method

.method private getActivityManagerInternal()Landroid/app/ActivityManagerInternal;
    .registers 2

    .line 5223
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mActivityManagerInternal:Landroid/app/ActivityManagerInternal;

    if-nez v0, :cond_e

    .line 5224
    const-class v0, Landroid/app/ActivityManagerInternal;

    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/app/ActivityManagerInternal;

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mActivityManagerInternal:Landroid/app/ActivityManagerInternal;

    .line 5226
    :cond_e
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mActivityManagerInternal:Landroid/app/ActivityManagerInternal;

    return-object v0
.end method

.method private getActivityTaskManagerInternal()Lcom/android/server/wm/ActivityTaskManagerInternal;
    .registers 2

    .line 5230
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mActivityTaskManagerInternal:Lcom/android/server/wm/ActivityTaskManagerInternal;

    if-nez v0, :cond_e

    .line 5231
    const-class v0, Lcom/android/server/wm/ActivityTaskManagerInternal;

    .line 5232
    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/wm/ActivityTaskManagerInternal;

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mActivityTaskManagerInternal:Lcom/android/server/wm/ActivityTaskManagerInternal;

    .line 5234
    :cond_e
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mActivityTaskManagerInternal:Lcom/android/server/wm/ActivityTaskManagerInternal;

    return-object v0
.end method

.method private static getAllowedSharedLibInfos(Lcom/android/server/pm/PackageManagerService$ScanResult;Ljava/util/Map;)Ljava/util/List;
    .registers 15
    .param p0, "scanResult"  # Lcom/android/server/pm/PackageManagerService$ScanResult;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/pm/PackageManagerService$ScanResult;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;)",
            "Ljava/util/List<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;"
        }
    .end annotation

    .line 17385
    .local p1, "existingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v0, v0, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 17386
    .local v0, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->staticSharedLibraryInfo:Landroid/content/pm/SharedLibraryInfo;

    const/4 v2, 0x0

    if-nez v1, :cond_e

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->dynamicSharedLibraryInfos:Ljava/util/List;

    if-nez v1, :cond_e

    .line 17388
    return-object v2

    .line 17392
    :cond_e
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->staticSharedLibraryInfo:Landroid/content/pm/SharedLibraryInfo;

    if-eqz v1, :cond_19

    .line 17393
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->staticSharedLibraryInfo:Landroid/content/pm/SharedLibraryInfo;

    invoke-static {v1}, Ljava/util/Collections;->singletonList(Ljava/lang/Object;)Ljava/util/List;

    move-result-object v1

    return-object v1

    .line 17395
    :cond_19
    iget-object v1, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->flags:I

    const/4 v3, 0x1

    and-int/2addr v1, v3

    if-eqz v1, :cond_26

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->dynamicSharedLibraryInfos:Ljava/util/List;

    if-eqz v1, :cond_26

    goto :goto_27

    :cond_26
    const/4 v3, 0x0

    :goto_27
    move v1, v3

    .line 17398
    .local v1, "hasDynamicLibraries":Z
    if-nez v1, :cond_2b

    .line 17399
    return-object v2

    .line 17401
    :cond_2b
    invoke-virtual {v0}, Landroid/content/pm/PackageParser$Package;->isUpdatedSystemApp()Z

    move-result v3

    .line 17404
    .local v3, "isUpdatedSystemApp":Z
    if-eqz v3, :cond_41

    .line 17405
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$ScanRequest;->disabledPkgSetting:Lcom/android/server/pm/PackageSetting;

    if-nez v4, :cond_3c

    .line 17406
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$ScanRequest;->oldPkgSetting:Lcom/android/server/pm/PackageSetting;

    goto :goto_42

    .line 17407
    :cond_3c
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$ScanRequest;->disabledPkgSetting:Lcom/android/server/pm/PackageSetting;

    goto :goto_42

    .line 17408
    :cond_41
    move-object v4, v2

    :goto_42
    nop

    .line 17409
    .local v4, "updatedSystemPs":Lcom/android/server/pm/PackageSetting;
    const-string v5, "Package "

    const-string v6, "PackageManager"

    if-eqz v3, :cond_6d

    iget-object v7, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v7, :cond_53

    iget-object v7, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v7, v7, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    if-nez v7, :cond_6d

    .line 17411
    :cond_53
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " declares libraries that are not declared on the system image; skipping"

    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v6, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 17413
    return-object v2

    .line 17415
    :cond_6d
    new-instance v2, Ljava/util/ArrayList;

    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->dynamicSharedLibraryInfos:Ljava/util/List;

    .line 17416
    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v7

    invoke-direct {v2, v7}, Ljava/util/ArrayList;-><init>(I)V

    .line 17417
    .local v2, "infos":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService$ScanResult;->dynamicSharedLibraryInfos:Ljava/util/List;

    invoke-interface {v7}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v7

    :goto_7e
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_e8

    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/pm/SharedLibraryInfo;

    .line 17418
    .local v8, "info":Landroid/content/pm/SharedLibraryInfo;
    invoke-virtual {v8}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v9

    .line 17419
    .local v9, "name":Ljava/lang/String;
    const-string v10, " declares library "

    if-eqz v3, :cond_bc

    .line 17430
    iget-object v11, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v11, v11, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    invoke-virtual {v11, v9}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v11

    if-nez v11, :cond_bc

    .line 17431
    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v11, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v12, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " that is not declared on system image; skipping"

    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v6, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 17433
    goto :goto_7e

    .line 17436
    :cond_bc
    const-wide/16 v11, -0x1

    invoke-static {v9, v11, v12, p1}, Lcom/android/server/pm/PackageManagerService;->sharedLibExists(Ljava/lang/String;JLjava/util/Map;)Z

    move-result v11

    if-eqz v11, :cond_e4

    .line 17438
    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v11, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v12, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " that already exists; skipping"

    invoke-virtual {v11, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v6, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 17440
    goto :goto_7e

    .line 17442
    :cond_e4
    invoke-virtual {v2, v8}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 17443
    .end local v8  # "info":Landroid/content/pm/SharedLibraryInfo;
    .end local v9  # "name":Ljava/lang/String;
    goto :goto_7e

    .line 17444
    :cond_e8
    return-object v2
.end method

.method private getApplicationInfoInternal(Ljava/lang/String;III)Landroid/content/pm/ApplicationInfo;
    .registers 13
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "filterCallingUid"  # I
    .param p4, "userId"  # I

    .line 4930
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p4}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    return-object v1

    .line 4931
    :cond_a
    invoke-direct {p0, p2, p4, p1}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForApplication(IILjava/lang/Object;)I

    move-result p2

    .line 4933
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0, p4}, Lcom/android/server/pm/PackageManagerService;->isRecentsAccessingChildProfiles(II)Z

    move-result v0

    if-nez v0, :cond_26

    .line 4934
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v7, "get application info"

    move v4, p4

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 4940
    :cond_26
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 4942
    const-wide/16 v2, -0x1

    :try_start_2b
    invoke-direct {p0, p1, v2, v3}, Lcom/android/server/pm/PackageManagerService;->resolveInternalPackageNameLPr(Ljava/lang/String;J)Ljava/lang/String;

    move-result-object v2

    move-object p1, v2

    .line 4945
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 4946
    .local v2, "p":Landroid/content/pm/PackageParser$Package;
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_INFO:Z

    if-eqz v3, :cond_5a

    const-string v3, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "getApplicationInfo "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, ": "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 4949
    :cond_5a
    if-eqz v2, :cond_8d

    .line 4950
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 4951
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v3, :cond_6a

    monitor-exit v0

    return-object v1

    .line 4952
    :cond_6a
    invoke-direct {p0, v3, p3, p4, p2}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v4

    if-eqz v4, :cond_72

    .line 4953
    monitor-exit v0

    return-object v1

    .line 4955
    :cond_72
    invoke-direct {p0, v3, p3, p4}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v4

    if-eqz v4, :cond_7a

    .line 4956
    monitor-exit v0

    return-object v1

    .line 4959
    :cond_7a
    nop

    .line 4960
    invoke-virtual {v3, p4}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v1

    .line 4959
    invoke-static {v2, p2, v1, p4}, Landroid/content/pm/PackageParser;->generateApplicationInfo(Landroid/content/pm/PackageParser$Package;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    .line 4961
    .local v1, "ai":Landroid/content/pm/ApplicationInfo;
    if-eqz v1, :cond_8b

    .line 4962
    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->resolveExternalPackageNameLPr(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;

    move-result-object v4

    iput-object v4, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 4964
    :cond_8b
    monitor-exit v0

    return-object v1

    .line 4966
    .end local v1  # "ai":Landroid/content/pm/ApplicationInfo;
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_8d
    const-string v3, "android"

    invoke-virtual {v3, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_ad

    const-string/jumbo v3, "system"

    invoke-virtual {v3, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_9f

    goto :goto_ad

    .line 4969
    :cond_9f
    const v3, 0x402000

    and-int/2addr v3, p2

    if-eqz v3, :cond_ab

    .line 4971
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->generateApplicationInfoFromSettingsLPw(Ljava/lang/String;III)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 4974
    .end local v2  # "p":Landroid/content/pm/PackageParser$Package;
    :cond_ab
    monitor-exit v0

    .line 4975
    return-object v1

    .line 4967
    .restart local v2  # "p":Landroid/content/pm/PackageParser$Package;
    :cond_ad
    :goto_ad
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mAndroidApplication:Landroid/content/pm/ApplicationInfo;

    monitor-exit v0

    return-object v1

    .line 4974
    .end local v2  # "p":Landroid/content/pm/PackageParser$Package;
    :catchall_b1
    move-exception v1

    monitor-exit v0
    :try_end_b3
    .catchall {:try_start_2b .. :try_end_b3} :catchall_b1

    throw v1
.end method

.method private getAppsWithSharedUserIdsLocked()Landroid/util/SparseArray;
    .registers 7
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Landroid/util/SparseArray<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 26054
    new-instance v0, Landroid/util/SparseArray;

    invoke-direct {v0}, Landroid/util/SparseArray;-><init>()V

    .line 26055
    .local v0, "sharedUserIds":Landroid/util/SparseArray;, "Landroid/util/SparseArray<Ljava/lang/String;>;"
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 26056
    :try_start_8
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2}, Lcom/android/server/pm/Settings;->getAllSharedUsersLPw()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_12
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_2a

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/SharedUserSetting;

    .line 26057
    .local v3, "setting":Lcom/android/server/pm/SharedUserSetting;
    iget v4, v3, Lcom/android/server/pm/SharedUserSetting;->userId:I

    invoke-static {v4}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v4

    iget-object v5, v3, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    invoke-virtual {v0, v4, v5}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 26058
    .end local v3  # "setting":Lcom/android/server/pm/SharedUserSetting;
    goto :goto_12

    .line 26059
    :cond_2a
    monitor-exit v1

    .line 26060
    return-object v0

    .line 26059
    :catchall_2c
    move-exception v2

    monitor-exit v1
    :try_end_2e
    .catchall {:try_start_8 .. :try_end_2e} :catchall_2c

    throw v2
.end method

.method private getBlockUninstallForUsers(Ljava/lang/String;[I)[I
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userIds"  # [I

    .line 19376
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    .line 19377
    .local v0, "result":[I
    array-length v1, p2

    const/4 v2, 0x0

    :goto_4
    if-ge v2, v1, :cond_15

    aget v3, p2, v2

    .line 19378
    .local v3, "userId":I
    invoke-virtual {p0, p1, v3}, Lcom/android/server/pm/PackageManagerService;->getBlockUninstallForUser(Ljava/lang/String;I)Z

    move-result v4

    if-eqz v4, :cond_12

    .line 19379
    invoke-static {v0, v3}, Lcom/android/internal/util/ArrayUtils;->appendInt([II)[I

    move-result-object v0

    .line 19377
    .end local v3  # "userId":I
    :cond_12
    add-int/lit8 v2, v2, 0x1

    goto :goto_4

    .line 19382
    :cond_15
    return-object v0
.end method

.method private getCrossProfileDomainPreferredLpr(Landroid/content/Intent;Ljava/lang/String;III)Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .registers 23
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "sourceUserId"  # I
    .param p5, "parentUserId"  # I

    .line 7800
    move-object/from16 v0, p0

    move/from16 v1, p4

    move/from16 v2, p5

    sget-object v3, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    const-string v4, "allow_parent_profile_app_linking"

    invoke-virtual {v3, v4, v1}, Lcom/android/server/pm/UserManagerService;->hasUserRestriction(Ljava/lang/String;I)Z

    move-result v3

    const/4 v4, 0x0

    if-nez v3, :cond_12

    .line 7802
    return-object v4

    .line 7804
    :cond_12
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    move-object/from16 v5, p1

    move-object/from16 v6, p2

    move/from16 v7, p3

    invoke-virtual {v3, v5, v6, v7, v2}, Lcom/android/server/pm/ComponentResolver;->queryActivities(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v3

    .line 7807
    .local v3, "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-eqz v3, :cond_94

    invoke-interface {v3}, Ljava/util/List;->isEmpty()Z

    move-result v8

    if-eqz v8, :cond_2b

    move-object/from16 v16, v3

    move-object v3, v4

    goto/16 :goto_97

    .line 7810
    :cond_2b
    const/4 v8, 0x0

    .line 7811
    .local v8, "result":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v9

    .line 7812
    .local v9, "size":I
    const/4 v10, 0x0

    .local v10, "i":I
    :goto_31
    if-ge v10, v9, :cond_88

    .line 7813
    invoke-interface {v3, v10}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/content/pm/ResolveInfo;

    .line 7816
    .local v11, "riTargetUser":Landroid/content/pm/ResolveInfo;
    iget-boolean v12, v11, Landroid/content/pm/ResolveInfo;->handleAllWebDataURI:Z

    if-eqz v12, :cond_40

    .line 7817
    move-object/from16 v16, v3

    goto :goto_80

    .line 7819
    :cond_40
    iget-object v12, v11, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v12, v12, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    .line 7820
    .local v12, "packageName":Ljava/lang/String;
    iget-object v13, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v13, v13, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v13, v12}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/pm/PackageSetting;

    .line 7821
    .local v13, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v13, :cond_53

    .line 7822
    move-object/from16 v16, v3

    goto :goto_80

    .line 7824
    :cond_53
    invoke-direct {v0, v13, v2}, Lcom/android/server/pm/PackageManagerService;->getDomainVerificationStatusLPr(Lcom/android/server/pm/PackageSetting;I)J

    move-result-wide v14

    .line 7825
    .local v14, "verificationState":J
    const/16 v16, 0x20

    shr-long v4, v14, v16

    long-to-int v4, v4

    .line 7826
    .local v4, "status":I
    if-nez v8, :cond_76

    .line 7827
    new-instance v5, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;

    move-object/from16 v16, v3

    const/4 v3, 0x0

    .end local v3  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v16, "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-direct {v5, v3}, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;-><init>(Lcom/android/server/pm/PackageManagerService$1;)V

    move-object v3, v5

    .line 7828
    .end local v8  # "result":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .local v3, "result":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    new-instance v5, Landroid/content/IntentFilter;

    invoke-direct {v5}, Landroid/content/IntentFilter;-><init>()V

    invoke-direct {v0, v5, v1, v2}, Lcom/android/server/pm/PackageManagerService;->createForwardingResolveInfoUnchecked(Landroid/content/IntentFilter;II)Landroid/content/pm/ResolveInfo;

    move-result-object v5

    iput-object v5, v3, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;->resolveInfo:Landroid/content/pm/ResolveInfo;

    .line 7830
    iput v4, v3, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;->bestDomainVerificationStatus:I

    move-object v8, v3

    goto :goto_80

    .line 7832
    .end local v16  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v3, "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v8  # "result":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    :cond_76
    move-object/from16 v16, v3

    .end local v3  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v16  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    iget v3, v8, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;->bestDomainVerificationStatus:I

    invoke-direct {v0, v4, v3}, Lcom/android/server/pm/PackageManagerService;->bestDomainVerificationStatus(II)I

    move-result v3

    iput v3, v8, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;->bestDomainVerificationStatus:I

    .line 7812
    .end local v4  # "status":I
    .end local v11  # "riTargetUser":Landroid/content/pm/ResolveInfo;
    .end local v12  # "packageName":Ljava/lang/String;
    .end local v13  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v14  # "verificationState":J
    :goto_80
    add-int/lit8 v10, v10, 0x1

    move-object/from16 v5, p1

    move-object/from16 v3, v16

    const/4 v4, 0x0

    goto :goto_31

    .end local v16  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v3  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_88
    move-object/from16 v16, v3

    .line 7837
    .end local v3  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v10  # "i":I
    .restart local v16  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-eqz v8, :cond_93

    iget v3, v8, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;->bestDomainVerificationStatus:I

    const/4 v4, 0x3

    if-ne v3, v4, :cond_93

    .line 7839
    const/4 v3, 0x0

    return-object v3

    .line 7841
    :cond_93
    return-object v8

    .line 7807
    .end local v8  # "result":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .end local v9  # "size":I
    .end local v16  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v3  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_94
    move-object/from16 v16, v3

    move-object v3, v4

    .line 7808
    .end local v3  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v16  # "resultTargetUser":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :goto_97
    return-object v3
.end method

.method private getDefaultDialerPackageName(I)Ljava/lang/String;
    .registers 5
    .param p1, "userId"  # I

    .line 14631
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 14632
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultDialerProvider:Landroid/content/pm/PackageManagerInternal$DefaultDialerProvider;

    .line 14633
    .local v1, "provider":Landroid/content/pm/PackageManagerInternal$DefaultDialerProvider;
    monitor-exit v0
    :try_end_6
    .catchall {:try_start_3 .. :try_end_6} :catchall_17

    .line 14634
    if-nez v1, :cond_12

    .line 14635
    const-string v0, "PackageManager"

    const-string/jumbo v2, "mDefaultDialerProvider is null"

    invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 14636
    const/4 v0, 0x0

    return-object v0

    .line 14638
    :cond_12
    invoke-interface {v1, p1}, Landroid/content/pm/PackageManagerInternal$DefaultDialerProvider;->getDefaultDialer(I)Ljava/lang/String;

    move-result-object v0

    return-object v0

    .line 14633
    .end local v1  # "provider":Landroid/content/pm/PackageManagerInternal$DefaultDialerProvider;
    :catchall_17
    move-exception v1

    :try_start_18
    monitor-exit v0
    :try_end_19
    .catchall {:try_start_18 .. :try_end_19} :catchall_17

    throw v1
.end method

.method private static getDefaultDisplayMetrics(Landroid/content/Context;Landroid/util/DisplayMetrics;)V
    .registers 4
    .param p0, "context"  # Landroid/content/Context;
    .param p1, "metrics"  # Landroid/util/DisplayMetrics;

    .line 2458
    const-string v0, "display"

    invoke-virtual {p0, v0}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/hardware/display/DisplayManager;

    .line 2460
    .local v0, "displayManager":Landroid/hardware/display/DisplayManager;
    const/4 v1, 0x0

    invoke-virtual {v0, v1}, Landroid/hardware/display/DisplayManager;->getDisplay(I)Landroid/view/Display;

    move-result-object v1

    invoke-virtual {v1, p1}, Landroid/view/Display;->getMetrics(Landroid/util/DisplayMetrics;)V

    .line 2461
    return-void
.end method

.method private getDefaultHomeActivity(I)Landroid/content/ComponentName;
    .registers 10
    .param p1, "userId"  # I

    .line 21861
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 21862
    .local v0, "allHomeCandidates":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-virtual {p0, v0, p1}, Lcom/android/server/pm/PackageManagerService;->getHomeActivitiesAsUser(Ljava/util/List;I)Landroid/content/ComponentName;

    move-result-object v1

    .line 21863
    .local v1, "cn":Landroid/content/ComponentName;
    if-eqz v1, :cond_c

    .line 21864
    return-object v1

    .line 21869
    :cond_c
    const/high16 v2, -0x80000000

    .line 21870
    .local v2, "lastPriority":I
    const/4 v3, 0x0

    .line 21871
    .local v3, "lastComponent":Landroid/content/ComponentName;
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v4

    .line 21872
    .local v4, "size":I
    const/4 v5, 0x0

    .local v5, "i":I
    :goto_14
    if-ge v5, v4, :cond_31

    .line 21873
    invoke-interface {v0, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/ResolveInfo;

    .line 21874
    .local v6, "ri":Landroid/content/pm/ResolveInfo;
    iget v7, v6, Landroid/content/pm/ResolveInfo;->priority:I

    if-le v7, v2, :cond_29

    .line 21875
    iget-object v7, v6, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    invoke-virtual {v7}, Landroid/content/pm/ActivityInfo;->getComponentName()Landroid/content/ComponentName;

    move-result-object v3

    .line 21876
    iget v2, v6, Landroid/content/pm/ResolveInfo;->priority:I

    goto :goto_2e

    .line 21877
    :cond_29
    iget v7, v6, Landroid/content/pm/ResolveInfo;->priority:I

    if-ne v7, v2, :cond_2e

    .line 21879
    const/4 v3, 0x0

    .line 21872
    .end local v6  # "ri":Landroid/content/pm/ResolveInfo;
    :cond_2e
    :goto_2e
    add-int/lit8 v5, v5, 0x1

    goto :goto_14

    .line 21882
    .end local v5  # "i":I
    :cond_31
    return-object v3
.end method

.method private getDefaultVerificationResponse(Landroid/os/UserHandle;)I
    .registers 5
    .param p1, "user"  # Landroid/os/UserHandle;

    .line 14832
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {p1}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v1

    const-string v2, "ensure_verify_apps"

    invoke-virtual {v0, v2, v1}, Lcom/android/server/pm/UserManagerService;->hasUserRestriction(Ljava/lang/String;I)Z

    move-result v0

    if-eqz v0, :cond_10

    .line 14833
    const/4 v0, -0x1

    return v0

    .line 14835
    :cond_10
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const/4 v1, 0x1

    const-string/jumbo v2, "verifier_default_response"

    invoke-static {v0, v2, v1}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v0

    return v0
.end method

.method private getDeviceConfiguratorPackageName()Ljava/lang/String;
    .registers 3

    .line 22099
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const v1, 0x1040165

    invoke-virtual {v0, v1}, Landroid/content/Context;->getString(I)Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->ensureSystemPackageName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method private getDeviceIdleController()Lcom/android/server/DeviceIdleController$LocalService;
    .registers 2

    .line 5238
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDeviceIdleController:Lcom/android/server/DeviceIdleController$LocalService;

    if-nez v0, :cond_e

    .line 5239
    const-class v0, Lcom/android/server/DeviceIdleController$LocalService;

    .line 5240
    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/DeviceIdleController$LocalService;

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDeviceIdleController:Lcom/android/server/DeviceIdleController$LocalService;

    .line 5242
    :cond_e
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDeviceIdleController:Lcom/android/server/DeviceIdleController$LocalService;

    return-object v0
.end method

.method private getDocumenterPackageName()Ljava/lang/String;
    .registers 6

    .line 22079
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.OPEN_DOCUMENT"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 22080
    .local v0, "intent":Landroid/content/Intent;
    const-string v1, "android.intent.category.OPENABLE"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 22081
    const-string v1, "*/*"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->setType(Ljava/lang/String;)Landroid/content/Intent;

    .line 22082
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v1

    invoke-virtual {v0, v1}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;

    move-result-object v1

    .line 22084
    .local v1, "resolvedType":Ljava/lang/String;
    nop

    .line 22087
    invoke-static {}, Landroid/os/UserHandle;->myUserId()I

    move-result v2

    .line 22084
    const v3, 0x1c0200

    invoke-direct {p0, v0, v1, v3, v2}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v2

    .line 22088
    .local v2, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v3

    const/4 v4, 0x1

    if-ne v3, v4, :cond_3c

    .line 22089
    const/4 v3, 0x0

    invoke-interface {v2, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v3}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v3

    iget-object v3, v3, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v3

    .line 22091
    :cond_3c
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "There should probably be exactly one documenter; found "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 22092
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, ": matches="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 22091
    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 22093
    const/4 v3, 0x0

    return-object v3
.end method

.method private getDomainVerificationStatusLPr(Lcom/android/server/pm/PackageSetting;I)J
    .registers 10
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "userId"  # I

    .line 8196
    invoke-virtual {p1, p2}, Lcom/android/server/pm/PackageSetting;->getDomainVerificationStatusForUser(I)J

    move-result-wide v0

    .line 8198
    .local v0, "result":J
    const/16 v2, 0x20

    shr-long v3, v0, v2

    const-wide/16 v5, 0x0

    cmp-long v3, v3, v5

    if-nez v3, :cond_1f

    .line 8199
    invoke-virtual {p1}, Lcom/android/server/pm/PackageSetting;->getIntentFilterVerificationInfo()Landroid/content/pm/IntentFilterVerificationInfo;

    move-result-object v3

    if-eqz v3, :cond_1f

    .line 8200
    invoke-virtual {p1}, Lcom/android/server/pm/PackageSetting;->getIntentFilterVerificationInfo()Landroid/content/pm/IntentFilterVerificationInfo;

    move-result-object v3

    invoke-virtual {v3}, Landroid/content/pm/IntentFilterVerificationInfo;->getStatus()I

    move-result v3

    int-to-long v3, v3

    shl-long v0, v3, v2

    .line 8203
    :cond_1f
    return-wide v0
.end method

.method static getEncryptKey()Ljava/lang/String;
    .registers 7

    .line 23542
    const-string v0, "AppsOnSD"

    const-string v1, "PackageManager"

    const/4 v2, 0x0

    :try_start_5
    invoke-static {}, Landroid/security/SystemKeyStore;->getInstance()Landroid/security/SystemKeyStore;

    move-result-object v3

    invoke-virtual {v3, v0}, Landroid/security/SystemKeyStore;->retrieveKeyHexString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    .line 23544
    .local v3, "sdEncKey":Ljava/lang/String;
    if-nez v3, :cond_24

    .line 23545
    invoke-static {}, Landroid/security/SystemKeyStore;->getInstance()Landroid/security/SystemKeyStore;

    move-result-object v4

    const/16 v5, 0x80

    const-string v6, "AES"

    invoke-virtual {v4, v5, v6, v0}, Landroid/security/SystemKeyStore;->generateNewKeyHexString(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    move-object v3, v0

    .line 23547
    if-nez v3, :cond_24

    .line 23548
    const-string v0, "Failed to create encryption keys"

    invoke-static {v1, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_23
    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_5 .. :try_end_23} :catch_3b
    .catch Ljava/io/IOException; {:try_start_5 .. :try_end_23} :catch_25

    .line 23549
    return-object v2

    .line 23552
    :cond_24
    return-object v3

    .line 23556
    .end local v3  # "sdEncKey":Ljava/lang/String;
    :catch_25
    move-exception v0

    .line 23557
    .local v0, "ioe":Ljava/io/IOException;
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Failed to retrieve encryption keys with exception: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v1, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 23558
    return-object v2

    .line 23553
    .end local v0  # "ioe":Ljava/io/IOException;
    :catch_3b
    move-exception v0

    .line 23554
    .local v0, "nsae":Ljava/security/NoSuchAlgorithmException;
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Failed to create encryption keys with exception: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v1, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 23555
    return-object v2
.end method

.method private getHomeFilter()Landroid/content/IntentFilter;
    .registers 3

    .line 21893
    new-instance v0, Landroid/content/IntentFilter;

    const-string v1, "android.intent.action.MAIN"

    invoke-direct {v0, v1}, Landroid/content/IntentFilter;-><init>(Ljava/lang/String;)V

    .line 21894
    .local v0, "filter":Landroid/content/IntentFilter;
    const-string v1, "android.intent.category.HOME"

    invoke-virtual {v0, v1}, Landroid/content/IntentFilter;->addCategory(Ljava/lang/String;)V

    .line 21895
    const-string v1, "android.intent.category.DEFAULT"

    invoke-virtual {v0, v1}, Landroid/content/IntentFilter;->addCategory(Ljava/lang/String;)V

    .line 21896
    return-object v0
.end method

.method private getHomeIntent()Landroid/content/Intent;
    .registers 3

    .line 21886
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.MAIN"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 21887
    .local v0, "intent":Landroid/content/Intent;
    const-string v1, "android.intent.category.HOME"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 21888
    const-string v1, "android.intent.category.DEFAULT"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 21889
    return-object v0
.end method

.method private getInstalledApplicationsListInternal(III)Ljava/util/List;
    .registers 14
    .param p1, "flags"  # I
    .param p2, "userId"  # I
    .param p3, "callingUid"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(III)",
            "Ljava/util/List<",
            "Landroid/content/pm/ApplicationInfo;",
            ">;"
        }
    .end annotation

    .line 9062
    invoke-direct {p0, p3}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_b

    .line 9063
    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v0

    return-object v0

    .line 9065
    :cond_b
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p2}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_18

    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v0

    return-object v0

    .line 9066
    :cond_18
    const/4 v0, 0x0

    invoke-direct {p0, p1, p2, v0}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForApplication(IILjava/lang/Object;)I

    move-result p1

    .line 9067
    const v0, 0x402000

    and-int/2addr v0, p1

    if-eqz v0, :cond_25

    const/4 v0, 0x1

    goto :goto_26

    :cond_25
    const/4 v0, 0x0

    .line 9069
    .local v0, "listUninstalled":Z
    :goto_26
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v4, 0x0

    const/4 v5, 0x0

    const-string v6, "get installed application info"

    move v2, p3

    move v3, p2

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 9076
    const/4 v1, 0x0

    .line 9077
    .local v1, "callOutOfSystem":Z
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-static {}, Landroid/os/Process;->myPid()I

    move-result v3

    if-eq v2, v3, :cond_3d

    .line 9078
    const/4 v1, 0x1

    .line 9083
    :cond_3d
    const/16 v2, 0x38

    .line 9084
    invoke-static {v2}, Lmeizu/security/FlymePermissionManager;->isFlymePermissionGranted(I)Z

    move-result v2

    if-nez v2, :cond_4b

    .line 9085
    new-instance v2, Ljava/util/ArrayList;

    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V

    .line 9086
    .local v2, "empty":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    return-object v2

    .line 9091
    .end local v2  # "empty":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    :cond_4b
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 9093
    if-eqz v0, :cond_c0

    .line 9094
    :try_start_50
    new-instance v3, Ljava/util/ArrayList;

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4}, Landroid/util/ArrayMap;->size()I

    move-result v4

    invoke-direct {v3, v4}, Ljava/util/ArrayList;-><init>(I)V

    .line 9095
    .local v3, "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v4

    invoke-interface {v4}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_69
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_bf

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 9097
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    move v6, p1

    .line 9098
    .local v6, "effectiveFlags":I
    invoke-virtual {v5}, Lcom/android/server/pm/PackageSetting;->isSystem()Z

    move-result v7

    if-eqz v7, :cond_7f

    .line 9099
    const/high16 v7, 0x400000

    or-int/2addr v6, v7

    .line 9101
    :cond_7f
    iget-object v7, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v7, :cond_a6

    .line 9102
    invoke-direct {p0, v5, p3, p2, p1}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v7

    if-eqz v7, :cond_8a

    .line 9103
    goto :goto_69

    .line 9105
    :cond_8a
    invoke-direct {p0, v5, p3, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v7

    if-eqz v7, :cond_91

    .line 9106
    goto :goto_69

    .line 9108
    :cond_91
    iget-object v7, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 9109
    invoke-virtual {v5, p2}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v8

    .line 9108
    invoke-static {v7, v6, v8, p2}, Landroid/content/pm/PackageParser;->generateApplicationInfo(Landroid/content/pm/PackageParser$Package;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v7

    .line 9110
    .local v7, "ai":Landroid/content/pm/ApplicationInfo;
    if-eqz v7, :cond_ac

    .line 9111
    iget-object v8, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-direct {p0, v8}, Lcom/android/server/pm/PackageManagerService;->resolveExternalPackageNameLPr(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;

    move-result-object v8

    iput-object v8, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    goto :goto_ac

    .line 9116
    .end local v7  # "ai":Landroid/content/pm/ApplicationInfo;
    :cond_a6
    iget-object v7, v5, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-direct {p0, v7, p3, v6, p2}, Lcom/android/server/pm/PackageManagerService;->generateApplicationInfoFromSettingsLPw(Ljava/lang/String;III)Landroid/content/pm/ApplicationInfo;

    move-result-object v7

    .line 9119
    .restart local v7  # "ai":Landroid/content/pm/ApplicationInfo;
    :cond_ac
    :goto_ac
    if-eqz v7, :cond_be

    .line 9121
    if-eqz v1, :cond_bb

    const-string v8, "com.meizu.regservice"

    iget-object v9, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_bb

    .line 9123
    goto :goto_69

    .line 9126
    :cond_bb
    invoke-virtual {v3, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 9128
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "effectiveFlags":I
    .end local v7  # "ai":Landroid/content/pm/ApplicationInfo;
    :cond_be
    goto :goto_69

    :cond_bf
    goto :goto_11d

    .line 9130
    .end local v3  # "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    :cond_c0
    new-instance v3, Ljava/util/ArrayList;

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4}, Landroid/util/ArrayMap;->size()I

    move-result v4

    invoke-direct {v3, v4}, Ljava/util/ArrayList;-><init>(I)V

    .line 9131
    .restart local v3  # "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v4

    invoke-interface {v4}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_d5
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_11d

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Package;

    .line 9132
    .local v5, "p":Landroid/content/pm/PackageParser$Package;
    iget-object v6, v5, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    if-eqz v6, :cond_11c

    .line 9133
    iget-object v6, v5, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    .line 9134
    .local v6, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    invoke-direct {p0, v6, v7, p2, p1}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v7

    if-eqz v7, :cond_f4

    .line 9135
    goto :goto_d5

    .line 9137
    :cond_f4
    invoke-direct {p0, v6, p3, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v7

    if-eqz v7, :cond_fb

    .line 9138
    goto :goto_d5

    .line 9140
    :cond_fb
    nop

    .line 9141
    invoke-virtual {v6, p2}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v7

    .line 9140
    invoke-static {v5, p1, v7, p2}, Landroid/content/pm/PackageParser;->generateApplicationInfo(Landroid/content/pm/PackageParser$Package;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v7

    .line 9142
    .restart local v7  # "ai":Landroid/content/pm/ApplicationInfo;
    if-eqz v7, :cond_11c

    .line 9143
    invoke-direct {p0, v5}, Lcom/android/server/pm/PackageManagerService;->resolveExternalPackageNameLPr(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;

    move-result-object v8

    iput-object v8, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 9145
    if-eqz v1, :cond_119

    const-string v8, "com.meizu.regservice"

    iget-object v9, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_119

    .line 9147
    goto :goto_d5

    .line 9150
    :cond_119
    invoke-virtual {v3, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 9153
    .end local v5  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "ai":Landroid/content/pm/ApplicationInfo;
    :cond_11c
    goto :goto_d5

    .line 9156
    :cond_11d
    :goto_11d
    monitor-exit v2

    return-object v3

    .line 9157
    .end local v3  # "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    :catchall_11f
    move-exception v3

    monitor-exit v2
    :try_end_121
    .catchall {:try_start_50 .. :try_end_121} :catchall_11f

    throw v3
.end method

.method private getInstallerSettings()I
    .registers 4

    .line 26956
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string v1, "flyme_installer_settings"

    const/4 v2, 0x0

    invoke-static {v0, v1, v2}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v0

    return v0
.end method

.method private getInstantAppInstallerLPr()Landroid/content/pm/ActivityInfo;
    .registers 12
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 4116
    sget-boolean v0, Landroid/os/Build;->IS_ENG:Z

    const-string v1, "android.intent.action.INSTALL_INSTANT_APP_PACKAGE"

    if-eqz v0, :cond_d

    .line 4117
    const-string v0, "android.intent.action.INSTALL_INSTANT_APP_PACKAGE_TEST"

    filled-new-array {v0, v1}, [Ljava/lang/String;

    move-result-object v0

    goto :goto_11

    .line 4120
    :cond_d
    filled-new-array {v1}, [Ljava/lang/String;

    move-result-object v0

    :goto_11
    nop

    .line 4123
    .local v0, "orderedActions":[Ljava/lang/String;
    const v1, 0xc0200

    .line 4127
    sget-boolean v2, Landroid/os/Build;->IS_ENG:Z

    const/4 v3, 0x0

    if-nez v2, :cond_1d

    const/high16 v2, 0x100000

    goto :goto_1e

    :cond_1d
    move v2, v3

    :goto_1e
    or-int/2addr v1, v2

    .line 4128
    .local v1, "resolveFlags":I
    new-instance v2, Landroid/content/Intent;

    invoke-direct {v2}, Landroid/content/Intent;-><init>()V

    .line 4129
    .local v2, "intent":Landroid/content/Intent;
    const-string v4, "android.intent.category.DEFAULT"

    invoke-virtual {v2, v4}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 4130
    new-instance v4, Ljava/io/File;

    const-string v5, "foo.apk"

    invoke-direct {v4, v5}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-static {v4}, Landroid/net/Uri;->fromFile(Ljava/io/File;)Landroid/net/Uri;

    move-result-object v4

    const-string v5, "application/vnd.android.package-archive"

    invoke-virtual {v2, v4, v5}, Landroid/content/Intent;->setDataAndType(Landroid/net/Uri;Ljava/lang/String;)Landroid/content/Intent;

    .line 4131
    const/4 v4, 0x0

    .line 4132
    .local v4, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    array-length v6, v0

    move-object v7, v4

    move v4, v3

    .end local v4  # "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v7, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :goto_3d
    if-ge v4, v6, :cond_6b

    aget-object v8, v0, v4

    .line 4133
    .local v8, "action":Ljava/lang/String;
    invoke-virtual {v2, v8}, Landroid/content/Intent;->setAction(Ljava/lang/String;)Landroid/content/Intent;

    .line 4134
    invoke-direct {p0, v2, v5, v1, v3}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v7

    .line 4136
    invoke-interface {v7}, Ljava/util/List;->isEmpty()Z

    move-result v9

    if-eqz v9, :cond_6b

    .line 4137
    sget-boolean v9, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v9, :cond_68

    .line 4138
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Instant App installer not found with "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    const-string v10, "PackageManager"

    invoke-static {v10, v9}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 4132
    .end local v8  # "action":Ljava/lang/String;
    :cond_68
    add-int/lit8 v4, v4, 0x1

    goto :goto_3d

    .line 4144
    :cond_6b
    invoke-interface {v7}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .line 4145
    .local v4, "iter":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/ResolveInfo;>;"
    :cond_6f
    :goto_6f
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_a0

    .line 4146
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/ResolveInfo;

    .line 4147
    .local v5, "rInfo":Landroid/content/pm/ResolveInfo;
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v6, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v8, v5, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v8}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    .line 4148
    .local v6, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v6, :cond_9c

    .line 4149
    invoke-virtual {v6}, Lcom/android/server/pm/PackageSetting;->getPermissionsState()Lcom/android/server/pm/permission/PermissionsState;

    move-result-object v8

    .line 4150
    .local v8, "permissionsState":Lcom/android/server/pm/permission/PermissionsState;
    const-string v9, "android.permission.INSTALL_PACKAGES"

    invoke-virtual {v8, v9, v3}, Lcom/android/server/pm/permission/PermissionsState;->hasPermission(Ljava/lang/String;I)Z

    move-result v9

    if-nez v9, :cond_6f

    sget-boolean v9, Landroid/os/Build;->IS_ENG:Z

    if-eqz v9, :cond_9c

    .line 4152
    goto :goto_6f

    .line 4155
    .end local v8  # "permissionsState":Lcom/android/server/pm/permission/PermissionsState;
    :cond_9c
    invoke-interface {v4}, Ljava/util/Iterator;->remove()V

    .line 4156
    .end local v5  # "rInfo":Landroid/content/pm/ResolveInfo;
    .end local v6  # "ps":Lcom/android/server/pm/PackageSetting;
    goto :goto_6f

    .line 4157
    :cond_a0
    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v5

    if-nez v5, :cond_a8

    .line 4158
    const/4 v3, 0x0

    return-object v3

    .line 4159
    :cond_a8
    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v5

    const/4 v6, 0x1

    if-ne v5, v6, :cond_bc

    .line 4160
    invoke-interface {v7, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v3}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ActivityInfo;

    return-object v3

    .line 4162
    :cond_bc
    new-instance v3, Ljava/lang/RuntimeException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "There must be at most one ephemeral installer; found "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v3, v5}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    throw v3
.end method

.method private getInstantAppPackageName(I)Ljava/lang/String;
    .registers 8
    .param p1, "callingUid"  # I

    .line 7473
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 7475
    :try_start_3
    invoke-static {p1}, Landroid/os/Process;->isIsolated(I)Z

    move-result v1

    if-eqz v1, :cond_10

    .line 7476
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mIsolatedOwners:Landroid/util/SparseIntArray;

    invoke-virtual {v1, p1}, Landroid/util/SparseIntArray;->get(I)I

    move-result v1

    move p1, v1

    .line 7478
    :cond_10
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v1

    .line 7479
    .local v1, "appId":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v1}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v2

    .line 7480
    .local v2, "obj":Ljava/lang/Object;
    instance-of v3, v2, Lcom/android/server/pm/PackageSetting;

    const/4 v4, 0x0

    if-eqz v3, :cond_32

    .line 7481
    move-object v3, v2

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 7482
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {p1}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v5

    invoke-virtual {v3, v5}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v5

    .line 7483
    .local v5, "isInstantApp":Z
    if-eqz v5, :cond_30

    iget-object v4, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    :cond_30
    monitor-exit v0

    return-object v4

    .line 7485
    .end local v1  # "appId":I
    .end local v2  # "obj":Ljava/lang/Object;
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "isInstantApp":Z
    :cond_32
    monitor-exit v0

    .line 7486
    return-object v4

    .line 7485
    :catchall_34
    move-exception v1

    monitor-exit v0
    :try_end_36
    .catchall {:try_start_3 .. :try_end_36} :catchall_34

    throw v1
.end method

.method private getInstantAppResolverLPr()Landroid/util/Pair;
    .registers 17
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Landroid/util/Pair<",
            "Landroid/content/ComponentName;",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 4059
    move-object/from16 v7, p0

    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 4060
    invoke-virtual {v0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v0

    const v1, 0x1070036

    invoke-virtual {v0, v1}, Landroid/content/res/Resources;->getStringArray(I)[Ljava/lang/String;

    move-result-object v8

    .line 4061
    .local v8, "packageArray":[Ljava/lang/String;
    array-length v0, v8

    const/4 v9, 0x0

    const-string v10, "PackageManager"

    if-nez v0, :cond_23

    sget-boolean v0, Landroid/os/Build;->IS_DEBUGGABLE:Z

    if-nez v0, :cond_23

    .line 4062
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v0, :cond_22

    .line 4063
    const-string v0, "Ephemeral resolver NOT found; empty package list"

    invoke-static {v10, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 4065
    :cond_22
    return-object v9

    .line 4068
    :cond_23
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v11

    .line 4069
    .local v11, "callingUid":I
    const/high16 v0, 0xc0000

    .line 4072
    sget-boolean v1, Landroid/os/Build;->IS_DEBUGGABLE:Z

    if-nez v1, :cond_30

    const/high16 v1, 0x100000

    goto :goto_31

    :cond_30
    const/4 v1, 0x0

    :goto_31
    or-int v12, v1, v0

    .line 4073
    .local v12, "resolveFlags":I
    const-string v13, "android.intent.action.RESOLVE_INSTANT_APP_PACKAGE"

    .line 4074
    .local v13, "actionName":Ljava/lang/String;
    new-instance v1, Landroid/content/Intent;

    invoke-direct {v1, v13}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 4075
    .local v1, "resolverIntent":Landroid/content/Intent;
    const/4 v2, 0x0

    const/4 v4, 0x0

    const/4 v6, 0x0

    move-object/from16 v0, p0

    move v3, v12

    move v5, v11

    invoke-direct/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->queryIntentServicesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZ)Ljava/util/List;

    move-result-object v0

    .line 4077
    .local v0, "resolvers":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v2

    .line 4078
    .local v2, "N":I
    if-nez v2, :cond_55

    .line 4079
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v3, :cond_54

    .line 4080
    const-string v3, "Ephemeral resolver NOT found; no matching intent filters"

    invoke-static {v10, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 4082
    :cond_54
    return-object v9

    .line 4085
    :cond_55
    new-instance v3, Landroid/util/ArraySet;

    invoke-static {v8}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;

    move-result-object v4

    invoke-direct {v3, v4}, Landroid/util/ArraySet;-><init>(Ljava/util/Collection;)V

    .line 4086
    .local v3, "possiblePackages":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    const/4 v4, 0x0

    .local v4, "i":I
    :goto_5f
    if-ge v4, v2, :cond_cb

    .line 4087
    invoke-interface {v0, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/ResolveInfo;

    .line 4089
    .local v5, "info":Landroid/content/pm/ResolveInfo;
    iget-object v6, v5, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    if-nez v6, :cond_6c

    .line 4090
    goto :goto_9a

    .line 4093
    :cond_6c
    iget-object v6, v5, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v6, v6, Landroid/content/pm/ServiceInfo;->packageName:Ljava/lang/String;

    .line 4094
    .local v6, "packageName":Ljava/lang/String;
    invoke-interface {v3, v6}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v14

    const-string v15, ", info:"

    if-nez v14, :cond_9e

    sget-boolean v14, Landroid/os/Build;->IS_DEBUGGABLE:Z

    if-nez v14, :cond_9e

    .line 4095
    sget-boolean v14, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v14, :cond_9a

    .line 4096
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Ephemeral resolver not in allowed package list; pkg: "

    invoke-virtual {v14, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v10, v9}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 4086
    .end local v5  # "info":Landroid/content/pm/ResolveInfo;
    .end local v6  # "packageName":Ljava/lang/String;
    :cond_9a
    :goto_9a
    add-int/lit8 v4, v4, 0x1

    const/4 v9, 0x0

    goto :goto_5f

    .line 4102
    .restart local v5  # "info":Landroid/content/pm/ResolveInfo;
    .restart local v6  # "packageName":Ljava/lang/String;
    :cond_9e
    sget-boolean v9, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v9, :cond_bc

    .line 4103
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Ephemeral resolver found; pkg: "

    invoke-virtual {v9, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v10, v9}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 4106
    :cond_bc
    new-instance v9, Landroid/util/Pair;

    new-instance v10, Landroid/content/ComponentName;

    iget-object v14, v5, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v14, v14, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    invoke-direct {v10, v6, v14}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-direct {v9, v10, v13}, Landroid/util/Pair;-><init>(Ljava/lang/Object;Ljava/lang/Object;)V

    return-object v9

    .line 4108
    .end local v4  # "i":I
    .end local v5  # "info":Landroid/content/pm/ResolveInfo;
    .end local v6  # "packageName":Ljava/lang/String;
    :cond_cb
    sget-boolean v4, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v4, :cond_d4

    .line 4109
    const-string v4, "Ephemeral resolver NOT found"

    invoke-static {v10, v4}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 4111
    :cond_d4
    const/4 v4, 0x0

    return-object v4
.end method

.method private getInstantAppResolverSettingsLPr(Landroid/content/ComponentName;)Landroid/content/ComponentName;
    .registers 8
    .param p1, "resolver"  # Landroid/content/ComponentName;

    .line 4169
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.INSTANT_APP_RESOLVER_SETTINGS"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 4170
    const-string v1, "android.intent.category.DEFAULT"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    move-result-object v0

    .line 4171
    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Landroid/content/Intent;->setPackage(Ljava/lang/String;)Landroid/content/Intent;

    move-result-object v0

    .line 4172
    .local v0, "intent":Landroid/content/Intent;
    const/high16 v1, 0xc0000

    .line 4173
    .local v1, "resolveFlags":I
    const/4 v2, 0x0

    const/4 v3, 0x0

    const/high16 v4, 0xc0000

    invoke-direct {p0, v0, v3, v4, v2}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v4

    .line 4175
    .local v4, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v4}, Ljava/util/List;->isEmpty()Z

    move-result v5

    if-eqz v5, :cond_26

    .line 4176
    return-object v3

    .line 4178
    :cond_26
    invoke-interface {v4, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v2}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v2

    invoke-virtual {v2}, Landroid/content/pm/ComponentInfo;->getComponentName()Landroid/content/ComponentName;

    move-result-object v2

    return-object v2
.end method

.method private getIntentFilterVerifierComponentNameLPr()Landroid/content/ComponentName;
    .registers 10

    .line 4017
    new-instance v1, Landroid/content/Intent;

    const-string v0, "android.intent.action.INTENT_FILTER_NEEDS_VERIFICATION"

    invoke-direct {v1, v0}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 4019
    .local v1, "intent":Landroid/content/Intent;
    const-string v2, "application/vnd.android.package-archive"

    const/high16 v3, 0x1c0000

    const/4 v4, 0x0

    const/4 v5, 0x0

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/pm/PackageManagerService;->queryIntentReceiversInternal(Landroid/content/Intent;Ljava/lang/String;IIZ)Ljava/util/List;

    move-result-object v0

    .line 4022
    .local v0, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/4 v2, 0x0

    .line 4023
    .local v2, "best":Landroid/content/pm/ResolveInfo;
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v3

    .line 4024
    .local v3, "N":I
    const/4 v4, 0x0

    .local v4, "i":I
    :goto_18
    if-ge v4, v3, :cond_3c

    .line 4025
    invoke-interface {v0, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/ResolveInfo;

    .line 4026
    .local v5, "cur":Landroid/content/pm/ResolveInfo;
    invoke-virtual {v5}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v6

    iget-object v6, v6, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    .line 4027
    .local v6, "packageName":Ljava/lang/String;
    const/4 v7, 0x0

    const-string v8, "android.permission.INTENT_FILTER_VERIFICATION_AGENT"

    invoke-virtual {p0, v8, v6, v7}, Lcom/android/server/pm/PackageManagerService;->checkPermission(Ljava/lang/String;Ljava/lang/String;I)I

    move-result v7

    if-eqz v7, :cond_30

    .line 4029
    goto :goto_39

    .line 4032
    :cond_30
    if-eqz v2, :cond_38

    iget v7, v5, Landroid/content/pm/ResolveInfo;->priority:I

    iget v8, v2, Landroid/content/pm/ResolveInfo;->priority:I

    if-le v7, v8, :cond_39

    .line 4033
    :cond_38
    move-object v2, v5

    .line 4024
    .end local v5  # "cur":Landroid/content/pm/ResolveInfo;
    .end local v6  # "packageName":Ljava/lang/String;
    :cond_39
    :goto_39
    add-int/lit8 v4, v4, 0x1

    goto :goto_18

    .line 4037
    .end local v4  # "i":I
    :cond_3c
    if-eqz v2, :cond_47

    .line 4038
    invoke-virtual {v2}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v4

    invoke-virtual {v4}, Landroid/content/pm/ComponentInfo;->getComponentName()Landroid/content/ComponentName;

    move-result-object v4

    return-object v4

    .line 4040
    :cond_47
    const-string v4, "PackageManager"

    const-string v5, "Intent filter verifier not found"

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4041
    const/4 v4, 0x0

    return-object v4
.end method

.method private getLatestSharedLibraVersionLPr(Landroid/content/pm/PackageParser$Package;)Landroid/content/pm/SharedLibraryInfo;
    .registers 12
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 10643
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/util/LongSparseArray;

    .line 10645
    .local v0, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    const/4 v1, 0x0

    if-nez v0, :cond_e

    .line 10646
    return-object v1

    .line 10648
    :cond_e
    const-wide/16 v2, -0x1

    .line 10649
    .local v2, "previousLibVersion":J
    invoke-virtual {v0}, Landroid/util/LongSparseArray;->size()I

    move-result v4

    .line 10650
    .local v4, "versionCount":I
    const/4 v5, 0x0

    .local v5, "i":I
    :goto_15
    if-ge v5, v4, :cond_28

    .line 10651
    invoke-virtual {v0, v5}, Landroid/util/LongSparseArray;->keyAt(I)J

    move-result-wide v6

    .line 10652
    .local v6, "libVersion":J
    iget-wide v8, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibVersion:J

    cmp-long v8, v6, v8

    if-gez v8, :cond_25

    .line 10653
    invoke-static {v2, v3, v6, v7}, Ljava/lang/Math;->max(JJ)J

    move-result-wide v2

    .line 10650
    .end local v6  # "libVersion":J
    :cond_25
    add-int/lit8 v5, v5, 0x1

    goto :goto_15

    .line 10656
    .end local v5  # "i":I
    :cond_28
    const-wide/16 v5, 0x0

    cmp-long v5, v2, v5

    if-ltz v5, :cond_35

    .line 10657
    invoke-virtual {v0, v2, v3}, Landroid/util/LongSparseArray;->get(J)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/SharedLibraryInfo;

    return-object v1

    .line 10659
    :cond_35
    return-object v1
.end method

.method private getMatchingCrossProfileIntentFilters(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;
    .registers 6
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "I)",
            "Ljava/util/List<",
            "Lcom/android/server/pm/CrossProfileIntentFilter;",
            ">;"
        }
    .end annotation

    .line 7448
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mCrossProfileIntentResolvers:Landroid/util/SparseArray;

    invoke-virtual {v0, p3}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/CrossProfileIntentResolver;

    .line 7449
    .local v0, "resolver":Lcom/android/server/pm/CrossProfileIntentResolver;
    if-eqz v0, :cond_12

    .line 7450
    const/4 v1, 0x0

    invoke-virtual {v0, p1, p2, v1, p3}, Lcom/android/server/pm/CrossProfileIntentResolver;->queryIntent(Landroid/content/Intent;Ljava/lang/String;ZI)Ljava/util/List;

    move-result-object v1

    return-object v1

    .line 7452
    :cond_12
    const/4 v1, 0x0

    return-object v1
.end method

.method private getNextCodePath(Ljava/io/File;Ljava/lang/String;)Ljava/io/File;
    .registers 9
    .param p1, "targetDir"  # Ljava/io/File;
    .param p2, "packageName"  # Ljava/lang/String;

    .line 16703
    new-instance v0, Ljava/security/SecureRandom;

    invoke-direct {v0}, Ljava/security/SecureRandom;-><init>()V

    .line 16704
    .local v0, "random":Ljava/security/SecureRandom;
    const/16 v1, 0x10

    new-array v1, v1, [B

    .line 16706
    .local v1, "bytes":[B
    :goto_9
    invoke-virtual {v0, v1}, Ljava/security/SecureRandom;->nextBytes([B)V

    .line 16707
    const/16 v2, 0xa

    invoke-static {v1, v2}, Landroid/util/Base64;->encodeToString([BI)Ljava/lang/String;

    move-result-object v2

    .line 16708
    .local v2, "suffix":Ljava/lang/String;
    new-instance v3, Ljava/io/File;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, "-"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, p1, v4}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    move-object v2, v3

    .line 16709
    .local v2, "result":Ljava/io/File;
    invoke-virtual {v2}, Ljava/io/File;->exists()Z

    move-result v3

    if-nez v3, :cond_33

    .line 16710
    return-object v2

    .line 16709
    :cond_33
    goto :goto_9
.end method

.method private getOatDir(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;
    .registers 5
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 26417
    invoke-virtual {p1}, Landroid/content/pm/PackageParser$Package;->canHaveOatDir()Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_8

    .line 26418
    return-object v1

    .line 26420
    :cond_8
    new-instance v0, Ljava/io/File;

    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-direct {v0, v2}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 26421
    .local v0, "codePath":Ljava/io/File;
    invoke-virtual {v0}, Ljava/io/File;->isDirectory()Z

    move-result v2

    if-eqz v2, :cond_1e

    .line 26422
    invoke-static {v0}, Lcom/android/server/pm/PackageDexOptimizer;->getOatDir(Ljava/io/File;)Ljava/io/File;

    move-result-object v1

    invoke-virtual {v1}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v1

    return-object v1

    .line 26424
    :cond_1e
    return-object v1
.end method

.method private getOptionalVerifierLPr()Ljava/lang/String;
    .registers 7

    .line 3930
    new-instance v1, Landroid/content/Intent;

    const-string v0, "com.qualcomm.qti.intent.action.PACKAGE_NEEDS_OPTIONAL_VERIFICATION"

    invoke-direct {v1, v0}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 3932
    .local v1, "intent":Landroid/content/Intent;
    const-string v2, "application/vnd.android.package-archive"

    const/high16 v3, 0x1c0000

    const/4 v4, 0x0

    const/4 v5, 0x0

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/pm/PackageManagerService;->queryIntentReceiversInternal(Landroid/content/Intent;Ljava/lang/String;IIZ)Ljava/util/List;

    move-result-object v0

    .line 3935
    .local v0, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v2

    const/4 v3, 0x0

    const/4 v4, 0x1

    if-lt v2, v4, :cond_57

    .line 3936
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v2

    const v4, 0x1040194

    invoke-virtual {v2, v4}, Landroid/content/res/Resources;->getString(I)Ljava/lang/String;

    move-result-object v2

    .line 3937
    .local v2, "optionalVerifierName":Ljava/lang/String;
    invoke-static {v2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v4

    if-eqz v4, :cond_2e

    .line 3938
    return-object v3

    .line 3939
    :cond_2e
    const/4 v4, 0x0

    .local v4, "i":I
    :goto_2f
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v5

    if-ge v4, v5, :cond_57

    .line 3940
    invoke-interface {v0, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v5}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v5

    iget-object v5, v5, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v2}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v5

    if-eqz v5, :cond_54

    .line 3941
    invoke-interface {v0, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v3}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v3

    iget-object v3, v3, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v3

    .line 3939
    :cond_54
    add-int/lit8 v4, v4, 0x1

    goto :goto_2f

    .line 3945
    .end local v2  # "optionalVerifierName":Ljava/lang/String;
    .end local v4  # "i":I
    :cond_57
    return-object v3
.end method

.method private getOriginalPackageLocked(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;
    .registers 9
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "renamedPkgName"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 11632
    invoke-static {p1, p2}, Lcom/android/server/pm/PackageManagerService;->isPackageRenamed(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_8

    .line 11633
    return-object v1

    .line 11635
    :cond_8
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_10
    if-ltz v0, :cond_9b

    .line 11636
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    .line 11637
    invoke-virtual {v3, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-virtual {v2, v3}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v2

    .line 11638
    .local v2, "originalPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v2, :cond_97

    .line 11641
    invoke-direct {p0, v2, p1}, Lcom/android/server/pm/PackageManagerService;->verifyPackageUpdateLPr(Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$Package;)Z

    move-result v3

    if-nez v3, :cond_29

    .line 11643
    goto :goto_97

    .line 11644
    :cond_29
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    const-string v4, "PackageManager"

    if-eqz v3, :cond_72

    .line 11645
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v3, v3, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    invoke-virtual {v3, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_96

    .line 11647
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unable to migrate data from "

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " to "

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, ": old uid "

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v2, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v5, v5, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " differs from "

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v4, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11651
    goto :goto_97

    .line 11655
    :cond_72
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_UPGRADE:Z

    if-eqz v1, :cond_96

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Renaming new package "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " to old name "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v4, v1}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 11658
    :cond_96
    return-object v2

    .line 11635
    .end local v2  # "originalPs":Lcom/android/server/pm/PackageSetting;
    :cond_97
    :goto_97
    add-int/lit8 v0, v0, -0x1

    goto/16 :goto_10

    .line 11661
    .end local v0  # "i":I
    :cond_9b
    return-object v1
.end method

.method private static getPackageExternalStorageType(Landroid/os/storage/VolumeInfo;Z)I
    .registers 4
    .param p0, "packageVolume"  # Landroid/os/storage/VolumeInfo;
    .param p1, "packageIsExternal"  # Z

    .line 2278
    if-eqz p0, :cond_1c

    .line 2279
    invoke-virtual {p0}, Landroid/os/storage/VolumeInfo;->getDisk()Landroid/os/storage/DiskInfo;

    move-result-object v0

    .line 2280
    .local v0, "disk":Landroid/os/storage/DiskInfo;
    if-eqz v0, :cond_1c

    .line 2281
    invoke-virtual {v0}, Landroid/os/storage/DiskInfo;->isSd()Z

    move-result v1

    if-eqz v1, :cond_10

    .line 2282
    const/4 v1, 0x1

    return v1

    .line 2284
    :cond_10
    invoke-virtual {v0}, Landroid/os/storage/DiskInfo;->isUsb()Z

    move-result v1

    if-eqz v1, :cond_18

    .line 2285
    const/4 v1, 0x2

    return v1

    .line 2287
    :cond_18
    if-eqz p1, :cond_1c

    .line 2288
    const/4 v1, 0x3

    return v1

    .line 2292
    .end local v0  # "disk":Landroid/os/storage/DiskInfo;
    :cond_1c
    const/4 v0, 0x0

    return v0
.end method

.method private getPackageInfoInternal(Ljava/lang/String;JIII)Landroid/content/pm/PackageInfo;
    .registers 16
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "versionCode"  # J
    .param p4, "flags"  # I
    .param p5, "filterCallingUid"  # I
    .param p6, "userId"  # I

    .line 4446
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p6}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    return-object v1

    .line 4447
    :cond_a
    invoke-direct {p0, p4, p6, p1}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForPackage(IILjava/lang/Object;)I

    move-result p4

    .line 4448
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v7, "get package info"

    move v4, p6

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 4452
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 4454
    :try_start_1f
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->resolveInternalPackageNameLPr(Ljava/lang/String;J)Ljava/lang/String;

    move-result-object v2

    move-object p1, v2

    .line 4456
    const/high16 v2, 0x200000

    and-int/2addr v2, p4

    const/4 v3, 0x1

    if-eqz v2, :cond_2c

    move v2, v3

    goto :goto_2d

    :cond_2c
    const/4 v2, 0x0

    .line 4457
    .local v2, "matchFactoryOnly":Z
    :goto_2d
    const/high16 v4, 0x40000000  # 2.0f

    if-eqz v2, :cond_5c

    .line 4459
    and-int v5, p4, v4

    if-eqz v5, :cond_3e

    .line 4460
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    const/4 v3, 0x2

    invoke-virtual {v1, p1, v3}, Lcom/android/server/pm/ApexManager;->getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 4463
    :cond_3e
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v5, p1}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v5

    .line 4464
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v5, :cond_5c

    .line 4465
    invoke-direct {p0, v5, p5, p6, p4}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v3

    if-eqz v3, :cond_4e

    .line 4466
    monitor-exit v0

    return-object v1

    .line 4468
    :cond_4e
    invoke-direct {p0, v5, p5, p6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-eqz v3, :cond_56

    .line 4469
    monitor-exit v0

    return-object v1

    .line 4471
    :cond_56
    invoke-direct {p0, v5, p4, p6}, Lcom/android/server/pm/PackageManagerService;->generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 4475
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_5c
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Package;

    .line 4476
    .local v5, "p":Landroid/content/pm/PackageParser$Package;
    if-eqz v2, :cond_70

    if-eqz v5, :cond_70

    invoke-static {v5}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v6

    if-nez v6, :cond_70

    .line 4477
    monitor-exit v0

    return-object v1

    .line 4479
    :cond_70
    sget-boolean v6, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_INFO:Z

    if-eqz v6, :cond_92

    .line 4480
    const-string v6, "PackageManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "getPackageInfo "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, ": "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 4481
    :cond_92
    if-eqz v5, :cond_b4

    .line 4482
    iget-object v3, v5, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 4483
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v3, p5, p6, p4}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v4

    if-eqz v4, :cond_a0

    .line 4484
    monitor-exit v0

    return-object v1

    .line 4486
    :cond_a0
    if-eqz v3, :cond_aa

    invoke-direct {p0, v3, p5, p6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v4

    if-eqz v4, :cond_aa

    .line 4487
    monitor-exit v0

    return-object v1

    .line 4489
    :cond_aa
    iget-object v1, v5, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    invoke-direct {p0, v1, p4, p6}, Lcom/android/server/pm/PackageManagerService;->generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 4491
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_b4
    if-nez v2, :cond_e0

    const v6, 0x402000

    and-int/2addr v6, p4

    if-eqz v6, :cond_e0

    .line 4492
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 4493
    .restart local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v3, :cond_ca

    monitor-exit v0

    return-object v1

    .line 4494
    :cond_ca
    invoke-direct {p0, v3, p5, p6, p4}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v4

    if-eqz v4, :cond_d2

    .line 4495
    monitor-exit v0

    return-object v1

    .line 4497
    :cond_d2
    invoke-direct {p0, v3, p5, p6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v4

    if-eqz v4, :cond_da

    .line 4498
    monitor-exit v0

    return-object v1

    .line 4500
    :cond_da
    invoke-direct {p0, v3, p4, p6}, Lcom/android/server/pm/PackageManagerService;->generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 4502
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_e0
    if-nez v2, :cond_ed

    and-int/2addr v4, p4

    if-eqz v4, :cond_ed

    .line 4503
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    invoke-virtual {v1, p1, v3}, Lcom/android/server/pm/ApexManager;->getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 4505
    .end local v2  # "matchFactoryOnly":Z
    .end local v5  # "p":Landroid/content/pm/PackageParser$Package;
    :cond_ed
    monitor-exit v0
    :try_end_ee
    .catchall {:try_start_1f .. :try_end_ee} :catchall_109

    .line 4507
    and-int/lit8 v0, p4, 0x40

    if-eqz v0, :cond_108

    .line 4508
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->flymePackageManagerService:Lcom/android/server/pm/FlymePackageManagerService;

    if-nez v0, :cond_101

    .line 4509
    nop

    .line 4510
    const-string v0, "flyme_packagemanager"

    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/FlymePackageManagerService;

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->flymePackageManagerService:Lcom/android/server/pm/FlymePackageManagerService;

    .line 4512
    :cond_101
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->flymePackageManagerService:Lcom/android/server/pm/FlymePackageManagerService;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/FlymePackageManagerService;->getRpkInfo(Ljava/lang/String;)Landroid/content/pm/PackageInfo;

    move-result-object v0

    return-object v0

    .line 4515
    :cond_108
    return-object v1

    .line 4505
    :catchall_109
    move-exception v1

    :try_start_10a
    monitor-exit v0
    :try_end_10b
    .catchall {:try_start_10a .. :try_end_10b} :catchall_109

    throw v1
.end method

.method private getPackageSizeInfoLI(Ljava/lang/String;ILandroid/content/pm/PackageStats;)Z
    .registers 16
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "stats"  # Landroid/content/pm/PackageStats;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock"
        }
    .end annotation

    .line 21044
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 21045
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 21046
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    const/4 v2, 0x0

    if-nez v1, :cond_28

    .line 21047
    const-string v3, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failed to find settings for "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 21048
    monitor-exit v0

    return v2

    .line 21050
    :cond_28
    monitor-exit v0
    :try_end_29
    .catchall {:try_start_3 .. :try_end_29} :catchall_6c

    .line 21052
    const/4 v0, 0x1

    new-array v5, v0, [Ljava/lang/String;

    aput-object p1, v5, v2

    .line 21053
    .local v5, "packageNames":[Ljava/lang/String;
    new-array v9, v0, [J

    invoke-virtual {v1, p2}, Lcom/android/server/pm/PackageSetting;->getCeDataInode(I)J

    move-result-wide v3

    aput-wide v3, v9, v2

    .line 21054
    .local v9, "ceDataInodes":[J
    new-array v10, v0, [Ljava/lang/String;

    iget-object v3, v1, Lcom/android/server/pm/PackageSetting;->codePathString:Ljava/lang/String;

    aput-object v3, v10, v2

    .line 21057
    .local v10, "codePaths":[Ljava/lang/String;
    :try_start_3c
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->volumeUuid:Ljava/lang/String;

    const/4 v7, 0x0

    iget v8, v1, Lcom/android/server/pm/PackageSetting;->appId:I

    move v6, p2

    move-object v11, p3

    invoke-virtual/range {v3 .. v11}, Lcom/android/server/pm/Installer;->getAppSize(Ljava/lang/String;[Ljava/lang/String;III[J[Ljava/lang/String;Landroid/content/pm/PackageStats;)V

    .line 21061
    invoke-static {v1}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Lcom/android/server/pm/PackageSetting;)Z

    move-result v3

    if-eqz v3, :cond_58

    invoke-static {v1}, Lcom/android/server/pm/PackageManagerService;->isUpdatedSystemApp(Lcom/android/server/pm/PackageSetting;)Z

    move-result v3

    if-nez v3, :cond_58

    .line 21062
    const-wide/16 v3, 0x0

    iput-wide v3, p3, Landroid/content/pm/PackageStats;->codeSize:J

    .line 21066
    :cond_58
    iget-wide v3, p3, Landroid/content/pm/PackageStats;->dataSize:J

    iget-wide v6, p3, Landroid/content/pm/PackageStats;->cacheSize:J

    sub-long/2addr v3, v6

    iput-wide v3, p3, Landroid/content/pm/PackageStats;->dataSize:J
    :try_end_5f
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_3c .. :try_end_5f} :catch_61

    .line 21071
    nop

    .line 21073
    return v0

    .line 21068
    :catch_61
    move-exception v0

    .line 21069
    .local v0, "e":Lcom/android/server/pm/Installer$InstallerException;
    invoke-static {v0}, Ljava/lang/String;->valueOf(Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 21070
    return v2

    .line 21050
    .end local v0  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "packageNames":[Ljava/lang/String;
    .end local v9  # "ceDataInodes":[J
    .end local v10  # "codePaths":[Ljava/lang/String;
    :catchall_6c
    move-exception v1

    :try_start_6d
    monitor-exit v0
    :try_end_6e
    .catchall {:try_start_6d .. :try_end_6e} :catchall_6c

    throw v1
.end method

.method private getPackageTargetSdkVersionLockedLPr(Ljava/lang/String;)I
    .registers 4
    .param p1, "packageName"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 21103
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/PackageParser$Package;

    .line 21104
    .local v0, "p":Landroid/content/pm/PackageParser$Package;
    if-eqz v0, :cond_f

    .line 21105
    iget-object v1, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    return v1

    .line 21107
    :cond_f
    const/16 v1, 0x2710

    return v1
.end method

.method private getPackagesForSharedUserIdLocked(Ljava/lang/String;I)[Ljava/lang/String;
    .registers 10
    .param p1, "sharedUserId"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 26072
    :try_start_0
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/4 v1, 0x0

    invoke-virtual {v0, p1, v1, v1, v1}, Lcom/android/server/pm/Settings;->getSharedUserLPw(Ljava/lang/String;IIZ)Lcom/android/server/pm/SharedUserSetting;

    move-result-object v0

    .line 26074
    .local v0, "sus":Lcom/android/server/pm/SharedUserSetting;
    if-nez v0, :cond_c

    .line 26075
    sget-object v1, Llibcore/util/EmptyArray;->STRING:[Ljava/lang/String;

    return-object v1

    .line 26077
    :cond_c
    iget-object v2, v0, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v2}, Landroid/util/ArraySet;->size()I

    move-result v2

    new-array v2, v2, [Ljava/lang/String;

    .line 26078
    .local v2, "res":[Ljava/lang/String;
    iget-object v3, v0, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v3}, Landroid/util/ArraySet;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 26079
    .local v3, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    nop

    .line 26080
    .local v1, "i":I
    :goto_1b
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_41

    .line 26081
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 26082
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v4, p2}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v5

    if-eqz v5, :cond_35

    .line 26083
    add-int/lit8 v5, v1, 0x1

    .end local v1  # "i":I
    .local v5, "i":I
    iget-object v6, v4, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    aput-object v6, v2, v1

    move v1, v5

    goto :goto_40

    .line 26085
    .end local v5  # "i":I
    .restart local v1  # "i":I
    :cond_35
    const-class v5, Ljava/lang/String;

    aget-object v6, v2, v1

    invoke-static {v5, v2, v6}, Lcom/android/internal/util/ArrayUtils;->removeElement(Ljava/lang/Class;[Ljava/lang/Object;Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v5

    check-cast v5, [Ljava/lang/String;
    :try_end_3f
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_0 .. :try_end_3f} :catch_42

    move-object v2, v5

    .line 26087
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_40
    goto :goto_1b

    .line 26088
    :cond_41
    return-object v2

    .line 26089
    .end local v0  # "sus":Lcom/android/server/pm/SharedUserSetting;
    .end local v1  # "i":I
    .end local v2  # "res":[Ljava/lang/String;
    .end local v3  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    :catch_42
    move-exception v0

    .line 26092
    sget-object v0, Llibcore/util/EmptyArray;->STRING:[Ljava/lang/String;

    return-object v0
.end method

.method private getPackagesUsingSharedLibraryLPr(Landroid/content/pm/SharedLibraryInfo;II)Ljava/util/List;
    .registers 14
    .param p1, "libInfo"  # Landroid/content/pm/SharedLibraryInfo;
    .param p2, "flags"  # I
    .param p3, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/SharedLibraryInfo;",
            "II)",
            "Ljava/util/List<",
            "Landroid/content/pm/VersionedPackage;",
            ">;"
        }
    .end annotation

    .line 5611
    const/4 v0, 0x0

    .line 5612
    .local v0, "versionedPackages":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/util/ArrayMap;->size()I

    move-result v1

    .line 5613
    .local v1, "packageCount":I
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_a
    if-ge v2, v1, :cond_9d

    .line 5614
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, v2}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 5616
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v3, :cond_1a

    .line 5617
    goto/16 :goto_99

    .line 5620
    :cond_1a
    invoke-virtual {v3, p3}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v4

    invoke-virtual {v4, p2}, Landroid/content/pm/PackageUserState;->isAvailable(I)Z

    move-result v4

    if-nez v4, :cond_26

    .line 5621
    goto/16 :goto_99

    .line 5624
    :cond_26
    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v4

    .line 5625
    .local v4, "libName":Ljava/lang/String;
    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->isStatic()Z

    move-result v5

    if-eqz v5, :cond_6d

    .line 5626
    iget-object v5, v3, Lcom/android/server/pm/PackageSetting;->usesStaticLibraries:[Ljava/lang/String;

    invoke-static {v5, v4}, Lcom/android/internal/util/ArrayUtils;->indexOf([Ljava/lang/Object;Ljava/lang/Object;)I

    move-result v5

    .line 5627
    .local v5, "libIdx":I
    if-gez v5, :cond_39

    .line 5628
    goto :goto_99

    .line 5630
    :cond_39
    iget-object v6, v3, Lcom/android/server/pm/PackageSetting;->usesStaticLibrariesVersions:[J

    aget-wide v6, v6, v5

    invoke-virtual {p1}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v8

    cmp-long v6, v6, v8

    if-eqz v6, :cond_46

    .line 5631
    goto :goto_99

    .line 5633
    :cond_46
    if-nez v0, :cond_4e

    .line 5634
    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V

    move-object v0, v6

    .line 5637
    :cond_4e
    iget-object v6, v3, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    .line 5638
    .local v6, "dependentPackageName":Ljava/lang/String;
    iget-object v7, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v7, :cond_62

    iget-object v7, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v7, v7, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v7}, Landroid/content/pm/ApplicationInfo;->isStaticSharedLibrary()Z

    move-result v7

    if-eqz v7, :cond_62

    .line 5639
    iget-object v7, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v6, v7, Landroid/content/pm/PackageParser$Package;->manifestPackageName:Ljava/lang/String;

    .line 5641
    :cond_62
    new-instance v7, Landroid/content/pm/VersionedPackage;

    iget-wide v8, v3, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-direct {v7, v6, v8, v9}, Landroid/content/pm/VersionedPackage;-><init>(Ljava/lang/String;J)V

    invoke-interface {v0, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 5642
    .end local v5  # "libIdx":I
    .end local v6  # "dependentPackageName":Ljava/lang/String;
    :cond_6c
    goto :goto_99

    :cond_6d
    iget-object v5, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v5, :cond_6c

    .line 5643
    iget-object v5, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v5, v5, Landroid/content/pm/PackageParser$Package;->usesLibraries:Ljava/util/ArrayList;

    invoke-static {v5, v4}, Lcom/android/internal/util/ArrayUtils;->contains(Ljava/util/Collection;Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_85

    iget-object v5, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v5, v5, Landroid/content/pm/PackageParser$Package;->usesOptionalLibraries:Ljava/util/ArrayList;

    .line 5644
    invoke-static {v5, v4}, Lcom/android/internal/util/ArrayUtils;->contains(Ljava/util/Collection;Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_99

    .line 5645
    :cond_85
    if-nez v0, :cond_8d

    .line 5646
    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V

    move-object v0, v5

    .line 5648
    :cond_8d
    new-instance v5, Landroid/content/pm/VersionedPackage;

    iget-object v6, v3, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    iget-wide v7, v3, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-direct {v5, v6, v7, v8}, Landroid/content/pm/VersionedPackage;-><init>(Ljava/lang/String;J)V

    invoke-interface {v0, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 5613
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "libName":Ljava/lang/String;
    :cond_99
    :goto_99
    add-int/lit8 v2, v2, 0x1

    goto/16 :goto_a

    .line 5653
    .end local v2  # "i":I
    :cond_9d
    return-object v0
.end method

.method private getParentOrChildPackageChangedSharedUser(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;
    .registers 11
    .param p1, "oldPkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "newPkg"  # Landroid/content/pm/PackageParser$Package;

    .line 16812
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    iget-object v1, p2, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    invoke-static {v0, v1}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_d

    .line 16813
    iget-object v0, p2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    return-object v0

    .line 16816
    :cond_d
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    const/4 v1, 0x0

    if-eqz v0, :cond_19

    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_1a

    :cond_19
    move v0, v1

    .line 16817
    .local v0, "oldChildCount":I
    :goto_1a
    iget-object v2, p2, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v2, :cond_24

    iget-object v1, p2, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 16818
    .local v1, "newChildCount":I
    :cond_24
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_25
    if-ge v2, v1, :cond_57

    .line 16819
    iget-object v3, p2, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 16821
    .local v3, "newChildPkg":Landroid/content/pm/PackageParser$Package;
    const/4 v4, 0x0

    .local v4, "j":I
    :goto_30
    if-ge v4, v0, :cond_54

    .line 16822
    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v5, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Package;

    .line 16823
    .local v5, "oldChildPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v6, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v7, v5, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_51

    iget-object v6, v3, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    iget-object v7, v5, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    .line 16824
    invoke-static {v6, v7}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_51

    .line 16825
    iget-object v6, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    return-object v6

    .line 16821
    .end local v5  # "oldChildPkg":Landroid/content/pm/PackageParser$Package;
    :cond_51
    add-int/lit8 v4, v4, 0x1

    goto :goto_30

    .line 16818
    .end local v3  # "newChildPkg":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "j":I
    :cond_54
    add-int/lit8 v2, v2, 0x1

    goto :goto_25

    .line 16829
    .end local v2  # "i":I
    :cond_57
    const/4 v2, 0x0

    return-object v2
.end method

.method private getPersistentApplicationsInternal(I)Ljava/util/List;
    .registers 14
    .param p1, "flags"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(I)",
            "Ljava/util/List<",
            "Landroid/content/pm/ApplicationInfo;",
            ">;"
        }
    .end annotation

    .line 9282
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 9284
    .local v0, "finalList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    const/4 v1, 0x0

    .line 9285
    .local v1, "callOutOfSystem":Z
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-static {}, Landroid/os/Process;->myPid()I

    move-result v3

    if-eq v2, v3, :cond_11

    .line 9286
    const/4 v1, 0x1

    .line 9290
    :cond_11
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 9291
    :try_start_14
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 9292
    .local v3, "i":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v4

    .line 9293
    .local v4, "userId":I
    :goto_22
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_94

    .line 9294
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Package;

    .line 9295
    .local v5, "p":Landroid/content/pm/PackageParser$Package;
    iget-object v6, v5, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    if-nez v6, :cond_33

    goto :goto_22

    .line 9297
    :cond_33
    const/high16 v6, 0x40000

    and-int/2addr v6, p1

    const/4 v7, 0x1

    const/4 v8, 0x0

    if-eqz v6, :cond_44

    iget-object v6, v5, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 9298
    invoke-virtual {v6}, Landroid/content/pm/ApplicationInfo;->isDirectBootAware()Z

    move-result v6

    if-nez v6, :cond_44

    move v6, v7

    goto :goto_45

    :cond_44
    move v6, v8

    .line 9299
    .local v6, "matchesUnaware":Z
    :goto_45
    const/high16 v9, 0x80000

    and-int/2addr v9, p1

    if-eqz v9, :cond_53

    iget-object v9, v5, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 9300
    invoke-virtual {v9}, Landroid/content/pm/ApplicationInfo;->isDirectBootAware()Z

    move-result v9

    if-eqz v9, :cond_53

    goto :goto_54

    :cond_53
    move v7, v8

    .line 9302
    .local v7, "matchesAware":Z
    :goto_54
    iget-object v8, v5, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v8, v8, 0x8

    if-eqz v8, :cond_93

    iget-boolean v8, p0, Lcom/android/server/pm/PackageManagerService;->mSafeMode:Z

    if-eqz v8, :cond_66

    .line 9303
    invoke-static {v5}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v8

    if-eqz v8, :cond_93

    :cond_66
    if-nez v6, :cond_6a

    if-eqz v7, :cond_93

    .line 9305
    :cond_6a
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v8, v8, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v9, v5, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/pm/PackageSetting;

    .line 9306
    .local v8, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v8, :cond_93

    .line 9307
    nop

    .line 9308
    invoke-virtual {v8, v4}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v9

    .line 9307
    invoke-static {v5, p1, v9, v4}, Landroid/content/pm/PackageParser;->generateApplicationInfo(Landroid/content/pm/PackageParser$Package;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v9

    .line 9309
    .local v9, "ai":Landroid/content/pm/ApplicationInfo;
    if-eqz v9, :cond_93

    .line 9311
    if-eqz v1, :cond_90

    const-string v10, "com.meizu.regservice"

    iget-object v11, v9, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v10

    if-eqz v10, :cond_90

    .line 9313
    goto :goto_22

    .line 9316
    :cond_90
    invoke-virtual {v0, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 9320
    .end local v5  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "matchesUnaware":Z
    .end local v7  # "matchesAware":Z
    .end local v8  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v9  # "ai":Landroid/content/pm/ApplicationInfo;
    :cond_93
    goto :goto_22

    .line 9321
    .end local v3  # "i":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Package;>;"
    .end local v4  # "userId":I
    :cond_94
    monitor-exit v2

    .line 9323
    return-object v0

    .line 9321
    :catchall_96
    move-exception v3

    monitor-exit v2
    :try_end_98
    .catchall {:try_start_14 .. :try_end_98} :catchall_96

    throw v3
.end method

.method private static getPrebuildProfilePath(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 10137
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, ".prof"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method private getProfileParent(I)Landroid/content/pm/UserInfo;
    .registers 5
    .param p1, "userId"  # I

    .line 7438
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7440
    .local v0, "identity":J
    :try_start_4
    sget-object v2, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v2, p1}, Lcom/android/server/pm/UserManagerService;->getProfileParent(I)Landroid/content/pm/UserInfo;

    move-result-object v2
    :try_end_a
    .catchall {:try_start_4 .. :try_end_a} :catchall_e

    .line 7442
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7440
    return-object v2

    .line 7442
    :catchall_e
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v2
.end method

.method private static getRealPackageName(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Ljava/lang/String;
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "renamedPkgName"  # Ljava/lang/String;

    .line 11610
    invoke-static {p0, p1}, Lcom/android/server/pm/PackageManagerService;->isPackageRenamed(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_9

    .line 11611
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->mRealPackage:Ljava/lang/String;

    return-object v0

    .line 11613
    :cond_9
    const/4 v0, 0x0

    return-object v0
.end method

.method private getRequiredButNotReallyRequiredVerifierLPr()Ljava/lang/String;
    .registers 7

    .line 3907
    new-instance v1, Landroid/content/Intent;

    const-string v0, "android.intent.action.PACKAGE_NEEDS_VERIFICATION"

    invoke-direct {v1, v0}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 3909
    .local v1, "intent":Landroid/content/Intent;
    const-string v2, "application/vnd.android.package-archive"

    const/high16 v3, 0x1c0000

    const/4 v4, 0x0

    const/4 v5, 0x0

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/pm/PackageManagerService;->queryIntentReceiversInternal(Landroid/content/Intent;Ljava/lang/String;IIZ)Ljava/util/List;

    move-result-object v0

    .line 3912
    .local v0, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v2

    const/4 v3, 0x0

    const/4 v4, 0x1

    if-ne v2, v4, :cond_27

    .line 3913
    invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v2}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v2

    iget-object v2, v2, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v2

    .line 3914
    :cond_27
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v2

    if-le v2, v4, :cond_77

    .line 3915
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v2

    const v4, 0x1040194

    invoke-virtual {v2, v4}, Landroid/content/res/Resources;->getString(I)Ljava/lang/String;

    move-result-object v2

    .line 3916
    .local v2, "optionalVerifierName":Ljava/lang/String;
    invoke-static {v2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v4

    if-eqz v4, :cond_4d

    .line 3917
    invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v3}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v3

    iget-object v3, v3, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v3

    .line 3918
    :cond_4d
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_4e
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v4

    if-ge v3, v4, :cond_76

    .line 3919
    invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v4}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v4

    iget-object v4, v4, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v2}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v4

    if-nez v4, :cond_73

    .line 3920
    invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v4}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v4

    iget-object v4, v4, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v4

    .line 3918
    :cond_73
    add-int/lit8 v3, v3, 0x1

    goto :goto_4e

    .end local v2  # "optionalVerifierName":Ljava/lang/String;
    .end local v3  # "i":I
    :cond_76
    goto :goto_86

    .line 3922
    :cond_77
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v2

    if-nez v2, :cond_86

    .line 3923
    const-string v2, "PackageManager"

    const-string v3, "There should probably be a verifier, but, none were found"

    invoke-static {v2, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 3924
    const/4 v2, 0x0

    return-object v2

    .line 3922
    :cond_86
    :goto_86
    nop

    .line 3926
    new-instance v2, Ljava/lang/RuntimeException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "There must be exactly one verifier; found "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    throw v2
.end method

.method private getRequiredInstallerLPr()Ljava/lang/String;
    .registers 6

    .line 3963
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.INSTALL_PACKAGE"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 3964
    .local v0, "intent":Landroid/content/Intent;
    const-string v1, "android.intent.category.DEFAULT"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 3965
    const-string v1, "content://com.example/foo.apk"

    invoke-static {v1}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v1

    const-string v2, "application/vnd.android.package-archive"

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->setDataAndType(Landroid/net/Uri;Ljava/lang/String;)Landroid/content/Intent;

    .line 3967
    const/4 v1, 0x0

    const/high16 v3, 0x1c0000

    invoke-direct {p0, v0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v2

    .line 3970
    .local v2, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v3

    const/4 v4, 0x1

    if-ne v3, v4, :cond_4a

    .line 3971
    invoke-interface {v2, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    .line 3972
    .local v3, "resolveInfo":Landroid/content/pm/ResolveInfo;
    iget-object v4, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v4}, Landroid/content/pm/ApplicationInfo;->isPrivilegedApp()Z

    move-result v4

    if-eqz v4, :cond_42

    .line 3975
    invoke-interface {v2, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v1}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v1

    .line 3973
    :cond_42
    new-instance v1, Ljava/lang/RuntimeException;

    const-string v4, "The installer must be a privileged app"

    invoke-direct {v1, v4}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 3977
    .end local v3  # "resolveInfo":Landroid/content/pm/ResolveInfo;
    :cond_4a
    new-instance v1, Ljava/lang/RuntimeException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "There must be exactly one installer; found "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v1, v3}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method private getRequiredPermissionControllerLPr()Ljava/lang/String;
    .registers 6

    .line 3998
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.MANAGE_PERMISSIONS"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 3999
    .local v0, "intent":Landroid/content/Intent;
    const-string v1, "android.intent.category.DEFAULT"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 4001
    const/4 v1, 0x0

    const/4 v2, 0x0

    const/high16 v3, 0x1c0000

    invoke-direct {p0, v0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v2

    .line 4004
    .local v2, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v3

    const/4 v4, 0x1

    if-ne v3, v4, :cond_40

    .line 4005
    invoke-interface {v2, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    .line 4006
    .local v3, "resolveInfo":Landroid/content/pm/ResolveInfo;
    iget-object v4, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v4}, Landroid/content/pm/ApplicationInfo;->isPrivilegedApp()Z

    move-result v4

    if-eqz v4, :cond_38

    .line 4009
    invoke-interface {v2, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v1}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v1

    .line 4007
    :cond_38
    new-instance v1, Ljava/lang/RuntimeException;

    const-string v4, "The permissions manager must be a privileged app"

    invoke-direct {v1, v4}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 4011
    .end local v3  # "resolveInfo":Landroid/content/pm/ResolveInfo;
    :cond_40
    new-instance v1, Ljava/lang/RuntimeException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "There must be exactly one permissions manager; found "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v1, v3}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method private getRequiredSharedLibraryLPr(Ljava/lang/String;I)Ljava/lang/String;
    .registers 9
    .param p1, "name"  # Ljava/lang/String;
    .param p2, "version"  # I

    .line 3949
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 3950
    int-to-long v1, p2

    :try_start_4
    invoke-direct {p0, p1, v1, v2}, Lcom/android/server/pm/PackageManagerService;->getSharedLibraryInfoLPr(Ljava/lang/String;J)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v1

    .line 3951
    .local v1, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v1, :cond_29

    .line 3954
    invoke-virtual {v1}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v2

    .line 3955
    .local v2, "packageName":Ljava/lang/String;
    if-eqz v2, :cond_12

    .line 3958
    monitor-exit v0

    return-object v2

    .line 3956
    :cond_12
    new-instance v3, Ljava/lang/IllegalStateException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Expected a package for shared library "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "name":Ljava/lang/String;
    .end local p2  # "version":I
    throw v3

    .line 3952
    .end local v2  # "packageName":Ljava/lang/String;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "name":Ljava/lang/String;
    .restart local p2  # "version":I
    :cond_29
    new-instance v2, Ljava/lang/IllegalStateException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Missing required shared library:"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "name":Ljava/lang/String;
    .end local p2  # "version":I
    throw v2

    .line 3959
    .end local v1  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "name":Ljava/lang/String;
    .restart local p2  # "version":I
    :catchall_40
    move-exception v1

    monitor-exit v0
    :try_end_42
    .catchall {:try_start_4 .. :try_end_42} :catchall_40

    throw v1
.end method

.method private getRequiredUninstallerLPr()Ljava/lang/String;
    .registers 6

    .line 3982
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.UNINSTALL_PACKAGE"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 3983
    .local v0, "intent":Landroid/content/Intent;
    const-string v1, "android.intent.category.DEFAULT"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 3984
    const/4 v1, 0x0

    const-string/jumbo v2, "package"

    const-string v3, "foo.bar"

    invoke-static {v2, v3, v1}, Landroid/net/Uri;->fromParts(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v2

    invoke-virtual {v0, v2}, Landroid/content/Intent;->setData(Landroid/net/Uri;)Landroid/content/Intent;

    .line 3986
    const/high16 v2, 0x1c0000

    const/4 v3, 0x0

    invoke-virtual {p0, v0, v1, v2, v3}, Lcom/android/server/pm/PackageManagerService;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;

    move-result-object v1

    .line 3989
    .local v1, "resolveInfo":Landroid/content/pm/ResolveInfo;
    if-eqz v1, :cond_39

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    .line 3990
    invoke-virtual {v1}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v3

    iget-object v3, v3, Landroid/content/pm/ComponentInfo;->name:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_39

    .line 3994
    invoke-virtual {v1}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v2

    iget-object v2, v2, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v2

    .line 3991
    :cond_39
    new-instance v2, Ljava/lang/RuntimeException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "There must be exactly one uninstaller; found "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    throw v2
.end method

.method private getResolverActivityName()V
    .registers 3

    .line 26294
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const-class v1, Lcom/android/internal/app/MzResolverActivity;

    invoke-virtual {v1}, Ljava/lang/Class;->getName()Ljava/lang/String;

    move-result-object v1

    iput-object v1, v0, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    .line 26295
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const v1, 0xa110033

    iput v1, v0, Landroid/content/pm/ActivityInfo;->theme:I

    .line 26296
    iget v1, v0, Landroid/content/pm/ActivityInfo;->configChanges:I

    or-int/lit16 v1, v1, 0x200

    iput v1, v0, Landroid/content/pm/ActivityInfo;->configChanges:I

    .line 26297
    return-void
.end method

.method private getSettingsVersionForPackage(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/Settings$VersionInfo;
    .registers 4
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19052
    invoke-static {p1}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-eqz v0, :cond_1e

    .line 19053
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->volumeUuid:Ljava/lang/String;

    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v0

    if-eqz v0, :cond_15

    .line 19054
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0}, Lcom/android/server/pm/Settings;->getExternalVersion()Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v0

    return-object v0

    .line 19056
    :cond_15
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->volumeUuid:Ljava/lang/String;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/Settings;->findOrCreateVersion(Ljava/lang/String;)Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v0

    return-object v0

    .line 19059
    :cond_1e
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0}, Lcom/android/server/pm/Settings;->getInternalVersion()Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v0

    return-object v0
.end method

.method private getSetupWizardPackageName()Ljava/lang/String;
    .registers 6

    .line 22027
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.MAIN"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 22028
    .local v0, "intent":Landroid/content/Intent;
    const-string v1, "android.intent.category.SETUP_WIZARD"

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 22030
    nop

    .line 22033
    invoke-static {}, Landroid/os/UserHandle;->myUserId()I

    move-result v1

    .line 22030
    const/4 v2, 0x0

    const v3, 0x1c0200

    invoke-direct {p0, v0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v1

    .line 22034
    .local v1, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v3

    const/4 v4, 0x1

    if-ne v3, v4, :cond_2e

    .line 22035
    const/4 v2, 0x0

    invoke-interface {v1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v2}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v2

    iget-object v2, v2, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v2

    .line 22037
    :cond_2e
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "There should probably be exactly one setup wizard; found "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, ": matches="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 22039
    return-object v2
.end method

.method private getSharedLibLatestVersionSetting(Lcom/android/server/pm/PackageManagerService$ScanResult;)Lcom/android/server/pm/PackageSetting;
    .registers 7
    .param p1, "scanResult"  # Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 10665
    const/4 v0, 0x0

    .line 10666
    .local v0, "sharedLibPackage":Lcom/android/server/pm/PackageSetting;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 10667
    :try_start_4
    iget-object v2, p1, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v2, v2, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 10668
    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->getLatestSharedLibraVersionLPr(Landroid/content/pm/PackageParser$Package;)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v2

    .line 10669
    .local v2, "latestSharedLibraVersionLPr":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v2, :cond_19

    .line 10670
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    .line 10671
    invoke-virtual {v2}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v4

    .line 10670
    invoke-virtual {v3, v4}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v3

    move-object v0, v3

    .line 10673
    .end local v2  # "latestSharedLibraVersionLPr":Landroid/content/pm/SharedLibraryInfo;
    :cond_19
    monitor-exit v1

    .line 10674
    return-object v0

    .line 10673
    :catchall_1b
    move-exception v2

    monitor-exit v1
    :try_end_1d
    .catchall {:try_start_4 .. :try_end_1d} :catchall_1b

    throw v2
.end method

.method private static getSharedLibraryInfo(Ljava/lang/String;JLjava/util/Map;Ljava/util/Map;)Landroid/content/pm/SharedLibraryInfo;
    .registers 8
    .param p0, "name"  # Ljava/lang/String;
    .param p1, "version"  # J
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "J",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;)",
            "Landroid/content/pm/SharedLibraryInfo;"
        }
    .end annotation

    .line 10625
    .local p3, "existingLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .local p4, "newLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    if-eqz p4, :cond_15

    .line 10626
    invoke-interface {p4, p0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/util/LongSparseArray;

    .line 10627
    .local v0, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    const/4 v1, 0x0

    .line 10628
    .local v1, "info":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v0, :cond_12

    .line 10629
    invoke-virtual {v0, p1, p2}, Landroid/util/LongSparseArray;->get(J)Ljava/lang/Object;

    move-result-object v2

    move-object v1, v2

    check-cast v1, Landroid/content/pm/SharedLibraryInfo;

    .line 10631
    :cond_12
    if-eqz v1, :cond_15

    .line 10632
    return-object v1

    .line 10635
    .end local v0  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v1  # "info":Landroid/content/pm/SharedLibraryInfo;
    :cond_15
    invoke-interface {p3, p0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/util/LongSparseArray;

    .line 10636
    .restart local v0  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-nez v0, :cond_1f

    .line 10637
    const/4 v1, 0x0

    return-object v1

    .line 10639
    :cond_1f
    invoke-virtual {v0, p1, p2}, Landroid/util/LongSparseArray;->get(J)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/SharedLibraryInfo;

    return-object v1
.end method

.method private getSharedLibraryInfoLPr(Ljava/lang/String;J)Landroid/content/pm/SharedLibraryInfo;
    .registers 6
    .param p1, "name"  # Ljava/lang/String;
    .param p2, "version"  # J

    .line 10618
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    const/4 v1, 0x0

    invoke-static {p1, p2, p3, v0, v1}, Lcom/android/server/pm/PackageManagerService;->getSharedLibraryInfo(Ljava/lang/String;JLjava/util/Map;Ljava/util/Map;)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v0

    return-object v0
.end method

.method private getSharedUserIdForPackageLocked(Ljava/lang/String;)Ljava/lang/String;
    .registers 4
    .param p1, "packageName"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 26065
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 26066
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_17

    invoke-virtual {v0}, Lcom/android/server/pm/PackageSetting;->isSharedUser()Z

    move-result v1

    if-eqz v1, :cond_17

    iget-object v1, v0, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v1, v1, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    goto :goto_18

    :cond_17
    const/4 v1, 0x0

    :goto_18
    return-object v1
.end method

.method private getStorageManagerInternal()Landroid/os/storage/StorageManagerInternal;
    .registers 2

    .line 5246
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mStorageManagerInternal:Landroid/os/storage/StorageManagerInternal;

    if-nez v0, :cond_e

    .line 5247
    const-class v0, Landroid/os/storage/StorageManagerInternal;

    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/os/storage/StorageManagerInternal;

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mStorageManagerInternal:Landroid/os/storage/StorageManagerInternal;

    .line 5249
    :cond_e
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mStorageManagerInternal:Landroid/os/storage/StorageManagerInternal;

    return-object v0
.end method

.method private getStorageManagerPackageName()Ljava/lang/String;
    .registers 6

    .line 22044
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.os.storage.action.MANAGE_STORAGE"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 22046
    .local v0, "intent":Landroid/content/Intent;
    nop

    .line 22049
    invoke-static {}, Landroid/os/UserHandle;->myUserId()I

    move-result v1

    .line 22046
    const/4 v2, 0x0

    const v3, 0x1c0200

    invoke-direct {p0, v0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v1

    .line 22050
    .local v1, "matches":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v3

    const/4 v4, 0x1

    if-ne v3, v4, :cond_29

    .line 22051
    const/4 v2, 0x0

    invoke-interface {v1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ResolveInfo;

    invoke-virtual {v2}, Landroid/content/pm/ResolveInfo;->getComponentInfo()Landroid/content/pm/ComponentInfo;

    move-result-object v2

    iget-object v2, v2, Landroid/content/pm/ComponentInfo;->packageName:Ljava/lang/String;

    return-object v2

    .line 22053
    :cond_29
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "There should probably be exactly one storage manager; found "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 22054
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, ": matches="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 22053
    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 22055
    return-object v2
.end method

.method private getUidForVerifier(Landroid/content/pm/VerifierInfo;)I
    .registers 10
    .param p1, "verifierInfo"  # Landroid/content/pm/VerifierInfo;

    .line 14757
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 14758
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, p1, Landroid/content/pm/VerifierInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 14759
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    const/4 v2, -0x1

    if-nez v1, :cond_12

    .line 14760
    monitor-exit v0

    return v2

    .line 14761
    :cond_12
    iget-object v3, v1, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v3, v3, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    array-length v3, v3

    const/4 v4, 0x1

    if-eq v3, v4, :cond_39

    .line 14762
    const-string v3, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Verifier package "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, p1, Landroid/content/pm/VerifierInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " has more than one signature; ignoring"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14764
    monitor-exit v0
    :try_end_38
    .catchall {:try_start_3 .. :try_end_38} :catchall_7e

    return v2

    .line 14775
    :cond_39
    :try_start_39
    iget-object v3, v1, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v3, v3, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    const/4 v4, 0x0

    aget-object v3, v3, v4

    .line 14776
    .local v3, "verifierSig":Landroid/content/pm/Signature;
    invoke-virtual {v3}, Landroid/content/pm/Signature;->getPublicKey()Ljava/security/PublicKey;

    move-result-object v4

    .line 14777
    .local v4, "publicKey":Ljava/security/PublicKey;
    invoke-interface {v4}, Ljava/security/PublicKey;->getEncoded()[B

    move-result-object v5
    :try_end_48
    .catch Ljava/security/cert/CertificateException; {:try_start_39 .. :try_end_48} :catch_7b
    .catchall {:try_start_39 .. :try_end_48} :catchall_7e

    move-object v3, v5

    .line 14780
    .end local v4  # "publicKey":Ljava/security/PublicKey;
    .local v3, "expectedPublicKey":[B
    nop

    .line 14782
    :try_start_4a
    iget-object v4, p1, Landroid/content/pm/VerifierInfo;->publicKey:Ljava/security/PublicKey;

    invoke-interface {v4}, Ljava/security/PublicKey;->getEncoded()[B

    move-result-object v4

    .line 14784
    .local v4, "actualPublicKey":[B
    invoke-static {v4, v3}, Ljava/util/Arrays;->equals([B[B)Z

    move-result v5

    if-nez v5, :cond_75

    .line 14785
    const-string v5, "PackageManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Verifier package "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, p1, Landroid/content/pm/VerifierInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " does not have the expected public key; ignoring"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14787
    monitor-exit v0

    return v2

    .line 14790
    :cond_75
    iget-object v2, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    monitor-exit v0

    return v2

    .line 14778
    .end local v3  # "expectedPublicKey":[B
    .end local v4  # "actualPublicKey":[B
    :catch_7b
    move-exception v3

    .line 14779
    .local v3, "e":Ljava/security/cert/CertificateException;
    monitor-exit v0

    return v2

    .line 14791
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "e":Ljava/security/cert/CertificateException;
    :catchall_7e
    move-exception v1

    monitor-exit v0
    :try_end_80
    .catchall {:try_start_4a .. :try_end_80} :catchall_7e

    throw v1
.end method

.method private getUidTargetSdkVersionLockedLPr(I)I
    .registers 9
    .param p1, "uid"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 21078
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v0

    .line 21079
    .local v0, "appId":I
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, v0}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v1

    .line 21080
    .local v1, "obj":Ljava/lang/Object;
    instance-of v2, v1, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v2, :cond_34

    .line 21081
    move-object v2, v1

    check-cast v2, Lcom/android/server/pm/SharedUserSetting;

    .line 21082
    .local v2, "sus":Lcom/android/server/pm/SharedUserSetting;
    const/16 v3, 0x2710

    .line 21083
    .local v3, "vers":I
    iget-object v4, v2, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v4}, Landroid/util/ArraySet;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .line 21084
    .local v4, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    :goto_19
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_33

    .line 21085
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 21086
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v6, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v6, :cond_32

    .line 21087
    iget-object v6, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v6, v6, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    .line 21088
    .local v6, "v":I
    if-ge v6, v3, :cond_32

    move v3, v6

    .line 21090
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "v":I
    :cond_32
    goto :goto_19

    .line 21091
    :cond_33
    return v3

    .line 21092
    .end local v2  # "sus":Lcom/android/server/pm/SharedUserSetting;
    .end local v3  # "vers":I
    .end local v4  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    :cond_34
    instance-of v2, v1, Lcom/android/server/pm/PackageSetting;

    if-eqz v2, :cond_46

    .line 21093
    move-object v2, v1

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 21094
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v3, :cond_46

    .line 21095
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v3, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    return v3

    .line 21098
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_46
    const/16 v2, 0x2710

    return v2
.end method

.method private getUnknownSourcesSettings()I
    .registers 4

    .line 15074
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string/jumbo v1, "install_non_market_apps"

    const/4 v2, -0x1

    invoke-static {v0, v1, v2}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v0

    return v0
.end method

.method private getUserManagerInternal()Landroid/os/UserManagerInternal;
    .registers 2

    .line 5216
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mUserManagerInternal:Landroid/os/UserManagerInternal;

    if-nez v0, :cond_e

    .line 5217
    const-class v0, Landroid/os/UserManagerInternal;

    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/os/UserManagerInternal;

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mUserManagerInternal:Landroid/os/UserManagerInternal;

    .line 5219
    :cond_e
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mUserManagerInternal:Landroid/os/UserManagerInternal;

    return-object v0
.end method

.method private getVerificationTimeout()J
    .registers 5

    .line 14821
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string/jumbo v1, "verifier_timeout"

    const-wide/16 v2, 0x2710

    invoke-static {v0, v1, v2, v3}, Landroid/provider/Settings$Global;->getLong(Landroid/content/ContentResolver;Ljava/lang/String;J)J

    move-result-wide v0

    return-wide v0
.end method

.method private handlePackagePostInstall(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;ZZZ[Ljava/lang/String;Ljava/util/List;ZLjava/lang/String;Landroid/content/pm/IPackageInstallObserver2;)V
    .registers 39
    .param p1, "res"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .param p2, "grantPermissions"  # Z
    .param p3, "killApp"  # Z
    .param p4, "virtualPreload"  # Z
    .param p5, "grantedPermissions"  # [Ljava/lang/String;
    .param p7, "launchedForRestore"  # Z
    .param p8, "installerPackage"  # Ljava/lang/String;
    .param p9, "installObserver"  # Landroid/content/pm/IPackageInstallObserver2;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;",
            "ZZZ[",
            "Ljava/lang/String;",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;Z",
            "Ljava/lang/String;",
            "Landroid/content/pm/IPackageInstallObserver2;",
            ")V"
        }
    .end annotation

    .line 1935
    .local p6, "whitelistedRestrictedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move-object/from16 v10, p0

    move-object/from16 v11, p1

    move/from16 v12, p3

    move-object/from16 v13, p9

    iget v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    const/4 v15, 0x1

    if-ne v0, v15, :cond_f

    move v0, v15

    goto :goto_10

    :cond_f
    const/4 v0, 0x0

    :goto_10
    move/from16 v16, v0

    .line 1936
    .local v16, "succeeded":Z
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    if-eqz v0, :cond_1e

    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v0, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    if-eqz v0, :cond_1e

    move v0, v15

    goto :goto_1f

    :cond_1e
    const/4 v0, 0x0

    :goto_1f
    move/from16 v17, v0

    .line 1938
    .local v17, "update":Z
    if-eqz v16, :cond_393

    .line 1941
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-direct {v10, v0}, Lcom/android/server/pm/PackageManagerService;->updateInactiveVersion(Ljava/lang/String;)V

    .line 1944
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    if-eqz v0, :cond_35

    .line 1945
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    invoke-virtual {v0, v12}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->sendPackageRemovedBroadcasts(Z)V

    .line 1950
    :cond_35
    if-eqz p6, :cond_4f

    .line 1951
    invoke-interface/range {p6 .. p6}, Ljava/util/List;->isEmpty()Z

    move-result v0

    if-nez v0, :cond_4f

    .line 1952
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v2, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    .line 1954
    invoke-static {}, Landroid/os/Process;->myUid()I

    move-result v5

    const/4 v6, 0x2

    iget-object v7, v10, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 1952
    move-object/from16 v4, p6

    invoke-virtual/range {v1 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->setWhitelistedRestrictedPermissions(Landroid/content/pm/PackageParser$Package;[ILjava/util/List;IILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 1963
    :cond_4f
    if-eqz p2, :cond_63

    .line 1964
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 1965
    .local v6, "callingUid":I
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v1, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    iget-object v5, v10, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    move-object/from16 v3, p5

    move v4, v6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->grantRequestedRuntimePermissions(Landroid/content/pm/PackageParser$Package;[I[Ljava/lang/String;ILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 1971
    .end local v6  # "callingUid":I
    :cond_63
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->installerPackageName:Ljava/lang/String;

    if-eqz v0, :cond_6a

    .line 1972
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->installerPackageName:Ljava/lang/String;

    goto :goto_74

    .line 1973
    :cond_6a
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    if-eqz v0, :cond_73

    .line 1974
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v0, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installerPackageName:Ljava/lang/String;

    goto :goto_74

    .line 1975
    :cond_73
    const/4 v0, 0x0

    :goto_74
    move-object v8, v0

    .line 1980
    .local v8, "installerPackageName":Ljava/lang/String;
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->parentPackage:Landroid/content/pm/PackageParser$Package;

    if-eqz v0, :cond_88

    .line 1981
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 1982
    .local v0, "callingUid":I
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v2, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v10, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    invoke-virtual {v1, v2, v0, v3}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->grantRuntimePermissionsGrantedToDisabledPackage(Landroid/content/pm/PackageParser$Package;ILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 1986
    .end local v0  # "callingUid":I
    :cond_88
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 1987
    :try_start_8b
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    iget-object v2, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    invoke-virtual {v0, v2, v3}, Lcom/android/server/pm/InstantAppRegistry;->onPackageInstalledLPw(Landroid/content/pm/PackageParser$Package;[I)V

    .line 1988
    monitor-exit v1
    :try_end_95
    .catchall {:try_start_8b .. :try_end_95} :catchall_38b

    .line 1990
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 1994
    .local v7, "packageName":Ljava/lang/String;
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    .line 1995
    .local v0, "firstUserIds":[I
    sget-object v1, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    .line 1996
    .local v1, "firstInstantUserIds":[I
    sget-object v2, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    .line 1997
    .local v2, "updateUserIds":[I
    sget-object v3, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    .line 1998
    .local v3, "instantUserIds":[I
    iget-object v4, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origUsers:[I

    if-eqz v4, :cond_af

    iget-object v4, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origUsers:[I

    array-length v4, v4

    if-nez v4, :cond_ad

    goto :goto_af

    :cond_ad
    const/4 v4, 0x0

    goto :goto_b0

    :cond_af
    :goto_af
    move v4, v15

    :goto_b0
    move/from16 v18, v4

    .line 1999
    .local v18, "allNewUsers":Z
    iget-object v4, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    move-object v6, v4

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    .line 2000
    .local v6, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v4, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    array-length v5, v4

    move-object v14, v3

    move-object v3, v0

    const/4 v0, 0x0

    move-object/from16 v28, v2

    move-object v2, v1

    move-object/from16 v1, v28

    .end local v0  # "firstUserIds":[I
    .local v1, "updateUserIds":[I
    .local v2, "firstInstantUserIds":[I
    .local v3, "firstUserIds":[I
    .local v14, "instantUserIds":[I
    :goto_c4
    if-ge v0, v5, :cond_11d

    aget v9, v4, v0

    .line 2001
    .local v9, "newUser":I
    invoke-virtual {v6, v9}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v20

    .line 2002
    .local v20, "isInstantApp":Z
    if-eqz v18, :cond_e2

    .line 2003
    if-eqz v20, :cond_d9

    .line 2004
    invoke-static {v2, v9}, Lcom/android/internal/util/ArrayUtils;->appendInt([II)[I

    move-result-object v2

    move-object/from16 v23, v4

    move/from16 v24, v5

    goto :goto_115

    .line 2006
    :cond_d9
    invoke-static {v3, v9}, Lcom/android/internal/util/ArrayUtils;->appendInt([II)[I

    move-result-object v3

    .line 2008
    move-object/from16 v23, v4

    move/from16 v24, v5

    goto :goto_115

    .line 2010
    :cond_e2
    const/16 v21, 0x1

    .line 2011
    .local v21, "isNew":Z
    iget-object v15, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origUsers:[I

    move-object/from16 v23, v4

    array-length v4, v15

    move/from16 v24, v5

    const/4 v5, 0x0

    :goto_ec
    if-ge v5, v4, :cond_fc

    move/from16 v25, v4

    aget v4, v15, v5

    .line 2012
    .local v4, "origUser":I
    if-ne v4, v9, :cond_f7

    .line 2013
    const/16 v21, 0x0

    .line 2014
    goto :goto_fc

    .line 2011
    .end local v4  # "origUser":I
    :cond_f7
    add-int/lit8 v5, v5, 0x1

    move/from16 v4, v25

    goto :goto_ec

    .line 2017
    :cond_fc
    :goto_fc
    if-eqz v21, :cond_10a

    .line 2018
    if-eqz v20, :cond_105

    .line 2019
    invoke-static {v2, v9}, Lcom/android/internal/util/ArrayUtils;->appendInt([II)[I

    move-result-object v2

    goto :goto_115

    .line 2021
    :cond_105
    invoke-static {v3, v9}, Lcom/android/internal/util/ArrayUtils;->appendInt([II)[I

    move-result-object v3

    goto :goto_115

    .line 2024
    :cond_10a
    if-eqz v20, :cond_111

    .line 2025
    invoke-static {v14, v9}, Lcom/android/internal/util/ArrayUtils;->appendInt([II)[I

    move-result-object v14

    goto :goto_115

    .line 2027
    :cond_111
    invoke-static {v1, v9}, Lcom/android/internal/util/ArrayUtils;->appendInt([II)[I

    move-result-object v1

    .line 2000
    .end local v9  # "newUser":I
    .end local v20  # "isInstantApp":Z
    .end local v21  # "isNew":Z
    :goto_115
    add-int/lit8 v0, v0, 0x1

    move-object/from16 v4, v23

    move/from16 v5, v24

    const/4 v15, 0x1

    goto :goto_c4

    .line 2033
    :cond_11d
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-nez v0, :cond_2ec

    .line 2034
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mProcessLoggingHandler:Lcom/android/server/pm/ProcessLoggingHandler;

    iget-object v4, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-virtual {v0, v4}, Lcom/android/server/pm/ProcessLoggingHandler;->invalidateProcessLoggingBaseApkHash(Ljava/lang/String;)V

    .line 2038
    iget v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->uid:I

    invoke-static {v0}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v0

    .line 2039
    .local v0, "appId":I
    iget-object v4, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v4}, Landroid/content/pm/ApplicationInfo;->isSystemApp()Z

    move-result v15

    .line 2040
    .local v15, "isSystem":Z
    if-nez v15, :cond_141

    if-eqz p4, :cond_13f

    goto :goto_141

    :cond_13f
    const/4 v4, 0x0

    goto :goto_142

    :cond_141
    :goto_141
    const/4 v4, 0x1

    :goto_142
    move-object/from16 v20, v1

    .end local v1  # "updateUserIds":[I
    .local v20, "updateUserIds":[I
    move-object/from16 v1, p0

    move-object v9, v2

    .end local v2  # "firstInstantUserIds":[I
    .local v9, "firstInstantUserIds":[I
    move-object v2, v7

    move-object v5, v3

    .end local v3  # "firstUserIds":[I
    .local v5, "firstUserIds":[I
    move v3, v4

    move/from16 v4, p4

    move-object/from16 v21, v5

    .end local v5  # "firstUserIds":[I
    .local v21, "firstUserIds":[I
    move v5, v0

    move-object/from16 v23, v6

    .end local v6  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v23, "ps":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v6, v21

    move-object/from16 v24, v7

    .end local v7  # "packageName":Ljava/lang/String;
    .local v24, "packageName":Ljava/lang/String;
    move-object v7, v9

    invoke-virtual/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->sendPackageAddedForNewUsers(Ljava/lang/String;ZZI[I[I)V

    .line 2044
    new-instance v1, Landroid/os/Bundle;

    const/4 v2, 0x1

    invoke-direct {v1, v2}, Landroid/os/Bundle;-><init>(I)V

    move-object v7, v1

    .line 2045
    .local v7, "extras":Landroid/os/Bundle;
    iget v1, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->uid:I

    const-string v3, "android.intent.extra.UID"

    invoke-virtual {v7, v3, v1}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V

    .line 2046
    if-eqz v17, :cond_16e

    .line 2047
    const-string v1, "android.intent.extra.REPLACING"

    invoke-virtual {v7, v1, v2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V

    .line 2049
    :cond_16e
    const/4 v5, 0x0

    const/4 v6, 0x0

    const/16 v25, 0x0

    const-string v2, "android.intent.action.PACKAGE_ADDED"

    move-object/from16 v1, p0

    move-object/from16 v3, v24

    move-object v4, v7

    move-object/from16 v26, v7

    .end local v7  # "extras":Landroid/os/Bundle;
    .local v26, "extras":Landroid/os/Bundle;
    move-object/from16 v7, v25

    move-object/from16 v27, v8

    .end local v8  # "installerPackageName":Ljava/lang/String;
    .local v27, "installerPackageName":Ljava/lang/String;
    move-object/from16 v8, v20

    move/from16 v19, v0

    move/from16 v25, v15

    const/4 v0, 0x0

    move-object v15, v9

    .end local v0  # "appId":I
    .end local v9  # "firstInstantUserIds":[I
    .local v15, "firstInstantUserIds":[I
    .local v19, "appId":I
    .local v25, "isSystem":Z
    move-object v9, v14

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 2053
    move-object/from16 v9, v27

    .end local v27  # "installerPackageName":Ljava/lang/String;
    .local v9, "installerPackageName":Ljava/lang/String;
    if-eqz v9, :cond_1a2

    .line 2054
    const/4 v5, 0x0

    const/4 v7, 0x0

    const-string v2, "android.intent.action.PACKAGE_ADDED"

    move-object/from16 v1, p0

    move-object/from16 v3, v24

    move-object/from16 v4, v26

    move-object v6, v9

    move-object/from16 v8, v20

    move-object v13, v9

    .end local v9  # "installerPackageName":Ljava/lang/String;
    .local v13, "installerPackageName":Ljava/lang/String;
    move-object v9, v14

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    goto :goto_1a3

    .line 2053
    .end local v13  # "installerPackageName":Ljava/lang/String;
    .restart local v9  # "installerPackageName":Ljava/lang/String;
    :cond_1a2
    move-object v13, v9

    .line 2061
    .end local v9  # "installerPackageName":Ljava/lang/String;
    .restart local v13  # "installerPackageName":Ljava/lang/String;
    :goto_1a3
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    if-eqz v1, :cond_1af

    .line 2062
    invoke-virtual {v1, v13}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-nez v1, :cond_1af

    const/4 v1, 0x1

    goto :goto_1b0

    :cond_1af
    const/4 v1, 0x0

    :goto_1b0
    move/from16 v27, v1

    .line 2063
    .local v27, "notifyVerifier":Z
    if-eqz v27, :cond_1c6

    .line 2064
    const/4 v5, 0x0

    iget-object v6, v10, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    const/4 v7, 0x0

    const-string v2, "android.intent.action.PACKAGE_ADDED"

    move-object/from16 v1, p0

    move-object/from16 v3, v24

    move-object/from16 v4, v26

    move-object/from16 v8, v20

    move-object v9, v14

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 2071
    :cond_1c6
    iget-object v6, v10, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    if-eqz v6, :cond_1db

    .line 2072
    const/high16 v5, 0x1000000

    const/4 v7, 0x0

    const-string v2, "android.intent.action.PACKAGE_ADDED"

    move-object/from16 v1, p0

    move-object/from16 v3, v24

    move-object/from16 v4, v26

    move-object/from16 v8, v21

    move-object v9, v14

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 2079
    :cond_1db
    if-eqz v17, :cond_22c

    .line 2080
    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v2, "android.intent.action.PACKAGE_REPLACED"

    move-object/from16 v1, p0

    move-object/from16 v3, v24

    move-object/from16 v4, v26

    move-object/from16 v8, v20

    move-object v9, v14

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 2084
    if-eqz v13, :cond_201

    .line 2085
    const/4 v5, 0x0

    const/4 v7, 0x0

    const-string v2, "android.intent.action.PACKAGE_REPLACED"

    move-object/from16 v1, p0

    move-object/from16 v3, v24

    move-object/from16 v4, v26

    move-object v6, v13

    move-object/from16 v8, v20

    move-object v9, v14

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 2090
    :cond_201
    if-eqz v27, :cond_215

    .line 2091
    const/4 v5, 0x0

    iget-object v6, v10, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    const/4 v7, 0x0

    const-string v2, "android.intent.action.PACKAGE_REPLACED"

    move-object/from16 v1, p0

    move-object/from16 v3, v24

    move-object/from16 v4, v26

    move-object/from16 v8, v20

    move-object v9, v14

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 2096
    :cond_215
    const/4 v3, 0x0

    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const-string v2, "android.intent.action.MY_PACKAGE_REPLACED"

    move-object/from16 v1, p0

    move-object/from16 v6, v24

    move-object/from16 v8, v20

    move-object v9, v14

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    move-object/from16 v8, p8

    move-object/from16 v9, v21

    move-object/from16 v7, v24

    goto :goto_26f

    .line 2100
    :cond_22c
    if-eqz p7, :cond_269

    iget-object v1, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-static {v1}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v1

    if-nez v1, :cond_269

    .line 2103
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v1, :cond_25f

    .line 2104
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Post-restore of "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v7, v24

    .end local v24  # "packageName":Ljava/lang/String;
    .local v7, "packageName":Ljava/lang/String;
    invoke-virtual {v1, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " sending FIRST_LAUNCH in "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2105
    invoke-static/range {v21 .. v21}, Ljava/util/Arrays;->toString([I)Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 2104
    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_261

    .line 2103
    .end local v7  # "packageName":Ljava/lang/String;
    .restart local v24  # "packageName":Ljava/lang/String;
    :cond_25f
    move-object/from16 v7, v24

    .line 2107
    .end local v24  # "packageName":Ljava/lang/String;
    .restart local v7  # "packageName":Ljava/lang/String;
    :goto_261
    move-object/from16 v8, p8

    move-object/from16 v9, v21

    .end local v21  # "firstUserIds":[I
    .local v9, "firstUserIds":[I
    invoke-direct {v10, v7, v8, v9, v15}, Lcom/android/server/pm/PackageManagerService;->sendFirstLaunchBroadcast(Ljava/lang/String;Ljava/lang/String;[I[I)V

    goto :goto_26f

    .line 2100
    .end local v7  # "packageName":Ljava/lang/String;
    .end local v9  # "firstUserIds":[I
    .restart local v21  # "firstUserIds":[I
    .restart local v24  # "packageName":Ljava/lang/String;
    :cond_269
    move-object/from16 v8, p8

    move-object/from16 v9, v21

    move-object/from16 v7, v24

    .line 2112
    .end local v21  # "firstUserIds":[I
    .end local v24  # "packageName":Ljava/lang/String;
    .restart local v7  # "packageName":Ljava/lang/String;
    .restart local v9  # "firstUserIds":[I
    :goto_26f
    iget-object v1, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-static {v1}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z

    move-result v1

    if-eqz v1, :cond_2f6

    .line 2113
    if-nez v17, :cond_2a6

    .line 2114
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v2, Landroid/os/storage/StorageManager;

    .line 2115
    invoke-virtual {v1, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/os/storage/StorageManager;

    .line 2116
    .local v1, "storage":Landroid/os/storage/StorageManager;
    iget-object v2, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->storageUuid:Ljava/util/UUID;

    .line 2118
    invoke-virtual {v2}, Ljava/util/UUID;->toString()Ljava/lang/String;

    move-result-object v2

    .line 2117
    invoke-virtual {v1, v2}, Landroid/os/storage/StorageManager;->findVolumeByUuid(Ljava/lang/String;)Landroid/os/storage/VolumeInfo;

    move-result-object v2

    .line 2119
    .local v2, "volume":Landroid/os/storage/VolumeInfo;
    iget-object v3, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 2120
    invoke-static {v3}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z

    move-result v3

    invoke-static {v2, v3}, Lcom/android/server/pm/PackageManagerService;->getPackageExternalStorageType(Landroid/os/storage/VolumeInfo;Z)I

    move-result v3

    .line 2122
    .local v3, "packageExternalStorageType":I
    if-eqz v3, :cond_2a6

    .line 2123
    const/16 v4, 0xb5

    iget-object v5, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v5, v5, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-static {v4, v3, v5}, Landroid/util/StatsLog;->write(IILjava/lang/String;)I

    .line 2127
    .end local v1  # "storage":Landroid/os/storage/StorageManager;
    .end local v2  # "volume":Landroid/os/storage/VolumeInfo;
    .end local v3  # "packageExternalStorageType":I
    :cond_2a6
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v1, :cond_2c8

    .line 2128
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v2, "upgrading pkg "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v2, " is external"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2130
    :cond_2c8
    const/4 v1, 0x1

    new-array v5, v1, [I

    iget-object v2, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    const/4 v3, 0x0

    aput v2, v5, v3

    .line 2131
    .local v5, "uidArray":[I
    new-instance v2, Ljava/util/ArrayList;

    invoke-direct {v2, v1}, Ljava/util/ArrayList;-><init>(I)V

    move-object v6, v2

    .line 2132
    .local v6, "pkgList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2133
    const/4 v2, 0x1

    const/4 v3, 0x1

    const/16 v21, 0x0

    move-object/from16 v1, p0

    move-object v4, v6

    move-object/from16 v24, v6

    .end local v6  # "pkgList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    .local v24, "pkgList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    move-object/from16 v6, v21

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->sendResourcesChangedBroadcast(ZZLjava/util/ArrayList;[ILandroid/content/IIntentReceiver;)V

    goto :goto_2f6

    .line 2033
    .end local v5  # "uidArray":[I
    .end local v9  # "firstUserIds":[I
    .end local v13  # "installerPackageName":Ljava/lang/String;
    .end local v15  # "firstInstantUserIds":[I
    .end local v19  # "appId":I
    .end local v20  # "updateUserIds":[I
    .end local v23  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v24  # "pkgList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    .end local v25  # "isSystem":Z
    .end local v26  # "extras":Landroid/os/Bundle;
    .end local v27  # "notifyVerifier":Z
    .local v1, "updateUserIds":[I
    .local v2, "firstInstantUserIds":[I
    .local v3, "firstUserIds":[I
    .local v6, "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v8  # "installerPackageName":Ljava/lang/String;
    :cond_2ec
    move-object/from16 v20, v1

    move-object v15, v2

    move-object v9, v3

    move-object/from16 v23, v6

    move-object v13, v8

    const/4 v0, 0x0

    move-object/from16 v8, p8

    .line 2138
    .end local v1  # "updateUserIds":[I
    .end local v2  # "firstInstantUserIds":[I
    .end local v3  # "firstUserIds":[I
    .end local v6  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v8  # "installerPackageName":Ljava/lang/String;
    .restart local v9  # "firstUserIds":[I
    .restart local v13  # "installerPackageName":Ljava/lang/String;
    .restart local v15  # "firstInstantUserIds":[I
    .restart local v20  # "updateUserIds":[I
    .restart local v23  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_2f6
    :goto_2f6
    if-eqz v9, :cond_335

    array-length v1, v9

    if-lez v1, :cond_335

    .line 2139
    array-length v1, v9

    const/4 v2, 0x0

    :goto_2fd
    if-ge v2, v1, :cond_335

    aget v3, v9, v2

    .line 2144
    .local v3, "userId":I
    invoke-direct {v10, v7, v3}, Lcom/android/server/pm/PackageManagerService;->packageIsBrowser(Ljava/lang/String;I)Z

    move-result v4

    if-eqz v4, :cond_326

    .line 2147
    iget-object v4, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v4

    .line 2148
    :try_start_30a
    iget-object v5, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v7}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 2149
    .local v5, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v5, v3}, Lcom/android/server/pm/PackageSetting;->getInstallReason(I)I

    move-result v6

    const/4 v0, 0x2

    if-eq v6, v0, :cond_320

    .line 2151
    const/4 v0, 0x0

    invoke-direct {v10, v0, v3}, Lcom/android/server/pm/PackageManagerService;->setDefaultBrowserAsyncLPw(Ljava/lang/String;I)V

    goto :goto_321

    .line 2149
    :cond_320
    const/4 v0, 0x0

    .line 2153
    .end local v5  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_321
    monitor-exit v4

    goto :goto_326

    :catchall_323
    move-exception v0

    monitor-exit v4
    :try_end_325
    .catchall {:try_start_30a .. :try_end_325} :catchall_323

    throw v0

    .line 2158
    :cond_326
    :goto_326
    iget-object v4, v10, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 2159
    invoke-static {v3}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;

    move-result-object v5

    .line 2158
    invoke-virtual {v4, v7, v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->restoreDelayedRuntimePermissions(Ljava/lang/String;Landroid/os/UserHandle;)V

    .line 2163
    invoke-direct {v10, v3}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(I)Z

    .line 2139
    .end local v3  # "userId":I
    add-int/lit8 v2, v2, 0x1

    goto :goto_2fd

    .line 2167
    :cond_335
    if-eqz v18, :cond_33f

    if-nez v17, :cond_33f

    .line 2168
    iget v1, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->uid:I

    invoke-virtual {v10, v7, v1}, Lcom/android/server/pm/PackageManagerService;->notifyPackageAdded(Ljava/lang/String;I)V

    goto :goto_344

    .line 2170
    :cond_33f
    iget v1, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->uid:I

    invoke-virtual {v10, v7, v1}, Lcom/android/server/pm/PackageManagerService;->notifyPackageChanged(Ljava/lang/String;I)V

    .line 2174
    :goto_344
    const/16 v1, 0xc26

    .line 2175
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getUnknownSourcesSettings()I

    move-result v2

    .line 2174
    invoke-static {v1, v2}, Landroid/util/EventLog;->writeEvent(II)I

    .line 2178
    iget-object v1, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    if-eqz v1, :cond_355

    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v0, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    :cond_355
    move-object v1, v0

    .line 2179
    .local v1, "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    if-eqz v1, :cond_36b

    .line 2180
    if-nez v12, :cond_35f

    .line 2185
    invoke-direct {v10, v1}, Lcom/android/server/pm/PackageManagerService;->scheduleDeferredNoKillPostDelete(Lcom/android/server/pm/PackageManagerService$InstallArgs;)V

    const/4 v0, 0x1

    goto :goto_373

    .line 2187
    :cond_35f
    iget-object v2, v10, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v2

    .line 2188
    const/4 v0, 0x1

    :try_start_363
    invoke-virtual {v1, v0}, Lcom/android/server/pm/PackageManagerService$InstallArgs;->doPostDeleteLI(Z)Z

    .line 2189
    monitor-exit v2

    goto :goto_373

    :catchall_368
    move-exception v0

    monitor-exit v2
    :try_end_36a
    .catchall {:try_start_363 .. :try_end_36a} :catchall_368

    throw v0

    .line 2194
    :cond_36b
    const/4 v0, 0x1

    invoke-static {}, Ldalvik/system/VMRuntime;->getRuntime()Ldalvik/system/VMRuntime;

    move-result-object v2

    invoke-virtual {v2}, Ldalvik/system/VMRuntime;->requestConcurrentGC()V

    .line 2202
    :goto_373
    array-length v2, v9

    const/4 v3, 0x0

    :goto_375
    if-ge v3, v2, :cond_389

    aget v4, v9, v3

    .line 2203
    .local v4, "userId":I
    const/4 v5, 0x0

    invoke-virtual {v10, v7, v5, v4}, Lcom/android/server/pm/PackageManagerService;->getPackageInfo(Ljava/lang/String;II)Landroid/content/pm/PackageInfo;

    move-result-object v6

    .line 2206
    .local v6, "info":Landroid/content/pm/PackageInfo;
    if-eqz v6, :cond_385

    .line 2207
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    invoke-virtual {v0, v6, v4}, Lcom/android/server/pm/dex/DexManager;->notifyPackageInstalled(Landroid/content/pm/PackageInfo;I)V

    .line 2202
    .end local v4  # "userId":I
    .end local v6  # "info":Landroid/content/pm/PackageInfo;
    :cond_385
    add-int/lit8 v3, v3, 0x1

    const/4 v0, 0x1

    goto :goto_375

    :cond_389
    const/4 v5, 0x0

    goto :goto_396

    .line 1988
    .end local v1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local v7  # "packageName":Ljava/lang/String;
    .end local v9  # "firstUserIds":[I
    .end local v13  # "installerPackageName":Ljava/lang/String;
    .end local v14  # "instantUserIds":[I
    .end local v15  # "firstInstantUserIds":[I
    .end local v18  # "allNewUsers":Z
    .end local v20  # "updateUserIds":[I
    .end local v23  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v8  # "installerPackageName":Ljava/lang/String;
    :catchall_38b
    move-exception v0

    move-object v13, v8

    move-object/from16 v8, p8

    .end local v8  # "installerPackageName":Ljava/lang/String;
    .restart local v13  # "installerPackageName":Ljava/lang/String;
    :goto_38f
    :try_start_38f
    monitor-exit v1
    :try_end_390
    .catchall {:try_start_38f .. :try_end_390} :catchall_391

    throw v0

    :catchall_391
    move-exception v0

    goto :goto_38f

    .line 1938
    .end local v13  # "installerPackageName":Ljava/lang/String;
    :cond_393
    move-object/from16 v8, p8

    const/4 v5, 0x0

    .line 2212
    :goto_396
    if-eqz v16, :cond_39f

    if-eqz v17, :cond_39f

    if-nez v12, :cond_39f

    const/16 v22, 0x1

    goto :goto_3a1

    :cond_39f
    move/from16 v22, v5

    :goto_3a1
    move/from16 v0, v22

    .line 2213
    .local v0, "deferInstallObserver":Z
    if-eqz v0, :cond_3ab

    .line 2214
    move-object/from16 v1, p9

    invoke-direct {v10, v11, v1}, Lcom/android/server/pm/PackageManagerService;->scheduleDeferredNoKillInstallObserver(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/pm/IPackageInstallObserver2;)V

    goto :goto_3b0

    .line 2216
    :cond_3ab
    move-object/from16 v1, p9

    invoke-direct {v10, v11, v1}, Lcom/android/server/pm/PackageManagerService;->notifyInstallObserver(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/pm/IPackageInstallObserver2;)V

    .line 2218
    :goto_3b0
    return-void
.end method

.method private static hasDomainURLs(Landroid/content/pm/PackageParser$Package;)Z
    .registers 2
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19030
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    and-int/lit8 v0, v0, 0x10

    if-eqz v0, :cond_a

    const/4 v0, 0x1

    goto :goto_b

    :cond_a
    const/4 v0, 0x0

    :goto_b
    return v0
.end method

.method private hasNonNegativePriority(Ljava/util/List;)Z
    .registers 4
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;)Z"
        }
    .end annotation

    .line 8032
    .local p1, "resolveInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v0

    const/4 v1, 0x0

    if-lez v0, :cond_12

    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/ResolveInfo;

    iget v0, v0, Landroid/content/pm/ResolveInfo;->priority:I

    if-ltz v0, :cond_12

    const/4 v1, 0x1

    :cond_12
    return v1
.end method

.method private static hasString(Ljava/util/List;Ljava/util/List;)Z
    .registers 8
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;)Z"
        }
    .end annotation

    .line 11109
    .local p0, "list":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local p1, "which":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    const/4 v0, 0x0

    if-eqz p0, :cond_2d

    if-nez p1, :cond_6

    goto :goto_2d

    .line 11112
    :cond_6
    invoke-interface {p0}, Ljava/util/List;->size()I

    move-result v1

    const/4 v2, 0x1

    sub-int/2addr v1, v2

    .local v1, "i":I
    :goto_c
    if-ltz v1, :cond_2c

    .line 11113
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    sub-int/2addr v3, v2

    .local v3, "j":I
    :goto_13
    if-ltz v3, :cond_29

    .line 11114
    invoke-interface {p1, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/String;

    invoke-interface {p0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_26

    .line 11115
    return v2

    .line 11113
    :cond_26
    add-int/lit8 v3, v3, -0x1

    goto :goto_13

    .line 11112
    .end local v3  # "j":I
    :cond_29
    add-int/lit8 v1, v1, -0x1

    goto :goto_c

    .line 11119
    .end local v1  # "i":I
    :cond_2c
    return v0

    .line 11110
    :cond_2d
    :goto_2d
    return v0
.end method

.method private hasTargetSdkInUidLowerThan(II)Z
    .registers 13
    .param p1, "uid"  # I
    .param p2, "higherTargetSDK"  # I

    .line 4791
    invoke-static {p1}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v0

    .line 4793
    .local v0, "userId":I
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 4794
    :try_start_7
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v3

    invoke-virtual {v2, v3}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v2

    .line 4795
    .local v2, "obj":Ljava/lang/Object;
    const/4 v3, 0x0

    if-nez v2, :cond_16

    .line 4796
    monitor-exit v1

    return v3

    .line 4799
    :cond_16
    instance-of v4, v2, Lcom/android/server/pm/PackageSetting;

    const/4 v5, 0x1

    if-eqz v4, :cond_31

    .line 4800
    move-object v4, v2

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 4802
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v4, v0}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v6

    if-nez v6, :cond_26

    .line 4803
    monitor-exit v1

    return v3

    .line 4806
    :cond_26
    iget-object v6, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v6, v6, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    if-ge v6, p2, :cond_2f

    move v3, v5

    :cond_2f
    monitor-exit v1

    return v3

    .line 4807
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_31
    instance-of v4, v2, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v4, :cond_5f

    .line 4808
    move-object v4, v2

    check-cast v4, Lcom/android/server/pm/SharedUserSetting;

    .line 4810
    .local v4, "sus":Lcom/android/server/pm/SharedUserSetting;
    iget-object v6, v4, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v6}, Landroid/util/ArraySet;->size()I

    move-result v6

    .line 4811
    .local v6, "numPkgs":I
    const/4 v7, 0x0

    .local v7, "i":I
    :goto_3f
    if-ge v7, v6, :cond_5d

    .line 4812
    iget-object v8, v4, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v8, v7}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/pm/PackageSetting;

    .line 4814
    .local v8, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v8, v0}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v9

    if-nez v9, :cond_50

    .line 4815
    goto :goto_5a

    .line 4818
    :cond_50
    iget-object v9, v8, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v9, v9, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    if-ge v9, p2, :cond_5a

    .line 4819
    monitor-exit v1

    return v5

    .line 4811
    .end local v8  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_5a
    :goto_5a
    add-int/lit8 v7, v7, 0x1

    goto :goto_3f

    .line 4823
    .end local v7  # "i":I
    :cond_5d
    monitor-exit v1

    return v3

    .line 4825
    .end local v4  # "sus":Lcom/android/server/pm/SharedUserSetting;
    .end local v6  # "numPkgs":I
    :cond_5f
    monitor-exit v1

    return v3

    .line 4827
    .end local v2  # "obj":Ljava/lang/Object;
    :catchall_61
    move-exception v2

    monitor-exit v1
    :try_end_63
    .catchall {:try_start_7 .. :try_end_63} :catchall_61

    throw v2
.end method

.method private static hasValidDomains(Landroid/content/pm/PackageParser$ActivityIntentInfo;)Z
    .registers 2
    .param p0, "filter"  # Landroid/content/pm/PackageParser$ActivityIntentInfo;

    .line 1315
    const-string v0, "android.intent.category.BROWSABLE"

    invoke-virtual {p0, v0}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->hasCategory(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_1a

    .line 1316
    const-string v0, "http"

    invoke-virtual {p0, v0}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->hasDataScheme(Ljava/lang/String;)Z

    move-result v0

    if-nez v0, :cond_18

    .line 1317
    const-string v0, "https"

    invoke-virtual {p0, v0}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->hasDataScheme(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_1a

    :cond_18
    const/4 v0, 0x1

    goto :goto_1b

    :cond_1a
    const/4 v0, 0x0

    .line 1315
    :goto_1b
    return v0
.end method

.method public static inCts()Z
    .registers 2

    .line 26903
    const-string/jumbo v0, "vendor.meizu.sys.cts_state"

    const/4 v1, 0x0

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z

    move-result v0

    return v0
.end method

.method private installBultInMzAppIfNeeded(Ljava/lang/String;)Landroid/content/pm/PackageParser$Package;
    .registers 14
    .param p1, "pkg"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock",
            "mPackages"
        }
    .end annotation

    .line 26878
    const/4 v0, 0x0

    .line 26879
    .local v0, "parserPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v1

    .line 26880
    .local v1, "alreadyScan":Z
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, p1}, Lcom/android/server/pm/Settings;->isMzApp(Ljava/lang/String;)Z

    move-result v2

    .line 26881
    .local v2, "isMzApp":Z
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, p1}, Lcom/android/server/pm/Settings;->isMzAppInstalled(Ljava/lang/String;)Z

    move-result v3

    .line 26882
    .local v3, "isMzInstalled":Z
    if-eqz v2, :cond_58

    if-nez v1, :cond_58

    if-nez v3, :cond_58

    .line 26883
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, p1}, Lcom/android/server/pm/Settings;->getMzAppCodePath(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    .line 26884
    .local v4, "builtInCodePath":Ljava/lang/String;
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v6, "installBultInMzAppIfNeeded builtInCodePath = "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v11, "PackageManager"

    invoke-static {v11, v5}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 26885
    if-eqz v4, :cond_58

    .line 26887
    :try_start_38
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/4 v6, 0x1

    invoke-virtual {v5, p1, v6}, Lcom/android/server/pm/Settings;->setMzAppInstalled(Ljava/lang/String;Z)V

    .line 26888
    sget-object v5, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v5}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v7

    .line 26889
    .local v7, "allUserHandles":[I
    const/4 v5, 0x0

    new-array v8, v5, [I

    .line 26891
    .local v8, "origUserHandles":[I
    const/4 v9, 0x0

    const/4 v10, 0x1

    move-object v5, p0

    move-object v6, v4

    invoke-direct/range {v5 .. v10}, Lcom/android/server/pm/PackageManagerService;->installPackageFromSystemLIF(Ljava/lang/String;[I[ILcom/android/server/pm/permission/PermissionsState;Z)Landroid/content/pm/PackageParser$Package;

    move-result-object v5
    :try_end_4f
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_38 .. :try_end_4f} :catch_51

    move-object v0, v5

    .line 26896
    .end local v7  # "allUserHandles":[I
    .end local v8  # "origUserHandles":[I
    goto :goto_58

    .line 26893
    :catch_51
    move-exception v5

    .line 26894
    .local v5, "e":Lcom/android/server/pm/PackageManagerException;
    const-string/jumbo v6, "installBultInMzAppIfNeeded installPackageFromSystemLIF failed"

    invoke-static {v11, v6}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 26899
    .end local v4  # "builtInCodePath":Ljava/lang/String;
    .end local v5  # "e":Lcom/android/server/pm/PackageManagerException;
    :cond_58
    :goto_58
    return-object v0
.end method

.method private installPackageFromSystemLIF(Ljava/lang/String;[I[ILcom/android/server/pm/permission/PermissionsState;Z)Landroid/content/pm/PackageParser$Package;
    .registers 28
    .param p1, "codePathString"  # Ljava/lang/String;
    .param p2, "allUserHandles"  # [I
    .param p3, "origUserHandles"  # [I
    .param p4, "origPermissionState"  # Lcom/android/server/pm/permission/PermissionsState;
    .param p5, "writeSettings"  # Z
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 20058
    move-object/from16 v8, p0

    move-object/from16 v9, p2

    move-object/from16 v10, p3

    move-object/from16 v11, p4

    iget v0, v8, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    const/4 v12, 0x1

    or-int/2addr v0, v12

    or-int/lit8 v13, v0, 0x10

    .line 20062
    .local v13, "parseFlags":I
    const/high16 v0, 0x20000

    .line 20063
    .local v0, "scanFlags":I
    invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->locationIsPrivileged(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_19

    .line 20064
    const/high16 v1, 0x40000

    or-int/2addr v0, v1

    .line 20066
    :cond_19
    invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->locationIsOem(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_22

    .line 20067
    const/high16 v1, 0x80000

    or-int/2addr v0, v1

    .line 20069
    :cond_22
    invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->locationIsVendor(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_2b

    .line 20070
    const/high16 v1, 0x100000

    or-int/2addr v0, v1

    .line 20072
    :cond_2b
    invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->locationIsProduct(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_34

    .line 20073
    const/high16 v1, 0x200000

    or-int/2addr v0, v1

    .line 20075
    :cond_34
    invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->locationIsProductServices(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_3d

    .line 20076
    const/high16 v1, 0x400000

    or-int/2addr v0, v1

    .line 20078
    :cond_3d
    invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->locationIsOdm(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_46

    .line 20079
    const/high16 v1, 0x800000

    or-int/2addr v0, v1

    .line 20082
    :cond_46
    invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->locationIsMzApp(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_51

    .line 20083
    const/high16 v1, 0x1000000

    or-int/2addr v0, v1

    move v14, v0

    goto :goto_52

    .line 20082
    :cond_51
    move v14, v0

    .line 20086
    .end local v0  # "scanFlags":I
    .local v14, "scanFlags":I
    :goto_52
    new-instance v2, Ljava/io/File;

    move-object/from16 v15, p1

    invoke-direct {v2, v15}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 20087
    .local v2, "codePath":Ljava/io/File;
    const-wide/16 v5, 0x0

    const/4 v7, 0x0

    .line 20088
    move-object/from16 v1, p0

    move v3, v13

    move v4, v14

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->scanPackageTracedLI(Ljava/io/File;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;

    move-result-object v1

    .line 20092
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    const/4 v0, 0x0

    :try_start_65
    iget-object v3, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-static {v3}, Ljava/util/Collections;->unmodifiableMap(Ljava/util/Map;)Ljava/util/Map;

    move-result-object v3

    invoke-direct {v8, v1, v0, v3}, Lcom/android/server/pm/PackageManagerService;->updateSharedLibrariesLocked(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/Map;)V
    :try_end_6e
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_65 .. :try_end_6e} :catch_6f

    .line 20095
    goto :goto_8b

    .line 20093
    :catch_6f
    move-exception v0

    .line 20094
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v4, "updateAllSharedLibrariesLPw failed: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 20097
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    :goto_8b
    invoke-direct {v8, v1}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataAfterInstallLIF(Landroid/content/pm/PackageParser$Package;)V

    .line 20100
    iget-object v3, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 20101
    :try_start_91
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v4, v1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;
    :try_end_9d
    .catchall {:try_start_91 .. :try_end_9d} :catchall_156

    .line 20106
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v11, :cond_ac

    .line 20107
    :try_start_9f
    invoke-virtual {v0}, Lcom/android/server/pm/PackageSetting;->getPermissionsState()Lcom/android/server/pm/permission/PermissionsState;

    move-result-object v4

    invoke-virtual {v4, v11}, Lcom/android/server/pm/permission/PermissionsState;->copyFrom(Lcom/android/server/pm/permission/PermissionsState;)V
    :try_end_a6
    .catchall {:try_start_9f .. :try_end_a6} :catchall_a7

    goto :goto_ac

    .line 20142
    .end local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_a7
    move-exception v0

    move-object/from16 v17, v2

    goto/16 :goto_159

    .line 20109
    .restart local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_ac
    :goto_ac
    :try_start_ac
    iget-object v4, v8, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v5, v1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/16 v19, 0x1

    iget-object v6, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v6}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v20

    iget-object v6, v8, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    move-object/from16 v16, v4

    move-object/from16 v17, v5

    move-object/from16 v18, v1

    move-object/from16 v21, v6

    invoke-virtual/range {v16 .. v21}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updatePermissions(Ljava/lang/String;Landroid/content/pm/PackageParser$Package;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 20112
    if-eqz v9, :cond_ca

    if-eqz v10, :cond_ca

    goto :goto_cb

    :cond_ca
    const/4 v12, 0x0

    :goto_cb
    move v5, v12

    .line 20114
    .local v5, "applyUserRestrictions":Z
    if-eqz v5, :cond_149

    .line 20115
    const/4 v6, 0x0

    .line 20116
    .local v6, "installedStateChanged":Z
    sget-boolean v7, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z
    :try_end_d1
    .catchall {:try_start_ac .. :try_end_d1} :catchall_156

    if-eqz v7, :cond_da

    .line 20117
    :try_start_d3
    const-string v7, "PackageManager"

    const-string v12, "Propagating install state across reinstall"

    invoke-static {v7, v12}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_da
    .catchall {:try_start_d3 .. :try_end_da} :catchall_a7

    .line 20119
    :cond_da
    :try_start_da
    array-length v7, v9

    move v12, v6

    const/4 v6, 0x0

    .end local v6  # "installedStateChanged":Z
    .local v12, "installedStateChanged":Z
    :goto_dd
    if-ge v6, v7, :cond_138

    aget v16, v9, v6

    move/from16 v17, v16

    .line 20120
    .local v17, "userId":I
    move/from16 v4, v17

    .end local v17  # "userId":I
    .local v4, "userId":I
    invoke-static {v10, v4}, Lcom/android/internal/util/ArrayUtils;->contains([II)Z

    move-result v17

    move/from16 v18, v17

    .line 20121
    .local v18, "installed":Z
    sget-boolean v17, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z
    :try_end_ed
    .catchall {:try_start_da .. :try_end_ed} :catchall_156

    if-eqz v17, :cond_116

    .line 20122
    move-object/from16 v17, v2

    .end local v2  # "codePath":Ljava/io/File;
    .local v17, "codePath":Ljava/io/File;
    :try_start_f1
    const-string v2, "PackageManager"

    move/from16 v19, v5

    .end local v5  # "applyUserRestrictions":Z
    .local v19, "applyUserRestrictions":Z
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v20, v7

    const-string v7, "    user "

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v7, " => "

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move/from16 v7, v18

    .end local v18  # "installed":Z
    .local v7, "installed":Z
    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v2, v5}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_11e

    .line 20121
    .end local v7  # "installed":Z
    .end local v17  # "codePath":Ljava/io/File;
    .end local v19  # "applyUserRestrictions":Z
    .restart local v2  # "codePath":Ljava/io/File;
    .restart local v5  # "applyUserRestrictions":Z
    .restart local v18  # "installed":Z
    :cond_116
    move-object/from16 v17, v2

    move/from16 v19, v5

    move/from16 v20, v7

    move/from16 v7, v18

    .line 20124
    .end local v2  # "codePath":Ljava/io/File;
    .end local v5  # "applyUserRestrictions":Z
    .end local v18  # "installed":Z
    .restart local v7  # "installed":Z
    .restart local v17  # "codePath":Ljava/io/File;
    .restart local v19  # "applyUserRestrictions":Z
    :goto_11e
    invoke-virtual {v0, v4}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v2

    if-eq v7, v2, :cond_126

    .line 20125
    const/4 v2, 0x1

    move v12, v2

    .line 20127
    :cond_126
    invoke-virtual {v0, v7, v4}, Lcom/android/server/pm/PackageSetting;->setInstalled(ZI)V

    .line 20129
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/4 v5, 0x0

    invoke-virtual {v2, v4, v5}, Lcom/android/server/pm/Settings;->writeRuntimePermissionsForUserLPr(IZ)V

    .line 20119
    .end local v4  # "userId":I
    .end local v7  # "installed":Z
    add-int/lit8 v6, v6, 0x1

    move-object/from16 v2, v17

    move/from16 v5, v19

    move/from16 v7, v20

    goto :goto_dd

    .line 20133
    .end local v17  # "codePath":Ljava/io/File;
    .end local v19  # "applyUserRestrictions":Z
    .restart local v2  # "codePath":Ljava/io/File;
    .restart local v5  # "applyUserRestrictions":Z
    :cond_138
    move-object/from16 v17, v2

    move/from16 v19, v5

    .end local v2  # "codePath":Ljava/io/File;
    .end local v5  # "applyUserRestrictions":Z
    .restart local v17  # "codePath":Ljava/io/File;
    .restart local v19  # "applyUserRestrictions":Z
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2}, Lcom/android/server/pm/Settings;->writeAllUsersPackageRestrictionsLPr()V

    .line 20134
    if-eqz v12, :cond_14d

    .line 20135
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v0}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V

    goto :goto_14d

    .line 20114
    .end local v12  # "installedStateChanged":Z
    .end local v17  # "codePath":Ljava/io/File;
    .end local v19  # "applyUserRestrictions":Z
    .restart local v2  # "codePath":Ljava/io/File;
    .restart local v5  # "applyUserRestrictions":Z
    :cond_149
    move-object/from16 v17, v2

    move/from16 v19, v5

    .line 20139
    .end local v2  # "codePath":Ljava/io/File;
    .end local v5  # "applyUserRestrictions":Z
    .restart local v17  # "codePath":Ljava/io/File;
    .restart local v19  # "applyUserRestrictions":Z
    :cond_14d
    :goto_14d
    if-eqz p5, :cond_154

    .line 20140
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 20142
    .end local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v19  # "applyUserRestrictions":Z
    :cond_154
    monitor-exit v3

    .line 20143
    return-object v1

    .line 20142
    .end local v17  # "codePath":Ljava/io/File;
    .restart local v2  # "codePath":Ljava/io/File;
    :catchall_156
    move-exception v0

    move-object/from16 v17, v2

    .end local v2  # "codePath":Ljava/io/File;
    .restart local v17  # "codePath":Ljava/io/File;
    :goto_159
    monitor-exit v3
    :try_end_15a
    .catchall {:try_start_f1 .. :try_end_15a} :catchall_15b

    throw v0

    :catchall_15b
    move-exception v0

    goto :goto_159
.end method

.method private installPackagesLI(Ljava/util/List;)V
    .registers 31
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Lcom/android/server/pm/PackageManagerService$InstallRequest;",
            ">;)V"
        }
    .end annotation

    .line 17656
    .local p1, "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    move-object/from16 v8, p0

    new-instance v0, Landroid/util/ArrayMap;

    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v1

    invoke-direct {v0, v1}, Landroid/util/ArrayMap;-><init>(I)V

    move-object v15, v0

    .line 17657
    .local v15, "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    new-instance v0, Landroid/util/ArrayMap;

    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v1

    invoke-direct {v0, v1}, Landroid/util/ArrayMap;-><init>(I)V

    move-object v14, v0

    .line 17658
    .local v14, "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    new-instance v0, Landroid/util/ArrayMap;

    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v1

    invoke-direct {v0, v1}, Landroid/util/ArrayMap;-><init>(I)V

    move-object v13, v0

    .line 17659
    .local v13, "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    new-instance v0, Landroid/util/ArrayMap;

    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v1

    invoke-direct {v0, v1}, Landroid/util/ArrayMap;-><init>(I)V

    move-object v12, v0

    .line 17660
    .local v12, "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    new-instance v0, Landroid/util/ArrayMap;

    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v1

    invoke-direct {v0, v1}, Landroid/util/ArrayMap;-><init>(I)V

    move-object v11, v0

    .line 17661
    .local v11, "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    new-instance v0, Landroid/util/ArrayMap;

    .line 17662
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v1

    invoke-direct {v0, v1}, Landroid/util/ArrayMap;-><init>(I)V

    move-object v10, v0

    .line 17663
    .local v10, "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    new-instance v0, Landroid/util/ArrayMap;

    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v1

    invoke-direct {v0, v1}, Landroid/util/ArrayMap;-><init>(I)V

    move-object v9, v0

    .line 17664
    .local v9, "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    const/16 v19, 0x0

    .line 17666
    .local v19, "success":Z
    const/4 v7, 0x1

    const-wide/32 v3, 0x40000

    :try_start_4e
    const-string/jumbo v0, "installPackagesLI"

    invoke-static {v3, v4, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 17667
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_58
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1
    :try_end_5c
    .catchall {:try_start_4e .. :try_end_5c} :catchall_54f

    if-eqz v1, :cond_382

    :try_start_5e
    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :try_end_64
    .catchall {:try_start_5e .. :try_end_64} :catchall_36b

    move-object v6, v1

    .line 17672
    .local v6, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :try_start_65
    const-string/jumbo v1, "preparePackage"

    invoke-static {v3, v4, v1}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 17673
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService$InstallRequest;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v2, v6, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    invoke-direct {v8, v1, v2}, Lcom/android/server/pm/PackageManagerService;->preparePackageLI(Lcom/android/server/pm/PackageManagerService$InstallArgs;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;)Lcom/android/server/pm/PackageManagerService$PrepareResult;

    move-result-object v1
    :try_end_73
    .catch Lcom/android/server/pm/PackageManagerService$PrepareFailure; {:try_start_65 .. :try_end_73} :catch_2c2
    .catchall {:try_start_65 .. :try_end_73} :catchall_2b2

    move-object v2, v1

    .line 17681
    .local v2, "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :try_start_74
    invoke-static {v3, v4}, Landroid/os/Trace;->traceEnd(J)V

    .line 17682
    nop

    .line 17683
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    invoke-virtual {v1, v7}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setReturnCode(I)V

    .line 17684
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :try_end_7f
    .catchall {:try_start_74 .. :try_end_7f} :catchall_36b

    :try_start_7f
    iget-object v3, v6, Lcom/android/server/pm/PackageManagerService$InstallRequest;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v3, v3, Lcom/android/server/pm/PackageManagerService$InstallArgs;->installerPackageName:Ljava/lang/String;

    iput-object v3, v1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->installerPackageName:Ljava/lang/String;

    .line 17686
    iget-object v1, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->packageToScan:Landroid/content/pm/PackageParser$Package;

    iget-object v1, v1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    move-object v4, v1

    .line 17687
    .local v4, "packageName":Ljava/lang/String;
    invoke-interface {v12, v4, v2}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 17688
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    invoke-interface {v13, v4, v1}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 17689
    iget-object v1, v6, Lcom/android/server/pm/PackageManagerService$InstallRequest;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    invoke-interface {v14, v4, v1}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_97
    .catchall {:try_start_7f .. :try_end_97} :catchall_29c

    .line 17691
    :try_start_97
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->packageToScan:Landroid/content/pm/PackageParser$Package;

    iget v1, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->parseFlags:I

    iget v5, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->scanFlags:I

    .line 17693
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v20
    :try_end_a1
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_97 .. :try_end_a1} :catch_216
    .catchall {:try_start_97 .. :try_end_a1} :catchall_29c

    :try_start_a1
    iget-object v7, v6, Lcom/android/server/pm/PackageManagerService$InstallRequest;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v7, v7, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;
    :try_end_a5
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_a1 .. :try_end_a5} :catch_206
    .catchall {:try_start_a1 .. :try_end_a5} :catchall_201

    .line 17691
    move/from16 v23, v1

    move-object/from16 v1, p0

    move-object/from16 v24, v2

    .end local v2  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .local v24, "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    move-object v2, v3

    const-wide/32 v25, 0x40000

    move/from16 v3, v23

    move-object/from16 v16, v13

    move-object v13, v4

    .end local v4  # "packageName":Ljava/lang/String;
    .local v13, "packageName":Ljava/lang/String;
    .local v16, "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    move v4, v5

    move-object/from16 v17, v14

    const/16 v23, 0x0

    move-object v14, v6

    .end local v6  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .local v14, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .local v17, "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    move-wide/from16 v5, v20

    move-object/from16 v18, v10

    const/4 v10, 0x1

    .end local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v18, "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    :try_start_bf
    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->scanPackageTracedLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Ljava/util/List;

    move-result-object v1

    .line 17695
    .local v1, "scanResults":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    invoke-interface {v1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_c7
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1d7

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17696
    .local v3, "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v4, v3, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v4, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-interface {v15, v4, v3}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4
    :try_end_dd
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_bf .. :try_end_dd} :catch_1fb
    .catchall {:try_start_bf .. :try_end_dd} :catchall_1e9

    if-eqz v4, :cond_18e

    .line 17697
    :try_start_df
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    const/4 v2, -0x5

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Duplicate package "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v3, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v5, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v5, v5, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " in multi-package install request."

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v0, v2, v4}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setError(ILjava/lang/String;)V
    :try_end_101
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_df .. :try_end_101} :catch_187
    .catchall {:try_start_df .. :try_end_101} :catchall_175

    .line 17758
    if-nez v19, :cond_153

    .line 17759
    invoke-interface {v15}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_10b
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_131

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17760
    .local v2, "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-static/range {v23 .. v23}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v5

    invoke-interface {v9, v4, v5}, Ljava/util/Map;->getOrDefault(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/Boolean;

    invoke-virtual {v4}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v4

    if-eqz v4, :cond_130

    .line 17761
    invoke-direct {v8, v2}, Lcom/android/server/pm/PackageManagerService;->cleanUpAppIdCreation(Lcom/android/server/pm/PackageManagerService$ScanResult;)V

    .line 17763
    .end local v2  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_130
    goto :goto_10b

    .line 17766
    :cond_131
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_135
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_153

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 17767
    .local v2, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v4, v4, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    if-ne v4, v10, :cond_14e

    .line 17768
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    move/from16 v5, v23

    iput v5, v4, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    goto :goto_150

    .line 17767
    :cond_14e
    move/from16 v5, v23

    .line 17770
    .end local v2  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :goto_150
    move/from16 v23, v5

    goto :goto_135

    .line 17772
    :cond_153
    invoke-interface {v12}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_15b
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_171

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    .line 17773
    .local v2, "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    if-eqz v4, :cond_170

    .line 17774
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-virtual {v4}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 17776
    .end local v2  # "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :cond_170
    goto :goto_15b

    .line 17777
    :cond_171
    invoke-static/range {v25 .. v26}, Landroid/os/Trace;->traceEnd(J)V

    .line 17701
    return-void

    .line 17758
    .end local v1  # "scanResults":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local v3  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .end local v13  # "packageName":Ljava/lang/String;
    .end local v14  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .end local v24  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :catchall_175
    move-exception v0

    move/from16 v5, v23

    move-object v2, v9

    move-object v6, v11

    move-object v7, v12

    move-object/from16 v22, v15

    move-object/from16 v20, v16

    move-object/from16 v21, v17

    move-object/from16 v3, v18

    move-wide/from16 v11, v25

    goto/16 :goto_55c

    .line 17715
    .restart local v13  # "packageName":Ljava/lang/String;
    .restart local v14  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .restart local v24  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :catch_187
    move-exception v0

    move/from16 v5, v23

    move-object/from16 v7, v18

    goto/16 :goto_228

    .line 17703
    .restart local v1  # "scanResults":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v3  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_18e
    move/from16 v5, v23

    :try_start_190
    invoke-direct {v8, v3}, Lcom/android/server/pm/PackageManagerService;->optimisticallyRegisterAppId(Lcom/android/server/pm/PackageManagerService$ScanResult;)Z

    move-result v4

    invoke-static {v4}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v4

    invoke-interface {v9, v13, v4}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 17704
    iget-object v4, v3, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v4, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v6, v3, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v6, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 17705
    invoke-direct {v8, v6}, Lcom/android/server/pm/PackageManagerService;->getSettingsVersionForPackage(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v6

    .line 17704
    invoke-interface {v11, v4, v6}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 17706
    iget-object v4, v3, Lcom/android/server/pm/PackageManagerService$ScanResult;->staticSharedLibraryInfo:Landroid/content/pm/SharedLibraryInfo;

    if-eqz v4, :cond_1c9

    .line 17707
    nop

    .line 17708
    invoke-direct {v8, v3}, Lcom/android/server/pm/PackageManagerService;->getSharedLibLatestVersionSetting(Lcom/android/server/pm/PackageManagerService$ScanResult;)Lcom/android/server/pm/PackageSetting;

    move-result-object v4

    .line 17709
    .local v4, "sharedLibLatestVersionSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v4, :cond_1c6

    .line 17710
    iget-object v6, v3, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v6, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v6, v6, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
    :try_end_1bd
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_190 .. :try_end_1bd} :catch_1d3
    .catchall {:try_start_190 .. :try_end_1bd} :catchall_1d1

    move-object/from16 v7, v18

    .end local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v7, "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    :try_start_1bf
    invoke-interface {v7, v6, v4}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_1c2
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_1bf .. :try_end_1c2} :catch_1c3
    .catchall {:try_start_1bf .. :try_end_1c2} :catchall_35c

    goto :goto_1cb

    .line 17715
    .end local v1  # "scanResults":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local v3  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .end local v4  # "sharedLibLatestVersionSetting":Lcom/android/server/pm/PackageSetting;
    :catch_1c3
    move-exception v0

    goto/16 :goto_228

    .line 17709
    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v1  # "scanResults":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v3  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .restart local v4  # "sharedLibLatestVersionSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    :cond_1c6
    move-object/from16 v7, v18

    .end local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    goto :goto_1cb

    .line 17706
    .end local v4  # "sharedLibLatestVersionSetting":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    :cond_1c9
    move-object/from16 v7, v18

    .line 17714
    .end local v3  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .end local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    :goto_1cb
    move/from16 v23, v5

    move-object/from16 v18, v7

    goto/16 :goto_c7

    .line 17758
    .end local v1  # "scanResults":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v13  # "packageName":Ljava/lang/String;
    .end local v14  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .end local v24  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .restart local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    :catchall_1d1
    move-exception v0

    goto :goto_1ec

    .line 17715
    .restart local v13  # "packageName":Ljava/lang/String;
    .restart local v14  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .restart local v24  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :catch_1d3
    move-exception v0

    move-object/from16 v7, v18

    goto :goto_200

    .line 17695
    .restart local v1  # "scanResults":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    :cond_1d7
    move-object/from16 v7, v18

    move/from16 v5, v23

    .line 17718
    .end local v1  # "scanResults":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    nop

    .line 17719
    .end local v13  # "packageName":Ljava/lang/String;
    .end local v14  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .end local v24  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    move-object/from16 v13, v16

    move-object/from16 v14, v17

    move-wide/from16 v3, v25

    move/from16 v27, v10

    move-object v10, v7

    move/from16 v7, v27

    goto/16 :goto_58

    .line 17758
    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    :catchall_1e9
    move-exception v0

    move/from16 v5, v23

    :goto_1ec
    move-object v2, v9

    move-object v6, v11

    move-object v7, v12

    move-object/from16 v22, v15

    move-object/from16 v20, v16

    move-object/from16 v21, v17

    move-object/from16 v3, v18

    move-wide/from16 v11, v25

    .end local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    goto/16 :goto_55c

    .line 17715
    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v13  # "packageName":Ljava/lang/String;
    .restart local v14  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .restart local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v24  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :catch_1fb
    move-exception v0

    move-object/from16 v7, v18

    move/from16 v5, v23

    .end local v18  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    :goto_200
    goto :goto_228

    .line 17758
    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .end local v24  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .restart local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v13, "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .local v14, "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    :catchall_201
    move-exception v0

    move-object v7, v10

    const/4 v5, 0x0

    goto/16 :goto_2a3

    .line 17715
    .local v2, "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .local v4, "packageName":Ljava/lang/String;
    .restart local v6  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :catch_206
    move-exception v0

    move-object/from16 v24, v2

    move-object v7, v10

    move-object/from16 v16, v13

    move-object/from16 v17, v14

    const/4 v5, 0x0

    const/4 v10, 0x1

    const-wide/32 v25, 0x40000

    move-object v13, v4

    move-object v14, v6

    goto :goto_228

    :catch_216
    move-exception v0

    move-object/from16 v24, v2

    move-object/from16 v16, v13

    move-object/from16 v17, v14

    const/4 v5, 0x0

    const-wide/32 v25, 0x40000

    move-object v13, v4

    move-object v14, v6

    move-object/from16 v27, v10

    move v10, v7

    move-object/from16 v7, v27

    .line 17716
    .end local v2  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .end local v4  # "packageName":Ljava/lang/String;
    .end local v6  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .end local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v13, "packageName":Ljava/lang/String;
    .local v14, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .restart local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v24  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :goto_228
    :try_start_228
    iget-object v1, v14, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    const-string v2, "Scanning Failed."

    invoke-virtual {v1, v2, v0}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setError(Ljava/lang/String;Lcom/android/server/pm/PackageManagerException;)V
    :try_end_22f
    .catchall {:try_start_228 .. :try_end_22f} :catchall_35c

    .line 17758
    if-nez v19, :cond_27a

    .line 17759
    invoke-interface {v15}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_239
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_25f

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17760
    .local v2, "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v3, v3, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-static {v5}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v4

    invoke-interface {v9, v3, v4}, Ljava/util/Map;->getOrDefault(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/Boolean;

    invoke-virtual {v3}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v3

    if-eqz v3, :cond_25e

    .line 17761
    invoke-direct {v8, v2}, Lcom/android/server/pm/PackageManagerService;->cleanUpAppIdCreation(Lcom/android/server/pm/PackageManagerService$ScanResult;)V

    .line 17763
    .end local v2  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_25e
    goto :goto_239

    .line 17766
    :cond_25f
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_263
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_27a

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 17767
    .local v2, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v3, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    if-ne v3, v10, :cond_279

    .line 17768
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iput v5, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    .line 17770
    .end local v2  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :cond_279
    goto :goto_263

    .line 17772
    :cond_27a
    invoke-interface {v12}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_282
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_298

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    .line 17773
    .local v2, "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    if-eqz v3, :cond_297

    .line 17774
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-virtual {v3}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 17776
    .end local v2  # "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :cond_297
    goto :goto_282

    .line 17777
    :cond_298
    invoke-static/range {v25 .. v26}, Landroid/os/Trace;->traceEnd(J)V

    .line 17717
    return-void

    .line 17758
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .end local v24  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .restart local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v13, "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .local v14, "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    :catchall_29c
    move-exception v0

    const/4 v5, 0x0

    move-object/from16 v27, v10

    move v10, v7

    move-object/from16 v7, v27

    :goto_2a3
    move-object v3, v7

    move-object v2, v9

    move-object v6, v11

    move-object v7, v12

    move-object/from16 v20, v13

    move-object/from16 v21, v14

    move-object/from16 v22, v15

    const-wide/32 v11, 0x40000

    goto/16 :goto_380

    .line 17681
    .restart local v6  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :catchall_2b2
    move-exception v0

    move-wide/from16 v25, v3

    move-object/from16 v16, v13

    move-object/from16 v17, v14

    const/4 v5, 0x0

    move-object v14, v6

    move-object/from16 v27, v10

    move v10, v7

    move-object/from16 v7, v27

    .end local v6  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .end local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v13  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v14, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .restart local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    goto/16 :goto_358

    .line 17674
    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v6  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .restart local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v13  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .local v14, "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    :catch_2c2
    move-exception v0

    move-wide/from16 v25, v3

    move-object/from16 v16, v13

    move-object/from16 v17, v14

    const/4 v5, 0x0

    move-object v14, v6

    move-object/from16 v27, v10

    move v10, v7

    move-object/from16 v7, v27

    .line 17675
    .end local v6  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .end local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v13  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .local v0, "prepareFailure":Lcom/android/server/pm/PackageManagerService$PrepareFailure;
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v14, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .restart local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    :try_start_2d0
    iget-object v1, v14, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v2, v0, Lcom/android/server/pm/PackageManagerService$PrepareFailure;->error:I

    .line 17676
    invoke-virtual {v0}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;->getMessage()Ljava/lang/String;

    move-result-object v3

    .line 17675
    invoke-virtual {v1, v2, v3}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setError(ILjava/lang/String;)V

    .line 17677
    iget-object v1, v14, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget-object v2, v0, Lcom/android/server/pm/PackageManagerService$PrepareFailure;->conflictingPackage:Ljava/lang/String;

    iput-object v2, v1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origPackage:Ljava/lang/String;

    .line 17678
    iget-object v1, v14, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget-object v2, v0, Lcom/android/server/pm/PackageManagerService$PrepareFailure;->conflictingPermission:Ljava/lang/String;

    iput-object v2, v1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origPermission:Ljava/lang/String;
    :try_end_2e7
    .catchall {:try_start_2d0 .. :try_end_2e7} :catchall_357

    .line 17681
    :try_start_2e7
    invoke-static/range {v25 .. v26}, Landroid/os/Trace;->traceEnd(J)V
    :try_end_2ea
    .catchall {:try_start_2e7 .. :try_end_2ea} :catchall_35c

    .line 17758
    if-nez v19, :cond_335

    .line 17759
    invoke-interface {v15}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_2f4
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_31a

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17760
    .local v2, "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v3, v3, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-static {v5}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v4

    invoke-interface {v9, v3, v4}, Ljava/util/Map;->getOrDefault(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/Boolean;

    invoke-virtual {v3}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v3

    if-eqz v3, :cond_319

    .line 17761
    invoke-direct {v8, v2}, Lcom/android/server/pm/PackageManagerService;->cleanUpAppIdCreation(Lcom/android/server/pm/PackageManagerService$ScanResult;)V

    .line 17763
    .end local v2  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_319
    goto :goto_2f4

    .line 17766
    :cond_31a
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_31e
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_335

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 17767
    .local v2, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v3, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    if-ne v3, v10, :cond_334

    .line 17768
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iput v5, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    .line 17770
    .end local v2  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :cond_334
    goto :goto_31e

    .line 17772
    :cond_335
    invoke-interface {v12}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_33d
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_353

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    .line 17773
    .local v2, "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    if-eqz v3, :cond_352

    .line 17774
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-virtual {v3}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 17776
    .end local v2  # "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :cond_352
    goto :goto_33d

    .line 17777
    :cond_353
    invoke-static/range {v25 .. v26}, Landroid/os/Trace;->traceEnd(J)V

    .line 17679
    return-void

    .line 17681
    .end local v0  # "prepareFailure":Lcom/android/server/pm/PackageManagerService$PrepareFailure;
    :catchall_357
    move-exception v0

    :goto_358
    :try_start_358
    invoke-static/range {v25 .. v26}, Landroid/os/Trace;->traceEnd(J)V

    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v9  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .end local v11  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .end local v12  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .end local v15  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .end local v19  # "success":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    throw v0
    :try_end_35c
    .catchall {:try_start_358 .. :try_end_35c} :catchall_35c

    .line 17758
    .end local v14  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v9  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .restart local v11  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .restart local v12  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .restart local v15  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v19  # "success":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    :catchall_35c
    move-exception v0

    move-object v3, v7

    move-object v2, v9

    move-object v6, v11

    move-object v7, v12

    move-object/from16 v22, v15

    move-object/from16 v20, v16

    move-object/from16 v21, v17

    move-wide/from16 v11, v25

    goto/16 :goto_55c

    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v13  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .local v14, "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    :catchall_36b
    move-exception v0

    const/4 v5, 0x0

    move-object/from16 v27, v10

    move v10, v7

    move-object/from16 v7, v27

    move-object v2, v9

    move-object v6, v11

    move-object/from16 v20, v13

    move-object/from16 v21, v14

    move-object/from16 v22, v15

    move-wide/from16 v27, v3

    move-object v3, v7

    move-object v7, v12

    move-wide/from16 v11, v27

    .end local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v13  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v14  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    :goto_380
    goto/16 :goto_55c

    .line 17720
    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v13  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v14  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    :cond_382
    move-wide/from16 v25, v3

    move-object/from16 v16, v13

    move-object/from16 v17, v14

    const/4 v5, 0x0

    move-object/from16 v27, v10

    move v10, v7

    move-object/from16 v7, v27

    .end local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v13  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v14  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    :try_start_38e
    new-instance v0, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;

    iget-object v14, v8, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 17724
    invoke-static {v1}, Ljava/util/Collections;->unmodifiableMap(Ljava/util/Map;)Ljava/util/Map;

    move-result-object v1
    :try_end_398
    .catchall {:try_start_38e .. :try_end_398} :catchall_541

    const/16 v18, 0x0

    move-object v2, v9

    .end local v9  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .local v2, "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    move-object v9, v0

    move-object v3, v7

    move v4, v10

    .end local v7  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v3, "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    move-object v10, v15

    move-object v6, v11

    .end local v11  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .local v6, "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    move-object/from16 v11, v17

    move-object v7, v12

    .end local v12  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .local v7, "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    move-object/from16 v12, v16

    move-object/from16 v20, v16

    .end local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .local v20, "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    move-object v13, v7

    move-object/from16 v21, v17

    .end local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .local v21, "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    move-object/from16 v22, v15

    .end local v15  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .local v22, "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    move-object v15, v1

    move-object/from16 v16, v6

    move-object/from16 v17, v3

    :try_start_3b1
    invoke-direct/range {v9 .. v18}, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;-><init>(Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;Lcom/android/server/pm/PackageManagerService$1;)V

    move-object v1, v0

    .line 17726
    .local v1, "reconcileRequest":Lcom/android/server/pm/PackageManagerService$ReconcileRequest;
    const/4 v9, 0x0

    .line 17727
    .local v9, "commitRequest":Lcom/android/server/pm/PackageManagerService$CommitRequest;
    iget-object v10, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v10
    :try_end_3b9
    .catchall {:try_start_3b1 .. :try_end_3b9} :catchall_53d

    .line 17730
    :try_start_3b9
    const-string/jumbo v0, "reconcilePackages"
    :try_end_3bc
    .catch Lcom/android/server/pm/PackageManagerService$ReconcileFailure; {:try_start_3b9 .. :try_end_3bc} :catch_4a7
    .catchall {:try_start_3b9 .. :try_end_3bc} :catchall_4a2

    move-wide/from16 v11, v25

    :try_start_3be
    invoke-static {v11, v12, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 17731
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    invoke-static {v1, v0}, Lcom/android/server/pm/PackageManagerService;->reconcilePackagesLocked(Lcom/android/server/pm/PackageManagerService$ReconcileRequest;Lcom/android/server/pm/KeySetManagerService;)Ljava/util/Map;

    move-result-object v0
    :try_end_3c9
    .catch Lcom/android/server/pm/PackageManagerService$ReconcileFailure; {:try_start_3be .. :try_end_3c9} :catch_4a0
    .catchall {:try_start_3be .. :try_end_3c9} :catchall_49d

    move-object v13, v0

    .line 17739
    .local v13, "reconciledPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    :try_start_3ca
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V
    :try_end_3cd
    .catchall {:try_start_3ca .. :try_end_3cd} :catchall_538

    .line 17740
    nop

    .line 17742
    :try_start_3ce
    const-string v0, "commitPackages"

    invoke-static {v11, v12, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 17743
    new-instance v0, Lcom/android/server/pm/PackageManagerService$CommitRequest;

    sget-object v14, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    .line 17744
    invoke-virtual {v14}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v14

    const/4 v15, 0x0

    invoke-direct {v0, v13, v14, v15}, Lcom/android/server/pm/PackageManagerService$CommitRequest;-><init>(Ljava/util/Map;[ILcom/android/server/pm/PackageManagerService$1;)V

    move-object v9, v0

    .line 17745
    invoke-direct {v8, v9}, Lcom/android/server/pm/PackageManagerService;->commitPackagesLocked(Lcom/android/server/pm/PackageManagerService$CommitRequest;)V
    :try_end_3e3
    .catchall {:try_start_3ce .. :try_end_3e3} :catchall_479

    .line 17746
    const/16 v19, 0x1

    .line 17748
    :try_start_3e5
    invoke-interface {v7}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_3ed
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v14

    if-eqz v14, :cond_403

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    .line 17749
    .local v14, "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    iget-object v15, v14, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    if-eqz v15, :cond_402

    .line 17750
    iget-object v15, v14, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-virtual {v15}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 17752
    .end local v14  # "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :cond_402
    goto :goto_3ed

    .line 17753
    :cond_403
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V

    .line 17754
    nop

    .line 17755
    .end local v13  # "reconciledPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    monitor-exit v10
    :try_end_408
    .catchall {:try_start_3e5 .. :try_end_408} :catchall_538

    .line 17756
    :try_start_408
    invoke-direct {v8, v9}, Lcom/android/server/pm/PackageManagerService;->executePostCommitSteps(Lcom/android/server/pm/PackageManagerService$CommitRequest;)V
    :try_end_40b
    .catchall {:try_start_408 .. :try_end_40b} :catchall_53b

    .line 17758
    .end local v1  # "reconcileRequest":Lcom/android/server/pm/PackageManagerService$ReconcileRequest;
    .end local v9  # "commitRequest":Lcom/android/server/pm/PackageManagerService$CommitRequest;
    if-nez v19, :cond_456

    .line 17759
    invoke-interface/range {v22 .. v22}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_415
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_43b

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17760
    .local v1, "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v9, v9, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v9, v9, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-static {v5}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v10

    invoke-interface {v2, v9, v10}, Ljava/util/Map;->getOrDefault(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/Boolean;

    invoke-virtual {v9}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v9

    if-eqz v9, :cond_43a

    .line 17761
    invoke-direct {v8, v1}, Lcom/android/server/pm/PackageManagerService;->cleanUpAppIdCreation(Lcom/android/server/pm/PackageManagerService$ScanResult;)V

    .line 17763
    .end local v1  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_43a
    goto :goto_415

    .line 17766
    :cond_43b
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_43f
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_456

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 17767
    .local v1, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v9, v9, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    if-ne v9, v4, :cond_455

    .line 17768
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iput v5, v9, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    .line 17770
    .end local v1  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :cond_455
    goto :goto_43f

    .line 17772
    :cond_456
    invoke-interface {v7}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_45e
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_474

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    .line 17773
    .local v1, "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    if-eqz v4, :cond_473

    .line 17774
    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-virtual {v4}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 17776
    .end local v1  # "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :cond_473
    goto :goto_45e

    .line 17777
    :cond_474
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V

    .line 17778
    nop

    .line 17779
    return-void

    .line 17748
    .local v1, "reconcileRequest":Lcom/android/server/pm/PackageManagerService$ReconcileRequest;
    .restart local v9  # "commitRequest":Lcom/android/server/pm/PackageManagerService$CommitRequest;
    .restart local v13  # "reconciledPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    :catchall_479
    move-exception v0

    :try_start_47a
    invoke-interface {v7}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v14

    invoke-interface {v14}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v14

    :goto_482
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v15

    if-eqz v15, :cond_499

    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    .line 17749
    .local v15, "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    iget-object v4, v15, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    if-eqz v4, :cond_497

    .line 17750
    iget-object v4, v15, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-virtual {v4}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 17752
    .end local v15  # "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :cond_497
    const/4 v4, 0x1

    goto :goto_482

    .line 17753
    :cond_499
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V

    .end local v1  # "reconcileRequest":Lcom/android/server/pm/PackageManagerService$ReconcileRequest;
    .end local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .end local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .end local v7  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .end local v9  # "commitRequest":Lcom/android/server/pm/PackageManagerService$CommitRequest;
    .end local v19  # "success":Z
    .end local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .end local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    throw v0
    :try_end_49d
    .catchall {:try_start_47a .. :try_end_49d} :catchall_538

    .line 17739
    .end local v13  # "reconciledPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    .restart local v1  # "reconcileRequest":Lcom/android/server/pm/PackageManagerService$ReconcileRequest;
    .restart local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .restart local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .restart local v7  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .restart local v9  # "commitRequest":Lcom/android/server/pm/PackageManagerService$CommitRequest;
    .restart local v19  # "success":Z
    .restart local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    :catchall_49d
    move-exception v0

    goto/16 :goto_534

    .line 17733
    :catch_4a0
    move-exception v0

    goto :goto_4aa

    .line 17739
    :catchall_4a2
    move-exception v0

    move-wide/from16 v11, v25

    goto/16 :goto_534

    .line 17733
    :catch_4a7
    move-exception v0

    move-wide/from16 v11, v25

    .line 17734
    .local v0, "e":Lcom/android/server/pm/PackageManagerService$ReconcileFailure;
    :goto_4aa
    :try_start_4aa
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_4ae
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v13

    if-eqz v13, :cond_4c2

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 17735
    .local v13, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v14, v13, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    const-string v15, "Reconciliation failed..."

    invoke-virtual {v14, v15, v0}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setError(Ljava/lang/String;Lcom/android/server/pm/PackageManagerException;)V
    :try_end_4c1
    .catchall {:try_start_4aa .. :try_end_4c1} :catchall_49d

    .line 17736
    .end local v13  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    goto :goto_4ae

    .line 17739
    :cond_4c2
    :try_start_4c2
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V

    monitor-exit v10
    :try_end_4c6
    .catchall {:try_start_4c2 .. :try_end_4c6} :catchall_538

    .line 17758
    if-nez v19, :cond_512

    .line 17759
    invoke-interface/range {v22 .. v22}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v4

    invoke-interface {v4}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_4d0
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v10

    if-eqz v10, :cond_4f6

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17760
    .local v10, "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v13, v10, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v13, v13, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v13, v13, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-static {v5}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v14

    invoke-interface {v2, v13, v14}, Ljava/util/Map;->getOrDefault(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Ljava/lang/Boolean;

    invoke-virtual {v13}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v13

    if-eqz v13, :cond_4f5

    .line 17761
    invoke-direct {v8, v10}, Lcom/android/server/pm/PackageManagerService;->cleanUpAppIdCreation(Lcom/android/server/pm/PackageManagerService$ScanResult;)V

    .line 17763
    .end local v10  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_4f5
    goto :goto_4d0

    .line 17766
    :cond_4f6
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_4fa
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v10

    if-eqz v10, :cond_512

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 17767
    .local v10, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v13, v10, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v13, v13, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    const/4 v14, 0x1

    if-ne v13, v14, :cond_511

    .line 17768
    iget-object v13, v10, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iput v5, v13, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    .line 17770
    .end local v10  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :cond_511
    goto :goto_4fa

    .line 17772
    :cond_512
    invoke-interface {v7}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v4

    invoke-interface {v4}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_51a
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_530

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    .line 17773
    .local v5, "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    iget-object v10, v5, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    if-eqz v10, :cond_52f

    .line 17774
    iget-object v10, v5, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-virtual {v10}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 17776
    .end local v5  # "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :cond_52f
    goto :goto_51a

    .line 17777
    :cond_530
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V

    .line 17737
    return-void

    .line 17739
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerService$ReconcileFailure;
    :goto_534
    :try_start_534
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V

    .end local v1  # "reconcileRequest":Lcom/android/server/pm/PackageManagerService$ReconcileRequest;
    .end local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .end local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .end local v7  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .end local v9  # "commitRequest":Lcom/android/server/pm/PackageManagerService$CommitRequest;
    .end local v19  # "success":Z
    .end local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .end local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    throw v0

    .line 17755
    .restart local v1  # "reconcileRequest":Lcom/android/server/pm/PackageManagerService$ReconcileRequest;
    .restart local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .restart local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .restart local v7  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .restart local v9  # "commitRequest":Lcom/android/server/pm/PackageManagerService$CommitRequest;
    .restart local v19  # "success":Z
    .restart local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    :catchall_538
    move-exception v0

    monitor-exit v10
    :try_end_53a
    .catchall {:try_start_534 .. :try_end_53a} :catchall_538

    .end local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .end local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .end local v7  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .end local v19  # "success":Z
    .end local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .end local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    :try_start_53a
    throw v0
    :try_end_53b
    .catchall {:try_start_53a .. :try_end_53b} :catchall_53b

    .line 17758
    .end local v1  # "reconcileRequest":Lcom/android/server/pm/PackageManagerService$ReconcileRequest;
    .end local v9  # "commitRequest":Lcom/android/server/pm/PackageManagerService$CommitRequest;
    .restart local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .restart local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .restart local v7  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .restart local v19  # "success":Z
    .restart local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    :catchall_53b
    move-exception v0

    goto :goto_55c

    :catchall_53d
    move-exception v0

    move-wide/from16 v11, v25

    goto :goto_55c

    .end local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .end local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .end local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .end local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .local v7, "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .local v9, "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .restart local v11  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .restart local v12  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .local v15, "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    :catchall_541
    move-exception v0

    move-object v3, v7

    move-object v2, v9

    move-object v6, v11

    move-object v7, v12

    move-object/from16 v22, v15

    move-object/from16 v20, v16

    move-object/from16 v21, v17

    move-wide/from16 v11, v25

    .end local v9  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .end local v11  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .end local v12  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .end local v15  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local v16  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v17  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .restart local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .local v7, "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .restart local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    goto :goto_55c

    .end local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .end local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .end local v7  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .end local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .end local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v9  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .local v10, "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v11  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .restart local v12  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .local v13, "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .local v14, "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v15  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    :catchall_54f
    move-exception v0

    move-object v2, v9

    move-object v6, v11

    move-object v7, v12

    move-object/from16 v20, v13

    move-object/from16 v21, v14

    move-object/from16 v22, v15

    const/4 v5, 0x0

    move-wide v11, v3

    move-object v3, v10

    .end local v9  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .end local v10  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .end local v11  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .end local v12  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .end local v13  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .end local v14  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .end local v15  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v2  # "createdAppId":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Boolean;>;"
    .restart local v3  # "lastStaticSharedLibSettings":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageSetting;>;"
    .restart local v6  # "versionInfos":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/Settings$VersionInfo;>;"
    .restart local v7  # "prepareResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PrepareResult;>;"
    .restart local v20  # "installResults":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;>;"
    .restart local v21  # "installArgs":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$InstallArgs;>;"
    .restart local v22  # "preparedScans":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    :goto_55c
    if-nez v19, :cond_5a8

    .line 17759
    invoke-interface/range {v22 .. v22}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_566
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_58c

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17760
    .local v4, "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v9, v4, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v9, v9, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v9, v9, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-static {v5}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v10

    invoke-interface {v2, v9, v10}, Ljava/util/Map;->getOrDefault(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/Boolean;

    invoke-virtual {v9}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v9

    if-eqz v9, :cond_58b

    .line 17761
    invoke-direct {v8, v4}, Lcom/android/server/pm/PackageManagerService;->cleanUpAppIdCreation(Lcom/android/server/pm/PackageManagerService$ScanResult;)V

    .line 17763
    .end local v4  # "result":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :cond_58b
    goto :goto_566

    .line 17766
    :cond_58c
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_590
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_5a8

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 17767
    .local v4, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v9, v4, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v9, v9, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    const/4 v10, 0x1

    if-ne v9, v10, :cond_5a7

    .line 17768
    iget-object v9, v4, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iput v5, v9, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    .line 17770
    .end local v4  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    :cond_5a7
    goto :goto_590

    .line 17772
    :cond_5a8
    invoke-interface {v7}, Ljava/util/Map;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_5b0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_5c6

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    .line 17773
    .local v4, "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    iget-object v5, v4, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    if-eqz v5, :cond_5c5

    .line 17774
    iget-object v5, v4, Lcom/android/server/pm/PackageManagerService$PrepareResult;->freezer:Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-virtual {v5}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 17776
    .end local v4  # "result":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    :cond_5c5
    goto :goto_5b0

    .line 17777
    :cond_5c6
    invoke-static {v11, v12}, Landroid/os/Trace;->traceEnd(J)V

    throw v0
.end method

.method private installPackagesTracedLI(Ljava/util/List;)V
    .registers 10
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock",
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Lcom/android/server/pm/PackageManagerService$InstallRequest;",
            ">;)V"
        }
    .end annotation

    .line 17013
    .local p1, "requests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    const-wide/32 v0, 0x40000

    :try_start_3
    const-string/jumbo v2, "installPackages"

    invoke-static {v0, v1, v2}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 17014
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->installPackagesLI(Ljava/util/List;)V

    .line 17016
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    if-eqz v2, :cond_23

    .line 17017
    invoke-static {}, Landroid/scene/SceneClient;->getInstance()Landroid/scene/SceneClient;

    move-result-object v2

    new-instance v3, Landroid/scene/Scene;

    const v4, 0x100000f

    const-string v5, "AppInstall"

    const/4 v6, 0x0

    const/4 v7, 0x0

    invoke-direct {v3, v4, v5, v6, v7}, Landroid/scene/Scene;-><init>(ILjava/lang/String;Ljava/lang/String;I)V

    invoke-virtual {v2, v3}, Landroid/scene/SceneClient;->notifyScene(Landroid/scene/Scene;)V
    :try_end_23
    .catchall {:try_start_3 .. :try_end_23} :catchall_28

    .line 17022
    :cond_23
    invoke-static {v0, v1}, Landroid/os/Trace;->traceEnd(J)V

    .line 17023
    nop

    .line 17024
    return-void

    .line 17022
    :catchall_28
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Trace;->traceEnd(J)V

    throw v2
.end method

.method private installStubPackageLI(Landroid/content/pm/PackageParser$Package;II)Landroid/content/pm/PackageParser$Package;
    .registers 13
    .param p1, "stubPkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 3713
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_COMPRESSION:Z

    if-eqz v0, :cond_1c

    .line 3714
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Uncompressing system stub; pkg: "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3717
    :cond_1c
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-direct {p0, v0, v1}, Lcom/android/server/pm/PackageManagerService;->decompressPackage(Ljava/lang/String;Ljava/lang/String;)Ljava/io/File;

    move-result-object v0

    .line 3718
    .local v0, "scanFile":Ljava/io/File;
    if-eqz v0, :cond_61

    .line 3721
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 3722
    :try_start_29
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v4, 0x1

    invoke-virtual {v2, v3, v4}, Lcom/android/server/pm/Settings;->disableSystemPackageLPw(Ljava/lang/String;Z)Z

    .line 3723
    monitor-exit v1
    :try_end_32
    .catchall {:try_start_29 .. :try_end_32} :catchall_5e

    .line 3724
    invoke-direct {p0, p1, v4}, Lcom/android/server/pm/PackageManagerService;->removePackageLI(Landroid/content/pm/PackageParser$Package;Z)V

    .line 3726
    const-wide/16 v6, 0x0

    const/4 v8, 0x0

    move-object v2, p0

    move-object v3, v0

    move v4, p2

    move v5, p3

    :try_start_3c
    invoke-direct/range {v2 .. v8}, Lcom/android/server/pm/PackageManagerService;->scanPackageTracedLI(Ljava/io/File;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;

    move-result-object v1
    :try_end_40
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_3c .. :try_end_40} :catch_41

    return-object v1

    .line 3727
    :catch_41
    move-exception v1

    .line 3728
    .local v1, "e":Lcom/android/server/pm/PackageManagerException;
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Failed to install compressed system package:"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "PackageManager"

    invoke-static {v3, v2, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 3730
    invoke-virtual {p0, v0}, Lcom/android/server/pm/PackageManagerService;->removeCodePathLI(Ljava/io/File;)V

    .line 3731
    throw v1

    .line 3723
    .end local v1  # "e":Lcom/android/server/pm/PackageManagerException;
    :catchall_5e
    move-exception v2

    :try_start_5f
    monitor-exit v1
    :try_end_60
    .catchall {:try_start_5f .. :try_end_60} :catchall_5e

    throw v2

    .line 3719
    :cond_61
    new-instance v1, Lcom/android/server/pm/PackageManagerException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Unable to decompress stub at "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v1, v2}, Lcom/android/server/pm/PackageManagerException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method private installSystemStubPackages(Ljava/util/List;I)V
    .registers 11
    .param p2, "scanFlags"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;I)V"
        }
    .end annotation

    .line 3602
    .local p1, "systemStubPackageNames":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v0

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_6
    const-string v1, "android"

    const/4 v2, 0x0

    if-ltz v0, :cond_6a

    .line 3603
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    .line 3605
    .local v3, "packageName":Ljava/lang/String;
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, v3}, Lcom/android/server/pm/Settings;->isDisabledSystemPackageLPr(Ljava/lang/String;)Z

    move-result v4

    if-eqz v4, :cond_1d

    .line 3606
    invoke-interface {p1, v0}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 3607
    goto :goto_67

    .line 3610
    :cond_1d
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/PackageParser$Package;

    .line 3611
    .local v4, "pkg":Landroid/content/pm/PackageParser$Package;
    if-nez v4, :cond_2b

    .line 3612
    invoke-interface {p1, v0}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 3613
    goto :goto_67

    .line 3616
    :cond_2b
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 3617
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v5, :cond_42

    .line 3618
    invoke-virtual {v5, v2}, Lcom/android/server/pm/PackageSetting;->getEnabled(I)I

    move-result v6

    .line 3619
    .local v6, "enabledState":I
    const/4 v7, 0x3

    if-ne v6, v7, :cond_42

    .line 3620
    invoke-interface {p1, v0}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 3621
    goto :goto_67

    .line 3627
    .end local v6  # "enabledState":I
    :cond_42
    :try_start_42
    invoke-direct {p0, v4, v2, p2}, Lcom/android/server/pm/PackageManagerService;->installStubPackageLI(Landroid/content/pm/PackageParser$Package;II)Landroid/content/pm/PackageParser$Package;

    .line 3628
    invoke-virtual {v5, v2, v2, v1}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    .line 3630
    invoke-interface {p1, v0}, Ljava/util/List;->remove(I)Ljava/lang/Object;
    :try_end_4b
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_42 .. :try_end_4b} :catch_4c

    .line 3633
    goto :goto_67

    .line 3631
    :catch_4c
    move-exception v1

    .line 3632
    .local v1, "e":Lcom/android/server/pm/PackageManagerException;
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failed to parse uncompressed system package: "

    invoke-virtual {v2, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v2, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v6, "PackageManager"

    invoke-static {v6, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 3602
    .end local v1  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v3  # "packageName":Ljava/lang/String;
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_67
    add-int/lit8 v0, v0, -0x1

    goto :goto_6

    .line 3639
    .end local v0  # "i":I
    :cond_6a
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v0

    add-int/lit8 v0, v0, -0x1

    .restart local v0  # "i":I
    :goto_70
    if-ltz v0, :cond_9e

    .line 3640
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    .line 3641
    .local v3, "pkgName":Ljava/lang/String;
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 3642
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    const/4 v5, 0x2

    invoke-virtual {v4, v5, v2, v1}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    .line 3644
    const/4 v5, 0x6

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Stub disabled; pkg: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 3639
    .end local v3  # "pkgName":Ljava/lang/String;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    add-int/lit8 v0, v0, -0x1

    goto :goto_70

    .line 3646
    .end local v0  # "i":I
    :cond_9e
    return-void
.end method

.method private isCallerAllowedToSilentlyUninstall(ILjava/lang/String;)Z
    .registers 7
    .param p1, "callingUid"  # I
    .param p2, "pkgName"  # Ljava/lang/String;

    .line 19325
    const/4 v0, 0x1

    const/16 v1, 0x7d0

    if-eq p1, v1, :cond_5d

    if-eqz p1, :cond_5d

    .line 19326
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v1

    const/16 v2, 0x3e8

    if-ne v1, v2, :cond_10

    goto :goto_5d

    .line 19329
    :cond_10
    invoke-static {p1}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    .line 19331
    .local v1, "callingUserId":I
    invoke-virtual {p0, p2}, Lcom/android/server/pm/PackageManagerService;->getInstallerPackageName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    const/4 v3, 0x0

    invoke-virtual {p0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    if-ne p1, v2, :cond_20

    .line 19332
    return v0

    .line 19336
    :cond_20
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    if-eqz v2, :cond_2b

    .line 19337
    invoke-virtual {p0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    if-ne p1, v2, :cond_2b

    .line 19338
    return v0

    .line 19342
    :cond_2b
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredUninstallerPackage:Ljava/lang/String;

    if-eqz v2, :cond_36

    .line 19343
    invoke-virtual {p0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    if-ne p1, v2, :cond_36

    .line 19344
    return v0

    .line 19348
    :cond_36
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mStorageManagerPackage:Ljava/lang/String;

    if-eqz v2, :cond_41

    .line 19349
    invoke-virtual {p0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    if-ne p1, v2, :cond_41

    .line 19350
    return v0

    .line 19354
    :cond_41
    const-string v2, "com.meizu.privacy"

    invoke-virtual {p0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    if-ne p1, v2, :cond_4a

    .line 19355
    return v0

    .line 19360
    :cond_4a
    const-string v2, "com.howie.gserverinstall"

    invoke-virtual {p0, v2, v3, v1}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    if-ne p1, v2, :cond_53

    .line 19361
    return v0

    .line 19367
    :cond_53
    const-string v2, "android.permission.MANAGE_PROFILE_AND_DEVICE_OWNERS"

    invoke-virtual {p0, v2, p1}, Lcom/android/server/pm/PackageManagerService;->checkUidPermission(Ljava/lang/String;I)I

    move-result v2

    if-nez v2, :cond_5c

    .line 19369
    return v0

    .line 19372
    :cond_5c
    return v3

    .line 19327
    .end local v1  # "callingUserId":I
    :cond_5d
    :goto_5d
    return v0
.end method

.method private isCallerSameApp(Ljava/lang/String;I)Z
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "uid"  # I

    .line 9268
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/PackageParser$Package;

    .line 9269
    .local v0, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v0, :cond_16

    .line 9270
    invoke-static {p2}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v1

    iget-object v2, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v1, v2, :cond_16

    const/4 v1, 0x1

    goto :goto_17

    :cond_16
    const/4 v1, 0x0

    .line 9269
    :goto_17
    return v1
.end method

.method private isCompatSignatureUpdateNeeded(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p1, "scannedPkg"  # Landroid/content/pm/PackageParser$Package;

    .line 6566
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getSettingsVersionForPackage(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->isCompatSignatureUpdateNeeded(Lcom/android/server/pm/Settings$VersionInfo;)Z

    move-result v0

    return v0
.end method

.method private static isCompatSignatureUpdateNeeded(Lcom/android/server/pm/Settings$VersionInfo;)Z
    .registers 3
    .param p0, "ver"  # Lcom/android/server/pm/Settings$VersionInfo;

    .line 6570
    iget v0, p0, Lcom/android/server/pm/Settings$VersionInfo;->databaseVersion:I

    const/4 v1, 0x2

    if-ge v0, v1, :cond_7

    const/4 v0, 0x1

    goto :goto_8

    :cond_7
    const/4 v0, 0x0

    :goto_8
    return v0
.end method

.method private isComponentVisibleToInstantApp(Landroid/content/ComponentName;)Z
    .registers 4
    .param p1, "component"  # Landroid/content/ComponentName;

    .line 4519
    const/4 v0, 0x1

    invoke-direct {p0, p1, v0}, Lcom/android/server/pm/PackageManagerService;->isComponentVisibleToInstantApp(Landroid/content/ComponentName;I)Z

    move-result v1

    if-eqz v1, :cond_8

    .line 4520
    return v0

    .line 4522
    :cond_8
    const/4 v1, 0x3

    invoke-direct {p0, p1, v1}, Lcom/android/server/pm/PackageManagerService;->isComponentVisibleToInstantApp(Landroid/content/ComponentName;I)Z

    move-result v1

    if-eqz v1, :cond_10

    .line 4523
    return v0

    .line 4525
    :cond_10
    const/4 v1, 0x4

    invoke-direct {p0, p1, v1}, Lcom/android/server/pm/PackageManagerService;->isComponentVisibleToInstantApp(Landroid/content/ComponentName;I)Z

    move-result v1

    if-eqz v1, :cond_18

    .line 4526
    return v0

    .line 4528
    :cond_18
    const/4 v0, 0x0

    return v0
.end method

.method private isComponentVisibleToInstantApp(Landroid/content/ComponentName;I)Z
    .registers 9
    .param p1, "component"  # Landroid/content/ComponentName;
    .param p2, "type"  # I

    .line 4533
    const/high16 v0, 0x200000

    const/high16 v1, 0x100000

    const/4 v2, 0x1

    const/4 v3, 0x0

    if-ne p2, v2, :cond_2c

    .line 4534
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v4, p1}, Lcom/android/server/pm/ComponentResolver;->getActivity(Landroid/content/ComponentName;)Landroid/content/pm/PackageParser$Activity;

    move-result-object v4

    .line 4535
    .local v4, "activity":Landroid/content/pm/PackageParser$Activity;
    if-nez v4, :cond_11

    .line 4536
    return v3

    .line 4538
    :cond_11
    iget-object v5, v4, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iget v5, v5, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/2addr v1, v5

    if-eqz v1, :cond_1a

    move v1, v2

    goto :goto_1b

    :cond_1a
    move v1, v3

    .line 4540
    .local v1, "visibleToInstantApp":Z
    :goto_1b
    iget-object v5, v4, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iget v5, v5, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/2addr v0, v5

    if-nez v0, :cond_24

    move v0, v2

    goto :goto_25

    :cond_24
    move v0, v3

    .line 4542
    .local v0, "explicitlyVisibleToInstantApp":Z
    :goto_25
    if-eqz v1, :cond_2a

    if-eqz v0, :cond_2a

    goto :goto_2b

    :cond_2a
    move v2, v3

    :goto_2b
    return v2

    .line 4543
    .end local v0  # "explicitlyVisibleToInstantApp":Z
    .end local v1  # "visibleToInstantApp":Z
    .end local v4  # "activity":Landroid/content/pm/PackageParser$Activity;
    :cond_2c
    const/4 v4, 0x2

    if-ne p2, v4, :cond_53

    .line 4544
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v4, p1}, Lcom/android/server/pm/ComponentResolver;->getReceiver(Landroid/content/ComponentName;)Landroid/content/pm/PackageParser$Activity;

    move-result-object v4

    .line 4545
    .restart local v4  # "activity":Landroid/content/pm/PackageParser$Activity;
    if-nez v4, :cond_38

    .line 4546
    return v3

    .line 4548
    :cond_38
    iget-object v5, v4, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iget v5, v5, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/2addr v1, v5

    if-eqz v1, :cond_41

    move v1, v2

    goto :goto_42

    :cond_41
    move v1, v3

    .line 4550
    .restart local v1  # "visibleToInstantApp":Z
    :goto_42
    iget-object v5, v4, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    iget v5, v5, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/2addr v0, v5

    if-nez v0, :cond_4b

    move v0, v2

    goto :goto_4c

    :cond_4b
    move v0, v3

    .line 4552
    .restart local v0  # "explicitlyVisibleToInstantApp":Z
    :goto_4c
    if-eqz v1, :cond_51

    if-nez v0, :cond_51

    goto :goto_52

    :cond_51
    move v2, v3

    :goto_52
    return v2

    .line 4553
    .end local v0  # "explicitlyVisibleToInstantApp":Z
    .end local v1  # "visibleToInstantApp":Z
    .end local v4  # "activity":Landroid/content/pm/PackageParser$Activity;
    :cond_53
    const/4 v0, 0x3

    if-ne p2, v0, :cond_69

    .line 4554
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/ComponentResolver;->getService(Landroid/content/ComponentName;)Landroid/content/pm/PackageParser$Service;

    move-result-object v0

    .line 4555
    .local v0, "service":Landroid/content/pm/PackageParser$Service;
    if-eqz v0, :cond_67

    .line 4556
    iget-object v4, v0, Landroid/content/pm/PackageParser$Service;->info:Landroid/content/pm/ServiceInfo;

    iget v4, v4, Landroid/content/pm/ServiceInfo;->flags:I

    and-int/2addr v1, v4

    if-eqz v1, :cond_68

    move v3, v2

    goto :goto_68

    .line 4557
    :cond_67
    nop

    .line 4555
    :cond_68
    :goto_68
    return v3

    .line 4558
    .end local v0  # "service":Landroid/content/pm/PackageParser$Service;
    :cond_69
    const/4 v0, 0x4

    if-ne p2, v0, :cond_7f

    .line 4559
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/ComponentResolver;->getProvider(Landroid/content/ComponentName;)Landroid/content/pm/PackageParser$Provider;

    move-result-object v0

    .line 4560
    .local v0, "provider":Landroid/content/pm/PackageParser$Provider;
    if-eqz v0, :cond_7d

    .line 4561
    iget-object v4, v0, Landroid/content/pm/PackageParser$Provider;->info:Landroid/content/pm/ProviderInfo;

    iget v4, v4, Landroid/content/pm/ProviderInfo;->flags:I

    and-int/2addr v1, v4

    if-eqz v1, :cond_7e

    move v3, v2

    goto :goto_7e

    .line 4562
    :cond_7d
    nop

    .line 4560
    :cond_7e
    :goto_7e
    return v3

    .line 4563
    .end local v0  # "provider":Landroid/content/pm/PackageParser$Provider;
    :cond_7f
    if-nez p2, :cond_86

    .line 4564
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->isComponentVisibleToInstantApp(Landroid/content/ComponentName;)Z

    move-result v0

    return v0

    .line 4566
    :cond_86
    return v3
.end method

.method private static isExternal(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 18987
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    const/high16 v1, 0x40000

    and-int/2addr v0, v1

    if-eqz v0, :cond_b

    const/4 v0, 0x1

    goto :goto_c

    :cond_b
    const/4 v0, 0x0

    :goto_c
    return v0
.end method

.method private static isExternal(Lcom/android/server/pm/PackageSetting;)Z
    .registers 3
    .param p0, "ps"  # Lcom/android/server/pm/PackageSetting;

    .line 18991
    iget v0, p0, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    const/high16 v1, 0x40000

    and-int/2addr v0, v1

    if-eqz v0, :cond_9

    const/4 v0, 0x1

    goto :goto_a

    :cond_9
    const/4 v0, 0x0

    :goto_a
    return v0
.end method

.method private isExternalMediaAvailable()Z
    .registers 2

    .line 13615
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mMediaMounted:Z

    if-nez v0, :cond_d

    invoke-static {}, Landroid/os/Environment;->isExternalStorageEmulated()Z

    move-result v0

    if-eqz v0, :cond_b

    goto :goto_d

    :cond_b
    const/4 v0, 0x0

    goto :goto_e

    :cond_d
    :goto_d
    const/4 v0, 0x1

    :goto_e
    return v0
.end method

.method private isHomeIntent(Landroid/content/Intent;)Z
    .registers 4
    .param p1, "intent"  # Landroid/content/Intent;

    .line 7197
    invoke-virtual {p1}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v0

    const-string v1, "android.intent.action.MAIN"

    invoke-virtual {v1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1e

    .line 7198
    const-string v0, "android.intent.category.HOME"

    invoke-virtual {p1, v0}, Landroid/content/Intent;->hasCategory(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_1e

    .line 7199
    const-string v0, "android.intent.category.DEFAULT"

    invoke-virtual {p1, v0}, Landroid/content/Intent;->hasCategory(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_1e

    const/4 v0, 0x1

    goto :goto_1f

    :cond_1e
    const/4 v0, 0x0

    .line 7197
    :goto_1f
    return v0
.end method

.method private isInstantAppResolutionAllowed(Landroid/content/Intent;Ljava/util/List;IZ)Z
    .registers 21
    .param p1, "intent"  # Landroid/content/Intent;
    .param p3, "userId"  # I
    .param p4, "skipPackageCheck"  # Z
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;IZ)Z"
        }
    .end annotation

    .line 6945
    .local p2, "resolvedActivities":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    move-object/from16 v1, p0

    move-object/from16 v2, p2

    move/from16 v3, p3

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mInstantAppResolverConnection:Lcom/android/server/pm/InstantAppResolverConnection;

    const/4 v4, 0x0

    if-nez v0, :cond_c

    .line 6946
    return v4

    .line 6948
    :cond_c
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    if-nez v0, :cond_11

    .line 6949
    return v4

    .line 6951
    :cond_11
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    if-eqz v0, :cond_18

    .line 6952
    return v4

    .line 6954
    :cond_18
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getFlags()I

    move-result v0

    and-int/lit16 v0, v0, 0x200

    if-eqz v0, :cond_21

    .line 6955
    return v4

    .line 6957
    :cond_21
    if-nez p4, :cond_2a

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getPackage()Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_2a

    .line 6958
    return v4

    .line 6960
    :cond_2a
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->isWebIntent()Z

    move-result v0

    if-nez v0, :cond_41

    .line 6963
    if-eqz v2, :cond_38

    invoke-interface/range {p2 .. p2}, Ljava/util/List;->size()I

    move-result v0

    if-nez v0, :cond_40

    .line 6964
    :cond_38
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getFlags()I

    move-result v0

    and-int/lit16 v0, v0, 0x800

    if-nez v0, :cond_5e

    .line 6965
    :cond_40
    return v4

    .line 6968
    :cond_41
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v0

    if-eqz v0, :cond_e4

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v0

    invoke-virtual {v0}, Landroid/net/Uri;->getHost()Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v0

    if-eqz v0, :cond_57

    goto/16 :goto_e4

    .line 6970
    :cond_57
    invoke-direct {v1, v3}, Lcom/android/server/pm/PackageManagerService;->areWebInstantAppsDisabled(I)Z

    move-result v0

    if-eqz v0, :cond_5e

    .line 6971
    return v4

    .line 6976
    :cond_5e
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 6977
    if-nez v2, :cond_65

    move v0, v4

    goto :goto_69

    :cond_65
    :try_start_65
    invoke-interface/range {p2 .. p2}, Ljava/util/List;->size()I

    move-result v0

    .line 6978
    .local v0, "count":I
    :goto_69
    const/4 v6, 0x0

    .local v6, "n":I
    :goto_6a
    if-ge v6, v0, :cond_de

    .line 6979
    invoke-interface {v2, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Landroid/content/pm/ResolveInfo;

    .line 6980
    .local v7, "info":Landroid/content/pm/ResolveInfo;
    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    .line 6981
    .local v8, "packageName":Ljava/lang/String;
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v9, v9, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v9, v8}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/pm/PackageSetting;

    .line 6982
    .local v9, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v9, :cond_db

    .line 6984
    iget-boolean v10, v7, Landroid/content/pm/ResolveInfo;->handleAllWebDataURI:Z

    if-nez v10, :cond_b9

    .line 6986
    invoke-direct {v1, v9, v3}, Lcom/android/server/pm/PackageManagerService;->getDomainVerificationStatusLPr(Lcom/android/server/pm/PackageSetting;I)J

    move-result-wide v10

    .line 6987
    .local v10, "packedStatus":J
    const/16 v12, 0x20

    shr-long v12, v10, v12

    long-to-int v12, v12

    .line 6988
    .local v12, "status":I
    const/4 v13, 0x2

    if-eq v12, v13, :cond_95

    const/4 v13, 0x4

    if-ne v12, v13, :cond_b9

    .line 6990
    :cond_95
    sget-boolean v13, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v13, :cond_b7

    .line 6991
    const-string v13, "PackageManager"

    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "DENY instant app; pkg: "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, ", status: "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    invoke-static {v13, v14}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 6994
    :cond_b7
    monitor-exit v5

    return v4

    .line 6997
    .end local v10  # "packedStatus":J
    .end local v12  # "status":I
    :cond_b9
    invoke-virtual {v9, v3}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v10

    if-eqz v10, :cond_db

    .line 6998
    sget-boolean v10, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v10, :cond_d9

    .line 6999
    const-string v10, "PackageManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "DENY instant app installed; pkg: "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7002
    :cond_d9
    monitor-exit v5

    return v4

    .line 6978
    .end local v7  # "info":Landroid/content/pm/ResolveInfo;
    .end local v8  # "packageName":Ljava/lang/String;
    .end local v9  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_db
    add-int/lit8 v6, v6, 0x1

    goto :goto_6a

    .line 7006
    .end local v0  # "count":I
    .end local v6  # "n":I
    :cond_de
    monitor-exit v5

    .line 7008
    const/4 v0, 0x1

    return v0

    .line 7006
    :catchall_e1
    move-exception v0

    monitor-exit v5
    :try_end_e3
    .catchall {:try_start_65 .. :try_end_e3} :catchall_e1

    throw v0

    .line 6969
    :cond_e4
    :goto_e4
    return v4
.end method

.method private static isMultiArch(Landroid/content/pm/ApplicationInfo;)Z
    .registers 3
    .param p0, "info"  # Landroid/content/pm/ApplicationInfo;

    .line 18983
    iget v0, p0, Landroid/content/pm/ApplicationInfo;->flags:I

    const/high16 v1, -0x80000000

    and-int/2addr v0, v1

    if-eqz v0, :cond_9

    const/4 v0, 0x1

    goto :goto_a

    :cond_9
    const/4 v0, 0x0

    :goto_a
    return v0
.end method

.method public static isMzApp(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19000
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v1, -0x80000000

    and-int/2addr v0, v1

    if-eqz v0, :cond_b

    const/4 v0, 0x1

    goto :goto_c

    :cond_b
    const/4 v0, 0x0

    :goto_c
    return v0
.end method

.method private static isMzApp(Lcom/android/server/pm/PackageSetting;)Z
    .registers 4
    .param p0, "ps"  # Lcom/android/server/pm/PackageSetting;

    .line 19043
    const/4 v0, 0x0

    if-eqz p0, :cond_1b

    iget-object v1, p0, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v1, :cond_1b

    iget-object v1, p0, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v1, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    if-nez v1, :cond_e

    goto :goto_1b

    .line 19046
    :cond_e
    iget-object v1, p0, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v1, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v2, -0x80000000

    and-int/2addr v1, v2

    if-eqz v1, :cond_1a

    const/4 v0, 0x1

    :cond_1a
    return v0

    .line 19044
    :cond_1b
    :goto_1b
    return v0
.end method

.method private static isOdmApp(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19026
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v1, 0x40000000  # 2.0f

    and-int/2addr v0, v1

    if-eqz v0, :cond_b

    const/4 v0, 0x1

    goto :goto_c

    :cond_b
    const/4 v0, 0x0

    :goto_c
    return v0
.end method

.method private static isOemApp(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19009
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v1, 0x20000

    and-int/2addr v0, v1

    if-eqz v0, :cond_b

    const/4 v0, 0x1

    goto :goto_c

    :cond_b
    const/4 v0, 0x0

    :goto_c
    return v0
.end method

.method private isPackageDeviceAdmin(Ljava/lang/String;I)Z
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 19402
    nop

    .line 19403
    const-string v0, "device_policy"

    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v0

    .line 19402
    invoke-static {v0}, Landroid/app/admin/IDevicePolicyManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/app/admin/IDevicePolicyManager;

    move-result-object v0

    .line 19405
    .local v0, "dpm":Landroid/app/admin/IDevicePolicyManager;
    const/4 v1, 0x0

    if-eqz v0, :cond_43

    .line 19406
    :try_start_e
    invoke-interface {v0, v1}, Landroid/app/admin/IDevicePolicyManager;->getDeviceOwnerComponent(Z)Landroid/content/ComponentName;

    move-result-object v2

    .line 19408
    .local v2, "deviceOwnerComponentName":Landroid/content/ComponentName;
    if-nez v2, :cond_16

    const/4 v3, 0x0

    goto :goto_1a

    .line 19409
    :cond_16
    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v3

    :goto_1a
    nop

    .line 19414
    .local v3, "deviceOwnerPackageName":Ljava/lang/String;
    invoke-virtual {p1, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    const/4 v5, 0x1

    if-eqz v4, :cond_23

    .line 19415
    return v5

    .line 19419
    :cond_23
    const/4 v4, -0x1

    if-ne p2, v4, :cond_2d

    .line 19420
    sget-object v4, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v4}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v4

    .local v4, "users":[I
    goto :goto_31

    .line 19422
    .end local v4  # "users":[I
    :cond_2d
    new-array v4, v5, [I

    aput p2, v4, v1

    .line 19424
    .restart local v4  # "users":[I
    :goto_31
    move v6, v1

    .local v6, "i":I
    :goto_32
    array-length v7, v4

    if-ge v6, v7, :cond_43

    .line 19425
    aget v7, v4, v6

    invoke-interface {v0, p1, v7}, Landroid/app/admin/IDevicePolicyManager;->packageHasActiveAdmins(Ljava/lang/String;I)Z

    move-result v7
    :try_end_3b
    .catch Landroid/os/RemoteException; {:try_start_e .. :try_end_3b} :catch_41

    if-eqz v7, :cond_3e

    .line 19426
    return v5

    .line 19424
    :cond_3e
    add-int/lit8 v6, v6, 0x1

    goto :goto_32

    .line 19430
    .end local v2  # "deviceOwnerComponentName":Landroid/content/ComponentName;
    .end local v3  # "deviceOwnerPackageName":Ljava/lang/String;
    .end local v4  # "users":[I
    .end local v6  # "i":I
    :catch_41
    move-exception v2

    goto :goto_44

    .line 19431
    :cond_43
    nop

    .line 19432
    :goto_44
    return v1
.end method

.method private static isPackageRenamed(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Z
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "renamedPkgName"  # Ljava/lang/String;

    .line 11619
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_e

    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_e

    const/4 v0, 0x1

    goto :goto_f

    :cond_e
    const/4 v0, 0x0

    :goto_f
    return v0
.end method

.method private static isPrivilegedApp(Landroid/content/pm/PackageParser$Package;)Z
    .registers 2
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19005
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    and-int/lit8 v0, v0, 0x8

    if-eqz v0, :cond_a

    const/4 v0, 0x1

    goto :goto_b

    :cond_a
    const/4 v0, 0x0

    :goto_b
    return v0
.end method

.method private static isProductApp(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19017
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v1, 0x80000

    and-int/2addr v0, v1

    if-eqz v0, :cond_b

    const/4 v0, 0x1

    goto :goto_c

    :cond_b
    const/4 v0, 0x0

    :goto_c
    return v0
.end method

.method private static isProductServicesApp(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19021
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v1, 0x200000

    and-int/2addr v0, v1

    if-eqz v0, :cond_b

    const/4 v0, 0x1

    goto :goto_c

    :cond_b
    const/4 v0, 0x0

    :goto_c
    return v0
.end method

.method private isRecentsAccessingChildProfiles(II)Z
    .registers 8
    .param p1, "callingUid"  # I
    .param p2, "targetUserId"  # I

    .line 5396
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getActivityTaskManagerInternal()Lcom/android/server/wm/ActivityTaskManagerInternal;

    move-result-object v0

    invoke-virtual {v0, p1}, Lcom/android/server/wm/ActivityTaskManagerInternal;->isCallerRecents(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_c

    .line 5397
    return v1

    .line 5399
    :cond_c
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 5401
    .local v2, "token":J
    :try_start_10
    invoke-static {p1}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v0

    .line 5402
    .local v0, "callingUserId":I
    invoke-static {}, Landroid/app/ActivityManager;->getCurrentUser()I

    move-result v4
    :try_end_18
    .catchall {:try_start_10 .. :try_end_18} :catchall_29

    if-eq v4, v0, :cond_1f

    .line 5403
    nop

    .line 5407
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5403
    return v1

    .line 5405
    :cond_1f
    :try_start_1f
    sget-object v1, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v1, v0, p2}, Lcom/android/server/pm/UserManagerService;->isSameProfileGroup(II)Z

    move-result v1
    :try_end_25
    .catchall {:try_start_1f .. :try_end_25} :catchall_29

    .line 5407
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5405
    return v1

    .line 5407
    .end local v0  # "callingUserId":I
    :catchall_29
    move-exception v0

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0
.end method

.method private isRecoverSignatureUpdateNeeded(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p1, "scannedPkg"  # Landroid/content/pm/PackageParser$Package;

    .line 6574
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getSettingsVersionForPackage(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->isRecoverSignatureUpdateNeeded(Lcom/android/server/pm/Settings$VersionInfo;)Z

    move-result v0

    return v0
.end method

.method private static isRecoverSignatureUpdateNeeded(Lcom/android/server/pm/Settings$VersionInfo;)Z
    .registers 3
    .param p0, "ver"  # Lcom/android/server/pm/Settings$VersionInfo;

    .line 6578
    iget v0, p0, Lcom/android/server/pm/Settings$VersionInfo;->databaseVersion:I

    const/4 v1, 0x3

    if-ge v0, v1, :cond_7

    const/4 v0, 0x1

    goto :goto_8

    :cond_7
    const/4 v0, 0x0

    :goto_8
    return v0
.end method

.method private static isSystemApp(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 18995
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    const/4 v1, 0x1

    and-int/2addr v0, v1

    if-eqz v0, :cond_9

    goto :goto_a

    :cond_9
    const/4 v1, 0x0

    :goto_a
    return v1
.end method

.method private static isSystemApp(Lcom/android/server/pm/PackageSetting;)Z
    .registers 3
    .param p0, "ps"  # Lcom/android/server/pm/PackageSetting;

    .line 19034
    iget v0, p0, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    const/4 v1, 0x1

    and-int/2addr v0, v1

    if-eqz v0, :cond_7

    goto :goto_8

    :cond_7
    const/4 v1, 0x0

    :goto_8
    return v1
.end method

.method private static isUpdatedSystemApp(Lcom/android/server/pm/PackageSetting;)Z
    .registers 2
    .param p0, "ps"  # Lcom/android/server/pm/PackageSetting;

    .line 19038
    iget v0, p0, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    and-int/lit16 v0, v0, 0x80

    if-eqz v0, :cond_8

    const/4 v0, 0x1

    goto :goto_9

    :cond_8
    const/4 v0, 0x0

    :goto_9
    return v0
.end method

.method private isUserEnabled(I)Z
    .registers 6
    .param p1, "userId"  # I

    .line 7859
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7861
    .local v0, "callingId":J
    :try_start_4
    sget-object v2, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v2, p1}, Lcom/android/server/pm/UserManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;

    move-result-object v2

    .line 7862
    .local v2, "userInfo":Landroid/content/pm/UserInfo;
    if-eqz v2, :cond_14

    invoke-virtual {v2}, Landroid/content/pm/UserInfo;->isEnabled()Z

    move-result v3
    :try_end_10
    .catchall {:try_start_4 .. :try_end_10} :catchall_19

    if-eqz v3, :cond_14

    const/4 v3, 0x1

    goto :goto_15

    :cond_14
    const/4 v3, 0x0

    .line 7864
    :goto_15
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7862
    return v3

    .line 7864
    .end local v2  # "userInfo":Landroid/content/pm/UserInfo;
    :catchall_19
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v2
.end method

.method private static isVendorApp(Landroid/content/pm/PackageParser$Package;)Z
    .registers 3
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19013
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v1, 0x40000

    and-int/2addr v0, v1

    if-eqz v0, :cond_b

    const/4 v0, 0x1

    goto :goto_c

    :cond_b
    const/4 v0, 0x0

    :goto_c
    return v0
.end method

.method private isVerificationEnabled(III)Z
    .registers 9
    .param p1, "userId"  # I
    .param p2, "installFlags"  # I
    .param p3, "installerUid"  # I

    .line 14850
    const/high16 v0, 0x80000

    and-int/2addr v0, p2

    const/4 v1, 0x0

    if-eqz v0, :cond_7

    .line 14851
    return v1

    .line 14854
    :cond_7
    const-string v0, "ensure_verify_apps"

    invoke-virtual {p0, p1, v0}, Lcom/android/server/pm/PackageManagerService;->isUserRestricted(ILjava/lang/String;)Z

    move-result v0

    .line 14857
    .local v0, "ensureVerifyAppsEnabled":Z
    and-int/lit8 v2, p2, 0x20

    const/4 v3, 0x1

    if-eqz v2, :cond_2c

    .line 14859
    invoke-static {}, Landroid/app/ActivityManager;->isRunningInTestHarness()Z

    move-result v2

    if-eqz v2, :cond_19

    .line 14860
    return v1

    .line 14862
    :cond_19
    if-eqz v0, :cond_1c

    .line 14863
    return v3

    .line 14866
    :cond_1c
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    const-string/jumbo v4, "verifier_verify_adb_installs"

    invoke-static {v2, v4, v3}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v2

    if-nez v2, :cond_5a

    .line 14868
    return v1

    .line 14873
    :cond_2c
    and-int/lit16 v2, p2, 0x800

    if-eqz v2, :cond_5a

    .line 14874
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    if-eqz v2, :cond_5a

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    .line 14875
    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_5a

    .line 14878
    :try_start_3e
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v4, Landroid/app/AppOpsManager;

    invoke-virtual {v2, v4}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/app/AppOpsManager;

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    .line 14879
    invoke-virtual {v2, p3, v4}, Landroid/app/AppOpsManager;->checkPackage(ILjava/lang/String;)V

    .line 14880
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_VERIFY:Z

    if-eqz v2, :cond_58

    .line 14881
    const-string v2, "PackageManager"

    const-string v4, "disable verification for instant app"

    invoke-static {v2, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_58
    .catch Ljava/lang/SecurityException; {:try_start_3e .. :try_end_58} :catch_59

    .line 14883
    :cond_58
    return v1

    .line 14884
    :catch_59
    move-exception v2

    .line 14889
    :cond_5a
    if-eqz v0, :cond_5d

    .line 14890
    return v3

    .line 14893
    :cond_5d
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    const-string/jumbo v4, "package_verifier_enable"

    invoke-static {v2, v4, v3}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v2

    if-ne v2, v3, :cond_6d

    move v1, v3

    :cond_6d
    return v1
.end method

.method private killApplication(Ljava/lang/String;IILjava/lang/String;)V
    .registers 9
    .param p1, "pkgName"  # Ljava/lang/String;
    .param p2, "appId"  # I
    .param p3, "userId"  # I
    .param p4, "reason"  # Ljava/lang/String;

    .line 13351
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 13353
    .local v0, "token":J
    :try_start_4
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v2
    :try_end_8
    .catchall {:try_start_4 .. :try_end_8} :catchall_14

    .line 13354
    .local v2, "am":Landroid/app/IActivityManager;
    if-eqz v2, :cond_f

    .line 13356
    :try_start_a
    invoke-interface {v2, p1, p2, p3, p4}, Landroid/app/IActivityManager;->killApplication(Ljava/lang/String;IILjava/lang/String;)V
    :try_end_d
    .catch Landroid/os/RemoteException; {:try_start_a .. :try_end_d} :catch_e
    .catchall {:try_start_a .. :try_end_d} :catchall_14

    .line 13358
    goto :goto_f

    .line 13357
    :catch_e
    move-exception v3

    .line 13361
    .end local v2  # "am":Landroid/app/IActivityManager;
    :cond_f
    :goto_f
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13362
    nop

    .line 13363
    return-void

    .line 13361
    :catchall_14
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v2
.end method

.method private killApplication(Ljava/lang/String;ILjava/lang/String;)V
    .registers 5
    .param p1, "pkgName"  # Ljava/lang/String;
    .param p2, "appId"  # I
    .param p3, "reason"  # Ljava/lang/String;

    .line 13344
    const/4 v0, -0x1

    invoke-direct {p0, p1, p2, v0, p3}, Lcom/android/server/pm/PackageManagerService;->killApplication(Ljava/lang/String;IILjava/lang/String;)V

    .line 13345
    return-void
.end method

.method private killUid(IILjava/lang/String;)V
    .registers 8
    .param p1, "appId"  # I
    .param p2, "userId"  # I
    .param p3, "reason"  # Ljava/lang/String;

    .line 6545
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 6547
    .local v0, "identity":J
    :try_start_4
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v2
    :try_end_8
    .catchall {:try_start_4 .. :try_end_8} :catchall_14

    .line 6548
    .local v2, "am":Landroid/app/IActivityManager;
    if-eqz v2, :cond_f

    .line 6550
    :try_start_a
    invoke-interface {v2, p1, p2, p3}, Landroid/app/IActivityManager;->killUid(IILjava/lang/String;)V
    :try_end_d
    .catch Landroid/os/RemoteException; {:try_start_a .. :try_end_d} :catch_e
    .catchall {:try_start_a .. :try_end_d} :catchall_14

    .line 6553
    goto :goto_f

    .line 6551
    :catch_e
    move-exception v3

    .line 6556
    .end local v2  # "am":Landroid/app/IActivityManager;
    :cond_f
    :goto_f
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6557
    nop

    .line 6558
    return-void

    .line 6556
    :catchall_14
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v2
.end method

.method public static synthetic lambda$XJQWfaGM1EYfvHM2L3JN55XapIQ(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;I)I
    .registers 3

    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->checkUidPermissionImpl(Ljava/lang/String;I)I

    move-result p0

    return p0
.end method

.method static synthetic lambda$addSharedLibraryLPr$4(Landroid/content/pm/SharedLibraryInfo;Landroid/content/pm/SharedLibraryInfo;)V
    .registers 2
    .param p0, "definingLibrary"  # Landroid/content/pm/SharedLibraryInfo;
    .param p1, "dependency"  # Landroid/content/pm/SharedLibraryInfo;

    .line 10943
    invoke-virtual {p0, p1}, Landroid/content/pm/SharedLibraryInfo;->addDependency(Landroid/content/pm/SharedLibraryInfo;)V

    .line 10944
    return-void
.end method

.method public static synthetic lambda$b2Z8hEDt-0dbtmX9ytdWFgSa9tc(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;Ljava/lang/String;I)I
    .registers 4

    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->checkPermissionImpl(Ljava/lang/String;Ljava/lang/String;I)I

    move-result p0

    return p0
.end method

.method static synthetic lambda$deletePackageVersioned$17(Ljava/lang/String;Landroid/content/pm/IPackageDeleteObserver2;)V
    .registers 5
    .param p0, "packageName"  # Ljava/lang/String;
    .param p1, "observer"  # Landroid/content/pm/IPackageDeleteObserver2;

    .line 19101
    :try_start_0
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.UNINSTALL_PACKAGE"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 19102
    .local v0, "intent":Landroid/content/Intent;
    const-string/jumbo v1, "package"

    const/4 v2, 0x0

    invoke-static {v1, p0, v2}, Landroid/net/Uri;->fromParts(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v1

    invoke-virtual {v0, v1}, Landroid/content/Intent;->setData(Landroid/net/Uri;)Landroid/content/Intent;

    .line 19103
    const-string v1, "android.content.pm.extra.CALLBACK"

    invoke-interface {p1}, Landroid/content/pm/IPackageDeleteObserver2;->asBinder()Landroid/os/IBinder;

    move-result-object v2

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/IBinder;)Landroid/content/Intent;

    .line 19104
    invoke-interface {p1, v0}, Landroid/content/pm/IPackageDeleteObserver2;->onUserActionRequired(Landroid/content/Intent;)V
    :try_end_1e
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_1e} :catch_1f

    .line 19106
    .end local v0  # "intent":Landroid/content/Intent;
    goto :goto_20

    .line 19105
    :catch_1f
    move-exception v0

    .line 19107
    :goto_20
    return-void
.end method

.method static synthetic lambda$deletePackageVersioned$18(Landroid/content/pm/IPackageDeleteObserver2;Ljava/lang/String;)V
    .registers 4
    .param p0, "observer"  # Landroid/content/pm/IPackageDeleteObserver2;
    .param p1, "packageName"  # Ljava/lang/String;

    .line 19126
    const/4 v0, -0x3

    const/4 v1, 0x0

    :try_start_2
    invoke-interface {p0, p1, v0, v1}, Landroid/content/pm/IPackageDeleteObserver2;->onPackageDeleted(Ljava/lang/String;ILjava/lang/String;)V
    :try_end_5
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_5} :catch_6

    .line 19129
    goto :goto_7

    .line 19128
    :catch_6
    move-exception v0

    .line 19130
    :goto_7
    return-void
.end method

.method static synthetic lambda$deletePackageVersioned$19(Landroid/content/pm/IPackageDeleteObserver2;Ljava/lang/String;)V
    .registers 4
    .param p0, "observer"  # Landroid/content/pm/IPackageDeleteObserver2;
    .param p1, "packageName"  # Ljava/lang/String;

    .line 19137
    const/4 v0, -0x4

    const/4 v1, 0x0

    :try_start_2
    invoke-interface {p0, p1, v0, v1}, Landroid/content/pm/IPackageDeleteObserver2;->onPackageDeleted(Ljava/lang/String;ILjava/lang/String;)V
    :try_end_5
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_5} :catch_6

    .line 19140
    goto :goto_7

    .line 19139
    :catch_6
    move-exception v0

    .line 19141
    :goto_7
    return-void
.end method

.method static synthetic lambda$deleteTempPackageFiles$16(Ljava/io/File;Ljava/lang/String;)Z
    .registers 3
    .param p0, "dir"  # Ljava/io/File;
    .param p1, "name"  # Ljava/lang/String;

    .line 19065
    const-string/jumbo v0, "vmdl"

    invoke-virtual {p1, v0}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_13

    const-string v0, ".tmp"

    invoke-virtual {p1, v0}, Ljava/lang/String;->endsWith(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_13

    const/4 v0, 0x1

    goto :goto_14

    :cond_13
    const/4 v0, 0x0

    :goto_14
    return v0
.end method

.method static synthetic lambda$executeSharedLibrariesUpdateLPr$5(Landroid/content/pm/SharedLibraryInfo;Landroid/content/pm/SharedLibraryInfo;)V
    .registers 2
    .param p0, "definingLibrary"  # Landroid/content/pm/SharedLibraryInfo;
    .param p1, "dependency"  # Landroid/content/pm/SharedLibraryInfo;

    .line 10996
    invoke-virtual {p0}, Landroid/content/pm/SharedLibraryInfo;->clearDependencies()V

    .line 10997
    return-void
.end method

.method static synthetic lambda$postPreferredActivityChangedBroadcast$24(I)V
    .registers 18
    .param p0, "userId"  # I

    .line 21157
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v15

    .line 21158
    .local v15, "am":Landroid/app/IActivityManager;
    if-nez v15, :cond_7

    .line 21159
    return-void

    .line 21162
    :cond_7
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.intent.action.ACTION_PREFERRED_ACTIVITY_CHANGED"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    move-object v14, v0

    .line 21163
    .local v14, "intent":Landroid/content/Intent;
    const-string v0, "android.intent.extra.user_handle"

    move/from16 v13, p0

    invoke-virtual {v14, v0, v13}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 21164
    const/high16 v0, 0x4000000

    invoke-virtual {v14, v0}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 21166
    const/4 v2, 0x0

    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, -0x1

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v0, 0x0

    move-object v1, v15

    move-object v3, v14

    move v13, v0

    move-object/from16 v16, v14

    .end local v14  # "intent":Landroid/content/Intent;
    .local v16, "intent":Landroid/content/Intent;
    move/from16 v14, p0

    :try_start_2d
    invoke-interface/range {v1 .. v14}, Landroid/app/IActivityManager;->broadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;[Ljava/lang/String;ILandroid/os/Bundle;ZZI)I
    :try_end_30
    .catch Landroid/os/RemoteException; {:try_start_2d .. :try_end_30} :catch_31

    .line 21170
    goto :goto_32

    .line 21169
    :catch_31
    move-exception v0

    .line 21171
    :goto_32
    return-void
.end method

.method static synthetic lambda$registerDexModule$3(Landroid/content/pm/IDexModuleRegisterCallback;Ljava/lang/String;Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;)V
    .registers 6
    .param p0, "callback"  # Landroid/content/pm/IDexModuleRegisterCallback;
    .param p1, "dexModulePath"  # Ljava/lang/String;
    .param p2, "result"  # Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;

    .line 10360
    :try_start_0
    iget-boolean v0, p2, Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;->success:Z

    iget-object v1, p2, Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;->message:Ljava/lang/String;

    invoke-interface {p0, p1, v0, v1}, Landroid/content/pm/IDexModuleRegisterCallback;->onDexModuleRegistered(Ljava/lang/String;ZLjava/lang/String;)V
    :try_end_7
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_7} :catch_8

    .line 10363
    goto :goto_1f

    .line 10361
    :catch_8
    move-exception v0

    .line 10362
    .local v0, "e":Landroid/os/RemoteException;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Failed to callback after module registration "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10364
    .end local v0  # "e":Landroid/os/RemoteException;
    :goto_1f
    return-void
.end method

.method static synthetic lambda$static$8(Landroid/content/pm/ProviderInfo;Landroid/content/pm/ProviderInfo;)I
    .registers 5
    .param p0, "p1"  # Landroid/content/pm/ProviderInfo;
    .param p1, "p2"  # Landroid/content/pm/ProviderInfo;

    .line 13545
    iget v0, p0, Landroid/content/pm/ProviderInfo;->initOrder:I

    .line 13546
    .local v0, "v1":I
    iget v1, p1, Landroid/content/pm/ProviderInfo;->initOrder:I

    .line 13547
    .local v1, "v2":I
    if-le v0, v1, :cond_8

    const/4 v2, -0x1

    goto :goto_d

    :cond_8
    if-ge v0, v1, :cond_c

    const/4 v2, 0x1

    goto :goto_d

    :cond_c
    const/4 v2, 0x0

    :goto_d
    return v2
.end method

.method static synthetic lambda$unsuspendForNonSystemSuspendingPackages$13(Ljava/lang/String;)Z
    .registers 2
    .param p0, "suspendingPackage"  # Ljava/lang/String;

    .line 14483
    const-string v0, "android"

    invoke-virtual {v0, p0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    xor-int/lit8 v0, v0, 0x1

    return v0
.end method

.method private loadPrivatePackages(Landroid/os/storage/VolumeInfo;)V
    .registers 4
    .param p1, "vol"  # Landroid/os/storage/VolumeInfo;

    .line 23602
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$dM4FH74RPFFuHWqzdwMz4odvhec;

    invoke-direct {v1, p0, p1}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$dM4FH74RPFFuHWqzdwMz4odvhec;-><init>(Lcom/android/server/pm/PackageManagerService;Landroid/os/storage/VolumeInfo;)V

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 23603
    return-void
.end method

.method private loadPrivatePackagesInner(Landroid/os/storage/VolumeInfo;)V
    .registers 22
    .param p1, "vol"  # Landroid/os/storage/VolumeInfo;

    .line 23606
    move-object/from16 v8, p0

    move-object/from16 v9, p1

    iget-object v10, v9, Landroid/os/storage/VolumeInfo;->fsUuid:Ljava/lang/String;

    .line 23607
    .local v10, "volumeUuid":Ljava/lang/String;
    invoke-static {v10}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v0

    if-eqz v0, :cond_14

    .line 23608
    const-string v0, "PackageManager"

    const-string v1, "Loading internal storage is probably a mistake; ignoring"

    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 23609
    return-void

    .line 23612
    :cond_14
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    move-object v11, v0

    .line 23613
    .local v11, "freezers":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PackageManagerService$PackageFreezer;>;"
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    move-object v12, v0

    .line 23614
    .local v12, "loaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    iget v0, v8, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    or-int/lit8 v13, v0, 0x8

    .line 23618
    .local v13, "parseFlags":I
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 23619
    :try_start_27
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v10}, Lcom/android/server/pm/Settings;->findOrCreateVersion(Ljava/lang/String;)Lcom/android/server/pm/Settings$VersionInfo;

    move-result-object v0

    move-object v14, v0

    .line 23620
    .local v14, "ver":Lcom/android/server/pm/Settings$VersionInfo;
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v10}, Lcom/android/server/pm/Settings;->getVolumePackagesLPr(Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    move-object v15, v0

    .line 23621
    .local v15, "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    monitor-exit v1
    :try_end_36
    .catchall {:try_start_27 .. :try_end_36} :catchall_1de

    .line 23623
    invoke-interface {v15}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v16

    :goto_3a
    invoke-interface/range {v16 .. v16}, Ljava/util/Iterator;->hasNext()Z

    move-result v0

    if-eqz v0, :cond_c0

    invoke-interface/range {v16 .. v16}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    move-object v7, v0

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 23624
    .local v7, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v0, v7, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    const-string/jumbo v1, "loadPrivatePackagesInner"

    invoke-virtual {v8, v0, v1}, Lcom/android/server/pm/PackageManagerService;->freezePackage(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v0

    invoke-virtual {v11, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 23625
    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v5

    .line 23628
    :try_start_56
    iget-object v2, v7, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;
    :try_end_58
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_56 .. :try_end_58} :catch_7d
    .catchall {:try_start_56 .. :try_end_58} :catchall_76

    const/16 v4, 0x200

    const-wide/16 v17, 0x0

    const/4 v0, 0x0

    move-object/from16 v1, p0

    move v3, v13

    move-object/from16 v19, v5

    move-wide/from16 v5, v17

    move/from16 v17, v13

    move-object v13, v7

    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v13, "ps":Lcom/android/server/pm/PackageSetting;
    .local v17, "parseFlags":I
    move-object v7, v0

    :try_start_68
    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->scanPackageTracedLI(Ljava/io/File;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;

    move-result-object v0

    .line 23629
    .local v0, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v1, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v12, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_71
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_68 .. :try_end_71} :catch_74
    .catchall {:try_start_68 .. :try_end_71} :catchall_72

    .line 23633
    goto :goto_a7

    .line 23639
    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_72
    move-exception v0

    goto :goto_be

    .line 23631
    :catch_74
    move-exception v0

    goto :goto_83

    .line 23639
    .end local v17  # "parseFlags":I
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v13, "parseFlags":I
    :catchall_76
    move-exception v0

    move-object/from16 v19, v5

    move/from16 v17, v13

    move-object v13, v7

    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v13, "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v17  # "parseFlags":I
    goto :goto_be

    .line 23631
    .end local v17  # "parseFlags":I
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v13, "parseFlags":I
    :catch_7d
    move-exception v0

    move-object/from16 v19, v5

    move/from16 v17, v13

    move-object v13, v7

    .line 23632
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    .local v13, "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v17  # "parseFlags":I
    :goto_83
    :try_start_83
    const-string v1, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Failed to scan "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v13, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v3, ": "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 23635
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    :goto_a7
    sget-object v0, Landroid/os/Build;->FINGERPRINT:Ljava/lang/String;

    iget-object v1, v14, Lcom/android/server/pm/Settings$VersionInfo;->fingerprint:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_b9

    .line 23636
    iget-object v0, v13, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    const/4 v1, -0x1

    const/16 v2, 0x27

    invoke-direct {v8, v0, v1, v2}, Lcom/android/server/pm/PackageManagerService;->clearAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 23639
    :cond_b9
    monitor-exit v19

    .line 23640
    .end local v13  # "ps":Lcom/android/server/pm/PackageSetting;
    move/from16 v13, v17

    goto/16 :goto_3a

    .line 23639
    .restart local v13  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_be
    monitor-exit v19
    :try_end_bf
    .catchall {:try_start_83 .. :try_end_bf} :catchall_72

    throw v0

    .line 23643
    .end local v17  # "parseFlags":I
    .local v13, "parseFlags":I
    :cond_c0
    move/from16 v17, v13

    .end local v13  # "parseFlags":I
    .restart local v17  # "parseFlags":I
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v1, Landroid/os/storage/StorageManager;

    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    move-object v2, v0

    check-cast v2, Landroid/os/storage/StorageManager;

    .line 23644
    .local v2, "sm":Landroid/os/storage/StorageManager;
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v1, Landroid/os/UserManager;

    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    move-object v3, v0

    check-cast v3, Landroid/os/UserManager;

    .line 23645
    .local v3, "um":Landroid/os/UserManager;
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getUserManagerInternal()Landroid/os/UserManagerInternal;

    move-result-object v4

    .line 23646
    .local v4, "umInternal":Landroid/os/UserManagerInternal;
    invoke-virtual {v3}, Landroid/os/UserManager;->getUsers()Ljava/util/List;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_e4
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v0

    if-eqz v0, :cond_150

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    move-object v6, v0

    check-cast v6, Landroid/content/pm/UserInfo;

    .line 23647
    .local v6, "user":Landroid/content/pm/UserInfo;
    const/4 v0, 0x0

    .line 23648
    .local v0, "flags":I
    iget v7, v6, Landroid/content/pm/UserInfo;->id:I

    invoke-virtual {v4, v7}, Landroid/os/UserManagerInternal;->isUserUnlockingOrUnlocked(I)Z

    move-result v7

    if-eqz v7, :cond_fc

    .line 23649
    const/4 v0, 0x3

    goto :goto_105

    .line 23650
    :cond_fc
    iget v7, v6, Landroid/content/pm/UserInfo;->id:I

    invoke-virtual {v4, v7}, Landroid/os/UserManagerInternal;->isUserRunning(I)Z

    move-result v7

    if-eqz v7, :cond_14d

    .line 23651
    const/4 v0, 0x1

    .line 23655
    :goto_105
    iget-object v7, v9, Landroid/os/storage/VolumeInfo;->disk:Landroid/os/storage/DiskInfo;

    iget v7, v7, Landroid/os/storage/DiskInfo;->flags:I

    const/16 v13, 0x20

    and-int/2addr v7, v13

    if-ne v7, v13, :cond_112

    .line 23656
    or-int/lit8 v0, v0, 0x20

    move v7, v0

    goto :goto_113

    .line 23655
    :cond_112
    move v7, v0

    .line 23658
    .end local v0  # "flags":I
    .local v7, "flags":I
    :goto_113
    move v13, v7

    .line 23660
    .local v13, "pflags":I
    :try_start_114
    iget v0, v6, Landroid/content/pm/UserInfo;->id:I

    iget v5, v6, Landroid/content/pm/UserInfo;->serialNumber:I

    invoke-virtual {v2, v10, v0, v5, v13}, Landroid/os/storage/StorageManager;->prepareUserStorage(Ljava/lang/String;III)V

    .line 23661
    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v5
    :try_end_11e
    .catch Ljava/lang/IllegalStateException; {:try_start_114 .. :try_end_11e} :catch_131

    .line 23662
    :try_start_11e
    iget v0, v6, Landroid/content/pm/UserInfo;->id:I
    :try_end_120
    .catchall {:try_start_11e .. :try_end_120} :catchall_12a

    move-object/from16 v18, v1

    const/4 v1, 0x1

    :try_start_123
    invoke-direct {v8, v10, v0, v7, v1}, Lcom/android/server/pm/PackageManagerService;->reconcileAppsDataLI(Ljava/lang/String;IIZ)V

    .line 23663
    monitor-exit v5

    .line 23667
    goto :goto_14a

    .line 23663
    :catchall_128
    move-exception v0

    goto :goto_12d

    :catchall_12a
    move-exception v0

    move-object/from16 v18, v1

    :goto_12d
    monitor-exit v5
    :try_end_12e
    .catchall {:try_start_123 .. :try_end_12e} :catchall_128

    .end local v2  # "sm":Landroid/os/storage/StorageManager;
    .end local v3  # "um":Landroid/os/UserManager;
    .end local v4  # "umInternal":Landroid/os/UserManagerInternal;
    .end local v6  # "user":Landroid/content/pm/UserInfo;
    .end local v7  # "flags":I
    .end local v10  # "volumeUuid":Ljava/lang/String;
    .end local v11  # "freezers":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PackageManagerService$PackageFreezer;>;"
    .end local v12  # "loaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    .end local v13  # "pflags":I
    .end local v14  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v15  # "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    .end local v17  # "parseFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "vol":Landroid/os/storage/VolumeInfo;
    :try_start_12e
    throw v0
    :try_end_12f
    .catch Ljava/lang/IllegalStateException; {:try_start_12e .. :try_end_12f} :catch_12f

    .line 23664
    .restart local v2  # "sm":Landroid/os/storage/StorageManager;
    .restart local v3  # "um":Landroid/os/UserManager;
    .restart local v4  # "umInternal":Landroid/os/UserManagerInternal;
    .restart local v6  # "user":Landroid/content/pm/UserInfo;
    .restart local v7  # "flags":I
    .restart local v10  # "volumeUuid":Ljava/lang/String;
    .restart local v11  # "freezers":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PackageManagerService$PackageFreezer;>;"
    .restart local v12  # "loaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    .restart local v13  # "pflags":I
    .restart local v14  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .restart local v15  # "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    .restart local v17  # "parseFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "vol":Landroid/os/storage/VolumeInfo;
    :catch_12f
    move-exception v0

    goto :goto_134

    :catch_131
    move-exception v0

    move-object/from16 v18, v1

    .line 23666
    .local v0, "e":Ljava/lang/IllegalStateException;
    :goto_134
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failed to prepare storage: "

    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v5, "PackageManager"

    invoke-static {v5, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 23668
    .end local v0  # "e":Ljava/lang/IllegalStateException;
    .end local v6  # "user":Landroid/content/pm/UserInfo;
    .end local v7  # "flags":I
    .end local v13  # "pflags":I
    :goto_14a
    move-object/from16 v1, v18

    goto :goto_e4

    .line 23650
    .local v0, "flags":I
    .restart local v6  # "user":Landroid/content/pm/UserInfo;
    :cond_14d
    move-object/from16 v18, v1

    goto :goto_e4

    .line 23670
    .end local v0  # "flags":I
    .end local v6  # "user":Landroid/content/pm/UserInfo;
    :cond_150
    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 23671
    :try_start_153
    iget v0, v14, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I

    iget v1, v8, Lcom/android/server/pm/PackageManagerService;->mSdkVersion:I

    const/4 v6, 0x0

    if-eq v0, v1, :cond_15c

    const/4 v0, 0x1

    goto :goto_15d

    :cond_15c
    move v0, v6

    .line 23672
    .local v0, "sdkUpdated":Z
    :goto_15d
    if-eqz v0, :cond_188

    .line 23673
    const/4 v1, 0x4

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Platform changed from "

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v13, v14, Lcom/android/server/pm/Settings$VersionInfo;->sdkVersion:I

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v13, " to "

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v13, v8, Lcom/android/server/pm/PackageManagerService;->mSdkVersion:I

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v13, "; regranting permissions for "

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v1, v7}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 23676
    :cond_188
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v7, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v7}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v7

    iget-object v13, v8, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    invoke-virtual {v1, v10, v0, v7, v13}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updateAllPermissions(Ljava/lang/String;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 23680
    invoke-virtual {v14}, Lcom/android/server/pm/Settings$VersionInfo;->forceCurrent()V

    .line 23682
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 23683
    .end local v0  # "sdkUpdated":Z
    monitor-exit v5
    :try_end_19e
    .catchall {:try_start_153 .. :try_end_19e} :catchall_1db

    .line 23685
    invoke-virtual {v11}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_1a2
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_1b2

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    .line 23686
    .local v1, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    invoke-virtual {v1}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 23687
    .end local v1  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    goto :goto_1a2

    .line 23689
    :cond_1b2
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_1cc

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Loaded packages "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 23690
    :cond_1cc
    const/4 v0, 0x0

    const/4 v1, 0x1

    invoke-direct {v8, v1, v6, v12, v0}, Lcom/android/server/pm/PackageManagerService;->sendResourcesChangedBroadcast(ZZLjava/util/ArrayList;Landroid/content/IIntentReceiver;)V

    .line 23691
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mLoadedVolumes:Landroid/util/ArraySet;

    invoke-virtual/range {p1 .. p1}, Landroid/os/storage/VolumeInfo;->getId()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 23692
    return-void

    .line 23683
    :catchall_1db
    move-exception v0

    :try_start_1dc
    monitor-exit v5
    :try_end_1dd
    .catchall {:try_start_1dc .. :try_end_1dd} :catchall_1db

    throw v0

    .line 23621
    .end local v2  # "sm":Landroid/os/storage/StorageManager;
    .end local v3  # "um":Landroid/os/UserManager;
    .end local v4  # "umInternal":Landroid/os/UserManagerInternal;
    .end local v14  # "ver":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v15  # "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    .end local v17  # "parseFlags":I
    .local v13, "parseFlags":I
    :catchall_1de
    move-exception v0

    move/from16 v17, v13

    .end local v13  # "parseFlags":I
    .restart local v17  # "parseFlags":I
    :goto_1e1
    :try_start_1e1
    monitor-exit v1
    :try_end_1e2
    .catchall {:try_start_1e1 .. :try_end_1e2} :catchall_1e3

    throw v0

    :catchall_1e3
    move-exception v0

    goto :goto_1e1
.end method

.method static locationIsMzApp(Ljava/lang/String;)Z
    .registers 7
    .param p0, "path"  # Ljava/lang/String;

    .line 19944
    const-string v0, "/"

    const-string v1, "MzApp"

    const/4 v2, 0x0

    :try_start_5
    new-instance v3, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v4

    invoke-direct {v3, v4, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 19945
    .local v3, "mzAppDir":Ljava/io/File;
    new-instance v4, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getVendorDirectory()Ljava/io/File;

    move-result-object v5

    invoke-direct {v4, v5, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    move-object v1, v4

    .line 19946
    .local v1, "vendorMzAppDir":Ljava/io/File;
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {p0, v4}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v4

    if-nez v4, :cond_4a

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v1}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p0, v0}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v0
    :try_end_48
    .catch Ljava/io/IOException; {:try_start_5 .. :try_end_48} :catch_4c

    if-eqz v0, :cond_4b

    :cond_4a
    const/4 v2, 0x1

    :cond_4b
    return v2

    .line 19947
    .end local v1  # "vendorMzAppDir":Ljava/io/File;
    .end local v3  # "mzAppDir":Ljava/io/File;
    :catch_4c
    move-exception v0

    .line 19948
    .local v0, "e":Ljava/io/IOException;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Unable to access code path "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v3, "PackageManager"

    invoke-static {v3, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 19950
    .end local v0  # "e":Ljava/io/IOException;
    return v2
.end method

.method static locationIsOdm(Ljava/lang/String;)Z
    .registers 4
    .param p0, "path"  # Ljava/lang/String;

    .line 19931
    :try_start_0
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-static {}, Landroid/os/Environment;->getOdmDirectory()Ljava/io/File;

    move-result-object v1

    invoke-virtual {v1}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "/"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p0, v0}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v0
    :try_end_1d
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_1d} :catch_1e

    return v0

    .line 19932
    :catch_1e
    move-exception v0

    .line 19933
    .local v0, "e":Ljava/io/IOException;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to access code path "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 19935
    .end local v0  # "e":Ljava/io/IOException;
    const/4 v0, 0x0

    return v0
.end method

.method static locationIsOem(Ljava/lang/String;)Z
    .registers 4
    .param p0, "path"  # Ljava/lang/String;

    .line 19893
    :try_start_0
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-static {}, Landroid/os/Environment;->getOemDirectory()Ljava/io/File;

    move-result-object v1

    invoke-virtual {v1}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "/"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p0, v0}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v0
    :try_end_1d
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_1d} :catch_1e

    return v0

    .line 19894
    :catch_1e
    move-exception v0

    .line 19895
    .local v0, "e":Ljava/io/IOException;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to access code path "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 19897
    .end local v0  # "e":Ljava/io/IOException;
    const/4 v0, 0x0

    return v0
.end method

.method static locationIsPrivileged(Ljava/lang/String;)Z
    .registers 10
    .param p0, "path"  # Ljava/lang/String;

    .line 19874
    const-string v0, "/"

    const-string/jumbo v1, "priv-app"

    const/4 v2, 0x0

    :try_start_6
    new-instance v3, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v4

    invoke-direct {v3, v4, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 19875
    .local v3, "privilegedAppDir":Ljava/io/File;
    new-instance v4, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getVendorDirectory()Ljava/io/File;

    move-result-object v5

    invoke-direct {v4, v5, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 19876
    .local v4, "privilegedVendorAppDir":Ljava/io/File;
    new-instance v5, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getOdmDirectory()Ljava/io/File;

    move-result-object v6

    invoke-direct {v5, v6, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 19877
    .local v5, "privilegedOdmAppDir":Ljava/io/File;
    new-instance v6, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getProductDirectory()Ljava/io/File;

    move-result-object v7

    invoke-direct {v6, v7, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 19878
    .local v6, "privilegedProductAppDir":Ljava/io/File;
    new-instance v7, Ljava/io/File;

    .line 19879
    invoke-static {}, Landroid/os/Environment;->getProductServicesDirectory()Ljava/io/File;

    move-result-object v8

    invoke-direct {v7, v8, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    move-object v1, v7

    .line 19880
    .local v1, "privilegedProductServicesAppDir":Ljava/io/File;
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {p0, v7}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v7

    if-nez v7, :cond_b1

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    .line 19881
    invoke-virtual {v4}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {p0, v7}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v7

    if-nez v7, :cond_b1

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    .line 19882
    invoke-virtual {v5}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {p0, v7}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v7

    if-nez v7, :cond_b1

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    .line 19883
    invoke-virtual {v6}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {p0, v7}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v7

    if-nez v7, :cond_b1

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    .line 19884
    invoke-virtual {v1}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p0, v0}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v0
    :try_end_af
    .catch Ljava/io/IOException; {:try_start_6 .. :try_end_af} :catch_b3

    if-eqz v0, :cond_b2

    :cond_b1
    const/4 v2, 0x1

    .line 19880
    :cond_b2
    return v2

    .line 19885
    .end local v1  # "privilegedProductServicesAppDir":Ljava/io/File;
    .end local v3  # "privilegedAppDir":Ljava/io/File;
    .end local v4  # "privilegedVendorAppDir":Ljava/io/File;
    .end local v5  # "privilegedOdmAppDir":Ljava/io/File;
    .end local v6  # "privilegedProductAppDir":Ljava/io/File;
    :catch_b3
    move-exception v0

    .line 19886
    .local v0, "e":Ljava/io/IOException;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Unable to access code path "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v3, "PackageManager"

    invoke-static {v3, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 19888
    .end local v0  # "e":Ljava/io/IOException;
    return v2
.end method

.method static locationIsProduct(Ljava/lang/String;)Z
    .registers 4
    .param p0, "path"  # Ljava/lang/String;

    .line 19912
    :try_start_0
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-static {}, Landroid/os/Environment;->getProductDirectory()Ljava/io/File;

    move-result-object v1

    invoke-virtual {v1}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "/"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p0, v0}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v0
    :try_end_1d
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_1d} :catch_1e

    return v0

    .line 19913
    :catch_1e
    move-exception v0

    .line 19914
    .local v0, "e":Ljava/io/IOException;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to access code path "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 19916
    .end local v0  # "e":Ljava/io/IOException;
    const/4 v0, 0x0

    return v0
.end method

.method static locationIsProductServices(Ljava/lang/String;)Z
    .registers 4
    .param p0, "path"  # Ljava/lang/String;

    .line 19921
    :try_start_0
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    .line 19922
    invoke-static {}, Landroid/os/Environment;->getProductServicesDirectory()Ljava/io/File;

    move-result-object v1

    invoke-virtual {v1}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "/"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 19921
    invoke-virtual {p0, v0}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v0
    :try_end_1d
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_1d} :catch_1e

    return v0

    .line 19923
    :catch_1e
    move-exception v0

    .line 19924
    .local v0, "e":Ljava/io/IOException;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to access code path "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 19926
    .end local v0  # "e":Ljava/io/IOException;
    const/4 v0, 0x0

    return v0
.end method

.method static locationIsVendor(Ljava/lang/String;)Z
    .registers 5
    .param p0, "path"  # Ljava/lang/String;

    .line 19902
    const-string v0, "/"

    const/4 v1, 0x0

    :try_start_3
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    invoke-static {}, Landroid/os/Environment;->getVendorDirectory()Ljava/io/File;

    move-result-object v3

    invoke-virtual {v3}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {p0, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v2

    if-nez v2, :cond_3d

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    .line 19903
    invoke-static {}, Landroid/os/Environment;->getOdmDirectory()Ljava/io/File;

    move-result-object v3

    invoke-virtual {v3}, Ljava/io/File;->getCanonicalPath()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p0, v0}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v0
    :try_end_3b
    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_3b} :catch_3f

    if-eqz v0, :cond_3e

    :cond_3d
    const/4 v1, 0x1

    .line 19902
    :cond_3e
    return v1

    .line 19904
    :catch_3f
    move-exception v0

    .line 19905
    .local v0, "e":Ljava/io/IOException;
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Unable to access code path "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "PackageManager"

    invoke-static {v3, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 19907
    .end local v0  # "e":Ljava/io/IOException;
    return v1
.end method

.method private logAppMovedStorage(Ljava/lang/String;Z)V
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "isPreviousLocationExternal"  # Z

    .line 24534
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 24535
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 24536
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    monitor-exit v0
    :try_end_c
    .catchall {:try_start_3 .. :try_end_c} :catchall_49

    .line 24537
    if-nez v1, :cond_f

    .line 24538
    return-void

    .line 24541
    :cond_f
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v2, Landroid/os/storage/StorageManager;

    invoke-virtual {v0, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/os/storage/StorageManager;

    .line 24542
    .local v0, "storage":Landroid/os/storage/StorageManager;
    iget-object v2, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->storageUuid:Ljava/util/UUID;

    invoke-virtual {v2}, Ljava/util/UUID;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v0, v2}, Landroid/os/storage/StorageManager;->findVolumeByUuid(Ljava/lang/String;)Landroid/os/storage/VolumeInfo;

    move-result-object v2

    .line 24543
    .local v2, "volume":Landroid/os/storage/VolumeInfo;
    invoke-static {v1}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z

    move-result v3

    invoke-static {v2, v3}, Lcom/android/server/pm/PackageManagerService;->getPackageExternalStorageType(Landroid/os/storage/VolumeInfo;Z)I

    move-result v3

    .line 24545
    .local v3, "packageExternalStorageType":I
    const/16 v4, 0xb7

    if-nez p2, :cond_3c

    invoke-static {v1}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z

    move-result v5

    if-eqz v5, :cond_3c

    .line 24547
    const/4 v5, 0x1

    invoke-static {v4, v3, v5, p1}, Landroid/util/StatsLog;->write(IIILjava/lang/String;)I

    goto :goto_48

    .line 24550
    :cond_3c
    if-eqz p2, :cond_48

    invoke-static {v1}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z

    move-result v5

    if-nez v5, :cond_48

    .line 24552
    const/4 v5, 0x2

    invoke-static {v4, v3, v5, p1}, Landroid/util/StatsLog;->write(IIILjava/lang/String;)I

    .line 24556
    :cond_48
    :goto_48
    return-void

    .line 24536
    .end local v0  # "storage":Landroid/os/storage/StorageManager;
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v2  # "volume":Landroid/os/storage/VolumeInfo;
    .end local v3  # "packageExternalStorageType":I
    :catchall_49
    move-exception v1

    :try_start_4a
    monitor-exit v0
    :try_end_4b
    .catchall {:try_start_4a .. :try_end_4b} :catchall_49

    throw v1
.end method

.method public static main(Landroid/content/Context;Lcom/android/server/pm/Installer;ZZ)Lcom/android/server/pm/PackageManagerService;
    .registers 7
    .param p0, "context"  # Landroid/content/Context;
    .param p1, "installer"  # Lcom/android/server/pm/Installer;
    .param p2, "factoryTest"  # Z
    .param p3, "onlyCore"  # Z

    .line 2402
    invoke-static {}, Lcom/android/server/pm/PackageManagerServiceCompilerMapping;->checkProperties()V

    .line 2404
    new-instance v0, Lcom/android/server/pm/PackageManagerService;

    invoke-direct {v0, p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;-><init>(Landroid/content/Context;Lcom/android/server/pm/Installer;ZZ)V

    .line 2406
    .local v0, "m":Lcom/android/server/pm/PackageManagerService;
    invoke-direct {v0}, Lcom/android/server/pm/PackageManagerService;->enableSystemUserPackages()V

    .line 2407
    const-string/jumbo v1, "package"

    invoke-static {v1, v0}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 2408
    new-instance v1, Lcom/android/server/pm/PackageManagerService$PackageManagerNative;

    invoke-static {v0}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;

    const/4 v2, 0x0

    invoke-direct {v1, v0, v2}, Lcom/android/server/pm/PackageManagerService$PackageManagerNative;-><init>(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$1;)V

    .line 2409
    .local v1, "pmn":Lcom/android/server/pm/PackageManagerService$PackageManagerNative;
    const-string/jumbo v2, "package_native"

    invoke-static {v2, v1}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 2410
    return-object v0
.end method

.method private markPackageUninstalledForUserLPw(Lcom/android/server/pm/PackageSetting;Landroid/os/UserHandle;)V
    .registers 31
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "user"  # Landroid/os/UserHandle;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 20549
    move-object/from16 v1, p1

    const/4 v0, 0x0

    if-eqz p2, :cond_17

    invoke-virtual/range {p2 .. p2}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v2

    const/4 v3, -0x1

    if-ne v2, v3, :cond_d

    goto :goto_17

    .line 20550
    :cond_d
    const/4 v2, 0x1

    new-array v2, v2, [I

    invoke-virtual/range {p2 .. p2}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v3

    aput v3, v2, v0

    goto :goto_1d

    :cond_17
    :goto_17
    sget-object v2, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v2}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v2

    :goto_1d
    move-object v15, v2

    .line 20551
    .local v15, "userIds":[I
    array-length v14, v15

    :goto_1f
    if-ge v0, v14, :cond_8b

    aget v13, v15, v0

    .line 20552
    .local v13, "nextUserId":I
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v2, :cond_47

    .line 20553
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Marking package:"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " uninstalled for user:"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "PackageManager"

    invoke-static {v3, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 20555
    :cond_47
    const-wide/16 v2, 0x0

    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v6, 0x1

    const/4 v7, 0x1

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/16 v16, 0x0

    move v2, v13

    .end local v13  # "nextUserId":I
    .local v2, "nextUserId":I
    move-object/from16 v13, v16

    const/4 v3, 0x0

    move/from16 v25, v14

    move-object v14, v3

    const/4 v3, 0x0

    move-object/from16 v26, v15

    .end local v15  # "userIds":[I
    .local v26, "userIds":[I
    move v15, v3

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, 0x0

    const/16 v19, 0x0

    .line 20571
    invoke-virtual {v1, v2}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v3

    iget v3, v3, Landroid/content/pm/PackageUserState;->domainVerificationStatus:I

    move/from16 v20, v3

    const/16 v21, 0x0

    const/16 v22, 0x0

    const/16 v23, 0x0

    .line 20555
    move/from16 v27, v0

    move-object/from16 v0, p1

    move-object v3, v1

    move v1, v2

    move/from16 v24, v2

    const-wide/16 v2, 0x0

    .end local v2  # "nextUserId":I
    .local v24, "nextUserId":I
    invoke-virtual/range {v0 .. v23}, Lcom/android/server/pm/PackageSetting;->setUserState(IJIZZZZIZLjava/lang/String;Landroid/content/pm/SuspendDialogInfo;Landroid/os/PersistableBundle;Landroid/os/PersistableBundle;ZZLjava/lang/String;Landroid/util/ArraySet;Landroid/util/ArraySet;IIILjava/lang/String;)V

    .line 20551
    .end local v24  # "nextUserId":I
    add-int/lit8 v0, v27, 0x1

    move-object/from16 v1, p1

    move/from16 v14, v25

    move-object/from16 v15, v26

    goto :goto_1f

    .line 20575
    .end local v26  # "userIds":[I
    .restart local v15  # "userIds":[I
    :cond_8b
    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    move-object/from16 v2, p1

    invoke-virtual {v1, v2}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V

    .line 20576
    return-void
.end method

.method private matchComponentForVerifier(Ljava/lang/String;Ljava/util/List;)Landroid/content/ComponentName;
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;)",
            "Landroid/content/ComponentName;"
        }
    .end annotation

    .line 14701
    .local p2, "receivers":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/4 v0, 0x0

    .line 14703
    .local v0, "targetReceiver":Landroid/content/pm/ActivityInfo;
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v1

    .line 14704
    .local v1, "NR":I
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_6
    if-ge v2, v1, :cond_23

    .line 14705
    invoke-interface {p2, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    .line 14706
    .local v3, "info":Landroid/content/pm/ResolveInfo;
    iget-object v4, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    if-nez v4, :cond_13

    .line 14707
    goto :goto_20

    .line 14710
    :cond_13
    iget-object v4, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {p1, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_20

    .line 14711
    iget-object v0, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 14712
    goto :goto_23

    .line 14704
    .end local v3  # "info":Landroid/content/pm/ResolveInfo;
    :cond_20
    :goto_20
    add-int/lit8 v2, v2, 0x1

    goto :goto_6

    .line 14716
    .end local v2  # "i":I
    :cond_23
    :goto_23
    if-nez v0, :cond_27

    .line 14717
    const/4 v2, 0x0

    return-object v2

    .line 14720
    :cond_27
    new-instance v2, Landroid/content/ComponentName;

    iget-object v3, v0, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v4, v0, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v2, v3, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    return-object v2
.end method

.method private matchVerifiers(Landroid/content/pm/PackageInfoLite;Ljava/util/List;Lcom/android/server/pm/PackageVerificationState;)Ljava/util/List;
    .registers 12
    .param p1, "pkgInfo"  # Landroid/content/pm/PackageInfoLite;
    .param p3, "verificationState"  # Lcom/android/server/pm/PackageVerificationState;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageInfoLite;",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;",
            "Lcom/android/server/pm/PackageVerificationState;",
            ")",
            "Ljava/util/List<",
            "Landroid/content/ComponentName;",
            ">;"
        }
    .end annotation

    .line 14725
    .local p2, "receivers":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    iget-object v0, p1, Landroid/content/pm/PackageInfoLite;->verifiers:[Landroid/content/pm/VerifierInfo;

    array-length v0, v0

    if-nez v0, :cond_7

    .line 14726
    const/4 v0, 0x0

    return-object v0

    .line 14729
    :cond_7
    iget-object v0, p1, Landroid/content/pm/PackageInfoLite;->verifiers:[Landroid/content/pm/VerifierInfo;

    array-length v0, v0

    .line 14730
    .local v0, "N":I
    new-instance v1, Ljava/util/ArrayList;

    add-int/lit8 v2, v0, 0x1

    invoke-direct {v1, v2}, Ljava/util/ArrayList;-><init>(I)V

    .line 14731
    .local v1, "sufficientVerifiers":Ljava/util/List;, "Ljava/util/List<Landroid/content/ComponentName;>;"
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_12
    if-ge v2, v0, :cond_53

    .line 14732
    iget-object v3, p1, Landroid/content/pm/PackageInfoLite;->verifiers:[Landroid/content/pm/VerifierInfo;

    aget-object v3, v3, v2

    .line 14734
    .local v3, "verifierInfo":Landroid/content/pm/VerifierInfo;
    iget-object v4, v3, Landroid/content/pm/VerifierInfo;->packageName:Ljava/lang/String;

    invoke-direct {p0, v4, p2}, Lcom/android/server/pm/PackageManagerService;->matchComponentForVerifier(Ljava/lang/String;Ljava/util/List;)Landroid/content/ComponentName;

    move-result-object v4

    .line 14736
    .local v4, "comp":Landroid/content/ComponentName;
    if-nez v4, :cond_21

    .line 14737
    goto :goto_50

    .line 14740
    :cond_21
    invoke-direct {p0, v3}, Lcom/android/server/pm/PackageManagerService;->getUidForVerifier(Landroid/content/pm/VerifierInfo;)I

    move-result v5

    .line 14741
    .local v5, "verifierUid":I
    const/4 v6, -0x1

    if-ne v5, v6, :cond_29

    .line 14742
    goto :goto_50

    .line 14745
    :cond_29
    sget-boolean v6, Lcom/android/server/pm/PackageManagerService;->DEBUG_VERIFY:Z

    if-eqz v6, :cond_4a

    .line 14746
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Added sufficient verifier "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v3, Landroid/content/pm/VerifierInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " with the correct signature"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const-string v7, "PackageManager"

    invoke-static {v7, v6}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 14749
    :cond_4a
    invoke-interface {v1, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 14750
    invoke-virtual {p3, v5}, Lcom/android/server/pm/PackageVerificationState;->addSufficientVerifier(I)V

    .line 14731
    .end local v3  # "verifierInfo":Landroid/content/pm/VerifierInfo;
    .end local v4  # "comp":Landroid/content/ComponentName;
    .end local v5  # "verifierUid":I
    :goto_50
    add-int/lit8 v2, v2, 0x1

    goto :goto_12

    .line 14753
    .end local v2  # "i":I
    :cond_53
    return-object v1
.end method

.method private static mayDeletePackageLocked(Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;[Lcom/android/server/pm/PackageSetting;ILandroid/os/UserHandle;)Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    .registers 19
    .param p0, "outInfo"  # Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "disabledPs"  # Lcom/android/server/pm/PackageSetting;
    .param p3, "children"  # [Lcom/android/server/pm/PackageSetting;
    .param p4, "flags"  # I
    .param p5, "user"  # Landroid/os/UserHandle;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 20286
    move-object v7, p0

    move-object v8, p1

    move-object/from16 v9, p3

    const/4 v0, 0x0

    if-nez v8, :cond_8

    .line 20287
    return-object v0

    .line 20289
    :cond_8
    invoke-static {p1}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Lcom/android/server/pm/PackageSetting;)Z

    move-result v1

    const/4 v2, 0x0

    if-eqz v1, :cond_6c

    .line 20290
    iget-object v1, v8, Lcom/android/server/pm/PackageSetting;->parentPackageName:Ljava/lang/String;

    const-string v3, "PackageManager"

    if-eqz v1, :cond_2e

    .line 20291
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Attempt to delete child system package "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v8, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v3, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 20292
    return-object v0

    .line 20295
    :cond_2e
    and-int/lit8 v1, p4, 0x4

    const/4 v4, 0x1

    if-eqz v1, :cond_35

    move v1, v4

    goto :goto_36

    :cond_35
    move v1, v2

    .line 20296
    .local v1, "deleteSystem":Z
    :goto_36
    if-eqz p5, :cond_42

    .line 20297
    invoke-virtual/range {p5 .. p5}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v5

    const/4 v6, -0x1

    if-ne v5, v6, :cond_40

    goto :goto_42

    :cond_40
    move v4, v2

    goto :goto_43

    :cond_42
    :goto_42
    nop

    .line 20298
    .local v4, "deleteAllUsers":Z
    :goto_43
    if-eqz v1, :cond_47

    if-eqz v4, :cond_6c

    :cond_47
    if-nez p2, :cond_6c

    .line 20302
    iget-boolean v5, v8, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    if-eqz v5, :cond_53

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->inCts()Z

    move-result v5

    if-eqz v5, :cond_6c

    .line 20303
    :cond_53
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Attempt to delete unknown system package "

    invoke-virtual {v2, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v8, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v5, v5, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v3, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 20304
    return-object v0

    .line 20313
    .end local v1  # "deleteSystem":Z
    .end local v4  # "deleteAllUsers":Z
    :cond_6c
    iget-object v1, v8, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v1, :cond_77

    iget-object v1, v8, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v1

    goto :goto_78

    :cond_77
    move v1, v2

    :goto_78
    move v10, v1

    .line 20314
    .local v10, "parentReferenceCount":I
    if-eqz v9, :cond_7d

    array-length v1, v9

    goto :goto_7e

    :cond_7d
    move v1, v2

    :goto_7e
    move v11, v1

    .line 20315
    .local v11, "childCount":I
    if-eq v11, v10, :cond_82

    .line 20316
    return-object v0

    .line 20318
    :cond_82
    if-eqz v11, :cond_a0

    if-eqz v7, :cond_a0

    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    if-eqz v1, :cond_a0

    .line 20319
    array-length v1, v9

    :goto_8b
    if-ge v2, v1, :cond_a0

    aget-object v3, v9, v2

    .line 20320
    .local v3, "child":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_9f

    iget-object v4, v8, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    iget-object v5, v3, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-interface {v4, v5}, Ljava/util/List;->contains(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_9c

    goto :goto_9f

    .line 20319
    .end local v3  # "child":Lcom/android/server/pm/PackageSetting;
    :cond_9c
    add-int/lit8 v2, v2, 0x1

    goto :goto_8b

    .line 20321
    .restart local v3  # "child":Lcom/android/server/pm/PackageSetting;
    :cond_9f
    :goto_9f
    return-object v0

    .line 20325
    .end local v3  # "child":Lcom/android/server/pm/PackageSetting;
    :cond_a0
    new-instance v12, Lcom/android/server/pm/PackageManagerService$DeletePackageAction;

    const/4 v6, 0x0

    move-object v0, v12

    move-object v1, p1

    move-object v2, p2

    move-object v3, p0

    move/from16 v4, p4

    move-object/from16 v5, p5

    invoke-direct/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService$DeletePackageAction;-><init>(Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ILandroid/os/UserHandle;Lcom/android/server/pm/PackageManagerService$1;)V

    return-object v12
.end method

.method private maybeAddInstantAppInstaller(Ljava/util/List;Landroid/content/Intent;Ljava/lang/String;IIZ)Ljava/util/List;
    .registers 28
    .param p2, "intent"  # Landroid/content/Intent;
    .param p3, "resolvedType"  # Ljava/lang/String;
    .param p4, "flags"  # I
    .param p5, "userId"  # I
    .param p6, "resolveForStart"  # Z
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "IIZ)",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 7693
    .local p1, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v10, p5

    const/high16 v2, 0x800000

    and-int v3, p4, v2

    const/4 v11, 0x1

    if-eqz v3, :cond_f

    move v3, v11

    goto :goto_10

    :cond_f
    const/4 v3, 0x0

    :goto_10
    move v13, v3

    .line 7694
    .local v13, "alreadyResolvedLocally":Z
    const/4 v3, 0x0

    .line 7695
    .local v3, "localInstantApp":Landroid/content/pm/ResolveInfo;
    const/4 v4, 0x0

    .line 7696
    .local v4, "blockResolution":Z
    const-string v14, "PackageManager"

    if-nez v13, :cond_9c

    .line 7697
    iget-object v5, v0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    or-int/lit8 v6, p4, 0x40

    or-int/2addr v2, v6

    const/high16 v6, 0x1000000

    or-int/2addr v2, v6

    move-object/from16 v15, p2

    move-object/from16 v9, p3

    invoke-virtual {v5, v15, v9, v2, v10}, Lcom/android/server/pm/ComponentResolver;->queryActivities(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v2

    .line 7705
    .local v2, "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v5

    sub-int/2addr v5, v11

    .local v5, "i":I
    :goto_2c
    if-ltz v5, :cond_99

    .line 7706
    invoke-interface {v2, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/ResolveInfo;

    .line 7707
    .local v6, "info":Landroid/content/pm/ResolveInfo;
    iget-object v7, v6, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    .line 7708
    .local v7, "packageName":Ljava/lang/String;
    iget-object v8, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v8, v8, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v8, v7}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/pm/PackageSetting;

    .line 7709
    .local v8, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v8, v10}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v16

    if-eqz v16, :cond_93

    .line 7710
    invoke-direct {v0, v8, v10}, Lcom/android/server/pm/PackageManagerService;->getDomainVerificationStatusLPr(Lcom/android/server/pm/PackageSetting;I)J

    move-result-wide v16

    .line 7711
    .local v16, "packedStatus":J
    const/16 v18, 0x20

    shr-long v11, v16, v18

    long-to-int v11, v11

    .line 7712
    .local v11, "status":I
    const/4 v12, 0x3

    if-ne v11, v12, :cond_75

    .line 7716
    sget-boolean v12, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v12, :cond_6f

    .line 7717
    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v18, v2

    .end local v2  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v18, "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const-string v2, "Instant app marked to never run; pkg: "

    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v14, v2}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_71

    .line 7716
    .end local v18  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v2  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_6f
    move-object/from16 v18, v2

    .line 7719
    .end local v2  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v18  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :goto_71
    const/4 v4, 0x1

    .line 7720
    move-object v12, v3

    move v11, v4

    goto :goto_a2

    .line 7724
    .end local v18  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v2  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_75
    move-object/from16 v18, v2

    .end local v2  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v18  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v2, :cond_8f

    .line 7725
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Found installed instant app; pkg: "

    invoke-virtual {v2, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v14, v2}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7727
    :cond_8f
    move-object v3, v6

    .line 7728
    move-object v12, v3

    move v11, v4

    goto :goto_a2

    .line 7709
    .end local v11  # "status":I
    .end local v16  # "packedStatus":J
    .end local v18  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v2  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_93
    move-object/from16 v18, v2

    .line 7705
    .end local v2  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v6  # "info":Landroid/content/pm/ResolveInfo;
    .end local v7  # "packageName":Ljava/lang/String;
    .end local v8  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v18  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    add-int/lit8 v5, v5, -0x1

    const/4 v11, 0x1

    goto :goto_2c

    .end local v18  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v2  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_99
    move-object/from16 v18, v2

    .end local v2  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v18  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    goto :goto_a0

    .line 7696
    .end local v5  # "i":I
    .end local v18  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_9c
    move-object/from16 v15, p2

    move-object/from16 v9, p3

    .line 7734
    :goto_a0
    move-object v12, v3

    move v11, v4

    .end local v3  # "localInstantApp":Landroid/content/pm/ResolveInfo;
    .end local v4  # "blockResolution":Z
    .local v11, "blockResolution":Z
    .local v12, "localInstantApp":Landroid/content/pm/ResolveInfo;
    :goto_a2
    const/16 v16, 0x0

    .line 7735
    .local v16, "auxiliaryResponse":Landroid/content/pm/AuxiliaryResolveInfo;
    if-nez v11, :cond_e9

    .line 7736
    if-nez v12, :cond_d4

    .line 7738
    const-wide/32 v7, 0x40000

    const-string/jumbo v2, "resolveEphemeral"

    invoke-static {v7, v8, v2}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 7739
    new-instance v17, Landroid/content/pm/InstantAppRequest;

    const/4 v3, 0x0

    const/4 v6, 0x0

    const/16 v18, 0x0

    move-object/from16 v2, v17

    move-object/from16 v4, p2

    move-object/from16 v5, p3

    move-wide/from16 v19, v7

    move/from16 v7, p5

    move-object/from16 v8, v18

    move/from16 v9, p6

    invoke-direct/range {v2 .. v9}, Landroid/content/pm/InstantAppRequest;-><init>(Landroid/content/pm/AuxiliaryResolveInfo;Landroid/content/Intent;Ljava/lang/String;Ljava/lang/String;ILandroid/os/Bundle;Z)V

    .line 7743
    .local v2, "requestObject":Landroid/content/pm/InstantAppRequest;
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mInstantAppResolverConnection:Lcom/android/server/pm/InstantAppResolverConnection;

    invoke-static {v3, v2}, Lcom/android/server/pm/InstantAppResolver;->doInstantAppResolutionPhaseOne(Lcom/android/server/pm/InstantAppResolverConnection;Landroid/content/pm/InstantAppRequest;)Landroid/content/pm/AuxiliaryResolveInfo;

    move-result-object v16

    .line 7745
    invoke-static/range {v19 .. v20}, Landroid/os/Trace;->traceEnd(J)V

    .line 7746
    .end local v2  # "requestObject":Landroid/content/pm/InstantAppRequest;
    move-object/from16 v2, v16

    goto :goto_eb

    .line 7752
    :cond_d4
    iget-object v2, v12, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 7753
    .local v2, "ai":Landroid/content/pm/ApplicationInfo;
    new-instance v9, Landroid/content/pm/AuxiliaryResolveInfo;

    const/4 v4, 0x0

    iget-object v5, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-wide v6, v2, Landroid/content/pm/ApplicationInfo;->longVersionCode:J

    const/4 v8, 0x0

    move-object v3, v9

    invoke-direct/range {v3 .. v8}, Landroid/content/pm/AuxiliaryResolveInfo;-><init>(Landroid/content/ComponentName;Ljava/lang/String;JLjava/lang/String;)V

    move-object/from16 v16, v9

    move-object/from16 v2, v16

    goto :goto_eb

    .line 7735
    .end local v2  # "ai":Landroid/content/pm/ApplicationInfo;
    :cond_e9
    move-object/from16 v2, v16

    .line 7757
    .end local v16  # "auxiliaryResponse":Landroid/content/pm/AuxiliaryResolveInfo;
    .local v2, "auxiliaryResponse":Landroid/content/pm/AuxiliaryResolveInfo;
    :goto_eb
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->isWebIntent()Z

    move-result v3

    if-eqz v3, :cond_f4

    if-nez v2, :cond_f4

    .line 7758
    return-object v1

    .line 7760
    :cond_f4
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v4, v0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 7761
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_173

    .line 7762
    invoke-virtual {v3, v10}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v4

    iget-object v5, v0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    const/4 v6, 0x0

    invoke-virtual {v4, v5, v6}, Landroid/content/pm/PackageUserState;->isEnabled(Landroid/content/pm/ComponentInfo;I)Z

    move-result v4

    if-nez v4, :cond_112

    goto :goto_173

    .line 7765
    :cond_112
    new-instance v4, Landroid/content/pm/ResolveInfo;

    iget-object v5, v0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerInfo:Landroid/content/pm/ResolveInfo;

    invoke-direct {v4, v5}, Landroid/content/pm/ResolveInfo;-><init>(Landroid/content/pm/ResolveInfo;)V

    .line 7766
    .local v4, "ephemeralInstaller":Landroid/content/pm/ResolveInfo;
    iget-object v5, v0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    .line 7767
    invoke-virtual {v3, v10}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v6

    .line 7766
    const/4 v7, 0x0

    invoke-static {v5, v7, v6, v10}, Landroid/content/pm/PackageParser;->generateActivityInfo(Landroid/content/pm/ActivityInfo;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ActivityInfo;

    move-result-object v5

    iput-object v5, v4, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 7768
    const v5, 0x588000

    iput v5, v4, Landroid/content/pm/ResolveInfo;->match:I

    .line 7771
    new-instance v5, Landroid/content/IntentFilter;

    invoke-direct {v5}, Landroid/content/IntentFilter;-><init>()V

    iput-object v5, v4, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    .line 7772
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    if-eqz v5, :cond_141

    .line 7773
    iget-object v5, v4, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V

    .line 7775
    :cond_141
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v5

    if-eqz v5, :cond_15f

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v5

    invoke-virtual {v5}, Landroid/net/Uri;->getPath()Ljava/lang/String;

    move-result-object v5

    if-eqz v5, :cond_15f

    .line 7776
    iget-object v5, v4, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    .line 7777
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v6

    invoke-virtual {v6}, Landroid/net/Uri;->getPath()Ljava/lang/String;

    move-result-object v6

    .line 7776
    const/4 v7, 0x0

    invoke-virtual {v5, v6, v7}, Landroid/content/IntentFilter;->addDataPath(Ljava/lang/String;I)V

    .line 7779
    :cond_15f
    const/4 v5, 0x1

    iput-boolean v5, v4, Landroid/content/pm/ResolveInfo;->isInstantAppAvailable:Z

    .line 7781
    iput-boolean v5, v4, Landroid/content/pm/ResolveInfo;->isDefault:Z

    .line 7782
    iput-object v2, v4, Landroid/content/pm/ResolveInfo;->auxiliaryInfo:Landroid/content/pm/AuxiliaryResolveInfo;

    .line 7783
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v5, :cond_16f

    .line 7784
    const-string v5, "Adding ephemeral installer to the ResolveInfo list"

    invoke-static {v14, v5}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7787
    :cond_16f
    invoke-interface {v1, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 7788
    return-object v1

    .line 7763
    .end local v4  # "ephemeralInstaller":Landroid/content/pm/ResolveInfo;
    :cond_173
    :goto_173
    return-object v1
.end method

.method private maybeClearProfilesForUpgradesLI(Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$Package;)V
    .registers 7
    .param p1, "originalPkgSetting"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "currentPkg"  # Landroid/content/pm/PackageParser$Package;

    .line 9602
    if-eqz p1, :cond_43

    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->isDeviceUpgrading()Z

    move-result v0

    if-nez v0, :cond_9

    goto :goto_43

    .line 9605
    :cond_9
    iget-wide v0, p1, Lcom/android/server/pm/PackageSetting;->versionCode:J

    iget v2, p2, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    int-to-long v2, v2

    cmp-long v0, v0, v2

    if-nez v0, :cond_13

    .line 9606
    return-void

    .line 9609
    :cond_13
    const/4 v0, -0x1

    invoke-direct {p0, p2, v0}, Lcom/android/server/pm/PackageManagerService;->clearAppProfilesLIF(Landroid/content/pm/PackageParser$Package;I)V

    .line 9610
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_42

    .line 9611
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    iget-object v1, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " clear profile due to version change "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v1, p1, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-virtual {v0, v1, v2}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v1, " != "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v1, p2, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 9616
    :cond_42
    return-void

    .line 9603
    :cond_43
    :goto_43
    return-void
.end method

.method private maybeMigrateAppDataLIF(Landroid/content/pm/PackageParser$Package;I)Z
    .registers 9
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I

    .line 24139
    invoke-virtual {p1}, Landroid/content/pm/PackageParser$Package;->isSystem()Z

    move-result v0

    if-eqz v0, :cond_47

    invoke-static {}, Landroid/os/storage/StorageManager;->isFileEncryptedNativeOrEmulated()Z

    move-result v0

    if-nez v0, :cond_47

    .line 24141
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v0}, Landroid/content/pm/ApplicationInfo;->isDefaultToDeviceProtectedStorage()Z

    move-result v0

    const/4 v1, 0x1

    if-eqz v0, :cond_17

    .line 24142
    move v0, v1

    goto :goto_18

    :cond_17
    const/4 v0, 0x2

    .line 24144
    .local v0, "storageTarget":I
    :goto_18
    :try_start_18
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->volumeUuid:Ljava/lang/String;

    iget-object v4, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v3, v4, p2, v0}, Lcom/android/server/pm/Installer;->migrateAppData(Ljava/lang/String;Ljava/lang/String;II)V
    :try_end_21
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_18 .. :try_end_21} :catch_22

    .line 24149
    goto :goto_46

    .line 24146
    :catch_22
    move-exception v2

    .line 24147
    .local v2, "e":Lcom/android/server/pm/Installer$InstallerException;
    const/4 v3, 0x5

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failed to migrate "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, ": "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 24148
    invoke-virtual {v2}, Lcom/android/server/pm/Installer$InstallerException;->getMessage()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    .line 24147
    invoke-static {v3, v4}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 24150
    .end local v2  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :goto_46
    return v1

    .line 24152
    .end local v0  # "storageTarget":I
    :cond_47
    const/4 v0, 0x0

    return v0
.end method

.method private static maybeThrowExceptionForMultiArchCopy(Ljava/lang/String;I)V
    .registers 3
    .param p0, "message"  # Ljava/lang/String;
    .param p1, "copyRet"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 16579
    if-gez p1, :cond_11

    .line 16580
    const/16 v0, -0x72

    if-eq p1, v0, :cond_11

    const/16 v0, -0x71

    if-ne p1, v0, :cond_b

    goto :goto_11

    .line 16582
    :cond_b
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    invoke-direct {v0, p1, p0}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v0

    .line 16585
    :cond_11
    :goto_11
    return-void
.end method

.method private movePackageInternal(Ljava/lang/String;Ljava/lang/String;IILandroid/os/UserHandle;)V
    .registers 62
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "volumeUuid"  # Ljava/lang/String;
    .param p3, "moveId"  # I
    .param p4, "callingUid"  # I
    .param p5, "user"  # Landroid/os/UserHandle;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 24305
    move-object/from16 v14, p0

    move-object/from16 v15, p1

    move-object/from16 v13, p2

    move/from16 v11, p3

    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v1, Landroid/os/storage/StorageManager;

    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    move-object v12, v0

    check-cast v12, Landroid/os/storage/StorageManager;

    .line 24306
    .local v12, "storage":Landroid/os/storage/StorageManager;
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v10

    .line 24321
    .local v10, "pm":Landroid/content/pm/PackageManager;
    iget-object v1, v14, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 24322
    :try_start_1c
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v15}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/PackageParser$Package;

    .line 24323
    .local v0, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v2, v14, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, v15}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 24324
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_3d8

    if-eqz v2, :cond_3d8

    .line 24326
    invoke-virtual/range {p5 .. p5}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v3

    move/from16 v9, p4

    invoke-direct {v14, v2, v9, v3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-nez v3, :cond_3d0

    .line 24329
    iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v3}, Landroid/content/pm/ApplicationInfo;->isSystemApp()Z

    move-result v3

    if-nez v3, :cond_3c0

    .line 24334
    const-string/jumbo v3, "private"

    invoke-virtual {v3, v13}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    .line 24335
    .local v3, "isInternalStorage":Z
    iget-object v4, v14, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v4}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v4

    const v5, 0x111000b

    invoke-virtual {v4, v5}, Landroid/content/res/Resources;->getBoolean(I)Z

    move-result v4
    :try_end_5a
    .catchall {:try_start_1c .. :try_end_5a} :catchall_3e8

    move v5, v4

    .line 24337
    .local v5, "allow3rdPartyOnInternal":Z
    if-eqz v3, :cond_72

    if-eqz v5, :cond_60

    goto :goto_72

    .line 24338
    :cond_60
    :try_start_60
    new-instance v4, Lcom/android/server/pm/PackageManagerException;

    const/16 v6, -0x9

    const-string v7, "3rd party apps are not allowed on internal storage"

    invoke-direct {v4, v6, v7}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "volumeUuid":Ljava/lang/String;
    .end local p3  # "moveId":I
    .end local p4  # "callingUid":I
    .end local p5  # "user":Landroid/os/UserHandle;
    throw v4
    :try_end_6a
    .catchall {:try_start_60 .. :try_end_6a} :catchall_6a

    .line 24375
    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "isInternalStorage":Z
    .end local v5  # "allow3rdPartyOnInternal":Z
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "volumeUuid":Ljava/lang/String;
    .restart local p3  # "moveId":I
    .restart local p4  # "callingUid":I
    .restart local p5  # "user":Landroid/os/UserHandle;
    :catchall_6a
    move-exception v0

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v3, v13

    goto/16 :goto_3ee

    .line 24342
    .restart local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "isInternalStorage":Z
    .restart local v5  # "allow3rdPartyOnInternal":Z
    :cond_72
    :goto_72
    :try_start_72
    iget-object v4, v2, Lcom/android/server/pm/PackageSetting;->volumeUuid:Ljava/lang/String;

    move-object v8, v4

    .line 24344
    .local v8, "currentVolumeUuid":Ljava/lang/String;
    new-instance v4, Ljava/io/File;

    iget-object v6, v0, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-direct {v4, v6}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    move-object v6, v4

    .line 24345
    .local v6, "probe":Ljava/io/File;
    new-instance v4, Ljava/io/File;

    const-string/jumbo v7, "oat"

    invoke-direct {v4, v6, v7}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    move-object/from16 v16, v4

    .line 24346
    .local v16, "probeOat":Ljava/io/File;
    invoke-virtual {v6}, Ljava/io/File;->isDirectory()Z

    move-result v4

    const/4 v7, -0x6

    if-eqz v4, :cond_3ab

    invoke-virtual/range {v16 .. v16}, Ljava/io/File;->isDirectory()Z

    move-result v4

    if-eqz v4, :cond_3ab

    .line 24351
    invoke-static {v8, v13}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_387

    .line 24355
    iget-object v4, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v4}, Landroid/content/pm/ApplicationInfo;->isInternal()Z

    move-result v4
    :try_end_a0
    .catchall {:try_start_72 .. :try_end_a0} :catchall_3e8

    if-eqz v4, :cond_b6

    :try_start_a2
    invoke-virtual/range {p0 .. p1}, Lcom/android/server/pm/PackageManagerService;->isPackageDeviceAdminOnAnyUser(Ljava/lang/String;)Z

    move-result v4

    if-nez v4, :cond_ab

    move/from16 v18, v3

    goto :goto_b8

    .line 24356
    :cond_ab
    new-instance v4, Lcom/android/server/pm/PackageManagerException;

    const-string v7, "Device admin cannot be moved"

    move/from16 v18, v3

    const/4 v3, -0x8

    .end local v3  # "isInternalStorage":Z
    .local v18, "isInternalStorage":Z
    invoke-direct {v4, v3, v7}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "volumeUuid":Ljava/lang/String;
    .end local p3  # "moveId":I
    .end local p4  # "callingUid":I
    .end local p5  # "user":Landroid/os/UserHandle;
    throw v4
    :try_end_b6
    .catchall {:try_start_a2 .. :try_end_b6} :catchall_6a

    .line 24355
    .end local v18  # "isInternalStorage":Z
    .restart local v3  # "isInternalStorage":Z
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "volumeUuid":Ljava/lang/String;
    .restart local p3  # "moveId":I
    .restart local p4  # "callingUid":I
    .restart local p5  # "user":Landroid/os/UserHandle;
    :cond_b6
    move/from16 v18, v3

    .line 24360
    .end local v3  # "isInternalStorage":Z
    .restart local v18  # "isInternalStorage":Z
    :goto_b8
    :try_start_b8
    iget-object v3, v14, Lcom/android/server/pm/PackageManagerService;->mFrozenPackages:Landroid/util/ArraySet;

    invoke-virtual {v3, v15}, Landroid/util/ArraySet;->contains(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_374

    .line 24365
    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z

    move-result v3

    move v4, v7

    move v7, v3

    .line 24366
    .local v7, "isCurrentLocationExternal":Z
    new-instance v3, Ljava/io/File;

    iget-object v4, v0, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-direct {v3, v4}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    move-object/from16 v43, v3

    .line 24367
    .local v43, "codeFile":Ljava/io/File;
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    move-object/from16 v23, v3

    .line 24368
    .local v23, "installerPackageName":Ljava/lang/String;
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->cpuAbiOverrideString:Ljava/lang/String;

    move-object/from16 v27, v3

    .line 24369
    .local v27, "packageAbiOverride":Ljava/lang/String;
    iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v3}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v40

    .line 24370
    .local v40, "appId":I
    iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->seInfo:Ljava/lang/String;

    move-object/from16 v41, v3

    .line 24371
    .local v41, "seinfo":Ljava/lang/String;
    iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v10, v3}, Landroid/content/pm/PackageManager;->getApplicationLabel(Landroid/content/pm/ApplicationInfo;)Ljava/lang/CharSequence;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/String;->valueOf(Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 24372
    .local v3, "label":Ljava/lang/String;
    iget-object v4, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    move/from16 v42, v4

    .line 24373
    .local v42, "targetSdkVersion":I
    const-string/jumbo v4, "movePackageInternal"

    invoke-virtual {v14, v15, v4}, Lcom/android/server/pm/PackageManagerService;->freezePackage(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v4

    move-object/from16 v19, v0

    const/4 v0, -0x6

    .line 24374
    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v4, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .local v19, "pkg":Landroid/content/pm/PackageParser$Package;
    sget-object v17, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual/range {v17 .. v17}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0

    move/from16 v17, v5

    .end local v5  # "allow3rdPartyOnInternal":Z
    .local v17, "allow3rdPartyOnInternal":Z
    const/4 v5, 0x1

    invoke-virtual {v2, v0, v5}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v0

    move-object v6, v0

    .line 24375
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v16  # "probeOat":Ljava/io/File;
    .end local v17  # "allow3rdPartyOnInternal":Z
    .end local v18  # "isInternalStorage":Z
    .end local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v6, "installedUserIds":[I
    monitor-exit v1
    :try_end_10e
    .catchall {:try_start_b8 .. :try_end_10e} :catchall_3e8

    .line 24377
    new-instance v0, Landroid/os/Bundle;

    invoke-direct {v0}, Landroid/os/Bundle;-><init>()V

    move-object v2, v0

    .line 24378
    .local v2, "extras":Landroid/os/Bundle;
    const-string v0, "android.intent.extra.PACKAGE_NAME"

    invoke-virtual {v2, v0, v15}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 24379
    const-string v0, "android.intent.extra.TITLE"

    invoke-virtual {v2, v0, v3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 24380
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    invoke-static {v0, v11, v2}, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;->access$5400(Lcom/android/server/pm/PackageManagerService$MoveCallbacks;ILandroid/os/Bundle;)V

    .line 24386
    const/16 v17, 0x10

    .line 24387
    .local v17, "installFlags":I
    sget-object v0, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    invoke-static {v0, v13}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_135

    .line 24388
    const/4 v0, 0x1

    .line 24389
    .local v0, "moveCompleteApp":Z
    invoke-static/range {p2 .. p2}, Landroid/os/Environment;->getDataAppDirectory(Ljava/lang/String;)Ljava/io/File;

    move-result-object v1

    move/from16 v44, v0

    .local v1, "measurePath":Ljava/io/File;
    goto :goto_164

    .line 24390
    .end local v0  # "moveCompleteApp":Z
    .end local v1  # "measurePath":Ljava/io/File;
    :cond_135
    const-string/jumbo v0, "primary_physical"

    invoke-static {v0, v13}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_14a

    .line 24391
    const/4 v0, 0x0

    .line 24392
    .restart local v0  # "moveCompleteApp":Z
    invoke-virtual {v12}, Landroid/os/storage/StorageManager;->getPrimaryPhysicalVolume()Landroid/os/storage/VolumeInfo;

    move-result-object v1

    invoke-virtual {v1}, Landroid/os/storage/VolumeInfo;->getPath()Ljava/io/File;

    move-result-object v1

    move/from16 v44, v0

    .restart local v1  # "measurePath":Ljava/io/File;
    goto :goto_164

    .line 24394
    .end local v0  # "moveCompleteApp":Z
    .end local v1  # "measurePath":Ljava/io/File;
    :cond_14a
    invoke-virtual {v12, v13}, Landroid/os/storage/StorageManager;->findVolumeByUuid(Ljava/lang/String;)Landroid/os/storage/VolumeInfo;

    move-result-object v0

    .line 24395
    .local v0, "volume":Landroid/os/storage/VolumeInfo;
    if-eqz v0, :cond_35c

    invoke-virtual {v0}, Landroid/os/storage/VolumeInfo;->getType()I

    move-result v1

    if-ne v1, v5, :cond_35c

    .line 24396
    invoke-virtual {v0}, Landroid/os/storage/VolumeInfo;->isMountedWritable()Z

    move-result v1

    if-eqz v1, :cond_34f

    .line 24402
    const/4 v1, 0x1

    .line 24403
    .local v1, "moveCompleteApp":Z
    invoke-static/range {p2 .. p2}, Landroid/os/Environment;->getDataAppDirectory(Ljava/lang/String;)Ljava/io/File;

    move-result-object v0

    move/from16 v44, v1

    move-object v1, v0

    .line 24407
    .end local v0  # "volume":Landroid/os/storage/VolumeInfo;
    .local v1, "measurePath":Ljava/io/File;
    .local v44, "moveCompleteApp":Z
    :goto_164
    if-eqz v44, :cond_1b3

    .line 24408
    array-length v0, v6

    const/4 v5, 0x0

    :goto_168
    if-ge v5, v0, :cond_1ae

    move/from16 v18, v0

    aget v0, v6, v5

    .line 24409
    .local v0, "userId":I
    invoke-static {}, Landroid/os/storage/StorageManager;->isFileEncryptedNativeOrEmulated()Z

    move-result v19

    if-eqz v19, :cond_1a1

    .line 24410
    invoke-static {v0}, Landroid/os/storage/StorageManager;->isUserKeyUnlocked(I)Z

    move-result v19

    if-eqz v19, :cond_17f

    move-object/from16 v19, v2

    move-object/from16 v22, v3

    goto :goto_1a5

    .line 24411
    :cond_17f
    new-instance v5, Lcom/android/server/pm/PackageManagerException;

    move-object/from16 v19, v2

    .end local v2  # "extras":Landroid/os/Bundle;
    .local v19, "extras":Landroid/os/Bundle;
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v22, v3

    .end local v3  # "label":Ljava/lang/String;
    .local v22, "label":Ljava/lang/String;
    const-string v3, "User "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, " must be unlocked"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const/16 v3, -0xa

    invoke-direct {v5, v3, v2}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v5

    .line 24409
    .end local v19  # "extras":Landroid/os/Bundle;
    .end local v22  # "label":Ljava/lang/String;
    .restart local v2  # "extras":Landroid/os/Bundle;
    .restart local v3  # "label":Ljava/lang/String;
    :cond_1a1
    move-object/from16 v19, v2

    move-object/from16 v22, v3

    .line 24408
    .end local v0  # "userId":I
    .end local v2  # "extras":Landroid/os/Bundle;
    .end local v3  # "label":Ljava/lang/String;
    .restart local v19  # "extras":Landroid/os/Bundle;
    .restart local v22  # "label":Ljava/lang/String;
    :goto_1a5
    add-int/lit8 v5, v5, 0x1

    move/from16 v0, v18

    move-object/from16 v2, v19

    move-object/from16 v3, v22

    goto :goto_168

    .end local v19  # "extras":Landroid/os/Bundle;
    .end local v22  # "label":Ljava/lang/String;
    .restart local v2  # "extras":Landroid/os/Bundle;
    .restart local v3  # "label":Ljava/lang/String;
    :cond_1ae
    move-object/from16 v19, v2

    move-object/from16 v22, v3

    .end local v2  # "extras":Landroid/os/Bundle;
    .end local v3  # "label":Ljava/lang/String;
    .restart local v19  # "extras":Landroid/os/Bundle;
    .restart local v22  # "label":Ljava/lang/String;
    goto :goto_1b7

    .line 24407
    .end local v19  # "extras":Landroid/os/Bundle;
    .end local v22  # "label":Ljava/lang/String;
    .restart local v2  # "extras":Landroid/os/Bundle;
    .restart local v3  # "label":Ljava/lang/String;
    :cond_1b3
    move-object/from16 v19, v2

    move-object/from16 v22, v3

    .line 24417
    .end local v2  # "extras":Landroid/os/Bundle;
    .end local v3  # "label":Ljava/lang/String;
    .restart local v19  # "extras":Landroid/os/Bundle;
    .restart local v22  # "label":Ljava/lang/String;
    :goto_1b7
    new-instance v0, Landroid/content/pm/PackageStats;

    const/4 v2, 0x0

    const/4 v3, -0x1

    invoke-direct {v0, v2, v3}, Landroid/content/pm/PackageStats;-><init>(Ljava/lang/String;I)V

    move-object v5, v0

    .line 24418
    .local v5, "stats":Landroid/content/pm/PackageStats;
    iget-object v2, v14, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    monitor-enter v2

    .line 24419
    :try_start_1c2
    array-length v0, v6
    :try_end_1c3
    .catchall {:try_start_1c2 .. :try_end_1c3} :catchall_33a

    const/4 v3, 0x0

    :goto_1c4
    if-ge v3, v0, :cond_20f

    :try_start_1c6
    aget v16, v6, v3

    move/from16 v18, v16

    .line 24420
    .local v18, "userId":I
    move/from16 v16, v0

    move/from16 v0, v18

    .end local v18  # "userId":I
    .restart local v0  # "userId":I
    invoke-direct {v14, v15, v0, v5}, Lcom/android/server/pm/PackageManagerService;->getPackageSizeInfoLI(Ljava/lang/String;ILandroid/content/pm/PackageStats;)Z

    move-result v18

    if-eqz v18, :cond_1d9

    .line 24419
    .end local v0  # "userId":I
    add-int/lit8 v3, v3, 0x1

    move/from16 v0, v16

    goto :goto_1c4

    .line 24421
    .restart local v0  # "userId":I
    :cond_1d9
    invoke-virtual {v4}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 24422
    new-instance v3, Lcom/android/server/pm/PackageManagerException;

    move/from16 v16, v0

    .end local v0  # "userId":I
    .local v16, "userId":I
    const-string v0, "Failed to measure package size"
    :try_end_1e2
    .catchall {:try_start_1c6 .. :try_end_1e2} :catchall_1fc

    move-object/from16 v18, v6

    const/4 v6, -0x6

    .end local v6  # "installedUserIds":[I
    .local v18, "installedUserIds":[I
    :try_start_1e5
    invoke-direct {v3, v6, v0}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v1  # "measurePath":Ljava/io/File;
    .end local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v5  # "stats":Landroid/content/pm/PackageStats;
    .end local v7  # "isCurrentLocationExternal":Z
    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .end local v17  # "installFlags":I
    .end local v18  # "installedUserIds":[I
    .end local v19  # "extras":Landroid/os/Bundle;
    .end local v22  # "label":Ljava/lang/String;
    .end local v23  # "installerPackageName":Ljava/lang/String;
    .end local v27  # "packageAbiOverride":Ljava/lang/String;
    .end local v40  # "appId":I
    .end local v41  # "seinfo":Ljava/lang/String;
    .end local v42  # "targetSdkVersion":I
    .end local v43  # "codeFile":Ljava/io/File;
    .end local v44  # "moveCompleteApp":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "volumeUuid":Ljava/lang/String;
    .end local p3  # "moveId":I
    .end local p4  # "callingUid":I
    .end local p5  # "user":Landroid/os/UserHandle;
    throw v3
    :try_end_1e9
    .catchall {:try_start_1e5 .. :try_end_1e9} :catchall_1e9

    .line 24426
    .end local v16  # "userId":I
    .restart local v1  # "measurePath":Ljava/io/File;
    .restart local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v5  # "stats":Landroid/content/pm/PackageStats;
    .restart local v7  # "isCurrentLocationExternal":Z
    .restart local v8  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v17  # "installFlags":I
    .restart local v18  # "installedUserIds":[I
    .restart local v19  # "extras":Landroid/os/Bundle;
    .restart local v22  # "label":Ljava/lang/String;
    .restart local v23  # "installerPackageName":Ljava/lang/String;
    .restart local v27  # "packageAbiOverride":Ljava/lang/String;
    .restart local v40  # "appId":I
    .restart local v41  # "seinfo":Ljava/lang/String;
    .restart local v42  # "targetSdkVersion":I
    .restart local v43  # "codeFile":Ljava/io/File;
    .restart local v44  # "moveCompleteApp":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "volumeUuid":Ljava/lang/String;
    .restart local p3  # "moveId":I
    .restart local p4  # "callingUid":I
    .restart local p5  # "user":Landroid/os/UserHandle;
    :catchall_1e9
    move-exception v0

    move-object/from16 v50, v1

    move-object/from16 v52, v5

    move-object v5, v8

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v6, v13

    move-object/from16 v53, v18

    move-object/from16 v51, v19

    move-object/from16 v49, v22

    goto/16 :goto_34b

    .end local v18  # "installedUserIds":[I
    .restart local v6  # "installedUserIds":[I
    :catchall_1fc
    move-exception v0

    move-object/from16 v50, v1

    move-object/from16 v52, v5

    move-object/from16 v53, v6

    move-object v5, v8

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v6, v13

    move-object/from16 v51, v19

    move-object/from16 v49, v22

    .end local v6  # "installedUserIds":[I
    .restart local v18  # "installedUserIds":[I
    goto/16 :goto_34b

    .end local v18  # "installedUserIds":[I
    .restart local v6  # "installedUserIds":[I
    :cond_20f
    move-object/from16 v18, v6

    .end local v6  # "installedUserIds":[I
    .restart local v18  # "installedUserIds":[I
    :try_start_211
    monitor-exit v2
    :try_end_212
    .catchall {:try_start_211 .. :try_end_212} :catchall_328

    .line 24428
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_238

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Measured code size "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v2, v5, Landroid/content/pm/PackageStats;->codeSize:J

    invoke-virtual {v0, v2, v3}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v2, ", data size "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v2, v5, Landroid/content/pm/PackageStats;->dataSize:J

    invoke-virtual {v0, v2, v3}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v2, "PackageManager"

    invoke-static {v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 24431
    :cond_238
    invoke-virtual {v1}, Ljava/io/File;->getUsableSpace()J

    move-result-wide v45

    .line 24433
    .local v45, "startFreeBytes":J
    if-eqz v44, :cond_248

    .line 24434
    iget-wide v2, v5, Landroid/content/pm/PackageStats;->codeSize:J

    move-object/from16 v24, v8

    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .local v24, "currentVolumeUuid":Ljava/lang/String;
    iget-wide v8, v5, Landroid/content/pm/PackageStats;->dataSize:J

    add-long/2addr v2, v8

    move-wide/from16 v47, v2

    .local v2, "sizeBytes":J
    goto :goto_24e

    .line 24436
    .end local v2  # "sizeBytes":J
    .end local v24  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v8  # "currentVolumeUuid":Ljava/lang/String;
    :cond_248
    move-object/from16 v24, v8

    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v24  # "currentVolumeUuid":Ljava/lang/String;
    iget-wide v2, v5, Landroid/content/pm/PackageStats;->codeSize:J

    move-wide/from16 v47, v2

    .line 24439
    .local v47, "sizeBytes":J
    :goto_24e
    invoke-virtual {v12, v1}, Landroid/os/storage/StorageManager;->getStorageBytesUntilLow(Ljava/io/File;)J

    move-result-wide v2

    cmp-long v0, v47, v2

    if-gtz v0, :cond_31a

    .line 24445
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    const/16 v2, 0xa

    invoke-static {v0, v11, v2}, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;->access$5500(Lcom/android/server/pm/PackageManagerService$MoveCallbacks;II)V

    .line 24447
    new-instance v3, Ljava/util/concurrent/CountDownLatch;

    const/4 v0, 0x1

    invoke-direct {v3, v0}, Ljava/util/concurrent/CountDownLatch;-><init>(I)V

    move-object/from16 v49, v22

    .line 24448
    .end local v22  # "label":Ljava/lang/String;
    .local v3, "installedLatch":Ljava/util/concurrent/CountDownLatch;
    .local v49, "label":Ljava/lang/String;
    new-instance v21, Lcom/android/server/pm/PackageManagerService$9;

    move-object/from16 v50, v1

    .end local v1  # "measurePath":Ljava/io/File;
    .local v50, "measurePath":Ljava/io/File;
    move-object/from16 v1, v21

    move-object/from16 v51, v19

    .end local v19  # "extras":Landroid/os/Bundle;
    .local v51, "extras":Landroid/os/Bundle;
    move-object/from16 v2, p0

    move-object/from16 v52, v5

    .end local v5  # "stats":Landroid/content/pm/PackageStats;
    .local v52, "stats":Landroid/content/pm/PackageStats;
    move/from16 v5, p3

    move-object/from16 v53, v18

    .end local v18  # "installedUserIds":[I
    .local v53, "installedUserIds":[I
    move-object/from16 v6, p1

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService$9;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/util/concurrent/CountDownLatch;Lcom/android/server/pm/PackageManagerService$PackageFreezer;ILjava/lang/String;Z)V

    .line 24483
    .local v21, "installObserver":Landroid/content/pm/IPackageInstallObserver2;
    if-eqz v44, :cond_2b4

    .line 24485
    new-instance v0, Ljava/lang/Thread;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$khEgFp5g734PWfRphYmdVxJ78QQ;

    move-object/from16 v5, v24

    .end local v24  # "currentVolumeUuid":Ljava/lang/String;
    .local v5, "currentVolumeUuid":Ljava/lang/String;
    move-object v8, v1

    move-object/from16 v9, p0

    move-object/from16 v54, v10

    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .local v54, "pm":Landroid/content/pm/PackageManager;
    move-object v10, v3

    move-object/from16 v55, v12

    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .local v55, "storage":Landroid/os/storage/StorageManager;
    move-wide/from16 v11, v45

    move-object v6, v13

    move-object/from16 v13, v50

    move-object v2, v14

    move-wide/from16 v14, v47

    move/from16 v16, p3

    invoke-direct/range {v8 .. v16}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$khEgFp5g734PWfRphYmdVxJ78QQ;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/util/concurrent/CountDownLatch;JLjava/io/File;JI)V

    invoke-direct {v0, v1}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V

    .line 24499
    invoke-virtual {v0}, Ljava/lang/Thread;->start()V

    .line 24501
    invoke-virtual/range {v43 .. v43}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v0

    .line 24502
    .local v0, "dataAppName":Ljava/lang/String;
    new-instance v1, Lcom/android/server/pm/PackageManagerService$MoveInfo;

    move-object/from16 v34, v1

    move/from16 v35, p3

    move-object/from16 v36, v5

    move-object/from16 v37, p2

    move-object/from16 v38, p1

    move-object/from16 v39, v0

    invoke-direct/range {v34 .. v42}, Lcom/android/server/pm/PackageManagerService$MoveInfo;-><init>(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ILjava/lang/String;I)V

    move-object v0, v1

    .line 24504
    .local v0, "move":Lcom/android/server/pm/PackageManagerService$MoveInfo;
    goto :goto_2bd

    .line 24505
    .end local v0  # "move":Lcom/android/server/pm/PackageManagerService$MoveInfo;
    .end local v5  # "currentVolumeUuid":Ljava/lang/String;
    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v24  # "currentVolumeUuid":Ljava/lang/String;
    :cond_2b4
    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v6, v13

    move-object v2, v14

    move-object/from16 v5, v24

    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .end local v24  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v5  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    const/4 v0, 0x0

    .line 24508
    .restart local v0  # "move":Lcom/android/server/pm/PackageManagerService$MoveInfo;
    :goto_2bd
    or-int/lit8 v1, v17, 0x2

    .end local v17  # "installFlags":I
    .local v1, "installFlags":I
    move/from16 v22, v1

    .line 24510
    iget-object v8, v2, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/4 v9, 0x5

    invoke-virtual {v8, v9}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v8

    .line 24511
    .local v8, "msg":Landroid/os/Message;
    invoke-static/range {v43 .. v43}, Lcom/android/server/pm/PackageManagerService$OriginInfo;->fromExistingFile(Ljava/io/File;)Lcom/android/server/pm/PackageManagerService$OriginInfo;

    move-result-object v9

    .local v9, "origin":Lcom/android/server/pm/PackageManagerService$OriginInfo;
    move-object/from16 v19, v9

    .line 24512
    new-instance v10, Lcom/android/server/pm/PackageManagerService$InstallParams;

    move-object/from16 v17, v10

    const/16 v25, 0x0

    const/16 v28, 0x0

    const/16 v29, 0x0

    sget-object v30, Landroid/content/pm/PackageParser$SigningDetails;->UNKNOWN:Landroid/content/pm/PackageParser$SigningDetails;

    const/16 v31, 0x0

    const-wide/16 v32, -0x1

    move-object/from16 v18, p0

    move-object/from16 v20, v0

    move-object/from16 v24, p2

    move-object/from16 v26, p5

    invoke-direct/range {v17 .. v33}, Lcom/android/server/pm/PackageManagerService$InstallParams;-><init>(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$OriginInfo;Lcom/android/server/pm/PackageManagerService$MoveInfo;Landroid/content/pm/IPackageInstallObserver2;ILjava/lang/String;Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$VerificationInfo;Landroid/os/UserHandle;Ljava/lang/String;[Ljava/lang/String;Ljava/util/List;Landroid/content/pm/PackageParser$SigningDetails;IJ)V

    .line 24517
    .local v10, "params":Lcom/android/server/pm/PackageManagerService$InstallParams;
    const-string/jumbo v11, "movePackage"

    invoke-virtual {v10, v11}, Lcom/android/server/pm/PackageManagerService$InstallParams;->setTraceMethod(Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$HandlerParams;

    move-result-object v11

    invoke-static {v10}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v12

    invoke-virtual {v11, v12}, Lcom/android/server/pm/PackageManagerService$HandlerParams;->setTraceCookie(I)Lcom/android/server/pm/PackageManagerService$HandlerParams;

    .line 24518
    iput-object v10, v8, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 24520
    iget-object v11, v8, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 24521
    invoke-static {v11}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v11

    .line 24520
    const-wide/32 v12, 0x40000

    const-string/jumbo v14, "movePackage"

    invoke-static {v12, v13, v14, v11}, Landroid/os/Trace;->asyncTraceBegin(JLjava/lang/String;I)V

    .line 24522
    iget-object v11, v8, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 24523
    invoke-static {v11}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v11

    .line 24522
    const-string/jumbo v14, "queueInstall"

    invoke-static {v12, v13, v14, v11}, Landroid/os/Trace;->asyncTraceBegin(JLjava/lang/String;I)V

    .line 24525
    iget-object v11, v2, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v11, v8}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 24526
    return-void

    .line 24440
    .end local v0  # "move":Lcom/android/server/pm/PackageManagerService$MoveInfo;
    .end local v3  # "installedLatch":Ljava/util/concurrent/CountDownLatch;
    .end local v8  # "msg":Landroid/os/Message;
    .end local v9  # "origin":Lcom/android/server/pm/PackageManagerService$OriginInfo;
    .end local v21  # "installObserver":Landroid/content/pm/IPackageInstallObserver2;
    .end local v49  # "label":Ljava/lang/String;
    .end local v50  # "measurePath":Ljava/io/File;
    .end local v51  # "extras":Landroid/os/Bundle;
    .end local v52  # "stats":Landroid/content/pm/PackageStats;
    .end local v53  # "installedUserIds":[I
    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .local v1, "measurePath":Ljava/io/File;
    .local v5, "stats":Landroid/content/pm/PackageStats;
    .local v10, "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v17  # "installFlags":I
    .restart local v18  # "installedUserIds":[I
    .restart local v19  # "extras":Landroid/os/Bundle;
    .restart local v22  # "label":Ljava/lang/String;
    .restart local v24  # "currentVolumeUuid":Ljava/lang/String;
    :cond_31a
    move-object/from16 v50, v1

    .end local v1  # "measurePath":Ljava/io/File;
    .restart local v50  # "measurePath":Ljava/io/File;
    invoke-virtual {v4}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 24441
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v1, "Not enough free space to move"

    const/4 v3, -0x6

    invoke-direct {v0, v3, v1}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v0

    .line 24426
    .end local v24  # "currentVolumeUuid":Ljava/lang/String;
    .end local v45  # "startFreeBytes":J
    .end local v47  # "sizeBytes":J
    .end local v50  # "measurePath":Ljava/io/File;
    .restart local v1  # "measurePath":Ljava/io/File;
    .local v8, "currentVolumeUuid":Ljava/lang/String;
    :catchall_328
    move-exception v0

    move-object/from16 v50, v1

    move-object/from16 v52, v5

    move-object v5, v8

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v6, v13

    move-object/from16 v53, v18

    move-object/from16 v51, v19

    move-object/from16 v49, v22

    .end local v1  # "measurePath":Ljava/io/File;
    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .end local v18  # "installedUserIds":[I
    .end local v19  # "extras":Landroid/os/Bundle;
    .end local v22  # "label":Ljava/lang/String;
    .local v5, "currentVolumeUuid":Ljava/lang/String;
    .restart local v49  # "label":Ljava/lang/String;
    .restart local v50  # "measurePath":Ljava/io/File;
    .restart local v51  # "extras":Landroid/os/Bundle;
    .restart local v52  # "stats":Landroid/content/pm/PackageStats;
    .restart local v53  # "installedUserIds":[I
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    goto :goto_34b

    .end local v49  # "label":Ljava/lang/String;
    .end local v50  # "measurePath":Ljava/io/File;
    .end local v51  # "extras":Landroid/os/Bundle;
    .end local v52  # "stats":Landroid/content/pm/PackageStats;
    .end local v53  # "installedUserIds":[I
    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .restart local v1  # "measurePath":Ljava/io/File;
    .local v5, "stats":Landroid/content/pm/PackageStats;
    .restart local v6  # "installedUserIds":[I
    .restart local v8  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v19  # "extras":Landroid/os/Bundle;
    .restart local v22  # "label":Ljava/lang/String;
    :catchall_33a
    move-exception v0

    move-object/from16 v50, v1

    move-object/from16 v52, v5

    move-object/from16 v53, v6

    move-object v5, v8

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v6, v13

    move-object/from16 v51, v19

    move-object/from16 v49, v22

    .end local v1  # "measurePath":Ljava/io/File;
    .end local v6  # "installedUserIds":[I
    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .end local v19  # "extras":Landroid/os/Bundle;
    .end local v22  # "label":Ljava/lang/String;
    .local v5, "currentVolumeUuid":Ljava/lang/String;
    .restart local v49  # "label":Ljava/lang/String;
    .restart local v50  # "measurePath":Ljava/io/File;
    .restart local v51  # "extras":Landroid/os/Bundle;
    .restart local v52  # "stats":Landroid/content/pm/PackageStats;
    .restart local v53  # "installedUserIds":[I
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    :goto_34b
    :try_start_34b
    monitor-exit v2
    :try_end_34c
    .catchall {:try_start_34b .. :try_end_34c} :catchall_34d

    throw v0

    :catchall_34d
    move-exception v0

    goto :goto_34b

    .line 24396
    .end local v5  # "currentVolumeUuid":Ljava/lang/String;
    .end local v44  # "moveCompleteApp":Z
    .end local v49  # "label":Ljava/lang/String;
    .end local v50  # "measurePath":Ljava/io/File;
    .end local v51  # "extras":Landroid/os/Bundle;
    .end local v52  # "stats":Landroid/content/pm/PackageStats;
    .end local v53  # "installedUserIds":[I
    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .local v0, "volume":Landroid/os/storage/VolumeInfo;
    .local v2, "extras":Landroid/os/Bundle;
    .local v3, "label":Ljava/lang/String;
    .restart local v6  # "installedUserIds":[I
    .restart local v8  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    :cond_34f
    move-object/from16 v51, v2

    move-object/from16 v49, v3

    move-object/from16 v53, v6

    move-object v5, v8

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v6, v13

    .end local v2  # "extras":Landroid/os/Bundle;
    .end local v3  # "label":Ljava/lang/String;
    .end local v6  # "installedUserIds":[I
    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v5  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v49  # "label":Ljava/lang/String;
    .restart local v51  # "extras":Landroid/os/Bundle;
    .restart local v53  # "installedUserIds":[I
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    goto :goto_368

    .line 24395
    .end local v5  # "currentVolumeUuid":Ljava/lang/String;
    .end local v49  # "label":Ljava/lang/String;
    .end local v51  # "extras":Landroid/os/Bundle;
    .end local v53  # "installedUserIds":[I
    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .restart local v2  # "extras":Landroid/os/Bundle;
    .restart local v3  # "label":Ljava/lang/String;
    .restart local v6  # "installedUserIds":[I
    .restart local v8  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    :cond_35c
    move-object/from16 v51, v2

    move-object/from16 v49, v3

    move-object/from16 v53, v6

    move-object v5, v8

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v6, v13

    .line 24397
    .end local v2  # "extras":Landroid/os/Bundle;
    .end local v3  # "label":Ljava/lang/String;
    .end local v6  # "installedUserIds":[I
    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v5  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v49  # "label":Ljava/lang/String;
    .restart local v51  # "extras":Landroid/os/Bundle;
    .restart local v53  # "installedUserIds":[I
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    :goto_368
    invoke-virtual {v4}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 24398
    new-instance v1, Lcom/android/server/pm/PackageManagerException;

    const-string v2, "Move location not mounted private volume"

    const/4 v3, -0x6

    invoke-direct {v1, v3, v2}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    throw v1

    .line 24361
    .end local v4  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v7  # "isCurrentLocationExternal":Z
    .end local v17  # "installFlags":I
    .end local v23  # "installerPackageName":Ljava/lang/String;
    .end local v27  # "packageAbiOverride":Ljava/lang/String;
    .end local v40  # "appId":I
    .end local v41  # "seinfo":Ljava/lang/String;
    .end local v42  # "targetSdkVersion":I
    .end local v43  # "codeFile":Ljava/io/File;
    .end local v49  # "label":Ljava/lang/String;
    .end local v51  # "extras":Landroid/os/Bundle;
    .end local v53  # "installedUserIds":[I
    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .local v0, "pkg":Landroid/content/pm/PackageParser$Package;
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    .local v5, "allow3rdPartyOnInternal":Z
    .local v6, "probe":Ljava/io/File;
    .restart local v8  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .local v16, "probeOat":Ljava/io/File;
    .local v18, "isInternalStorage":Z
    :cond_374
    move-object/from16 v19, v0

    move/from16 v17, v5

    move-object v5, v8

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v3, v13

    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .local v5, "currentVolumeUuid":Ljava/lang/String;
    .local v17, "allow3rdPartyOnInternal":Z
    .local v19, "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    :try_start_37e
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const/4 v4, -0x7

    const-string v7, "Failed to move already frozen package"

    invoke-direct {v0, v4, v7}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "volumeUuid":Ljava/lang/String;
    .end local p3  # "moveId":I
    .end local p4  # "callingUid":I
    .end local p5  # "user":Landroid/os/UserHandle;
    throw v0

    .line 24352
    .end local v17  # "allow3rdPartyOnInternal":Z
    .end local v18  # "isInternalStorage":Z
    .end local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v3, "isInternalStorage":Z
    .local v5, "allow3rdPartyOnInternal":Z
    .restart local v8  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "volumeUuid":Ljava/lang/String;
    .restart local p3  # "moveId":I
    .restart local p4  # "callingUid":I
    .restart local p5  # "user":Landroid/os/UserHandle;
    :cond_387
    move-object/from16 v19, v0

    move/from16 v18, v3

    move/from16 v17, v5

    move-object v5, v8

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v3, v13

    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "isInternalStorage":Z
    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .local v5, "currentVolumeUuid":Ljava/lang/String;
    .restart local v17  # "allow3rdPartyOnInternal":Z
    .restart local v18  # "isInternalStorage":Z
    .restart local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Package already moved to "

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    const/4 v7, -0x6

    invoke-direct {v0, v7, v4}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "volumeUuid":Ljava/lang/String;
    .end local p3  # "moveId":I
    .end local p4  # "callingUid":I
    .end local p5  # "user":Landroid/os/UserHandle;
    throw v0

    .line 24346
    .end local v17  # "allow3rdPartyOnInternal":Z
    .end local v18  # "isInternalStorage":Z
    .end local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v3  # "isInternalStorage":Z
    .local v5, "allow3rdPartyOnInternal":Z
    .restart local v8  # "currentVolumeUuid":Ljava/lang/String;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "volumeUuid":Ljava/lang/String;
    .restart local p3  # "moveId":I
    .restart local p4  # "callingUid":I
    .restart local p5  # "user":Landroid/os/UserHandle;
    :cond_3ab
    move-object/from16 v19, v0

    move/from16 v18, v3

    move/from16 v17, v5

    move-object v5, v8

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v3, v13

    .line 24347
    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "isInternalStorage":Z
    .end local v8  # "currentVolumeUuid":Ljava/lang/String;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .local v5, "currentVolumeUuid":Ljava/lang/String;
    .restart local v17  # "allow3rdPartyOnInternal":Z
    .restart local v18  # "isInternalStorage":Z
    .restart local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const-string v4, "Move only supported for modern cluster style installs"

    const/4 v7, -0x6

    invoke-direct {v0, v7, v4}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "volumeUuid":Ljava/lang/String;
    .end local p3  # "moveId":I
    .end local p4  # "callingUid":I
    .end local p5  # "user":Landroid/os/UserHandle;
    throw v0

    .line 24330
    .end local v5  # "currentVolumeUuid":Ljava/lang/String;
    .end local v6  # "probe":Ljava/io/File;
    .end local v16  # "probeOat":Ljava/io/File;
    .end local v17  # "allow3rdPartyOnInternal":Z
    .end local v18  # "isInternalStorage":Z
    .end local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "volumeUuid":Ljava/lang/String;
    .restart local p3  # "moveId":I
    .restart local p4  # "callingUid":I
    .restart local p5  # "user":Landroid/os/UserHandle;
    :cond_3c0
    move-object/from16 v19, v0

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v3, v13

    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const/4 v4, -0x3

    const-string v5, "Cannot move system application"

    invoke-direct {v0, v4, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "volumeUuid":Ljava/lang/String;
    .end local p3  # "moveId":I
    .end local p4  # "callingUid":I
    .end local p5  # "user":Landroid/os/UserHandle;
    throw v0

    .line 24326
    .end local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "volumeUuid":Ljava/lang/String;
    .restart local p3  # "moveId":I
    .restart local p4  # "callingUid":I
    .restart local p5  # "user":Landroid/os/UserHandle;
    :cond_3d0
    move-object/from16 v19, v0

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v3, v13

    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    goto :goto_3df

    .line 24324
    .end local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .restart local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    :cond_3d8
    move-object/from16 v19, v0

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v3, v13

    .line 24327
    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    :goto_3df
    new-instance v0, Lcom/android/server/pm/PackageManagerException;

    const/4 v4, -0x2

    const-string v5, "Missing package"

    invoke-direct {v0, v4, v5}, Lcom/android/server/pm/PackageManagerException;-><init>(ILjava/lang/String;)V

    .end local v54  # "pm":Landroid/content/pm/PackageManager;
    .end local v55  # "storage":Landroid/os/storage/StorageManager;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "volumeUuid":Ljava/lang/String;
    .end local p3  # "moveId":I
    .end local p4  # "callingUid":I
    .end local p5  # "user":Landroid/os/UserHandle;
    throw v0

    .line 24375
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v19  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v10  # "pm":Landroid/content/pm/PackageManager;
    .restart local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "volumeUuid":Ljava/lang/String;
    .restart local p3  # "moveId":I
    .restart local p4  # "callingUid":I
    .restart local p5  # "user":Landroid/os/UserHandle;
    :catchall_3e8
    move-exception v0

    move-object/from16 v54, v10

    move-object/from16 v55, v12

    move-object v3, v13

    .end local v10  # "pm":Landroid/content/pm/PackageManager;
    .end local v12  # "storage":Landroid/os/storage/StorageManager;
    .restart local v54  # "pm":Landroid/content/pm/PackageManager;
    .restart local v55  # "storage":Landroid/os/storage/StorageManager;
    :goto_3ee
    monitor-exit v1
    :try_end_3ef
    .catchall {:try_start_37e .. :try_end_3ef} :catchall_3f0

    throw v0

    :catchall_3f0
    move-exception v0

    goto :goto_3ee
.end method

.method private mzReplaceResolverName(Landroid/content/ComponentName;)Landroid/content/ComponentName;
    .registers 5
    .param p1, "componentName"  # Landroid/content/ComponentName;

    .line 26302
    if-eqz p1, :cond_22

    invoke-virtual {p1}, Landroid/content/ComponentName;->getClassName()Ljava/lang/String;

    move-result-object v0

    const-class v1, Lcom/android/internal/app/ResolverActivity;

    invoke-virtual {v1}, Ljava/lang/Class;->getName()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_22

    .line 26303
    new-instance v0, Landroid/content/ComponentName;

    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v1

    const-class v2, Lcom/android/internal/app/MzResolverActivity;

    invoke-virtual {v2}, Ljava/lang/Class;->getName()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v0, v1, v2}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 26304
    .local v0, "name":Landroid/content/ComponentName;
    return-object v0

    .line 26306
    .end local v0  # "name":Landroid/content/ComponentName;
    :cond_22
    return-object p1
.end method

.method private needsNetworkVerificationLPr(Ljava/lang/String;)Z
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 18964
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/Settings;->getIntentFilterVerificationLPr(Ljava/lang/String;)Landroid/content/pm/IntentFilterVerificationInfo;

    move-result-object v0

    .line 18966
    .local v0, "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    const/4 v1, 0x1

    if-nez v0, :cond_a

    .line 18967
    return v1

    .line 18969
    :cond_a
    invoke-virtual {v0}, Landroid/content/pm/IntentFilterVerificationInfo;->getStatus()I

    move-result v2

    .line 18970
    .local v2, "status":I
    if-eqz v2, :cond_17

    if-eq v2, v1, :cond_17

    const/4 v3, 0x2

    if-eq v2, v3, :cond_17

    .line 18978
    const/4 v1, 0x0

    return v1

    .line 18974
    :cond_17
    return v1
.end method

.method private nonStaticSharedLibExistsLocked(Ljava/lang/String;)Z
    .registers 5
    .param p1, "name"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 12585
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    const-wide/16 v1, -0x1

    invoke-static {p1, v1, v2, v0}, Lcom/android/server/pm/PackageManagerService;->sharedLibExists(Ljava/lang/String;JLjava/util/Map;)Z

    move-result v0

    return v0
.end method

.method private normalizePackageNameLPr(Ljava/lang/String;)Ljava/lang/String;
    .registers 4
    .param p1, "packageName"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 4980
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/Settings;->getRenamedPackageLPr(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    .line 4981
    .local v0, "normalizedPackageName":Ljava/lang/String;
    if-eqz v0, :cond_a

    move-object v1, v0

    goto :goto_b

    :cond_a
    move-object v1, p1

    :goto_b
    return-object v1
.end method

.method private notifyInstallObserver(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/pm/IPackageInstallObserver2;)V
    .registers 7
    .param p1, "info"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .param p2, "installObserver"  # Landroid/content/pm/IPackageInstallObserver2;

    .line 2244
    if-eqz p2, :cond_18

    .line 2246
    :try_start_2
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->extrasForInstallResult(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;)Landroid/os/Bundle;

    move-result-object v0

    .line 2247
    .local v0, "extras":Landroid/os/Bundle;
    iget-object v1, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->name:Ljava/lang/String;

    iget v2, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    iget-object v3, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnMsg:Ljava/lang/String;

    invoke-interface {p2, v1, v2, v3, v0}, Landroid/content/pm/IPackageInstallObserver2;->onPackageInstalled(Ljava/lang/String;ILjava/lang/String;Landroid/os/Bundle;)V
    :try_end_f
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_f} :catch_10

    .line 2251
    .end local v0  # "extras":Landroid/os/Bundle;
    goto :goto_18

    .line 2249
    :catch_10
    move-exception v0

    .line 2250
    .local v0, "e":Landroid/os/RemoteException;
    const-string v1, "PackageManager"

    const-string v2, "Observer no longer exists."

    invoke-static {v1, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2253
    .end local v0  # "e":Landroid/os/RemoteException;
    :cond_18
    :goto_18
    return-void
.end method

.method private notifyInstallObserver(Ljava/lang/String;)V
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;

    .line 2234
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mNoKillInstallObservers:Ljava/util/Map;

    .line 2235
    invoke-interface {v0, p1}, Ljava/util/Map;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/util/Pair;

    .line 2237
    .local v0, "pair":Landroid/util/Pair;, "Landroid/util/Pair<Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/pm/IPackageInstallObserver2;>;"
    if-eqz v0, :cond_15

    .line 2238
    iget-object v1, v0, Landroid/util/Pair;->first:Ljava/lang/Object;

    check-cast v1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget-object v2, v0, Landroid/util/Pair;->second:Ljava/lang/Object;

    check-cast v2, Landroid/content/pm/IPackageInstallObserver2;

    invoke-direct {p0, v1, v2}, Lcom/android/server/pm/PackageManagerService;->notifyInstallObserver(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/pm/IPackageInstallObserver2;)V

    .line 2240
    :cond_15
    return-void
.end method

.method private notifyPackageUseLocked(Ljava/lang/String;I)V
    .registers 7
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "reason"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 10323
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/PackageParser$Package;

    .line 10324
    .local v0, "p":Landroid/content/pm/PackageParser$Package;
    if-nez v0, :cond_b

    .line 10325
    return-void

    .line 10327
    :cond_b
    iget-object v1, v0, Landroid/content/pm/PackageParser$Package;->mLastPackageUsageTimeInMills:[J

    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v2

    aput-wide v2, v1, p2

    .line 10328
    return-void
.end method

.method static onRestoreComplete(ILandroid/content/Context;Landroid/content/IntentSender;)V
    .registers 10
    .param p0, "returnCode"  # I
    .param p1, "context"  # Landroid/content/Context;
    .param p2, "target"  # Landroid/content/IntentSender;

    .line 14190
    new-instance v0, Landroid/content/Intent;

    invoke-direct {v0}, Landroid/content/Intent;-><init>()V

    .line 14191
    .local v0, "fillIn":Landroid/content/Intent;
    nop

    .line 14192
    invoke-static {p0}, Landroid/content/pm/PackageManager;->installStatusToPublicStatus(I)I

    move-result v1

    .line 14191
    const-string v2, "android.content.pm.extra.STATUS"

    invoke-virtual {v0, v2, v1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 14194
    const/4 v3, 0x0

    const/4 v5, 0x0

    const/4 v6, 0x0

    move-object v1, p2

    move-object v2, p1

    move-object v4, v0

    :try_start_15
    invoke-virtual/range {v1 .. v6}, Landroid/content/IntentSender;->sendIntent(Landroid/content/Context;ILandroid/content/Intent;Landroid/content/IntentSender$OnFinished;Landroid/os/Handler;)V
    :try_end_18
    .catch Landroid/content/IntentSender$SendIntentException; {:try_start_15 .. :try_end_18} :catch_19

    .line 14196
    goto :goto_1a

    .line 14195
    :catch_19
    move-exception v1

    .line 14197
    :goto_1a
    return-void
.end method

.method private optimisticallyRegisterAppId(Lcom/android/server/pm/PackageManagerService$ScanResult;)Z
    .registers 4
    .param p1, "result"  # Lcom/android/server/pm/PackageManagerService$ScanResult;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 11468
    iget-boolean v0, p1, Lcom/android/server/pm/PackageManagerService$ScanResult;->existingSettingCopied:Z

    if-nez v0, :cond_d

    .line 11471
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, p1, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/Settings;->registerAppIdLPw(Lcom/android/server/pm/PackageSetting;)Z

    move-result v0

    return v0

    .line 11473
    :cond_d
    const/4 v0, 0x0

    return v0
.end method

.method private packageIsBrowser(Ljava/lang/String;I)Z
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 4236
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sBrowserIntent:Landroid/content/Intent;

    const/4 v1, 0x0

    const/high16 v2, 0x20000

    invoke-direct {p0, v0, v1, v2, p2}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v0

    .line 4238
    .local v0, "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v1

    .line 4239
    .local v1, "N":I
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_e
    if-ge v2, v1, :cond_29

    .line 4240
    invoke-interface {v0, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    .line 4241
    .local v3, "info":Landroid/content/pm/ResolveInfo;
    iget v4, v3, Landroid/content/pm/ResolveInfo;->priority:I

    if-ltz v4, :cond_26

    iget-object v4, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {p1, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_26

    .line 4242
    const/4 v4, 0x1

    return v4

    .line 4239
    .end local v3  # "info":Landroid/content/pm/ResolveInfo;
    :cond_26
    add-int/lit8 v2, v2, 0x1

    goto :goto_e

    .line 4245
    .end local v2  # "i":I
    :cond_29
    const/4 v2, 0x0

    return v2
.end method

.method private patchFpsUserIntentActivities(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;I)V
    .registers 9
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p5, "targetUserId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "I",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;I)V"
        }
    .end annotation

    .line 7493
    .local p4, "originalList":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :try_start_0
    invoke-direct {p0, p1, p2, p3, p5}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v0

    .line 7495
    .local v0, "resolveListEx":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-eqz v0, :cond_21

    invoke-interface {v0}, Ljava/util/List;->isEmpty()Z

    move-result v1

    if-nez v1, :cond_21

    .line 7496
    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_10
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_21

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ResolveInfo;

    .line 7497
    .local v2, "item":Landroid/content/pm/ResolveInfo;
    invoke-interface {p4, v2}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_1f
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_1f} :catch_22

    .line 7498
    nop

    .end local v2  # "item":Landroid/content/pm/ResolveInfo;
    goto :goto_10

    .line 7502
    .end local v0  # "resolveListEx":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_21
    goto :goto_3d

    .line 7500
    :catch_22
    move-exception v0

    .line 7501
    .local v0, "e":Ljava/lang/Exception;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "IntentActivities fpsUser E:"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/Exception;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 7503
    .end local v0  # "e":Ljava/lang/Exception;
    :goto_3d
    return-void
.end method

.method private performDexOptInternal(Lcom/android/server/pm/dex/DexoptOptions;)I
    .registers 7
    .param p1, "options"  # Lcom/android/server/pm/dex/DexoptOptions;

    .line 10458
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 10459
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {p1}, Lcom/android/server/pm/dex/DexoptOptions;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 10460
    .local v1, "p":Landroid/content/pm/PackageParser$Package;
    if-nez v1, :cond_14

    .line 10462
    const/4 v2, -0x1

    monitor-exit v0

    return v2

    .line 10464
    :cond_14
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackageUsage:Lcom/android/server/pm/PackageUsage;

    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, v3}, Lcom/android/server/pm/PackageUsage;->maybeWriteAsync(Ljava/lang/Object;)Z

    .line 10465
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mCompilerStats:Lcom/android/server/pm/CompilerStats;

    invoke-virtual {v2}, Lcom/android/server/pm/CompilerStats;->maybeWriteAsync()Z

    .line 10466
    monitor-exit v0
    :try_end_21
    .catchall {:try_start_3 .. :try_end_21} :catchall_39

    .line 10467
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 10469
    .local v2, "callingId":J
    :try_start_25
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v0
    :try_end_28
    .catchall {:try_start_25 .. :try_end_28} :catchall_34

    .line 10470
    :try_start_28
    invoke-direct {p0, v1, p1}, Lcom/android/server/pm/PackageManagerService;->performDexOptInternalWithDependenciesLI(Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/dex/DexoptOptions;)I

    move-result v4

    monitor-exit v0
    :try_end_2d
    .catchall {:try_start_28 .. :try_end_2d} :catchall_31

    .line 10473
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10470
    return v4

    .line 10471
    :catchall_31
    move-exception v4

    :try_start_32
    monitor-exit v0
    :try_end_33
    .catchall {:try_start_32 .. :try_end_33} :catchall_31

    .end local v1  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v2  # "callingId":J
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "options":Lcom/android/server/pm/dex/DexoptOptions;
    :try_start_33
    throw v4
    :try_end_34
    .catchall {:try_start_33 .. :try_end_34} :catchall_34

    .line 10473
    .restart local v1  # "p":Landroid/content/pm/PackageParser$Package;
    .restart local v2  # "callingId":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "options":Lcom/android/server/pm/dex/DexoptOptions;
    :catchall_34
    move-exception v0

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0

    .line 10466
    .end local v1  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v2  # "callingId":J
    :catchall_39
    move-exception v1

    :try_start_3a
    monitor-exit v0
    :try_end_3b
    .catchall {:try_start_3a .. :try_end_3b} :catchall_39

    throw v1
.end method

.method private performDexOptInternalWithDependenciesLI(Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/dex/DexoptOptions;)I
    .registers 14
    .param p1, "p"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "options"  # Lcom/android/server/pm/dex/DexoptOptions;

    .line 10494
    invoke-virtual {p2}, Lcom/android/server/pm/dex/DexoptOptions;->isForce()Z

    move-result v0

    if-eqz v0, :cond_f

    .line 10495
    new-instance v0, Lcom/android/server/pm/PackageDexOptimizer$ForcedUpdatePackageDexOptimizer;

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDexOptimizer:Lcom/android/server/pm/PackageDexOptimizer;

    invoke-direct {v0, v1}, Lcom/android/server/pm/PackageDexOptimizer$ForcedUpdatePackageDexOptimizer;-><init>(Lcom/android/server/pm/PackageDexOptimizer;)V

    move-object v1, v0

    goto :goto_12

    .line 10496
    :cond_f
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDexOptimizer:Lcom/android/server/pm/PackageDexOptimizer;

    move-object v1, v0

    :goto_12
    nop

    .line 10505
    .local v1, "pdo":Lcom/android/server/pm/PackageDexOptimizer;
    invoke-static {p1}, Lcom/android/server/pm/PackageManagerService;->findSharedLibraries(Landroid/content/pm/PackageParser$Package;)Ljava/util/List;

    move-result-object v0

    .line 10506
    .local v0, "deps":Ljava/util/Collection;, "Ljava/util/Collection<Landroid/content/pm/SharedLibraryInfo;>;"
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-static {v2}, Lcom/android/server/pm/InstructionSets;->getAppDexInstructionSets(Landroid/content/pm/ApplicationInfo;)[Ljava/lang/String;

    move-result-object v9

    .line 10507
    .local v9, "instructionSets":[Ljava/lang/String;
    invoke-interface {v0}, Ljava/util/Collection;->isEmpty()Z

    move-result v2

    if-nez v2, :cond_7f

    .line 10508
    new-instance v2, Lcom/android/server/pm/dex/DexoptOptions;

    invoke-virtual {p2}, Lcom/android/server/pm/dex/DexoptOptions;->getPackageName()Ljava/lang/String;

    move-result-object v4

    .line 10509
    invoke-virtual {p2}, Lcom/android/server/pm/dex/DexoptOptions;->getCompilationReason()I

    move-result v5

    invoke-virtual {p2}, Lcom/android/server/pm/dex/DexoptOptions;->getCompilerFilter()Ljava/lang/String;

    move-result-object v6

    .line 10510
    invoke-virtual {p2}, Lcom/android/server/pm/dex/DexoptOptions;->getSplitName()Ljava/lang/String;

    move-result-object v7

    .line 10511
    invoke-virtual {p2}, Lcom/android/server/pm/dex/DexoptOptions;->getFlags()I

    move-result v3

    or-int/lit8 v8, v3, 0x40

    move-object v3, v2

    invoke-direct/range {v3 .. v8}, Lcom/android/server/pm/dex/DexoptOptions;-><init>(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;I)V

    move-object v6, v2

    .line 10512
    .local v6, "libraryOptions":Lcom/android/server/pm/dex/DexoptOptions;
    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v7

    :goto_44
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_7f

    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    move-object v8, v2

    check-cast v8, Landroid/content/pm/SharedLibraryInfo;

    .line 10513
    .local v8, "info":Landroid/content/pm/SharedLibraryInfo;
    const/4 v2, 0x0

    .line 10514
    .local v2, "depPackage":Landroid/content/pm/PackageParser$Package;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 10515
    :try_start_55
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v8}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/PackageParser$Package;
    :try_end_61
    .catchall {:try_start_55 .. :try_end_61} :catchall_7c

    move-object v10, v4

    .line 10516
    .end local v2  # "depPackage":Landroid/content/pm/PackageParser$Package;
    .local v10, "depPackage":Landroid/content/pm/PackageParser$Package;
    :try_start_62
    monitor-exit v3
    :try_end_63
    .catchall {:try_start_62 .. :try_end_63} :catchall_78

    .line 10517
    if-eqz v10, :cond_77

    .line 10519
    nop

    .line 10520
    invoke-virtual {p0, v10}, Lcom/android/server/pm/PackageManagerService;->getOrCreateCompilerPackageStats(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/CompilerStats$PackageStats;

    move-result-object v4

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    iget-object v3, v10, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 10521
    invoke-virtual {v2, v3}, Lcom/android/server/pm/dex/DexManager;->getPackageUseInfoOrDefault(Ljava/lang/String;)Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;

    move-result-object v5

    .line 10519
    move-object v2, v10

    move-object v3, v9

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageDexOptimizer;->performDexOpt(Landroid/content/pm/PackageParser$Package;[Ljava/lang/String;Lcom/android/server/pm/CompilerStats$PackageStats;Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;Lcom/android/server/pm/dex/DexoptOptions;)I

    .line 10526
    .end local v8  # "info":Landroid/content/pm/SharedLibraryInfo;
    .end local v10  # "depPackage":Landroid/content/pm/PackageParser$Package;
    :cond_77
    goto :goto_44

    .line 10516
    .restart local v8  # "info":Landroid/content/pm/SharedLibraryInfo;
    .restart local v10  # "depPackage":Landroid/content/pm/PackageParser$Package;
    :catchall_78
    move-exception v2

    move-object v4, v2

    move-object v2, v10

    goto :goto_7d

    .end local v10  # "depPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v2  # "depPackage":Landroid/content/pm/PackageParser$Package;
    :catchall_7c
    move-exception v4

    :goto_7d
    :try_start_7d
    monitor-exit v3
    :try_end_7e
    .catchall {:try_start_7d .. :try_end_7e} :catchall_7c

    throw v4

    .line 10528
    .end local v2  # "depPackage":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "libraryOptions":Lcom/android/server/pm/dex/DexoptOptions;
    .end local v8  # "info":Landroid/content/pm/SharedLibraryInfo;
    :cond_7f
    nop

    .line 10529
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getOrCreateCompilerPackageStats(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/CompilerStats$PackageStats;

    move-result-object v6

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 10530
    invoke-virtual {v2, v3}, Lcom/android/server/pm/dex/DexManager;->getPackageUseInfoOrDefault(Ljava/lang/String;)Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;

    move-result-object v7

    .line 10528
    move-object v3, v1

    move-object v4, p1

    move-object v5, v9

    move-object v8, p2

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/PackageDexOptimizer;->performDexOpt(Landroid/content/pm/PackageParser$Package;[Ljava/lang/String;Lcom/android/server/pm/CompilerStats$PackageStats;Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;Lcom/android/server/pm/dex/DexoptOptions;)I

    move-result v2

    return v2
.end method

.method private performDexOptTraced(Lcom/android/server/pm/dex/DexoptOptions;)I
    .registers 6
    .param p1, "options"  # Lcom/android/server/pm/dex/DexoptOptions;

    .line 10443
    const-wide/32 v0, 0x40000

    const-string v2, "dexopt"

    invoke-static {v0, v1, v2}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 10445
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "PMS:performDexOpt:"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Lcom/android/server/pm/dex/DexoptOptions;->getPackageName()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->addBootEvent(Ljava/lang/String;)V

    .line 10448
    :try_start_20
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->performDexOptInternal(Lcom/android/server/pm/dex/DexoptOptions;)I

    move-result v2
    :try_end_24
    .catchall {:try_start_20 .. :try_end_24} :catchall_28

    .line 10450
    invoke-static {v0, v1}, Landroid/os/Trace;->traceEnd(J)V

    .line 10448
    return v2

    .line 10450
    :catchall_28
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Trace;->traceEnd(J)V

    throw v2
.end method

.method private performDexOptUpgrade(Ljava/util/List;ZIZ)[I
    .registers 24
    .param p2, "showDialog"  # Z
    .param p3, "compilationReason"  # I
    .param p4, "bootComplete"  # Z
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/PackageParser$Package;",
            ">;ZIZ)[I"
        }
    .end annotation

    .line 10149
    .local p1, "pkgs":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/PackageParser$Package;>;"
    move-object/from16 v1, p0

    const/4 v0, 0x0

    .line 10150
    .local v0, "numberOfPackagesVisited":I
    const/4 v2, 0x0

    .line 10151
    .local v2, "numberOfPackagesOptimized":I
    const/4 v3, 0x0

    .line 10152
    .local v3, "numberOfPackagesSkipped":I
    const/4 v4, 0x0

    .line 10153
    .local v4, "numberOfPackagesFailed":I
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v5

    .line 10155
    .local v5, "numberOfPackagesToDexopt":I
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v6

    :goto_e
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_1e6

    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Landroid/content/pm/PackageParser$Package;

    .line 10156
    .local v7, "pkg":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v11, v0, 0x1

    .line 10158
    .end local v0  # "numberOfPackagesVisited":I
    .local v11, "numberOfPackagesVisited":I
    const/4 v12, 0x0

    .line 10160
    .local v12, "useProfileForDexopt":Z
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->isFirstBoot()Z

    move-result v0

    if-nez v0, :cond_2e

    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->isDeviceUpgrading()Z

    move-result v0

    if-eqz v0, :cond_2a

    goto :goto_2e

    :cond_2a
    move-object/from16 v18, v6

    goto/16 :goto_103

    :cond_2e
    :goto_2e
    invoke-static {v7}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-eqz v0, :cond_101

    .line 10163
    new-instance v0, Ljava/io/File;

    invoke-static {v7}, Lcom/android/server/pm/PackageManagerService;->getPrebuildProfilePath(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;

    move-result-object v13

    invoke-direct {v0, v13}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    move-object v13, v0

    .line 10165
    .local v13, "profileFile":Ljava/io/File;
    invoke-virtual {v13}, Ljava/io/File;->exists()Z

    move-result v0

    const/4 v14, 0x0

    if-eqz v0, :cond_87

    .line 10170
    :try_start_45
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v13}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v15

    iget-object v10, v7, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v10, v10, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v9, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 10172
    invoke-static {v14}, Landroid/content/pm/dex/ArtManager;->getProfileName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v14

    .line 10170
    invoke-virtual {v0, v15, v10, v9, v14}, Lcom/android/server/pm/Installer;->copySystemProfile(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;)Z

    move-result v0

    if-nez v0, :cond_83

    .line 10173
    const-string v0, "PackageManager"

    const-string v9, "Installer failed to copy system profile!"

    invoke-static {v0, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_62
    .catch Ljava/lang/Exception; {:try_start_45 .. :try_end_62} :catch_63

    goto :goto_83

    .line 10179
    :catch_63
    move-exception v0

    .line 10180
    .local v0, "e":Ljava/lang/Exception;
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Failed to copy profile "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    const-string v10, "PackageManager"

    invoke-static {v10, v9, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10182
    .end local v0  # "e":Ljava/lang/Exception;
    :cond_83
    :goto_83
    move-object/from16 v18, v6

    goto/16 :goto_103

    .line 10184
    :cond_87
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v9, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v9}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v9

    .line 10188
    .local v9, "disabledPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v9, :cond_fe

    iget-object v0, v9, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-boolean v0, v0, Landroid/content/pm/PackageParser$Package;->isStub:Z

    if-eqz v0, :cond_fe

    .line 10191
    iget-object v0, v9, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 10192
    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->getPrebuildProfilePath(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;

    move-result-object v0

    const-string v10, "-Stub"

    const-string v15, ""

    invoke-virtual {v0, v10, v15}, Ljava/lang/String;->replace(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Ljava/lang/String;

    move-result-object v10

    .line 10193
    .local v10, "systemProfilePath":Ljava/lang/String;
    new-instance v0, Ljava/io/File;

    invoke-direct {v0, v10}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    move-object v13, v0

    .line 10200
    invoke-virtual {v13}, Ljava/io/File;->exists()Z

    move-result v0

    if-eqz v0, :cond_fb

    .line 10206
    :try_start_b1
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v13}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v15

    iget-object v8, v7, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v14, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
    :try_end_bd
    .catch Ljava/lang/Exception; {:try_start_b1 .. :try_end_bd} :catch_d8

    .line 10208
    move-object/from16 v18, v6

    const/16 v17, 0x0

    :try_start_c1
    invoke-static/range {v17 .. v17}, Landroid/content/pm/dex/ArtManager;->getProfileName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    .line 10206
    invoke-virtual {v0, v15, v8, v14, v6}, Lcom/android/server/pm/Installer;->copySystemProfile(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;)Z

    move-result v0

    if-nez v0, :cond_d3

    .line 10209
    const-string v0, "PackageManager"

    const-string v6, "Failed to copy system profile for stub package!"

    invoke-static {v0, v6}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_d2
    .catch Ljava/lang/Exception; {:try_start_c1 .. :try_end_d2} :catch_d6

    goto :goto_d5

    .line 10211
    :cond_d3
    const/4 v0, 0x1

    move v12, v0

    .line 10216
    :goto_d5
    goto :goto_103

    .line 10213
    :catch_d6
    move-exception v0

    goto :goto_db

    :catch_d8
    move-exception v0

    move-object/from16 v18, v6

    .line 10214
    .restart local v0  # "e":Ljava/lang/Exception;
    :goto_db
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Failed to copy profile "

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 10215
    invoke-virtual {v13}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, " "

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    .line 10214
    const-string v8, "PackageManager"

    invoke-static {v8, v6, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_103

    .line 10200
    .end local v0  # "e":Ljava/lang/Exception;
    :cond_fb
    move-object/from16 v18, v6

    goto :goto_103

    .line 10188
    .end local v10  # "systemProfilePath":Ljava/lang/String;
    :cond_fe
    move-object/from16 v18, v6

    goto :goto_103

    .line 10160
    .end local v9  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "profileFile":Ljava/io/File;
    :cond_101
    move-object/from16 v18, v6

    .line 10222
    :goto_103
    invoke-static {v7}, Lcom/android/server/pm/PackageDexOptimizer;->canOptimizePackage(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-nez v0, :cond_12c

    .line 10223
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DEXOPT:Z

    if-eqz v0, :cond_125

    .line 10224
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Skipping update of of non-optimizable app "

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v6, "PackageManager"

    invoke-static {v6, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 10226
    :cond_125
    add-int/lit8 v3, v3, 0x1

    .line 10227
    move v0, v11

    move-object/from16 v6, v18

    goto/16 :goto_e

    .line 10230
    :cond_12c
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DEXOPT:Z

    if-eqz v0, :cond_158

    .line 10231
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Updating app "

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, " of "

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, ": "

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v6, "PackageManager"

    invoke-static {v6, v0}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 10235
    :cond_158
    if-eqz p2, :cond_18c

    .line 10237
    :try_start_15a
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v0

    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 10238
    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v6

    const v8, 0x1040083

    const/4 v9, 0x2

    new-array v9, v9, [Ljava/lang/Object;

    .line 10239
    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v10

    const/4 v13, 0x0

    aput-object v10, v9, v13

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v10

    const/4 v13, 0x1

    aput-object v10, v9, v13

    .line 10238
    invoke-virtual {v6, v8, v9}, Landroid/content/res/Resources;->getString(I[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 10237
    invoke-interface {v0, v6, v13}, Landroid/app/IActivityManager;->showBootMessage(Ljava/lang/CharSequence;Z)V
    :try_end_17f
    .catch Landroid/os/RemoteException; {:try_start_15a .. :try_end_17f} :catch_180

    .line 10241
    goto :goto_181

    .line 10240
    :catch_180
    move-exception v0

    .line 10242
    :goto_181
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6

    .line 10243
    const/4 v8, 0x1

    :try_start_185
    iput-boolean v8, v1, Lcom/android/server/pm/PackageManagerService;->mDexOptDialogShown:Z

    .line 10244
    monitor-exit v6

    goto :goto_18c

    :catchall_189
    move-exception v0

    monitor-exit v6
    :try_end_18b
    .catchall {:try_start_185 .. :try_end_18b} :catchall_189

    throw v0

    .line 10247
    :cond_18c
    :goto_18c
    move/from16 v0, p3

    .line 10248
    .local v0, "pkgCompilationReason":I
    if-eqz v12, :cond_191

    .line 10251
    const/4 v0, 0x3

    .line 10254
    :cond_191
    const-string/jumbo v6, "pm.precompile_layouts"

    const/4 v8, 0x0

    invoke-static {v6, v8}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z

    move-result v6

    if-eqz v6, :cond_1a0

    .line 10255
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mArtManagerService:Lcom/android/server/pm/dex/ArtManagerService;

    invoke-virtual {v6, v7}, Lcom/android/server/pm/dex/ArtManagerService;->compileLayouts(Landroid/content/pm/PackageParser$Package;)Z

    .line 10263
    :cond_1a0
    if-eqz p4, :cond_1a6

    const/4 v9, 0x4

    move/from16 v16, v9

    goto :goto_1a8

    :cond_1a6
    const/16 v16, 0x0

    :goto_1a8
    move/from16 v6, v16

    .line 10264
    .local v6, "dexoptFlags":I
    if-nez p3, :cond_1ae

    .line 10266
    or-int/lit16 v6, v6, 0x400

    .line 10268
    :cond_1ae
    new-instance v8, Lcom/android/server/pm/dex/DexoptOptions;

    iget-object v9, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-direct {v8, v9, v0, v6}, Lcom/android/server/pm/dex/DexoptOptions;-><init>(Ljava/lang/String;II)V

    invoke-direct {v1, v8}, Lcom/android/server/pm/PackageManagerService;->performDexOptTraced(Lcom/android/server/pm/dex/DexoptOptions;)I

    move-result v8

    .line 10273
    .local v8, "primaryDexOptStaus":I
    const/4 v9, -0x1

    if-eq v8, v9, :cond_1de

    if-eqz v8, :cond_1db

    const/4 v9, 0x1

    if-eq v8, v9, :cond_1d8

    .line 10284
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Unexpected dexopt return code "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    const-string v10, "PackageManager"

    invoke-static {v10, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_1e1

    .line 10275
    :cond_1d8
    add-int/lit8 v2, v2, 0x1

    .line 10276
    goto :goto_1e1

    .line 10278
    :cond_1db
    add-int/lit8 v3, v3, 0x1

    .line 10279
    goto :goto_1e1

    .line 10281
    :cond_1de
    add-int/lit8 v4, v4, 0x1

    .line 10282
    nop

    .line 10287
    .end local v0  # "pkgCompilationReason":I
    .end local v6  # "dexoptFlags":I
    .end local v7  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v8  # "primaryDexOptStaus":I
    .end local v12  # "useProfileForDexopt":Z
    :goto_1e1
    move v0, v11

    move-object/from16 v6, v18

    goto/16 :goto_e

    .line 10289
    .end local v11  # "numberOfPackagesVisited":I
    .local v0, "numberOfPackagesVisited":I
    :cond_1e6
    const/4 v6, 0x3

    new-array v6, v6, [I

    const/4 v7, 0x0

    aput v2, v6, v7

    const/4 v7, 0x1

    aput v3, v6, v7

    const/4 v7, 0x2

    aput v4, v6, v7

    return-object v6
.end method

.method private postPreferredActivityChangedBroadcast(I)V
    .registers 4
    .param p1, "userId"  # I

    .line 21156
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Yfnee_CTmno9dIMhv8Cxk-LIk7w;

    invoke-direct {v1, p1}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Yfnee_CTmno9dIMhv8Cxk-LIk7w;-><init>(I)V

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 21172
    return-void
.end method

.method private prepareAppDataAfterInstallLIF(Landroid/content/pm/PackageParser$Package;)V
    .registers 9
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 23967
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 23968
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 23969
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v1}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V

    .line 23970
    monitor-exit v0
    :try_end_15
    .catchall {:try_start_3 .. :try_end_15} :catchall_52

    .line 23972
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    .line 23973
    .local v0, "um":Lcom/android/server/pm/UserManagerService;
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getUserManagerInternal()Landroid/os/UserManagerInternal;

    move-result-object v2

    .line 23974
    .local v2, "umInternal":Landroid/os/UserManagerInternal;
    const/4 v3, 0x0

    invoke-virtual {v0, v3}, Lcom/android/server/pm/UserManagerService;->getUsers(Z)Ljava/util/List;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :cond_24
    :goto_24
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_51

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/UserInfo;

    .line 23976
    .local v4, "user":Landroid/content/pm/UserInfo;
    iget v5, v4, Landroid/content/pm/UserInfo;->id:I

    invoke-virtual {v2, v5}, Landroid/os/UserManagerInternal;->isUserUnlockingOrUnlocked(I)Z

    move-result v5

    if-eqz v5, :cond_3a

    .line 23977
    const/4 v5, 0x3

    .local v5, "flags":I
    goto :goto_43

    .line 23978
    .end local v5  # "flags":I
    :cond_3a
    iget v5, v4, Landroid/content/pm/UserInfo;->id:I

    invoke-virtual {v2, v5}, Landroid/os/UserManagerInternal;->isUserRunning(I)Z

    move-result v5

    if-eqz v5, :cond_24

    .line 23979
    const/4 v5, 0x1

    .line 23984
    .restart local v5  # "flags":I
    :goto_43
    iget v6, v4, Landroid/content/pm/UserInfo;->id:I

    invoke-virtual {v1, v6}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v6

    if-eqz v6, :cond_50

    .line 23986
    iget v6, v4, Landroid/content/pm/UserInfo;->id:I

    invoke-direct {p0, p1, v6, v5}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 23988
    .end local v4  # "user":Landroid/content/pm/UserInfo;
    .end local v5  # "flags":I
    :cond_50
    goto :goto_24

    .line 23989
    :cond_51
    return-void

    .line 23970
    .end local v0  # "um":Lcom/android/server/pm/UserManagerService;
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v2  # "umInternal":Landroid/os/UserManagerInternal;
    :catchall_52
    move-exception v1

    :try_start_53
    monitor-exit v0
    :try_end_54
    .catchall {:try_start_53 .. :try_end_54} :catchall_52

    throw v1
.end method

.method private prepareAppDataAndMigrateLIF(Landroid/content/pm/PackageParser$Package;IIZ)V
    .registers 6
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I
    .param p3, "flags"  # I
    .param p4, "maybeMigrateAppData"  # Z

    .line 24013
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 24015
    if-eqz p4, :cond_e

    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->maybeMigrateAppDataLIF(Landroid/content/pm/PackageParser$Package;I)Z

    move-result v0

    if-eqz v0, :cond_e

    .line 24018
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 24020
    :cond_e
    return-void
.end method

.method private prepareAppDataContentsLIF(Landroid/content/pm/PackageParser$Package;II)V
    .registers 7
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I
    .param p3, "flags"  # I

    .line 24101
    if-nez p1, :cond_f

    .line 24102
    new-instance v0, Ljava/lang/Throwable;

    invoke-direct {v0}, Ljava/lang/Throwable;-><init>()V

    const-string v1, "PackageManager"

    const-string v2, "Package was null!"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 24103
    return-void

    .line 24105
    :cond_f
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataContentsLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 24106
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_1d

    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_1e

    :cond_1d
    const/4 v0, 0x0

    .line 24107
    .local v0, "childCount":I
    :goto_1e
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_1f
    if-ge v1, v0, :cond_2f

    .line 24108
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    invoke-direct {p0, v2, p2, p3}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataContentsLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 24107
    add-int/lit8 v1, v1, 0x1

    goto :goto_1f

    .line 24110
    .end local v1  # "i":I
    :cond_2f
    return-void
.end method

.method private prepareAppDataContentsLeafLIF(Landroid/content/pm/PackageParser$Package;II)V
    .registers 11
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I
    .param p3, "flags"  # I

    .line 24113
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->volumeUuid:Ljava/lang/String;

    .line 24114
    .local v0, "volumeUuid":Ljava/lang/String;
    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 24115
    .local v1, "packageName":Ljava/lang/String;
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 24117
    .local v2, "app":Landroid/content/pm/ApplicationInfo;
    and-int/lit8 v3, p3, 0x2

    if-eqz v3, :cond_3d

    .line 24121
    iget-object v3, v2, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    if-eqz v3, :cond_3d

    iget-object v3, v2, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    invoke-static {v3}, Ldalvik/system/VMRuntime;->is64BitAbi(Ljava/lang/String;)Z

    move-result v3

    if-nez v3, :cond_3d

    .line 24122
    iget-object v3, v2, Landroid/content/pm/ApplicationInfo;->nativeLibraryDir:Ljava/lang/String;

    .line 24124
    .local v3, "nativeLibPath":Ljava/lang/String;
    :try_start_18
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v4, v0, v1, v3, p2}, Lcom/android/server/pm/Installer;->linkNativeLibraryDirectory(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;I)V
    :try_end_1d
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_18 .. :try_end_1d} :catch_1e

    .line 24128
    goto :goto_3d

    .line 24126
    :catch_1e
    move-exception v4

    .line 24127
    .local v4, "e":Lcom/android/server/pm/Installer$InstallerException;
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failed to link native for "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, ": "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v6, "PackageManager"

    invoke-static {v6, v5}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 24131
    .end local v3  # "nativeLibPath":Ljava/lang/String;
    .end local v4  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :cond_3d
    :goto_3d
    return-void
.end method

.method private prepareAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V
    .registers 7
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I
    .param p3, "flags"  # I

    .line 24000
    if-nez p1, :cond_f

    .line 24001
    new-instance v0, Ljava/lang/Throwable;

    invoke-direct {v0}, Ljava/lang/Throwable;-><init>()V

    const-string v1, "PackageManager"

    const-string v2, "Package was null!"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 24002
    return-void

    .line 24004
    :cond_f
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 24005
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_1d

    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_1e

    :cond_1d
    const/4 v0, 0x0

    .line 24006
    .local v0, "childCount":I
    :goto_1e
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_1f
    if-ge v1, v0, :cond_2f

    .line 24007
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    invoke-direct {p0, v2, p2, p3}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 24006
    add-int/lit8 v1, v1, 0x1

    goto :goto_1f

    .line 24009
    .end local v1  # "i":I
    :cond_2f
    return-void
.end method

.method private prepareAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V
    .registers 26
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "userId"  # I
    .param p3, "flags"  # I

    .line 24023
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move/from16 v11, p2

    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_APP_DATA:Z

    if-eqz v0, :cond_37

    .line 24024
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v3, "prepareAppData for "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " u"

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, " 0x"

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 24025
    invoke-static/range {p3 .. p3}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 24024
    const-string v3, "PackageManager"

    invoke-static {v3, v0}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 24029
    :cond_37
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 24030
    :try_start_3a
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v4, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    move-object v12, v0

    .line 24031
    .local v12, "ps":Lcom/android/server/pm/PackageSetting;
    monitor-exit v3
    :try_end_48
    .catchall {:try_start_3a .. :try_end_48} :catchall_155

    .line 24032
    iget-object v13, v2, Landroid/content/pm/PackageParser$Package;->volumeUuid:Ljava/lang/String;

    .line 24033
    .local v13, "volumeUuid":Ljava/lang/String;
    iget-object v14, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 24035
    .local v14, "packageName":Ljava/lang/String;
    const/4 v15, 0x0

    if-nez v12, :cond_52

    .line 24036
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    goto :goto_5a

    .line 24037
    :cond_52
    invoke-virtual {v12, v11}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v0

    invoke-static {v2, v15, v0, v11}, Landroid/content/pm/PackageParser;->generateApplicationInfo(Landroid/content/pm/PackageParser$Package;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v0

    :goto_5a
    nop

    .line 24038
    .local v0, "app":Landroid/content/pm/ApplicationInfo;
    if-nez v0, :cond_61

    .line 24039
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v10, v0

    goto :goto_62

    .line 24038
    :cond_61
    move-object v10, v0

    .line 24042
    .end local v0  # "app":Landroid/content/pm/ApplicationInfo;
    .local v10, "app":Landroid/content/pm/ApplicationInfo;
    :goto_62
    iget v0, v10, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v0}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v16

    .line 24044
    .local v16, "appId":I
    iget-object v0, v10, Landroid/content/pm/ApplicationInfo;->seInfo:Ljava/lang/String;

    invoke-static {v0}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;)Ljava/lang/Object;

    .line 24046
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    iget-object v3, v10, Landroid/content/pm/ApplicationInfo;->seInfo:Ljava/lang/String;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v10, Landroid/content/pm/ApplicationInfo;->seInfoUser:Ljava/lang/String;

    if-eqz v3, :cond_7e

    iget-object v3, v10, Landroid/content/pm/ApplicationInfo;->seInfoUser:Ljava/lang/String;

    goto :goto_80

    :cond_7e
    const-string v3, ""

    :goto_80
    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    .line 24047
    .local v17, "seInfo":Ljava/lang/String;
    const-wide/16 v18, -0x1

    .line 24049
    .local v18, "ceDataInode":J
    :try_start_89
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    iget v0, v10, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I
    :try_end_8d
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_89 .. :try_end_8d} :catch_a4

    move-object v4, v13

    move-object v5, v14

    move/from16 v6, p2

    move/from16 v7, p3

    move/from16 v8, v16

    move-object/from16 v9, v17

    move-object/from16 v20, v10

    .end local v10  # "app":Landroid/content/pm/ApplicationInfo;
    .local v20, "app":Landroid/content/pm/ApplicationInfo;
    move v10, v0

    :try_start_9a
    invoke-virtual/range {v3 .. v10}, Lcom/android/server/pm/Installer;->createAppData(Ljava/lang/String;Ljava/lang/String;IIILjava/lang/String;I)J

    move-result-wide v3
    :try_end_9e
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_9a .. :try_end_9e} :catch_a2

    move-wide/from16 v18, v3

    .line 24066
    goto/16 :goto_12a

    .line 24051
    :catch_a2
    move-exception v0

    goto :goto_a7

    .end local v20  # "app":Landroid/content/pm/ApplicationInfo;
    .restart local v10  # "app":Landroid/content/pm/ApplicationInfo;
    :catch_a4
    move-exception v0

    move-object/from16 v20, v10

    .end local v10  # "app":Landroid/content/pm/ApplicationInfo;
    .restart local v20  # "app":Landroid/content/pm/ApplicationInfo;
    :goto_a7
    move-object v10, v0

    .line 24052
    .local v10, "e":Lcom/android/server/pm/Installer$InstallerException;
    invoke-virtual/range {v20 .. v20}, Landroid/content/pm/ApplicationInfo;->isSystemApp()Z

    move-result v0

    if-eqz v0, :cond_106

    .line 24053
    const/4 v0, 0x6

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Failed to create app data for "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, ", but trying to recover: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v0, v3}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 24055
    invoke-direct/range {p0 .. p3}, Lcom/android/server/pm/PackageManagerService;->destroyAppDataLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 24057
    const/4 v9, 0x3

    :try_start_cf
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;
    :try_end_d1
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_cf .. :try_end_d1} :catch_fa

    move-object/from16 v8, v20

    .end local v20  # "app":Landroid/content/pm/ApplicationInfo;
    .local v8, "app":Landroid/content/pm/ApplicationInfo;
    :try_start_d3
    iget v0, v8, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I
    :try_end_d5
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_d3 .. :try_end_d5} :catch_f3

    move-object v4, v13

    move-object v5, v14

    move/from16 v6, p2

    move/from16 v7, p3

    move-object/from16 v20, v8

    .end local v8  # "app":Landroid/content/pm/ApplicationInfo;
    .restart local v20  # "app":Landroid/content/pm/ApplicationInfo;
    move/from16 v8, v16

    move v15, v9

    move-object/from16 v9, v17

    move-object/from16 v21, v10

    .end local v10  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .local v21, "e":Lcom/android/server/pm/Installer$InstallerException;
    move v10, v0

    :try_start_e5
    invoke-virtual/range {v3 .. v10}, Lcom/android/server/pm/Installer;->createAppData(Ljava/lang/String;Ljava/lang/String;IIILjava/lang/String;I)J

    move-result-wide v3

    move-wide/from16 v18, v3

    .line 24059
    const-string v0, "Recovery succeeded!"

    invoke-static {v15, v0}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V
    :try_end_f0
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_e5 .. :try_end_f0} :catch_f1

    goto :goto_103

    .line 24060
    :catch_f1
    move-exception v0

    goto :goto_fe

    .end local v20  # "app":Landroid/content/pm/ApplicationInfo;
    .end local v21  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .restart local v8  # "app":Landroid/content/pm/ApplicationInfo;
    .restart local v10  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :catch_f3
    move-exception v0

    move-object/from16 v20, v8

    move v15, v9

    move-object/from16 v21, v10

    .end local v8  # "app":Landroid/content/pm/ApplicationInfo;
    .end local v10  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .restart local v20  # "app":Landroid/content/pm/ApplicationInfo;
    .restart local v21  # "e":Lcom/android/server/pm/Installer$InstallerException;
    goto :goto_fe

    .end local v21  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .restart local v10  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :catch_fa
    move-exception v0

    move v15, v9

    move-object/from16 v21, v10

    .line 24061
    .end local v10  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .local v0, "e2":Lcom/android/server/pm/Installer$InstallerException;
    .restart local v21  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :goto_fe
    const-string v3, "Recovery failed!"

    invoke-static {v15, v3}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 24062
    .end local v0  # "e2":Lcom/android/server/pm/Installer$InstallerException;
    :goto_103
    move-wide/from16 v3, v18

    goto :goto_12a

    .line 24064
    .end local v21  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .restart local v10  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :cond_106
    move-object/from16 v21, v10

    .end local v10  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .restart local v21  # "e":Lcom/android/server/pm/Installer$InstallerException;
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Failed to create app data for "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, ": "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v3, v21

    .end local v21  # "e":Lcom/android/server/pm/Installer$InstallerException;
    .local v3, "e":Lcom/android/server/pm/Installer$InstallerException;
    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v4, "PackageManager"

    invoke-static {v4, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    move-wide/from16 v3, v18

    .line 24083
    .end local v18  # "ceDataInode":J
    .local v3, "ceDataInode":J
    :goto_12a
    iget-boolean v0, v1, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z

    if-nez v0, :cond_134

    iget-boolean v0, v1, Lcom/android/server/pm/PackageManagerService;->mFirstBoot:Z

    if-nez v0, :cond_134

    if-eqz v11, :cond_13a

    .line 24084
    :cond_134
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mArtManagerService:Lcom/android/server/pm/dex/ArtManagerService;

    const/4 v5, 0x0

    invoke-virtual {v0, v2, v11, v5}, Lcom/android/server/pm/dex/ArtManagerService;->prepareAppProfiles(Landroid/content/pm/PackageParser$Package;IZ)V

    .line 24088
    :cond_13a
    and-int/lit8 v0, p3, 0x2

    if-eqz v0, :cond_151

    const-wide/16 v5, -0x1

    cmp-long v0, v3, v5

    if-eqz v0, :cond_151

    .line 24090
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 24091
    if-eqz v12, :cond_14c

    .line 24092
    :try_start_149
    invoke-virtual {v12, v3, v4, v11}, Lcom/android/server/pm/PackageSetting;->setCeDataInode(JI)V

    .line 24094
    :cond_14c
    monitor-exit v5

    goto :goto_151

    :catchall_14e
    move-exception v0

    monitor-exit v5
    :try_end_150
    .catchall {:try_start_149 .. :try_end_150} :catchall_14e

    throw v0

    .line 24097
    :cond_151
    :goto_151
    invoke-direct/range {p0 .. p3}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataContentsLeafLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 24098
    return-void

    .line 24031
    .end local v3  # "ceDataInode":J
    .end local v12  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "volumeUuid":Ljava/lang/String;
    .end local v14  # "packageName":Ljava/lang/String;
    .end local v16  # "appId":I
    .end local v17  # "seInfo":Ljava/lang/String;
    .end local v20  # "app":Landroid/content/pm/ApplicationInfo;
    :catchall_155
    move-exception v0

    :try_start_156
    monitor-exit v3
    :try_end_157
    .catchall {:try_start_156 .. :try_end_157} :catchall_155

    throw v0
.end method

.method private preparePackageLI(Lcom/android/server/pm/PackageManagerService$InstallArgs;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;)Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .registers 51
    .param p1, "args"  # Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .param p2, "res"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerService$PrepareFailure;
        }
    .end annotation

    .line 17948
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move-object/from16 v3, p2

    iget v4, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->installFlags:I

    .line 17949
    .local v4, "installFlags":I
    iget-object v15, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->installerPackageName:Ljava/lang/String;

    .line 17950
    .local v15, "installerPackageName":Ljava/lang/String;
    iget-object v14, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->volumeUuid:Ljava/lang/String;

    .line 17951
    .local v14, "volumeUuid":Ljava/lang/String;
    new-instance v5, Ljava/io/File;

    invoke-virtual/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService$InstallArgs;->getCodePath()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    move-object v13, v5

    .line 17952
    .local v13, "tmpPackageFile":Ljava/io/File;
    iget-object v5, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->volumeUuid:Ljava/lang/String;

    if-eqz v5, :cond_1c

    const/4 v5, 0x1

    goto :goto_1d

    :cond_1c
    const/4 v5, 0x0

    :goto_1d
    move v12, v5

    .line 17953
    .local v12, "onExternal":Z
    and-int/lit16 v5, v4, 0x800

    if-eqz v5, :cond_24

    const/4 v5, 0x1

    goto :goto_25

    :cond_24
    const/4 v5, 0x0

    :goto_25
    move/from16 v23, v5

    .line 17954
    .local v23, "instantApp":Z
    and-int/lit16 v5, v4, 0x4000

    if-eqz v5, :cond_2d

    const/4 v5, 0x1

    goto :goto_2e

    :cond_2d
    const/4 v5, 0x0

    :goto_2e
    move/from16 v24, v5

    .line 17955
    .local v24, "fullApp":Z
    const/high16 v5, 0x10000

    and-int v8, v4, v5

    if-eqz v8, :cond_38

    const/4 v8, 0x1

    goto :goto_39

    :cond_38
    const/4 v8, 0x0

    :goto_39
    move/from16 v25, v8

    .line 17957
    .local v25, "virtualPreload":Z
    const/4 v8, 0x6

    .line 17958
    .local v8, "scanFlags":I
    iget-object v9, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->move:Lcom/android/server/pm/PackageManagerService$MoveInfo;

    if-eqz v9, :cond_42

    .line 17960
    or-int/lit16 v8, v8, 0x200

    .line 17962
    :cond_42
    and-int/lit16 v9, v4, 0x1000

    if-eqz v9, :cond_48

    .line 17963
    or-int/lit16 v8, v8, 0x800

    .line 17965
    :cond_48
    if-eqz v23, :cond_4c

    .line 17966
    or-int/lit16 v8, v8, 0x4000

    .line 17968
    :cond_4c
    if-eqz v24, :cond_52

    .line 17969
    const v9, 0x8000

    or-int/2addr v8, v9

    .line 17971
    :cond_52
    if-eqz v25, :cond_55

    .line 17972
    or-int/2addr v8, v5

    .line 17975
    :cond_55
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v5, :cond_70

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v9, "installPackageLI: path="

    invoke-virtual {v5, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v9, "PackageManager"

    invoke-static {v9, v5}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 17978
    :cond_70
    const/16 v5, -0x74

    if-eqz v23, :cond_93

    if-nez v12, :cond_77

    goto :goto_93

    .line 17979
    :cond_77
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Incompatible ephemeral install; external="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v12}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const-string v7, "PackageManager"

    invoke-static {v7, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 17980
    new-instance v6, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    invoke-direct {v6, v5}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(I)V

    throw v6

    .line 17984
    :cond_93
    :goto_93
    iget v9, v1, Lcom/android/server/pm/PackageManagerService;->mDefParseFlags:I

    const/high16 v10, -0x80000000

    or-int/2addr v9, v10

    or-int/lit8 v9, v9, 0x40

    .line 17986
    if-eqz v12, :cond_9f

    const/16 v16, 0x8

    goto :goto_a1

    :cond_9f
    const/16 v16, 0x0

    :goto_a1
    or-int v9, v9, v16

    .line 17988
    .local v9, "parseFlags":I
    new-instance v16, Landroid/content/pm/PackageParser;

    invoke-direct/range {v16 .. v16}, Landroid/content/pm/PackageParser;-><init>()V

    move-object/from16 v17, v16

    .line 17989
    .local v17, "pp":Landroid/content/pm/PackageParser;
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mSeparateProcesses:[Ljava/lang/String;

    move-object/from16 v11, v17

    .end local v17  # "pp":Landroid/content/pm/PackageParser;
    .local v11, "pp":Landroid/content/pm/PackageParser;
    invoke-virtual {v11, v10}, Landroid/content/pm/PackageParser;->setSeparateProcesses([Ljava/lang/String;)V

    .line 17990
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mMetrics:Landroid/util/DisplayMetrics;

    invoke-virtual {v11, v10}, Landroid/content/pm/PackageParser;->setDisplayMetrics(Landroid/util/DisplayMetrics;)V

    .line 17991
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mPackageParserCallback:Landroid/content/pm/PackageParser$Callback;

    invoke-virtual {v11, v10}, Landroid/content/pm/PackageParser;->setCallback(Landroid/content/pm/PackageParser$Callback;)V

    .line 17993
    const-wide/32 v6, 0x40000

    const-string/jumbo v10, "parsePackage"

    invoke-static {v6, v7, v10}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 17996
    :try_start_c4
    invoke-virtual {v11, v13, v9}, Landroid/content/pm/PackageParser;->parsePackage(Ljava/io/File;I)Landroid/content/pm/PackageParser$Package;

    move-result-object v10

    .line 17997
    .local v10, "pkg":Landroid/content/pm/PackageParser$Package;
    invoke-static {v10}, Landroid/content/pm/dex/DexMetadataHelper;->validatePackageDexMetadata(Landroid/content/pm/PackageParser$Package;)V
    :try_end_cb
    .catch Landroid/content/pm/PackageParser$PackageParserException; {:try_start_c4 .. :try_end_cb} :catch_10eb
    .catchall {:try_start_c4 .. :try_end_cb} :catchall_10da

    .line 18001
    invoke-static {v6, v7}, Landroid/os/Trace;->traceEnd(J)V

    .line 18002
    nop

    .line 18005
    if-eqz v23, :cond_128

    .line 18006
    iget-object v6, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    const/16 v7, 0x1a

    if-lt v6, v7, :cond_103

    .line 18012
    iget-object v6, v10, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    if-nez v6, :cond_de

    goto :goto_128

    .line 18013
    :cond_de
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Instant app package "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v10, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " may not declare sharedUserId."

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const-string v7, "PackageManager"

    invoke-static {v7, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18015
    new-instance v6, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const-string v7, "Instant app package may not declare a sharedUserId"

    invoke-direct {v6, v5, v7}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v6

    .line 18007
    :cond_103
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Instant app package "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v10, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " does not target at least O"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const-string v7, "PackageManager"

    invoke-static {v7, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18009
    new-instance v6, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const-string v7, "Instant app package must target at least O"

    invoke-direct {v6, v5, v7}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v6

    .line 18020
    :cond_128
    :goto_128
    iget-object v6, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v6}, Landroid/content/pm/ApplicationInfo;->isStaticSharedLibrary()Z

    move-result v6

    if-eqz v6, :cond_147

    .line 18022
    invoke-static {v10}, Lcom/android/server/pm/PackageManagerService;->renameStaticSharedLibraryPackage(Landroid/content/pm/PackageParser$Package;)V

    .line 18025
    if-nez v12, :cond_136

    goto :goto_147

    .line 18026
    :cond_136
    const-string v5, "PackageManager"

    const-string v6, "Static shared libs can only be installed on internal storage."

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 18027
    new-instance v5, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const/16 v6, -0x13

    const-string v7, "Packages declaring static-shared libs cannot be updated"

    invoke-direct {v5, v6, v7}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v5

    .line 18033
    :cond_147
    :goto_147
    iget-object v6, v10, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v6, :cond_1fd

    .line 18034
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6

    .line 18035
    :try_start_14e
    iget-object v7, v10, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v7

    .line 18036
    .local v7, "childCount":I
    const/16 v20, 0x0

    move/from16 v5, v20

    .local v5, "i":I
    :goto_158
    if-ge v5, v7, :cond_1e2

    .line 18037
    move/from16 v20, v7

    .end local v7  # "childCount":I
    .local v20, "childCount":I
    iget-object v7, v10, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v7, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Landroid/content/pm/PackageParser$Package;

    .line 18038
    .local v7, "childPkg":Landroid/content/pm/PackageParser$Package;
    new-instance v22, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    invoke-direct/range {v22 .. v22}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;-><init>()V
    :try_end_169
    .catchall {:try_start_14e .. :try_end_169} :catchall_1ee

    move-object/from16 v26, v22

    .line 18039
    .local v26, "childRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    move-object/from16 v22, v11

    move-object/from16 v11, v26

    move-object/from16 v26, v13

    const/4 v13, 0x1

    .end local v13  # "tmpPackageFile":Ljava/io/File;
    .local v11, "childRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .local v22, "pp":Landroid/content/pm/PackageParser;
    .local v26, "tmpPackageFile":Ljava/io/File;
    :try_start_172
    invoke-virtual {v11, v13}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setReturnCode(I)V

    .line 18040
    iput-object v7, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 18041
    iget-object v13, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iput-object v13, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->name:Ljava/lang/String;

    .line 18042
    iget-object v13, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;
    :try_end_17d
    .catchall {:try_start_172 .. :try_end_17d} :catchall_1db

    move/from16 v27, v9

    .end local v9  # "parseFlags":I
    .local v27, "parseFlags":I
    :try_start_17f
    iget-object v9, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v13, v9}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v9

    .line 18043
    .local v9, "childPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v9, :cond_197

    .line 18044
    sget-object v13, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    .line 18045
    invoke-virtual {v13}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v13
    :try_end_18d
    .catchall {:try_start_17f .. :try_end_18d} :catchall_1d6

    .line 18044
    move-object/from16 v28, v14

    const/4 v14, 0x1

    .end local v14  # "volumeUuid":Ljava/lang/String;
    .local v28, "volumeUuid":Ljava/lang/String;
    :try_start_190
    invoke-virtual {v9, v13, v14}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v13

    iput-object v13, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origUsers:[I

    goto :goto_199

    .line 18043
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v14  # "volumeUuid":Ljava/lang/String;
    :cond_197
    move-object/from16 v28, v14

    .line 18047
    .end local v14  # "volumeUuid":Ljava/lang/String;
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    :goto_199
    iget-object v13, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v14, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v13, v14}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v13

    if-eqz v13, :cond_1b6

    .line 18048
    new-instance v13, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    invoke-direct {v13, v1}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;-><init>(Lcom/android/server/pm/PackageSender;)V

    iput-object v13, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    .line 18049
    iget-object v13, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v14, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iput-object v14, v13, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    .line 18050
    iget-object v13, v11, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v14, v9, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    iput-object v14, v13, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installerPackageName:Ljava/lang/String;

    .line 18052
    :cond_1b6
    iget-object v13, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->addedChildPackages:Landroid/util/ArrayMap;

    if-nez v13, :cond_1c1

    .line 18053
    new-instance v13, Landroid/util/ArrayMap;

    invoke-direct {v13}, Landroid/util/ArrayMap;-><init>()V

    iput-object v13, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->addedChildPackages:Landroid/util/ArrayMap;

    .line 18055
    :cond_1c1
    iget-object v13, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->addedChildPackages:Landroid/util/ArrayMap;

    iget-object v14, v7, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v13, v14, v11}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18036
    nop

    .end local v7  # "childPkg":Landroid/content/pm/PackageParser$Package;
    .end local v9  # "childPs":Lcom/android/server/pm/PackageSetting;
    .end local v11  # "childRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    add-int/lit8 v5, v5, 0x1

    move/from16 v7, v20

    move-object/from16 v11, v22

    move-object/from16 v13, v26

    move/from16 v9, v27

    move-object/from16 v14, v28

    goto :goto_158

    .line 18057
    .end local v5  # "i":I
    .end local v20  # "childCount":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v14  # "volumeUuid":Ljava/lang/String;
    :catchall_1d6
    move-exception v0

    move-object/from16 v28, v14

    move-object v5, v0

    .end local v14  # "volumeUuid":Ljava/lang/String;
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    goto :goto_1f8

    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .local v9, "parseFlags":I
    .restart local v14  # "volumeUuid":Ljava/lang/String;
    :catchall_1db
    move-exception v0

    move/from16 v27, v9

    move-object/from16 v28, v14

    move-object v5, v0

    .end local v9  # "parseFlags":I
    .end local v14  # "volumeUuid":Ljava/lang/String;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    goto :goto_1f8

    .line 18036
    .end local v22  # "pp":Landroid/content/pm/PackageParser;
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v5  # "i":I
    .local v7, "childCount":I
    .restart local v9  # "parseFlags":I
    .local v11, "pp":Landroid/content/pm/PackageParser;
    .restart local v13  # "tmpPackageFile":Ljava/io/File;
    .restart local v14  # "volumeUuid":Ljava/lang/String;
    :cond_1e2
    move/from16 v20, v7

    move/from16 v27, v9

    move-object/from16 v22, v11

    move-object/from16 v26, v13

    move-object/from16 v28, v14

    .line 18057
    .end local v5  # "i":I
    .end local v7  # "childCount":I
    .end local v9  # "parseFlags":I
    .end local v11  # "pp":Landroid/content/pm/PackageParser;
    .end local v13  # "tmpPackageFile":Ljava/io/File;
    .end local v14  # "volumeUuid":Ljava/lang/String;
    .restart local v22  # "pp":Landroid/content/pm/PackageParser;
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    monitor-exit v6

    goto :goto_205

    .end local v22  # "pp":Landroid/content/pm/PackageParser;
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v9  # "parseFlags":I
    .restart local v11  # "pp":Landroid/content/pm/PackageParser;
    .restart local v13  # "tmpPackageFile":Ljava/io/File;
    .restart local v14  # "volumeUuid":Ljava/lang/String;
    :catchall_1ee
    move-exception v0

    move/from16 v27, v9

    move-object/from16 v22, v11

    move-object/from16 v26, v13

    move-object/from16 v28, v14

    move-object v5, v0

    .end local v9  # "parseFlags":I
    .end local v11  # "pp":Landroid/content/pm/PackageParser;
    .end local v13  # "tmpPackageFile":Ljava/io/File;
    .end local v14  # "volumeUuid":Ljava/lang/String;
    .restart local v22  # "pp":Landroid/content/pm/PackageParser;
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    :goto_1f8
    monitor-exit v6
    :try_end_1f9
    .catchall {:try_start_190 .. :try_end_1f9} :catchall_1fa

    throw v5

    :catchall_1fa
    move-exception v0

    move-object v5, v0

    goto :goto_1f8

    .line 18033
    .end local v22  # "pp":Landroid/content/pm/PackageParser;
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v9  # "parseFlags":I
    .restart local v11  # "pp":Landroid/content/pm/PackageParser;
    .restart local v13  # "tmpPackageFile":Ljava/io/File;
    .restart local v14  # "volumeUuid":Ljava/lang/String;
    :cond_1fd
    move/from16 v27, v9

    move-object/from16 v22, v11

    move-object/from16 v26, v13

    move-object/from16 v28, v14

    .line 18062
    .end local v9  # "parseFlags":I
    .end local v11  # "pp":Landroid/content/pm/PackageParser;
    .end local v13  # "tmpPackageFile":Ljava/io/File;
    .end local v14  # "volumeUuid":Ljava/lang/String;
    .restart local v22  # "pp":Landroid/content/pm/PackageParser;
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    :goto_205
    iget-object v5, v10, Landroid/content/pm/PackageParser$Package;->cpuAbiOverride:Ljava/lang/String;

    invoke-static {v5}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v5

    if-eqz v5, :cond_211

    .line 18063
    iget-object v5, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->abiOverride:Ljava/lang/String;

    iput-object v5, v10, Landroid/content/pm/PackageParser$Package;->cpuAbiOverride:Ljava/lang/String;

    .line 18066
    :cond_211
    iget-object v5, v10, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iput-object v5, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->name:Ljava/lang/String;

    .line 18067
    .local v5, "pkgName":Ljava/lang/String;
    iget-object v6, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit16 v6, v6, 0x100

    if-eqz v6, :cond_22d

    .line 18068
    and-int/lit8 v6, v4, 0x4

    if-eqz v6, :cond_222

    goto :goto_22d

    .line 18069
    :cond_222
    new-instance v6, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const/16 v7, -0xf

    const-string/jumbo v9, "installPackageLI"

    invoke-direct {v6, v7, v9}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v6

    .line 18075
    :cond_22d
    :goto_22d
    :try_start_22d
    iget-object v6, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->signingDetails:Landroid/content/pm/PackageParser$SigningDetails;

    sget-object v7, Landroid/content/pm/PackageParser$SigningDetails;->UNKNOWN:Landroid/content/pm/PackageParser$SigningDetails;
    :try_end_231
    .catch Landroid/content/pm/PackageParser$PackageParserException; {:try_start_22d .. :try_end_231} :catch_10c8

    if-eq v6, v7, :cond_246

    .line 18076
    :try_start_233
    iget-object v6, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->signingDetails:Landroid/content/pm/PackageParser$SigningDetails;

    invoke-virtual {v10, v6}, Landroid/content/pm/PackageParser$Package;->setSigningDetails(Landroid/content/pm/PackageParser$SigningDetails;)V
    :try_end_238
    .catch Landroid/content/pm/PackageParser$PackageParserException; {:try_start_233 .. :try_end_238} :catch_23a

    move-object v14, v10

    goto :goto_24b

    .line 18080
    :catch_23a
    move-exception v0

    move-object v2, v0

    move/from16 v42, v4

    move-object/from16 v45, v10

    move/from16 v43, v12

    move-object/from16 v32, v15

    goto/16 :goto_10d2

    .line 18078
    :cond_246
    const/4 v6, 0x0

    :try_start_247
    invoke-static {v10, v6}, Landroid/content/pm/PackageParser;->collectCertificates(Landroid/content/pm/PackageParser$Package;Z)V
    :try_end_24a
    .catch Landroid/content/pm/PackageParser$PackageParserException; {:try_start_247 .. :try_end_24a} :catch_10c8

    move-object v14, v10

    .line 18082
    .end local v10  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v14, "pkg":Landroid/content/pm/PackageParser$Package;
    :goto_24b
    nop

    .line 18084
    if-eqz v23, :cond_27d

    iget-object v6, v14, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget v6, v6, Landroid/content/pm/PackageParser$SigningDetails;->signatureSchemeVersion:I

    const/4 v7, 0x2

    if-lt v6, v7, :cond_256

    goto :goto_27d

    .line 18086
    :cond_256
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Instant app package "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " is not signed with at least APK Signature Scheme v2"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const-string v7, "PackageManager"

    invoke-static {v7, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18088
    new-instance v6, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const-string v7, "Instant app package must be signed with APK Signature Scheme v2 or greater"

    const/16 v9, -0x74

    invoke-direct {v6, v9, v7}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v6

    .line 18092
    :cond_27d
    :goto_27d
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getInstallerSettings()I

    move-result v6

    const/4 v9, 0x1

    if-ne v6, v9, :cond_393

    .line 18094
    :try_start_284
    iget v6, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->callInstallUid:I

    invoke-virtual {v1, v6}, Lcom/android/server/pm/PackageManagerService;->getNameForUid(I)Ljava/lang/String;

    move-result-object v6

    .line 18095
    .local v6, "realInstallerPackageName":Ljava/lang/String;
    const-string v9, "PackageManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Instant app innerInstallerPackageName: "

    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v13, ", mRequiredInstallerPackage: "

    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v1, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v13, ", pkgName: "

    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v9, v11}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18096
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    invoke-static {v6, v9}, Landroid/text/TextUtils;->equals(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Z

    move-result v9

    if-nez v9, :cond_38b

    .line 18097
    new-instance v9, Ljava/util/HashMap;

    invoke-direct {v9}, Ljava/util/HashMap;-><init>()V

    .line 18098
    .local v9, "properties":Ljava/util/HashMap;, "Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/String;>;"
    const-string/jumbo v11, "requiredInstallerPackage"

    iget-object v13, v1, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    invoke-virtual {v9, v11, v13}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18099
    const-string v11, "callerPkg"

    invoke-virtual {v9, v11, v15}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18100
    const-string/jumbo v11, "realCallerPkg"

    invoke-virtual {v9, v11, v6}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18101
    const-string v11, "calleeInstallPkg"

    invoke-virtual {v9, v11, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18102
    const-string/jumbo v11, "realCallerUid"

    iget v13, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->callInstallUid:I

    invoke-static {v13}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;

    move-result-object v13

    invoke-virtual {v9, v11, v13}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18103
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v11
    :try_end_2e7
    .catch Ljava/lang/Exception; {:try_start_284 .. :try_end_2e7} :catch_38e

    .line 18104
    .local v11, "am":Landroid/app/IActivityManager;
    if-eqz v11, :cond_357

    .line 18106
    :try_start_2e9
    invoke-interface {v11}, Landroid/app/IActivityManager;->getRunningAppProcesses()Ljava/util/List;

    move-result-object v13

    invoke-interface {v13}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v13

    :goto_2f1
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v19

    if-eqz v19, :cond_34c

    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Landroid/app/ActivityManager$RunningAppProcessInfo;

    move-object/from16 v20, v19

    .line 18107
    .local v20, "appProcess":Landroid/app/ActivityManager$RunningAppProcessInfo;
    move-object/from16 v10, v20

    .end local v20  # "appProcess":Landroid/app/ActivityManager$RunningAppProcessInfo;
    .local v10, "appProcess":Landroid/app/ActivityManager$RunningAppProcessInfo;
    iget v7, v10, Landroid/app/ActivityManager$RunningAppProcessInfo;->pid:I
    :try_end_303
    .catch Landroid/os/RemoteException; {:try_start_2e9 .. :try_end_303} :catch_34f
    .catch Ljava/lang/Exception; {:try_start_2e9 .. :try_end_303} :catch_38e

    move-object/from16 v29, v6

    .end local v6  # "realInstallerPackageName":Ljava/lang/String;
    .local v29, "realInstallerPackageName":Ljava/lang/String;
    :try_start_305
    iget v6, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->callInstallPid:I

    if-ne v7, v6, :cond_346

    .line 18108
    iget-object v6, v10, Landroid/app/ActivityManager$RunningAppProcessInfo;->processName:Ljava/lang/String;

    .line 18109
    .local v6, "realCallerProcessName":Ljava/lang/String;
    const-string/jumbo v7, "realCallerProcessName"

    invoke-virtual {v9, v7, v6}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18110
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    .line 18111
    .local v7, "realCallerPkg2":Ljava/lang/StringBuilder;
    const/4 v13, 0x0

    move/from16 v19, v13

    .local v13, "i":I
    :goto_319
    move-object/from16 v19, v6

    .end local v6  # "realCallerProcessName":Ljava/lang/String;
    .local v19, "realCallerProcessName":Ljava/lang/String;
    iget-object v6, v10, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    array-length v6, v6

    if-ge v13, v6, :cond_33b

    .line 18112
    if-eqz v13, :cond_32f

    .line 18113
    const-string v6, ","

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v10, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    aget-object v6, v6, v13

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_336

    .line 18115
    :cond_32f
    iget-object v6, v10, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    aget-object v6, v6, v13

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 18111
    :goto_336
    add-int/lit8 v13, v13, 0x1

    move-object/from16 v6, v19

    goto :goto_319

    .line 18118
    .end local v13  # "i":I
    :cond_33b
    const-string/jumbo v6, "realCallerPkg2"

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {v9, v6, v13}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_345
    .catch Landroid/os/RemoteException; {:try_start_305 .. :try_end_345} :catch_349
    .catch Ljava/lang/Exception; {:try_start_305 .. :try_end_345} :catch_38e

    .line 18119
    goto :goto_34e

    .line 18121
    .end local v7  # "realCallerPkg2":Ljava/lang/StringBuilder;
    .end local v10  # "appProcess":Landroid/app/ActivityManager$RunningAppProcessInfo;
    .end local v19  # "realCallerProcessName":Ljava/lang/String;
    :cond_346
    move-object/from16 v6, v29

    goto :goto_2f1

    .line 18122
    :catch_349
    move-exception v0

    move-object v6, v0

    goto :goto_353

    .line 18106
    .end local v29  # "realInstallerPackageName":Ljava/lang/String;
    .local v6, "realInstallerPackageName":Ljava/lang/String;
    :cond_34c
    move-object/from16 v29, v6

    .line 18124
    .end local v6  # "realInstallerPackageName":Ljava/lang/String;
    .restart local v29  # "realInstallerPackageName":Ljava/lang/String;
    :goto_34e
    goto :goto_359

    .line 18122
    .end local v29  # "realInstallerPackageName":Ljava/lang/String;
    .restart local v6  # "realInstallerPackageName":Ljava/lang/String;
    :catch_34f
    move-exception v0

    move-object/from16 v29, v6

    move-object v6, v0

    .line 18123
    .local v6, "e":Landroid/os/RemoteException;
    .restart local v29  # "realInstallerPackageName":Ljava/lang/String;
    :goto_353
    :try_start_353
    invoke-virtual {v6}, Landroid/os/RemoteException;->printStackTrace()V

    goto :goto_359

    .line 18104
    .end local v29  # "realInstallerPackageName":Ljava/lang/String;
    .local v6, "realInstallerPackageName":Ljava/lang/String;
    :cond_357
    move-object/from16 v29, v6

    .line 18126
    .end local v6  # "realInstallerPackageName":Ljava/lang/String;
    .restart local v29  # "realInstallerPackageName":Ljava/lang/String;
    :goto_359
    const-string v6, ""

    .line 18127
    .local v6, "installType":Ljava/lang/String;
    and-int/lit8 v7, v4, 0x20

    if-eqz v7, :cond_362

    .line 18128
    const-string v7, "adb"

    move-object v6, v7

    .line 18130
    :cond_362
    const-string/jumbo v7, "installType"

    invoke-virtual {v9, v7, v6}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18131
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-static {v7}, Landroid/nonvccUsageStats/UsageStatsNonVccProxy3;->getInstance(Landroid/content/Context;)Landroid/nonvccUsageStats/UsageStatsNonVccProxy3;

    move-result-object v7

    const-string v10, "PkgSilentInstall"

    .line 18132
    const/4 v13, 0x0

    invoke-virtual {v7, v10, v13, v9}, Landroid/nonvccUsageStats/UsageStatsNonVccProxy3;->onOsEvent(Ljava/lang/String;Ljava/lang/String;Ljava/util/Map;)V

    .line 18133
    const-string v7, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Instant app package "

    invoke-virtual {v10, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v7, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_38a
    .catch Ljava/lang/Exception; {:try_start_353 .. :try_end_38a} :catch_38e

    goto :goto_38d

    .line 18096
    .end local v9  # "properties":Ljava/util/HashMap;, "Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/String;>;"
    .end local v11  # "am":Landroid/app/IActivityManager;
    .end local v29  # "realInstallerPackageName":Ljava/lang/String;
    .local v6, "realInstallerPackageName":Ljava/lang/String;
    :cond_38b
    move-object/from16 v29, v6

    .line 18137
    .end local v6  # "realInstallerPackageName":Ljava/lang/String;
    :goto_38d
    goto :goto_393

    .line 18135
    :catch_38e
    move-exception v0

    move-object v6, v0

    .line 18136
    .local v6, "ex":Ljava/lang/Exception;
    invoke-virtual {v6}, Ljava/lang/Exception;->printStackTrace()V

    .line 18141
    .end local v6  # "ex":Ljava/lang/Exception;
    :cond_393
    :goto_393
    const/16 v29, 0x0

    .line 18142
    .end local v22  # "pp":Landroid/content/pm/PackageParser;
    .local v29, "pp":Landroid/content/pm/PackageParser;
    const/4 v6, 0x0

    .line 18143
    .local v6, "systemApp":Z
    const/4 v7, 0x0

    .line 18144
    .local v7, "replace":Z
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v9

    .line 18146
    and-int/lit8 v10, v4, 0x2

    if-eqz v10, :cond_569

    .line 18147
    :try_start_39e
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v10, v5}, Lcom/android/server/pm/Settings;->getRenamedPackageLPr(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v10

    move-object v13, v10

    .line 18148
    .local v13, "oldName":Ljava/lang/String;
    iget-object v10, v14, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    if-eqz v10, :cond_3f0

    iget-object v10, v14, Landroid/content/pm/PackageParser$Package;->mOriginalPackages:Ljava/util/ArrayList;

    .line 18149
    invoke-virtual {v10, v13}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v10

    if-eqz v10, :cond_3ed

    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 18150
    invoke-virtual {v10, v13}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v10

    if-eqz v10, :cond_3ea

    .line 18155
    invoke-virtual {v14, v13}, Landroid/content/pm/PackageParser$Package;->setPackageName(Ljava/lang/String;)V

    .line 18156
    iget-object v10, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    move-object v5, v10

    .line 18157
    const/4 v7, 0x1

    .line 18158
    sget-boolean v10, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v10, :cond_3e6

    .line 18159
    const-string v10, "PackageManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V
    :try_end_3cb
    .catchall {:try_start_39e .. :try_end_3cb} :catchall_55b

    move/from16 v22, v6

    .end local v6  # "systemApp":Z
    .local v22, "systemApp":Z
    :try_start_3cd
    const-string v6, "Replacing existing renamed package: oldName="

    invoke-virtual {v11, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " pkgName="

    invoke-virtual {v11, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto/16 :goto_44d

    .line 18158
    .end local v22  # "systemApp":Z
    .restart local v6  # "systemApp":Z
    :cond_3e6
    move/from16 v22, v6

    .end local v6  # "systemApp":Z
    .restart local v22  # "systemApp":Z
    goto/16 :goto_44d

    .line 18150
    .end local v22  # "systemApp":Z
    .restart local v6  # "systemApp":Z
    :cond_3ea
    move/from16 v22, v6

    .end local v6  # "systemApp":Z
    .restart local v22  # "systemApp":Z
    goto :goto_3f2

    .line 18149
    .end local v22  # "systemApp":Z
    .restart local v6  # "systemApp":Z
    :cond_3ed
    move/from16 v22, v6

    .end local v6  # "systemApp":Z
    .restart local v22  # "systemApp":Z
    goto :goto_3f2

    .line 18148
    .end local v22  # "systemApp":Z
    .restart local v6  # "systemApp":Z
    :cond_3f0
    move/from16 v22, v6

    .line 18162
    .end local v6  # "systemApp":Z
    .restart local v22  # "systemApp":Z
    :goto_3f2
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v6, v5}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v6
    :try_end_3f8
    .catchall {:try_start_3cd .. :try_end_3f8} :catchall_54d

    if-eqz v6, :cond_44d

    .line 18165
    const/4 v7, 0x1

    .line 18166
    :try_start_3fb
    sget-boolean v6, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z
    :try_end_3fd
    .catchall {:try_start_3fb .. :try_end_3fd} :catchall_43d

    if-eqz v6, :cond_415

    :try_start_3ff
    const-string v6, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Replace existing pacakge: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v6, v10}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_415
    .catchall {:try_start_3ff .. :try_end_415} :catchall_54d

    .line 18167
    :cond_415
    const/16 v6, 0x8

    const/4 v10, 0x1

    :try_start_418
    invoke-direct {v1, v6, v5, v10}, Lcom/android/server/pm/PackageManagerService;->acquireUxPerfLock(ILjava/lang/String;I)V

    .line 18168
    new-instance v6, Landroid/util/BoostFramework;

    invoke-direct {v6}, Landroid/util/BoostFramework;-><init>()V
    :try_end_420
    .catchall {:try_start_418 .. :try_end_420} :catchall_43d

    .line 18169
    .local v6, "mPerf":Landroid/util/BoostFramework;
    nop

    .line 18170
    const/16 v10, 0x1092

    move/from16 v30, v7

    const/4 v7, 0x0

    const/4 v11, -0x1

    .end local v7  # "replace":Z
    .local v30, "replace":Z
    :try_start_427
    invoke-virtual {v6, v10, v5, v11, v7}, Landroid/util/BoostFramework;->perfHint(ILjava/lang/String;II)I
    :try_end_42a
    .catchall {:try_start_427 .. :try_end_42a} :catchall_42d

    .line 18175
    .end local v6  # "mPerf":Landroid/util/BoostFramework;
    move/from16 v7, v30

    goto :goto_44d

    .line 18353
    .end local v13  # "oldName":Ljava/lang/String;
    :catchall_42d
    move-exception v0

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move-object/from16 v32, v15

    move/from16 v6, v22

    move/from16 v7, v30

    goto/16 :goto_10c3

    .end local v30  # "replace":Z
    .restart local v7  # "replace":Z
    :catchall_43d
    move-exception v0

    move/from16 v30, v7

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move-object/from16 v32, v15

    move/from16 v6, v22

    .end local v7  # "replace":Z
    .restart local v30  # "replace":Z
    goto/16 :goto_10c3

    .line 18175
    .end local v30  # "replace":Z
    .restart local v7  # "replace":Z
    .restart local v13  # "oldName":Ljava/lang/String;
    :cond_44d
    :goto_44d
    :try_start_44d
    iget-object v6, v14, Landroid/content/pm/PackageParser$Package;->parentPackage:Landroid/content/pm/PackageParser$Package;

    if-nez v6, :cond_4f7

    .line 18183
    if-eqz v7, :cond_4eb

    .line 18185
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v6, v5}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/PackageParser$Package;

    .line 18186
    .local v6, "oldPackage":Landroid/content/pm/PackageParser$Package;
    iget-object v11, v6, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v11, v11, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    .line 18187
    .local v11, "oldTargetSdk":I
    iget-object v10, v14, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v10, v10, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I
    :try_end_463
    .catchall {:try_start_44d .. :try_end_463} :catchall_53b

    .line 18188
    .local v10, "newTargetSdk":I
    move-object/from16 v31, v5

    .end local v5  # "pkgName":Ljava/lang/String;
    .local v31, "pkgName":Ljava/lang/String;
    const/16 v5, 0x16

    if-le v11, v5, :cond_4b8

    const/16 v5, 0x16

    if-le v10, v5, :cond_472

    move/from16 v32, v7

    move-object/from16 v33, v13

    goto :goto_4bc

    .line 18190
    :cond_472
    :try_start_472
    new-instance v5, Lcom/android/server/pm/PackageManagerService$PrepareFailure;
    :try_end_474
    .catchall {:try_start_472 .. :try_end_474} :catchall_4a6

    move/from16 v32, v7

    .end local v7  # "replace":Z
    .local v32, "replace":Z
    :try_start_476
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v33, v13

    .end local v13  # "oldName":Ljava/lang/String;
    .local v33, "oldName":Ljava/lang/String;
    const-string v13, "Package "

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v13, " new target SDK "

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v13, " doesn\'t support runtime permissions but the old target SDK "

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v13, " does."

    invoke-virtual {v7, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    const/16 v13, -0x1a

    invoke-direct {v5, v13, v7}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v4  # "installFlags":I
    .end local v8  # "scanFlags":I
    .end local v12  # "onExternal":Z
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .end local v22  # "systemApp":Z
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v31  # "pkgName":Ljava/lang/String;
    .end local v32  # "replace":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v5

    .line 18353
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v10  # "newTargetSdk":I
    .end local v11  # "oldTargetSdk":I
    .end local v33  # "oldName":Ljava/lang/String;
    .restart local v4  # "installFlags":I
    .restart local v7  # "replace":Z
    .restart local v8  # "scanFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v15  # "installerPackageName":Ljava/lang/String;
    .restart local v22  # "systemApp":Z
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v31  # "pkgName":Ljava/lang/String;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_4a6
    move-exception v0

    move/from16 v32, v7

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move/from16 v6, v22

    move-object/from16 v5, v31

    move-object/from16 v32, v15

    .end local v7  # "replace":Z
    .restart local v32  # "replace":Z
    goto/16 :goto_10c3

    .line 18188
    .end local v32  # "replace":Z
    .restart local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v7  # "replace":Z
    .restart local v10  # "newTargetSdk":I
    .restart local v11  # "oldTargetSdk":I
    .restart local v13  # "oldName":Ljava/lang/String;
    :cond_4b8
    move/from16 v32, v7

    move-object/from16 v33, v13

    .line 18206
    .end local v7  # "replace":Z
    .end local v13  # "oldName":Ljava/lang/String;
    .restart local v32  # "replace":Z
    .restart local v33  # "oldName":Ljava/lang/String;
    :goto_4bc
    iget-object v5, v6, Landroid/content/pm/PackageParser$Package;->parentPackage:Landroid/content/pm/PackageParser$Package;

    if-nez v5, :cond_4c1

    goto :goto_4f1

    .line 18207
    :cond_4c1
    new-instance v5, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Package "

    invoke-virtual {v13, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v13, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " is child of package "

    invoke-virtual {v13, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v6, Landroid/content/pm/PackageParser$Package;->parentPackage:Landroid/content/pm/PackageParser$Package;

    invoke-virtual {v13, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v7, ". Child packages can be updated only through the parent package."

    invoke-virtual {v13, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    const/16 v13, -0x6a

    invoke-direct {v5, v13, v7}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v4  # "installFlags":I
    .end local v8  # "scanFlags":I
    .end local v12  # "onExternal":Z
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .end local v22  # "systemApp":Z
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v31  # "pkgName":Ljava/lang/String;
    .end local v32  # "replace":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v5

    .line 18183
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v10  # "newTargetSdk":I
    .end local v11  # "oldTargetSdk":I
    .end local v33  # "oldName":Ljava/lang/String;
    .restart local v4  # "installFlags":I
    .restart local v5  # "pkgName":Ljava/lang/String;
    .restart local v7  # "replace":Z
    .restart local v8  # "scanFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "oldName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v15  # "installerPackageName":Ljava/lang/String;
    .restart local v22  # "systemApp":Z
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :cond_4eb
    move-object/from16 v31, v5

    move/from16 v32, v7

    move-object/from16 v33, v13

    .line 18216
    .end local v5  # "pkgName":Ljava/lang/String;
    .end local v7  # "replace":Z
    .end local v13  # "oldName":Ljava/lang/String;
    .restart local v31  # "pkgName":Ljava/lang/String;
    .restart local v32  # "replace":Z
    :goto_4f1
    move-object/from16 v13, v31

    move/from16 v7, v32

    goto/16 :goto_56c

    .line 18176
    .end local v31  # "pkgName":Ljava/lang/String;
    .end local v32  # "replace":Z
    .restart local v5  # "pkgName":Ljava/lang/String;
    .restart local v7  # "replace":Z
    .restart local v13  # "oldName":Ljava/lang/String;
    :cond_4f7
    move-object/from16 v31, v5

    move/from16 v32, v7

    move-object/from16 v33, v13

    .end local v5  # "pkgName":Ljava/lang/String;
    .end local v7  # "replace":Z
    .end local v13  # "oldName":Ljava/lang/String;
    .restart local v31  # "pkgName":Ljava/lang/String;
    .restart local v32  # "replace":Z
    .restart local v33  # "oldName":Ljava/lang/String;
    new-instance v5, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const/16 v6, -0x6a

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Package "

    invoke-virtual {v7, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v7, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " is child of package "

    invoke-virtual {v7, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v14, Landroid/content/pm/PackageParser$Package;->parentPackage:Landroid/content/pm/PackageParser$Package;

    iget-object v10, v10, Landroid/content/pm/PackageParser$Package;->parentPackage:Landroid/content/pm/PackageParser$Package;

    invoke-virtual {v7, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v10, ". Child packages can be updated only through the parent package."

    invoke-virtual {v7, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v5, v6, v7}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v4  # "installFlags":I
    .end local v8  # "scanFlags":I
    .end local v12  # "onExternal":Z
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .end local v22  # "systemApp":Z
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v31  # "pkgName":Ljava/lang/String;
    .end local v32  # "replace":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v5
    :try_end_529
    .catchall {:try_start_476 .. :try_end_529} :catchall_529

    .line 18353
    .end local v33  # "oldName":Ljava/lang/String;
    .restart local v4  # "installFlags":I
    .restart local v8  # "scanFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v15  # "installerPackageName":Ljava/lang/String;
    .restart local v22  # "systemApp":Z
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v31  # "pkgName":Ljava/lang/String;
    .restart local v32  # "replace":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_529
    move-exception v0

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move/from16 v6, v22

    move-object/from16 v5, v31

    move/from16 v7, v32

    move-object/from16 v32, v15

    goto/16 :goto_10c3

    .end local v31  # "pkgName":Ljava/lang/String;
    .end local v32  # "replace":Z
    .restart local v5  # "pkgName":Ljava/lang/String;
    .restart local v7  # "replace":Z
    :catchall_53b
    move-exception v0

    move-object/from16 v31, v5

    move/from16 v32, v7

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move/from16 v6, v22

    move-object/from16 v32, v15

    .end local v5  # "pkgName":Ljava/lang/String;
    .end local v7  # "replace":Z
    .restart local v31  # "pkgName":Ljava/lang/String;
    .restart local v32  # "replace":Z
    goto/16 :goto_10c3

    .end local v31  # "pkgName":Ljava/lang/String;
    .end local v32  # "replace":Z
    .restart local v5  # "pkgName":Ljava/lang/String;
    .restart local v7  # "replace":Z
    :catchall_54d
    move-exception v0

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move-object/from16 v32, v15

    move/from16 v6, v22

    goto/16 :goto_10c3

    .end local v22  # "systemApp":Z
    .local v6, "systemApp":Z
    :catchall_55b
    move-exception v0

    move/from16 v22, v6

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move-object/from16 v32, v15

    .end local v6  # "systemApp":Z
    .restart local v22  # "systemApp":Z
    goto/16 :goto_10c3

    .line 18146
    .end local v22  # "systemApp":Z
    .restart local v6  # "systemApp":Z
    :cond_569
    move/from16 v22, v6

    .end local v6  # "systemApp":Z
    .restart local v22  # "systemApp":Z
    move-object v13, v5

    .line 18216
    .end local v5  # "pkgName":Ljava/lang/String;
    .local v13, "pkgName":Ljava/lang/String;
    :goto_56c
    :try_start_56c
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v13}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;
    :try_end_576
    .catchall {:try_start_56c .. :try_end_576} :catchall_10b1

    .line 18217
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v5, :cond_6cc

    .line 18218
    :try_start_578
    sget-boolean v10, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z
    :try_end_57a
    .catchall {:try_start_578 .. :try_end_57a} :catchall_6bb

    if-eqz v10, :cond_5a2

    :try_start_57c
    const-string v10, "PackageManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Existing package: "

    invoke-virtual {v11, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v11, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_592
    .catchall {:try_start_57c .. :try_end_592} :catchall_593

    goto :goto_5a2

    .line 18353
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_593
    move-exception v0

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object v5, v13

    move-object/from16 v45, v14

    move-object/from16 v32, v15

    move/from16 v6, v22

    goto/16 :goto_10c3

    .line 18224
    .restart local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_5a2
    :goto_5a2
    move-object v6, v5

    .line 18225
    .local v6, "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    :try_start_5a3
    iget-object v10, v14, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v10}, Landroid/content/pm/ApplicationInfo;->isStaticSharedLibrary()Z

    move-result v10
    :try_end_5a9
    .catchall {:try_start_5a3 .. :try_end_5a9} :catchall_6bb

    if-eqz v10, :cond_5c1

    .line 18226
    :try_start_5ab
    invoke-direct {v1, v14}, Lcom/android/server/pm/PackageManagerService;->getLatestSharedLibraVersionLPr(Landroid/content/pm/PackageParser$Package;)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v10

    .line 18227
    .local v10, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v10, :cond_5be

    .line 18228
    iget-object v11, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    move-object/from16 v32, v6

    .end local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .local v32, "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v10}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v11, v6}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v6
    :try_end_5bd
    .catchall {:try_start_5ab .. :try_end_5bd} :catchall_593

    .end local v32  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    goto :goto_5c5

    .line 18227
    :cond_5be
    move-object/from16 v32, v6

    .end local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .restart local v32  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    goto :goto_5c3

    .line 18225
    .end local v10  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v32  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    :cond_5c1
    move-object/from16 v32, v6

    .line 18235
    .end local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .restart local v32  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    :goto_5c3
    move-object/from16 v6, v32

    .end local v32  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    :goto_5c5
    :try_start_5c5
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v10, v10, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 18236
    .local v10, "ksms":Lcom/android/server/pm/KeySetManagerService;
    invoke-virtual {v10, v6, v8}, Lcom/android/server/pm/KeySetManagerService;->shouldCheckUpgradeKeySetLocked(Lcom/android/server/pm/PackageSettingBase;I)Z

    move-result v11
    :try_end_5cd
    .catchall {:try_start_5c5 .. :try_end_5cd} :catchall_6bb

    if-eqz v11, :cond_629

    .line 18237
    :try_start_5cf
    invoke-virtual {v10, v6, v14}, Lcom/android/server/pm/KeySetManagerService;->checkUpgradeKeySetLocked(Lcom/android/server/pm/PackageSettingBase;Landroid/content/pm/PackageParser$Package;)Z

    move-result v11

    if-eqz v11, :cond_5dd

    move/from16 v33, v4

    move/from16 v34, v7

    move-object/from16 v32, v15

    goto/16 :goto_653

    .line 18238
    :cond_5dd
    new-instance v11, Lcom/android/server/pm/PackageManagerService$PrepareFailure;
    :try_end_5df
    .catchall {:try_start_5cf .. :try_end_5df} :catchall_61a

    move-object/from16 v32, v15

    .end local v15  # "installerPackageName":Ljava/lang/String;
    .local v32, "installerPackageName":Ljava/lang/String;
    :try_start_5e1
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V
    :try_end_5e6
    .catchall {:try_start_5e1 .. :try_end_5e6} :catchall_60d

    move/from16 v33, v4

    .end local v4  # "installFlags":I
    .local v33, "installFlags":I
    :try_start_5e8
    const-string v4, "Package "

    invoke-virtual {v15, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v15, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " upgrade keys do not match the previously installed version"

    invoke-virtual {v15, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    const/4 v15, -0x7

    invoke-direct {v11, v15, v4}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v7  # "replace":Z
    .end local v8  # "scanFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v22  # "systemApp":Z
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "installFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v11
    :try_end_600
    .catchall {:try_start_5e8 .. :try_end_600} :catchall_600

    .line 18353
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .end local v10  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v7  # "replace":Z
    .restart local v8  # "scanFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v22  # "systemApp":Z
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "installFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_600
    move-exception v0

    move-object v2, v0

    move/from16 v43, v12

    move-object v5, v13

    move-object/from16 v45, v14

    move/from16 v6, v22

    move/from16 v42, v33

    goto/16 :goto_10c3

    .end local v33  # "installFlags":I
    .restart local v4  # "installFlags":I
    :catchall_60d
    move-exception v0

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object v5, v13

    move-object/from16 v45, v14

    move/from16 v6, v22

    .end local v4  # "installFlags":I
    .restart local v33  # "installFlags":I
    goto/16 :goto_10c3

    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "installFlags":I
    .restart local v4  # "installFlags":I
    .restart local v15  # "installerPackageName":Ljava/lang/String;
    :catchall_61a
    move-exception v0

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object v5, v13

    move-object/from16 v45, v14

    move-object/from16 v32, v15

    move/from16 v6, v22

    .end local v4  # "installFlags":I
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "installFlags":I
    goto/16 :goto_10c3

    .line 18244
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "installFlags":I
    .restart local v4  # "installFlags":I
    .restart local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .restart local v10  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v15  # "installerPackageName":Ljava/lang/String;
    :cond_629
    move/from16 v33, v4

    move-object/from16 v32, v15

    .end local v4  # "installFlags":I
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "installFlags":I
    :try_start_62d
    invoke-direct {v1, v14}, Lcom/android/server/pm/PackageManagerService;->isCompatSignatureUpdateNeeded(Landroid/content/pm/PackageParser$Package;)Z

    move-result v4

    .line 18245
    .local v4, "compareCompat":Z
    invoke-direct {v1, v14}, Lcom/android/server/pm/PackageManagerService;->isRecoverSignatureUpdateNeeded(Landroid/content/pm/PackageParser$Package;)Z

    move-result v11

    .line 18247
    .local v11, "compareRecover":Z
    iget-object v15, v14, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;
    :try_end_637
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_62d .. :try_end_637} :catch_69c
    .catchall {:try_start_62d .. :try_end_637} :catchall_68d

    move/from16 v34, v7

    const/4 v7, 0x0

    .end local v7  # "replace":Z
    .local v34, "replace":Z
    :try_start_63a
    invoke-static {v6, v7, v15, v4, v11}, Lcom/android/server/pm/PackageManagerServiceUtils;->verifySignatures(Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$SigningDetails;ZZ)Z

    move-result v15

    .line 18251
    .local v15, "compatMatch":Z
    if-eqz v15, :cond_650

    .line 18252
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v7
    :try_end_643
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_63a .. :try_end_643} :catch_68a
    .catchall {:try_start_63a .. :try_end_643} :catchall_6ac

    .line 18253
    move/from16 v35, v4

    .end local v4  # "compareCompat":Z
    .local v35, "compareCompat":Z
    :try_start_645
    iget-object v4, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v10, v4}, Lcom/android/server/pm/KeySetManagerService;->removeAppKeySetDataLPw(Ljava/lang/String;)V

    .line 18254
    monitor-exit v7

    goto :goto_652

    :catchall_64c
    move-exception v0

    move-object v4, v0

    monitor-exit v7
    :try_end_64f
    .catchall {:try_start_645 .. :try_end_64f} :catchall_64c

    .end local v8  # "scanFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v22  # "systemApp":Z
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "installFlags":I
    .end local v34  # "replace":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :try_start_64f
    throw v4
    :try_end_650
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_64f .. :try_end_650} :catch_68a
    .catchall {:try_start_64f .. :try_end_650} :catchall_6ac

    .line 18251
    .end local v35  # "compareCompat":Z
    .restart local v4  # "compareCompat":Z
    .restart local v8  # "scanFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v22  # "systemApp":Z
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "installFlags":I
    .restart local v34  # "replace":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :cond_650
    move/from16 v35, v4

    .line 18258
    .end local v4  # "compareCompat":Z
    .end local v11  # "compareRecover":Z
    .end local v15  # "compatMatch":Z
    :goto_652
    nop

    .line 18261
    :goto_653
    :try_start_653
    iget-object v4, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v4, :cond_66b

    iget-object v4, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    if-eqz v4, :cond_66b

    .line 18262
    iget-object v4, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I
    :try_end_663
    .catchall {:try_start_653 .. :try_end_663} :catchall_6ac

    const/4 v7, 0x1

    and-int/2addr v4, v7

    if-eqz v4, :cond_669

    const/4 v4, 0x1

    goto :goto_66a

    :cond_669
    const/4 v4, 0x0

    .end local v22  # "systemApp":Z
    .local v4, "systemApp":Z
    :goto_66a
    goto :goto_66d

    .line 18265
    .end local v4  # "systemApp":Z
    .restart local v22  # "systemApp":Z
    :cond_66b
    move/from16 v4, v22

    .end local v22  # "systemApp":Z
    .restart local v4  # "systemApp":Z
    :goto_66d
    :try_start_66d
    sget-object v7, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v7}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v7

    const/4 v11, 0x1

    invoke-virtual {v5, v7, v11}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v7

    iput-object v7, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origUsers:[I
    :try_end_67a
    .catchall {:try_start_66d .. :try_end_67a} :catchall_67c

    goto/16 :goto_6d4

    .line 18353
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .end local v10  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :catchall_67c
    move-exception v0

    move-object v2, v0

    move v6, v4

    move/from16 v43, v12

    move-object v5, v13

    move-object/from16 v45, v14

    move/from16 v42, v33

    move/from16 v7, v34

    goto/16 :goto_10c3

    .line 18256
    .end local v4  # "systemApp":Z
    .restart local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .restart local v10  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v22  # "systemApp":Z
    :catch_68a
    move-exception v0

    move-object v4, v0

    goto :goto_6a0

    .line 18353
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .end local v10  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v34  # "replace":Z
    .restart local v7  # "replace":Z
    :catchall_68d
    move-exception v0

    move/from16 v34, v7

    move-object v2, v0

    move/from16 v43, v12

    move-object v5, v13

    move-object/from16 v45, v14

    move/from16 v6, v22

    move/from16 v42, v33

    .end local v7  # "replace":Z
    .restart local v34  # "replace":Z
    goto/16 :goto_10c3

    .line 18256
    .end local v34  # "replace":Z
    .restart local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "replace":Z
    .restart local v10  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :catch_69c
    move-exception v0

    move/from16 v34, v7

    move-object v4, v0

    .line 18257
    .end local v7  # "replace":Z
    .local v4, "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v34  # "replace":Z
    :goto_6a0
    :try_start_6a0
    new-instance v7, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    iget v11, v4, Lcom/android/server/pm/PackageManagerException;->error:I

    invoke-virtual {v4}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v15

    invoke-direct {v7, v11, v15}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v8  # "scanFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v22  # "systemApp":Z
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "installFlags":I
    .end local v34  # "replace":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v7
    :try_end_6ac
    .catchall {:try_start_6a0 .. :try_end_6ac} :catchall_6ac

    .line 18353
    .end local v4  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .end local v10  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v8  # "scanFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v22  # "systemApp":Z
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "installFlags":I
    .restart local v34  # "replace":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_6ac
    move-exception v0

    move-object v2, v0

    move/from16 v43, v12

    move-object v5, v13

    move-object/from16 v45, v14

    move/from16 v6, v22

    move/from16 v42, v33

    move/from16 v7, v34

    goto/16 :goto_10c3

    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "installFlags":I
    .end local v34  # "replace":Z
    .local v4, "installFlags":I
    .restart local v7  # "replace":Z
    .local v15, "installerPackageName":Ljava/lang/String;
    :catchall_6bb
    move-exception v0

    move/from16 v34, v7

    move-object v2, v0

    move/from16 v42, v4

    move/from16 v43, v12

    move-object v5, v13

    move-object/from16 v45, v14

    move-object/from16 v32, v15

    move/from16 v6, v22

    .end local v4  # "installFlags":I
    .end local v7  # "replace":Z
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "installFlags":I
    .restart local v34  # "replace":Z
    goto/16 :goto_10c3

    .line 18217
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "installFlags":I
    .end local v34  # "replace":Z
    .restart local v4  # "installFlags":I
    .restart local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "replace":Z
    .restart local v15  # "installerPackageName":Ljava/lang/String;
    :cond_6cc
    move/from16 v33, v4

    move/from16 v34, v7

    move-object/from16 v32, v15

    .end local v4  # "installFlags":I
    .end local v7  # "replace":Z
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "installFlags":I
    .restart local v34  # "replace":Z
    move/from16 v4, v22

    .line 18269
    .end local v22  # "systemApp":Z
    .local v4, "systemApp":Z
    :goto_6d4
    :try_start_6d4
    iget-object v6, v14, Landroid/content/pm/PackageParser$Package;->permissions:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6
    :try_end_6da
    .catchall {:try_start_6d4 .. :try_end_6da} :catchall_109c

    .line 18270
    .local v6, "N":I
    add-int/lit8 v7, v6, -0x1

    .local v7, "i":I
    :goto_6dc
    if-ltz v7, :cond_871

    .line 18271
    :try_start_6de
    iget-object v10, v14, Landroid/content/pm/PackageParser$Package;->permissions:Ljava/util/ArrayList;

    invoke-virtual {v10, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Landroid/content/pm/PackageParser$Permission;

    .line 18272
    .local v10, "perm":Landroid/content/pm/PackageParser$Permission;
    iget-object v11, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v15, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    iget-object v15, v15, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 18273
    invoke-virtual {v11, v15}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getPermissionTEMP(Ljava/lang/String;)Lcom/android/server/pm/permission/BasePermission;

    move-result-object v11

    .line 18276
    .local v11, "bp":Lcom/android/server/pm/permission/BasePermission;
    iget-object v15, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    iget v15, v15, Landroid/content/pm/PermissionInfo;->protectionLevel:I
    :try_end_6f4
    .catchall {:try_start_6de .. :try_end_6f4} :catchall_860

    and-int/lit16 v15, v15, 0x1000

    if-eqz v15, :cond_730

    if-nez v4, :cond_730

    .line 18278
    :try_start_6fa
    const-string v15, "PackageManager"

    move-object/from16 v35, v5

    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v35, "ps":Lcom/android/server/pm/PackageSetting;
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v22, v6

    .end local v6  # "N":I
    .local v22, "N":I
    const-string v6, "Non-System package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " attempting to delcare ephemeral permission "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    iget-object v6, v6, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, "; Removing ephemeral."

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v15, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18281
    iget-object v5, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    iget v6, v5, Landroid/content/pm/PermissionInfo;->protectionLevel:I

    and-int/lit16 v6, v6, -0x1001

    iput v6, v5, Landroid/content/pm/PermissionInfo;->protectionLevel:I
    :try_end_72f
    .catchall {:try_start_6fa .. :try_end_72f} :catchall_67c

    goto :goto_734

    .line 18276
    .end local v22  # "N":I
    .end local v35  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "N":I
    :cond_730
    move-object/from16 v35, v5

    move/from16 v22, v6

    .line 18285
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "N":I
    .restart local v22  # "N":I
    .restart local v35  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_734
    if-eqz v11, :cond_852

    .line 18290
    :try_start_736
    invoke-virtual {v11}, Lcom/android/server/pm/permission/BasePermission;->getSourcePackageName()Ljava/lang/String;

    move-result-object v5

    .line 18291
    .local v5, "sourcePackageName":Ljava/lang/String;
    invoke-virtual {v11}, Lcom/android/server/pm/permission/BasePermission;->getSourcePackageSetting()Lcom/android/server/pm/PackageSettingBase;

    move-result-object v6

    .line 18292
    .local v6, "sourcePackageSetting":Lcom/android/server/pm/PackageSettingBase;
    iget-object v15, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v15, v15, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 18293
    .local v15, "ksms":Lcom/android/server/pm/KeySetManagerService;
    iget-object v3, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3
    :try_end_748
    .catchall {:try_start_736 .. :try_end_748} :catchall_860

    if-eqz v3, :cond_759

    .line 18294
    :try_start_74a
    invoke-virtual {v15, v6, v8}, Lcom/android/server/pm/KeySetManagerService;->shouldCheckUpgradeKeySetLocked(Lcom/android/server/pm/PackageSettingBase;I)Z

    move-result v3

    if-eqz v3, :cond_759

    .line 18296
    invoke-virtual {v15, v6, v14}, Lcom/android/server/pm/KeySetManagerService;->checkUpgradeKeySetLocked(Lcom/android/server/pm/PackageSettingBase;Landroid/content/pm/PackageParser$Package;)Z

    move-result v3
    :try_end_754
    .catchall {:try_start_74a .. :try_end_754} :catchall_67c

    move-object/from16 v37, v13

    move-object/from16 v36, v15

    .local v3, "sigsOk":Z
    goto :goto_781

    .line 18302
    .end local v3  # "sigsOk":Z
    :cond_759
    :try_start_759
    iget-object v3, v6, Lcom/android/server/pm/PackageSettingBase;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v3, v3, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    move-object/from16 v36, v15

    .end local v15  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .local v36, "ksms":Lcom/android/server/pm/KeySetManagerService;
    iget-object v15, v14, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;
    :try_end_761
    .catchall {:try_start_759 .. :try_end_761} :catchall_860

    move-object/from16 v37, v13

    .end local v13  # "pkgName":Ljava/lang/String;
    .local v37, "pkgName":Ljava/lang/String;
    const/4 v13, 0x4

    :try_start_764
    invoke-virtual {v3, v15, v13}, Landroid/content/pm/PackageParser$SigningDetails;->checkCapability(Landroid/content/pm/PackageParser$SigningDetails;I)Z

    move-result v3

    if-eqz v3, :cond_76c

    .line 18305
    const/4 v3, 0x1

    .restart local v3  # "sigsOk":Z
    goto :goto_781

    .line 18306
    .end local v3  # "sigsOk":Z
    :cond_76c
    iget-object v3, v14, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v15, v6, Lcom/android/server/pm/PackageSettingBase;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v15, v15, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    invoke-virtual {v3, v15, v13}, Landroid/content/pm/PackageParser$SigningDetails;->checkCapability(Landroid/content/pm/PackageParser$SigningDetails;I)Z

    move-result v3

    if-eqz v3, :cond_780

    .line 18312
    iget-object v3, v6, Lcom/android/server/pm/PackageSettingBase;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v13, v14, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iput-object v13, v3, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    .line 18313
    const/4 v3, 0x1

    .restart local v3  # "sigsOk":Z
    goto :goto_781

    .line 18315
    .end local v3  # "sigsOk":Z
    :cond_780
    const/4 v3, 0x0

    .line 18318
    .restart local v3  # "sigsOk":Z
    :goto_781
    if-nez v3, :cond_7f6

    .line 18322
    const-string v13, "android"

    invoke-virtual {v5, v13}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v13

    if-eqz v13, :cond_7bd

    .line 18331
    const-string v13, "PackageManager"

    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v38, v3

    .end local v3  # "sigsOk":Z
    .local v38, "sigsOk":Z
    const-string v3, "Package "

    invoke-virtual {v15, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v15, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " attempting to redeclare system permission "

    invoke-virtual {v15, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    iget-object v3, v3, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    invoke-virtual {v15, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, "; ignoring new declaration"

    invoke-virtual {v15, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v13, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18334
    iget-object v3, v14, Landroid/content/pm/PackageParser$Package;->permissions:Ljava/util/ArrayList;

    invoke-virtual {v3, v7}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto/16 :goto_854

    .line 18323
    .end local v38  # "sigsOk":Z
    .restart local v3  # "sigsOk":Z
    :cond_7bd
    move/from16 v38, v3

    .end local v3  # "sigsOk":Z
    .restart local v38  # "sigsOk":Z
    new-instance v3, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Package "

    invoke-virtual {v15, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v15, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v13, " attempting to redeclare permission "

    invoke-virtual {v15, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    iget-object v13, v13, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    invoke-virtual {v15, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v13, " already owned by "

    invoke-virtual {v15, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    const/16 v15, -0x70

    invoke-direct {v3, v15, v13}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    iget-object v13, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    iget-object v13, v13, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 18328
    invoke-virtual {v3, v13, v5}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;->conflictsWithExistingPermission(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    move-result-object v3

    .end local v4  # "systemApp":Z
    .end local v8  # "scanFlags":I
    .end local v12  # "onExternal":Z
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "installFlags":I
    .end local v34  # "replace":Z
    .end local v37  # "pkgName":Ljava/lang/String;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v3

    .line 18336
    .end local v38  # "sigsOk":Z
    .restart local v3  # "sigsOk":Z
    .restart local v4  # "systemApp":Z
    .restart local v8  # "scanFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "installFlags":I
    .restart local v34  # "replace":Z
    .restart local v37  # "pkgName":Ljava/lang/String;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :cond_7f6
    move/from16 v38, v3

    .end local v3  # "sigsOk":Z
    .restart local v38  # "sigsOk":Z
    const-string v3, "android"

    iget-object v13, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v13}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_854

    .line 18341
    iget-object v3, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    iget v3, v3, Landroid/content/pm/PermissionInfo;->protectionLevel:I

    and-int/lit8 v3, v3, 0xf

    const/4 v13, 0x1

    if-ne v3, v13, :cond_854

    .line 18343
    invoke-virtual {v11}, Lcom/android/server/pm/permission/BasePermission;->isRuntime()Z

    move-result v3

    if-nez v3, :cond_854

    .line 18344
    const-string v3, "PackageManager"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Package "

    invoke-virtual {v13, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v15, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v13, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, " trying to change a non-runtime permission "

    invoke-virtual {v13, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v15, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    iget-object v15, v15, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    invoke-virtual {v13, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, " to runtime; keeping old protection level"

    invoke-virtual {v13, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-static {v3, v13}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18347
    iget-object v3, v10, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;

    invoke-virtual {v11}, Lcom/android/server/pm/permission/BasePermission;->getProtectionLevel()I

    move-result v13

    iput v13, v3, Landroid/content/pm/PermissionInfo;->protectionLevel:I
    :try_end_842
    .catchall {:try_start_764 .. :try_end_842} :catchall_843

    goto :goto_854

    .line 18353
    .end local v5  # "sourcePackageName":Ljava/lang/String;
    .end local v6  # "sourcePackageSetting":Lcom/android/server/pm/PackageSettingBase;
    .end local v7  # "i":I
    .end local v10  # "perm":Landroid/content/pm/PackageParser$Permission;
    .end local v11  # "bp":Lcom/android/server/pm/permission/BasePermission;
    .end local v22  # "N":I
    .end local v35  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v36  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v38  # "sigsOk":Z
    :catchall_843
    move-exception v0

    move-object v2, v0

    move v6, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move/from16 v42, v33

    move/from16 v7, v34

    move-object/from16 v5, v37

    goto/16 :goto_10c3

    .line 18285
    .end local v37  # "pkgName":Ljava/lang/String;
    .restart local v7  # "i":I
    .restart local v10  # "perm":Landroid/content/pm/PackageParser$Permission;
    .restart local v11  # "bp":Lcom/android/server/pm/permission/BasePermission;
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v22  # "N":I
    .restart local v35  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_852
    move-object/from16 v37, v13

    .line 18270
    .end local v10  # "perm":Landroid/content/pm/PackageParser$Permission;
    .end local v11  # "bp":Lcom/android/server/pm/permission/BasePermission;
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v37  # "pkgName":Ljava/lang/String;
    :cond_854
    :goto_854
    add-int/lit8 v7, v7, -0x1

    move-object/from16 v3, p2

    move/from16 v6, v22

    move-object/from16 v5, v35

    move-object/from16 v13, v37

    goto/16 :goto_6dc

    .line 18353
    .end local v7  # "i":I
    .end local v22  # "N":I
    .end local v35  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v37  # "pkgName":Ljava/lang/String;
    .restart local v13  # "pkgName":Ljava/lang/String;
    :catchall_860
    move-exception v0

    move-object/from16 v37, v13

    move-object v2, v0

    move v6, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move/from16 v42, v33

    move/from16 v7, v34

    move-object/from16 v5, v37

    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v37  # "pkgName":Ljava/lang/String;
    goto/16 :goto_10c3

    .line 18270
    .end local v37  # "pkgName":Ljava/lang/String;
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    .local v6, "N":I
    .restart local v7  # "i":I
    .restart local v13  # "pkgName":Ljava/lang/String;
    :cond_871
    move-object/from16 v35, v5

    move/from16 v22, v6

    move-object/from16 v37, v13

    .line 18353
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "N":I
    .end local v7  # "i":I
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v37  # "pkgName":Ljava/lang/String;
    :try_start_877
    monitor-exit v9
    :try_end_878
    .catchall {:try_start_877 .. :try_end_878} :catchall_1087

    .line 18355
    if-eqz v4, :cond_893

    .line 18356
    if-nez v12, :cond_889

    .line 18360
    if-nez v23, :cond_87f

    goto :goto_893

    .line 18362
    :cond_87f
    new-instance v3, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const-string v5, "Cannot update a system app with an instant app"

    const/16 v6, -0x74

    invoke-direct {v3, v6, v5}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v3

    .line 18358
    :cond_889
    new-instance v3, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const/16 v5, -0x13

    const-string v6, "Cannot install updates to system apps on sdcard"

    invoke-direct {v3, v5, v6}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v3

    .line 18367
    :cond_893
    :goto_893
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->move:Lcom/android/server/pm/PackageManagerService$MoveInfo;

    const/16 v5, -0x6e

    if-eqz v3, :cond_8e5

    .line 18369
    const/4 v3, 0x1

    or-int/lit8 v6, v8, 0x1

    .line 18370
    .end local v8  # "scanFlags":I
    .local v6, "scanFlags":I
    or-int/lit16 v3, v6, 0x100

    .line 18372
    .end local v6  # "scanFlags":I
    .local v3, "scanFlags":I
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6

    .line 18373
    :try_start_8a1
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;
    :try_end_8a5
    .catchall {:try_start_8a1 .. :try_end_8a5} :catchall_8da

    move-object/from16 v13, v37

    .end local v37  # "pkgName":Ljava/lang/String;
    .restart local v13  # "pkgName":Ljava/lang/String;
    :try_start_8a7
    invoke-virtual {v7, v13}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 18374
    .local v7, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v7, :cond_8c6

    .line 18375
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Missing settings for moved package "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8
    :try_end_8c0
    .catchall {:try_start_8a7 .. :try_end_8c0} :catchall_8d6

    move-object/from16 v15, p2

    :try_start_8c2
    invoke-virtual {v15, v5, v8}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setError(ILjava/lang/String;)V

    goto :goto_8c8

    .line 18374
    :cond_8c6
    move-object/from16 v15, p2

    .line 18381
    :goto_8c8
    iget-object v8, v14, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v9, v7, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    iput-object v9, v8, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 18382
    iget-object v8, v14, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v9, v7, Lcom/android/server/pm/PackageSetting;->secondaryCpuAbiString:Ljava/lang/String;

    iput-object v9, v8, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    .line 18383
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    monitor-exit v6

    goto :goto_916

    :catchall_8d6
    move-exception v0

    move-object/from16 v15, p2

    goto :goto_8e3

    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v37  # "pkgName":Ljava/lang/String;
    :catchall_8da
    move-exception v0

    move-object/from16 v15, p2

    move-object/from16 v13, v37

    move-object v5, v0

    .end local v37  # "pkgName":Ljava/lang/String;
    .restart local v13  # "pkgName":Ljava/lang/String;
    :goto_8e0
    monitor-exit v6
    :try_end_8e1
    .catchall {:try_start_8c2 .. :try_end_8e1} :catchall_8e2

    throw v5

    :catchall_8e2
    move-exception v0

    :goto_8e3
    move-object v5, v0

    goto :goto_8e0

    .line 18387
    .end local v3  # "scanFlags":I
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v8  # "scanFlags":I
    .restart local v37  # "pkgName":Ljava/lang/String;
    :cond_8e5
    move-object/from16 v15, p2

    move-object/from16 v13, v37

    .end local v37  # "pkgName":Ljava/lang/String;
    .restart local v13  # "pkgName":Ljava/lang/String;
    const/4 v3, 0x1

    or-int/lit8 v6, v8, 0x1

    .line 18390
    .end local v8  # "scanFlags":I
    .restart local v6  # "scanFlags":I
    :try_start_8ec
    iget-object v3, v14, Landroid/content/pm/PackageParser$Package;->cpuAbiOverride:Ljava/lang/String;

    invoke-static {v3}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v3
    :try_end_8f2
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_8ec .. :try_end_8f2} :catch_106a

    if-eqz v3, :cond_907

    .line 18391
    :try_start_8f4
    iget-object v3, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->abiOverride:Ljava/lang/String;
    :try_end_8f6
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_8f4 .. :try_end_8f6} :catch_8f7

    goto :goto_909

    .line 18394
    :catch_8f7
    move-exception v0

    move-object v2, v0

    move/from16 v35, v4

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    move/from16 v42, v33

    move/from16 v39, v34

    goto/16 :goto_1078

    .line 18391
    :cond_907
    :try_start_907
    iget-object v3, v14, Landroid/content/pm/PackageParser$Package;->cpuAbiOverride:Ljava/lang/String;

    .line 18392
    .local v3, "abiOverride":Ljava/lang/String;
    :goto_909
    invoke-virtual {v14}, Landroid/content/pm/PackageParser$Package;->isLibrary()Z

    move-result v7

    if-nez v7, :cond_911

    const/4 v7, 0x1

    goto :goto_912

    :cond_911
    const/4 v7, 0x0

    .line 18393
    .local v7, "extractNativeLibs":Z
    :goto_912
    invoke-static {v14, v3, v7}, Lcom/android/server/pm/PackageManagerService;->derivePackageAbi(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;Z)V
    :try_end_915
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_907 .. :try_end_915} :catch_106a

    .line 18398
    .end local v3  # "abiOverride":Ljava/lang/String;
    .end local v7  # "extractNativeLibs":Z
    move v3, v6

    .line 18401
    .end local v6  # "scanFlags":I
    .local v3, "scanFlags":I
    :goto_916
    iget v6, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    invoke-virtual {v2, v6, v14}, Lcom/android/server/pm/PackageManagerService$InstallArgs;->doRename(ILandroid/content/pm/PackageParser$Package;)Z

    move-result v6

    if-eqz v6, :cond_105d

    .line 18406
    :try_start_91e
    invoke-direct {v1, v14}, Lcom/android/server/pm/PackageManagerService;->setUpFsVerityIfPossible(Landroid/content/pm/PackageParser$Package;)V
    :try_end_921
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_91e .. :try_end_921} :catch_1036
    .catch Ljava/io/IOException; {:try_start_91e .. :try_end_921} :catch_1036
    .catch Ljava/security/DigestException; {:try_start_91e .. :try_end_921} :catch_1036
    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_91e .. :try_end_921} :catch_1036

    .line 18410
    nop

    .line 18412
    if-nez v23, :cond_930

    .line 18413
    iget-object v5, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;

    invoke-virtual {v5}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v5

    move/from16 v7, v34

    .end local v34  # "replace":Z
    .local v7, "replace":Z
    invoke-direct {v1, v5, v7, v14}, Lcom/android/server/pm/PackageManagerService;->startIntentFilterVerifications(IZLandroid/content/pm/PackageParser$Package;)V

    goto :goto_94c

    .line 18415
    .end local v7  # "replace":Z
    .restart local v34  # "replace":Z
    :cond_930
    move/from16 v7, v34

    .end local v34  # "replace":Z
    .restart local v7  # "replace":Z
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v5, :cond_94c

    .line 18416
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Not verifying instant app install for app links: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v6, "PackageManager"

    invoke-static {v6, v5}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 18419
    :cond_94c
    :goto_94c
    nop

    .line 18420
    const-string/jumbo v5, "installPackageLI"

    move/from16 v11, v33

    .end local v33  # "installFlags":I
    .local v11, "installFlags":I
    invoke-virtual {v1, v13, v11, v5}, Lcom/android/server/pm/PackageManagerService;->freezePackageForInstall(Ljava/lang/String;ILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v33

    .line 18421
    .local v33, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    const/4 v5, 0x1

    .line 18424
    .local v5, "shouldCloseFreezerBeforeReturn":Z
    const/4 v6, 0x0

    .line 18425
    .local v6, "renamedPackage":Ljava/lang/String;
    const/4 v8, 0x0

    .line 18426
    .local v8, "sysPkg":Z
    move-object/from16 v9, v28

    .line 18427
    .local v9, "targetVolumeUuid":Ljava/lang/String;
    move/from16 v22, v3

    .line 18428
    .local v22, "targetScanFlags":I
    move/from16 v34, v27

    .line 18432
    .local v34, "targetParseFlags":I
    if-eqz v7, :cond_f03

    .line 18433
    const/4 v9, 0x0

    .line 18434
    :try_start_962
    iget-object v10, v14, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v10}, Landroid/content/pm/ApplicationInfo;->isStaticSharedLibrary()Z

    move-result v10
    :try_end_968
    .catchall {:try_start_962 .. :try_end_968} :catchall_eef

    if-eqz v10, :cond_9cf

    .line 18439
    :try_start_96a
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;
    :try_end_96c
    .catchall {:try_start_96a .. :try_end_96c} :catchall_9bb

    move/from16 v35, v4

    .end local v4  # "systemApp":Z
    .local v35, "systemApp":Z
    :try_start_96e
    iget-object v4, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v10, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/PackageParser$Package;

    .line 18440
    .local v4, "existingPkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v4, :cond_9a4

    .line 18441
    invoke-virtual {v4}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v36

    invoke-virtual {v14}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v38

    cmp-long v10, v36, v38

    if-nez v10, :cond_987

    move/from16 v37, v5

    goto :goto_9d3

    .line 18442
    :cond_987
    new-instance v10, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    move-object/from16 v36, v4

    .end local v4  # "existingPkg":Landroid/content/pm/PackageParser$Package;
    .local v36, "existingPkg":Landroid/content/pm/PackageParser$Package;
    const-string v4, "Packages declaring static-shared libs cannot be updated"
    :try_end_98d
    .catchall {:try_start_96e .. :try_end_98d} :catchall_9a9

    move/from16 v37, v5

    const/4 v5, -0x5

    .end local v5  # "shouldCloseFreezerBeforeReturn":Z
    .local v37, "shouldCloseFreezerBeforeReturn":Z
    :try_start_990
    invoke-direct {v10, v5, v4}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v3  # "scanFlags":I
    .end local v7  # "replace":Z
    .end local v11  # "installFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v10
    :try_end_994
    .catchall {:try_start_990 .. :try_end_994} :catchall_994

    .line 18694
    .end local v6  # "renamedPackage":Ljava/lang/String;
    .end local v8  # "sysPkg":Z
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .end local v22  # "targetScanFlags":I
    .end local v34  # "targetParseFlags":I
    .end local v36  # "existingPkg":Landroid/content/pm/PackageParser$Package;
    .restart local v3  # "scanFlags":I
    .restart local v7  # "replace":Z
    .restart local v11  # "installFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v35  # "systemApp":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_994
    move-exception v0

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v39, v7

    move/from16 v42, v11

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    goto/16 :goto_1030

    .line 18440
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v4  # "existingPkg":Landroid/content/pm/PackageParser$Package;
    .restart local v5  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v6  # "renamedPackage":Ljava/lang/String;
    .restart local v8  # "sysPkg":Z
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v22  # "targetScanFlags":I
    .restart local v34  # "targetParseFlags":I
    :cond_9a4
    move-object/from16 v36, v4

    move/from16 v37, v5

    .end local v4  # "existingPkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v36  # "existingPkg":Landroid/content/pm/PackageParser$Package;
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    goto :goto_9d3

    .line 18694
    .end local v6  # "renamedPackage":Ljava/lang/String;
    .end local v8  # "sysPkg":Z
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .end local v22  # "targetScanFlags":I
    .end local v34  # "targetParseFlags":I
    .end local v36  # "existingPkg":Landroid/content/pm/PackageParser$Package;
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v5  # "shouldCloseFreezerBeforeReturn":Z
    :catchall_9a9
    move-exception v0

    move/from16 v37, v5

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v39, v7

    move/from16 v42, v11

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    .end local v5  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    goto/16 :goto_1030

    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .local v4, "systemApp":Z
    .restart local v5  # "shouldCloseFreezerBeforeReturn":Z
    :catchall_9bb
    move-exception v0

    move/from16 v35, v4

    move/from16 v37, v5

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v39, v7

    move/from16 v42, v11

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    .end local v4  # "systemApp":Z
    .end local v5  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v35  # "systemApp":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    goto/16 :goto_1030

    .line 18434
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v4  # "systemApp":Z
    .restart local v5  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v6  # "renamedPackage":Ljava/lang/String;
    .restart local v8  # "sysPkg":Z
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v22  # "targetScanFlags":I
    .restart local v34  # "targetParseFlags":I
    :cond_9cf
    move/from16 v35, v4

    move/from16 v37, v5

    .line 18448
    .end local v4  # "systemApp":Z
    .end local v5  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v35  # "systemApp":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    :goto_9d3
    and-int/lit16 v4, v3, 0x4000

    if-eqz v4, :cond_9d9

    const/4 v4, 0x1

    goto :goto_9da

    :cond_9d9
    const/4 v4, 0x0

    .line 18451
    .local v4, "isInstantApp":Z
    :goto_9da
    :try_start_9da
    iget-object v5, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 18455
    .local v5, "pkgName11":Ljava/lang/String;
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v10
    :try_end_9df
    .catchall {:try_start_9da .. :try_end_9df} :catchall_edf

    .line 18456
    move-object/from16 v36, v6

    .end local v6  # "renamedPackage":Ljava/lang/String;
    .local v36, "renamedPackage":Ljava/lang/String;
    :try_start_9e1
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v6, v5}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/PackageParser$Package;

    .line 18457
    .local v6, "oldPackage":Landroid/content/pm/PackageParser$Package;
    move-object/from16 v38, v6

    .line 18458
    .local v38, "existingPackage":Landroid/content/pm/PackageParser$Package;
    sget-boolean v39, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z
    :try_end_9ed
    .catchall {:try_start_9e1 .. :try_end_9ed} :catchall_eba

    if-eqz v39, :cond_a4b

    .line 18459
    move/from16 v39, v7

    .end local v7  # "replace":Z
    .local v39, "replace":Z
    :try_start_9f1
    const-string v7, "PackageManager"
    :try_end_9f3
    .catchall {:try_start_9f1 .. :try_end_9f3} :catchall_a37

    move/from16 v40, v8

    .end local v8  # "sysPkg":Z
    .local v40, "sysPkg":Z
    :try_start_9f5
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V
    :try_end_9fa
    .catchall {:try_start_9f5 .. :try_end_9fa} :catchall_a25

    move-object/from16 v41, v9

    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .local v41, "targetVolumeUuid":Ljava/lang/String;
    :try_start_9fc
    const-string/jumbo v9, "replacePackageLI: new="

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v9, ", old="

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_a14
    .catchall {:try_start_9fc .. :try_end_a14} :catchall_a15

    goto :goto_a51

    .line 18545
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    :catchall_a15
    move-exception v0

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move/from16 v44, v11

    move/from16 v18, v12

    move-object/from16 v45, v13

    goto/16 :goto_ece

    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    :catchall_a25
    move-exception v0

    move-object/from16 v41, v9

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move/from16 v44, v11

    move/from16 v18, v12

    move-object/from16 v45, v13

    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    goto/16 :goto_ece

    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v8  # "sysPkg":Z
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    :catchall_a37
    move-exception v0

    move/from16 v40, v8

    move-object/from16 v41, v9

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move/from16 v44, v11

    move/from16 v18, v12

    move-object/from16 v45, v13

    .end local v8  # "sysPkg":Z
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    goto/16 :goto_ece

    .line 18458
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v7  # "replace":Z
    .restart local v8  # "sysPkg":Z
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    :cond_a4b
    move/from16 v39, v7

    move/from16 v40, v8

    move-object/from16 v41, v9

    .line 18463
    .end local v7  # "replace":Z
    .end local v8  # "sysPkg":Z
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    :goto_a51
    :try_start_a51
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v7, v5}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 18464
    .local v7, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v8, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v8, v7}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Lcom/android/server/pm/PackageSetting;)Lcom/android/server/pm/PackageSetting;

    move-result-object v8

    .line 18467
    .local v8, "disabledPs":Lcom/android/server/pm/PackageSetting;
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v9, v9, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 18468
    .local v9, "ksms":Lcom/android/server/pm/KeySetManagerService;
    invoke-virtual {v9, v7, v3}, Lcom/android/server/pm/KeySetManagerService;->shouldCheckUpgradeKeySetLocked(Lcom/android/server/pm/PackageSettingBase;I)Z

    move-result v42
    :try_end_a69
    .catchall {:try_start_a51 .. :try_end_a69} :catchall_eab

    if-eqz v42, :cond_aa7

    .line 18469
    :try_start_a6b
    invoke-virtual {v9, v7, v14}, Lcom/android/server/pm/KeySetManagerService;->checkUpgradeKeySetLocked(Lcom/android/server/pm/PackageSettingBase;Landroid/content/pm/PackageParser$Package;)Z

    move-result v18

    if-eqz v18, :cond_a79

    move-object/from16 v42, v8

    move-object/from16 v43, v9

    move/from16 v44, v11

    goto/16 :goto_aeb

    .line 18470
    :cond_a79
    move-object/from16 v42, v8

    .end local v8  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .local v42, "disabledPs":Lcom/android/server/pm/PackageSetting;
    new-instance v8, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    move-object/from16 v43, v9

    .end local v9  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .local v43, "ksms":Lcom/android/server/pm/KeySetManagerService;
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V
    :try_end_a84
    .catchall {:try_start_a6b .. :try_end_a84} :catchall_a97

    move/from16 v44, v11

    .end local v11  # "installFlags":I
    .local v44, "installFlags":I
    :try_start_a86
    const-string v11, "New package not signed by keys specified by upgrade-keysets: "

    invoke-virtual {v9, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    const/4 v11, -0x7

    invoke-direct {v8, v11, v9}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v3  # "scanFlags":I
    .end local v4  # "isInstantApp":Z
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v22  # "targetScanFlags":I
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v34  # "targetParseFlags":I
    .end local v35  # "systemApp":Z
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v44  # "installFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v8
    :try_end_a97
    .catchall {:try_start_a86 .. :try_end_a97} :catchall_add

    .line 18545
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v3  # "scanFlags":I
    .restart local v4  # "isInstantApp":Z
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v11  # "installFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v22  # "targetScanFlags":I
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v34  # "targetParseFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_a97
    move-exception v0

    move/from16 v44, v11

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move/from16 v18, v12

    move-object/from16 v45, v13

    .end local v11  # "installFlags":I
    .restart local v44  # "installFlags":I
    goto/16 :goto_ece

    .line 18476
    .end local v44  # "installFlags":I
    .restart local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v8  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v9  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v11  # "installFlags":I
    .restart local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    :cond_aa7
    move-object/from16 v42, v8

    move-object/from16 v43, v9

    move/from16 v44, v11

    .end local v8  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v9  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v11  # "installFlags":I
    .restart local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v44  # "installFlags":I
    :try_start_aad
    iget-object v8, v14, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v9, v6, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    const/4 v11, 0x1

    invoke-virtual {v8, v9, v11}, Landroid/content/pm/PackageParser$SigningDetails;->checkCapability(Landroid/content/pm/PackageParser$SigningDetails;I)Z

    move-result v8
    :try_end_ab6
    .catchall {:try_start_aad .. :try_end_ab6} :catchall_e9e

    if-nez v8, :cond_aeb

    :try_start_ab8
    iget-object v8, v6, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v9, v14, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    .line 18478
    const/16 v11, 0x8

    invoke-virtual {v8, v9, v11}, Landroid/content/pm/PackageParser$SigningDetails;->checkCapability(Landroid/content/pm/PackageParser$SigningDetails;I)Z

    move-result v8

    if-eqz v8, :cond_ac5

    goto :goto_aeb

    .line 18481
    :cond_ac5
    new-instance v8, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "New package has a different signature: "

    invoke-virtual {v9, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    const/4 v11, -0x7

    invoke-direct {v8, v11, v9}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v3  # "scanFlags":I
    .end local v4  # "isInstantApp":Z
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v22  # "targetScanFlags":I
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v34  # "targetParseFlags":I
    .end local v35  # "systemApp":Z
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v44  # "installFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v8
    :try_end_add
    .catchall {:try_start_ab8 .. :try_end_add} :catchall_add

    .line 18545
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v3  # "scanFlags":I
    .restart local v4  # "isInstantApp":Z
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v22  # "targetScanFlags":I
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v34  # "targetParseFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v44  # "installFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_add
    move-exception v0

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move/from16 v18, v12

    move-object/from16 v45, v13

    goto/16 :goto_ece

    .line 18487
    .restart local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_aeb
    :goto_aeb
    :try_start_aeb
    iget-object v8, v6, Landroid/content/pm/PackageParser$Package;->restrictUpdateHash:[B
    :try_end_aed
    .catchall {:try_start_aeb .. :try_end_aed} :catchall_e9e

    if-eqz v8, :cond_b94

    :try_start_aef
    invoke-virtual {v6}, Landroid/content/pm/PackageParser$Package;->isSystem()Z

    move-result v8
    :try_end_af3
    .catchall {:try_start_aef .. :try_end_af3} :catchall_b86

    if-eqz v8, :cond_b94

    .line 18490
    :try_start_af5
    const-string v8, "SHA-512"

    invoke-static {v8}, Ljava/security/MessageDigest;->getInstance(Ljava/lang/String;)Ljava/security/MessageDigest;

    move-result-object v8

    .line 18491
    .local v8, "digest":Ljava/security/MessageDigest;
    new-instance v9, Ljava/io/File;

    iget-object v11, v14, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-direct {v9, v11}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-static {v8, v9}, Lcom/android/server/pm/PackageManagerService;->updateDigest(Ljava/security/MessageDigest;Ljava/io/File;)V

    .line 18492
    iget-object v9, v14, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    invoke-static {v9}, Lcom/android/internal/util/ArrayUtils;->isEmpty([Ljava/lang/Object;)Z

    move-result v9

    if-nez v9, :cond_b2e

    .line 18493
    iget-object v9, v14, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    array-length v11, v9
    :try_end_b10
    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_af5 .. :try_end_b10} :catch_b5e
    .catch Ljava/io/IOException; {:try_start_af5 .. :try_end_b10} :catch_b5e
    .catchall {:try_start_af5 .. :try_end_b10} :catchall_b86

    move/from16 v18, v12

    const/4 v12, 0x0

    .end local v12  # "onExternal":Z
    .local v18, "onExternal":Z
    :goto_b13
    if-ge v12, v11, :cond_b30

    :try_start_b15
    aget-object v31, v9, v12

    move-object/from16 v45, v31

    .line 18494
    .local v45, "path":Ljava/lang/String;
    move-object/from16 v31, v9

    new-instance v9, Ljava/io/File;

    move/from16 v46, v11

    move-object/from16 v11, v45

    .end local v45  # "path":Ljava/lang/String;
    .local v11, "path":Ljava/lang/String;
    invoke-direct {v9, v11}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-static {v8, v9}, Lcom/android/server/pm/PackageManagerService;->updateDigest(Ljava/security/MessageDigest;Ljava/io/File;)V

    .line 18493
    .end local v11  # "path":Ljava/lang/String;
    add-int/lit8 v12, v12, 0x1

    move-object/from16 v9, v31

    move/from16 v11, v46

    goto :goto_b13

    .line 18492
    .end local v18  # "onExternal":Z
    .restart local v12  # "onExternal":Z
    :cond_b2e
    move/from16 v18, v12

    .line 18497
    .end local v12  # "onExternal":Z
    .restart local v18  # "onExternal":Z
    :cond_b30
    invoke-virtual {v8}, Ljava/security/MessageDigest;->digest()[B

    move-result-object v9
    :try_end_b34
    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_b15 .. :try_end_b34} :catch_b5b
    .catch Ljava/io/IOException; {:try_start_b15 .. :try_end_b34} :catch_b5b
    .catchall {:try_start_b15 .. :try_end_b34} :catchall_b7a

    move-object v8, v9

    .line 18501
    .local v8, "digestBytes":[B
    nop

    .line 18502
    :try_start_b36
    iget-object v9, v6, Landroid/content/pm/PackageParser$Package;->restrictUpdateHash:[B

    invoke-static {v9, v8}, Ljava/util/Arrays;->equals([B[B)Z

    move-result v9

    if-eqz v9, :cond_b43

    .line 18507
    iget-object v9, v6, Landroid/content/pm/PackageParser$Package;->restrictUpdateHash:[B

    iput-object v9, v14, Landroid/content/pm/PackageParser$Package;->restrictUpdateHash:[B

    goto :goto_b96

    .line 18503
    :cond_b43
    new-instance v9, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "New package fails restrict-update check: "

    invoke-virtual {v12, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    const/4 v12, -0x2

    invoke-direct {v9, v12, v11}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v3  # "scanFlags":I
    .end local v4  # "isInstantApp":Z
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .end local v22  # "targetScanFlags":I
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v34  # "targetParseFlags":I
    .end local v35  # "systemApp":Z
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v44  # "installFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v9

    .line 18498
    .end local v8  # "digestBytes":[B
    .restart local v3  # "scanFlags":I
    .restart local v4  # "isInstantApp":Z
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v22  # "targetScanFlags":I
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v34  # "targetParseFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v44  # "installFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catch_b5b
    move-exception v0

    move-object v8, v0

    goto :goto_b62

    .end local v18  # "onExternal":Z
    .restart local v12  # "onExternal":Z
    :catch_b5e
    move-exception v0

    move/from16 v18, v12

    move-object v8, v0

    .line 18499
    .end local v12  # "onExternal":Z
    .local v8, "e":Ljava/lang/Exception;
    .restart local v18  # "onExternal":Z
    :goto_b62
    new-instance v9, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Could not compute hash: "

    invoke-virtual {v12, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    const/4 v12, -0x2

    invoke-direct {v9, v12, v11}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v3  # "scanFlags":I
    .end local v4  # "isInstantApp":Z
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .end local v22  # "targetScanFlags":I
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v34  # "targetParseFlags":I
    .end local v35  # "systemApp":Z
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v44  # "installFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v9
    :try_end_b7a
    .catchall {:try_start_b36 .. :try_end_b7a} :catchall_b7a

    .line 18545
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v8  # "e":Ljava/lang/Exception;
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v3  # "scanFlags":I
    .restart local v4  # "isInstantApp":Z
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v22  # "targetScanFlags":I
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v34  # "targetParseFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v44  # "installFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_b7a
    move-exception v0

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move-object/from16 v45, v13

    goto/16 :goto_ece

    .end local v18  # "onExternal":Z
    .restart local v12  # "onExternal":Z
    :catchall_b86
    move-exception v0

    move/from16 v18, v12

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move-object/from16 v45, v13

    .end local v12  # "onExternal":Z
    .restart local v18  # "onExternal":Z
    goto/16 :goto_ece

    .line 18487
    .end local v18  # "onExternal":Z
    .restart local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v12  # "onExternal":Z
    .restart local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_b94
    move/from16 v18, v12

    .line 18511
    .end local v12  # "onExternal":Z
    .restart local v18  # "onExternal":Z
    :goto_b96
    nop

    .line 18512
    :try_start_b97
    invoke-direct {v1, v6, v14}, Lcom/android/server/pm/PackageManagerService;->getParentOrChildPackageChangedSharedUser(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;

    move-result-object v8

    .line 18513
    .local v8, "invalidPackageName":Ljava/lang/String;
    if-nez v8, :cond_e67

    .line 18520
    sget-object v9, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v9}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v9

    .line 18521
    .local v9, "allUsers":[I
    const/4 v11, 0x1

    invoke-virtual {v7, v9, v11}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v12
    :try_end_ba8
    .catchall {:try_start_b97 .. :try_end_ba8} :catchall_e93

    move-object v11, v12

    .line 18525
    .local v11, "installedUsers":[I
    if-eqz v4, :cond_c52

    .line 18526
    :try_start_bab
    iget-object v12, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;

    if-eqz v12, :cond_c05

    iget-object v12, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;

    invoke-virtual {v12}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v12
    :try_end_bb5
    .catchall {:try_start_bab .. :try_end_bb5} :catchall_c46

    move/from16 v31, v4

    const/4 v4, -0x1

    .end local v4  # "isInstantApp":Z
    .local v31, "isInstantApp":Z
    if-ne v12, v4, :cond_bbd

    move-object/from16 v45, v13

    goto :goto_c09

    .line 18537
    :cond_bbd
    :try_start_bbd
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;

    invoke-virtual {v4}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v4

    invoke-virtual {v7, v4}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v4

    if-eqz v4, :cond_bcd

    move-object/from16 v45, v13

    goto/16 :goto_c56

    .line 18539
    :cond_bcd
    const-string v4, "PackageManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V
    :try_end_bd4
    .catchall {:try_start_bbd .. :try_end_bd4} :catchall_bfb

    move-object/from16 v45, v13

    .end local v13  # "pkgName":Ljava/lang/String;
    .local v45, "pkgName":Ljava/lang/String;
    :try_start_bd6
    const-string v13, "Can\'t replace full app with instant app: "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v13, " for user: "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;

    .line 18540
    invoke-virtual {v13}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v13

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    .line 18539
    invoke-static {v4, v12}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18541
    new-instance v4, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const/16 v12, -0x74

    invoke-direct {v4, v12}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(I)V

    .end local v3  # "scanFlags":I
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .end local v22  # "targetScanFlags":I
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v31  # "isInstantApp":Z
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v34  # "targetParseFlags":I
    .end local v35  # "systemApp":Z
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v4

    .line 18545
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v8  # "invalidPackageName":Ljava/lang/String;
    .end local v9  # "allUsers":[I
    .end local v11  # "installedUsers":[I
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v3  # "scanFlags":I
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v22  # "targetScanFlags":I
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v31  # "isInstantApp":Z
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v34  # "targetParseFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v44  # "installFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_bfb
    move-exception v0

    move-object/from16 v45, v13

    move-object v2, v0

    move/from16 v30, v3

    move-object/from16 v46, v5

    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v45  # "pkgName":Ljava/lang/String;
    goto/16 :goto_ece

    .line 18526
    .end local v31  # "isInstantApp":Z
    .end local v45  # "pkgName":Ljava/lang/String;
    .restart local v4  # "isInstantApp":Z
    .restart local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v8  # "invalidPackageName":Ljava/lang/String;
    .restart local v9  # "allUsers":[I
    .restart local v11  # "installedUsers":[I
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_c05
    move/from16 v31, v4

    move-object/from16 v45, v13

    .line 18527
    .end local v4  # "isInstantApp":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v31  # "isInstantApp":Z
    .restart local v45  # "pkgName":Ljava/lang/String;
    :goto_c09
    array-length v4, v9

    const/4 v12, 0x0

    :goto_c0b
    if-ge v12, v4, :cond_c56

    aget v13, v9, v12

    .line 18528
    .local v13, "currentUser":I
    invoke-virtual {v7, v13}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v19

    if-eqz v19, :cond_c18

    .line 18527
    .end local v13  # "currentUser":I
    add-int/lit8 v12, v12, 0x1

    goto :goto_c0b

    .line 18530
    .restart local v13  # "currentUser":I
    :cond_c18
    const-string v4, "PackageManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Can\'t replace full app with instant app: "

    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " for user: "

    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v4, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18533
    new-instance v2, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const/16 v4, -0x74

    invoke-direct {v2, v4}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(I)V

    .end local v3  # "scanFlags":I
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .end local v22  # "targetScanFlags":I
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v31  # "isInstantApp":Z
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v34  # "targetParseFlags":I
    .end local v35  # "systemApp":Z
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v2
    :try_end_c3e
    .catchall {:try_start_bd6 .. :try_end_c3e} :catchall_c3e

    .line 18545
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v8  # "invalidPackageName":Ljava/lang/String;
    .end local v9  # "allUsers":[I
    .end local v11  # "installedUsers":[I
    .end local v13  # "currentUser":I
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v3  # "scanFlags":I
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v22  # "targetScanFlags":I
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v31  # "isInstantApp":Z
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v34  # "targetParseFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v44  # "installFlags":I
    .restart local v45  # "pkgName":Ljava/lang/String;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_c3e
    move-exception v0

    move-object v2, v0

    move/from16 v30, v3

    move-object/from16 v46, v5

    goto/16 :goto_ece

    .end local v31  # "isInstantApp":Z
    .end local v45  # "pkgName":Ljava/lang/String;
    .restart local v4  # "isInstantApp":Z
    .local v13, "pkgName":Ljava/lang/String;
    :catchall_c46
    move-exception v0

    move/from16 v31, v4

    move-object/from16 v45, v13

    move-object v2, v0

    move/from16 v30, v3

    move-object/from16 v46, v5

    .end local v4  # "isInstantApp":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v31  # "isInstantApp":Z
    .restart local v45  # "pkgName":Ljava/lang/String;
    goto/16 :goto_ece

    .line 18525
    .end local v31  # "isInstantApp":Z
    .end local v45  # "pkgName":Ljava/lang/String;
    .restart local v4  # "isInstantApp":Z
    .restart local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v8  # "invalidPackageName":Ljava/lang/String;
    .restart local v9  # "allUsers":[I
    .restart local v11  # "installedUsers":[I
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_c52
    move/from16 v31, v4

    move-object/from16 v45, v13

    .line 18545
    .end local v4  # "isInstantApp":Z
    .end local v8  # "invalidPackageName":Ljava/lang/String;
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .restart local v31  # "isInstantApp":Z
    .restart local v45  # "pkgName":Ljava/lang/String;
    :cond_c56
    :goto_c56
    :try_start_c56
    monitor-exit v10
    :try_end_c57
    .catchall {:try_start_c56 .. :try_end_c57} :catchall_e5f

    .line 18548
    :try_start_c57
    new-instance v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    invoke-direct {v2, v1}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;-><init>(Lcom/android/server/pm/PackageSender;)V

    iput-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    .line 18549
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v4, v6, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v4, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->uid:I

    .line 18550
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v4, v6, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iput-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    .line 18551
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v4, v7, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    iput-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installerPackageName:Ljava/lang/String;

    .line 18552
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v4, v14, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-eqz v4, :cond_c7a

    const/4 v4, 0x1

    goto :goto_c7b

    :cond_c7a
    const/4 v4, 0x0

    :goto_c7b
    iput-boolean v4, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->isStaticSharedLib:Z

    .line 18553
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    const/4 v4, 0x1

    iput-boolean v4, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->isUpdate:Z

    .line 18554
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iput-object v11, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->origUsers:[I

    .line 18555
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    new-instance v4, Landroid/util/SparseArray;

    array-length v8, v11

    invoke-direct {v4, v8}, Landroid/util/SparseArray;-><init>(I)V

    iput-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installReasons:Landroid/util/SparseArray;

    .line 18556
    const/4 v2, 0x0

    move v4, v2

    .local v4, "i":I
    :goto_c92
    array-length v2, v11
    :try_end_c93
    .catchall {:try_start_c57 .. :try_end_c93} :catchall_e51

    if-ge v4, v2, :cond_cb7

    .line 18557
    :try_start_c95
    aget v2, v11, v4

    .line 18558
    .local v2, "userId":I
    iget-object v8, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v8, v8, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installReasons:Landroid/util/SparseArray;

    invoke-virtual {v7, v2}, Lcom/android/server/pm/PackageSetting;->getInstallReason(I)I

    move-result v12

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    invoke-virtual {v8, v2, v12}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V
    :try_end_ca6
    .catchall {:try_start_c95 .. :try_end_ca6} :catchall_ca9

    .line 18556
    .end local v2  # "userId":I
    add-int/lit8 v4, v4, 0x1

    goto :goto_c92

    .line 18694
    .end local v4  # "i":I
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v9  # "allUsers":[I
    .end local v11  # "installedUsers":[I
    .end local v22  # "targetScanFlags":I
    .end local v31  # "isInstantApp":Z
    .end local v34  # "targetParseFlags":I
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    :catchall_ca9
    move-exception v0

    move-object v2, v0

    move/from16 v30, v3

    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    goto/16 :goto_1030

    .line 18561
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v9  # "allUsers":[I
    .restart local v11  # "installedUsers":[I
    .restart local v22  # "targetScanFlags":I
    .restart local v31  # "isInstantApp":Z
    .restart local v34  # "targetParseFlags":I
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    :cond_cb7
    :try_start_cb7
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v7}, Lcom/android/server/pm/Settings;->getChildSettingsLPr(Lcom/android/server/pm/PackageSetting;)[Lcom/android/server/pm/PackageSetting;

    move-result-object v2
    :try_end_cbd
    .catchall {:try_start_cb7 .. :try_end_cbd} :catchall_e51

    .line 18562
    .local v2, "childPackages":[Lcom/android/server/pm/PackageSetting;
    if-eqz v2, :cond_d69

    .line 18563
    :try_start_cbf
    array-length v4, v2

    const/4 v8, 0x0

    :goto_cc1
    if-ge v8, v4, :cond_d62

    aget-object v12, v2, v8

    .line 18564
    .local v12, "childPs":Lcom/android/server/pm/PackageSetting;
    const/4 v13, 0x0

    .line 18565
    .local v13, "childPackageUpdated":Z
    if-nez v12, :cond_cca

    const/4 v10, 0x0

    goto :goto_ccc

    :cond_cca
    iget-object v10, v12, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 18566
    .local v10, "childPkg":Landroid/content/pm/PackageParser$Package;
    :goto_ccc
    move-object/from16 v19, v2

    .end local v2  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .local v19, "childPackages":[Lcom/android/server/pm/PackageSetting;
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->addedChildPackages:Landroid/util/ArrayMap;

    if-eqz v2, :cond_d0a

    .line 18567
    iget-object v2, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->addedChildPackages:Landroid/util/ArrayMap;

    move/from16 v21, v4

    iget-object v4, v10, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    .line 18569
    .local v2, "childRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    if-eqz v2, :cond_d07

    .line 18570
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    move-object/from16 v46, v5

    .end local v5  # "pkgName11":Ljava/lang/String;
    .local v46, "pkgName11":Ljava/lang/String;
    iget-object v5, v10, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v5, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->uid:I

    .line 18571
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v5, v10, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iput-object v5, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    .line 18572
    if-eqz v12, :cond_cf8

    .line 18573
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v5, v12, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    iput-object v5, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installerPackageName:Ljava/lang/String;

    .line 18576
    :cond_cf8
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    const/4 v5, 0x1

    iput-boolean v5, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->isUpdate:Z

    .line 18577
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v5, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v5, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installReasons:Landroid/util/SparseArray;

    iput-object v5, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installReasons:Landroid/util/SparseArray;

    .line 18579
    const/4 v13, 0x1

    goto :goto_d0e

    .line 18569
    .end local v46  # "pkgName11":Ljava/lang/String;
    .restart local v5  # "pkgName11":Ljava/lang/String;
    :cond_d07
    move-object/from16 v46, v5

    .end local v5  # "pkgName11":Ljava/lang/String;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    goto :goto_d0e

    .line 18566
    .end local v2  # "childRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .restart local v5  # "pkgName11":Ljava/lang/String;
    :cond_d0a
    move/from16 v21, v4

    move-object/from16 v46, v5

    .line 18582
    .end local v5  # "pkgName11":Ljava/lang/String;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    :goto_d0e
    if-nez v13, :cond_d54

    .line 18583
    new-instance v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    invoke-direct {v2, v1}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;-><init>(Lcom/android/server/pm/PackageSender;)V

    .line 18584
    .local v2, "childRemovedRes":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    iget-object v4, v10, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iput-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    .line 18585
    if-eqz v12, :cond_d1f

    .line 18586
    iget-object v4, v12, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    iput-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installerPackageName:Ljava/lang/String;

    .line 18588
    :cond_d1f
    const/4 v4, 0x0

    iput-boolean v4, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->isUpdate:Z

    .line 18589
    const/4 v5, 0x1

    iput-boolean v5, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->dataRemoved:Z

    .line 18590
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5
    :try_end_d28
    .catchall {:try_start_cbf .. :try_end_d28} :catchall_ca9

    .line 18591
    if-eqz v12, :cond_d34

    .line 18592
    move-object/from16 v47, v7

    const/4 v4, 0x1

    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v47, "ps":Lcom/android/server/pm/PackageSetting;
    :try_start_d2d
    invoke-virtual {v12, v9, v4}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v7

    iput-object v7, v2, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->origUsers:[I

    goto :goto_d36

    .line 18591
    .end local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_d34
    move-object/from16 v47, v7

    .line 18596
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_d36
    monitor-exit v5
    :try_end_d37
    .catchall {:try_start_d2d .. :try_end_d37} :catchall_d50

    .line 18597
    :try_start_d37
    iget-object v4, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    if-nez v4, :cond_d46

    .line 18598
    iget-object v4, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    new-instance v5, Landroid/util/ArrayMap;

    invoke-direct {v5}, Landroid/util/ArrayMap;-><init>()V

    iput-object v5, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    .line 18600
    :cond_d46
    iget-object v4, v15, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedChildPackages:Landroid/util/ArrayMap;

    iget-object v5, v10, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5, v2}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_d4f
    .catchall {:try_start_d37 .. :try_end_d4f} :catchall_ca9

    goto :goto_d56

    .line 18596
    :catchall_d50
    move-exception v0

    move-object v4, v0

    :try_start_d52
    monitor-exit v5
    :try_end_d53
    .catchall {:try_start_d52 .. :try_end_d53} :catchall_d50

    .end local v3  # "scanFlags":I
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :try_start_d53
    throw v4
    :try_end_d54
    .catchall {:try_start_d53 .. :try_end_d54} :catchall_ca9

    .line 18582
    .end local v2  # "childRemovedRes":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "scanFlags":I
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v35  # "systemApp":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v44  # "installFlags":I
    .restart local v45  # "pkgName":Ljava/lang/String;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :cond_d54
    move-object/from16 v47, v7

    .line 18563
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v10  # "childPkg":Landroid/content/pm/PackageParser$Package;
    .end local v12  # "childPs":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "childPackageUpdated":Z
    .restart local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_d56
    add-int/lit8 v8, v8, 0x1

    move-object/from16 v2, v19

    move/from16 v4, v21

    move-object/from16 v5, v46

    move-object/from16 v7, v47

    goto/16 :goto_cc1

    .end local v19  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .end local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v2, "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_d62
    move-object/from16 v19, v2

    move-object/from16 v46, v5

    move-object/from16 v47, v7

    .end local v2  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v19  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    .restart local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    goto :goto_d6f

    .line 18562
    .end local v19  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .end local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v2  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_d69
    move-object/from16 v19, v2

    move-object/from16 v46, v5

    move-object/from16 v47, v7

    .line 18607
    .end local v2  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v19  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    .restart local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_d6f
    :try_start_d6f
    invoke-static {v6}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v2

    .line 18608
    .end local v40  # "sysPkg":Z
    .local v2, "sysPkg":Z
    if-eqz v2, :cond_e0e

    .line 18610
    invoke-static {v6}, Lcom/android/server/pm/PackageManagerService;->isPrivilegedApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v4

    .line 18611
    .local v4, "privileged":Z
    invoke-static {v6}, Lcom/android/server/pm/PackageManagerService;->isOemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v5

    .line 18612
    .local v5, "oem":Z
    invoke-static {v6}, Lcom/android/server/pm/PackageManagerService;->isVendorApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v7

    .line 18613
    .local v7, "vendor":Z
    invoke-static {v6}, Lcom/android/server/pm/PackageManagerService;->isProductApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v8

    .line 18614
    .local v8, "product":Z
    invoke-static {v6}, Lcom/android/server/pm/PackageManagerService;->isOdmApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v10

    .line 18615
    .local v10, "odm":Z
    move/from16 v12, v27

    .line 18616
    .local v12, "systemParseFlags":I
    const/high16 v13, 0x20000

    or-int/2addr v13, v3

    .line 18618
    if-eqz v4, :cond_d93

    const/high16 v20, 0x40000

    goto :goto_d95

    :cond_d93
    const/16 v20, 0x0

    :goto_d95
    or-int v13, v13, v20

    .line 18619
    if-eqz v5, :cond_d9c

    const/high16 v20, 0x80000

    goto :goto_d9e

    :cond_d9c
    const/16 v20, 0x0

    :goto_d9e
    or-int v13, v13, v20

    .line 18620
    if-eqz v7, :cond_da5

    const/high16 v20, 0x100000

    goto :goto_da7

    :cond_da5
    const/16 v20, 0x0

    :goto_da7
    or-int v13, v13, v20

    .line 18621
    if-eqz v8, :cond_dae

    const/high16 v20, 0x200000

    goto :goto_db0

    :cond_dae
    const/16 v20, 0x0

    :goto_db0
    or-int v13, v13, v20

    .line 18622
    if-eqz v10, :cond_db7

    const/high16 v20, 0x800000

    goto :goto_db9

    :cond_db7
    const/16 v20, 0x0

    :goto_db9
    or-int v13, v13, v20

    .line 18624
    move/from16 v20, v2

    .end local v2  # "sysPkg":Z
    .local v20, "sysPkg":Z
    iget-object v2, v6, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v16, -0x80000000

    and-int v2, v2, v16

    if-eqz v2, :cond_dcc

    .line 18625
    const/high16 v2, 0x1000000

    move/from16 v30, v2

    goto :goto_dce

    :cond_dcc
    const/16 v30, 0x0

    :goto_dce
    or-int v2, v13, v30

    .line 18628
    .local v2, "systemScanFlags":I
    sget-boolean v13, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v13, :cond_df8

    .line 18629
    const-string v13, "PackageManager"
    :try_end_dd6
    .catchall {:try_start_d6f .. :try_end_dd6} :catchall_e51

    move/from16 v30, v3

    .end local v3  # "scanFlags":I
    .local v30, "scanFlags":I
    :try_start_dd8
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v16, v4

    .end local v4  # "privileged":Z
    .local v16, "privileged":Z
    const-string/jumbo v4, "replaceSystemPackageLI: new="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v4, ", old="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v13, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_dfc

    .line 18628
    .end local v16  # "privileged":Z
    .end local v30  # "scanFlags":I
    .restart local v3  # "scanFlags":I
    .restart local v4  # "privileged":Z
    :cond_df8
    move/from16 v30, v3

    move/from16 v16, v4

    .line 18632
    .end local v3  # "scanFlags":I
    .end local v4  # "privileged":Z
    .restart local v16  # "privileged":Z
    .restart local v30  # "scanFlags":I
    :goto_dfc
    const/4 v3, 0x1

    invoke-virtual {v15, v3}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setReturnCode(I)V

    .line 18633
    const/16 v3, 0x80

    const/16 v4, 0x80

    invoke-virtual {v14, v3, v4}, Landroid/content/pm/PackageParser$Package;->setApplicationInfoFlags(II)V
    :try_end_e07
    .catchall {:try_start_dd8 .. :try_end_e07} :catchall_ed0

    .line 18635
    move/from16 v34, v12

    .line 18636
    move/from16 v22, v2

    .line 18637
    .end local v2  # "systemScanFlags":I
    .end local v5  # "oem":Z
    .end local v7  # "vendor":Z
    .end local v8  # "product":Z
    .end local v10  # "odm":Z
    .end local v12  # "systemParseFlags":I
    .end local v16  # "privileged":Z
    move/from16 v7, v39

    goto :goto_e46

    .line 18638
    .end local v20  # "sysPkg":Z
    .end local v30  # "scanFlags":I
    .local v2, "sysPkg":Z
    .restart local v3  # "scanFlags":I
    :cond_e0e
    move/from16 v20, v2

    move/from16 v30, v3

    .end local v2  # "sysPkg":Z
    .end local v3  # "scanFlags":I
    .restart local v20  # "sysPkg":Z
    .restart local v30  # "scanFlags":I
    const/4 v7, 0x1

    .line 18639
    .end local v39  # "replace":Z
    .local v7, "replace":Z
    :try_start_e13
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v2, :cond_e36

    .line 18640
    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v4, "replaceNonSystemPackageLI: new="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v4, ", old="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 18645
    :cond_e36
    iget-object v2, v6, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 18646
    .local v2, "pkgName1":Ljava/lang/String;
    const/4 v3, 0x1

    .line 18647
    .local v3, "deletedPkg":Z
    const/4 v4, 0x0

    .line 18648
    .local v4, "addedPkg":Z
    const/4 v5, 0x0

    .line 18650
    .local v5, "updatedSettings":Z
    iget-object v8, v14, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    if-eqz v8, :cond_e45

    .line 18651
    iget-object v8, v14, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v8, Lcom/android/server/pm/PackageSetting;

    iget-wide v12, v8, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J
    :try_end_e45
    .catchall {:try_start_e13 .. :try_end_e45} :catchall_f38

    :cond_e45
    nop

    .line 18654
    .end local v2  # "pkgName1":Ljava/lang/String;
    .end local v3  # "deletedPkg":Z
    .end local v4  # "addedPkg":Z
    .end local v5  # "updatedSettings":Z
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v9  # "allUsers":[I
    .end local v11  # "installedUsers":[I
    .end local v31  # "isInstantApp":Z
    .end local v46  # "pkgName11":Ljava/lang/String;
    :goto_e46
    move v2, v7

    move-object/from16 v31, v19

    move/from16 v40, v20

    move/from16 v3, v22

    move-object/from16 v4, v42

    goto/16 :goto_f67

    .line 18694
    .end local v7  # "replace":Z
    .end local v19  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v20  # "sysPkg":Z
    .end local v22  # "targetScanFlags":I
    .end local v30  # "scanFlags":I
    .end local v34  # "targetParseFlags":I
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v3, "scanFlags":I
    .restart local v39  # "replace":Z
    :catchall_e51
    move-exception v0

    move/from16 v30, v3

    move-object v2, v0

    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    .end local v3  # "scanFlags":I
    .restart local v30  # "scanFlags":I
    goto/16 :goto_1030

    .line 18545
    .end local v30  # "scanFlags":I
    .restart local v3  # "scanFlags":I
    .local v5, "pkgName11":Ljava/lang/String;
    .restart local v22  # "targetScanFlags":I
    .restart local v31  # "isInstantApp":Z
    .restart local v34  # "targetParseFlags":I
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    :catchall_e5f
    move-exception v0

    move/from16 v30, v3

    move-object/from16 v46, v5

    move-object v2, v0

    .end local v3  # "scanFlags":I
    .end local v5  # "pkgName11":Ljava/lang/String;
    .restart local v30  # "scanFlags":I
    .restart local v46  # "pkgName11":Ljava/lang/String;
    goto/16 :goto_ece

    .line 18514
    .end local v30  # "scanFlags":I
    .end local v31  # "isInstantApp":Z
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .restart local v3  # "scanFlags":I
    .local v4, "isInstantApp":Z
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .local v7, "ps":Lcom/android/server/pm/PackageSetting;
    .local v8, "invalidPackageName":Ljava/lang/String;
    .local v13, "pkgName":Ljava/lang/String;
    .restart local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_e67
    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move-object/from16 v47, v7

    move-object/from16 v45, v13

    .end local v3  # "scanFlags":I
    .end local v4  # "isInstantApp":Z
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v30  # "scanFlags":I
    .restart local v31  # "isInstantApp":Z
    .restart local v45  # "pkgName":Ljava/lang/String;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    .restart local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    :try_start_e71
    new-instance v2, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const/4 v3, -0x8

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Package "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " tried to change user "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v6, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v2, v3, v4}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .end local v22  # "targetScanFlags":I
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v30  # "scanFlags":I
    .end local v31  # "isInstantApp":Z
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v34  # "targetParseFlags":I
    .end local v35  # "systemApp":Z
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v2

    .line 18545
    .end local v6  # "oldPackage":Landroid/content/pm/PackageParser$Package;
    .end local v8  # "invalidPackageName":Ljava/lang/String;
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v42  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v43  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    .end local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "scanFlags":I
    .restart local v4  # "isInstantApp":Z
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v22  # "targetScanFlags":I
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v34  # "targetParseFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v44  # "installFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_e93
    move-exception v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move-object/from16 v45, v13

    move-object v2, v0

    .end local v3  # "scanFlags":I
    .end local v4  # "isInstantApp":Z
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v30  # "scanFlags":I
    .restart local v31  # "isInstantApp":Z
    .restart local v45  # "pkgName":Ljava/lang/String;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    goto :goto_ece

    .end local v18  # "onExternal":Z
    .end local v30  # "scanFlags":I
    .end local v31  # "isInstantApp":Z
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .restart local v3  # "scanFlags":I
    .restart local v4  # "isInstantApp":Z
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .local v12, "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    :catchall_e9e
    move-exception v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move/from16 v18, v12

    move-object/from16 v45, v13

    move-object v2, v0

    .end local v3  # "scanFlags":I
    .end local v4  # "isInstantApp":Z
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v18  # "onExternal":Z
    .restart local v30  # "scanFlags":I
    .restart local v31  # "isInstantApp":Z
    .restart local v45  # "pkgName":Ljava/lang/String;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    goto :goto_ece

    .end local v18  # "onExternal":Z
    .end local v30  # "scanFlags":I
    .end local v31  # "isInstantApp":Z
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .restart local v3  # "scanFlags":I
    .restart local v4  # "isInstantApp":Z
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .local v11, "installFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    :catchall_eab
    move-exception v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move/from16 v44, v11

    move/from16 v18, v12

    move-object/from16 v45, v13

    move-object v2, v0

    .end local v3  # "scanFlags":I
    .end local v4  # "isInstantApp":Z
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v11  # "installFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v18  # "onExternal":Z
    .restart local v30  # "scanFlags":I
    .restart local v31  # "isInstantApp":Z
    .restart local v44  # "installFlags":I
    .restart local v45  # "pkgName":Ljava/lang/String;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    goto :goto_ece

    .end local v18  # "onExternal":Z
    .end local v30  # "scanFlags":I
    .end local v31  # "isInstantApp":Z
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .restart local v3  # "scanFlags":I
    .restart local v4  # "isInstantApp":Z
    .restart local v5  # "pkgName11":Ljava/lang/String;
    .local v7, "replace":Z
    .local v8, "sysPkg":Z
    .local v9, "targetVolumeUuid":Ljava/lang/String;
    .restart local v11  # "installFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    :catchall_eba
    move-exception v0

    move/from16 v30, v3

    move/from16 v31, v4

    move-object/from16 v46, v5

    move/from16 v39, v7

    move/from16 v40, v8

    move-object/from16 v41, v9

    move/from16 v44, v11

    move/from16 v18, v12

    move-object/from16 v45, v13

    move-object v2, v0

    .end local v3  # "scanFlags":I
    .end local v4  # "isInstantApp":Z
    .end local v5  # "pkgName11":Ljava/lang/String;
    .end local v7  # "replace":Z
    .end local v8  # "sysPkg":Z
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .end local v11  # "installFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v18  # "onExternal":Z
    .restart local v30  # "scanFlags":I
    .restart local v31  # "isInstantApp":Z
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v44  # "installFlags":I
    .restart local v45  # "pkgName":Ljava/lang/String;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    :goto_ece
    monitor-exit v10
    :try_end_ecf
    .catchall {:try_start_e71 .. :try_end_ecf} :catchall_edc

    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v30  # "scanFlags":I
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :try_start_ecf
    throw v2
    :try_end_ed0
    .catchall {:try_start_ecf .. :try_end_ed0} :catchall_ed0

    .line 18694
    .end local v22  # "targetScanFlags":I
    .end local v31  # "isInstantApp":Z
    .end local v34  # "targetParseFlags":I
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v30  # "scanFlags":I
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v35  # "systemApp":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v44  # "installFlags":I
    .restart local v45  # "pkgName":Ljava/lang/String;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_ed0
    move-exception v0

    move-object v2, v0

    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    goto/16 :goto_1030

    .line 18545
    .restart local v22  # "targetScanFlags":I
    .restart local v31  # "isInstantApp":Z
    .restart local v34  # "targetParseFlags":I
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v40  # "sysPkg":Z
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v46  # "pkgName11":Ljava/lang/String;
    :catchall_edc
    move-exception v0

    move-object v2, v0

    goto :goto_ece

    .line 18694
    .end local v18  # "onExternal":Z
    .end local v22  # "targetScanFlags":I
    .end local v30  # "scanFlags":I
    .end local v31  # "isInstantApp":Z
    .end local v34  # "targetParseFlags":I
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v39  # "replace":Z
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .end local v46  # "pkgName11":Ljava/lang/String;
    .restart local v3  # "scanFlags":I
    .restart local v7  # "replace":Z
    .restart local v11  # "installFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    :catchall_edf
    move-exception v0

    move/from16 v30, v3

    move/from16 v39, v7

    move-object v2, v0

    move/from16 v42, v11

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    .end local v3  # "scanFlags":I
    .end local v7  # "replace":Z
    .end local v11  # "installFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v18  # "onExternal":Z
    .restart local v30  # "scanFlags":I
    .restart local v39  # "replace":Z
    .restart local v44  # "installFlags":I
    .restart local v45  # "pkgName":Ljava/lang/String;
    goto/16 :goto_1030

    .end local v18  # "onExternal":Z
    .end local v30  # "scanFlags":I
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .restart local v3  # "scanFlags":I
    .local v4, "systemApp":Z
    .local v5, "shouldCloseFreezerBeforeReturn":Z
    .restart local v7  # "replace":Z
    .restart local v11  # "installFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    :catchall_eef
    move-exception v0

    move/from16 v30, v3

    move/from16 v35, v4

    move/from16 v37, v5

    move/from16 v39, v7

    move-object v2, v0

    move/from16 v42, v11

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    .end local v3  # "scanFlags":I
    .end local v4  # "systemApp":Z
    .end local v5  # "shouldCloseFreezerBeforeReturn":Z
    .end local v7  # "replace":Z
    .end local v11  # "installFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v18  # "onExternal":Z
    .restart local v30  # "scanFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v44  # "installFlags":I
    .restart local v45  # "pkgName":Ljava/lang/String;
    goto/16 :goto_1030

    .line 18655
    .end local v18  # "onExternal":Z
    .end local v30  # "scanFlags":I
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v44  # "installFlags":I
    .end local v45  # "pkgName":Ljava/lang/String;
    .restart local v3  # "scanFlags":I
    .restart local v4  # "systemApp":Z
    .restart local v5  # "shouldCloseFreezerBeforeReturn":Z
    .local v6, "renamedPackage":Ljava/lang/String;
    .restart local v7  # "replace":Z
    .restart local v8  # "sysPkg":Z
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v11  # "installFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v22  # "targetScanFlags":I
    .restart local v34  # "targetParseFlags":I
    :cond_f03
    move/from16 v30, v3

    move/from16 v35, v4

    move/from16 v37, v5

    move-object/from16 v36, v6

    move/from16 v39, v7

    move/from16 v40, v8

    move/from16 v44, v11

    move/from16 v18, v12

    move-object/from16 v45, v13

    .end local v3  # "scanFlags":I
    .end local v4  # "systemApp":Z
    .end local v5  # "shouldCloseFreezerBeforeReturn":Z
    .end local v6  # "renamedPackage":Ljava/lang/String;
    .end local v7  # "replace":Z
    .end local v8  # "sysPkg":Z
    .end local v11  # "installFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .restart local v18  # "onExternal":Z
    .restart local v30  # "scanFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v39  # "replace":Z
    .restart local v40  # "sysPkg":Z
    .restart local v44  # "installFlags":I
    .restart local v45  # "pkgName":Ljava/lang/String;
    const/4 v2, 0x0

    .line 18656
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    const/4 v3, 0x0

    .line 18657
    .local v3, "childPackages":[Lcom/android/server/pm/PackageSetting;
    const/4 v4, 0x0

    .line 18658
    .local v4, "disabledPs":Lcom/android/server/pm/PackageSetting;
    const/4 v7, 0x0

    .line 18659
    .end local v39  # "replace":Z
    .restart local v7  # "replace":Z
    const/4 v5, 0x0

    .line 18661
    .local v5, "existingPackage":Landroid/content/pm/PackageParser$Package;
    :try_start_f1a
    iget-object v6, v14, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 18663
    .local v6, "pkgName1":Ljava/lang/String;
    sget-boolean v8, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z
    :try_end_f1e
    .catchall {:try_start_f1a .. :try_end_f1e} :catchall_1024

    if-eqz v8, :cond_f46

    :try_start_f20
    const-string v8, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v11, "installNewPackageLI: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v8, v10}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_f37
    .catchall {:try_start_f20 .. :try_end_f37} :catchall_f38

    goto :goto_f46

    .line 18694
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "pkgName1":Ljava/lang/String;
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .end local v22  # "targetScanFlags":I
    .end local v34  # "targetParseFlags":I
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v40  # "sysPkg":Z
    :catchall_f38
    move-exception v0

    move-object v2, v0

    move/from16 v39, v7

    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    goto/16 :goto_1030

    .line 18666
    .restart local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v6  # "pkgName1":Ljava/lang/String;
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v22  # "targetScanFlags":I
    .restart local v34  # "targetParseFlags":I
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v40  # "sysPkg":Z
    :cond_f46
    :goto_f46
    :try_start_f46
    iget-object v8, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8
    :try_end_f49
    .catchall {:try_start_f46 .. :try_end_f49} :catchall_1024

    .line 18667
    :try_start_f49
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v10, v6}, Lcom/android/server/pm/Settings;->getRenamedPackageLPr(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v10
    :try_end_f4f
    .catchall {:try_start_f49 .. :try_end_f4f} :catchall_1010

    .line 18668
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .local v10, "renamedPackage":Ljava/lang/String;
    if-nez v10, :cond_fe3

    .line 18678
    :try_start_f51
    iget-object v11, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v11, v6}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v11

    if-nez v11, :cond_fb1

    .line 18684
    monitor-exit v8
    :try_end_f5a
    .catchall {:try_start_f51 .. :try_end_f5a} :catchall_fd6

    move-object/from16 v47, v2

    move-object/from16 v31, v3

    move-object/from16 v38, v5

    move v2, v7

    move-object/from16 v41, v9

    move-object/from16 v36, v10

    move/from16 v3, v22

    .line 18687
    .end local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "pkgName1":Ljava/lang/String;
    .end local v7  # "replace":Z
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .end local v10  # "renamedPackage":Ljava/lang/String;
    .end local v22  # "targetScanFlags":I
    .local v2, "replace":Z
    .local v3, "targetScanFlags":I
    .local v31, "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v41  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_f67
    const/16 v37, 0x0

    .line 18689
    :try_start_f69
    new-instance v39, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    move-object/from16 v13, p1

    iget v6, v13, Lcom/android/server/pm/PackageManagerService$InstallArgs;->installReason:I

    iget-object v9, v13, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;
    :try_end_f71
    .catchall {:try_start_f69 .. :try_end_f71} :catchall_fa3

    const/16 v22, 0x0

    move-object/from16 v5, v39

    move-object/from16 v7, v41

    move-object/from16 v8, v32

    move v10, v2

    move/from16 v42, v44

    .end local v44  # "installFlags":I
    .local v42, "installFlags":I
    move v11, v3

    move/from16 v43, v18

    .end local v18  # "onExternal":Z
    .local v43, "onExternal":Z
    move/from16 v12, v34

    move-object/from16 v44, v45

    .end local v45  # "pkgName":Ljava/lang/String;
    .local v44, "pkgName":Ljava/lang/String;
    move-object/from16 v13, v38

    move-object/from16 v45, v14

    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v45, "pkg":Landroid/content/pm/PackageParser$Package;
    move v15, v2

    move/from16 v16, v40

    move-object/from16 v17, v36

    move-object/from16 v18, v33

    move-object/from16 v19, v47

    move-object/from16 v20, v4

    move-object/from16 v21, v31

    :try_start_f94
    invoke-direct/range {v5 .. v22}, Lcom/android/server/pm/PackageManagerService$PrepareResult;-><init>(ILjava/lang/String;Ljava/lang/String;Landroid/os/UserHandle;ZIILandroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;ZZLjava/lang/String;Lcom/android/server/pm/PackageManagerService$PackageFreezer;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;[Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageManagerService$1;)V
    :try_end_f97
    .catchall {:try_start_f94 .. :try_end_f97} :catchall_f9d

    .line 18694
    if-eqz v37, :cond_f9c

    .line 18695
    invoke-virtual/range {v33 .. v33}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    .line 18689
    :cond_f9c
    return-object v39

    .line 18694
    .end local v3  # "targetScanFlags":I
    .end local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v31  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v34  # "targetParseFlags":I
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v38  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v40  # "sysPkg":Z
    .end local v41  # "targetVolumeUuid":Ljava/lang/String;
    .end local v47  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_f9d
    move-exception v0

    move/from16 v39, v2

    move-object v2, v0

    goto/16 :goto_1030

    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .local v44, "installFlags":I
    .local v45, "pkgName":Ljava/lang/String;
    :catchall_fa3
    move-exception v0

    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    move/from16 v39, v2

    move-object v2, v0

    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .local v44, "pkgName":Ljava/lang/String;
    .local v45, "pkg":Landroid/content/pm/PackageParser$Package;
    goto/16 :goto_1030

    .line 18680
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    .local v3, "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v6  # "pkgName1":Ljava/lang/String;
    .restart local v7  # "replace":Z
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v10  # "renamedPackage":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v22  # "targetScanFlags":I
    .restart local v34  # "targetParseFlags":I
    .restart local v40  # "sysPkg":Z
    .local v44, "installFlags":I
    .local v45, "pkgName":Ljava/lang/String;
    :cond_fb1
    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .local v44, "pkgName":Ljava/lang/String;
    .local v45, "pkg":Landroid/content/pm/PackageParser$Package;
    :try_start_fb9
    new-instance v11, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Attempt to re-install "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v13, " without first uninstalling."

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    const/4 v13, -0x1

    invoke-direct {v11, v13, v12}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "pkgName1":Ljava/lang/String;
    .end local v7  # "replace":Z
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .end local v10  # "renamedPackage":Ljava/lang/String;
    .end local v22  # "targetScanFlags":I
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v30  # "scanFlags":I
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v34  # "targetParseFlags":I
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v40  # "sysPkg":Z
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v44  # "pkgName":Ljava/lang/String;
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v11

    .line 18684
    .restart local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v6  # "pkgName1":Ljava/lang/String;
    .restart local v7  # "replace":Z
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v10  # "renamedPackage":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v22  # "targetScanFlags":I
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v30  # "scanFlags":I
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v34  # "targetParseFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v40  # "sysPkg":Z
    .local v44, "installFlags":I
    .local v45, "pkgName":Ljava/lang/String;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_fd6
    move-exception v0

    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    move-object/from16 v36, v10

    move-object v10, v0

    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .local v44, "pkgName":Ljava/lang/String;
    .local v45, "pkg":Landroid/content/pm/PackageParser$Package;
    goto :goto_101a

    .line 18673
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .local v44, "installFlags":I
    .local v45, "pkgName":Ljava/lang/String;
    :cond_fe3
    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .local v44, "pkgName":Ljava/lang/String;
    .local v45, "pkg":Landroid/content/pm/PackageParser$Package;
    new-instance v11, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Attempt to re-install "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v13, " without first uninstalling package running as "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    const/4 v13, -0x1

    invoke-direct {v11, v13, v12}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "pkgName1":Ljava/lang/String;
    .end local v7  # "replace":Z
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .end local v10  # "renamedPackage":Ljava/lang/String;
    .end local v22  # "targetScanFlags":I
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v30  # "scanFlags":I
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v34  # "targetParseFlags":I
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v40  # "sysPkg":Z
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v44  # "pkgName":Ljava/lang/String;
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v11
    :try_end_100b
    .catchall {:try_start_fb9 .. :try_end_100b} :catchall_100b

    .line 18684
    .restart local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v6  # "pkgName1":Ljava/lang/String;
    .restart local v7  # "replace":Z
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v10  # "renamedPackage":Ljava/lang/String;
    .restart local v22  # "targetScanFlags":I
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v30  # "scanFlags":I
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v34  # "targetParseFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v40  # "sysPkg":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .restart local v44  # "pkgName":Ljava/lang/String;
    .restart local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_100b
    move-exception v0

    move-object/from16 v36, v10

    move-object v10, v0

    goto :goto_101a

    .end local v10  # "renamedPackage":Ljava/lang/String;
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .local v44, "installFlags":I
    .local v45, "pkgName":Ljava/lang/String;
    :catchall_1010
    move-exception v0

    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    move-object v10, v0

    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .local v44, "pkgName":Ljava/lang/String;
    .local v45, "pkg":Landroid/content/pm/PackageParser$Package;
    :goto_101a
    :try_start_101a
    monitor-exit v8
    :try_end_101b
    .catchall {:try_start_101a .. :try_end_101b} :catchall_1021

    .end local v7  # "replace":Z
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v30  # "scanFlags":I
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v44  # "pkgName":Ljava/lang/String;
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :try_start_101b
    throw v10
    :try_end_101c
    .catchall {:try_start_101b .. :try_end_101c} :catchall_101c

    .line 18694
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "pkgName1":Ljava/lang/String;
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .end local v22  # "targetScanFlags":I
    .end local v34  # "targetParseFlags":I
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v40  # "sysPkg":Z
    .restart local v7  # "replace":Z
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v29  # "pp":Landroid/content/pm/PackageParser;
    .restart local v30  # "scanFlags":I
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v33  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v35  # "systemApp":Z
    .restart local v37  # "shouldCloseFreezerBeforeReturn":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .restart local v44  # "pkgName":Ljava/lang/String;
    .restart local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_101c
    move-exception v0

    move-object v2, v0

    move/from16 v39, v7

    goto :goto_1030

    .line 18684
    .restart local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .restart local v6  # "pkgName1":Ljava/lang/String;
    .restart local v9  # "targetVolumeUuid":Ljava/lang/String;
    .restart local v22  # "targetScanFlags":I
    .restart local v34  # "targetParseFlags":I
    .restart local v36  # "renamedPackage":Ljava/lang/String;
    .restart local v40  # "sysPkg":Z
    :catchall_1021
    move-exception v0

    move-object v10, v0

    goto :goto_101a

    .line 18694
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "childPackages":[Lcom/android/server/pm/PackageSetting;
    .end local v4  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "existingPackage":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "pkgName1":Ljava/lang/String;
    .end local v9  # "targetVolumeUuid":Ljava/lang/String;
    .end local v22  # "targetScanFlags":I
    .end local v34  # "targetParseFlags":I
    .end local v36  # "renamedPackage":Ljava/lang/String;
    .end local v40  # "sysPkg":Z
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v18  # "onExternal":Z
    .local v44, "installFlags":I
    .local v45, "pkgName":Ljava/lang/String;
    :catchall_1024
    move-exception v0

    move/from16 v43, v18

    move/from16 v42, v44

    move-object/from16 v44, v45

    move-object/from16 v45, v14

    move-object v2, v0

    move/from16 v39, v7

    .end local v7  # "replace":Z
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v18  # "onExternal":Z
    .restart local v39  # "replace":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .local v44, "pkgName":Ljava/lang/String;
    .local v45, "pkg":Landroid/content/pm/PackageParser$Package;
    :goto_1030
    if-eqz v37, :cond_1035

    .line 18695
    invoke-virtual/range {v33 .. v33}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;->close()V

    :cond_1035
    throw v2

    .line 18407
    .end local v30  # "scanFlags":I
    .end local v35  # "systemApp":Z
    .end local v37  # "shouldCloseFreezerBeforeReturn":Z
    .end local v39  # "replace":Z
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v44  # "pkgName":Ljava/lang/String;
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v3, "scanFlags":I
    .local v4, "systemApp":Z
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v33, "installFlags":I
    .local v34, "replace":Z
    :catch_1036
    move-exception v0

    move/from16 v30, v3

    move/from16 v35, v4

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    move/from16 v42, v33

    move/from16 v39, v34

    move-object v2, v0

    .line 18408
    .end local v3  # "scanFlags":I
    .end local v4  # "systemApp":Z
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v33  # "installFlags":I
    .end local v34  # "replace":Z
    .local v2, "e":Ljava/lang/Exception;
    .restart local v30  # "scanFlags":I
    .restart local v35  # "systemApp":Z
    .restart local v39  # "replace":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .restart local v44  # "pkgName":Ljava/lang/String;
    .restart local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    new-instance v3, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failed to set up verity: "

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v5, v4}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v3

    .line 18402
    .end local v2  # "e":Ljava/lang/Exception;
    .end local v30  # "scanFlags":I
    .end local v35  # "systemApp":Z
    .end local v39  # "replace":Z
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v44  # "pkgName":Ljava/lang/String;
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v3  # "scanFlags":I
    .restart local v4  # "systemApp":Z
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v33  # "installFlags":I
    .restart local v34  # "replace":Z
    :cond_105d
    move/from16 v30, v3

    move/from16 v35, v4

    .end local v3  # "scanFlags":I
    .end local v4  # "systemApp":Z
    .restart local v30  # "scanFlags":I
    .restart local v35  # "systemApp":Z
    new-instance v2, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const/4 v3, -0x4

    const-string v4, "Failed rename"

    invoke-direct {v2, v3, v4}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v2

    .line 18394
    .end local v30  # "scanFlags":I
    .end local v35  # "systemApp":Z
    .restart local v4  # "systemApp":Z
    .local v6, "scanFlags":I
    :catch_106a
    move-exception v0

    move/from16 v35, v4

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    move/from16 v42, v33

    move/from16 v39, v34

    move-object v2, v0

    .line 18395
    .end local v4  # "systemApp":Z
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v33  # "installFlags":I
    .end local v34  # "replace":Z
    .local v2, "pme":Lcom/android/server/pm/PackageManagerException;
    .restart local v35  # "systemApp":Z
    .restart local v39  # "replace":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .restart local v44  # "pkgName":Ljava/lang/String;
    .restart local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    :goto_1078
    const-string v3, "PackageManager"

    const-string v4, "Error deriving application ABI"

    invoke-static {v3, v4, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 18396
    new-instance v3, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const-string v4, "Error deriving application ABI"

    invoke-direct {v3, v5, v4}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v3

    .line 18353
    .end local v2  # "pme":Lcom/android/server/pm/PackageManagerException;
    .end local v6  # "scanFlags":I
    .end local v35  # "systemApp":Z
    .end local v39  # "replace":Z
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v44  # "pkgName":Ljava/lang/String;
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v4  # "systemApp":Z
    .local v8, "scanFlags":I
    .restart local v12  # "onExternal":Z
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v33  # "installFlags":I
    .restart local v34  # "replace":Z
    .local v37, "pkgName":Ljava/lang/String;
    :catchall_1087
    move-exception v0

    move/from16 v35, v4

    move/from16 v43, v12

    move-object/from16 v45, v14

    move/from16 v42, v33

    move/from16 v39, v34

    move-object/from16 v44, v37

    move-object v2, v0

    move/from16 v6, v35

    move/from16 v7, v39

    move-object/from16 v5, v44

    .end local v4  # "systemApp":Z
    .end local v12  # "onExternal":Z
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v33  # "installFlags":I
    .end local v34  # "replace":Z
    .end local v37  # "pkgName":Ljava/lang/String;
    .restart local v35  # "systemApp":Z
    .restart local v39  # "replace":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .restart local v44  # "pkgName":Ljava/lang/String;
    .restart local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    goto :goto_10c3

    .end local v35  # "systemApp":Z
    .end local v39  # "replace":Z
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v44  # "pkgName":Ljava/lang/String;
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v4  # "systemApp":Z
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v33  # "installFlags":I
    .restart local v34  # "replace":Z
    :catchall_109c
    move-exception v0

    move/from16 v35, v4

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    move/from16 v42, v33

    move/from16 v39, v34

    move-object v2, v0

    move/from16 v6, v35

    move/from16 v7, v39

    move-object/from16 v5, v44

    .end local v4  # "systemApp":Z
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v33  # "installFlags":I
    .end local v34  # "replace":Z
    .restart local v35  # "systemApp":Z
    .restart local v39  # "replace":Z
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .restart local v44  # "pkgName":Ljava/lang/String;
    .restart local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    goto :goto_10c3

    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v35  # "systemApp":Z
    .end local v39  # "replace":Z
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v44  # "pkgName":Ljava/lang/String;
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v4, "installFlags":I
    .restart local v7  # "replace":Z
    .restart local v12  # "onExternal":Z
    .restart local v13  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v15, "installerPackageName":Ljava/lang/String;
    .local v22, "systemApp":Z
    :catchall_10b1
    move-exception v0

    move/from16 v42, v4

    move/from16 v39, v7

    move/from16 v43, v12

    move-object/from16 v44, v13

    move-object/from16 v45, v14

    move-object/from16 v32, v15

    move-object v2, v0

    move/from16 v6, v22

    move-object/from16 v5, v44

    .end local v4  # "installFlags":I
    .end local v12  # "onExternal":Z
    .end local v13  # "pkgName":Ljava/lang/String;
    .end local v14  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .end local v22  # "systemApp":Z
    .local v5, "pkgName":Ljava/lang/String;
    .local v6, "systemApp":Z
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .restart local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    :goto_10c3
    :try_start_10c3
    monitor-exit v9
    :try_end_10c4
    .catchall {:try_start_10c3 .. :try_end_10c4} :catchall_10c5

    throw v2

    :catchall_10c5
    move-exception v0

    move-object v2, v0

    goto :goto_10c3

    .line 18080
    .end local v6  # "systemApp":Z
    .end local v7  # "replace":Z
    .end local v29  # "pp":Landroid/content/pm/PackageParser;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v4  # "installFlags":I
    .local v10, "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v12  # "onExternal":Z
    .restart local v15  # "installerPackageName":Ljava/lang/String;
    .local v22, "pp":Landroid/content/pm/PackageParser;
    :catch_10c8
    move-exception v0

    move/from16 v42, v4

    move-object/from16 v45, v10

    move/from16 v43, v12

    move-object/from16 v32, v15

    move-object v2, v0

    .line 18081
    .end local v4  # "installFlags":I
    .end local v10  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v12  # "onExternal":Z
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .local v2, "e":Landroid/content/pm/PackageParser$PackageParserException;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .restart local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    :goto_10d2
    new-instance v3, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const-string v4, "Failed collect during installPackageLI"

    invoke-direct {v3, v4, v2}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(Ljava/lang/String;Ljava/lang/Exception;)V

    throw v3

    .line 18001
    .end local v2  # "e":Landroid/content/pm/PackageParser$PackageParserException;
    .end local v5  # "pkgName":Ljava/lang/String;
    .end local v22  # "pp":Landroid/content/pm/PackageParser;
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local v45  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v4  # "installFlags":I
    .local v9, "parseFlags":I
    .local v11, "pp":Landroid/content/pm/PackageParser;
    .restart local v12  # "onExternal":Z
    .local v13, "tmpPackageFile":Ljava/io/File;
    .local v14, "volumeUuid":Ljava/lang/String;
    .restart local v15  # "installerPackageName":Ljava/lang/String;
    :catchall_10da
    move-exception v0

    move/from16 v42, v4

    move/from16 v27, v9

    move-object/from16 v22, v11

    move/from16 v43, v12

    move-object/from16 v26, v13

    move-object/from16 v28, v14

    move-object/from16 v32, v15

    move-object v2, v0

    .end local v4  # "installFlags":I
    .end local v9  # "parseFlags":I
    .end local v11  # "pp":Landroid/content/pm/PackageParser;
    .end local v12  # "onExternal":Z
    .end local v13  # "tmpPackageFile":Ljava/io/File;
    .end local v14  # "volumeUuid":Ljava/lang/String;
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .restart local v22  # "pp":Landroid/content/pm/PackageParser;
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    goto :goto_1105

    .line 17998
    .end local v22  # "pp":Landroid/content/pm/PackageParser;
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .restart local v4  # "installFlags":I
    .restart local v9  # "parseFlags":I
    .restart local v11  # "pp":Landroid/content/pm/PackageParser;
    .restart local v12  # "onExternal":Z
    .restart local v13  # "tmpPackageFile":Ljava/io/File;
    .restart local v14  # "volumeUuid":Ljava/lang/String;
    .restart local v15  # "installerPackageName":Ljava/lang/String;
    :catch_10eb
    move-exception v0

    move/from16 v42, v4

    move/from16 v27, v9

    move-object/from16 v22, v11

    move/from16 v43, v12

    move-object/from16 v26, v13

    move-object/from16 v28, v14

    move-object/from16 v32, v15

    move-object v2, v0

    .line 17999
    .end local v4  # "installFlags":I
    .end local v9  # "parseFlags":I
    .end local v11  # "pp":Landroid/content/pm/PackageParser;
    .end local v12  # "onExternal":Z
    .end local v13  # "tmpPackageFile":Ljava/io/File;
    .end local v14  # "volumeUuid":Ljava/lang/String;
    .end local v15  # "installerPackageName":Ljava/lang/String;
    .restart local v2  # "e":Landroid/content/pm/PackageParser$PackageParserException;
    .restart local v22  # "pp":Landroid/content/pm/PackageParser;
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    :try_start_10fb
    new-instance v3, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const-string v4, "Failed parse during installPackageLI"

    invoke-direct {v3, v4, v2}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(Ljava/lang/String;Ljava/lang/Exception;)V

    .end local v8  # "scanFlags":I
    .end local v22  # "pp":Landroid/content/pm/PackageParser;
    .end local v23  # "instantApp":Z
    .end local v24  # "fullApp":Z
    .end local v25  # "virtualPreload":Z
    .end local v26  # "tmpPackageFile":Ljava/io/File;
    .end local v27  # "parseFlags":I
    .end local v28  # "volumeUuid":Ljava/lang/String;
    .end local v32  # "installerPackageName":Ljava/lang/String;
    .end local v42  # "installFlags":I
    .end local v43  # "onExternal":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    throw v3
    :try_end_1103
    .catchall {:try_start_10fb .. :try_end_1103} :catchall_1103

    .line 18001
    .end local v2  # "e":Landroid/content/pm/PackageParser$PackageParserException;
    .restart local v8  # "scanFlags":I
    .restart local v22  # "pp":Landroid/content/pm/PackageParser;
    .restart local v23  # "instantApp":Z
    .restart local v24  # "fullApp":Z
    .restart local v25  # "virtualPreload":Z
    .restart local v26  # "tmpPackageFile":Ljava/io/File;
    .restart local v27  # "parseFlags":I
    .restart local v28  # "volumeUuid":Ljava/lang/String;
    .restart local v32  # "installerPackageName":Ljava/lang/String;
    .restart local v42  # "installFlags":I
    .restart local v43  # "onExternal":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "args":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local p2  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_1103
    move-exception v0

    move-object v2, v0

    :goto_1105
    invoke-static {v6, v7}, Landroid/os/Trace;->traceEnd(J)V

    throw v2
.end method

.method private preparePackageParserCache()Ljava/io/File;
    .registers 11

    .line 3816
    sget-boolean v0, Landroid/os/Build;->IS_ENG:Z

    const/4 v1, 0x0

    if-eqz v0, :cond_6

    .line 3817
    return-object v1

    .line 3820
    :cond_6
    const/4 v0, 0x0

    const-string/jumbo v2, "pm.boot.disable_package_cache"

    invoke-static {v2, v0}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z

    move-result v2

    const-string v3, "PackageManager"

    if-eqz v2, :cond_18

    .line 3821
    const-string v0, "Disabling package parser cache due to system property."

    invoke-static {v3, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3822
    return-object v1

    .line 3826
    :cond_18
    invoke-static {}, Landroid/os/Environment;->getPackageCacheDirectory()Ljava/io/File;

    move-result-object v2

    .line 3827
    .local v2, "cacheBaseDir":Ljava/io/File;
    invoke-static {v2}, Landroid/os/FileUtils;->createDir(Ljava/io/File;)Z

    move-result v4

    if-nez v4, :cond_23

    .line 3828
    return-object v1

    .line 3834
    :cond_23
    const-string/jumbo v4, "ro.build.fingerprint"

    const-string/jumbo v5, "persist.sys.isolated_storage"

    const-string/jumbo v6, "sys.isolated_storage_snapshot"

    filled-new-array {v4, v5, v6}, [Ljava/lang/String;

    move-result-object v4

    invoke-static {v4}, Landroid/os/SystemProperties;->digestOf([Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    .line 3840
    .local v4, "cacheName":Ljava/lang/String;
    invoke-static {v2}, Landroid/os/FileUtils;->listFilesOrEmpty(Ljava/io/File;)[Ljava/io/File;

    move-result-object v5

    array-length v6, v5

    :goto_39
    if-ge v0, v6, :cond_82

    aget-object v7, v5, v0

    .line 3843
    .local v7, "cacheDir":Ljava/io/File;
    invoke-virtual {v7}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v8

    invoke-static {v4, v8}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_64

    iget-boolean v8, p0, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z

    if-nez v8, :cond_64

    .line 3845
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Keeping known cache "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v3, v8}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_7f

    .line 3847
    :cond_64
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Destroying unknown cache "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v3, v8}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 3848
    invoke-static {v7}, Landroid/os/FileUtils;->deleteContentsAndDir(Ljava/io/File;)Z

    .line 3840
    .end local v7  # "cacheDir":Ljava/io/File;
    :goto_7f
    add-int/lit8 v0, v0, 0x1

    goto :goto_39

    .line 3853
    :cond_82
    invoke-static {v2, v4}, Landroid/os/FileUtils;->createDir(Ljava/io/File;Ljava/lang/String;)Ljava/io/File;

    move-result-object v0

    .line 3855
    .local v0, "cacheDir":Ljava/io/File;
    if-nez v0, :cond_a0

    .line 3857
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Cache directory cannot be created - wiping base dir "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v3, v5}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    .line 3858
    invoke-static {v2}, Landroid/os/FileUtils;->deleteContentsAndDir(Ljava/io/File;)Z

    .line 3859
    return-object v1

    .line 3869
    :cond_a0
    sget-boolean v1, Landroid/os/Build;->IS_USERDEBUG:Z

    if-eqz v1, :cond_d1

    sget-object v1, Landroid/os/Build$VERSION;->INCREMENTAL:Ljava/lang/String;

    const-string v5, "eng."

    invoke-virtual {v1, v5}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_d1

    .line 3870
    const-string v1, "Wiping cache directory because the system partition changed."

    invoke-static {v3, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3876
    new-instance v1, Ljava/io/File;

    invoke-static {}, Landroid/os/Environment;->getRootDirectory()Ljava/io/File;

    move-result-object v3

    const-string v5, "framework"

    invoke-direct {v1, v3, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 3877
    .local v1, "frameworkDir":Ljava/io/File;
    invoke-virtual {v0}, Ljava/io/File;->lastModified()J

    move-result-wide v5

    invoke-virtual {v1}, Ljava/io/File;->lastModified()J

    move-result-wide v7

    cmp-long v3, v5, v7

    if-gez v3, :cond_d1

    .line 3878
    invoke-static {v2}, Landroid/os/FileUtils;->deleteContents(Ljava/io/File;)Z

    .line 3879
    invoke-static {v2, v4}, Landroid/os/FileUtils;->createDir(Ljava/io/File;Ljava/lang/String;)Ljava/io/File;

    move-result-object v0

    .line 3883
    .end local v1  # "frameworkDir":Ljava/io/File;
    :cond_d1
    return-object v0
.end method

.method private primeDomainVerificationsLPw(I)V
    .registers 14
    .param p1, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 4183
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    const-string v1, "PackageManager"

    if-eqz v0, :cond_1a

    .line 4184
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Priming domain verifications in user "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 4187
    :cond_1a
    invoke-static {}, Lcom/android/server/SystemConfig;->getInstance()Lcom/android/server/SystemConfig;

    move-result-object v0

    .line 4188
    .local v0, "systemConfig":Lcom/android/server/SystemConfig;
    invoke-virtual {v0}, Lcom/android/server/SystemConfig;->getLinkedApps()Landroid/util/ArraySet;

    move-result-object v2

    .line 4190
    .local v2, "packages":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    invoke-virtual {v2}, Landroid/util/ArraySet;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :goto_26
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_fe

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/String;

    .line 4191
    .local v4, "packageName":Ljava/lang/String;
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Package;

    .line 4192
    .local v5, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v5, :cond_e3

    .line 4193
    invoke-virtual {v5}, Landroid/content/pm/PackageParser$Package;->isSystem()Z

    move-result v6

    if-nez v6, :cond_5c

    .line 4194
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Non-system app \'"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, "\' in sysconfig <app-link>"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v1, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4195
    goto :goto_26

    .line 4198
    :cond_5c
    const/4 v6, 0x0

    .line 4199
    .local v6, "domains":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    iget-object v7, v5, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v7

    :goto_63
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_98

    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/pm/PackageParser$Activity;

    .line 4200
    .local v8, "a":Landroid/content/pm/PackageParser$Activity;
    iget-object v9, v8, Landroid/content/pm/PackageParser$Activity;->intents:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v9

    :goto_75
    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z

    move-result v10

    if-eqz v10, :cond_97

    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Landroid/content/pm/PackageParser$ActivityIntentInfo;

    .line 4201
    .local v10, "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    invoke-static {v10}, Lcom/android/server/pm/PackageManagerService;->hasValidDomains(Landroid/content/pm/PackageParser$ActivityIntentInfo;)Z

    move-result v11

    if-eqz v11, :cond_96

    .line 4202
    if-nez v6, :cond_8f

    .line 4203
    new-instance v11, Landroid/util/ArraySet;

    invoke-direct {v11}, Landroid/util/ArraySet;-><init>()V

    move-object v6, v11

    .line 4205
    :cond_8f
    invoke-virtual {v10}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->getHostsList()Ljava/util/ArrayList;

    move-result-object v11

    invoke-virtual {v6, v11}, Landroid/util/ArraySet;->addAll(Ljava/util/Collection;)Z

    .line 4207
    .end local v10  # "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    :cond_96
    goto :goto_75

    .line 4208
    .end local v8  # "a":Landroid/content/pm/PackageParser$Activity;
    :cond_97
    goto :goto_63

    .line 4210
    :cond_98
    if-eqz v6, :cond_c9

    invoke-virtual {v6}, Landroid/util/ArraySet;->size()I

    move-result v7

    if-lez v7, :cond_c9

    .line 4211
    sget-boolean v7, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v7, :cond_b8

    .line 4212
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "      + "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v1, v7}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 4218
    :cond_b8
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v7, v4, v6}, Lcom/android/server/pm/Settings;->createIntentFilterVerificationIfNeededLPw(Ljava/lang/String;Landroid/util/ArraySet;)Landroid/content/pm/IntentFilterVerificationInfo;

    move-result-object v7

    .line 4219
    .local v7, "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    const/4 v8, 0x0

    invoke-virtual {v7, v8}, Landroid/content/pm/IntentFilterVerificationInfo;->setStatus(I)V

    .line 4220
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/4 v9, 0x2

    invoke-virtual {v8, v4, v9, p1}, Lcom/android/server/pm/Settings;->updateIntentFilterVerificationStatusLPw(Ljava/lang/String;II)Z

    .line 4222
    .end local v7  # "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    goto :goto_e2

    .line 4223
    :cond_c9
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Sysconfig <app-link> package \'"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, "\' does not handle web links"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v1, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4226
    .end local v6  # "domains":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    :goto_e2
    goto :goto_fc

    .line 4227
    :cond_e3
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unknown package "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " in sysconfig <app-link>"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v1, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4229
    .end local v4  # "packageName":Ljava/lang/String;
    .end local v5  # "pkg":Landroid/content/pm/PackageParser$Package;
    :goto_fc
    goto/16 :goto_26

    .line 4231
    :cond_fe
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 4232
    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->scheduleWriteSettingsLocked()V

    .line 4233
    return-void
.end method

.method private processInstallRequestsAsync(ZLjava/util/List;)V
    .registers 5
    .param p1, "success"  # Z
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(Z",
            "Ljava/util/List<",
            "Lcom/android/server/pm/PackageManagerService$InstallRequest;",
            ">;)V"
        }
    .end annotation

    .line 15215
    .local p2, "installRequests":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$InstallRequest;>;"
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$6_Yp7BSB4TgtrWSoFlODKgHIvZY;

    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$6_Yp7BSB4TgtrWSoFlODKgHIvZY;-><init>(Lcom/android/server/pm/PackageManagerService;ZLjava/util/List;)V

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 15233
    return-void
.end method

.method private processPendingInstall(Lcom/android/server/pm/PackageManagerService$InstallArgs;I)V
    .registers 7
    .param p1, "args"  # Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .param p2, "currentStatus"  # I

    .line 15202
    iget-object v0, p1, Lcom/android/server/pm/PackageManagerService$InstallArgs;->mMultiPackageInstallParams:Lcom/android/server/pm/PackageManagerService$MultiPackageInstallParams;

    if-eqz v0, :cond_a

    .line 15203
    iget-object v0, p1, Lcom/android/server/pm/PackageManagerService$InstallArgs;->mMultiPackageInstallParams:Lcom/android/server/pm/PackageManagerService$MultiPackageInstallParams;

    invoke-virtual {v0, p1, p2}, Lcom/android/server/pm/PackageManagerService$MultiPackageInstallParams;->tryProcessInstallRequest(Lcom/android/server/pm/PackageManagerService$InstallArgs;I)V

    goto :goto_22

    .line 15205
    :cond_a
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->createPackageInstalledInfo(I)Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    move-result-object v0

    .line 15206
    .local v0, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    iget v1, v0, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    const/4 v2, 0x1

    if-ne v1, v2, :cond_14

    goto :goto_15

    :cond_14
    const/4 v2, 0x0

    :goto_15
    new-instance v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    const/4 v3, 0x0

    invoke-direct {v1, p1, v0, v3}, Lcom/android/server/pm/PackageManagerService$InstallRequest;-><init>(Lcom/android/server/pm/PackageManagerService$InstallArgs;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Lcom/android/server/pm/PackageManagerService$1;)V

    .line 15208
    invoke-static {v1}, Ljava/util/Collections;->singletonList(Ljava/lang/Object;)Ljava/util/List;

    move-result-object v1

    .line 15206
    invoke-direct {p0, v2, v1}, Lcom/android/server/pm/PackageManagerService;->processInstallRequestsAsync(ZLjava/util/List;)V

    .line 15210
    .end local v0  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :goto_22
    return-void
.end method

.method private pruneUnusedStaticSharedLibraries(JJ)Z
    .registers 25
    .param p1, "neededSpace"  # J
    .param p3, "maxCachePeriod"  # J
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .line 5127
    move-object/from16 v7, p0

    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v1, Landroid/os/storage/StorageManager;

    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    move-object v8, v0

    check-cast v8, Landroid/os/storage/StorageManager;

    .line 5128
    .local v8, "storage":Landroid/os/storage/StorageManager;
    sget-object v0, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    invoke-virtual {v8, v0}, Landroid/os/storage/StorageManager;->findPathForUuid(Ljava/lang/String;)Ljava/io/File;

    move-result-object v9

    .line 5130
    .local v9, "volume":Ljava/io/File;
    const/4 v1, 0x0

    .line 5131
    .local v1, "packagesToDelete":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v10

    .line 5133
    .local v10, "now":J
    iget-object v2, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 5134
    :try_start_1b
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0

    .line 5135
    .local v0, "allUsers":[I
    iget-object v3, v7, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->size()I

    move-result v3
    :try_end_27
    .catchall {:try_start_1b .. :try_end_27} :catchall_110

    .line 5136
    .local v3, "libCount":I
    const/4 v4, 0x0

    move-object v12, v1

    .end local v1  # "packagesToDelete":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    .local v4, "i":I
    .local v12, "packagesToDelete":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    :goto_29
    if-ge v4, v3, :cond_d5

    .line 5137
    :try_start_2b
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    .line 5138
    invoke-virtual {v1, v4}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/util/LongSparseArray;

    .line 5139
    .local v1, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-nez v1, :cond_3c

    .line 5140
    move-object/from16 v16, v0

    move-object v15, v8

    move-wide/from16 v18, v10

    goto/16 :goto_c4

    .line 5142
    :cond_3c
    invoke-virtual {v1}, Landroid/util/LongSparseArray;->size()I

    move-result v5

    .line 5143
    .local v5, "versionCount":I
    const/4 v6, 0x0

    .local v6, "j":I
    :goto_41
    if-ge v6, v5, :cond_bd

    .line 5144
    invoke-virtual {v1, v6}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Landroid/content/pm/SharedLibraryInfo;

    .line 5146
    .local v13, "libInfo":Landroid/content/pm/SharedLibraryInfo;
    invoke-virtual {v13}, Landroid/content/pm/SharedLibraryInfo;->isStatic()Z

    move-result v14

    if-nez v14, :cond_56

    .line 5147
    move-object/from16 v16, v0

    move-object v15, v8

    move-wide/from16 v18, v10

    goto/16 :goto_c4

    .line 5152
    :cond_56
    invoke-virtual {v13}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v14

    .line 5154
    .local v14, "declaringPackage":Landroid/content/pm/VersionedPackage;
    nop

    .line 5155
    invoke-virtual {v14}, Landroid/content/pm/VersionedPackage;->getPackageName()Ljava/lang/String;

    move-result-object v15

    .line 5156
    move-object/from16 v16, v0

    move-object/from16 v17, v1

    .end local v0  # "allUsers":[I
    .end local v1  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .local v16, "allUsers":[I
    .local v17, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    invoke-virtual {v14}, Landroid/content/pm/VersionedPackage;->getLongVersionCode()J

    move-result-wide v0

    .line 5154
    invoke-direct {v7, v15, v0, v1}, Lcom/android/server/pm/PackageManagerService;->resolveInternalPackageNameLPr(Ljava/lang/String;J)Ljava/lang/String;

    move-result-object v0

    .line 5157
    .local v0, "internalPackageName":Ljava/lang/String;
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, v0}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v1
    :try_end_71
    .catchall {:try_start_2b .. :try_end_71} :catchall_cf

    .line 5160
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_ae

    move-object v15, v8

    .end local v8  # "storage":Landroid/os/storage/StorageManager;
    .local v15, "storage":Landroid/os/storage/StorageManager;
    :try_start_74
    iget-wide v7, v1, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J

    sub-long v7, v10, v7

    cmp-long v7, v7, p3

    if-gez v7, :cond_7f

    .line 5161
    move-wide/from16 v18, v10

    goto :goto_b1

    .line 5164
    :cond_7f
    iget-object v7, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-virtual {v7}, Landroid/content/pm/PackageParser$Package;->isSystem()Z

    move-result v7
    :try_end_85
    .catchall {:try_start_74 .. :try_end_85} :catchall_a8

    if-eqz v7, :cond_8a

    .line 5165
    move-wide/from16 v18, v10

    goto :goto_b1

    .line 5168
    :cond_8a
    if-nez v12, :cond_99

    .line 5169
    :try_start_8c
    new-instance v7, Ljava/util/ArrayList;

    invoke-direct {v7}, Ljava/util/ArrayList;-><init>()V
    :try_end_91
    .catchall {:try_start_8c .. :try_end_91} :catchall_93

    move-object v12, v7

    .end local v12  # "packagesToDelete":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    .local v7, "packagesToDelete":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    goto :goto_99

    .line 5175
    .end local v0  # "internalPackageName":Ljava/lang/String;
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "libCount":I
    .end local v4  # "i":I
    .end local v5  # "versionCount":I
    .end local v6  # "j":I
    .end local v7  # "packagesToDelete":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    .end local v13  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v14  # "declaringPackage":Landroid/content/pm/VersionedPackage;
    .end local v16  # "allUsers":[I
    .end local v17  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .restart local v12  # "packagesToDelete":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    :catchall_93
    move-exception v0

    move-wide/from16 v18, v10

    move-object v1, v12

    goto/16 :goto_114

    .line 5171
    .restart local v0  # "internalPackageName":Ljava/lang/String;
    .restart local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "libCount":I
    .restart local v4  # "i":I
    .restart local v5  # "versionCount":I
    .restart local v6  # "j":I
    .restart local v13  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .restart local v14  # "declaringPackage":Landroid/content/pm/VersionedPackage;
    .restart local v16  # "allUsers":[I
    .restart local v17  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    :cond_99
    :goto_99
    :try_start_99
    new-instance v7, Landroid/content/pm/VersionedPackage;
    :try_end_9b
    .catchall {:try_start_99 .. :try_end_9b} :catchall_a8

    .line 5172
    move-wide/from16 v18, v10

    .end local v10  # "now":J
    .local v18, "now":J
    :try_start_9d
    invoke-virtual {v14}, Landroid/content/pm/VersionedPackage;->getLongVersionCode()J

    move-result-wide v10

    invoke-direct {v7, v0, v10, v11}, Landroid/content/pm/VersionedPackage;-><init>(Ljava/lang/String;J)V

    .line 5171
    invoke-interface {v12, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_b1

    .line 5175
    .end local v0  # "internalPackageName":Ljava/lang/String;
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "libCount":I
    .end local v4  # "i":I
    .end local v5  # "versionCount":I
    .end local v6  # "j":I
    .end local v13  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v14  # "declaringPackage":Landroid/content/pm/VersionedPackage;
    .end local v16  # "allUsers":[I
    .end local v17  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v18  # "now":J
    .restart local v10  # "now":J
    :catchall_a8
    move-exception v0

    move-wide/from16 v18, v10

    move-object v1, v12

    .end local v10  # "now":J
    .restart local v18  # "now":J
    goto/16 :goto_114

    .line 5160
    .end local v15  # "storage":Landroid/os/storage/StorageManager;
    .end local v18  # "now":J
    .restart local v0  # "internalPackageName":Ljava/lang/String;
    .restart local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v3  # "libCount":I
    .restart local v4  # "i":I
    .restart local v5  # "versionCount":I
    .restart local v6  # "j":I
    .restart local v8  # "storage":Landroid/os/storage/StorageManager;
    .restart local v10  # "now":J
    .restart local v13  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .restart local v14  # "declaringPackage":Landroid/content/pm/VersionedPackage;
    .restart local v16  # "allUsers":[I
    .restart local v17  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    :cond_ae
    move-object v15, v8

    move-wide/from16 v18, v10

    .line 5143
    .end local v0  # "internalPackageName":Ljava/lang/String;
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v8  # "storage":Landroid/os/storage/StorageManager;
    .end local v10  # "now":J
    .end local v13  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v14  # "declaringPackage":Landroid/content/pm/VersionedPackage;
    .restart local v15  # "storage":Landroid/os/storage/StorageManager;
    .restart local v18  # "now":J
    :goto_b1
    add-int/lit8 v6, v6, 0x1

    move-object/from16 v7, p0

    move-object v8, v15

    move-object/from16 v0, v16

    move-object/from16 v1, v17

    move-wide/from16 v10, v18

    goto :goto_41

    .end local v15  # "storage":Landroid/os/storage/StorageManager;
    .end local v16  # "allUsers":[I
    .end local v17  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v18  # "now":J
    .local v0, "allUsers":[I
    .local v1, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .restart local v8  # "storage":Landroid/os/storage/StorageManager;
    .restart local v10  # "now":J
    :cond_bd
    move-object/from16 v16, v0

    move-object/from16 v17, v1

    move-object v15, v8

    move-wide/from16 v18, v10

    .line 5136
    .end local v0  # "allUsers":[I
    .end local v1  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v5  # "versionCount":I
    .end local v6  # "j":I
    .end local v8  # "storage":Landroid/os/storage/StorageManager;
    .end local v10  # "now":J
    .restart local v15  # "storage":Landroid/os/storage/StorageManager;
    .restart local v16  # "allUsers":[I
    .restart local v18  # "now":J
    :goto_c4
    add-int/lit8 v4, v4, 0x1

    move-object/from16 v7, p0

    move-object v8, v15

    move-object/from16 v0, v16

    move-wide/from16 v10, v18

    goto/16 :goto_29

    .line 5175
    .end local v3  # "libCount":I
    .end local v4  # "i":I
    .end local v15  # "storage":Landroid/os/storage/StorageManager;
    .end local v16  # "allUsers":[I
    .end local v18  # "now":J
    .restart local v8  # "storage":Landroid/os/storage/StorageManager;
    .restart local v10  # "now":J
    :catchall_cf
    move-exception v0

    move-object v15, v8

    move-wide/from16 v18, v10

    move-object v1, v12

    .end local v8  # "storage":Landroid/os/storage/StorageManager;
    .end local v10  # "now":J
    .restart local v15  # "storage":Landroid/os/storage/StorageManager;
    .restart local v18  # "now":J
    goto :goto_114

    .line 5136
    .end local v15  # "storage":Landroid/os/storage/StorageManager;
    .end local v18  # "now":J
    .restart local v0  # "allUsers":[I
    .restart local v3  # "libCount":I
    .restart local v4  # "i":I
    .restart local v8  # "storage":Landroid/os/storage/StorageManager;
    .restart local v10  # "now":J
    :cond_d5
    move-object/from16 v16, v0

    move-object v15, v8

    move-wide/from16 v18, v10

    .line 5175
    .end local v0  # "allUsers":[I
    .end local v3  # "libCount":I
    .end local v4  # "i":I
    .end local v8  # "storage":Landroid/os/storage/StorageManager;
    .end local v10  # "now":J
    .restart local v15  # "storage":Landroid/os/storage/StorageManager;
    .restart local v18  # "now":J
    monitor-exit v2
    :try_end_db
    .catchall {:try_start_9d .. :try_end_db} :catchall_10d

    .line 5177
    if-eqz v12, :cond_10b

    .line 5178
    invoke-interface {v12}, Ljava/util/List;->size()I

    move-result v0

    .line 5179
    .local v0, "packageCount":I
    const/4 v1, 0x0

    move v7, v1

    .local v7, "i":I
    :goto_e3
    if-ge v7, v0, :cond_10b

    .line 5180
    invoke-interface {v12, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    move-object v8, v1

    check-cast v8, Landroid/content/pm/VersionedPackage;

    .line 5182
    .local v8, "pkgToDelete":Landroid/content/pm/VersionedPackage;
    invoke-virtual {v8}, Landroid/content/pm/VersionedPackage;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v8}, Landroid/content/pm/VersionedPackage;->getLongVersionCode()J

    move-result-wide v3

    const/4 v5, 0x0

    const/4 v6, 0x2

    move-object/from16 v1, p0

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->deletePackageX(Ljava/lang/String;JII)I

    move-result v1

    const/4 v2, 0x1

    if-ne v1, v2, :cond_108

    .line 5185
    invoke-virtual {v9}, Ljava/io/File;->getUsableSpace()J

    move-result-wide v3

    cmp-long v1, v3, p1

    if-ltz v1, :cond_108

    .line 5186
    return v2

    .line 5179
    .end local v8  # "pkgToDelete":Landroid/content/pm/VersionedPackage;
    :cond_108
    add-int/lit8 v7, v7, 0x1

    goto :goto_e3

    .line 5192
    .end local v0  # "packageCount":I
    .end local v7  # "i":I
    :cond_10b
    const/4 v0, 0x0

    return v0

    .line 5175
    :catchall_10d
    move-exception v0

    move-object v1, v12

    goto :goto_114

    .end local v12  # "packagesToDelete":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    .end local v15  # "storage":Landroid/os/storage/StorageManager;
    .end local v18  # "now":J
    .local v1, "packagesToDelete":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    .local v8, "storage":Landroid/os/storage/StorageManager;
    .restart local v10  # "now":J
    :catchall_110
    move-exception v0

    move-object v15, v8

    move-wide/from16 v18, v10

    .end local v8  # "storage":Landroid/os/storage/StorageManager;
    .end local v10  # "now":J
    .restart local v15  # "storage":Landroid/os/storage/StorageManager;
    .restart local v18  # "now":J
    :goto_114
    :try_start_114
    monitor-exit v2
    :try_end_115
    .catchall {:try_start_114 .. :try_end_115} :catchall_116

    throw v0

    :catchall_116
    move-exception v0

    goto :goto_114
.end method

.method private queryCrossProfileIntents(Ljava/util/List;Landroid/content/Intent;Ljava/lang/String;IIZ)Landroid/content/pm/ResolveInfo;
    .registers 22
    .param p2, "intent"  # Landroid/content/Intent;
    .param p3, "resolvedType"  # Ljava/lang/String;
    .param p4, "flags"  # I
    .param p5, "sourceUserId"  # I
    .param p6, "matchInCurrentProfile"  # Z
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Lcom/android/server/pm/CrossProfileIntentFilter;",
            ">;",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "IIZ)",
            "Landroid/content/pm/ResolveInfo;"
        }
    .end annotation

    .line 8231
    .local p1, "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    move-object/from16 v0, p1

    if-eqz v0, :cond_57

    .line 8235
    new-instance v1, Landroid/util/SparseBooleanArray;

    invoke-direct {v1}, Landroid/util/SparseBooleanArray;-><init>()V

    .line 8236
    .local v1, "alreadyTriedUserIds":Landroid/util/SparseBooleanArray;
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v2

    .line 8237
    .local v2, "size":I
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_e
    if-ge v3, v2, :cond_57

    .line 8238
    invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/CrossProfileIntentFilter;

    .line 8239
    .local v4, "filter":Lcom/android/server/pm/CrossProfileIntentFilter;
    invoke-virtual {v4}, Lcom/android/server/pm/CrossProfileIntentFilter;->getTargetUserId()I

    move-result v11

    .line 8240
    .local v11, "targetUserId":I
    nop

    .line 8241
    invoke-virtual {v4}, Lcom/android/server/pm/CrossProfileIntentFilter;->getFlags()I

    move-result v5

    and-int/lit8 v5, v5, 0x2

    const/4 v6, 0x0

    const/4 v12, 0x1

    if-eqz v5, :cond_27

    move v5, v12

    goto :goto_28

    :cond_27
    move v5, v6

    :goto_28
    move v13, v5

    .line 8242
    .local v13, "skipCurrentProfile":Z
    nop

    .line 8243
    invoke-virtual {v4}, Lcom/android/server/pm/CrossProfileIntentFilter;->getFlags()I

    move-result v5

    and-int/lit8 v5, v5, 0x4

    if-eqz v5, :cond_33

    move v6, v12

    :cond_33
    move v14, v6

    .line 8244
    .local v14, "skipCurrentProfileIfNoMatchFound":Z
    if-nez v13, :cond_54

    invoke-virtual {v1, v11}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v5

    if-nez v5, :cond_54

    if-eqz v14, :cond_40

    if-nez p6, :cond_54

    .line 8248
    :cond_40
    move-object v5, p0

    move-object v6, v4

    move-object/from16 v7, p2

    move-object/from16 v8, p3

    move/from16 v9, p4

    move/from16 v10, p5

    invoke-direct/range {v5 .. v10}, Lcom/android/server/pm/PackageManagerService;->createForwardingResolveInfo(Lcom/android/server/pm/CrossProfileIntentFilter;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;

    move-result-object v5

    .line 8250
    .local v5, "resolveInfo":Landroid/content/pm/ResolveInfo;
    if-eqz v5, :cond_51

    return-object v5

    .line 8251
    :cond_51
    invoke-virtual {v1, v11, v12}, Landroid/util/SparseBooleanArray;->put(IZ)V

    .line 8237
    .end local v4  # "filter":Lcom/android/server/pm/CrossProfileIntentFilter;
    .end local v5  # "resolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v11  # "targetUserId":I
    .end local v13  # "skipCurrentProfile":Z
    .end local v14  # "skipCurrentProfileIfNoMatchFound":Z
    :cond_54
    add-int/lit8 v3, v3, 0x1

    goto :goto_e

    .line 8255
    .end local v1  # "alreadyTriedUserIds":Landroid/util/SparseBooleanArray;
    .end local v2  # "size":I
    .end local v3  # "i":I
    :cond_57
    const/4 v1, 0x0

    return-object v1
.end method

.method private queryInstrumentationInternal(Ljava/lang/String;I)Ljava/util/List;
    .registers 8
    .param p1, "targetPackage"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "I)",
            "Ljava/util/List<",
            "Landroid/content/pm/InstrumentationInfo;",
            ">;"
        }
    .end annotation

    .line 9434
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 9437
    .local v0, "finalList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/InstrumentationInfo;>;"
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 9438
    :try_start_8
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mInstrumentation:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .line 9439
    .local v2, "i":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Instrumentation;>;"
    :goto_12
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_34

    .line 9440
    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Instrumentation;

    .line 9441
    .local v3, "p":Landroid/content/pm/PackageParser$Instrumentation;
    if-eqz p1, :cond_2a

    iget-object v4, v3, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v4, v4, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    .line 9442
    invoke-virtual {p1, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_33

    .line 9443
    :cond_2a
    invoke-static {v3, p2}, Landroid/content/pm/PackageParser;->generateInstrumentationInfo(Landroid/content/pm/PackageParser$Instrumentation;I)Landroid/content/pm/InstrumentationInfo;

    move-result-object v4

    .line 9445
    .local v4, "ii":Landroid/content/pm/InstrumentationInfo;
    if-eqz v4, :cond_33

    .line 9446
    invoke-virtual {v0, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 9449
    .end local v3  # "p":Landroid/content/pm/PackageParser$Instrumentation;
    .end local v4  # "ii":Landroid/content/pm/InstrumentationInfo;
    :cond_33
    goto :goto_12

    .line 9450
    .end local v2  # "i":Ljava/util/Iterator;, "Ljava/util/Iterator<Landroid/content/pm/PackageParser$Instrumentation;>;"
    :cond_34
    monitor-exit v1

    .line 9452
    return-object v0

    .line 9450
    :catchall_36
    move-exception v2

    monitor-exit v1
    :try_end_38
    .catchall {:try_start_8 .. :try_end_38} :catchall_36

    throw v2
.end method

.method private queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;
    .registers 13
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "II)",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 7508
    nop

    .line 7509
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v4

    .line 7508
    const/4 v6, 0x0

    const/4 v7, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move v3, p3

    move v5, p4

    invoke-direct/range {v0 .. v7}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZZ)Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method private queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZZ)Ljava/util/List;
    .registers 33
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "filterCallingUid"  # I
    .param p5, "userId"  # I
    .param p6, "resolveForStart"  # Z
    .param p7, "allowDynamicSplits"  # Z
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "IIIZZ)",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 7516
    move-object/from16 v15, p0

    move-object/from16 v14, p2

    move/from16 v13, p5

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v13}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_13

    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v0

    return-object v0

    .line 7517
    :cond_13
    move/from16 v12, p4

    invoke-direct {v15, v12}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v11

    .line 7518
    .local v11, "instantAppPkgName":Ljava/lang/String;
    iget-object v1, v15, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    const/4 v4, 0x0

    const/4 v5, 0x0

    const-string/jumbo v6, "query intent activities"

    move/from16 v3, p5

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 7521
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getPackage()Ljava/lang/String;

    move-result-object v10

    .line 7522
    .local v10, "pkgName":Ljava/lang/String;
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    .line 7523
    .local v0, "comp":Landroid/content/ComponentName;
    if-nez v0, :cond_44

    .line 7524
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object v1

    if-eqz v1, :cond_44

    .line 7525
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object v1

    .line 7526
    .end local p1  # "intent":Landroid/content/Intent;
    .local v1, "intent":Landroid/content/Intent;
    invoke-virtual {v1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    move-object v8, v0

    move-object v9, v1

    goto :goto_47

    .line 7530
    .end local v1  # "intent":Landroid/content/Intent;
    .restart local p1  # "intent":Landroid/content/Intent;
    :cond_44
    move-object/from16 v9, p1

    move-object v8, v0

    .end local v0  # "comp":Landroid/content/ComponentName;
    .end local p1  # "intent":Landroid/content/Intent;
    .local v8, "comp":Landroid/content/ComponentName;
    .local v9, "intent":Landroid/content/Intent;
    :goto_47
    const/4 v7, 0x1

    if-nez v8, :cond_50

    if-eqz v10, :cond_4d

    goto :goto_50

    :cond_4d
    const/16 v16, 0x0

    goto :goto_52

    :cond_50
    :goto_50
    move/from16 v16, v7

    :goto_52
    move-object/from16 v1, p0

    move/from16 v2, p3

    move/from16 v3, p5

    move-object v4, v9

    move/from16 v5, p4

    move/from16 v6, p6

    move v0, v7

    move/from16 v7, v16

    invoke-virtual/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZZ)I

    move-result v7

    .line 7532
    .end local p3  # "flags":I
    .local v7, "flags":I
    if-eqz v8, :cond_110

    .line 7533
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1, v0}, Ljava/util/ArrayList;-><init>(I)V

    move-object v6, v1

    .line 7534
    .local v6, "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-virtual {v15, v8, v7, v13}, Lcom/android/server/pm/PackageManagerService;->getActivityInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ActivityInfo;

    move-result-object v5

    .line 7535
    .local v5, "ai":Landroid/content/pm/ActivityInfo;
    if-eqz v5, :cond_f4

    .line 7540
    const/high16 v1, 0x800000

    and-int/2addr v1, v7

    if-eqz v1, :cond_79

    move v1, v0

    goto :goto_7a

    :cond_79
    const/4 v1, 0x0

    .line 7542
    .local v1, "matchInstantApp":Z
    :goto_7a
    const/high16 v2, 0x1000000

    and-int/2addr v2, v7

    if-eqz v2, :cond_81

    move v2, v0

    goto :goto_82

    :cond_81
    const/4 v2, 0x0

    .line 7544
    .local v2, "matchVisibleToInstantAppOnly":Z
    :goto_82
    const/high16 v3, 0x2000000

    and-int/2addr v3, v7

    if-eqz v3, :cond_89

    move v3, v0

    goto :goto_8a

    :cond_89
    const/4 v3, 0x0

    .line 7546
    .local v3, "matchExplicitlyVisibleOnly":Z
    :goto_8a
    if-eqz v11, :cond_8e

    move v4, v0

    goto :goto_8f

    :cond_8e
    const/4 v4, 0x0

    .line 7548
    .local v4, "isCallerInstantApp":Z
    :goto_8f
    nop

    .line 7549
    invoke-virtual {v8}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {v0, v11}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    .line 7550
    .local v0, "isTargetSameInstantApp":Z
    move/from16 p3, v7

    .end local v7  # "flags":I
    .restart local p3  # "flags":I
    iget-object v7, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    and-int/lit16 v7, v7, 0x80

    if-eqz v7, :cond_a4

    const/4 v7, 0x1

    goto :goto_a5

    :cond_a4
    const/4 v7, 0x0

    .line 7553
    .local v7, "isTargetInstantApp":Z
    :goto_a5
    move-object/from16 v17, v8

    .end local v8  # "comp":Landroid/content/ComponentName;
    .local v17, "comp":Landroid/content/ComponentName;
    iget v8, v5, Landroid/content/pm/ActivityInfo;->flags:I

    const/high16 v18, 0x100000

    and-int v8, v8, v18

    if-eqz v8, :cond_b1

    const/4 v8, 0x1

    goto :goto_b2

    :cond_b1
    const/4 v8, 0x0

    .line 7555
    .local v8, "isTargetVisibleToInstantApp":Z
    :goto_b2
    if-eqz v8, :cond_be

    iget v12, v5, Landroid/content/pm/ActivityInfo;->flags:I

    const/high16 v18, 0x200000

    and-int v12, v12, v18

    if-nez v12, :cond_be

    const/4 v12, 0x1

    goto :goto_bf

    :cond_be
    const/4 v12, 0x0

    .line 7558
    .local v12, "isTargetExplicitlyVisibleToInstantApp":Z
    :goto_bf
    if-eqz v8, :cond_c9

    if-eqz v3, :cond_c6

    if-nez v12, :cond_c6

    goto :goto_c9

    :cond_c6
    const/16 v18, 0x0

    goto :goto_cb

    :cond_c9
    :goto_c9
    const/16 v18, 0x1

    .line 7561
    .local v18, "isTargetHiddenFromInstantApp":Z
    :goto_cb
    if-nez v0, :cond_dc

    if-nez v1, :cond_d3

    if-nez v4, :cond_d3

    if-nez v7, :cond_d9

    :cond_d3
    if-eqz v2, :cond_dc

    if-eqz v4, :cond_dc

    if-eqz v18, :cond_dc

    :cond_d9
    const/16 v16, 0x1

    goto :goto_de

    :cond_dc
    const/16 v16, 0x0

    .line 7566
    .local v16, "blockResolution":Z
    :goto_de
    if-nez v16, :cond_f1

    .line 7567
    new-instance v19, Landroid/content/pm/ResolveInfo;

    invoke-direct/range {v19 .. v19}, Landroid/content/pm/ResolveInfo;-><init>()V

    move-object/from16 p1, v19

    .line 7568
    .local p1, "ri":Landroid/content/pm/ResolveInfo;
    move/from16 v19, v0

    move-object/from16 v0, p1

    .end local p1  # "ri":Landroid/content/pm/ResolveInfo;
    .local v0, "ri":Landroid/content/pm/ResolveInfo;
    .local v19, "isTargetSameInstantApp":Z
    iput-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 7569
    invoke-interface {v6, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_f8

    .line 7566
    .end local v19  # "isTargetSameInstantApp":Z
    .local v0, "isTargetSameInstantApp":Z
    :cond_f1
    move/from16 v19, v0

    .end local v0  # "isTargetSameInstantApp":Z
    .restart local v19  # "isTargetSameInstantApp":Z
    goto :goto_f8

    .line 7535
    .end local v1  # "matchInstantApp":Z
    .end local v2  # "matchVisibleToInstantAppOnly":Z
    .end local v3  # "matchExplicitlyVisibleOnly":Z
    .end local v4  # "isCallerInstantApp":Z
    .end local v12  # "isTargetExplicitlyVisibleToInstantApp":Z
    .end local v16  # "blockResolution":Z
    .end local v17  # "comp":Landroid/content/ComponentName;
    .end local v18  # "isTargetHiddenFromInstantApp":Z
    .end local v19  # "isTargetSameInstantApp":Z
    .end local p3  # "flags":I
    .local v7, "flags":I
    .local v8, "comp":Landroid/content/ComponentName;
    :cond_f4
    move/from16 p3, v7

    move-object/from16 v17, v8

    .line 7572
    .end local v7  # "flags":I
    .end local v8  # "comp":Landroid/content/ComponentName;
    .restart local v17  # "comp":Landroid/content/ComponentName;
    .restart local p3  # "flags":I
    :goto_f8
    move-object/from16 v1, p0

    move-object v2, v6

    move-object v3, v11

    move/from16 v4, p7

    move-object v0, v5

    .end local v5  # "ai":Landroid/content/pm/ActivityInfo;
    .local v0, "ai":Landroid/content/pm/ActivityInfo;
    move/from16 v5, p4

    move-object v12, v6

    .end local v6  # "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v12, "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    move/from16 v6, p6

    move/from16 v8, p3

    .end local p3  # "flags":I
    .local v8, "flags":I
    move/from16 v7, p5

    move-object/from16 v18, v17

    .end local v8  # "flags":I
    .end local v17  # "comp":Landroid/content/ComponentName;
    .local v18, "comp":Landroid/content/ComponentName;
    .restart local p3  # "flags":I
    move-object v8, v9

    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->applyPostResolutionFilter(Ljava/util/List;Ljava/lang/String;ZIZILandroid/content/Intent;)Ljava/util/List;

    move-result-object v1

    return-object v1

    .line 7578
    .end local v0  # "ai":Landroid/content/pm/ActivityInfo;
    .end local v12  # "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v18  # "comp":Landroid/content/ComponentName;
    .end local p3  # "flags":I
    .restart local v7  # "flags":I
    .local v8, "comp":Landroid/content/ComponentName;
    :cond_110
    move/from16 p3, v7

    move-object/from16 v18, v8

    .end local v7  # "flags":I
    .end local v8  # "comp":Landroid/content/ComponentName;
    .restart local v18  # "comp":Landroid/content/ComponentName;
    .restart local p3  # "flags":I
    const/4 v12, 0x0

    .line 7579
    .local v12, "sortResult":Z
    const/16 v17, 0x0

    .line 7581
    .local v17, "addInstant":Z
    iget-object v8, v15, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8

    .line 7582
    if-nez v10, :cond_33f

    .line 7583
    nop

    .line 7584
    :try_start_11d
    invoke-direct {v15, v9, v14, v13}, Lcom/android/server/pm/PackageManagerService;->getMatchingCrossProfileIntentFilters(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;

    move-result-object v2

    .line 7586
    .local v2, "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    move-object/from16 v1, p0

    move-object v3, v9

    move-object/from16 v4, p2

    move/from16 v5, p3

    move/from16 v6, p5

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->querySkipCurrentProfileIntents(Ljava/util/List;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;

    move-result-object v0
    :try_end_12e
    .catchall {:try_start_11d .. :try_end_12e} :catchall_331

    .line 7589
    .local v0, "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    if-eqz v0, :cond_177

    :try_start_130
    invoke-static/range {p5 .. p5}, Landroid/os/UserHandle;->isMultiOpenUserId(I)Z

    move-result v1

    if-nez v1, :cond_177

    .line 7591
    new-instance v1, Ljava/util/ArrayList;

    const/4 v3, 0x1

    invoke-direct {v1, v3}, Ljava/util/ArrayList;-><init>(I)V

    .line 7592
    .local v1, "xpResult":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {v1, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 7593
    nop

    .line 7594
    invoke-direct {v15, v1, v13}, Lcom/android/server/pm/PackageManagerService;->filterIfNotSystemUser(Ljava/util/List;I)Ljava/util/List;

    move-result-object v4
    :try_end_144
    .catchall {:try_start_130 .. :try_end_144} :catchall_16a

    .line 7593
    move-object/from16 v3, p0

    move-object v5, v11

    move/from16 v6, p7

    move/from16 v7, p4

    move-object/from16 v19, v8

    move/from16 v8, p6

    move-object/from16 v20, v9

    .end local v9  # "intent":Landroid/content/Intent;
    .local v20, "intent":Landroid/content/Intent;
    move/from16 v9, p5

    move-object/from16 p1, v1

    move-object v1, v10

    .end local v10  # "pkgName":Ljava/lang/String;
    .local v1, "pkgName":Ljava/lang/String;
    .local p1, "xpResult":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    move-object/from16 v10, v20

    :try_start_158
    invoke-direct/range {v3 .. v10}, Lcom/android/server/pm/PackageManagerService;->applyPostResolutionFilter(Ljava/util/List;Ljava/lang/String;ZIZILandroid/content/Intent;)Ljava/util/List;

    move-result-object v3

    monitor-exit v19
    :try_end_15d
    .catchall {:try_start_158 .. :try_end_15d} :catchall_15e

    return-object v3

    .line 7677
    .end local v0  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v2  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .end local p1  # "xpResult":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :catchall_15e
    move-exception v0

    move/from16 v21, p3

    move-object v9, v1

    move-object/from16 v24, v11

    move v11, v13

    move-object v10, v15

    move-object/from16 v13, v20

    goto/16 :goto_3b8

    .end local v1  # "pkgName":Ljava/lang/String;
    .end local v20  # "intent":Landroid/content/Intent;
    .restart local v9  # "intent":Landroid/content/Intent;
    .restart local v10  # "pkgName":Ljava/lang/String;
    :catchall_16a
    move-exception v0

    move-object/from16 v19, v8

    move/from16 v21, p3

    move-object/from16 v24, v11

    move v11, v13

    move-object v13, v9

    move-object v9, v10

    move-object v10, v15

    .end local v9  # "intent":Landroid/content/Intent;
    .end local v10  # "pkgName":Ljava/lang/String;
    .restart local v1  # "pkgName":Ljava/lang/String;
    .restart local v20  # "intent":Landroid/content/Intent;
    goto/16 :goto_3b8

    .line 7589
    .end local v1  # "pkgName":Ljava/lang/String;
    .end local v20  # "intent":Landroid/content/Intent;
    .restart local v0  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .restart local v2  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .restart local v9  # "intent":Landroid/content/Intent;
    .restart local v10  # "pkgName":Ljava/lang/String;
    :cond_177
    move-object/from16 v19, v8

    move-object/from16 v20, v9

    move-object v1, v10

    .line 7599
    .end local v9  # "intent":Landroid/content/Intent;
    .end local v10  # "pkgName":Ljava/lang/String;
    .restart local v1  # "pkgName":Ljava/lang/String;
    .restart local v20  # "intent":Landroid/content/Intent;
    :try_start_17c
    iget-object v3, v15, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;
    :try_end_17e
    .catchall {:try_start_17c .. :try_end_17e} :catchall_325

    move/from16 v8, p3

    move-object/from16 v10, v20

    .end local v20  # "intent":Landroid/content/Intent;
    .end local p3  # "flags":I
    .local v8, "flags":I
    .local v10, "intent":Landroid/content/Intent;
    :try_start_182
    invoke-virtual {v3, v10, v14, v8, v13}, Lcom/android/server/pm/ComponentResolver;->queryActivities(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v3

    invoke-direct {v15, v3, v13}, Lcom/android/server/pm/PackageManagerService;->filterIfNotSystemUser(Ljava/util/List;I)Ljava/util/List;

    move-result-object v3

    .line 7601
    .local v3, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/4 v4, 0x0

    invoke-direct {v15, v10, v3, v13, v4}, Lcom/android/server/pm/PackageManagerService;->isInstantAppResolutionAllowed(Landroid/content/Intent;Ljava/util/List;IZ)Z

    move-result v5
    :try_end_18f
    .catchall {:try_start_182 .. :try_end_18f} :catchall_31a

    move/from16 v20, v5

    .line 7604
    .end local v17  # "addInstant":Z
    .local v20, "addInstant":Z
    :try_start_191
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v4

    invoke-static {v4}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v4
    :try_end_199
    .catchall {:try_start_191 .. :try_end_199} :catchall_30d

    if-ne v4, v13, :cond_1c5

    .line 7605
    :try_start_19b
    invoke-static/range {p5 .. p5}, Landroid/os/UserHandle;->isMultiOpenUserId(I)Z

    move-result v4

    if-eqz v4, :cond_1b6

    if-eqz v3, :cond_1ac

    .line 7606
    invoke-interface {v3}, Ljava/util/List;->isEmpty()Z

    move-result v4

    if-eqz v4, :cond_1aa

    goto :goto_1ac

    :cond_1aa
    const/4 v7, 0x0

    goto :goto_1c6

    .line 7607
    :cond_1ac
    :goto_1ac
    iget-object v4, v15, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    const/4 v7, 0x0

    invoke-virtual {v4, v10, v14, v8, v7}, Lcom/android/server/pm/ComponentResolver;->queryActivities(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v4
    :try_end_1b3
    .catchall {:try_start_19b .. :try_end_1b3} :catchall_1b8

    move-object v3, v4

    move-object v6, v3

    goto :goto_1c7

    .line 7605
    :cond_1b6
    const/4 v7, 0x0

    goto :goto_1c6

    .line 7677
    .end local v0  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v2  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .end local v3  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :catchall_1b8
    move-exception v0

    move-object v9, v1

    move/from16 v21, v8

    move-object/from16 v24, v11

    move v11, v13

    move/from16 v17, v20

    move-object v13, v10

    move-object v10, v15

    goto/16 :goto_3b8

    .line 7604
    .restart local v0  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .restart local v2  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .restart local v3  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_1c5
    const/4 v7, 0x0

    .line 7612
    :goto_1c6
    move-object v6, v3

    .end local v3  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v6, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :goto_1c7
    :try_start_1c7
    invoke-direct {v15, v6}, Lcom/android/server/pm/PackageManagerService;->hasNonNegativePriority(Ljava/util/List;)Z

    move-result v9
    :try_end_1cb
    .catchall {:try_start_1c7 .. :try_end_1cb} :catchall_30d

    .line 7613
    .local v9, "hasNonNegativePriorityResult":Z
    move-object/from16 v3, p0

    move-object v4, v2

    move-object v5, v10

    move-object/from16 p1, v0

    move-object v0, v6

    .end local v6  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v0, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local p1, "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    move-object/from16 v6, p2

    move/from16 v17, v7

    move v7, v8

    move/from16 v21, v8

    .end local v8  # "flags":I
    .local v21, "flags":I
    move/from16 v8, p5

    :try_start_1db
    invoke-direct/range {v3 .. v9}, Lcom/android/server/pm/PackageManagerService;->queryCrossProfileIntents(Ljava/util/List;Landroid/content/Intent;Ljava/lang/String;IIZ)Landroid/content/pm/ResolveInfo;

    move-result-object v3
    :try_end_1df
    .catchall {:try_start_1db .. :try_end_1df} :catchall_302

    move-object v8, v3

    .line 7616
    .end local p1  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .local v8, "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    if-eqz v8, :cond_211

    :try_start_1e2
    iget v3, v8, Landroid/content/pm/ResolveInfo;->targetUserId:I

    invoke-direct {v15, v3}, Lcom/android/server/pm/PackageManagerService;->isUserEnabled(I)Z

    move-result v3

    if-eqz v3, :cond_211

    .line 7617
    nop

    .line 7618
    invoke-static {v8}, Ljava/util/Collections;->singletonList(Ljava/lang/Object;)Ljava/util/List;

    move-result-object v3

    .line 7617
    invoke-direct {v15, v3, v13}, Lcom/android/server/pm/PackageManagerService;->filterIfNotSystemUser(Ljava/util/List;I)Ljava/util/List;

    move-result-object v3

    .line 7618
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_1fb

    const/16 v17, 0x1

    :cond_1fb
    move/from16 v3, v17

    .line 7619
    .local v3, "isVisibleToUser":Z
    if-eqz v3, :cond_211

    .line 7620
    invoke-interface {v0, v8}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_202
    .catchall {:try_start_1e2 .. :try_end_202} :catchall_206

    .line 7621
    const/4 v12, 0x1

    move/from16 v22, v12

    goto :goto_213

    .line 7677
    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v2  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .end local v3  # "isVisibleToUser":Z
    .end local v8  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v9  # "hasNonNegativePriorityResult":Z
    :catchall_206
    move-exception v0

    move-object v9, v1

    move-object/from16 v24, v11

    move v11, v13

    move/from16 v17, v20

    move-object v13, v10

    move-object v10, v15

    goto/16 :goto_3b8

    .line 7624
    .restart local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v2  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .restart local v8  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .restart local v9  # "hasNonNegativePriorityResult":Z
    :cond_211
    move/from16 v22, v12

    .end local v12  # "sortResult":Z
    .local v22, "sortResult":Z
    :goto_213
    :try_start_213
    invoke-virtual {v10}, Landroid/content/Intent;->hasWebURI()Z

    move-result v3

    if-eqz v3, :cond_2e6

    .line 7625
    const/4 v12, 0x0

    .line 7626
    .local v12, "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    invoke-direct {v15, v13}, Lcom/android/server/pm/PackageManagerService;->getProfileParent(I)Landroid/content/pm/UserInfo;

    move-result-object v3
    :try_end_21e
    .catchall {:try_start_213 .. :try_end_21e} :catchall_2f5

    move-object v7, v3

    .line 7627
    .local v7, "parent":Landroid/content/pm/UserInfo;
    if-eqz v7, :cond_248

    .line 7628
    :try_start_221
    iget v6, v7, Landroid/content/pm/UserInfo;->id:I

    move-object/from16 v3, p0

    move-object v4, v10

    move-object/from16 v5, p2

    move/from16 v17, v6

    move/from16 v6, v21

    move-object/from16 v23, v7

    .end local v7  # "parent":Landroid/content/pm/UserInfo;
    .local v23, "parent":Landroid/content/pm/UserInfo;
    move/from16 v7, p5

    move-object/from16 p1, v2

    move-object v2, v8

    .end local v8  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .local v2, "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .local p1, "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    move/from16 v8, v17

    invoke-direct/range {v3 .. v8}, Lcom/android/server/pm/PackageManagerService;->getCrossProfileDomainPreferredLpr(Landroid/content/Intent;Ljava/lang/String;III)Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;

    move-result-object v3

    move-object v8, v3

    .end local v12  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .local v3, "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    goto :goto_24e

    .line 7677
    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v2  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v3  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .end local v9  # "hasNonNegativePriorityResult":Z
    .end local v23  # "parent":Landroid/content/pm/UserInfo;
    .end local p1  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    :catchall_23b
    move-exception v0

    move-object v9, v1

    move-object/from16 v24, v11

    move v11, v13

    move/from16 v17, v20

    move/from16 v12, v22

    move-object v13, v10

    move-object v10, v15

    goto/16 :goto_3b8

    .line 7627
    .restart local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v2, "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .restart local v7  # "parent":Landroid/content/pm/UserInfo;
    .restart local v8  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .restart local v9  # "hasNonNegativePriorityResult":Z
    .restart local v12  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    :cond_248
    move-object/from16 p1, v2

    move-object/from16 v23, v7

    move-object v2, v8

    .end local v7  # "parent":Landroid/content/pm/UserInfo;
    .end local v8  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .local v2, "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .restart local v23  # "parent":Landroid/content/pm/UserInfo;
    .restart local p1  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    move-object v8, v12

    .line 7631
    .end local v12  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .local v8, "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    :goto_24e
    if-eqz v8, :cond_28f

    .line 7632
    if-eqz v2, :cond_255

    .line 7635
    invoke-interface {v0, v2}, Ljava/util/List;->remove(Ljava/lang/Object;)Z
    :try_end_255
    .catchall {:try_start_221 .. :try_end_255} :catchall_23b

    .line 7637
    :cond_255
    :try_start_255
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v3

    if-nez v3, :cond_27c

    if-nez v20, :cond_27c

    .line 7641
    iget-object v3, v8, Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;->resolveInfo:Landroid/content/pm/ResolveInfo;

    invoke-interface {v0, v3}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_262
    .catchall {:try_start_255 .. :try_end_262} :catchall_282

    .line 7642
    move-object v7, v10

    .end local v10  # "intent":Landroid/content/Intent;
    .local v7, "intent":Landroid/content/Intent;
    move-object/from16 v10, p0

    move-object/from16 v24, v11

    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .local v24, "instantAppPkgName":Ljava/lang/String;
    move-object v11, v0

    move-object/from16 v12, v24

    move v6, v13

    move/from16 v13, p7

    move/from16 v14, p4

    move-object v5, v15

    move/from16 v15, p6

    move/from16 v16, p5

    move-object/from16 v17, v7

    :try_start_276
    invoke-direct/range {v10 .. v17}, Lcom/android/server/pm/PackageManagerService;->applyPostResolutionFilter(Ljava/util/List;Ljava/lang/String;ZIZILandroid/content/Intent;)Ljava/util/List;

    move-result-object v3

    monitor-exit v19
    :try_end_27b
    .catchall {:try_start_276 .. :try_end_27b} :catchall_2b2

    return-object v3

    .line 7637
    .end local v7  # "intent":Landroid/content/Intent;
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .restart local v10  # "intent":Landroid/content/Intent;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    :cond_27c
    move-object v7, v10

    move-object/from16 v24, v11

    move v6, v13

    move-object v5, v15

    .end local v10  # "intent":Landroid/content/Intent;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v7  # "intent":Landroid/content/Intent;
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    goto :goto_2bd

    .line 7677
    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v2  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v7  # "intent":Landroid/content/Intent;
    .end local v8  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .end local v9  # "hasNonNegativePriorityResult":Z
    .end local v23  # "parent":Landroid/content/pm/UserInfo;
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .end local p1  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .restart local v10  # "intent":Landroid/content/Intent;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    :catchall_282
    move-exception v0

    move-object/from16 v24, v11

    move-object v9, v1

    move v11, v13

    move/from16 v17, v20

    move/from16 v12, v22

    move-object v13, v10

    move-object v10, v15

    .end local v10  # "intent":Landroid/content/Intent;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v7  # "intent":Landroid/content/Intent;
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    goto/16 :goto_3b8

    .line 7646
    .end local v7  # "intent":Landroid/content/Intent;
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .restart local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v2  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .restart local v8  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .restart local v9  # "hasNonNegativePriorityResult":Z
    .restart local v10  # "intent":Landroid/content/Intent;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v23  # "parent":Landroid/content/pm/UserInfo;
    .restart local p1  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    :cond_28f
    move-object v7, v10

    move-object/from16 v24, v11

    move v6, v13

    move-object v5, v15

    .end local v10  # "intent":Landroid/content/Intent;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v7  # "intent":Landroid/content/Intent;
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    :try_start_294
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v3
    :try_end_298
    .catchall {:try_start_294 .. :try_end_298} :catchall_2db

    const/4 v4, 0x1

    if-gt v3, v4, :cond_2bd

    if-nez v20, :cond_2bd

    .line 7650
    move-object/from16 v10, p0

    move-object v11, v0

    move-object/from16 v12, v24

    move/from16 v13, p7

    move/from16 v14, p4

    move/from16 v15, p6

    move/from16 v16, p5

    move-object/from16 v17, v7

    :try_start_2ac
    invoke-direct/range {v10 .. v17}, Lcom/android/server/pm/PackageManagerService;->applyPostResolutionFilter(Ljava/util/List;Ljava/lang/String;ZIZILandroid/content/Intent;)Ljava/util/List;

    move-result-object v3

    monitor-exit v19
    :try_end_2b1
    .catchall {:try_start_2ac .. :try_end_2b1} :catchall_2b2

    return-object v3

    .line 7677
    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v2  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v8  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .end local v9  # "hasNonNegativePriorityResult":Z
    .end local v23  # "parent":Landroid/content/pm/UserInfo;
    .end local p1  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    :catchall_2b2
    move-exception v0

    move-object v9, v1

    move-object v10, v5

    move v11, v6

    move-object v13, v7

    move/from16 v17, v20

    move/from16 v12, v22

    goto/16 :goto_3b8

    .line 7656
    .restart local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v2  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .restart local v8  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .restart local v9  # "hasNonNegativePriorityResult":Z
    .restart local v23  # "parent":Landroid/content/pm/UserInfo;
    .restart local p1  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    :cond_2bd
    :goto_2bd
    move-object/from16 v3, p0

    move-object v4, v7

    move-object v10, v5

    move/from16 v5, v21

    move v11, v6

    move-object v6, v0

    move-object v13, v7

    .end local v7  # "intent":Landroid/content/Intent;
    .local v13, "intent":Landroid/content/Intent;
    move-object v7, v8

    move-object v12, v8

    .end local v8  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .restart local v12  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    move/from16 v8, p5

    :try_start_2ca
    invoke-direct/range {v3 .. v8}, Lcom/android/server/pm/PackageManagerService;->filterCandidatesWithDomainPreferredActivitiesLPr(Landroid/content/Intent;ILjava/util/List;Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;I)Ljava/util/List;

    move-result-object v3
    :try_end_2ce
    .catchall {:try_start_2ca .. :try_end_2ce} :catchall_2d3

    move-object v6, v3

    .line 7658
    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v6  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/4 v0, 0x1

    move v12, v0

    move-object v0, v6

    .end local v22  # "sortResult":Z
    .local v0, "sortResult":Z
    goto :goto_2f0

    .line 7677
    .end local v0  # "sortResult":Z
    .end local v2  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v6  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v9  # "hasNonNegativePriorityResult":Z
    .end local v12  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .end local v23  # "parent":Landroid/content/pm/UserInfo;
    .end local p1  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .restart local v22  # "sortResult":Z
    :catchall_2d3
    move-exception v0

    move-object v9, v1

    move/from16 v17, v20

    move/from16 v12, v22

    goto/16 :goto_3b8

    .end local v13  # "intent":Landroid/content/Intent;
    .restart local v7  # "intent":Landroid/content/Intent;
    :catchall_2db
    move-exception v0

    move-object v10, v5

    move v11, v6

    move-object v13, v7

    move-object v9, v1

    move/from16 v17, v20

    move/from16 v12, v22

    .end local v7  # "intent":Landroid/content/Intent;
    .restart local v13  # "intent":Landroid/content/Intent;
    goto/16 :goto_3b8

    .line 7624
    .end local v13  # "intent":Landroid/content/Intent;
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .local v0, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v2, "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .local v8, "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .restart local v9  # "hasNonNegativePriorityResult":Z
    .restart local v10  # "intent":Landroid/content/Intent;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    :cond_2e6
    move-object/from16 p1, v2

    move-object v2, v8

    move-object/from16 v24, v11

    move v11, v13

    move-object v13, v10

    move-object v10, v15

    .end local v8  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v10  # "intent":Landroid/content/Intent;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .local v2, "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .restart local v13  # "intent":Landroid/content/Intent;
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    .restart local p1  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    move/from16 v12, v22

    .line 7660
    .end local v2  # "xpResolveInfo":Landroid/content/pm/ResolveInfo;
    .end local v9  # "hasNonNegativePriorityResult":Z
    .end local v22  # "sortResult":Z
    .end local p1  # "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    .local v12, "sortResult":Z
    :goto_2f0
    move-object v9, v1

    move/from16 v17, v20

    goto/16 :goto_389

    .line 7677
    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v12  # "sortResult":Z
    .end local v13  # "intent":Landroid/content/Intent;
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .restart local v10  # "intent":Landroid/content/Intent;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v22  # "sortResult":Z
    :catchall_2f5
    move-exception v0

    move-object/from16 v24, v11

    move v11, v13

    move-object v13, v10

    move-object v10, v15

    move-object v9, v1

    move/from16 v17, v20

    move/from16 v12, v22

    .end local v10  # "intent":Landroid/content/Intent;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v13  # "intent":Landroid/content/Intent;
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    goto/16 :goto_3b8

    .end local v13  # "intent":Landroid/content/Intent;
    .end local v22  # "sortResult":Z
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .restart local v10  # "intent":Landroid/content/Intent;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v12  # "sortResult":Z
    :catchall_302
    move-exception v0

    move-object/from16 v24, v11

    move v11, v13

    move-object v13, v10

    move-object v10, v15

    move-object v9, v1

    move/from16 v17, v20

    .end local v10  # "intent":Landroid/content/Intent;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v13  # "intent":Landroid/content/Intent;
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    goto/16 :goto_3b8

    .end local v13  # "intent":Landroid/content/Intent;
    .end local v21  # "flags":I
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .local v8, "flags":I
    .restart local v10  # "intent":Landroid/content/Intent;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    :catchall_30d
    move-exception v0

    move/from16 v21, v8

    move-object/from16 v24, v11

    move v11, v13

    move-object v13, v10

    move-object v10, v15

    move-object v9, v1

    move/from16 v17, v20

    .end local v8  # "flags":I
    .end local v10  # "intent":Landroid/content/Intent;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v13  # "intent":Landroid/content/Intent;
    .restart local v21  # "flags":I
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    goto/16 :goto_3b8

    .end local v13  # "intent":Landroid/content/Intent;
    .end local v20  # "addInstant":Z
    .end local v21  # "flags":I
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .restart local v8  # "flags":I
    .restart local v10  # "intent":Landroid/content/Intent;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v17  # "addInstant":Z
    :catchall_31a
    move-exception v0

    move/from16 v21, v8

    move-object/from16 v24, v11

    move v11, v13

    move-object v13, v10

    move-object v10, v15

    move-object v9, v1

    .end local v8  # "flags":I
    .end local v10  # "intent":Landroid/content/Intent;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local v13  # "intent":Landroid/content/Intent;
    .restart local v21  # "flags":I
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    goto/16 :goto_3b8

    .end local v13  # "intent":Landroid/content/Intent;
    .end local v21  # "flags":I
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    .local v20, "intent":Landroid/content/Intent;
    .restart local p3  # "flags":I
    :catchall_325
    move-exception v0

    move/from16 v21, p3

    move-object/from16 v24, v11

    move v11, v13

    move-object v10, v15

    move-object/from16 v13, v20

    move-object v9, v1

    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .end local v20  # "intent":Landroid/content/Intent;
    .end local p3  # "flags":I
    .restart local v13  # "intent":Landroid/content/Intent;
    .restart local v21  # "flags":I
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    goto/16 :goto_3b8

    .end local v1  # "pkgName":Ljava/lang/String;
    .end local v13  # "intent":Landroid/content/Intent;
    .end local v21  # "flags":I
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .local v9, "intent":Landroid/content/Intent;
    .local v10, "pkgName":Ljava/lang/String;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local p3  # "flags":I
    :catchall_331
    move-exception v0

    move/from16 v21, p3

    move-object/from16 v19, v8

    move-object v1, v10

    move-object/from16 v24, v11

    move v11, v13

    move-object v10, v15

    move-object v13, v9

    move-object v9, v1

    .end local v9  # "intent":Landroid/content/Intent;
    .end local v10  # "pkgName":Ljava/lang/String;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .end local p3  # "flags":I
    .restart local v1  # "pkgName":Ljava/lang/String;
    .restart local v13  # "intent":Landroid/content/Intent;
    .restart local v21  # "flags":I
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    goto/16 :goto_3b8

    .line 7661
    .end local v1  # "pkgName":Ljava/lang/String;
    .end local v13  # "intent":Landroid/content/Intent;
    .end local v21  # "flags":I
    .end local v24  # "instantAppPkgName":Ljava/lang/String;
    .restart local v9  # "intent":Landroid/content/Intent;
    .restart local v10  # "pkgName":Ljava/lang/String;
    .restart local v11  # "instantAppPkgName":Ljava/lang/String;
    .restart local p3  # "flags":I
    :cond_33f
    move/from16 v21, p3

    move-object/from16 v19, v8

    move-object v1, v10

    move-object/from16 v24, v11

    move v11, v13

    move-object v10, v15

    move-object v13, v9

    .end local v9  # "intent":Landroid/content/Intent;
    .end local v10  # "pkgName":Ljava/lang/String;
    .end local v11  # "instantAppPkgName":Ljava/lang/String;
    .end local p3  # "flags":I
    .restart local v1  # "pkgName":Ljava/lang/String;
    .restart local v13  # "intent":Landroid/content/Intent;
    .restart local v21  # "flags":I
    .restart local v24  # "instantAppPkgName":Ljava/lang/String;
    :try_start_349
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/PackageParser$Package;

    .line 7662
    .local v0, "pkg":Landroid/content/pm/PackageParser$Package;
    const/4 v7, 0x0

    .line 7663
    .local v7, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-eqz v0, :cond_36b

    .line 7664
    iget-object v2, v10, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    iget-object v5, v0, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;
    :try_end_358
    .catchall {:try_start_349 .. :try_end_358} :catchall_3b6

    move-object v9, v1

    .end local v1  # "pkgName":Ljava/lang/String;
    .local v9, "pkgName":Ljava/lang/String;
    move-object v1, v2

    move-object v2, v13

    move-object/from16 v3, p2

    move/from16 v4, v21

    move/from16 v6, p5

    :try_start_361
    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/ComponentResolver;->queryActivities(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;I)Ljava/util/List;

    move-result-object v1

    invoke-direct {v10, v1, v11}, Lcom/android/server/pm/PackageManagerService;->filterIfNotSystemUser(Ljava/util/List;I)Ljava/util/List;

    move-result-object v1

    move-object v7, v1

    goto :goto_36c

    .line 7663
    .end local v9  # "pkgName":Ljava/lang/String;
    .restart local v1  # "pkgName":Ljava/lang/String;
    :cond_36b
    move-object v9, v1

    .line 7667
    .end local v1  # "pkgName":Ljava/lang/String;
    .restart local v9  # "pkgName":Ljava/lang/String;
    :goto_36c
    if-eqz v7, :cond_377

    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v1

    if-nez v1, :cond_375

    goto :goto_377

    :cond_375
    move-object v0, v7

    goto :goto_389

    .line 7670
    :cond_377
    :goto_377
    const/4 v1, 0x0

    const/4 v2, 0x1

    invoke-direct {v10, v13, v1, v11, v2}, Lcom/android/server/pm/PackageManagerService;->isInstantAppResolutionAllowed(Landroid/content/Intent;Ljava/util/List;IZ)Z

    move-result v1

    move/from16 v17, v1

    .line 7672
    if-nez v7, :cond_388

    .line 7673
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    move-object v0, v1

    .end local v7  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v1, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    goto :goto_389

    .line 7672
    .end local v1  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v7  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_388
    move-object v0, v7

    .line 7677
    .end local v7  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .local v0, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :goto_389
    monitor-exit v19
    :try_end_38a
    .catchall {:try_start_361 .. :try_end_38a} :catchall_3ba

    .line 7678
    if-eqz v17, :cond_39c

    .line 7679
    move-object/from16 v1, p0

    move-object v2, v0

    move-object v3, v13

    move-object/from16 v4, p2

    move/from16 v5, v21

    move/from16 v6, p5

    move/from16 v7, p6

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->maybeAddInstantAppInstaller(Ljava/util/List;Landroid/content/Intent;Ljava/lang/String;IIZ)Ljava/util/List;

    move-result-object v0

    .line 7682
    :cond_39c
    if-eqz v12, :cond_3a3

    .line 7683
    sget-object v1, Lcom/android/server/pm/ComponentResolver;->RESOLVE_PRIORITY_SORTER:Ljava/util/Comparator;

    invoke-static {v0, v1}, Ljava/util/Collections;->sort(Ljava/util/List;Ljava/util/Comparator;)V

    .line 7685
    :cond_3a3
    move-object/from16 v1, p0

    move-object v2, v0

    move-object/from16 v3, v24

    move/from16 v4, p7

    move/from16 v5, p4

    move/from16 v6, p6

    move/from16 v7, p5

    move-object v8, v13

    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->applyPostResolutionFilter(Ljava/util/List;Ljava/lang/String;ZIZILandroid/content/Intent;)Ljava/util/List;

    move-result-object v1

    return-object v1

    .line 7677
    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v9  # "pkgName":Ljava/lang/String;
    .local v1, "pkgName":Ljava/lang/String;
    :catchall_3b6
    move-exception v0

    move-object v9, v1

    .end local v1  # "pkgName":Ljava/lang/String;
    .restart local v9  # "pkgName":Ljava/lang/String;
    :goto_3b8
    :try_start_3b8
    monitor-exit v19
    :try_end_3b9
    .catchall {:try_start_3b8 .. :try_end_3b9} :catchall_3ba

    throw v0

    :catchall_3ba
    move-exception v0

    goto :goto_3b8
.end method

.method private queryIntentActivityOptionsInternal(Landroid/content/ComponentName;[Landroid/content/Intent;[Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;
    .registers 29
    .param p1, "caller"  # Landroid/content/ComponentName;
    .param p2, "specifics"  # [Landroid/content/Intent;
    .param p3, "specificTypes"  # [Ljava/lang/String;
    .param p4, "intent"  # Landroid/content/Intent;
    .param p5, "resolvedType"  # Ljava/lang/String;
    .param p6, "flags"  # I
    .param p7, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/ComponentName;",
            "[",
            "Landroid/content/Intent;",
            "[",
            "Ljava/lang/String;",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "II)",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8330
    move-object/from16 v6, p0

    move-object/from16 v7, p2

    move-object/from16 v8, p4

    move/from16 v9, p7

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v9}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_15

    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v0

    return-object v0

    .line 8331
    :cond_15
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v10

    .line 8332
    .local v10, "callingUid":I
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move/from16 v1, p6

    move/from16 v2, p7

    move-object/from16 v3, p4

    move v4, v10

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZ)I

    move-result v11

    .line 8334
    .end local p6  # "flags":I
    .local v11, "flags":I
    iget-object v0, v6, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string/jumbo v5, "query intent activity options"

    move v1, v10

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 8337
    invoke-virtual/range {p4 .. p4}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v0

    .line 8339
    .local v0, "resultsAction":Ljava/lang/String;
    or-int/lit8 v1, v11, 0x40

    move-object/from16 v2, p5

    invoke-direct {v6, v8, v2, v1, v9}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v1

    .line 8342
    .local v1, "results":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_INTENT_MATCHING:Z

    const-string v4, ": "

    const-string v5, "PackageManager"

    if-eqz v3, :cond_60

    .line 8343
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Query "

    invoke-virtual {v3, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v5, v3}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8346
    :cond_60
    const/4 v3, 0x0

    .line 8357
    .local v3, "specificsPos":I
    const-string v12, "Removing duplicate item from "

    if-eqz v7, :cond_191

    .line 8358
    const/4 v14, 0x0

    .local v14, "i":I
    :goto_66
    array-length v15, v7

    if-ge v14, v15, :cond_18c

    .line 8359
    aget-object v15, v7, v14

    .line 8360
    .local v15, "sintent":Landroid/content/Intent;
    if-nez v15, :cond_73

    .line 8361
    move-object/from16 v20, v0

    move/from16 v18, v10

    goto/16 :goto_e2

    .line 8364
    :cond_73
    sget-boolean v16, Lcom/android/server/pm/PackageManagerService;->DEBUG_INTENT_MATCHING:Z

    const-string v13, "Specific #"

    if-eqz v16, :cond_91

    .line 8365
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v2, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v5, v2}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8368
    :cond_91
    invoke-virtual {v15}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v2

    .line 8369
    .local v2, "action":Ljava/lang/String;
    if-eqz v0, :cond_9e

    invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v16

    if-eqz v16, :cond_9e

    .line 8372
    const/4 v2, 0x0

    .line 8375
    :cond_9e
    const/16 v16, 0x0

    .line 8376
    .local v16, "ri":Landroid/content/pm/ResolveInfo;
    const/16 v17, 0x0

    .line 8378
    .local v17, "ai":Landroid/content/pm/ActivityInfo;
    invoke-virtual {v15}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    .line 8379
    .local v7, "comp":Landroid/content/ComponentName;
    if-nez v7, :cond_d5

    .line 8380
    nop

    .line 8382
    if-eqz p3, :cond_b0

    aget-object v18, p3, v14

    move-object/from16 v8, v18

    goto :goto_b1

    :cond_b0
    const/4 v8, 0x0

    .line 8380
    :goto_b1
    invoke-virtual {v6, v15, v8, v11, v9}, Lcom/android/server/pm/PackageManagerService;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;

    move-result-object v8

    .line 8384
    .end local v16  # "ri":Landroid/content/pm/ResolveInfo;
    .local v8, "ri":Landroid/content/pm/ResolveInfo;
    if-nez v8, :cond_bc

    .line 8385
    move-object/from16 v20, v0

    move/from16 v18, v10

    goto :goto_e2

    .line 8387
    :cond_bc
    move/from16 v18, v10

    .end local v10  # "callingUid":I
    .local v18, "callingUid":I
    iget-object v10, v6, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    .line 8390
    iget-object v10, v8, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 8391
    .end local v17  # "ai":Landroid/content/pm/ActivityInfo;
    .local v10, "ai":Landroid/content/pm/ActivityInfo;
    move-object/from16 v16, v8

    .end local v8  # "ri":Landroid/content/pm/ResolveInfo;
    .restart local v16  # "ri":Landroid/content/pm/ResolveInfo;
    new-instance v8, Landroid/content/ComponentName;

    move-object/from16 v19, v15

    .end local v15  # "sintent":Landroid/content/Intent;
    .local v19, "sintent":Landroid/content/Intent;
    iget-object v15, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v15, v15, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object/from16 v20, v0

    .end local v0  # "resultsAction":Ljava/lang/String;
    .local v20, "resultsAction":Ljava/lang/String;
    iget-object v0, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v8, v15, v0}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    move-object v7, v8

    goto :goto_e6

    .line 8394
    .end local v18  # "callingUid":I
    .end local v19  # "sintent":Landroid/content/Intent;
    .end local v20  # "resultsAction":Ljava/lang/String;
    .restart local v0  # "resultsAction":Ljava/lang/String;
    .local v10, "callingUid":I
    .restart local v15  # "sintent":Landroid/content/Intent;
    .restart local v17  # "ai":Landroid/content/pm/ActivityInfo;
    :cond_d5
    move-object/from16 v20, v0

    move/from16 v18, v10

    move-object/from16 v19, v15

    .end local v0  # "resultsAction":Ljava/lang/String;
    .end local v10  # "callingUid":I
    .end local v15  # "sintent":Landroid/content/Intent;
    .restart local v18  # "callingUid":I
    .restart local v19  # "sintent":Landroid/content/Intent;
    .restart local v20  # "resultsAction":Ljava/lang/String;
    invoke-virtual {v6, v7, v11, v9}, Lcom/android/server/pm/PackageManagerService;->getActivityInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ActivityInfo;

    move-result-object v10

    .line 8395
    .end local v17  # "ai":Landroid/content/pm/ActivityInfo;
    .local v10, "ai":Landroid/content/pm/ActivityInfo;
    if-nez v10, :cond_e6

    .line 8396
    nop

    .line 8358
    .end local v2  # "action":Ljava/lang/String;
    .end local v7  # "comp":Landroid/content/ComponentName;
    .end local v16  # "ri":Landroid/content/pm/ResolveInfo;
    .end local v18  # "callingUid":I
    .end local v19  # "sintent":Landroid/content/Intent;
    .end local v20  # "resultsAction":Ljava/lang/String;
    .restart local v0  # "resultsAction":Ljava/lang/String;
    .local v10, "callingUid":I
    :goto_e2
    move-object/from16 v17, v4

    .end local v0  # "resultsAction":Ljava/lang/String;
    .end local v10  # "callingUid":I
    .restart local v18  # "callingUid":I
    .restart local v20  # "resultsAction":Ljava/lang/String;
    goto/16 :goto_17c

    .line 8402
    .restart local v2  # "action":Ljava/lang/String;
    .restart local v7  # "comp":Landroid/content/ComponentName;
    .local v10, "ai":Landroid/content/pm/ActivityInfo;
    .restart local v16  # "ri":Landroid/content/pm/ResolveInfo;
    .restart local v19  # "sintent":Landroid/content/Intent;
    :cond_e6
    :goto_e6
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INTENT_MATCHING:Z

    if-eqz v0, :cond_102

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v5, v0}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8403
    :cond_102
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v0

    .line 8405
    .local v0, "N":I
    move v8, v3

    .local v8, "j":I
    :goto_107
    if-ge v8, v0, :cond_167

    .line 8406
    invoke-interface {v1, v8}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Landroid/content/pm/ResolveInfo;

    .line 8407
    .local v13, "sri":Landroid/content/pm/ResolveInfo;
    iget-object v15, v13, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v15, v15, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    move-object/from16 v17, v4

    invoke-virtual {v7}, Landroid/content/ComponentName;->getClassName()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v15, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_12f

    iget-object v4, v13, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v4, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 8409
    invoke-virtual {v7}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v15

    .line 8408
    invoke-virtual {v4, v15}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_139

    :cond_12f
    if-eqz v2, :cond_162

    iget-object v4, v13, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    .line 8410
    invoke-virtual {v4, v2}, Landroid/content/IntentFilter;->matchAction(Ljava/lang/String;)Z

    move-result v4

    if-eqz v4, :cond_162

    .line 8411
    :cond_139
    invoke-interface {v1, v8}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 8412
    sget-boolean v4, Lcom/android/server/pm/PackageManagerService;->DEBUG_INTENT_MATCHING:Z

    if-eqz v4, :cond_15a

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v15, " due to specific "

    invoke-virtual {v4, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v5, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8415
    :cond_15a
    if-nez v16, :cond_15e

    .line 8416
    move-object/from16 v16, v13

    .line 8418
    :cond_15e
    add-int/lit8 v8, v8, -0x1

    .line 8419
    add-int/lit8 v0, v0, -0x1

    .line 8405
    .end local v13  # "sri":Landroid/content/pm/ResolveInfo;
    :cond_162
    add-int/lit8 v8, v8, 0x1

    move-object/from16 v4, v17

    goto :goto_107

    .line 8424
    :cond_167
    move-object/from16 v17, v4

    if-nez v16, :cond_173

    .line 8425
    new-instance v4, Landroid/content/pm/ResolveInfo;

    invoke-direct {v4}, Landroid/content/pm/ResolveInfo;-><init>()V

    .line 8426
    .end local v16  # "ri":Landroid/content/pm/ResolveInfo;
    .local v4, "ri":Landroid/content/pm/ResolveInfo;
    iput-object v10, v4, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    goto :goto_175

    .line 8424
    .end local v4  # "ri":Landroid/content/pm/ResolveInfo;
    .restart local v16  # "ri":Landroid/content/pm/ResolveInfo;
    :cond_173
    move-object/from16 v4, v16

    .line 8428
    .end local v16  # "ri":Landroid/content/pm/ResolveInfo;
    .restart local v4  # "ri":Landroid/content/pm/ResolveInfo;
    :goto_175
    invoke-interface {v1, v3, v4}, Ljava/util/List;->add(ILjava/lang/Object;)V

    .line 8429
    iput v14, v4, Landroid/content/pm/ResolveInfo;->specificIndex:I

    .line 8430
    add-int/lit8 v3, v3, 0x1

    .line 8358
    .end local v0  # "N":I
    .end local v2  # "action":Ljava/lang/String;
    .end local v4  # "ri":Landroid/content/pm/ResolveInfo;
    .end local v7  # "comp":Landroid/content/ComponentName;
    .end local v8  # "j":I
    .end local v10  # "ai":Landroid/content/pm/ActivityInfo;
    .end local v19  # "sintent":Landroid/content/Intent;
    :goto_17c
    add-int/lit8 v14, v14, 0x1

    move-object/from16 v7, p2

    move-object/from16 v8, p4

    move-object/from16 v2, p5

    move-object/from16 v4, v17

    move/from16 v10, v18

    move-object/from16 v0, v20

    goto/16 :goto_66

    .end local v18  # "callingUid":I
    .end local v20  # "resultsAction":Ljava/lang/String;
    .local v0, "resultsAction":Ljava/lang/String;
    .local v10, "callingUid":I
    :cond_18c
    move-object/from16 v20, v0

    move/from16 v18, v10

    .end local v0  # "resultsAction":Ljava/lang/String;
    .end local v10  # "callingUid":I
    .restart local v18  # "callingUid":I
    .restart local v20  # "resultsAction":Ljava/lang/String;
    goto :goto_195

    .line 8357
    .end local v14  # "i":I
    .end local v18  # "callingUid":I
    .end local v20  # "resultsAction":Ljava/lang/String;
    .restart local v0  # "resultsAction":Ljava/lang/String;
    .restart local v10  # "callingUid":I
    :cond_191
    move-object/from16 v20, v0

    move/from16 v18, v10

    .line 8436
    .end local v0  # "resultsAction":Ljava/lang/String;
    .end local v10  # "callingUid":I
    .restart local v18  # "callingUid":I
    .restart local v20  # "resultsAction":Ljava/lang/String;
    :goto_195
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v0

    .line 8437
    .local v0, "N":I
    move v2, v3

    .local v2, "i":I
    :goto_19a
    add-int/lit8 v4, v0, -0x1

    if-ge v2, v4, :cond_23b

    .line 8438
    invoke-interface {v1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/ResolveInfo;

    .line 8439
    .local v4, "rii":Landroid/content/pm/ResolveInfo;
    iget-object v7, v4, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    if-nez v7, :cond_1a9

    .line 8440
    goto :goto_1b2

    .line 8445
    :cond_1a9
    iget-object v7, v4, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    invoke-virtual {v7}, Landroid/content/IntentFilter;->actionsIterator()Ljava/util/Iterator;

    move-result-object v7

    .line 8446
    .local v7, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    if-nez v7, :cond_1b8

    .line 8447
    nop

    .line 8437
    .end local v4  # "rii":Landroid/content/pm/ResolveInfo;
    .end local v7  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    :goto_1b2
    move/from16 v16, v3

    move-object/from16 v10, v20

    goto/16 :goto_233

    .line 8449
    .restart local v4  # "rii":Landroid/content/pm/ResolveInfo;
    .restart local v7  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    :cond_1b8
    :goto_1b8
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_228

    .line 8450
    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    .line 8451
    .local v8, "action":Ljava/lang/String;
    if-eqz v20, :cond_1d1

    move-object/from16 v10, v20

    .end local v20  # "resultsAction":Ljava/lang/String;
    .local v10, "resultsAction":Ljava/lang/String;
    invoke-virtual {v10, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v13

    if-eqz v13, :cond_1d3

    .line 8454
    move-object/from16 v20, v10

    goto :goto_1b8

    .line 8451
    .end local v10  # "resultsAction":Ljava/lang/String;
    .restart local v20  # "resultsAction":Ljava/lang/String;
    :cond_1d1
    move-object/from16 v10, v20

    .line 8456
    .end local v20  # "resultsAction":Ljava/lang/String;
    .restart local v10  # "resultsAction":Ljava/lang/String;
    :cond_1d3
    add-int/lit8 v13, v2, 0x1

    .local v13, "j":I
    :goto_1d5
    if-ge v13, v0, :cond_223

    .line 8457
    invoke-interface {v1, v13}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Landroid/content/pm/ResolveInfo;

    .line 8458
    .local v14, "rij":Landroid/content/pm/ResolveInfo;
    iget-object v15, v14, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    if-eqz v15, :cond_21c

    iget-object v15, v14, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    invoke-virtual {v15, v8}, Landroid/content/IntentFilter;->hasAction(Ljava/lang/String;)Z

    move-result v15

    if-eqz v15, :cond_21c

    .line 8459
    invoke-interface {v1, v13}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 8460
    sget-boolean v15, Lcom/android/server/pm/PackageManagerService;->DEBUG_INTENT_MATCHING:Z

    if-eqz v15, :cond_215

    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v15, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move/from16 v16, v3

    .end local v3  # "specificsPos":I
    .local v16, "specificsPos":I
    const-string v3, " due to action "

    invoke-virtual {v15, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " at "

    invoke-virtual {v15, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v5, v3}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_217

    .end local v16  # "specificsPos":I
    .restart local v3  # "specificsPos":I
    :cond_215
    move/from16 v16, v3

    .line 8463
    .end local v3  # "specificsPos":I
    .restart local v16  # "specificsPos":I
    :goto_217
    add-int/lit8 v13, v13, -0x1

    .line 8464
    add-int/lit8 v0, v0, -0x1

    goto :goto_21e

    .line 8458
    .end local v16  # "specificsPos":I
    .restart local v3  # "specificsPos":I
    :cond_21c
    move/from16 v16, v3

    .line 8456
    .end local v3  # "specificsPos":I
    .end local v14  # "rij":Landroid/content/pm/ResolveInfo;
    .restart local v16  # "specificsPos":I
    :goto_21e
    add-int/lit8 v13, v13, 0x1

    move/from16 v3, v16

    goto :goto_1d5

    .end local v16  # "specificsPos":I
    .restart local v3  # "specificsPos":I
    :cond_223
    move/from16 v16, v3

    .line 8467
    .end local v3  # "specificsPos":I
    .end local v8  # "action":Ljava/lang/String;
    .end local v13  # "j":I
    .restart local v16  # "specificsPos":I
    move-object/from16 v20, v10

    goto :goto_1b8

    .line 8471
    .end local v10  # "resultsAction":Ljava/lang/String;
    .end local v16  # "specificsPos":I
    .restart local v3  # "specificsPos":I
    .restart local v20  # "resultsAction":Ljava/lang/String;
    :cond_228
    move/from16 v16, v3

    move-object/from16 v10, v20

    .end local v3  # "specificsPos":I
    .end local v20  # "resultsAction":Ljava/lang/String;
    .restart local v10  # "resultsAction":Ljava/lang/String;
    .restart local v16  # "specificsPos":I
    and-int/lit8 v3, v11, 0x40

    if-nez v3, :cond_233

    .line 8472
    const/4 v3, 0x0

    iput-object v3, v4, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    .line 8437
    .end local v4  # "rii":Landroid/content/pm/ResolveInfo;
    .end local v7  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    :cond_233
    :goto_233
    add-int/lit8 v2, v2, 0x1

    move-object/from16 v20, v10

    move/from16 v3, v16

    goto/16 :goto_19a

    .end local v10  # "resultsAction":Ljava/lang/String;
    .end local v16  # "specificsPos":I
    .restart local v3  # "specificsPos":I
    .restart local v20  # "resultsAction":Ljava/lang/String;
    :cond_23b
    move/from16 v16, v3

    move-object/from16 v10, v20

    .line 8477
    .end local v2  # "i":I
    .end local v3  # "specificsPos":I
    .end local v20  # "resultsAction":Ljava/lang/String;
    .restart local v10  # "resultsAction":Ljava/lang/String;
    .restart local v16  # "specificsPos":I
    if-eqz p1, :cond_271

    .line 8478
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v0

    .line 8479
    const/4 v2, 0x0

    .restart local v2  # "i":I
    :goto_246
    if-ge v2, v0, :cond_271

    .line 8480
    invoke-interface {v1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    iget-object v3, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 8481
    .local v3, "ainfo":Landroid/content/pm/ActivityInfo;
    invoke-virtual/range {p1 .. p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v4

    iget-object v7, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_26e

    .line 8482
    invoke-virtual/range {p1 .. p1}, Landroid/content/ComponentName;->getClassName()Ljava/lang/String;

    move-result-object v4

    iget-object v7, v3, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_26e

    .line 8483
    invoke-interface {v1, v2}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 8484
    goto :goto_271

    .line 8479
    .end local v3  # "ainfo":Landroid/content/pm/ActivityInfo;
    :cond_26e
    add-int/lit8 v2, v2, 0x1

    goto :goto_246

    .line 8492
    .end local v2  # "i":I
    :cond_271
    :goto_271
    and-int/lit8 v2, v11, 0x40

    if-nez v2, :cond_288

    .line 8493
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v0

    .line 8494
    const/4 v2, 0x0

    .restart local v2  # "i":I
    :goto_27a
    if-ge v2, v0, :cond_288

    .line 8495
    invoke-interface {v1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    const/4 v4, 0x0

    iput-object v4, v3, Landroid/content/pm/ResolveInfo;->filter:Landroid/content/IntentFilter;

    .line 8494
    add-int/lit8 v2, v2, 0x1

    goto :goto_27a

    .line 8499
    .end local v2  # "i":I
    :cond_288
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_INTENT_MATCHING:Z

    if-eqz v2, :cond_2a0

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Result: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v5, v2}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 8500
    :cond_2a0
    return-object v1
.end method

.method private queryIntentContentProvidersInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;
    .registers 22
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "II)",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8748
    move-object/from16 v7, p0

    move/from16 v8, p4

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v8}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_11

    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v0

    return-object v0

    .line 8749
    :cond_11
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v9

    .line 8750
    .local v9, "callingUid":I
    invoke-direct {v7, v9}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v10

    .line 8751
    .local v10, "instantAppPkgName":Ljava/lang/String;
    const/4 v6, 0x0

    move-object/from16 v1, p0

    move/from16 v2, p3

    move/from16 v3, p4

    move-object/from16 v4, p1

    move v5, v9

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZ)I

    move-result v11

    .line 8753
    .end local p3  # "flags":I
    .local v11, "flags":I
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    .line 8754
    .local v0, "comp":Landroid/content/ComponentName;
    if-nez v0, :cond_3e

    .line 8755
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object v1

    if-eqz v1, :cond_3e

    .line 8756
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object v1

    .line 8757
    .end local p1  # "intent":Landroid/content/Intent;
    .local v1, "intent":Landroid/content/Intent;
    invoke-virtual {v1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    move-object v12, v0

    move-object v13, v1

    goto :goto_41

    .line 8760
    .end local v1  # "intent":Landroid/content/Intent;
    .restart local p1  # "intent":Landroid/content/Intent;
    :cond_3e
    move-object/from16 v13, p1

    move-object v12, v0

    .end local v0  # "comp":Landroid/content/ComponentName;
    .end local p1  # "intent":Landroid/content/Intent;
    .local v12, "comp":Landroid/content/ComponentName;
    .local v13, "intent":Landroid/content/Intent;
    :goto_41
    if-eqz v12, :cond_a9

    .line 8761
    new-instance v0, Ljava/util/ArrayList;

    const/4 v1, 0x1

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    .line 8762
    .local v0, "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-virtual {v7, v12, v11, v8}, Lcom/android/server/pm/PackageManagerService;->getProviderInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ProviderInfo;

    move-result-object v2

    .line 8763
    .local v2, "pi":Landroid/content/pm/ProviderInfo;
    if-eqz v2, :cond_a8

    .line 8768
    const/high16 v3, 0x800000

    and-int/2addr v3, v11

    const/4 v4, 0x0

    if-eqz v3, :cond_57

    move v3, v1

    goto :goto_58

    :cond_57
    move v3, v4

    .line 8770
    .local v3, "matchInstantApp":Z
    :goto_58
    const/high16 v5, 0x1000000

    and-int/2addr v5, v11

    if-eqz v5, :cond_5f

    move v5, v1

    goto :goto_60

    :cond_5f
    move v5, v4

    .line 8772
    .local v5, "matchVisibleToInstantAppOnly":Z
    :goto_60
    if-eqz v10, :cond_64

    move v6, v1

    goto :goto_65

    :cond_64
    move v6, v4

    .line 8774
    .local v6, "isCallerInstantApp":Z
    :goto_65
    nop

    .line 8775
    invoke-virtual {v12}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v14

    invoke-virtual {v14, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v14

    .line 8776
    .local v14, "isTargetSameInstantApp":Z
    iget-object v15, v2, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v15, v15, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    and-int/lit16 v15, v15, 0x80

    if-eqz v15, :cond_78

    move v15, v1

    goto :goto_79

    :cond_78
    move v15, v4

    .line 8779
    .local v15, "isTargetInstantApp":Z
    :goto_79
    iget v1, v2, Landroid/content/pm/ProviderInfo;->flags:I

    const/high16 v16, 0x100000

    and-int v1, v1, v16

    if-nez v1, :cond_83

    const/4 v1, 0x1

    goto :goto_84

    :cond_83
    move v1, v4

    .line 8781
    .local v1, "isTargetHiddenFromInstantApp":Z
    :goto_84
    if-nez v14, :cond_93

    if-nez v3, :cond_8c

    if-nez v6, :cond_8c

    if-nez v15, :cond_92

    :cond_8c
    if-eqz v5, :cond_93

    if-eqz v6, :cond_93

    if-eqz v1, :cond_93

    :cond_92
    const/4 v4, 0x1

    .line 8786
    .local v4, "blockResolution":Z
    :cond_93
    if-nez v4, :cond_a6

    .line 8787
    new-instance v16, Landroid/content/pm/ResolveInfo;

    invoke-direct/range {v16 .. v16}, Landroid/content/pm/ResolveInfo;-><init>()V

    move-object/from16 p1, v16

    .line 8788
    .local p1, "ri":Landroid/content/pm/ResolveInfo;
    move/from16 p3, v1

    move-object/from16 v1, p1

    .end local p1  # "ri":Landroid/content/pm/ResolveInfo;
    .local v1, "ri":Landroid/content/pm/ResolveInfo;
    .local p3, "isTargetHiddenFromInstantApp":Z
    iput-object v2, v1, Landroid/content/pm/ResolveInfo;->providerInfo:Landroid/content/pm/ProviderInfo;

    .line 8789
    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_a8

    .line 8786
    .end local p3  # "isTargetHiddenFromInstantApp":Z
    .local v1, "isTargetHiddenFromInstantApp":Z
    :cond_a6
    move/from16 p3, v1

    .line 8792
    .end local v1  # "isTargetHiddenFromInstantApp":Z
    .end local v3  # "matchInstantApp":Z
    .end local v4  # "blockResolution":Z
    .end local v5  # "matchVisibleToInstantAppOnly":Z
    .end local v6  # "isCallerInstantApp":Z
    .end local v14  # "isTargetSameInstantApp":Z
    .end local v15  # "isTargetInstantApp":Z
    :cond_a8
    :goto_a8
    return-object v0

    .line 8796
    .end local v0  # "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v2  # "pi":Landroid/content/pm/ProviderInfo;
    :cond_a9
    iget-object v14, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v14

    .line 8797
    :try_start_ac
    invoke-virtual {v13}, Landroid/content/Intent;->getPackage()Ljava/lang/String;

    move-result-object v0

    .line 8798
    .local v0, "pkgName":Ljava/lang/String;
    if-nez v0, :cond_c0

    .line 8799
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;
    :try_end_b4
    .catchall {:try_start_ac .. :try_end_b4} :catchall_eb

    .line 8800
    move-object/from16 v15, p2

    :try_start_b6
    invoke-virtual {v1, v13, v15, v11, v8}, Lcom/android/server/pm/ComponentResolver;->queryProviders(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v1

    .line 8799
    invoke-direct {v7, v1, v10}, Lcom/android/server/pm/PackageManagerService;->applyPostContentProviderResolutionFilter(Ljava/util/List;Ljava/lang/String;)Ljava/util/List;

    move-result-object v1

    monitor-exit v14

    return-object v1

    .line 8803
    :cond_c0
    move-object/from16 v15, p2

    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, v0}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    move-object v6, v1

    .line 8804
    .local v6, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v6, :cond_e3

    .line 8805
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    iget-object v5, v6, Landroid/content/pm/PackageParser$Package;->providers:Ljava/util/ArrayList;

    .line 8806
    move-object v2, v13

    move-object/from16 v3, p2

    move v4, v11

    move-object/from16 v16, v6

    .end local v6  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v16, "pkg":Landroid/content/pm/PackageParser$Package;
    move/from16 v6, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/ComponentResolver;->queryProviders(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;I)Ljava/util/List;

    move-result-object v1

    .line 8805
    invoke-direct {v7, v1, v10}, Lcom/android/server/pm/PackageManagerService;->applyPostContentProviderResolutionFilter(Ljava/util/List;Ljava/lang/String;)Ljava/util/List;

    move-result-object v1

    monitor-exit v14

    return-object v1

    .line 8810
    .end local v16  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v6  # "pkg":Landroid/content/pm/PackageParser$Package;
    :cond_e3
    move-object/from16 v16, v6

    .end local v6  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v16  # "pkg":Landroid/content/pm/PackageParser$Package;
    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v1

    monitor-exit v14

    return-object v1

    .line 8811
    .end local v0  # "pkgName":Ljava/lang/String;
    .end local v16  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_eb
    move-exception v0

    move-object/from16 v15, p2

    :goto_ee
    monitor-exit v14
    :try_end_ef
    .catchall {:try_start_b6 .. :try_end_ef} :catchall_f0

    throw v0

    :catchall_f0
    move-exception v0

    goto :goto_ee
.end method

.method private queryIntentReceiversInternal(Landroid/content/Intent;Ljava/lang/String;IIZ)Ljava/util/List;
    .registers 26
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .param p5, "allowDynamicSplits"  # Z
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "IIZ)",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8513
    move-object/from16 v9, p0

    move/from16 v10, p4

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v10}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_11

    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v0

    return-object v0

    .line 8514
    :cond_11
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v11

    .line 8515
    .local v11, "callingUid":I
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v4, 0x0

    const/4 v5, 0x0

    const-string/jumbo v6, "query intent receivers"

    move v2, v11

    move/from16 v3, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 8518
    invoke-direct {v9, v11}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v12

    .line 8519
    .local v12, "instantAppPkgName":Ljava/lang/String;
    const/4 v6, 0x0

    move-object/from16 v1, p0

    move/from16 v2, p3

    move-object/from16 v4, p1

    move v5, v11

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZ)I

    move-result v13

    .line 8521
    .end local p3  # "flags":I
    .local v13, "flags":I
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    .line 8522
    .local v0, "comp":Landroid/content/ComponentName;
    if-nez v0, :cond_49

    .line 8523
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object v1

    if-eqz v1, :cond_49

    .line 8524
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object v1

    .line 8525
    .end local p1  # "intent":Landroid/content/Intent;
    .local v1, "intent":Landroid/content/Intent;
    invoke-virtual {v1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    move-object v14, v0

    move-object v15, v1

    goto :goto_4c

    .line 8528
    .end local v1  # "intent":Landroid/content/Intent;
    .restart local p1  # "intent":Landroid/content/Intent;
    :cond_49
    move-object/from16 v15, p1

    move-object v14, v0

    .end local v0  # "comp":Landroid/content/ComponentName;
    .end local p1  # "intent":Landroid/content/Intent;
    .local v14, "comp":Landroid/content/ComponentName;
    .local v15, "intent":Landroid/content/Intent;
    :goto_4c
    if-eqz v14, :cond_ef

    .line 8529
    new-instance v0, Ljava/util/ArrayList;

    const/4 v1, 0x1

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    .line 8530
    .local v0, "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-virtual {v9, v14, v13, v10}, Lcom/android/server/pm/PackageManagerService;->getReceiverInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ActivityInfo;

    move-result-object v8

    .line 8531
    .local v8, "ai":Landroid/content/pm/ActivityInfo;
    if-eqz v8, :cond_dc

    .line 8536
    const/high16 v2, 0x800000

    and-int/2addr v2, v13

    if-eqz v2, :cond_61

    move v2, v1

    goto :goto_62

    :cond_61
    const/4 v2, 0x0

    .line 8538
    .local v2, "matchInstantApp":Z
    :goto_62
    const/high16 v4, 0x1000000

    and-int/2addr v4, v13

    if-eqz v4, :cond_69

    move v4, v1

    goto :goto_6a

    :cond_69
    const/4 v4, 0x0

    .line 8540
    .local v4, "matchVisibleToInstantAppOnly":Z
    :goto_6a
    const/high16 v5, 0x2000000

    and-int/2addr v5, v13

    if-eqz v5, :cond_71

    move v5, v1

    goto :goto_72

    :cond_71
    const/4 v5, 0x0

    .line 8542
    .local v5, "matchExplicitlyVisibleOnly":Z
    :goto_72
    if-eqz v12, :cond_76

    move v6, v1

    goto :goto_77

    :cond_76
    const/4 v6, 0x0

    .line 8544
    .local v6, "isCallerInstantApp":Z
    :goto_77
    nop

    .line 8545
    invoke-virtual {v14}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v7, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    .line 8546
    .local v7, "isTargetSameInstantApp":Z
    iget-object v1, v8, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    and-int/lit16 v1, v1, 0x80

    if-eqz v1, :cond_8a

    const/4 v1, 0x1

    goto :goto_8b

    :cond_8a
    const/4 v1, 0x0

    .line 8549
    .local v1, "isTargetInstantApp":Z
    :goto_8b
    iget v3, v8, Landroid/content/pm/ActivityInfo;->flags:I

    const/high16 v16, 0x100000

    and-int v3, v3, v16

    if-eqz v3, :cond_95

    const/4 v3, 0x1

    goto :goto_96

    :cond_95
    const/4 v3, 0x0

    .line 8551
    .local v3, "isTargetVisibleToInstantApp":Z
    :goto_96
    if-eqz v3, :cond_a4

    move-object/from16 v16, v14

    .end local v14  # "comp":Landroid/content/ComponentName;
    .local v16, "comp":Landroid/content/ComponentName;
    iget v14, v8, Landroid/content/pm/ActivityInfo;->flags:I

    const/high16 v17, 0x200000

    and-int v14, v14, v17

    if-nez v14, :cond_a6

    const/4 v14, 0x1

    goto :goto_a7

    .end local v16  # "comp":Landroid/content/ComponentName;
    .restart local v14  # "comp":Landroid/content/ComponentName;
    :cond_a4
    move-object/from16 v16, v14

    .end local v14  # "comp":Landroid/content/ComponentName;
    .restart local v16  # "comp":Landroid/content/ComponentName;
    :cond_a6
    const/4 v14, 0x0

    .line 8554
    .local v14, "isTargetExplicitlyVisibleToInstantApp":Z
    :goto_a7
    if-eqz v3, :cond_b1

    if-eqz v5, :cond_ae

    if-nez v14, :cond_ae

    goto :goto_b1

    :cond_ae
    const/16 v17, 0x0

    goto :goto_b3

    :cond_b1
    :goto_b1
    const/16 v17, 0x1

    .line 8557
    .local v17, "isTargetHiddenFromInstantApp":Z
    :goto_b3
    if-nez v7, :cond_c4

    if-nez v2, :cond_bb

    if-nez v6, :cond_bb

    if-nez v1, :cond_c1

    :cond_bb
    if-eqz v4, :cond_c4

    if-eqz v6, :cond_c4

    if-eqz v17, :cond_c4

    :cond_c1
    const/16 v18, 0x1

    goto :goto_c6

    :cond_c4
    const/16 v18, 0x0

    .line 8562
    .local v18, "blockResolution":Z
    :goto_c6
    if-nez v18, :cond_d9

    .line 8563
    new-instance v19, Landroid/content/pm/ResolveInfo;

    invoke-direct/range {v19 .. v19}, Landroid/content/pm/ResolveInfo;-><init>()V

    move-object/from16 p1, v19

    .line 8564
    .local p1, "ri":Landroid/content/pm/ResolveInfo;
    move/from16 p3, v1

    move-object/from16 v1, p1

    .end local p1  # "ri":Landroid/content/pm/ResolveInfo;
    .local v1, "ri":Landroid/content/pm/ResolveInfo;
    .local p3, "isTargetInstantApp":Z
    iput-object v8, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 8565
    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_de

    .line 8562
    .end local p3  # "isTargetInstantApp":Z
    .local v1, "isTargetInstantApp":Z
    :cond_d9
    move/from16 p3, v1

    .end local v1  # "isTargetInstantApp":Z
    .restart local p3  # "isTargetInstantApp":Z
    goto :goto_de

    .line 8531
    .end local v2  # "matchInstantApp":Z
    .end local v3  # "isTargetVisibleToInstantApp":Z
    .end local v4  # "matchVisibleToInstantAppOnly":Z
    .end local v5  # "matchExplicitlyVisibleOnly":Z
    .end local v6  # "isCallerInstantApp":Z
    .end local v7  # "isTargetSameInstantApp":Z
    .end local v16  # "comp":Landroid/content/ComponentName;
    .end local v17  # "isTargetHiddenFromInstantApp":Z
    .end local v18  # "blockResolution":Z
    .end local p3  # "isTargetInstantApp":Z
    .local v14, "comp":Landroid/content/ComponentName;
    :cond_dc
    move-object/from16 v16, v14

    .line 8568
    .end local v14  # "comp":Landroid/content/ComponentName;
    .restart local v16  # "comp":Landroid/content/ComponentName;
    :goto_de
    const/4 v6, 0x0

    move-object/from16 v1, p0

    move-object v2, v0

    move-object v3, v12

    move/from16 v4, p5

    move v5, v11

    move/from16 v7, p4

    move-object v14, v8

    .end local v8  # "ai":Landroid/content/pm/ActivityInfo;
    .local v14, "ai":Landroid/content/pm/ActivityInfo;
    move-object v8, v15

    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->applyPostResolutionFilter(Ljava/util/List;Ljava/lang/String;ZIZILandroid/content/Intent;)Ljava/util/List;

    move-result-object v1

    return-object v1

    .line 8574
    .end local v0  # "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v16  # "comp":Landroid/content/ComponentName;
    .local v14, "comp":Landroid/content/ComponentName;
    :cond_ef
    move-object/from16 v16, v14

    .end local v14  # "comp":Landroid/content/ComponentName;
    .restart local v16  # "comp":Landroid/content/ComponentName;
    iget-object v14, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v14

    .line 8575
    :try_start_f4
    invoke-virtual {v15}, Landroid/content/Intent;->getPackage()Ljava/lang/String;

    move-result-object v0

    .line 8576
    .local v0, "pkgName":Ljava/lang/String;
    if-nez v0, :cond_112

    .line 8577
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    .line 8578
    move-object/from16 v8, p2

    invoke-virtual {v1, v15, v8, v13, v10}, Lcom/android/server/pm/ComponentResolver;->queryReceivers(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v2

    .line 8579
    .local v2, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/4 v6, 0x0

    move-object/from16 v1, p0

    move-object v3, v12

    move/from16 v4, p5

    move v5, v11

    move/from16 v7, p4

    move-object v8, v15

    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->applyPostResolutionFilter(Ljava/util/List;Ljava/lang/String;ZIZILandroid/content/Intent;)Ljava/util/List;

    move-result-object v1

    monitor-exit v14

    return-object v1

    .line 8583
    .end local v2  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_112
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, v0}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    move-object v8, v1

    .line 8584
    .local v8, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v8, :cond_13d

    .line 8585
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    iget-object v5, v8, Landroid/content/pm/PackageParser$Package;->receivers:Ljava/util/ArrayList;

    move-object v2, v15

    move-object/from16 v3, p2

    move v4, v13

    move/from16 v6, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/ComponentResolver;->queryReceivers(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;I)Ljava/util/List;

    move-result-object v2

    .line 8587
    .restart local v2  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/4 v6, 0x0

    move-object/from16 v1, p0

    move-object v3, v12

    move/from16 v4, p5

    move v5, v11

    move/from16 v7, p4

    move-object/from16 v17, v8

    .end local v8  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v17, "pkg":Landroid/content/pm/PackageParser$Package;
    move-object v8, v15

    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->applyPostResolutionFilter(Ljava/util/List;Ljava/lang/String;ZIZILandroid/content/Intent;)Ljava/util/List;

    move-result-object v1

    monitor-exit v14

    return-object v1

    .line 8591
    .end local v2  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v17  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v8  # "pkg":Landroid/content/pm/PackageParser$Package;
    :cond_13d
    move-object/from16 v17, v8

    .end local v8  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v17  # "pkg":Landroid/content/pm/PackageParser$Package;
    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v1

    monitor-exit v14

    return-object v1

    .line 8592
    .end local v0  # "pkgName":Ljava/lang/String;
    .end local v17  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_145
    move-exception v0

    monitor-exit v14
    :try_end_147
    .catchall {:try_start_f4 .. :try_end_147} :catchall_145

    throw v0
.end method

.method private queryIntentServicesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZ)Ljava/util/List;
    .registers 24
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .param p5, "callingUid"  # I
    .param p6, "includeInstantApps"  # Z
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "IIIZ)",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8629
    move-object/from16 v7, p0

    move/from16 v8, p4

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v8}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_11

    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v0

    return-object v0

    .line 8630
    :cond_11
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v4, 0x0

    const/4 v5, 0x0

    const-string/jumbo v6, "query intent receivers"

    move/from16 v2, p5

    move/from16 v3, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 8633
    move/from16 v9, p5

    invoke-direct {v7, v9}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v10

    .line 8634
    .local v10, "instantAppPkgName":Ljava/lang/String;
    move-object/from16 v1, p0

    move/from16 v2, p3

    move-object/from16 v4, p1

    move/from16 v5, p5

    move/from16 v6, p6

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZ)I

    move-result v11

    .line 8635
    .end local p3  # "flags":I
    .local v11, "flags":I
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    .line 8636
    .local v0, "comp":Landroid/content/ComponentName;
    if-nez v0, :cond_4a

    .line 8637
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object v1

    if-eqz v1, :cond_4a

    .line 8638
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object v1

    .line 8639
    .end local p1  # "intent":Landroid/content/Intent;
    .local v1, "intent":Landroid/content/Intent;
    invoke-virtual {v1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    move-object v12, v0

    move-object v13, v1

    goto :goto_4d

    .line 8642
    .end local v1  # "intent":Landroid/content/Intent;
    .restart local p1  # "intent":Landroid/content/Intent;
    :cond_4a
    move-object/from16 v13, p1

    move-object v12, v0

    .end local v0  # "comp":Landroid/content/ComponentName;
    .end local p1  # "intent":Landroid/content/Intent;
    .local v12, "comp":Landroid/content/ComponentName;
    .local v13, "intent":Landroid/content/Intent;
    :goto_4d
    if-eqz v12, :cond_b5

    .line 8643
    new-instance v0, Ljava/util/ArrayList;

    const/4 v1, 0x1

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    .line 8644
    .local v0, "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-virtual {v7, v12, v11, v8}, Lcom/android/server/pm/PackageManagerService;->getServiceInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ServiceInfo;

    move-result-object v2

    .line 8645
    .local v2, "si":Landroid/content/pm/ServiceInfo;
    if-eqz v2, :cond_b4

    .line 8650
    const/high16 v3, 0x800000

    and-int/2addr v3, v11

    const/4 v4, 0x0

    if-eqz v3, :cond_63

    move v3, v1

    goto :goto_64

    :cond_63
    move v3, v4

    .line 8652
    .local v3, "matchInstantApp":Z
    :goto_64
    const/high16 v5, 0x1000000

    and-int/2addr v5, v11

    if-eqz v5, :cond_6b

    move v5, v1

    goto :goto_6c

    :cond_6b
    move v5, v4

    .line 8654
    .local v5, "matchVisibleToInstantAppOnly":Z
    :goto_6c
    if-eqz v10, :cond_70

    move v6, v1

    goto :goto_71

    :cond_70
    move v6, v4

    .line 8656
    .local v6, "isCallerInstantApp":Z
    :goto_71
    nop

    .line 8657
    invoke-virtual {v12}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v14

    invoke-virtual {v14, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v14

    .line 8658
    .local v14, "isTargetSameInstantApp":Z
    iget-object v15, v2, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v15, v15, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    and-int/lit16 v15, v15, 0x80

    if-eqz v15, :cond_84

    move v15, v1

    goto :goto_85

    :cond_84
    move v15, v4

    .line 8661
    .local v15, "isTargetInstantApp":Z
    :goto_85
    iget v1, v2, Landroid/content/pm/ServiceInfo;->flags:I

    const/high16 v16, 0x100000

    and-int v1, v1, v16

    if-nez v1, :cond_8f

    const/4 v1, 0x1

    goto :goto_90

    :cond_8f
    move v1, v4

    .line 8663
    .local v1, "isTargetHiddenFromInstantApp":Z
    :goto_90
    if-nez v14, :cond_9f

    if-nez v3, :cond_98

    if-nez v6, :cond_98

    if-nez v15, :cond_9e

    :cond_98
    if-eqz v5, :cond_9f

    if-eqz v6, :cond_9f

    if-eqz v1, :cond_9f

    :cond_9e
    const/4 v4, 0x1

    .line 8668
    .local v4, "blockResolution":Z
    :cond_9f
    if-nez v4, :cond_b2

    .line 8669
    new-instance v16, Landroid/content/pm/ResolveInfo;

    invoke-direct/range {v16 .. v16}, Landroid/content/pm/ResolveInfo;-><init>()V

    move-object/from16 p1, v16

    .line 8670
    .local p1, "ri":Landroid/content/pm/ResolveInfo;
    move/from16 p3, v1

    move-object/from16 v1, p1

    .end local p1  # "ri":Landroid/content/pm/ResolveInfo;
    .local v1, "ri":Landroid/content/pm/ResolveInfo;
    .local p3, "isTargetHiddenFromInstantApp":Z
    iput-object v2, v1, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    .line 8671
    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_b4

    .line 8668
    .end local p3  # "isTargetHiddenFromInstantApp":Z
    .local v1, "isTargetHiddenFromInstantApp":Z
    :cond_b2
    move/from16 p3, v1

    .line 8674
    .end local v1  # "isTargetHiddenFromInstantApp":Z
    .end local v3  # "matchInstantApp":Z
    .end local v4  # "blockResolution":Z
    .end local v5  # "matchVisibleToInstantAppOnly":Z
    .end local v6  # "isCallerInstantApp":Z
    .end local v14  # "isTargetSameInstantApp":Z
    .end local v15  # "isTargetInstantApp":Z
    :cond_b4
    :goto_b4
    return-object v0

    .line 8678
    .end local v0  # "list":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v2  # "si":Landroid/content/pm/ServiceInfo;
    :cond_b5
    iget-object v14, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v14

    .line 8679
    :try_start_b8
    invoke-virtual {v13}, Landroid/content/Intent;->getPackage()Ljava/lang/String;

    move-result-object v0

    .line 8680
    .local v0, "pkgName":Ljava/lang/String;
    if-nez v0, :cond_cc

    .line 8681
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;
    :try_end_c0
    .catchall {:try_start_b8 .. :try_end_c0} :catchall_f7

    .line 8682
    move-object/from16 v15, p2

    :try_start_c2
    invoke-virtual {v1, v13, v15, v11, v8}, Lcom/android/server/pm/ComponentResolver;->queryServices(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v1

    .line 8681
    invoke-direct {v7, v1, v10}, Lcom/android/server/pm/PackageManagerService;->applyPostServiceResolutionFilter(Ljava/util/List;Ljava/lang/String;)Ljava/util/List;

    move-result-object v1

    monitor-exit v14

    return-object v1

    .line 8685
    :cond_cc
    move-object/from16 v15, p2

    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, v0}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    move-object v6, v1

    .line 8686
    .local v6, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v6, :cond_ef

    .line 8687
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    iget-object v5, v6, Landroid/content/pm/PackageParser$Package;->services:Ljava/util/ArrayList;

    .line 8688
    move-object v2, v13

    move-object/from16 v3, p2

    move v4, v11

    move-object/from16 v16, v6

    .end local v6  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v16, "pkg":Landroid/content/pm/PackageParser$Package;
    move/from16 v6, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/ComponentResolver;->queryServices(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;I)Ljava/util/List;

    move-result-object v1

    .line 8687
    invoke-direct {v7, v1, v10}, Lcom/android/server/pm/PackageManagerService;->applyPostServiceResolutionFilter(Ljava/util/List;Ljava/lang/String;)Ljava/util/List;

    move-result-object v1

    monitor-exit v14

    return-object v1

    .line 8692
    .end local v16  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v6  # "pkg":Landroid/content/pm/PackageParser$Package;
    :cond_ef
    move-object/from16 v16, v6

    .end local v6  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v16  # "pkg":Landroid/content/pm/PackageParser$Package;
    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v1

    monitor-exit v14

    return-object v1

    .line 8693
    .end local v0  # "pkgName":Ljava/lang/String;
    .end local v16  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_f7
    move-exception v0

    move-object/from16 v15, p2

    :goto_fa
    monitor-exit v14
    :try_end_fb
    .catchall {:try_start_c2 .. :try_end_fb} :catchall_fc

    throw v0

    :catchall_fc
    move-exception v0

    goto :goto_fa
.end method

.method private querySkipCurrentProfileIntents(Ljava/util/List;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;
    .registers 15
    .param p2, "intent"  # Landroid/content/Intent;
    .param p3, "resolvedType"  # Ljava/lang/String;
    .param p4, "flags"  # I
    .param p5, "sourceUserId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Lcom/android/server/pm/CrossProfileIntentFilter;",
            ">;",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "II)",
            "Landroid/content/pm/ResolveInfo;"
        }
    .end annotation

    .line 8209
    .local p1, "matchingFilters":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    if-eqz p1, :cond_27

    .line 8210
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v0

    .line 8211
    .local v0, "size":I
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_7
    if-ge v1, v0, :cond_27

    .line 8212
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/CrossProfileIntentFilter;

    .line 8213
    .local v2, "filter":Lcom/android/server/pm/CrossProfileIntentFilter;
    invoke-virtual {v2}, Lcom/android/server/pm/CrossProfileIntentFilter;->getFlags()I

    move-result v3

    and-int/lit8 v3, v3, 0x2

    if-eqz v3, :cond_24

    .line 8216
    move-object v3, p0

    move-object v4, v2

    move-object v5, p2

    move-object v6, p3

    move v7, p4

    move v8, p5

    invoke-direct/range {v3 .. v8}, Lcom/android/server/pm/PackageManagerService;->createForwardingResolveInfo(Lcom/android/server/pm/CrossProfileIntentFilter;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;

    move-result-object v3

    .line 8218
    .local v3, "resolveInfo":Landroid/content/pm/ResolveInfo;
    if-eqz v3, :cond_24

    .line 8219
    return-object v3

    .line 8211
    .end local v2  # "filter":Lcom/android/server/pm/CrossProfileIntentFilter;
    .end local v3  # "resolveInfo":Landroid/content/pm/ResolveInfo;
    :cond_24
    add-int/lit8 v1, v1, 0x1

    goto :goto_7

    .line 8224
    .end local v0  # "size":I
    .end local v1  # "i":I
    :cond_27
    const/4 v0, 0x0

    return-object v0
.end method

.method private reconcileApps(Ljava/lang/String;)V
    .registers 16
    .param p1, "volumeUuid"  # Ljava/lang/String;

    .line 23788
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->collectAbsoluteCodePaths()Ljava/util/List;

    move-result-object v0

    .line 23789
    .local v0, "absoluteCodePaths":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    const/4 v1, 0x0

    .line 23791
    .local v1, "filesToDelete":Ljava/util/List;, "Ljava/util/List<Ljava/io/File;>;"
    nop

    .line 23792
    invoke-static {p1}, Landroid/os/Environment;->getDataAppDirectory(Ljava/lang/String;)Ljava/io/File;

    move-result-object v2

    .line 23791
    invoke-static {v2}, Landroid/os/FileUtils;->listFilesOrEmpty(Ljava/io/File;)[Ljava/io/File;

    move-result-object v2

    .line 23793
    .local v2, "files":[Ljava/io/File;
    array-length v3, v2

    const/4 v4, 0x0

    move-object v5, v1

    move v1, v4

    .end local v1  # "filesToDelete":Ljava/util/List;, "Ljava/util/List<Ljava/io/File;>;"
    .local v5, "filesToDelete":Ljava/util/List;, "Ljava/util/List<Ljava/io/File;>;"
    :goto_12
    if-ge v1, v3, :cond_5f

    aget-object v6, v2, v1

    .line 23794
    .local v6, "file":Ljava/io/File;
    invoke-static {v6}, Landroid/content/pm/PackageParser;->isApkFile(Ljava/io/File;)Z

    move-result v7

    if-nez v7, :cond_22

    invoke-virtual {v6}, Ljava/io/File;->isDirectory()Z

    move-result v7

    if-eqz v7, :cond_2e

    .line 23795
    :cond_22
    invoke-virtual {v6}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v7

    invoke-static {v7}, Lcom/android/server/pm/PackageInstallerService;->isStageName(Ljava/lang/String;)Z

    move-result v7

    if-nez v7, :cond_2e

    const/4 v7, 0x1

    goto :goto_2f

    :cond_2e
    move v7, v4

    .line 23796
    .local v7, "isPackage":Z
    :goto_2f
    if-nez v7, :cond_32

    .line 23798
    goto :goto_5c

    .line 23801
    :cond_32
    invoke-virtual {v6}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v8

    .line 23803
    .local v8, "absolutePath":Ljava/lang/String;
    const/4 v9, 0x0

    .line 23804
    .local v9, "pathValid":Z
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v10

    .line 23805
    .local v10, "absoluteCodePathCount":I
    const/4 v11, 0x0

    .local v11, "i":I
    :goto_3c
    if-ge v11, v10, :cond_4f

    .line 23806
    invoke-interface {v0, v11}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Ljava/lang/String;

    .line 23807
    .local v12, "absoluteCodePath":Ljava/lang/String;
    invoke-virtual {v8, v12}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v13

    if-eqz v13, :cond_4c

    .line 23808
    const/4 v9, 0x1

    .line 23809
    goto :goto_4f

    .line 23805
    .end local v12  # "absoluteCodePath":Ljava/lang/String;
    :cond_4c
    add-int/lit8 v11, v11, 0x1

    goto :goto_3c

    .line 23813
    .end local v11  # "i":I
    :cond_4f
    :goto_4f
    if-nez v9, :cond_5c

    .line 23814
    if-nez v5, :cond_59

    .line 23815
    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    move-object v5, v11

    .line 23817
    :cond_59
    invoke-interface {v5, v6}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 23793
    .end local v6  # "file":Ljava/io/File;
    .end local v7  # "isPackage":Z
    .end local v8  # "absolutePath":Ljava/lang/String;
    .end local v9  # "pathValid":Z
    .end local v10  # "absoluteCodePathCount":I
    :cond_5c
    :goto_5c
    add-int/lit8 v1, v1, 0x1

    goto :goto_12

    .line 23821
    :cond_5f
    if-eqz v5, :cond_90

    .line 23822
    invoke-interface {v5}, Ljava/util/List;->size()I

    move-result v1

    .line 23823
    .local v1, "fileToDeleteCount":I
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_66
    if-ge v3, v1, :cond_90

    .line 23824
    invoke-interface {v5, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/io/File;

    .line 23825
    .local v4, "fileToDelete":Ljava/io/File;
    const/4 v6, 0x5

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Destroying orphaned"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 23826
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v6

    .line 23827
    :try_start_86
    invoke-virtual {p0, v4}, Lcom/android/server/pm/PackageManagerService;->removeCodePathLI(Ljava/io/File;)V

    .line 23828
    monitor-exit v6

    .line 23823
    .end local v4  # "fileToDelete":Ljava/io/File;
    add-int/lit8 v3, v3, 0x1

    goto :goto_66

    .line 23828
    .restart local v4  # "fileToDelete":Ljava/io/File;
    :catchall_8d
    move-exception v7

    monitor-exit v6
    :try_end_8f
    .catchall {:try_start_86 .. :try_end_8f} :catchall_8d

    throw v7

    .line 23831
    .end local v1  # "fileToDeleteCount":I
    .end local v3  # "i":I
    .end local v4  # "fileToDelete":Ljava/io/File;
    :cond_90
    return-void
.end method

.method private reconcileAppsDataLI(Ljava/lang/String;IIZZ)Ljava/util/List;
    .registers 32
    .param p1, "volumeUuid"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "flags"  # I
    .param p4, "migrateAppData"  # Z
    .param p5, "onlyCoreApps"  # Z
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "IIZZ)",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 23868
    move-object/from16 v1, p0

    move-object/from16 v9, p1

    move/from16 v10, p2

    move/from16 v11, p3

    move/from16 v12, p4

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v2, "reconcileAppsData for "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " u"

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, " 0x"

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 23869
    invoke-static/range {p3 .. p3}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " migrateAppData="

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v12}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 23868
    const-string v2, "PackageManager"

    invoke-static {v2, v0}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 23871
    const-string v0, "PMS:reconcileAppsDataLI"

    invoke-direct {v1, v0}, Lcom/android/server/pm/PackageManagerService;->addBootEvent(Ljava/lang/String;)V

    .line 23873
    if-eqz p5, :cond_4a

    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    goto :goto_4b

    :cond_4a
    const/4 v0, 0x0

    :goto_4b
    move-object v13, v0

    .line 23875
    .local v13, "result":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    invoke-static/range {p1 .. p2}, Landroid/os/Environment;->getDataUserCeDirectory(Ljava/lang/String;I)Ljava/io/File;

    move-result-object v14

    .line 23876
    .local v14, "ceDir":Ljava/io/File;
    invoke-static/range {p1 .. p2}, Landroid/os/Environment;->getDataUserDeDirectory(Ljava/lang/String;I)Ljava/io/File;

    move-result-object v15

    .line 23880
    .local v15, "deDir":Ljava/io/File;
    and-int/lit8 v0, v11, 0x2

    const/16 v16, 0x0

    if-eqz v0, :cond_119

    .line 23881
    invoke-static {}, Landroid/os/storage/StorageManager;->isFileEncryptedNativeOrEmulated()Z

    move-result v0

    if-eqz v0, :cond_83

    .line 23882
    invoke-static/range {p2 .. p2}, Landroid/os/storage/StorageManager;->isUserKeyUnlocked(I)Z

    move-result v0

    if-eqz v0, :cond_67

    goto :goto_83

    .line 23883
    :cond_67
    new-instance v0, Ljava/lang/RuntimeException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Yikes, someone asked us to reconcile CE storage while "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, " was still locked; this would have caused massive data loss!"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v0, v2}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 23888
    :cond_83
    :goto_83
    invoke-static {v14}, Landroid/os/FileUtils;->listFilesOrEmpty(Ljava/io/File;)[Ljava/io/File;

    move-result-object v8

    .line 23889
    .local v8, "files":[Ljava/io/File;
    array-length v6, v8

    move/from16 v5, v16

    :goto_8a
    if-ge v5, v6, :cond_113

    aget-object v4, v8, v5

    .line 23890
    .local v4, "file":Ljava/io/File;
    invoke-virtual {v4}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v3

    .line 23892
    .local v3, "packageName":Ljava/lang/String;
    :try_start_92
    invoke-direct {v1, v9, v3, v10}, Lcom/android/server/pm/PackageManagerService;->assertPackageKnownAndInstalled(Ljava/lang/String;Ljava/lang/String;I)V
    :try_end_95
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_92 .. :try_end_95} :catch_a0

    .line 23901
    move/from16 v23, v5

    move/from16 v24, v6

    move-object/from16 v17, v8

    move-object/from16 v25, v14

    const/4 v14, 0x5

    goto/16 :goto_109

    .line 23893
    :catch_a0
    move-exception v0

    move-object v2, v0

    .line 23894
    .local v2, "e":Lcom/android/server/pm/PackageManagerException;
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Destroying "

    invoke-virtual {v0, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v7, " due to: "

    invoke-virtual {v0, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const/4 v7, 0x5

    invoke-static {v7, v0}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 23896
    :try_start_bf
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;
    :try_end_c1
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_bf .. :try_end_c1} :catch_e5

    const/16 v17, 0x2

    const-wide/16 v18, 0x0

    move-object/from16 v20, v2

    .end local v2  # "e":Lcom/android/server/pm/PackageManagerException;
    .local v20, "e":Lcom/android/server/pm/PackageManagerException;
    move-object v2, v0

    move-object/from16 v21, v3

    .end local v3  # "packageName":Ljava/lang/String;
    .local v21, "packageName":Ljava/lang/String;
    move-object/from16 v3, p1

    move-object/from16 v22, v4

    .end local v4  # "file":Ljava/io/File;
    .local v22, "file":Ljava/io/File;
    move-object/from16 v4, v21

    move/from16 v23, v5

    move/from16 v5, p2

    move/from16 v24, v6

    move/from16 v6, v17

    move-object/from16 v17, v8

    move-object/from16 v25, v14

    move v14, v7

    .end local v8  # "files":[Ljava/io/File;
    .end local v14  # "ceDir":Ljava/io/File;
    .local v17, "files":[Ljava/io/File;
    .local v25, "ceDir":Ljava/io/File;
    move-wide/from16 v7, v18

    :try_start_df
    invoke-virtual/range {v2 .. v8}, Lcom/android/server/pm/Installer;->destroyAppData(Ljava/lang/String;Ljava/lang/String;IIJ)V
    :try_end_e2
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_df .. :try_end_e2} :catch_e3

    .line 23900
    goto :goto_109

    .line 23898
    :catch_e3
    move-exception v0

    goto :goto_f5

    .end local v17  # "files":[Ljava/io/File;
    .end local v20  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v21  # "packageName":Ljava/lang/String;
    .end local v22  # "file":Ljava/io/File;
    .end local v25  # "ceDir":Ljava/io/File;
    .restart local v2  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v3  # "packageName":Ljava/lang/String;
    .restart local v4  # "file":Ljava/io/File;
    .restart local v8  # "files":[Ljava/io/File;
    .restart local v14  # "ceDir":Ljava/io/File;
    :catch_e5
    move-exception v0

    move-object/from16 v20, v2

    move-object/from16 v21, v3

    move-object/from16 v22, v4

    move/from16 v23, v5

    move/from16 v24, v6

    move-object/from16 v17, v8

    move-object/from16 v25, v14

    move v14, v7

    .line 23899
    .end local v2  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v3  # "packageName":Ljava/lang/String;
    .end local v4  # "file":Ljava/io/File;
    .end local v8  # "files":[Ljava/io/File;
    .end local v14  # "ceDir":Ljava/io/File;
    .local v0, "e2":Lcom/android/server/pm/Installer$InstallerException;
    .restart local v17  # "files":[Ljava/io/File;
    .restart local v20  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v21  # "packageName":Ljava/lang/String;
    .restart local v22  # "file":Ljava/io/File;
    .restart local v25  # "ceDir":Ljava/io/File;
    :goto_f5
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Failed to destroy: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v14, v2}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 23889
    .end local v0  # "e2":Lcom/android/server/pm/Installer$InstallerException;
    .end local v20  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v21  # "packageName":Ljava/lang/String;
    .end local v22  # "file":Ljava/io/File;
    :goto_109
    add-int/lit8 v5, v23, 0x1

    move-object/from16 v8, v17

    move/from16 v6, v24

    move-object/from16 v14, v25

    goto/16 :goto_8a

    .end local v17  # "files":[Ljava/io/File;
    .end local v25  # "ceDir":Ljava/io/File;
    .restart local v8  # "files":[Ljava/io/File;
    .restart local v14  # "ceDir":Ljava/io/File;
    :cond_113
    move-object/from16 v17, v8

    move-object/from16 v25, v14

    const/4 v14, 0x5

    .end local v8  # "files":[Ljava/io/File;
    .end local v14  # "ceDir":Ljava/io/File;
    .restart local v17  # "files":[Ljava/io/File;
    .restart local v25  # "ceDir":Ljava/io/File;
    goto :goto_11c

    .line 23880
    .end local v17  # "files":[Ljava/io/File;
    .end local v25  # "ceDir":Ljava/io/File;
    .restart local v14  # "ceDir":Ljava/io/File;
    :cond_119
    move-object/from16 v25, v14

    const/4 v14, 0x5

    .line 23904
    .end local v14  # "ceDir":Ljava/io/File;
    .restart local v25  # "ceDir":Ljava/io/File;
    :goto_11c
    and-int/lit8 v0, v11, 0x1

    if-eqz v0, :cond_1a0

    .line 23905
    invoke-static {v15}, Landroid/os/FileUtils;->listFilesOrEmpty(Ljava/io/File;)[Ljava/io/File;

    move-result-object v7

    .line 23906
    .local v7, "files":[Ljava/io/File;
    array-length v8, v7

    move/from16 v6, v16

    :goto_127
    if-ge v6, v8, :cond_19e

    aget-object v5, v7, v6

    .line 23907
    .local v5, "file":Ljava/io/File;
    invoke-virtual {v5}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v4

    .line 23909
    .local v4, "packageName":Ljava/lang/String;
    :try_start_12f
    invoke-direct {v1, v9, v4, v10}, Lcom/android/server/pm/PackageManagerService;->assertPackageKnownAndInstalled(Ljava/lang/String;Ljava/lang/String;I)V
    :try_end_132
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_12f .. :try_end_132} :catch_139

    .line 23918
    move/from16 v21, v6

    move-object/from16 v22, v7

    move/from16 v23, v8

    goto :goto_197

    .line 23910
    :catch_139
    move-exception v0

    move-object v2, v0

    move-object v3, v2

    .line 23911
    .local v3, "e":Lcom/android/server/pm/PackageManagerException;
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Destroying "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v2, " due to: "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v14, v0}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 23913
    :try_start_158
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;
    :try_end_15a
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_158 .. :try_end_15a} :catch_176

    const/4 v0, 0x1

    const-wide/16 v16, 0x0

    move-object/from16 v18, v3

    .end local v3  # "e":Lcom/android/server/pm/PackageManagerException;
    .local v18, "e":Lcom/android/server/pm/PackageManagerException;
    move-object/from16 v3, p1

    move-object/from16 v19, v4

    .end local v4  # "packageName":Ljava/lang/String;
    .local v19, "packageName":Ljava/lang/String;
    move-object/from16 v20, v5

    .end local v5  # "file":Ljava/io/File;
    .local v20, "file":Ljava/io/File;
    move/from16 v5, p2

    move/from16 v21, v6

    move v6, v0

    move-object/from16 v22, v7

    move/from16 v23, v8

    .end local v7  # "files":[Ljava/io/File;
    .local v22, "files":[Ljava/io/File;
    move-wide/from16 v7, v16

    :try_start_170
    invoke-virtual/range {v2 .. v8}, Lcom/android/server/pm/Installer;->destroyAppData(Ljava/lang/String;Ljava/lang/String;IIJ)V
    :try_end_173
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_170 .. :try_end_173} :catch_174

    .line 23917
    goto :goto_197

    .line 23915
    :catch_174
    move-exception v0

    goto :goto_183

    .end local v18  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v19  # "packageName":Ljava/lang/String;
    .end local v20  # "file":Ljava/io/File;
    .end local v22  # "files":[Ljava/io/File;
    .restart local v3  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v4  # "packageName":Ljava/lang/String;
    .restart local v5  # "file":Ljava/io/File;
    .restart local v7  # "files":[Ljava/io/File;
    :catch_176
    move-exception v0

    move-object/from16 v18, v3

    move-object/from16 v19, v4

    move-object/from16 v20, v5

    move/from16 v21, v6

    move-object/from16 v22, v7

    move/from16 v23, v8

    .line 23916
    .end local v3  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v4  # "packageName":Ljava/lang/String;
    .end local v5  # "file":Ljava/io/File;
    .end local v7  # "files":[Ljava/io/File;
    .restart local v0  # "e2":Lcom/android/server/pm/Installer$InstallerException;
    .restart local v18  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v19  # "packageName":Ljava/lang/String;
    .restart local v20  # "file":Ljava/io/File;
    .restart local v22  # "files":[Ljava/io/File;
    :goto_183
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Failed to destroy: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v14, v2}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 23906
    .end local v0  # "e2":Lcom/android/server/pm/Installer$InstallerException;
    .end local v18  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v19  # "packageName":Ljava/lang/String;
    .end local v20  # "file":Ljava/io/File;
    :goto_197
    add-int/lit8 v6, v21, 0x1

    move-object/from16 v7, v22

    move/from16 v8, v23

    goto :goto_127

    .end local v22  # "files":[Ljava/io/File;
    .restart local v7  # "files":[Ljava/io/File;
    :cond_19e
    move-object/from16 v22, v7

    .line 23925
    .end local v7  # "files":[Ljava/io/File;
    :cond_1a0
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 23926
    :try_start_1a3
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v9}, Lcom/android/server/pm/Settings;->getVolumePackagesLPr(Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    .line 23927
    .local v0, "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    monitor-exit v2
    :try_end_1aa
    .catchall {:try_start_1a3 .. :try_end_1aa} :catchall_20f

    .line 23928
    const/4 v2, 0x0

    .line 23929
    .local v2, "preparedCount":I
    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :goto_1af
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_1f2

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 23930
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v5, v4, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    .line 23931
    .local v5, "packageName":Ljava/lang/String;
    iget-object v6, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-nez v6, :cond_1d8

    .line 23932
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Odd, missing scanned package "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const-string v7, "PackageManager"

    invoke-static {v7, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 23935
    goto :goto_1af

    .line 23938
    :cond_1d8
    if-eqz p5, :cond_1e4

    iget-object v6, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-boolean v6, v6, Landroid/content/pm/PackageParser$Package;->coreApp:Z

    if-nez v6, :cond_1e4

    .line 23939
    invoke-interface {v13, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 23940
    goto :goto_1af

    .line 23943
    :cond_1e4
    invoke-virtual {v4, v10}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v6

    if-eqz v6, :cond_1f1

    .line 23944
    iget-object v6, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-direct {v1, v6, v10, v11, v12}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataAndMigrateLIF(Landroid/content/pm/PackageParser$Package;IIZ)V

    .line 23945
    add-int/lit8 v2, v2, 0x1

    .line 23947
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "packageName":Ljava/lang/String;
    :cond_1f1
    goto :goto_1af

    .line 23949
    :cond_1f2
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v4, "reconcileAppsData finished "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, " packages"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 23950
    return-object v13

    .line 23927
    .end local v0  # "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    .end local v2  # "preparedCount":I
    :catchall_20f
    move-exception v0

    :try_start_210
    monitor-exit v2
    :try_end_211
    .catchall {:try_start_210 .. :try_end_211} :catchall_20f

    throw v0
.end method

.method private reconcileAppsDataLI(Ljava/lang/String;IIZ)V
    .registers 11
    .param p1, "volumeUuid"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "flags"  # I
    .param p4, "migrateAppData"  # Z
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock"
        }
    .end annotation

    .line 23852
    const/4 v5, 0x0

    move-object v0, p0

    move-object v1, p1

    move v2, p2

    move v3, p3

    move v4, p4

    invoke-direct/range {v0 .. v5}, Lcom/android/server/pm/PackageManagerService;->reconcileAppsDataLI(Ljava/lang/String;IIZZ)Ljava/util/List;

    .line 23853
    return-void
.end method

.method private static reconcilePackagesLocked(Lcom/android/server/pm/PackageManagerService$ReconcileRequest;Lcom/android/server/pm/KeySetManagerService;)Ljava/util/Map;
    .registers 41
    .param p0, "request"  # Lcom/android/server/pm/PackageManagerService$ReconcileRequest;
    .param p1, "ksms"  # Lcom/android/server/pm/KeySetManagerService;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/pm/PackageManagerService$ReconcileRequest;",
            "Lcom/android/server/pm/KeySetManagerService;",
            ")",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Lcom/android/server/pm/PackageManagerService$ReconciledPackage;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerService$ReconcileFailure;
        }
    .end annotation

    .line 17163
    move-object/from16 v14, p0

    move-object/from16 v15, p1

    iget-object v13, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->scannedPackages:Ljava/util/Map;

    .line 17165
    .local v13, "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    new-instance v0, Landroid/util/ArrayMap;

    invoke-interface {v13}, Ljava/util/Map;->size()I

    move-result v1

    invoke-direct {v0, v1}, Landroid/util/ArrayMap;-><init>(I)V

    move-object v12, v0

    .line 17168
    .local v12, "result":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    new-instance v0, Landroid/util/ArrayMap;

    iget-object v1, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->allPackages:Ljava/util/Map;

    .line 17169
    invoke-interface {v1}, Ljava/util/Map;->size()I

    move-result v1

    invoke-interface {v13}, Ljava/util/Map;->size()I

    move-result v2

    add-int/2addr v1, v2

    invoke-direct {v0, v1}, Landroid/util/ArrayMap;-><init>(I)V

    move-object v11, v0

    .line 17170
    .local v11, "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->allPackages:Ljava/util/Map;

    invoke-virtual {v11, v0}, Landroid/util/ArrayMap;->putAll(Ljava/util/Map;)V

    .line 17172
    new-instance v0, Landroid/util/ArrayMap;

    invoke-direct {v0}, Landroid/util/ArrayMap;-><init>()V

    move-object v10, v0

    .line 17175
    .local v10, "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    invoke-interface {v13}, Ljava/util/Map;->keySet()Ljava/util/Set;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v16

    :goto_34
    invoke-interface/range {v16 .. v16}, Ljava/util/Iterator;->hasNext()Z

    move-result v0

    if-eqz v0, :cond_333

    invoke-interface/range {v16 .. v16}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    move-object v9, v0

    check-cast v9, Ljava/lang/String;

    .line 17176
    .local v9, "installPackageName":Ljava/lang/String;
    invoke-interface {v13, v9}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    move-object v8, v0

    check-cast v8, Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17179
    .local v8, "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v0, v0, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v1, v1, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-virtual {v11, v0, v1}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 17182
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->sharedLibrarySource:Ljava/util/Map;

    .line 17183
    invoke-static {v8, v0}, Lcom/android/server/pm/PackageManagerService;->getAllowedSharedLibInfos(Lcom/android/server/pm/PackageManagerService$ScanResult;Ljava/util/Map;)Ljava/util/List;

    move-result-object v17

    .line 17184
    .local v17, "allowedSharedLibInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    iget-object v7, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->staticSharedLibraryInfo:Landroid/content/pm/SharedLibraryInfo;

    .line 17185
    .local v7, "staticLib":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v17, :cond_94

    .line 17186
    invoke-interface/range {v17 .. v17}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_61
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_94

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/SharedLibraryInfo;

    .line 17187
    .local v1, "info":Landroid/content/pm/SharedLibraryInfo;
    invoke-static {v10, v1}, Lcom/android/server/pm/PackageManagerService;->addSharedLibraryToPackageVersionMap(Ljava/util/Map;Landroid/content/pm/SharedLibraryInfo;)Z

    move-result v2

    if-eqz v2, :cond_74

    .line 17191
    .end local v1  # "info":Landroid/content/pm/SharedLibraryInfo;
    goto :goto_61

    .line 17188
    .restart local v1  # "info":Landroid/content/pm/SharedLibraryInfo;
    :cond_74
    new-instance v0, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Static Shared Library "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " is being installed twice in this set!"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v0, v2}, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;-><init>(Ljava/lang/String;)V

    throw v0

    .line 17195
    .end local v1  # "info":Landroid/content/pm/SharedLibraryInfo;
    :cond_94
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->installArgs:Ljava/util/Map;

    invoke-interface {v0, v9}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    move-object/from16 v18, v0

    check-cast v18, Lcom/android/server/pm/PackageManagerService$InstallArgs;

    .line 17196
    .local v18, "installArgs":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->installResults:Ljava/util/Map;

    invoke-interface {v0, v9}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    move-object v6, v0

    check-cast v6, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    .line 17197
    .local v6, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->preparedPackages:Ljava/util/Map;

    invoke-interface {v0, v9}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    move-object v5, v0

    check-cast v5, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    .line 17198
    .local v5, "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    const/4 v0, 0x1

    if-eqz v18, :cond_b5

    move v2, v0

    goto :goto_b6

    :cond_b5
    const/4 v2, 0x0

    :goto_b6
    move/from16 v19, v2

    .line 17199
    .local v19, "isInstall":Z
    if-eqz v19, :cond_db

    if-eqz v6, :cond_bf

    if-eqz v5, :cond_bf

    goto :goto_db

    .line 17200
    :cond_bf
    new-instance v0, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Reconcile arguments are not balanced for "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, "!"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;-><init>(Ljava/lang/String;)V

    throw v0

    .line 17206
    :cond_db
    :goto_db
    if-eqz v19, :cond_135

    iget-boolean v2, v5, Lcom/android/server/pm/PackageManagerService$PrepareResult;->replace:Z

    if-eqz v2, :cond_135

    iget-boolean v2, v5, Lcom/android/server/pm/PackageManagerService$PrepareResult;->system:Z

    if-nez v2, :cond_135

    .line 17207
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget v2, v2, Lcom/android/server/pm/PackageManagerService$ScanRequest;->scanFlags:I

    and-int/lit16 v2, v2, 0x800

    if-nez v2, :cond_ef

    move v2, v0

    goto :goto_f0

    :cond_ef
    const/4 v2, 0x0

    .line 17208
    .local v2, "killApp":Z
    :goto_f0
    nop

    .line 17209
    if-eqz v2, :cond_f5

    const/4 v3, 0x0

    goto :goto_f7

    :cond_f5
    const/16 v3, 0x8

    :goto_f7
    or-int/2addr v0, v3

    .line 17210
    .local v0, "deleteFlags":I
    iget-object v3, v6, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v4, v5, Lcom/android/server/pm/PackageManagerService$PrepareResult;->originalPs:Lcom/android/server/pm/PackageSetting;

    iget-object v1, v5, Lcom/android/server/pm/PackageManagerService$PrepareResult;->disabledPs:Lcom/android/server/pm/PackageSetting;

    move/from16 v27, v2

    .end local v2  # "killApp":Z
    .local v27, "killApp":Z
    iget-object v2, v5, Lcom/android/server/pm/PackageManagerService$PrepareResult;->childPackageSettings:[Lcom/android/server/pm/PackageSetting;

    const/16 v25, 0x0

    move-object/from16 v20, v3

    move-object/from16 v21, v4

    move-object/from16 v22, v1

    move-object/from16 v23, v2

    move/from16 v24, v0

    invoke-static/range {v20 .. v25}, Lcom/android/server/pm/PackageManagerService;->mayDeletePackageLocked(Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;[Lcom/android/server/pm/PackageSetting;ILandroid/os/UserHandle;)Lcom/android/server/pm/PackageManagerService$DeletePackageAction;

    move-result-object v1

    .line 17213
    .local v1, "deletePackageAction":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    if-eqz v1, :cond_117

    .line 17218
    .end local v0  # "deleteFlags":I
    .end local v27  # "killApp":Z
    move-object/from16 v20, v1

    goto :goto_138

    .line 17214
    .restart local v0  # "deleteFlags":I
    .restart local v27  # "killApp":Z
    :cond_117
    new-instance v2, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "May not delete "

    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " to replace"

    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const/16 v4, -0xa

    invoke-direct {v2, v4, v3}, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;-><init>(ILjava/lang/String;)V

    throw v2

    .line 17219
    .end local v0  # "deleteFlags":I
    .end local v1  # "deletePackageAction":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    .end local v27  # "killApp":Z
    :cond_135
    const/4 v0, 0x0

    move-object/from16 v20, v0

    .line 17222
    .local v20, "deletePackageAction":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    :goto_138
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget v4, v0, Lcom/android/server/pm/PackageManagerService$ScanRequest;->scanFlags:I

    .line 17223
    .local v4, "scanFlags":I
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget v3, v0, Lcom/android/server/pm/PackageManagerService$ScanRequest;->parseFlags:I

    .line 17224
    .local v3, "parseFlags":I
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v2, v0, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 17226
    .local v2, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v1, v0, Lcom/android/server/pm/PackageManagerService$ScanRequest;->disabledPkgSetting:Lcom/android/server/pm/PackageSetting;

    .line 17227
    .local v1, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->lastStaticSharedLibSettings:Ljava/util/Map;

    .line 17228
    invoke-interface {v0, v9}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    move-object/from16 v21, v0

    check-cast v21, Lcom/android/server/pm/PackageSetting;

    .line 17230
    .local v21, "lastStaticSharedLibSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v5, :cond_159

    if-eqz v21, :cond_159

    .line 17231
    move-object/from16 v0, v21

    goto :goto_15b

    .line 17232
    :cond_159
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    :goto_15b
    move-object/from16 v22, v0

    .line 17233
    .local v22, "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    const/16 v23, 0x0

    .line 17234
    .local v23, "removeAppKeySetData":Z
    const/16 v24, 0x0

    .line 17235
    .local v24, "sharedUserSignaturesChanged":Z
    const/16 v25, 0x0

    .line 17236
    .local v25, "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    move-object/from16 v27, v13

    move-object/from16 v13, v22

    .end local v22  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .local v13, "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .local v27, "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    invoke-virtual {v15, v13, v4}, Lcom/android/server/pm/KeySetManagerService;->shouldCheckUpgradeKeySetLocked(Lcom/android/server/pm/PackageSettingBase;I)Z

    move-result v0

    move/from16 v22, v4

    .end local v4  # "scanFlags":I
    .local v22, "scanFlags":I
    const-string v4, " signature changed; retaining data."

    move-object/from16 v29, v5

    .end local v5  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .local v29, "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    const-string v5, "System package "

    if-eqz v0, :cond_1c3

    .line 17237
    invoke-virtual {v15, v13, v2}, Lcom/android/server/pm/KeySetManagerService;->checkUpgradeKeySetLocked(Lcom/android/server/pm/PackageSettingBase;Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-eqz v0, :cond_17c

    goto :goto_198

    .line 17241
    :cond_17c
    and-int/lit8 v0, v3, 0x10

    if-eqz v0, :cond_1a4

    .line 17246
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 17248
    .local v0, "msg":Ljava/lang/String;
    const/4 v4, 0x5

    invoke-static {v4, v0}, Lcom/android/server/pm/PackageManagerService;->reportSettingsProblem(ILjava/lang/String;)V

    .line 17251
    .end local v0  # "msg":Ljava/lang/String;
    :goto_198
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    move-object/from16 v25, v0

    move-object/from16 v34, v1

    move-object/from16 v33, v7

    move-object/from16 v31, v10

    .end local v25  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    .local v0, "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    goto/16 :goto_2df

    .line 17242
    .end local v0  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    .restart local v25  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    :cond_1a4
    new-instance v0, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Package "

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " upgrade keys do not match the previously installed version"

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    const/4 v5, -0x7

    invoke-direct {v0, v5, v4}, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;-><init>(ILjava/lang/String;)V

    throw v0

    .line 17254
    :cond_1c3
    :try_start_1c3
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->versionInfos:Ljava/util/Map;

    invoke-interface {v0, v9}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/Settings$VersionInfo;

    .line 17255
    .local v0, "versionInfo":Lcom/android/server/pm/Settings$VersionInfo;
    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->isCompatSignatureUpdateNeeded(Lcom/android/server/pm/Settings$VersionInfo;)Z

    move-result v30

    move/from16 v31, v30

    .line 17256
    .local v31, "compareCompat":Z
    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->isRecoverSignatureUpdateNeeded(Lcom/android/server/pm/Settings$VersionInfo;)Z

    move-result v30

    move/from16 v32, v30

    .line 17257
    .local v32, "compareRecover":Z
    move-object/from16 v30, v0

    .end local v0  # "versionInfo":Lcom/android/server/pm/Settings$VersionInfo;
    .local v30, "versionInfo":Lcom/android/server/pm/Settings$VersionInfo;
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;
    :try_end_1db
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_1c3 .. :try_end_1db} :catch_23a
    .catch Ljava/lang/IllegalArgumentException; {:try_start_1c3 .. :try_end_1db} :catch_22b

    move-object/from16 v33, v7

    move/from16 v7, v31

    move-object/from16 v31, v10

    move/from16 v10, v32

    .end local v32  # "compareRecover":Z
    .local v7, "compareCompat":Z
    .local v10, "compareRecover":Z
    .local v31, "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .local v33, "staticLib":Landroid/content/pm/SharedLibraryInfo;
    :try_start_1e3
    invoke-static {v13, v1, v0, v7, v10}, Lcom/android/server/pm/PackageManagerServiceUtils;->verifySignatures(Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$SigningDetails;ZZ)Z

    move-result v0

    .line 17260
    .local v0, "compatMatch":Z
    if-eqz v0, :cond_1eb

    .line 17261
    const/16 v23, 0x1

    .line 17265
    :cond_1eb
    move/from16 v32, v0

    .end local v0  # "compatMatch":Z
    .local v32, "compatMatch":Z
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    move-object/from16 v25, v0

    .line 17272
    iget-object v0, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eqz v0, :cond_21f

    .line 17273
    iget-object v0, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;
    :try_end_1f7
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_1e3 .. :try_end_1f7} :catch_227
    .catch Ljava/lang/IllegalArgumentException; {:try_start_1e3 .. :try_end_1f7} :catch_223

    move-object/from16 v34, v1

    .end local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v34, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    :try_start_1f9
    iget-object v1, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v1, v1, Lcom/android/server/pm/SharedUserSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v1, v1, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    invoke-virtual {v0, v1}, Landroid/content/pm/PackageParser$SigningDetails;->hasAncestor(Landroid/content/pm/PackageParser$SigningDetails;)Z

    move-result v0

    if-eqz v0, :cond_20d

    .line 17275
    iget-object v0, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v0, v0, Lcom/android/server/pm/SharedUserSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v1, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iput-object v1, v0, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    .line 17278
    :cond_20d
    iget-object v0, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v0, v0, Lcom/android/server/pm/SharedUserSetting;->signaturesChanged:Ljava/lang/Boolean;

    if-nez v0, :cond_2de

    .line 17279
    iget-object v0, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    sget-object v1, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;

    iput-object v1, v0, Lcom/android/server/pm/SharedUserSetting;->signaturesChanged:Ljava/lang/Boolean;
    :try_end_219
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_1f9 .. :try_end_219} :catch_21d
    .catch Ljava/lang/IllegalArgumentException; {:try_start_1f9 .. :try_end_219} :catch_21b

    goto/16 :goto_2de

    .line 17335
    .end local v7  # "compareCompat":Z
    .end local v10  # "compareRecover":Z
    .end local v30  # "versionInfo":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v32  # "compatMatch":Z
    :catch_21b
    move-exception v0

    goto :goto_232

    .line 17282
    :catch_21d
    move-exception v0

    goto :goto_241

    .line 17272
    .end local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "compareCompat":Z
    .restart local v10  # "compareRecover":Z
    .restart local v30  # "versionInfo":Lcom/android/server/pm/Settings$VersionInfo;
    .restart local v32  # "compatMatch":Z
    :cond_21f
    move-object/from16 v34, v1

    .end local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    goto/16 :goto_2de

    .line 17335
    .end local v7  # "compareCompat":Z
    .end local v10  # "compareRecover":Z
    .end local v30  # "versionInfo":Lcom/android/server/pm/Settings$VersionInfo;
    .end local v32  # "compatMatch":Z
    .end local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    :catch_223
    move-exception v0

    move-object/from16 v34, v1

    .end local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    goto :goto_232

    .line 17282
    .end local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    :catch_227
    move-exception v0

    move-object/from16 v34, v1

    .end local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    goto :goto_241

    .line 17335
    .end local v31  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .end local v33  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .end local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v7, "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .local v10, "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    :catch_22b
    move-exception v0

    move-object/from16 v34, v1

    move-object/from16 v33, v7

    move-object/from16 v31, v10

    .line 17338
    .end local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .end local v10  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .local v0, "e":Ljava/lang/IllegalArgumentException;
    .restart local v31  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v33  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .restart local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_232
    new-instance v1, Ljava/lang/RuntimeException;

    const-string v4, "Signing certificates comparison made on incomparable signing details but somehow passed verifySignatures!"

    invoke-direct {v1, v4, v0}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V

    throw v1

    .line 17282
    .end local v0  # "e":Ljava/lang/IllegalArgumentException;
    .end local v31  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .end local v33  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .end local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .restart local v10  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    :catch_23a
    move-exception v0

    move-object/from16 v34, v1

    move-object/from16 v33, v7

    move-object/from16 v31, v10

    .line 17283
    .end local v1  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .end local v10  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v31  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v33  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .restart local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_241
    and-int/lit8 v1, v3, 0x10

    if-eqz v1, :cond_32b

    .line 17286
    iget-object v1, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    .line 17296
    .end local v25  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    .local v1, "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    iget-object v7, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eqz v7, :cond_2c4

    .line 17297
    iget-object v7, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v7, v7, Lcom/android/server/pm/SharedUserSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v7, v7, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v7, v7, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .line 17299
    .local v7, "sharedUserSignatures":[Landroid/content/pm/Signature;
    iget-object v10, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v10, v10, Lcom/android/server/pm/SharedUserSetting;->signaturesChanged:Ljava/lang/Boolean;

    if-eqz v10, :cond_2b1

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v10, v10, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .line 17300
    invoke-static {v7, v10}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v10

    if-eqz v10, :cond_2b1

    .line 17303
    const-string/jumbo v4, "ro.product.first_api_level"

    const/4 v5, 0x0

    invoke-static {v4, v5}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I

    move-result v4

    const/16 v5, 0x1d

    if-gt v4, v5, :cond_28c

    .line 17310
    new-instance v4, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Signature mismatch for shared user: "

    invoke-virtual {v10, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v5, v5, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    invoke-virtual {v10, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const/16 v10, -0x68

    invoke-direct {v4, v10, v5}, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;-><init>(ILjava/lang/String;)V

    throw v4

    .line 17319
    :cond_28c
    new-instance v4, Ljava/lang/IllegalStateException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Signature mismatch on system package "

    invoke-virtual {v5, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v10, " for shared user "

    invoke-virtual {v5, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v10, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v10, v10, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    invoke-virtual {v5, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 17326
    :cond_2b1
    const/16 v24, 0x1

    .line 17327
    iget-object v10, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v10, v10, Lcom/android/server/pm/SharedUserSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    move-object/from16 v25, v1

    .end local v1  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    .restart local v25  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    iget-object v1, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iput-object v1, v10, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    .line 17329
    iget-object v1, v13, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    sget-object v10, Ljava/lang/Boolean;->TRUE:Ljava/lang/Boolean;

    iput-object v10, v1, Lcom/android/server/pm/SharedUserSetting;->signaturesChanged:Ljava/lang/Boolean;

    goto :goto_2c6

    .line 17296
    .end local v7  # "sharedUserSignatures":[Landroid/content/pm/Signature;
    .end local v25  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    .restart local v1  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    :cond_2c4
    move-object/from16 v25, v1

    .line 17332
    .end local v1  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    .restart local v25  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    :goto_2c6
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v5, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 17334
    .local v1, "msg":Ljava/lang/String;
    const/4 v4, 0x5

    invoke-static {v4, v1}, Lcom/android/server/pm/PackageManagerService;->reportSettingsProblem(ILjava/lang/String;)V

    .line 17341
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v1  # "msg":Ljava/lang/String;
    :cond_2de
    :goto_2de
    nop

    .line 17344
    :goto_2df
    new-instance v0, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;

    iget-object v4, v8, Lcom/android/server/pm/PackageManagerService$ScanResult;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    iget-object v1, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->preparedPackages:Ljava/util/Map;

    .line 17346
    invoke-interface {v1, v9}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    move-object v7, v1

    check-cast v7, Lcom/android/server/pm/PackageManagerService$PrepareResult;

    const/16 v26, 0x0

    move-object/from16 v28, v34

    .end local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v28, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object v1, v0

    move-object/from16 v30, v2

    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v30, "pkg":Landroid/content/pm/PackageParser$Package;
    move-object/from16 v2, p0

    move/from16 v32, v3

    .end local v3  # "parseFlags":I
    .local v32, "parseFlags":I
    move-object/from16 v3, v18

    move-object v5, v6

    move-object/from16 v34, v6

    .end local v6  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .local v34, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    move-object v6, v7

    move-object v7, v8

    move-object/from16 v35, v8

    .end local v8  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .local v35, "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    move-object/from16 v8, v20

    move-object v10, v9

    .end local v9  # "installPackageName":Ljava/lang/String;
    .local v10, "installPackageName":Ljava/lang/String;
    move-object/from16 v9, v17

    move-object/from16 v37, v10

    move-object/from16 v36, v31

    .end local v10  # "installPackageName":Ljava/lang/String;
    .end local v31  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .local v36, "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .local v37, "installPackageName":Ljava/lang/String;
    move-object/from16 v10, v25

    move-object/from16 v38, v11

    .end local v11  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .local v38, "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    move/from16 v11, v24

    move-object v15, v12

    .end local v12  # "result":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    .local v15, "result":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    move/from16 v12, v23

    move-object/from16 v31, v27

    move-object/from16 v27, v13

    .end local v13  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .local v27, "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .local v31, "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    move-object/from16 v13, v26

    invoke-direct/range {v1 .. v13}, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;-><init>(Lcom/android/server/pm/PackageManagerService$ReconcileRequest;Lcom/android/server/pm/PackageManagerService$InstallArgs;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Lcom/android/server/pm/PackageManagerService$PrepareResult;Lcom/android/server/pm/PackageManagerService$ScanResult;Lcom/android/server/pm/PackageManagerService$DeletePackageAction;Ljava/util/List;Landroid/content/pm/PackageParser$SigningDetails;ZZLcom/android/server/pm/PackageManagerService$1;)V

    .line 17344
    move-object/from16 v1, v37

    .end local v37  # "installPackageName":Ljava/lang/String;
    .local v1, "installPackageName":Ljava/lang/String;
    invoke-interface {v15, v1, v0}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 17349
    .end local v1  # "installPackageName":Ljava/lang/String;
    .end local v17  # "allowedSharedLibInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v18  # "installArgs":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local v19  # "isInstall":Z
    .end local v20  # "deletePackageAction":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    .end local v21  # "lastStaticSharedLibSetting":Lcom/android/server/pm/PackageSetting;
    .end local v22  # "scanFlags":I
    .end local v23  # "removeAppKeySetData":Z
    .end local v24  # "sharedUserSignaturesChanged":Z
    .end local v25  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    .end local v27  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .end local v28  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v29  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .end local v30  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v32  # "parseFlags":I
    .end local v33  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .end local v34  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .end local v35  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    move-object v12, v15

    move-object/from16 v13, v31

    move-object/from16 v10, v36

    move-object/from16 v11, v38

    move-object/from16 v15, p1

    goto/16 :goto_34

    .line 17284
    .end local v15  # "result":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    .end local v36  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .end local v38  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .restart local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v3  # "parseFlags":I
    .restart local v6  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .restart local v8  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .restart local v9  # "installPackageName":Ljava/lang/String;
    .restart local v11  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .restart local v12  # "result":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    .restart local v13  # "signatureCheckPs":Lcom/android/server/pm/PackageSetting;
    .restart local v17  # "allowedSharedLibInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .restart local v18  # "installArgs":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .restart local v19  # "isInstall":Z
    .restart local v20  # "deletePackageAction":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    .restart local v21  # "lastStaticSharedLibSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v22  # "scanFlags":I
    .restart local v23  # "removeAppKeySetData":Z
    .restart local v24  # "sharedUserSignaturesChanged":Z
    .restart local v25  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    .local v27, "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v29  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .local v31, "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v33  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .local v34, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_32b
    move-object/from16 v30, v2

    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v30  # "pkg":Landroid/content/pm/PackageParser$Package;
    new-instance v2, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;

    invoke-direct {v2, v0}, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;-><init>(Lcom/android/server/pm/PackageManagerException;)V

    throw v2

    .line 17351
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v3  # "parseFlags":I
    .end local v6  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .end local v8  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .end local v9  # "installPackageName":Ljava/lang/String;
    .end local v17  # "allowedSharedLibInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v18  # "installArgs":Lcom/android/server/pm/PackageManagerService$InstallArgs;
    .end local v19  # "isInstall":Z
    .end local v20  # "deletePackageAction":Lcom/android/server/pm/PackageManagerService$DeletePackageAction;
    .end local v21  # "lastStaticSharedLibSetting":Lcom/android/server/pm/PackageSetting;
    .end local v22  # "scanFlags":I
    .end local v23  # "removeAppKeySetData":Z
    .end local v24  # "sharedUserSignaturesChanged":Z
    .end local v25  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    .end local v27  # "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local v29  # "prepareResult":Lcom/android/server/pm/PackageManagerService$PrepareResult;
    .end local v30  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v31  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .end local v33  # "staticLib":Landroid/content/pm/SharedLibraryInfo;
    .end local v34  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v10, "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .local v13, "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    :cond_333
    move-object/from16 v36, v10

    move-object/from16 v38, v11

    move-object v15, v12

    move-object/from16 v31, v13

    .end local v10  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .end local v11  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .end local v12  # "result":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    .end local v13  # "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v15  # "result":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ReconciledPackage;>;"
    .local v31, "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v36  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v38  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    invoke-interface/range {v31 .. v31}, Ljava/util/Map;->keySet()Ljava/util/Set;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_342
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_3a1

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/lang/String;

    .line 17359
    .restart local v1  # "installPackageName":Ljava/lang/String;
    move-object/from16 v2, v31

    .end local v31  # "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .local v2, "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    invoke-interface {v2, v1}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageManagerService$ScanResult;

    .line 17360
    .local v3, "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    iget-object v4, v3, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget v4, v4, Lcom/android/server/pm/PackageManagerService$ScanRequest;->scanFlags:I

    and-int/lit8 v4, v4, 0x10

    if-nez v4, :cond_39a

    iget-object v4, v3, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget v4, v4, Lcom/android/server/pm/PackageManagerService$ScanRequest;->parseFlags:I

    and-int/lit8 v4, v4, 0x10

    if-eqz v4, :cond_369

    .line 17362
    move-object/from16 v31, v2

    goto :goto_342

    .line 17365
    :cond_369
    :try_start_369
    invoke-interface {v15, v1}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;

    iget-object v5, v3, Lcom/android/server/pm/PackageManagerService$ScanResult;->request:Lcom/android/server/pm/PackageManagerService$ScanRequest;

    iget-object v5, v5, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v6, v14, Lcom/android/server/pm/PackageManagerService$ReconcileRequest;->sharedLibrarySource:Ljava/util/Map;
    :try_end_375
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_369 .. :try_end_375} :catch_389

    .line 17366
    move-object/from16 v8, v36

    move-object/from16 v7, v38

    .end local v36  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .end local v38  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .local v7, "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .local v8, "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    :try_start_379
    invoke-static {v5, v7, v6, v8}, Lcom/android/server/pm/PackageManagerService;->collectSharedLibraryInfos(Landroid/content/pm/PackageParser$Package;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;)Ljava/util/ArrayList;

    move-result-object v5

    iput-object v5, v4, Lcom/android/server/pm/PackageManagerService$ReconciledPackage;->collectedSharedLibraryInfos:Ljava/util/ArrayList;
    :try_end_37f
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_379 .. :try_end_37f} :catch_387

    .line 17371
    nop

    .line 17372
    .end local v1  # "installPackageName":Ljava/lang/String;
    .end local v3  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    move-object/from16 v31, v2

    move-object/from16 v38, v7

    move-object/from16 v36, v8

    goto :goto_342

    .line 17369
    .restart local v1  # "installPackageName":Ljava/lang/String;
    .restart local v3  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    :catch_387
    move-exception v0

    goto :goto_38e

    .end local v7  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .end local v8  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v36  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v38  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    :catch_389
    move-exception v0

    move-object/from16 v8, v36

    move-object/from16 v7, v38

    .line 17370
    .end local v36  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .end local v38  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .restart local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v7  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .restart local v8  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    :goto_38e
    new-instance v4, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;

    iget v5, v0, Lcom/android/server/pm/PackageManagerException;->error:I

    invoke-virtual {v0}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v4, v5, v6}, Lcom/android/server/pm/PackageManagerService$ReconcileFailure;-><init>(ILjava/lang/String;)V

    throw v4

    .line 17360
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v7  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .end local v8  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v36  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v38  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    :cond_39a
    move-object/from16 v8, v36

    move-object/from16 v7, v38

    .end local v36  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .end local v38  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .restart local v7  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .restart local v8  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    move-object/from16 v31, v2

    goto :goto_342

    .line 17374
    .end local v1  # "installPackageName":Ljava/lang/String;
    .end local v2  # "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .end local v3  # "scanResult":Lcom/android/server/pm/PackageManagerService$ScanResult;
    .end local v7  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    .end local v8  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v31  # "scannedPackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    .restart local v36  # "incomingSharedLibraries":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    .restart local v38  # "combinedPackages":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    :cond_3a1
    return-object v15
.end method

.method private static removeKeystoreDataIfNeeded(II)V
    .registers 8
    .param p0, "userId"  # I
    .param p1, "appId"  # I

    .line 20950
    if-gez p1, :cond_3

    .line 20951
    return-void

    .line 20954
    :cond_3
    invoke-static {}, Landroid/security/KeyStore;->getInstance()Landroid/security/KeyStore;

    move-result-object v0

    .line 20955
    .local v0, "keyStore":Landroid/security/KeyStore;
    if-eqz v0, :cond_2a

    .line 20956
    const/4 v1, -0x1

    if-ne p0, v1, :cond_22

    .line 20957
    sget-object v1, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v1

    array-length v2, v1

    const/4 v3, 0x0

    :goto_14
    if-ge v3, v2, :cond_40

    aget v4, v1, v3

    .line 20958
    .local v4, "individual":I
    invoke-static {v4, p1}, Landroid/os/UserHandle;->getUid(II)I

    move-result v5

    invoke-virtual {v0, v5}, Landroid/security/KeyStore;->clearUid(I)Z

    .line 20957
    .end local v4  # "individual":I
    add-int/lit8 v3, v3, 0x1

    goto :goto_14

    .line 20961
    :cond_22
    invoke-static {p0, p1}, Landroid/os/UserHandle;->getUid(II)I

    move-result v1

    invoke-virtual {v0, v1}, Landroid/security/KeyStore;->clearUid(I)Z

    goto :goto_40

    .line 20964
    :cond_2a
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Could not contact keystore to clear entries for app id "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 20966
    :cond_40
    :goto_40
    return-void
.end method

.method private removeNativeBinariesLI(Lcom/android/server/pm/PackageSetting;)V
    .registers 8
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;

    .line 16834
    if-eqz p1, :cond_37

    .line 16835
    iget-object v0, p1, Lcom/android/server/pm/PackageSetting;->legacyNativeLibraryPathString:Ljava/lang/String;

    invoke-static {v0}, Lcom/android/internal/content/NativeLibraryHelper;->removeNativeBinariesLI(Ljava/lang/String;)V

    .line 16837
    iget-object v0, p1, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    if-eqz v0, :cond_12

    iget-object v0, p1, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v0

    goto :goto_13

    :cond_12
    const/4 v0, 0x0

    .line 16838
    .local v0, "childCount":I
    :goto_13
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_14
    if-ge v1, v0, :cond_37

    .line 16839
    const/4 v2, 0x0

    .line 16840
    .local v2, "childPs":Lcom/android/server/pm/PackageSetting;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 16841
    :try_start_1a
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, p1, Lcom/android/server/pm/PackageSetting;->childPackageNames:Ljava/util/List;

    invoke-interface {v5, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/String;

    invoke-virtual {v4, v5}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v4

    move-object v2, v4

    .line 16842
    monitor-exit v3
    :try_end_2a
    .catchall {:try_start_1a .. :try_end_2a} :catchall_34

    .line 16843
    if-eqz v2, :cond_31

    .line 16844
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->legacyNativeLibraryPathString:Ljava/lang/String;

    invoke-static {v3}, Lcom/android/internal/content/NativeLibraryHelper;->removeNativeBinariesLI(Ljava/lang/String;)V

    .line 16838
    .end local v2  # "childPs":Lcom/android/server/pm/PackageSetting;
    :cond_31
    add-int/lit8 v1, v1, 0x1

    goto :goto_14

    .line 16842
    .restart local v2  # "childPs":Lcom/android/server/pm/PackageSetting;
    :catchall_34
    move-exception v4

    :try_start_35
    monitor-exit v3
    :try_end_36
    .catchall {:try_start_35 .. :try_end_36} :catchall_34

    throw v4

    .line 16849
    .end local v0  # "childCount":I
    .end local v1  # "i":I
    .end local v2  # "childPs":Lcom/android/server/pm/PackageSetting;
    :cond_37
    return-void
.end method

.method private removePackageDataLIF(Lcom/android/server/pm/PackageSetting;[ILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;IZ)V
    .registers 25
    .param p1, "deletedPs"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "allUserHandles"  # [I
    .param p3, "outInfo"  # Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .param p4, "flags"  # I
    .param p5, "writeSettings"  # Z

    .line 19758
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move-object/from16 v3, p2

    move-object/from16 v4, p3

    iget-object v5, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    .line 19759
    .local v5, "packageName":Ljava/lang/String;
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v0, :cond_25

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v6, "removePackageDataLI: "

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v6, "PackageManager"

    invoke-static {v6, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 19761
    :cond_25
    iget-object v6, v2, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 19762
    .local v6, "deletedPkg":Landroid/content/pm/PackageParser$Package;
    const/4 v7, 0x1

    if-eqz v4, :cond_49

    .line 19763
    iput-object v5, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    .line 19764
    iget-object v8, v2, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    iput-object v8, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installerPackageName:Ljava/lang/String;

    .line 19765
    if-eqz v6, :cond_38

    iget-object v8, v6, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-eqz v8, :cond_38

    move v8, v7

    goto :goto_39

    :cond_38
    const/4 v8, 0x0

    :goto_39
    iput-boolean v8, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->isStaticSharedLib:Z

    .line 19767
    nop

    .line 19768
    sget-object v8, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v8}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v8

    invoke-virtual {v2, v8, v7}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v8

    .line 19767
    invoke-virtual {v4, v8, v2}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->populateUsers([ILcom/android/server/pm/PackageSetting;)V

    .line 19771
    :cond_49
    iget-object v8, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    const/high16 v9, -0x80000000

    and-int v9, p4, v9

    if-eqz v9, :cond_53

    move v9, v7

    goto :goto_54

    :cond_53
    const/4 v9, 0x0

    :goto_54
    invoke-virtual {v1, v8, v9}, Lcom/android/server/pm/PackageManagerService;->removePackageLI(Ljava/lang/String;Z)V

    .line 19773
    and-int/lit8 v8, p4, 0x1

    const/4 v9, -0x1

    if-nez v8, :cond_77

    .line 19775
    if-eqz v6, :cond_60

    .line 19776
    move-object v8, v6

    .local v8, "resolvedPkg":Landroid/content/pm/PackageParser$Package;
    goto :goto_6c

    .line 19780
    .end local v8  # "resolvedPkg":Landroid/content/pm/PackageParser$Package;
    :cond_60
    new-instance v8, Landroid/content/pm/PackageParser$Package;

    iget-object v10, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-direct {v8, v10}, Landroid/content/pm/PackageParser$Package;-><init>(Ljava/lang/String;)V

    .line 19781
    .restart local v8  # "resolvedPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v10, v2, Lcom/android/server/pm/PackageSetting;->volumeUuid:Ljava/lang/String;

    invoke-virtual {v8, v10}, Landroid/content/pm/PackageParser$Package;->setVolumeUuid(Ljava/lang/String;)V

    .line 19783
    :goto_6c
    const/4 v10, 0x7

    invoke-direct {v1, v8, v9, v10}, Lcom/android/server/pm/PackageManagerService;->destroyAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 19785
    invoke-direct {v1, v8}, Lcom/android/server/pm/PackageManagerService;->destroyAppProfilesLIF(Landroid/content/pm/PackageParser$Package;)V

    .line 19786
    if-eqz v4, :cond_77

    .line 19787
    iput-boolean v7, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->dataRemoved:Z

    .line 19791
    .end local v8  # "resolvedPkg":Landroid/content/pm/PackageParser$Package;
    :cond_77
    const/4 v8, -0x1

    .line 19794
    .local v8, "removedAppId":I
    const/4 v10, 0x0

    .line 19795
    .local v10, "installedStateChanged":Z
    nop

    .line 19796
    and-int/lit8 v11, p4, 0x1

    if-nez v11, :cond_f4

    .line 19797
    new-instance v11, Landroid/util/SparseBooleanArray;

    invoke-direct {v11}, Landroid/util/SparseBooleanArray;-><init>()V

    .line 19798
    .local v11, "changedUsers":Landroid/util/SparseBooleanArray;
    iget-object v12, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v12

    .line 19799
    :try_start_86
    iget-object v13, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v1, v13, v9, v7}, Lcom/android/server/pm/PackageManagerService;->clearIntentFilterVerificationsLPw(Ljava/lang/String;IZ)V

    .line 19800
    invoke-virtual {v1, v5}, Lcom/android/server/pm/PackageManagerService;->clearDefaultBrowserIfNeeded(Ljava/lang/String;)V

    .line 19801
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    invoke-virtual {v7, v5}, Lcom/android/server/pm/KeySetManagerService;->removeAppKeySetDataLPw(Ljava/lang/String;)V

    .line 19802
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v7, v5}, Lcom/android/server/pm/Settings;->removePackageLPw(Ljava/lang/String;)I

    move-result v7

    move v8, v7

    .line 19803
    if-eqz v4, :cond_a0

    .line 19804
    iput v8, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedAppId:I

    .line 19806
    :cond_a0
    iget-object v13, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v14, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    const/4 v15, 0x0

    const/16 v16, 0x0

    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 19807
    invoke-virtual {v7}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v17

    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 19806
    move-object/from16 v18, v7

    invoke-virtual/range {v13 .. v18}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updatePermissions(Ljava/lang/String;Landroid/content/pm/PackageParser$Package;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 19808
    iget-object v7, v2, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eqz v7, :cond_de

    .line 19814
    invoke-static {}, Lcom/android/server/pm/UserManagerService;->getInstance()Lcom/android/server/pm/UserManagerService;

    move-result-object v7

    invoke-virtual {v7}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v7

    array-length v13, v7

    const/4 v14, 0x0

    :goto_c2
    if-ge v14, v13, :cond_de

    aget v15, v7, v14

    .line 19815
    .local v15, "userId":I
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v2, v15}, Lcom/android/server/pm/Settings;->updateSharedUserPermsLPw(Lcom/android/server/pm/PackageSetting;I)I

    move-result v0

    .line 19817
    .local v0, "userIdToKill":I
    if-eq v0, v9, :cond_d4

    if-ltz v0, :cond_d1

    goto :goto_d4

    .line 19814
    .end local v0  # "userIdToKill":I
    .end local v15  # "userId":I
    :cond_d1
    add-int/lit8 v14, v14, 0x1

    goto :goto_c2

    .line 19820
    .restart local v0  # "userIdToKill":I
    .restart local v15  # "userId":I
    :cond_d4
    :goto_d4
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v13, Lcom/android/server/pm/-$$Lambda$PackageManagerService$gcU1RKL3rEcBWLR2OlkcyejcM9M;

    invoke-direct {v13, v1, v2}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$gcU1RKL3rEcBWLR2OlkcyejcM9M;-><init>(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageSetting;)V

    invoke-virtual {v7, v13}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 19829
    .end local v0  # "userIdToKill":I
    .end local v15  # "userId":I
    :cond_de
    iget-object v0, v2, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-direct {v1, v0, v11, v9}, Lcom/android/server/pm/PackageManagerService;->clearPackagePreferredActivitiesLPw(Ljava/lang/String;Landroid/util/SparseBooleanArray;I)V

    .line 19831
    monitor-exit v12
    :try_end_e4
    .catchall {:try_start_86 .. :try_end_e4} :catchall_f1

    .line 19832
    invoke-virtual {v11}, Landroid/util/SparseBooleanArray;->size()I

    move-result v0

    if-lez v0, :cond_f4

    .line 19833
    invoke-direct {v1, v11}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(Landroid/util/SparseBooleanArray;)V

    .line 19834
    invoke-direct {v1, v9}, Lcom/android/server/pm/PackageManagerService;->postPreferredActivityChangedBroadcast(I)V

    goto :goto_f4

    .line 19831
    :catchall_f1
    move-exception v0

    :try_start_f2
    monitor-exit v12
    :try_end_f3
    .catchall {:try_start_f2 .. :try_end_f3} :catchall_f1

    throw v0

    .line 19839
    .end local v11  # "changedUsers":Landroid/util/SparseBooleanArray;
    :cond_f4
    :goto_f4
    if-eqz v3, :cond_142

    if-eqz v4, :cond_142

    iget-object v0, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->origUsers:[I

    if-eqz v0, :cond_142

    .line 19840
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v0, :cond_107

    .line 19841
    const-string v0, "PackageManager"

    const-string v7, "Propagating install state across downgrade"

    invoke-static {v0, v7}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 19843
    :cond_107
    array-length v0, v3

    const/4 v7, 0x0

    :goto_109
    if-ge v7, v0, :cond_142

    aget v11, v3, v7

    .line 19844
    .local v11, "userId":I
    iget-object v12, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->origUsers:[I

    invoke-static {v12, v11}, Lcom/android/internal/util/ArrayUtils;->contains([II)Z

    move-result v12

    .line 19845
    .local v12, "installed":Z
    sget-boolean v13, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v13, :cond_135

    .line 19846
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "    user "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v14, " => "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v12}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    const-string v14, "PackageManager"

    invoke-static {v14, v13}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 19848
    :cond_135
    invoke-virtual {v2, v11}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v13

    if-eq v12, v13, :cond_13c

    .line 19849
    const/4 v10, 0x1

    .line 19851
    :cond_13c
    invoke-virtual {v2, v12, v11}, Lcom/android/server/pm/PackageSetting;->setInstalled(ZI)V

    .line 19843
    .end local v11  # "userId":I
    .end local v12  # "installed":Z
    add-int/lit8 v7, v7, 0x1

    goto :goto_109

    .line 19855
    :cond_142
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v7

    .line 19857
    if-eqz p5, :cond_14f

    .line 19859
    :try_start_147
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0}, Lcom/android/server/pm/Settings;->writeLPr()V

    goto :goto_14f

    .line 19864
    :catchall_14d
    move-exception v0

    goto :goto_15d

    .line 19861
    :cond_14f
    :goto_14f
    if-eqz v10, :cond_156

    .line 19862
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v2}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V

    .line 19864
    :cond_156
    monitor-exit v7
    :try_end_157
    .catchall {:try_start_147 .. :try_end_157} :catchall_14d

    .line 19865
    if-eq v8, v9, :cond_15c

    .line 19868
    invoke-static {v9, v8}, Lcom/android/server/pm/PackageManagerService;->removeKeystoreDataIfNeeded(II)V

    .line 19870
    :cond_15c
    return-void

    .line 19864
    :goto_15d
    :try_start_15d
    monitor-exit v7
    :try_end_15e
    .catchall {:try_start_15d .. :try_end_15e} :catchall_14d

    throw v0
.end method

.method private removePackageLI(Landroid/content/pm/PackageParser$Package;Z)V
    .registers 8
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "chatty"  # Z

    .line 13367
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 13368
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_c

    .line 13369
    iget-object v1, v0, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {p0, v1, p2}, Lcom/android/server/pm/PackageManagerService;->removePackageLI(Ljava/lang/String;Z)V

    goto :goto_2f

    .line 13370
    :cond_c
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v1, :cond_2f

    if-eqz p2, :cond_2f

    .line 13371
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Not removing package "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, "; mExtras == null"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 13374
    :cond_2f
    :goto_2f
    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v1, :cond_3a

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    goto :goto_3b

    :cond_3a
    const/4 v1, 0x0

    .line 13375
    .local v1, "childCount":I
    :goto_3b
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_3c
    if-ge v2, v1, :cond_55

    .line 13376
    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 13377
    .local v3, "childPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    move-object v0, v4

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 13378
    if-eqz v0, :cond_52

    .line 13379
    iget-object v4, v0, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {p0, v4, p2}, Lcom/android/server/pm/PackageManagerService;->removePackageLI(Ljava/lang/String;Z)V

    .line 13375
    .end local v3  # "childPkg":Landroid/content/pm/PackageParser$Package;
    :cond_52
    add-int/lit8 v2, v2, 0x1

    goto :goto_3c

    .line 13382
    .end local v2  # "i":I
    :cond_55
    return-void
.end method

.method private removeSharedLibraryLPw(Ljava/lang/String;J)Z
    .registers 9
    .param p1, "name"  # Ljava/lang/String;
    .param p2, "version"  # J

    .line 12613
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v0, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/util/LongSparseArray;

    .line 12614
    .local v0, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    const/4 v1, 0x0

    if-nez v0, :cond_c

    .line 12615
    return v1

    .line 12617
    :cond_c
    invoke-virtual {v0, p2, p3}, Landroid/util/LongSparseArray;->indexOfKey(J)I

    move-result v2

    .line 12618
    .local v2, "libIdx":I
    if-gez v2, :cond_13

    .line 12619
    return v1

    .line 12621
    :cond_13
    invoke-virtual {v0, v2}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/SharedLibraryInfo;

    .line 12622
    .local v1, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    invoke-virtual {v0, p2, p3}, Landroid/util/LongSparseArray;->remove(J)V

    .line 12623
    invoke-virtual {v0}, Landroid/util/LongSparseArray;->size()I

    move-result v3

    if-gtz v3, :cond_3b

    .line 12624
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 12625
    invoke-virtual {v1}, Landroid/content/pm/SharedLibraryInfo;->getType()I

    move-result v3

    const/4 v4, 0x2

    if-ne v3, v4, :cond_3b

    .line 12626
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mStaticLibsByDeclaringPackage:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v4

    .line 12627
    invoke-virtual {v4}, Landroid/content/pm/VersionedPackage;->getPackageName()Ljava/lang/String;

    move-result-object v4

    .line 12626
    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 12630
    :cond_3b
    const/4 v3, 0x1

    return v3
.end method

.method private removeUnusedPackagesLPw(Lcom/android/server/pm/UserManagerService;I)V
    .registers 11
    .param p1, "userManager"  # Lcom/android/server/pm/UserManagerService;
    .param p2, "userHandle"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 24648
    const/4 v0, 0x0

    .line 24649
    .local v0, "DEBUG_CLEAN_APKS":Z
    invoke-virtual {p1}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v1

    .line 24650
    .local v1, "users":[I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .line 24651
    .local v2, "psit":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    :cond_11
    :goto_11
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_60

    .line 24652
    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 24653
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v4, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-nez v4, :cond_22

    .line 24654
    goto :goto_11

    .line 24656
    :cond_22
    iget-object v4, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 24658
    .local v4, "packageName":Ljava/lang/String;
    iget v5, v3, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    and-int/lit8 v5, v5, 0x1

    if-nez v5, :cond_11

    iget-object v5, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v5, v5, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    .line 24659
    invoke-static {v5}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v5

    if-nez v5, :cond_37

    .line 24660
    goto :goto_11

    .line 24665
    :cond_37
    invoke-direct {p0, v4}, Lcom/android/server/pm/PackageManagerService;->shouldKeepUninstalledPackageLPr(Ljava/lang/String;)Z

    move-result v5

    .line 24666
    .local v5, "keep":Z
    if-eqz v5, :cond_3e

    goto :goto_53

    .line 24671
    :cond_3e
    const/4 v6, 0x0

    .local v6, "i":I
    :goto_3f
    array-length v7, v1

    if-ge v6, v7, :cond_53

    .line 24672
    aget v7, v1, v6

    if-eq v7, p2, :cond_50

    aget v7, v1, v6

    invoke-virtual {v3, v7}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v7

    if-eqz v7, :cond_50

    .line 24673
    const/4 v5, 0x1

    .line 24678
    goto :goto_53

    .line 24671
    :cond_50
    add-int/lit8 v6, v6, 0x1

    goto :goto_3f

    .line 24682
    .end local v6  # "i":I
    :cond_53
    :goto_53
    if-nez v5, :cond_5f

    .line 24687
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v7, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Pm72-V-71sQAfx1TmE9rlLUh1hk;

    invoke-direct {v7, p0, v4, p2}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Pm72-V-71sQAfx1TmE9rlLUh1hk;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;I)V

    invoke-virtual {v6, v7}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 24690
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "packageName":Ljava/lang/String;
    .end local v5  # "keep":Z
    :cond_5f
    goto :goto_11

    .line 24691
    :cond_60
    return-void
.end method

.method private static renameStaticSharedLibraryPackage(Landroid/content/pm/PackageParser$Package;)V
    .registers 4
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 10008
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "_"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v1, p0, Landroid/content/pm/PackageParser$Package;->staticSharedLibVersion:J

    invoke-virtual {v0, v1, v2}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p0, v0}, Landroid/content/pm/PackageParser$Package;->setPackageName(Ljava/lang/String;)V

    .line 10010
    return-void
.end method

.method public static reportSettingsProblem(ILjava/lang/String;)V
    .registers 2
    .param p0, "priority"  # I
    .param p1, "msg"  # Ljava/lang/String;

    .line 9552
    invoke-static {p0, p1}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 9553
    return-void
.end method

.method private static requestCopyPreoptedFiles()V
    .registers 13

    .line 2470
    const/16 v0, 0x64

    .line 2471
    .local v0, "WAIT_TIME_MS":I
    const-string/jumbo v1, "sys.cppreopt"

    .line 2472
    .local v1, "CP_PREOPT_PROPERTY":Ljava/lang/String;
    const-string/jumbo v2, "ro.cp_system_other_odex"

    const/4 v3, 0x0

    invoke-static {v2, v3}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I

    move-result v2

    const/4 v3, 0x1

    if-ne v2, v3, :cond_65

    .line 2473
    const-string/jumbo v2, "sys.cppreopt"

    const-string/jumbo v3, "requested"

    invoke-static {v2, v3}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 2475
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    .line 2476
    .local v3, "timeStart":J
    const-wide/32 v5, 0x186a0

    add-long/2addr v5, v3

    .line 2477
    .local v5, "timeEnd":J
    move-wide v7, v3

    .line 2478
    .local v7, "timeNow":J
    :cond_22
    invoke-static {v2}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    const-string v10, "finished"

    invoke-virtual {v9, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v9

    const-string v10, "PackageManager"

    if-nez v9, :cond_4a

    .line 2480
    const-wide/16 v11, 0x64

    :try_start_32
    invoke-static {v11, v12}, Ljava/lang/Thread;->sleep(J)V
    :try_end_35
    .catch Ljava/lang/InterruptedException; {:try_start_32 .. :try_end_35} :catch_36

    .line 2483
    goto :goto_37

    .line 2481
    :catch_36
    move-exception v9

    .line 2484
    :goto_37
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v7

    .line 2485
    cmp-long v9, v7, v5

    if-lez v9, :cond_22

    .line 2486
    const-string/jumbo v9, "timed-out"

    invoke-static {v2, v9}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 2487
    const-string v2, "cppreopt did not finish!"

    invoke-static {v10, v2}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    .line 2492
    :cond_4a
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "cppreopts took "

    invoke-virtual {v2, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    sub-long v11, v7, v3

    invoke-virtual {v2, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v9, " ms"

    invoke-virtual {v2, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v10, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2494
    .end local v3  # "timeStart":J
    .end local v5  # "timeEnd":J
    .end local v7  # "timeNow":J
    :cond_65
    return-void
.end method

.method private requestInstantAppResolutionPhaseTwo(Landroid/content/pm/AuxiliaryResolveInfo;Landroid/content/Intent;Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;I)V
    .registers 18
    .param p1, "responseObj"  # Landroid/content/pm/AuxiliaryResolveInfo;
    .param p2, "origIntent"  # Landroid/content/Intent;
    .param p3, "resolvedType"  # Ljava/lang/String;
    .param p4, "callingPackage"  # Ljava/lang/String;
    .param p5, "verificationBundle"  # Landroid/os/Bundle;
    .param p6, "userId"  # I

    .line 7014
    move-object v0, p0

    iget-object v1, v0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v10, Landroid/content/pm/InstantAppRequest;

    const/4 v9, 0x0

    move-object v2, v10

    move-object v3, p1

    move-object v4, p2

    move-object v5, p3

    move-object v6, p4

    move/from16 v7, p6

    move-object/from16 v8, p5

    invoke-direct/range {v2 .. v9}, Landroid/content/pm/InstantAppRequest;-><init>(Landroid/content/pm/AuxiliaryResolveInfo;Landroid/content/Intent;Ljava/lang/String;Ljava/lang/String;ILandroid/os/Bundle;Z)V

    const/16 v2, 0x14

    invoke-virtual {v1, v2, v10}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(ILjava/lang/Object;)Landroid/os/Message;

    move-result-object v1

    .line 7017
    .local v1, "msg":Landroid/os/Message;
    iget-object v2, v0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v2, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 7018
    return-void
.end method

.method private resetNetworkPolicies(I)V
    .registers 3
    .param p1, "userId"  # I

    .line 20768
    const-class v0, Lcom/android/server/net/NetworkPolicyManagerInternal;

    invoke-static {v0}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/net/NetworkPolicyManagerInternal;

    invoke-virtual {v0, p1}, Lcom/android/server/net/NetworkPolicyManagerInternal;->resetUserState(I)V

    .line 20769
    return-void
.end method

.method private resetUserChangesToRuntimePermissionsAndFlagsLPw(I)V
    .registers 6
    .param p1, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 20759
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v0

    .line 20760
    .local v0, "packageCount":I
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_7
    if-ge v1, v0, :cond_1b

    .line 20761
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, v1}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 20762
    .local v2, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v3, v2, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 20763
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v3, p1}, Lcom/android/server/pm/PackageManagerService;->resetUserChangesToRuntimePermissionsAndFlagsLPw(Lcom/android/server/pm/PackageSetting;I)V

    .line 20760
    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    add-int/lit8 v1, v1, 0x1

    goto :goto_7

    .line 20765
    .end local v1  # "i":I
    :cond_1b
    return-void
.end method

.method private resetUserChangesToRuntimePermissionsAndFlagsLPw(Lcom/android/server/pm/PackageSetting;I)V
    .registers 27
    .param p1, "ps"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "userId"  # I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 20780
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    iget-object v2, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-nez v2, :cond_9

    .line 20781
    return-void

    .line 20784
    :cond_9
    iget-object v2, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 20787
    .local v2, "packageName":Ljava/lang/String;
    const/16 v12, 0x4b

    .line 20792
    .local v12, "userSettableMask":I
    const/16 v13, 0x14

    .line 20796
    .local v13, "policyOrSystemFlags":I
    const/4 v3, 0x1

    new-array v14, v3, [Z

    .line 20797
    .local v14, "permissionRemoved":[Z
    new-instance v3, Landroid/util/ArraySet;

    invoke-direct {v3}, Landroid/util/ArraySet;-><init>()V

    move-object v15, v3

    .line 20798
    .local v15, "revokedPermissions":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/Long;>;"
    new-instance v3, Landroid/util/SparseBooleanArray;

    invoke-direct {v3}, Landroid/util/SparseBooleanArray;-><init>()V

    move-object v10, v3

    .line 20800
    .local v10, "updatedUsers":Landroid/util/SparseBooleanArray;
    new-instance v11, Lcom/android/server/pm/PackageManagerService$5;

    invoke-direct {v11, v0, v15, v10, v14}, Lcom/android/server/pm/PackageManagerService$5;-><init>(Lcom/android/server/pm/PackageManagerService;Landroid/util/ArraySet;Landroid/util/SparseBooleanArray;[Z)V

    .line 20849
    .local v11, "delayingPermCallback":Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;
    iget-object v3, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v3, Landroid/content/pm/PackageParser$Package;->requestedPermissions:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v9

    .line 20850
    .local v9, "permissionCount":I
    const/4 v3, 0x0

    move v8, v3

    .local v8, "i":I
    :goto_2f
    if-ge v8, v9, :cond_127

    .line 20851
    iget-object v3, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v3, Landroid/content/pm/PackageParser$Package;->requestedPermissions:Ljava/util/ArrayList;

    invoke-virtual {v3, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    move-object v7, v3

    check-cast v7, Ljava/lang/String;

    .line 20852
    .local v7, "permName":Ljava/lang/String;
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 20853
    invoke-virtual {v3, v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getPermissionTEMP(Ljava/lang/String;)Lcom/android/server/pm/permission/BasePermission;

    move-result-object v16

    .line 20854
    .local v16, "bp":Lcom/android/server/pm/permission/BasePermission;
    if-nez v16, :cond_4c

    .line 20855
    move/from16 v22, v8

    move/from16 v20, v9

    move-object/from16 v23, v10

    goto/16 :goto_11f

    .line 20858
    :cond_4c
    invoke-virtual/range {v16 .. v16}, Lcom/android/server/pm/permission/BasePermission;->isRemoved()Z

    move-result v3

    if-eqz v3, :cond_5a

    .line 20859
    move/from16 v22, v8

    move/from16 v20, v9

    move-object/from16 v23, v10

    goto/16 :goto_11f

    .line 20863
    :cond_5a
    iget-object v3, v1, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eqz v3, :cond_af

    .line 20864
    const/4 v3, 0x0

    .line 20865
    .local v3, "used":Z
    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v4, v4, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v4}, Landroid/util/ArraySet;->size()I

    move-result v4

    .line 20866
    .local v4, "packageCount":I
    const/4 v5, 0x0

    .local v5, "j":I
    :goto_68
    if-ge v5, v4, :cond_a1

    .line 20867
    iget-object v6, v1, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v6, v6, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v6, v5}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    .line 20868
    .local v6, "pkg":Lcom/android/server/pm/PackageSetting;
    move/from16 v17, v3

    .end local v3  # "used":Z
    .local v17, "used":Z
    iget-object v3, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v3, :cond_98

    iget-object v3, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    move/from16 v18, v4

    .end local v4  # "packageCount":I
    .local v18, "packageCount":I
    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_9a

    iget-object v3, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v3, Landroid/content/pm/PackageParser$Package;->requestedPermissions:Ljava/util/ArrayList;

    .line 20869
    invoke-virtual {v3, v7}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_9a

    .line 20870
    const/4 v3, 0x1

    .line 20871
    .end local v17  # "used":Z
    .restart local v3  # "used":Z
    move/from16 v17, v3

    goto :goto_a5

    .line 20868
    .end local v3  # "used":Z
    .end local v18  # "packageCount":I
    .restart local v4  # "packageCount":I
    .restart local v17  # "used":Z
    :cond_98
    move/from16 v18, v4

    .line 20866
    .end local v4  # "packageCount":I
    .end local v6  # "pkg":Lcom/android/server/pm/PackageSetting;
    .restart local v18  # "packageCount":I
    :cond_9a
    add-int/lit8 v5, v5, 0x1

    move/from16 v3, v17

    move/from16 v4, v18

    goto :goto_68

    .end local v17  # "used":Z
    .end local v18  # "packageCount":I
    .restart local v3  # "used":Z
    .restart local v4  # "packageCount":I
    :cond_a1
    move/from16 v17, v3

    move/from16 v18, v4

    .line 20874
    .end local v3  # "used":Z
    .end local v4  # "packageCount":I
    .end local v5  # "j":I
    .restart local v17  # "used":Z
    .restart local v18  # "packageCount":I
    :goto_a5
    if-eqz v17, :cond_af

    .line 20875
    move/from16 v22, v8

    move/from16 v20, v9

    move-object/from16 v23, v10

    goto/16 :goto_11f

    .line 20879
    .end local v17  # "used":Z
    .end local v18  # "packageCount":I
    :cond_af
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/16 v4, 0x3e8

    move/from16 v6, p2

    invoke-virtual {v3, v7, v2, v4, v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getPermissionFlags(Ljava/lang/String;Ljava/lang/String;II)I

    move-result v17

    .line 20885
    .local v17, "oldFlags":I
    const/4 v3, 0x0

    .line 20886
    .local v3, "flags":I
    iget-object v4, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    const/16 v5, 0x17

    if-ge v4, v5, :cond_cf

    invoke-virtual/range {v16 .. v16}, Lcom/android/server/pm/permission/BasePermission;->isRuntime()Z

    move-result v4

    if-eqz v4, :cond_cf

    .line 20887
    or-int/lit8 v3, v3, 0x48

    move/from16 v18, v3

    goto :goto_d1

    .line 20890
    :cond_cf
    move/from16 v18, v3

    .end local v3  # "flags":I
    .local v18, "flags":I
    :goto_d1
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/16 v19, 0x4b

    const/16 v20, 0x3e8

    const/16 v21, 0x0

    move-object v4, v7

    move-object v5, v2

    move/from16 v6, v19

    move-object/from16 v19, v7

    .end local v7  # "permName":Ljava/lang/String;
    .local v19, "permName":Ljava/lang/String;
    move/from16 v7, v18

    move/from16 v22, v8

    .end local v8  # "i":I
    .local v22, "i":I
    move/from16 v8, v20

    move/from16 v20, v9

    .end local v9  # "permissionCount":I
    .local v20, "permissionCount":I
    move/from16 v9, p2

    move-object/from16 v23, v10

    .end local v10  # "updatedUsers":Landroid/util/SparseBooleanArray;
    .local v23, "updatedUsers":Landroid/util/SparseBooleanArray;
    move/from16 v10, v21

    invoke-virtual/range {v3 .. v11}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updatePermissionFlags(Ljava/lang/String;Ljava/lang/String;IIIIZLcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 20895
    invoke-virtual/range {v16 .. v16}, Lcom/android/server/pm/permission/BasePermission;->isRuntime()Z

    move-result v3

    if-nez v3, :cond_f7

    .line 20896
    goto :goto_11f

    .line 20900
    :cond_f7
    and-int/lit8 v3, v17, 0x14

    if-eqz v3, :cond_fc

    .line 20901
    goto :goto_11f

    .line 20905
    :cond_fc
    and-int/lit8 v3, v17, 0x20

    if-eqz v3, :cond_10f

    .line 20906
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v6, 0x0

    const/16 v7, 0x3e8

    move-object/from16 v4, v19

    move-object v5, v2

    move/from16 v8, p2

    move-object v9, v11

    invoke-virtual/range {v3 .. v9}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->grantRuntimePermission(Ljava/lang/String;Ljava/lang/String;ZIILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    goto :goto_11f

    .line 20910
    :cond_10f
    and-int/lit8 v3, v18, 0x40

    if-nez v3, :cond_11f

    .line 20912
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v6, 0x0

    move-object/from16 v4, v19

    move-object v5, v2

    move/from16 v7, p2

    move-object v8, v11

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->revokeRuntimePermission(Ljava/lang/String;Ljava/lang/String;ZILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 20850
    .end local v16  # "bp":Lcom/android/server/pm/permission/BasePermission;
    .end local v17  # "oldFlags":I
    .end local v18  # "flags":I
    .end local v19  # "permName":Ljava/lang/String;
    :cond_11f
    :goto_11f
    add-int/lit8 v8, v22, 0x1

    move/from16 v9, v20

    move-object/from16 v10, v23

    .end local v22  # "i":I
    .restart local v8  # "i":I
    goto/16 :goto_2f

    .end local v20  # "permissionCount":I
    .end local v23  # "updatedUsers":Landroid/util/SparseBooleanArray;
    .restart local v9  # "permissionCount":I
    .restart local v10  # "updatedUsers":Landroid/util/SparseBooleanArray;
    :cond_127
    move/from16 v22, v8

    move/from16 v20, v9

    move-object/from16 v23, v10

    .line 20918
    .end local v8  # "i":I
    .end local v9  # "permissionCount":I
    .end local v10  # "updatedUsers":Landroid/util/SparseBooleanArray;
    .restart local v20  # "permissionCount":I
    .restart local v23  # "updatedUsers":Landroid/util/SparseBooleanArray;
    const/4 v3, 0x0

    aget-boolean v3, v14, v3

    if-eqz v3, :cond_137

    .line 20919
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    invoke-virtual {v3}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;->onPermissionRemoved()V

    .line 20924
    :cond_137
    invoke-virtual {v15}, Landroid/util/ArraySet;->isEmpty()Z

    move-result v3

    if-nez v3, :cond_172

    .line 20925
    invoke-virtual {v15}, Landroid/util/ArraySet;->size()I

    move-result v3

    .line 20926
    .local v3, "numRevokedPermissions":I
    const/4 v4, 0x0

    .local v4, "i":I
    :goto_142
    if-ge v4, v3, :cond_172

    .line 20927
    invoke-virtual {v15, v4}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/Long;

    invoke-virtual {v5}, Ljava/lang/Long;->longValue()J

    move-result-wide v5

    invoke-static {v5, v6}, Lcom/android/internal/util/IntPair;->first(J)I

    move-result v5

    .line 20928
    .local v5, "revocationUID":I
    invoke-virtual {v15, v4}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/Long;

    invoke-virtual {v6}, Ljava/lang/Long;->longValue()J

    move-result-wide v6

    invoke-static {v6, v7}, Lcom/android/internal/util/IntPair;->second(J)I

    move-result v6

    .line 20930
    .local v6, "revocationUserId":I
    iget-object v7, v0, Lcom/android/server/pm/PackageManagerService;->mOnPermissionChangeListeners:Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;

    invoke-virtual {v7, v5}, Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;->onPermissionsChanged(I)V

    .line 20933
    iget-object v7, v0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v8, Lcom/android/server/pm/-$$Lambda$PackageManagerService$T9irnsyd0hjl-Q0V6JKQ0qWiY3g;

    invoke-direct {v8, v0, v5, v6}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$T9irnsyd0hjl-Q0V6JKQ0qWiY3g;-><init>(Lcom/android/server/pm/PackageManagerService;II)V

    invoke-virtual {v7, v8}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 20926
    .end local v5  # "revocationUID":I
    .end local v6  # "revocationUserId":I
    add-int/lit8 v4, v4, 0x1

    goto :goto_142

    .line 20938
    .end local v3  # "numRevokedPermissions":I
    .end local v4  # "i":I
    :cond_172
    invoke-virtual/range {v23 .. v23}, Landroid/util/SparseBooleanArray;->size()I

    move-result v3

    .line 20939
    .local v3, "numUpdatedUsers":I
    const/4 v4, 0x0

    .restart local v4  # "i":I
    :goto_177
    if-ge v4, v3, :cond_18b

    .line 20940
    iget-object v5, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    move-object/from16 v6, v23

    .end local v23  # "updatedUsers":Landroid/util/SparseBooleanArray;
    .local v6, "updatedUsers":Landroid/util/SparseBooleanArray;
    invoke-virtual {v6, v4}, Landroid/util/SparseBooleanArray;->keyAt(I)I

    move-result v7

    .line 20941
    invoke-virtual {v6, v4}, Landroid/util/SparseBooleanArray;->valueAt(I)Z

    move-result v8

    .line 20940
    invoke-virtual {v5, v7, v8}, Lcom/android/server/pm/Settings;->writeRuntimePermissionsForUserLPr(IZ)V

    .line 20939
    add-int/lit8 v4, v4, 0x1

    goto :goto_177

    .line 20943
    .end local v4  # "i":I
    .end local v6  # "updatedUsers":Landroid/util/SparseBooleanArray;
    .restart local v23  # "updatedUsers":Landroid/util/SparseBooleanArray;
    :cond_18b
    return-void
.end method

.method private resolveContentProviderInternal(Ljava/lang/String;II)Landroid/content/pm/ProviderInfo;
    .registers 14
    .param p1, "name"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 9332
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p3}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    return-object v1

    .line 9333
    :cond_a
    invoke-direct {p0, p2, p3, p1}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForComponent(IILjava/lang/Object;)I

    move-result p2

    .line 9334
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 9335
    .local v0, "callingUid":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v2, p1, p2, p3}, Lcom/android/server/pm/ComponentResolver;->queryProvider(Ljava/lang/String;II)Landroid/content/pm/ProviderInfo;

    move-result-object v8

    .line 9336
    .local v8, "providerInfo":Landroid/content/pm/ProviderInfo;
    if-nez v8, :cond_1b

    .line 9337
    return-object v1

    .line 9339
    :cond_1b
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v8, p2, p3}, Lcom/android/server/pm/Settings;->isEnabledAndMatchLPr(Landroid/content/pm/ComponentInfo;II)Z

    move-result v2

    if-nez v2, :cond_24

    .line 9340
    return-object v1

    .line 9342
    :cond_24
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v9

    .line 9343
    :try_start_27
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v3, v8, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    move-object v3, v2

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 9344
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    new-instance v5, Landroid/content/ComponentName;

    iget-object v2, v8, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    iget-object v4, v8, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-direct {v5, v2, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 9346
    .local v5, "component":Landroid/content/ComponentName;
    const/4 v6, 0x4

    move-object v2, p0

    move v4, v0

    move v7, p3

    invoke-direct/range {v2 .. v7}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v2

    if-eqz v2, :cond_49

    .line 9347
    monitor-exit v9

    return-object v1

    .line 9349
    :cond_49
    monitor-exit v9

    return-object v8

    .line 9350
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "component":Landroid/content/ComponentName;
    :catchall_4b
    move-exception v1

    monitor-exit v9
    :try_end_4d
    .catchall {:try_start_27 .. :try_end_4d} :catchall_4b

    throw v1
.end method

.method private resolveExternalPackageNameLPr(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;
    .registers 3
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 19245
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-eqz v0, :cond_7

    .line 19246
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->manifestPackageName:Ljava/lang/String;

    return-object v0

    .line 19248
    :cond_7
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    return-object v0
.end method

.method private resolveIntentInternal(Landroid/content/Intent;Ljava/lang/String;IIZI)Landroid/content/pm/ResolveInfo;
    .registers 26
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .param p5, "resolveForStart"  # Z
    .param p6, "filterCallingUid"  # I

    move-object/from16 v11, p0

    move/from16 v10, p4

    .line 6847
    const-wide/32 v8, 0x40000

    :try_start_7
    const-string/jumbo v0, "resolveIntent"

    invoke-static {v8, v9, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 6849
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v10}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0
    :try_end_13
    .catchall {:try_start_7 .. :try_end_13} :catchall_99

    if-nez v0, :cond_1a

    const/4 v0, 0x0

    .line 6869
    invoke-static {v8, v9}, Landroid/os/Trace;->traceEnd(J)V

    .line 6849
    return-object v0

    .line 6851
    :cond_1a
    :try_start_1a
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService;->flymePackageManagerService:Lcom/android/server/pm/FlymePackageManagerService;
    :try_end_1c
    .catchall {:try_start_1a .. :try_end_1c} :catchall_99

    if-eqz v0, :cond_3b

    .line 6852
    :try_start_1e
    iget-object v0, v11, Lcom/android/server/pm/PackageManagerService;->flymePackageManagerService:Lcom/android/server/pm/FlymePackageManagerService;
    :try_end_20
    .catchall {:try_start_1e .. :try_end_20} :catchall_31

    move-object/from16 v1, p1

    :try_start_22
    invoke-virtual {v0, v1, v10}, Lcom/android/server/pm/FlymePackageManagerService;->transformIntent(Landroid/content/Intent;I)Landroid/content/Intent;

    move-result-object v0
    :try_end_26
    .catchall {:try_start_22 .. :try_end_26} :catchall_29

    move-object/from16 v18, v0

    .end local p1  # "intent":Landroid/content/Intent;
    .local v0, "intent":Landroid/content/Intent;
    goto :goto_3f

    .line 6869
    .end local v0  # "intent":Landroid/content/Intent;
    .restart local p1  # "intent":Landroid/content/Intent;
    :catchall_29
    move-exception v0

    move/from16 v4, p3

    move-object/from16 v18, v1

    move-wide v14, v8

    goto/16 :goto_a1

    :catchall_31
    move-exception v0

    move-object/from16 v1, p1

    move/from16 v4, p3

    move-object/from16 v18, v1

    move-wide v14, v8

    goto/16 :goto_a1

    .line 6851
    :cond_3b
    move-object/from16 v1, p1

    move-object/from16 v18, v1

    .line 6855
    .end local p1  # "intent":Landroid/content/Intent;
    .local v18, "intent":Landroid/content/Intent;
    :goto_3f
    :try_start_3f
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v13

    .line 6856
    .local v13, "callingUid":I
    move-object/from16 v1, p0

    move/from16 v2, p3

    move/from16 v3, p4

    move-object/from16 v4, v18

    move/from16 v5, p6

    move/from16 v6, p5

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZ)I

    move-result v4
    :try_end_53
    .catchall {:try_start_3f .. :try_end_53} :catchall_94

    .line 6857
    .end local p3  # "flags":I
    .local v4, "flags":I
    :try_start_53
    iget-object v12, v11, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v15, 0x0

    const/16 v16, 0x0

    const-string/jumbo v17, "resolve intent"

    move/from16 v14, p4

    invoke-virtual/range {v12 .. v17}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 6860
    const-string/jumbo v0, "queryIntentActivities"

    invoke-static {v8, v9, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V
    :try_end_66
    .catchall {:try_start_53 .. :try_end_66} :catchall_91

    .line 6861
    const/4 v0, 0x1

    move-object/from16 v1, p0

    move-object/from16 v2, v18

    move-object/from16 v3, p2

    move/from16 v5, p6

    move/from16 v6, p4

    move/from16 v7, p5

    move-wide v14, v8

    move v8, v0

    :try_start_75
    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZZ)Ljava/util/List;

    move-result-object v9

    .line 6863
    .local v9, "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-static {v14, v15}, Landroid/os/Trace;->traceEnd(J)V

    .line 6865
    nop

    .line 6866
    move-object/from16 v5, p0

    move-object/from16 v6, v18

    move-object/from16 v7, p2

    move v8, v4

    move/from16 v10, p4

    invoke-direct/range {v5 .. v10}, Lcom/android/server/pm/PackageManagerService;->chooseBestActivity(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;I)Landroid/content/pm/ResolveInfo;

    move-result-object v0
    :try_end_8a
    .catchall {:try_start_75 .. :try_end_8a} :catchall_8f

    .line 6867
    .local v0, "bestChoice":Landroid/content/pm/ResolveInfo;
    nop

    .line 6869
    invoke-static {v14, v15}, Landroid/os/Trace;->traceEnd(J)V

    .line 6867
    return-object v0

    .line 6869
    .end local v0  # "bestChoice":Landroid/content/pm/ResolveInfo;
    .end local v9  # "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local v13  # "callingUid":I
    :catchall_8f
    move-exception v0

    goto :goto_a1

    :catchall_91
    move-exception v0

    move-wide v14, v8

    goto :goto_a1

    .end local v4  # "flags":I
    .restart local p3  # "flags":I
    :catchall_94
    move-exception v0

    move-wide v14, v8

    move/from16 v4, p3

    goto :goto_a1

    .end local v18  # "intent":Landroid/content/Intent;
    .restart local p1  # "intent":Landroid/content/Intent;
    :catchall_99
    move-exception v0

    move-object/from16 v1, p1

    move-wide v14, v8

    move/from16 v4, p3

    move-object/from16 v18, v1

    .end local p1  # "intent":Landroid/content/Intent;
    .end local p3  # "flags":I
    .restart local v4  # "flags":I
    .restart local v18  # "intent":Landroid/content/Intent;
    :goto_a1
    invoke-static {v14, v15}, Landroid/os/Trace;->traceEnd(J)V

    throw v0
.end method

.method private resolveInternalPackageNameLPr(Ljava/lang/String;J)Ljava/lang/String;
    .registers 19
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "versionCode"  # J
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 19254
    move-object v0, p0

    iget-object v1, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    move-object/from16 v2, p1

    invoke-virtual {v1, v2}, Lcom/android/server/pm/Settings;->getRenamedPackageLPr(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    .line 19255
    .local v1, "normalizedPackageName":Ljava/lang/String;
    if-eqz v1, :cond_d

    move-object v3, v1

    goto :goto_e

    :cond_d
    move-object v3, v2

    :goto_e
    move-object v2, v3

    .line 19258
    .end local p1  # "packageName":Ljava/lang/String;
    .local v2, "packageName":Ljava/lang/String;
    iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mStaticLibsByDeclaringPackage:Landroid/util/ArrayMap;

    .line 19259
    invoke-virtual {v3, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/util/LongSparseArray;

    .line 19260
    .local v3, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-eqz v3, :cond_c4

    invoke-virtual {v3}, Landroid/util/LongSparseArray;->size()I

    move-result v4

    if-gtz v4, :cond_21

    goto/16 :goto_c4

    .line 19265
    :cond_21
    const/4 v4, 0x0

    .line 19266
    .local v4, "versionsCallerCanSee":Landroid/util/LongSparseLongArray;
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    invoke-static {v5}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v5

    .line 19267
    .local v5, "callingAppId":I
    const/16 v6, 0x3e8

    if-eq v5, v6, :cond_6c

    const/16 v6, 0x7d0

    if-eq v5, v6, :cond_6c

    if-eqz v5, :cond_6c

    .line 19269
    new-instance v6, Landroid/util/LongSparseLongArray;

    invoke-direct {v6}, Landroid/util/LongSparseLongArray;-><init>()V

    move-object v4, v6

    .line 19270
    const/4 v6, 0x0

    invoke-virtual {v3, v6}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Landroid/content/pm/SharedLibraryInfo;

    invoke-virtual {v7}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v7

    .line 19271
    .local v7, "libName":Ljava/lang/String;
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    invoke-virtual {p0, v8}, Lcom/android/server/pm/PackageManagerService;->getPackagesForUid(I)[Ljava/lang/String;

    move-result-object v8

    .line 19272
    .local v8, "uidPackages":[Ljava/lang/String;
    if-eqz v8, :cond_6c

    .line 19273
    array-length v9, v8

    :goto_50
    if-ge v6, v9, :cond_6c

    aget-object v10, v8, v6

    .line 19274
    .local v10, "uidPackage":Ljava/lang/String;
    iget-object v11, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v11, v10}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v11

    .line 19275
    .local v11, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v12, v11, Lcom/android/server/pm/PackageSetting;->usesStaticLibraries:[Ljava/lang/String;

    invoke-static {v12, v7}, Lcom/android/internal/util/ArrayUtils;->indexOf([Ljava/lang/Object;Ljava/lang/Object;)I

    move-result v12

    .line 19276
    .local v12, "libIdx":I
    if-ltz v12, :cond_69

    .line 19277
    iget-object v13, v11, Lcom/android/server/pm/PackageSetting;->usesStaticLibrariesVersions:[J

    aget-wide v13, v13, v12

    .line 19278
    .local v13, "libVersion":J
    invoke-virtual {v4, v13, v14, v13, v14}, Landroid/util/LongSparseLongArray;->append(JJ)V

    .line 19273
    .end local v10  # "uidPackage":Ljava/lang/String;
    .end local v11  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "libIdx":I
    .end local v13  # "libVersion":J
    :cond_69
    add-int/lit8 v6, v6, 0x1

    goto :goto_50

    .line 19285
    .end local v7  # "libName":Ljava/lang/String;
    .end local v8  # "uidPackages":[Ljava/lang/String;
    :cond_6c
    if-eqz v4, :cond_75

    invoke-virtual {v4}, Landroid/util/LongSparseLongArray;->size()I

    move-result v6

    if-gtz v6, :cond_75

    .line 19286
    return-object v2

    .line 19290
    :cond_75
    const/4 v6, 0x0

    .line 19291
    .local v6, "highestVersion":Landroid/content/pm/SharedLibraryInfo;
    invoke-virtual {v3}, Landroid/util/LongSparseArray;->size()I

    move-result v7

    .line 19292
    .local v7, "versionCount":I
    const/4 v8, 0x0

    .local v8, "i":I
    :goto_7b
    if-ge v8, v7, :cond_bc

    .line 19293
    invoke-virtual {v3, v8}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Landroid/content/pm/SharedLibraryInfo;

    .line 19294
    .local v9, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v4, :cond_90

    .line 19295
    invoke-virtual {v9}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v10

    .line 19294
    invoke-virtual {v4, v10, v11}, Landroid/util/LongSparseLongArray;->indexOfKey(J)I

    move-result v10

    if-gez v10, :cond_90

    .line 19296
    goto :goto_b9

    .line 19298
    :cond_90
    invoke-virtual {v9}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v10

    invoke-virtual {v10}, Landroid/content/pm/VersionedPackage;->getLongVersionCode()J

    move-result-wide v10

    .line 19299
    .local v10, "libVersionCode":J
    const-wide/16 v12, -0x1

    cmp-long v12, p2, v12

    if-eqz v12, :cond_a7

    .line 19300
    cmp-long v12, v10, p2

    if-nez v12, :cond_b9

    .line 19301
    invoke-virtual {v9}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v12

    return-object v12

    .line 19303
    :cond_a7
    if-nez v6, :cond_ab

    .line 19304
    move-object v6, v9

    goto :goto_b9

    .line 19305
    :cond_ab
    nop

    .line 19306
    invoke-virtual {v6}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v12

    invoke-virtual {v12}, Landroid/content/pm/VersionedPackage;->getLongVersionCode()J

    move-result-wide v12

    cmp-long v12, v10, v12

    if-lez v12, :cond_b9

    .line 19307
    move-object v6, v9

    .line 19292
    .end local v9  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v10  # "libVersionCode":J
    :cond_b9
    :goto_b9
    add-int/lit8 v8, v8, 0x1

    goto :goto_7b

    .line 19311
    .end local v8  # "i":I
    :cond_bc
    if-eqz v6, :cond_c3

    .line 19312
    invoke-virtual {v6}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v8

    return-object v8

    .line 19315
    :cond_c3
    return-object v2

    .line 19261
    .end local v4  # "versionsCallerCanSee":Landroid/util/LongSparseLongArray;
    .end local v5  # "callingAppId":I
    .end local v6  # "highestVersion":Landroid/content/pm/SharedLibraryInfo;
    .end local v7  # "versionCount":I
    :cond_c4
    :goto_c4
    return-object v2
.end method

.method private resolveServiceInternal(Landroid/content/Intent;Ljava/lang/String;III)Landroid/content/pm/ResolveInfo;
    .registers 15
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .param p5, "callingUid"  # I

    .line 8603
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p4}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v8, 0x0

    if-nez v0, :cond_a

    return-object v8

    .line 8604
    :cond_a
    const/4 v6, 0x0

    move-object v1, p0

    move v2, p3

    move v3, p4

    move-object v4, p1

    move v5, p5

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZ)I

    move-result v0

    .line 8606
    .end local p3  # "flags":I
    .local v0, "flags":I
    const/4 v7, 0x0

    move-object v2, p1

    move-object v3, p2

    move v4, v0

    move v5, p4

    move v6, p5

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->queryIntentServicesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZ)Ljava/util/List;

    move-result-object v1

    .line 8608
    .local v1, "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-eqz v1, :cond_2f

    .line 8609
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v2

    const/4 v3, 0x1

    if-lt v2, v3, :cond_2f

    .line 8612
    const/4 v2, 0x0

    invoke-interface {v1, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ResolveInfo;

    return-object v2

    .line 8615
    :cond_2f
    return-object v8
.end method

.method private resolveUserIds(I)[I
    .registers 4
    .param p1, "userId"  # I

    .line 10779
    const/4 v0, -0x1

    if-ne p1, v0, :cond_a

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0

    goto :goto_10

    :cond_a
    const/4 v0, 0x1

    new-array v0, v0, [I

    const/4 v1, 0x0

    aput p1, v0, v1

    :goto_10
    return-object v0
.end method

.method private restoreAndPostInstall(ILcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Lcom/android/server/pm/PackageManagerService$PostInstallData;)V
    .registers 30
    .param p1, "userId"  # I
    .param p2, "res"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .param p3, "data"  # Lcom/android/server/pm/PackageManagerService$PostInstallData;

    .line 15248
    move-object/from16 v1, p0

    move/from16 v0, p1

    move-object/from16 v2, p2

    move-object/from16 v3, p3

    sget-boolean v4, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v4, :cond_35

    .line 15253
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v5, "restoreAndPostInstall userId="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v5, " package="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 15254
    iget-object v5, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    if-nez v5, :cond_27

    const-string/jumbo v5, "null"

    goto :goto_29

    :cond_27
    iget-object v5, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    :goto_29
    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    .line 15253
    const-string v5, "PackageManager"

    invoke-static {v5, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 15261
    :cond_35
    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    const/4 v6, 0x1

    if-eqz v4, :cond_42

    iget-object v4, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    if-eqz v4, :cond_42

    move v4, v6

    goto :goto_43

    :cond_42
    const/4 v4, 0x0

    .line 15263
    .local v4, "update":Z
    :goto_43
    iget-object v7, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    if-nez v7, :cond_49

    const/4 v7, 0x0

    goto :goto_4f

    :cond_49
    iget-object v7, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v7, v7, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->flags:I

    .line 15264
    .local v7, "flags":I
    :goto_4f
    if-nez v4, :cond_59

    const v8, 0x8000

    and-int/2addr v8, v7

    if-eqz v8, :cond_59

    move v8, v6

    goto :goto_5a

    :cond_59
    const/4 v8, 0x0

    .line 15271
    .local v8, "doRestore":Z
    :goto_5a
    iget v9, v1, Lcom/android/server/pm/PackageManagerService;->mNextInstallToken:I

    if-gez v9, :cond_60

    iput v6, v1, Lcom/android/server/pm/PackageManagerService;->mNextInstallToken:I

    .line 15272
    :cond_60
    iget v9, v1, Lcom/android/server/pm/PackageManagerService;->mNextInstallToken:I

    add-int/lit8 v10, v9, 0x1

    iput v10, v1, Lcom/android/server/pm/PackageManagerService;->mNextInstallToken:I

    .line 15273
    .local v9, "token":I
    if-eqz v3, :cond_6e

    .line 15274
    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mRunningInstalls:Landroid/util/SparseArray;

    invoke-virtual {v10, v9, v3}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    goto :goto_88

    .line 15275
    :cond_6e
    sget-boolean v10, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v10, :cond_88

    .line 15276
    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "No post-install required for "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    const-string v11, "PackageManager"

    invoke-static {v11, v10}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 15279
    :cond_88
    :goto_88
    sget-boolean v10, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v10, :cond_a2

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "+ starting restore round-trip "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    const-string v11, "PackageManager"

    invoke-static {v11, v10}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 15281
    :cond_a2
    iget v10, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    const-wide/32 v14, 0x40000

    if-ne v10, v6, :cond_112

    if-eqz v8, :cond_112

    .line 15286
    nop

    .line 15287
    const-string v10, "backup"

    invoke-static {v10}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v10

    .line 15286
    invoke-static {v10}, Landroid/app/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/app/backup/IBackupManager;

    move-result-object v10

    .line 15288
    .local v10, "bm":Landroid/app/backup/IBackupManager;
    if-eqz v10, :cond_108

    .line 15291
    const/4 v11, -0x1

    if-ne v0, v11, :cond_be

    .line 15292
    const/4 v0, 0x0

    move v11, v0

    .end local p1  # "userId":I
    .local v0, "userId":I
    goto :goto_bf

    .line 15291
    .end local v0  # "userId":I
    .restart local p1  # "userId":I
    :cond_be
    move v11, v0

    .line 15294
    .end local p1  # "userId":I
    .local v11, "userId":I
    :goto_bf
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_e2

    .line 15295
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v12, "token "

    invoke-virtual {v0, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v12, " to BM for possible restore for user "

    invoke-virtual {v0, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v12, "PackageManager"

    invoke-static {v12, v0}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 15297
    :cond_e2
    const-string/jumbo v0, "restore"

    invoke-static {v14, v15, v0, v9}, Landroid/os/Trace;->asyncTraceBegin(JLjava/lang/String;I)V

    .line 15299
    :try_start_e8
    invoke-interface {v10, v11}, Landroid/app/backup/IBackupManager;->isBackupServiceActive(I)Z

    move-result v0

    if-eqz v0, :cond_f8

    .line 15300
    iget-object v0, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v10, v11, v0, v9}, Landroid/app/backup/IBackupManager;->restoreAtInstallForUser(ILjava/lang/String;I)V
    :try_end_f7
    .catch Landroid/os/RemoteException; {:try_start_e8 .. :try_end_f7} :catch_105
    .catch Ljava/lang/Exception; {:try_start_e8 .. :try_end_f7} :catch_fb

    goto :goto_106

    .line 15303
    :cond_f8
    const/4 v0, 0x0

    move v8, v0

    .end local v8  # "doRestore":Z
    .local v0, "doRestore":Z
    goto :goto_106

    .line 15307
    .end local v0  # "doRestore":Z
    .restart local v8  # "doRestore":Z
    :catch_fb
    move-exception v0

    .line 15308
    .local v0, "e":Ljava/lang/Exception;
    const-string v12, "PackageManager"

    const-string v13, "Exception trying to enqueue restore"

    invoke-static {v12, v13, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 15309
    const/4 v8, 0x0

    .end local v0  # "e":Ljava/lang/Exception;
    goto :goto_106

    .line 15305
    :catch_105
    move-exception v0

    .line 15310
    :goto_106
    move v10, v11

    goto :goto_113

    .line 15312
    .end local v11  # "userId":I
    .restart local p1  # "userId":I
    :cond_108
    const-string v11, "PackageManager"

    const-string v12, "Backup Manager not found!"

    invoke-static {v11, v12}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 15313
    const/4 v8, 0x0

    move v10, v0

    goto :goto_113

    .line 15322
    .end local v10  # "bm":Landroid/app/backup/IBackupManager;
    :cond_112
    move v10, v0

    .end local p1  # "userId":I
    .local v10, "userId":I
    :goto_113
    iget v0, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    if-ne v0, v6, :cond_1ab

    if-nez v8, :cond_1ab

    if-eqz v4, :cond_1ab

    .line 15323
    nop

    .line 15324
    const-string/jumbo v0, "rollback"

    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v0

    .line 15323
    invoke-static {v0}, Landroid/content/rollback/IRollbackManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/content/rollback/IRollbackManager;

    move-result-object v19

    .line 15326
    .local v19, "rm":Landroid/content/rollback/IRollbackManager;
    iget-object v0, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v12, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 15327
    .local v12, "packageName":Ljava/lang/String;
    iget-object v0, v2, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v11, v0, Landroid/content/pm/ApplicationInfo;->seInfo:Ljava/lang/String;

    .line 15328
    .local v11, "seInfo":Ljava/lang/String;
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v13

    .line 15332
    .local v13, "allUsers":[I
    const/16 v16, -0x1

    .line 15333
    .local v16, "appId":I
    const-wide/16 v17, -0x1

    .line 15334
    .local v17, "ceDataInode":J
    iget-object v14, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    monitor-enter v14

    .line 15335
    :try_start_140
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v12}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v0
    :try_end_146
    .catchall {:try_start_140 .. :try_end_146} :catchall_1a0

    move-object v15, v0

    .line 15336
    .local v15, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v15, :cond_160

    .line 15337
    :try_start_149
    iget v0, v15, Lcom/android/server/pm/PackageSetting;->appId:I

    move/from16 v16, v0

    .line 15338
    invoke-virtual {v15, v10}, Lcom/android/server/pm/PackageSetting;->getCeDataInode(I)J

    move-result-wide v21
    :try_end_151
    .catchall {:try_start_149 .. :try_end_151} :catchall_158

    move-wide/from16 v17, v21

    move/from16 v21, v16

    move-wide/from16 v22, v17

    goto :goto_164

    .line 15344
    .end local v15  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_158
    move-exception v0

    move-object/from16 v24, v11

    move-object/from16 v25, v12

    move-object/from16 p1, v13

    goto :goto_1a7

    .line 15336
    .restart local v15  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_160
    move/from16 v21, v16

    move-wide/from16 v22, v17

    .line 15343
    .end local v16  # "appId":I
    .end local v17  # "ceDataInode":J
    .local v21, "appId":I
    .local v22, "ceDataInode":J
    :goto_164
    :try_start_164
    invoke-virtual {v15, v13, v6}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v0
    :try_end_168
    .catchall {:try_start_164 .. :try_end_168} :catchall_194

    move-object v6, v13

    .end local v13  # "allUsers":[I
    .local v6, "allUsers":[I
    move-object v13, v0

    .line 15344
    .local v13, "installedUsers":[I
    :try_start_16a
    monitor-exit v14
    :try_end_16b
    .catchall {:try_start_16a .. :try_end_16b} :catchall_188

    .line 15346
    nop

    .line 15348
    move-object/from16 v24, v11

    .end local v11  # "seInfo":Ljava/lang/String;
    .local v24, "seInfo":Ljava/lang/String;
    move-object/from16 v11, v19

    move-object/from16 v25, v12

    .end local v12  # "packageName":Ljava/lang/String;
    .local v25, "packageName":Ljava/lang/String;
    move-object/from16 p1, v6

    const-wide/32 v5, 0x40000

    .end local v6  # "allUsers":[I
    .local p1, "allUsers":[I
    move/from16 v14, v21

    move-object/from16 v20, v15

    .end local v15  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v20, "ps":Lcom/android/server/pm/PackageSetting;
    move-wide/from16 v15, v22

    move-object/from16 v17, v24

    move/from16 v18, v9

    :try_start_181
    invoke-interface/range {v11 .. v18}, Landroid/content/rollback/IRollbackManager;->snapshotAndRestoreUserData(Ljava/lang/String;[IIJLjava/lang/String;I)V
    :try_end_184
    .catch Landroid/os/RemoteException; {:try_start_181 .. :try_end_184} :catch_185

    .line 15352
    goto :goto_186

    .line 15350
    :catch_185
    move-exception v0

    .line 15353
    :goto_186
    const/4 v8, 0x1

    goto :goto_1ac

    .line 15344
    .end local v13  # "installedUsers":[I
    .end local v20  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v24  # "seInfo":Ljava/lang/String;
    .end local v25  # "packageName":Ljava/lang/String;
    .end local p1  # "allUsers":[I
    .restart local v6  # "allUsers":[I
    .restart local v11  # "seInfo":Ljava/lang/String;
    .restart local v12  # "packageName":Ljava/lang/String;
    :catchall_188
    move-exception v0

    move-object/from16 p1, v6

    move-object/from16 v24, v11

    move-object/from16 v25, v12

    move/from16 v16, v21

    move-wide/from16 v17, v22

    .end local v6  # "allUsers":[I
    .end local v11  # "seInfo":Ljava/lang/String;
    .end local v12  # "packageName":Ljava/lang/String;
    .restart local v24  # "seInfo":Ljava/lang/String;
    .restart local v25  # "packageName":Ljava/lang/String;
    .restart local p1  # "allUsers":[I
    goto :goto_1a7

    .end local v24  # "seInfo":Ljava/lang/String;
    .end local v25  # "packageName":Ljava/lang/String;
    .end local p1  # "allUsers":[I
    .restart local v11  # "seInfo":Ljava/lang/String;
    .restart local v12  # "packageName":Ljava/lang/String;
    .local v13, "allUsers":[I
    :catchall_194
    move-exception v0

    move-object/from16 v24, v11

    move-object/from16 v25, v12

    move-object/from16 p1, v13

    move/from16 v16, v21

    move-wide/from16 v17, v22

    .end local v11  # "seInfo":Ljava/lang/String;
    .end local v12  # "packageName":Ljava/lang/String;
    .end local v13  # "allUsers":[I
    .restart local v24  # "seInfo":Ljava/lang/String;
    .restart local v25  # "packageName":Ljava/lang/String;
    .restart local p1  # "allUsers":[I
    goto :goto_1a7

    .end local v21  # "appId":I
    .end local v22  # "ceDataInode":J
    .end local v24  # "seInfo":Ljava/lang/String;
    .end local v25  # "packageName":Ljava/lang/String;
    .end local p1  # "allUsers":[I
    .restart local v11  # "seInfo":Ljava/lang/String;
    .restart local v12  # "packageName":Ljava/lang/String;
    .restart local v13  # "allUsers":[I
    .restart local v16  # "appId":I
    .restart local v17  # "ceDataInode":J
    :catchall_1a0
    move-exception v0

    move-object/from16 v24, v11

    move-object/from16 v25, v12

    move-object/from16 p1, v13

    .end local v11  # "seInfo":Ljava/lang/String;
    .end local v12  # "packageName":Ljava/lang/String;
    .end local v13  # "allUsers":[I
    .restart local v24  # "seInfo":Ljava/lang/String;
    .restart local v25  # "packageName":Ljava/lang/String;
    .restart local p1  # "allUsers":[I
    :goto_1a7
    :try_start_1a7
    monitor-exit v14
    :try_end_1a8
    .catchall {:try_start_1a7 .. :try_end_1a8} :catchall_1a9

    throw v0

    :catchall_1a9
    move-exception v0

    goto :goto_1a7

    .line 15322
    .end local v16  # "appId":I
    .end local v17  # "ceDataInode":J
    .end local v19  # "rm":Landroid/content/rollback/IRollbackManager;
    .end local v24  # "seInfo":Ljava/lang/String;
    .end local v25  # "packageName":Ljava/lang/String;
    .end local p1  # "allUsers":[I
    :cond_1ab
    move-wide v5, v14

    .line 15357
    :goto_1ac
    if-nez v8, :cond_1dc

    .line 15360
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_1c8

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "No restore - queue post-install for "

    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v11, "PackageManager"

    invoke-static {v11, v0}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 15362
    :cond_1c8
    const-string/jumbo v0, "postInstall"

    invoke-static {v5, v6, v0, v9}, Landroid/os/Trace;->asyncTraceBegin(JLjava/lang/String;I)V

    .line 15364
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v5, 0x9

    const/4 v6, 0x0

    invoke-virtual {v0, v5, v9, v6}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(III)Landroid/os/Message;

    move-result-object v0

    .line 15365
    .local v0, "msg":Landroid/os/Message;
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v5, v0}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 15367
    .end local v0  # "msg":Landroid/os/Message;
    :cond_1dc
    return-void
.end method

.method private restoreFromXml(Lorg/xmlpull/v1/XmlPullParser;ILjava/lang/String;Lcom/android/server/pm/PackageManagerService$BlobXmlRestorer;)V
    .registers 9
    .param p1, "parser"  # Lorg/xmlpull/v1/XmlPullParser;
    .param p2, "userId"  # I
    .param p3, "expectedStartTag"  # Ljava/lang/String;
    .param p4, "functor"  # Lcom/android/server/pm/PackageManagerService$BlobXmlRestorer;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;,
            Lorg/xmlpull/v1/XmlPullParserException;
        }
    .end annotation

    .line 21532
    :goto_0
    invoke-interface {p1}, Lorg/xmlpull/v1/XmlPullParser;->next()I

    move-result v0

    move v1, v0

    .local v1, "type":I
    const/4 v2, 0x2

    if-eq v0, v2, :cond_c

    const/4 v0, 0x1

    if-eq v1, v0, :cond_c

    goto :goto_0

    .line 21535
    :cond_c
    const-string v0, "PackageManager"

    if-eq v1, v2, :cond_1a

    .line 21537
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v2, :cond_19

    .line 21538
    const-string v2, "Didn\'t find start tag during restore"

    invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 21540
    :cond_19
    return-void

    .line 21543
    :cond_1a
    invoke-interface {p1}, Lorg/xmlpull/v1/XmlPullParser;->getName()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {p3, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_41

    .line 21544
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v2, :cond_40

    .line 21545
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Found unexpected tag "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-interface {p1}, Lorg/xmlpull/v1/XmlPullParser;->getName()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 21547
    :cond_40
    return-void

    .line 21551
    :cond_41
    :goto_41
    invoke-interface {p1}, Lorg/xmlpull/v1/XmlPullParser;->next()I

    move-result v0

    move v1, v0

    const/4 v2, 0x4

    if-ne v0, v2, :cond_4a

    goto :goto_41

    .line 21552
    :cond_4a
    invoke-interface {p4, p1, p2}, Lcom/android/server/pm/PackageManagerService$BlobXmlRestorer;->apply(Lorg/xmlpull/v1/XmlPullParser;I)V

    .line 21553
    return-void
.end method

.method private scanDirLI(Ljava/io/File;IIJ)V
    .registers 24
    .param p1, "scanDir"  # Ljava/io/File;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .param p4, "currentTime"  # J

    .line 9465
    move-object/from16 v8, p0

    move-object/from16 v9, p1

    move/from16 v10, p3

    invoke-virtual/range {p1 .. p1}, Ljava/io/File;->listFiles()[Ljava/io/File;

    move-result-object v11

    .line 9466
    .local v11, "files":[Ljava/io/File;
    invoke-static {v11}, Lcom/android/internal/util/ArrayUtils;->isEmpty([Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_27

    .line 9467
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "No files in app dir "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 9468
    return-void

    .line 9472
    :cond_27
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Android:PMS_scan_data:"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual/range {p1 .. p1}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/String;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-direct {v8, v0}, Lcom/android/server/pm/PackageManagerService;->addBootEvent(Ljava/lang/String;)V

    .line 9475
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z

    if-eqz v0, :cond_71

    .line 9476
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Scanning app dir "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v1, " scanFlags="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, " flags=0x"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9477
    invoke-static/range {p2 .. p2}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 9476
    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 9479
    :cond_71
    new-instance v0, Lcom/android/server/pm/ParallelPackageParser;

    iget-object v3, v8, Lcom/android/server/pm/PackageManagerService;->mSeparateProcesses:[Ljava/lang/String;

    iget-boolean v4, v8, Lcom/android/server/pm/PackageManagerService;->mOnlyCore:Z

    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService;->mMetrics:Landroid/util/DisplayMetrics;

    iget-object v6, v8, Lcom/android/server/pm/PackageManagerService;->mCacheDir:Ljava/io/File;

    iget-object v7, v8, Lcom/android/server/pm/PackageManagerService;->mParallelPackageParserCallback:Lcom/android/server/pm/PackageManagerService$ParallelPackageParserCallback;

    move-object v2, v0

    invoke-direct/range {v2 .. v7}, Lcom/android/server/pm/ParallelPackageParser;-><init>([Ljava/lang/String;ZLandroid/util/DisplayMetrics;Ljava/io/File;Landroid/content/pm/PackageParser$Callback;)V

    move-object v12, v0

    .line 9483
    .local v12, "parallelPackageParser":Lcom/android/server/pm/ParallelPackageParser;
    const/4 v0, 0x0

    .line 9484
    .local v0, "fileCount":I
    :try_start_83
    array-length v1, v11

    const/4 v2, 0x0

    move v3, v0

    move v0, v2

    .end local v0  # "fileCount":I
    .local v3, "fileCount":I
    :goto_87
    if-ge v0, v1, :cond_b4

    aget-object v4, v11, v0

    .line 9485
    .local v4, "file":Ljava/io/File;
    invoke-static {v4}, Landroid/content/pm/PackageParser;->isApkFile(Ljava/io/File;)Z

    move-result v5

    if-nez v5, :cond_97

    invoke-virtual {v4}, Ljava/io/File;->isDirectory()Z

    move-result v5

    if-eqz v5, :cond_a3

    .line 9486
    :cond_97
    invoke-virtual {v4}, Ljava/io/File;->getName()Ljava/lang/String;

    move-result-object v5

    invoke-static {v5}, Lcom/android/server/pm/PackageInstallerService;->isStageName(Ljava/lang/String;)Z

    move-result v5
    :try_end_9f
    .catchall {:try_start_83 .. :try_end_9f} :catchall_1fa

    if-nez v5, :cond_a3

    const/4 v14, 0x1

    goto :goto_a4

    :cond_a3
    move v14, v2

    :goto_a4
    move v5, v14

    .line 9487
    .local v5, "isPackage":Z
    if-nez v5, :cond_aa

    .line 9489
    move/from16 v15, p2

    goto :goto_b1

    .line 9491
    :cond_aa
    move/from16 v15, p2

    :try_start_ac
    invoke-virtual {v12, v4, v15}, Lcom/android/server/pm/ParallelPackageParser;->submit(Ljava/io/File;I)V

    .line 9492
    add-int/lit8 v3, v3, 0x1

    .line 9484
    .end local v4  # "file":Ljava/io/File;
    .end local v5  # "isPackage":Z
    :goto_b1
    add-int/lit8 v0, v0, 0x1

    goto :goto_87

    :cond_b4
    move/from16 v15, p2

    move/from16 v16, v3

    .line 9496
    .end local v3  # "fileCount":I
    .local v16, "fileCount":I
    :goto_b8
    if-lez v16, :cond_1f5

    .line 9497
    invoke-virtual {v12}, Lcom/android/server/pm/ParallelPackageParser;->take()Lcom/android/server/pm/ParallelPackageParser$ParseResult;

    move-result-object v0

    move-object v7, v0

    .line 9498
    .local v7, "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    iget-object v0, v7, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->throwable:Ljava/lang/Throwable;

    move-object v5, v0

    .line 9499
    .local v5, "throwable":Ljava/lang/Throwable;
    const/16 v17, 0x1

    .line 9501
    .local v17, "errorCode":I
    if-nez v5, :cond_17d

    .line 9503
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1
    :try_end_c9
    .catchall {:try_start_ac .. :try_end_c9} :catchall_1f3

    .line 9504
    const/high16 v0, 0x1000000

    and-int/2addr v0, v10

    if-eqz v0, :cond_121

    .line 9505
    :try_start_ce
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v7, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    iget-object v3, v7, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v3, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-virtual {v0, v2, v3}, Lcom/android/server/pm/Settings;->updateMzAppInfo(Ljava/lang/String;Ljava/lang/String;)V

    .line 9507
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v7, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v2}, Lcom/android/server/pm/Settings;->isMzApp(Ljava/lang/String;)Z

    move-result v0

    .line 9508
    .local v0, "isMzApp":Z
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v7, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v3, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 9509
    invoke-virtual {v2, v3}, Lcom/android/server/pm/Settings;->isMzAppInstalled(Ljava/lang/String;)Z

    move-result v2

    .line 9510
    .local v2, "isMzInstalled":Z
    if-eqz v0, :cond_121

    if-nez v2, :cond_121

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->inCts()Z

    move-result v3

    if-nez v3, :cond_121

    .line 9511
    const-string v3, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v6, "scanDirLI  pkg  = "

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v7, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v6, v6, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " not insalled"

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 9513
    monitor-exit v1
    :try_end_11a
    .catchall {:try_start_ce .. :try_end_11a} :catchall_11d

    const/4 v1, 0x1

    goto/16 :goto_1d6

    .line 9516
    .end local v0  # "isMzApp":Z
    .end local v2  # "isMzInstalled":Z
    :catchall_11d
    move-exception v0

    move-object v13, v5

    move-object v14, v7

    goto :goto_179

    :cond_121
    :try_start_121
    monitor-exit v1
    :try_end_122
    .catchall {:try_start_121 .. :try_end_122} :catchall_176

    .line 9520
    :try_start_122
    iget-object v0, v7, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v0}, Landroid/content/pm/ApplicationInfo;->isStaticSharedLibrary()Z

    move-result v0

    if-eqz v0, :cond_131

    .line 9521
    iget-object v0, v7, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->renameStaticSharedLibraryPackage(Landroid/content/pm/PackageParser$Package;)V
    :try_end_131
    .catchall {:try_start_122 .. :try_end_131} :catchall_1f3

    .line 9524
    :cond_131
    :try_start_131
    iget-object v2, v7, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->pkg:Landroid/content/pm/PackageParser$Package;
    :try_end_133
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_131 .. :try_end_133} :catch_148
    .catchall {:try_start_131 .. :try_end_133} :catchall_1f3

    const/4 v0, 0x0

    move-object/from16 v1, p0

    move/from16 v3, p2

    move/from16 v4, p3

    move-object v13, v5

    .end local v5  # "throwable":Ljava/lang/Throwable;
    .local v13, "throwable":Ljava/lang/Throwable;
    move-wide/from16 v5, p4

    move-object v14, v7

    .end local v7  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    .local v14, "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    move-object v7, v0

    :try_start_13f
    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->scanPackageChildLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;
    :try_end_142
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_13f .. :try_end_142} :catch_146
    .catchall {:try_start_13f .. :try_end_142} :catchall_1f3

    .line 9529
    move/from16 v0, v17

    goto/16 :goto_1b0

    .line 9526
    :catch_146
    move-exception v0

    goto :goto_14b

    .end local v13  # "throwable":Ljava/lang/Throwable;
    .end local v14  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    .restart local v5  # "throwable":Ljava/lang/Throwable;
    .restart local v7  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    :catch_148
    move-exception v0

    move-object v13, v5

    move-object v14, v7

    .line 9527
    .end local v5  # "throwable":Ljava/lang/Throwable;
    .end local v7  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    .restart local v13  # "throwable":Ljava/lang/Throwable;
    .restart local v14  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    :goto_14b
    :try_start_14b
    iget v1, v0, Lcom/android/server/pm/PackageManagerException;->error:I

    move/from16 v17, v1

    .line 9528
    const-string v1, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Failed to scan "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v14, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->scanFile:Ljava/io/File;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v3, ": "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_173
    .catchall {:try_start_14b .. :try_end_173} :catchall_1f3

    .line 9529
    move/from16 v0, v17

    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    goto :goto_1b0

    .line 9516
    .end local v13  # "throwable":Ljava/lang/Throwable;
    .end local v14  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    .restart local v5  # "throwable":Ljava/lang/Throwable;
    .restart local v7  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    :catchall_176
    move-exception v0

    move-object v13, v5

    move-object v14, v7

    .end local v5  # "throwable":Ljava/lang/Throwable;
    .end local v7  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    .restart local v13  # "throwable":Ljava/lang/Throwable;
    .restart local v14  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    :goto_179
    :try_start_179
    monitor-exit v1
    :try_end_17a
    .catchall {:try_start_179 .. :try_end_17a} :catchall_17b

    .end local v11  # "files":[Ljava/io/File;
    .end local v12  # "parallelPackageParser":Lcom/android/server/pm/ParallelPackageParser;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "scanDir":Ljava/io/File;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    .end local p4  # "currentTime":J
    :try_start_17a
    throw v0

    .restart local v11  # "files":[Ljava/io/File;
    .restart local v12  # "parallelPackageParser":Lcom/android/server/pm/ParallelPackageParser;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "scanDir":Ljava/io/File;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    .restart local p4  # "currentTime":J
    :catchall_17b
    move-exception v0

    goto :goto_179

    .line 9530
    .end local v13  # "throwable":Ljava/lang/Throwable;
    .end local v14  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    .restart local v5  # "throwable":Ljava/lang/Throwable;
    .restart local v7  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    :cond_17d
    move-object v13, v5

    move-object v14, v7

    .end local v5  # "throwable":Ljava/lang/Throwable;
    .end local v7  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    .restart local v13  # "throwable":Ljava/lang/Throwable;
    .restart local v14  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    instance-of v0, v13, Landroid/content/pm/PackageParser$PackageParserException;

    if-eqz v0, :cond_1da

    .line 9531
    move-object v0, v13

    check-cast v0, Landroid/content/pm/PackageParser$PackageParserException;

    .line 9533
    .local v0, "e":Landroid/content/pm/PackageParser$PackageParserException;
    iget v1, v0, Landroid/content/pm/PackageParser$PackageParserException;->error:I

    move/from16 v17, v1

    .line 9534
    const-string v1, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Failed to parse "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v14, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->scanFile:Ljava/io/File;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v3, ": "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Landroid/content/pm/PackageParser$PackageParserException;->getMessage()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9535
    move/from16 v0, v17

    .line 9541
    .end local v17  # "errorCode":I
    .local v0, "errorCode":I
    :goto_1b0
    const/high16 v1, 0x20000

    and-int/2addr v1, v10

    if-nez v1, :cond_1d5

    const/4 v1, 0x1

    if-eq v0, v1, :cond_1d6

    .line 9543
    const/4 v2, 0x5

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Deleting invalid package at "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v14, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->scanFile:Ljava/io/File;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Lcom/android/server/pm/PackageManagerServiceUtils;->logCriticalInfo(ILjava/lang/String;)V

    .line 9545
    iget-object v2, v14, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->scanFile:Ljava/io/File;

    invoke-virtual {v8, v2}, Lcom/android/server/pm/PackageManagerService;->removeCodePathLI(Ljava/io/File;)V

    goto :goto_1d6

    .line 9541
    :cond_1d5
    const/4 v1, 0x1

    .line 9496
    .end local v0  # "errorCode":I
    .end local v13  # "throwable":Ljava/lang/Throwable;
    .end local v14  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    :cond_1d6
    :goto_1d6
    add-int/lit8 v16, v16, -0x1

    goto/16 :goto_b8

    .line 9536
    .restart local v13  # "throwable":Ljava/lang/Throwable;
    .restart local v14  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    .restart local v17  # "errorCode":I
    :cond_1da
    new-instance v0, Ljava/lang/IllegalStateException;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unexpected exception occurred while parsing "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v14, Lcom/android/server/pm/ParallelPackageParser$ParseResult;->scanFile:Ljava/io/File;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1, v13}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V

    .end local v11  # "files":[Ljava/io/File;
    .end local v12  # "parallelPackageParser":Lcom/android/server/pm/ParallelPackageParser;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "scanDir":Ljava/io/File;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    .end local p4  # "currentTime":J
    throw v0
    :try_end_1f3
    .catchall {:try_start_17a .. :try_end_1f3} :catchall_1f3

    .line 9479
    .end local v13  # "throwable":Ljava/lang/Throwable;
    .end local v14  # "parseResult":Lcom/android/server/pm/ParallelPackageParser$ParseResult;
    .end local v16  # "fileCount":I
    .end local v17  # "errorCode":I
    .restart local v11  # "files":[Ljava/io/File;
    .restart local v12  # "parallelPackageParser":Lcom/android/server/pm/ParallelPackageParser;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "scanDir":Ljava/io/File;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    .restart local p4  # "currentTime":J
    :catchall_1f3
    move-exception v0

    goto :goto_1fd

    .line 9548
    :cond_1f5
    const/4 v1, 0x0

    invoke-static {v1, v12}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    .line 9549
    .end local v12  # "parallelPackageParser":Lcom/android/server/pm/ParallelPackageParser;
    return-void

    .line 9479
    .restart local v12  # "parallelPackageParser":Lcom/android/server/pm/ParallelPackageParser;
    :catchall_1fa
    move-exception v0

    move/from16 v15, p2

    :goto_1fd
    move-object v1, v0

    .end local v11  # "files":[Ljava/io/File;
    .end local v12  # "parallelPackageParser":Lcom/android/server/pm/ParallelPackageParser;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "scanDir":Ljava/io/File;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    .end local p4  # "currentTime":J
    :try_start_1fe
    throw v1
    :try_end_1ff
    .catchall {:try_start_1fe .. :try_end_1ff} :catchall_1ff

    .line 9548
    .restart local v11  # "files":[Ljava/io/File;
    .restart local v12  # "parallelPackageParser":Lcom/android/server/pm/ParallelPackageParser;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "scanDir":Ljava/io/File;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    .restart local p4  # "currentTime":J
    :catchall_1ff
    move-exception v0

    move-object v2, v0

    invoke-static {v1, v12}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    throw v2
.end method

.method private scanDirTracedLI(Ljava/io/File;IIJ)V
    .registers 9
    .param p1, "scanDir"  # Ljava/io/File;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .param p4, "currentTime"  # J

    .line 9456
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v1, "scanDir ["

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "]"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-wide/32 v1, 0x40000

    invoke-static {v1, v2, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 9458
    :try_start_21
    invoke-direct/range {p0 .. p5}, Lcom/android/server/pm/PackageManagerService;->scanDirLI(Ljava/io/File;IIJ)V
    :try_end_24
    .catchall {:try_start_21 .. :try_end_24} :catchall_29

    .line 9460
    invoke-static {v1, v2}, Landroid/os/Trace;->traceEnd(J)V

    .line 9461
    nop

    .line 9462
    return-void

    .line 9460
    :catchall_29
    move-exception v0

    invoke-static {v1, v2}, Landroid/os/Trace;->traceEnd(J)V

    throw v0
.end method

.method private scanPackageChildLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;
    .registers 24
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .param p4, "currentTime"  # J
    .param p6, "user"  # Landroid/os/UserHandle;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock",
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 9679
    move-object/from16 v7, p1

    move/from16 v0, p3

    and-int/lit16 v1, v0, 0x400

    if-nez v1, :cond_1a

    .line 9680
    iget-object v1, v7, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v1, :cond_18

    iget-object v1, v7, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_18

    .line 9681
    or-int/lit16 v0, v0, 0x400

    move v15, v0

    .end local p3  # "scanFlags":I
    .local v0, "scanFlags":I
    goto :goto_1d

    .line 9688
    .end local v0  # "scanFlags":I
    .restart local p3  # "scanFlags":I
    :cond_18
    move v15, v0

    goto :goto_1d

    .line 9684
    :cond_1a
    and-int/lit16 v0, v0, -0x401

    move v15, v0

    .line 9688
    .end local p3  # "scanFlags":I
    .local v15, "scanFlags":I
    :goto_1d
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move v3, v15

    move-wide/from16 v4, p4

    move-object/from16 v6, p6

    invoke-direct/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->addForInitLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;

    move-result-object v16

    .line 9692
    .local v16, "scannedPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v0, v7, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_37

    iget-object v0, v7, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_38

    :cond_37
    const/4 v0, 0x0

    :goto_38
    move v6, v0

    .line 9693
    .local v6, "childCount":I
    const/4 v0, 0x0

    .local v0, "i":I
    :goto_3a
    if-ge v0, v6, :cond_54

    .line 9694
    iget-object v1, v7, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 9695
    .local v1, "childPackage":Landroid/content/pm/PackageParser$Package;
    move-object/from16 v8, p0

    move-object v9, v1

    move/from16 v10, p2

    move v11, v15

    move-wide/from16 v12, p4

    move-object/from16 v14, p6

    invoke-direct/range {v8 .. v14}, Lcom/android/server/pm/PackageManagerService;->addForInitLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;

    .line 9693
    .end local v1  # "childPackage":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v0, v0, 0x1

    goto :goto_3a

    .line 9700
    .end local v0  # "i":I
    :cond_54
    and-int/lit16 v0, v15, 0x400

    if-eqz v0, :cond_69

    .line 9701
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move v3, v15

    move-wide/from16 v4, p4

    move v8, v6

    .end local v6  # "childCount":I
    .local v8, "childCount":I
    move-object/from16 v6, p6

    invoke-direct/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->scanPackageChildLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;

    move-result-object v0

    return-object v0

    .line 9704
    .end local v8  # "childCount":I
    .restart local v6  # "childCount":I
    :cond_69
    return-object v16
.end method

.method private scanPackageLI(Ljava/io/File;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;
    .registers 19
    .param p1, "scanFile"  # Ljava/io/File;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .param p4, "currentTime"  # J
    .param p6, "user"  # Landroid/os/UserHandle;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock",
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 9640
    move-object v8, p0

    move-object v9, p1

    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_1c

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Parsing: "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 9641
    :cond_1c
    new-instance v0, Landroid/content/pm/PackageParser;

    invoke-direct {v0}, Landroid/content/pm/PackageParser;-><init>()V

    move-object v10, v0

    .line 9642
    .local v10, "pp":Landroid/content/pm/PackageParser;
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSeparateProcesses:[Ljava/lang/String;

    invoke-virtual {v10, v0}, Landroid/content/pm/PackageParser;->setSeparateProcesses([Ljava/lang/String;)V

    .line 9643
    iget-boolean v0, v8, Lcom/android/server/pm/PackageManagerService;->mOnlyCore:Z

    invoke-virtual {v10, v0}, Landroid/content/pm/PackageParser;->setOnlyCoreApps(Z)V

    .line 9644
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mMetrics:Landroid/util/DisplayMetrics;

    invoke-virtual {v10, v0}, Landroid/content/pm/PackageParser;->setDisplayMetrics(Landroid/util/DisplayMetrics;)V

    .line 9645
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mPackageParserCallback:Landroid/content/pm/PackageParser$Callback;

    invoke-virtual {v10, v0}, Landroid/content/pm/PackageParser;->setCallback(Landroid/content/pm/PackageParser$Callback;)V

    .line 9647
    const-wide/32 v1, 0x40000

    const-string/jumbo v0, "parsePackage"

    invoke-static {v1, v2, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 9650
    move v11, p2

    :try_start_40
    invoke-virtual {v10, p1, p2}, Landroid/content/pm/PackageParser;->parsePackage(Ljava/io/File;I)Landroid/content/pm/PackageParser$Package;

    move-result-object v0
    :try_end_44
    .catch Landroid/content/pm/PackageParser$PackageParserException; {:try_start_40 .. :try_end_44} :catch_62
    .catchall {:try_start_40 .. :try_end_44} :catchall_60

    .line 9654
    .local v0, "pkg":Landroid/content/pm/PackageParser$Package;
    invoke-static {v1, v2}, Landroid/os/Trace;->traceEnd(J)V

    .line 9655
    nop

    .line 9658
    iget-object v1, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v1}, Landroid/content/pm/ApplicationInfo;->isStaticSharedLibrary()Z

    move-result v1

    if-eqz v1, :cond_53

    .line 9659
    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->renameStaticSharedLibraryPackage(Landroid/content/pm/PackageParser$Package;)V

    .line 9662
    :cond_53
    move-object v1, p0

    move-object v2, v0

    move v3, p2

    move v4, p3

    move-wide/from16 v5, p4

    move-object/from16 v7, p6

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->scanPackageChildLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;

    move-result-object v1

    return-object v1

    .line 9654
    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_60
    move-exception v0

    goto :goto_6a

    .line 9651
    :catch_62
    move-exception v0

    move-object v3, v0

    move-object v0, v3

    .line 9652
    .local v0, "e":Landroid/content/pm/PackageParser$PackageParserException;
    :try_start_65
    invoke-static {v0}, Lcom/android/server/pm/PackageManagerException;->from(Landroid/content/pm/PackageParser$PackageParserException;)Lcom/android/server/pm/PackageManagerException;

    move-result-object v3

    .end local v10  # "pp":Landroid/content/pm/PackageParser;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "scanFile":Ljava/io/File;
    .end local p2  # "parseFlags":I
    .end local p3  # "scanFlags":I
    .end local p4  # "currentTime":J
    .end local p6  # "user":Landroid/os/UserHandle;
    throw v3
    :try_end_6a
    .catchall {:try_start_65 .. :try_end_6a} :catchall_60

    .line 9654
    .end local v0  # "e":Landroid/content/pm/PackageParser$PackageParserException;
    .restart local v10  # "pp":Landroid/content/pm/PackageParser;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "scanFile":Ljava/io/File;
    .restart local p2  # "parseFlags":I
    .restart local p3  # "scanFlags":I
    .restart local p4  # "currentTime":J
    .restart local p6  # "user":Landroid/os/UserHandle;
    :goto_6a
    invoke-static {v1, v2}, Landroid/os/Trace;->traceEnd(J)V

    throw v0
.end method

.method private scanPackageNewLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Lcom/android/server/pm/PackageManagerService$ScanResult;
    .registers 30
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .param p4, "currentTime"  # J
    .param p6, "user"  # Landroid/os/UserHandle;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock",
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 11419
    move-object/from16 v7, p0

    move-object/from16 v15, p1

    move/from16 v14, p2

    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v15, Landroid/content/pm/PackageParser$Package;->mRealPackage:Ljava/lang/String;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/Settings;->getRenamedPackageLPr(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v13

    .line 11420
    .local v13, "renamedPkgName":Ljava/lang/String;
    invoke-static {v15, v13}, Lcom/android/server/pm/PackageManagerService;->getRealPackageName(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v20

    .line 11421
    .local v20, "realPkgName":Ljava/lang/String;
    if-eqz v20, :cond_17

    .line 11422
    invoke-static {v15, v13}, Lcom/android/server/pm/PackageManagerService;->ensurePackageRenamed(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)V

    .line 11424
    :cond_17
    invoke-direct {v7, v15, v13}, Lcom/android/server/pm/PackageManagerService;->getOriginalPackageLocked(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v21

    .line 11425
    .local v21, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v15, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v12

    .line 11426
    .local v12, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v15, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 11427
    invoke-virtual {v0, v1}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v22

    .line 11429
    .local v22, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mTransferedPackages:Landroid/util/ArraySet;

    iget-object v1, v15, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Landroid/util/ArraySet;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_52

    .line 11430
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Package "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, v15, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " was transferred to another, but its .apk remains"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11434
    :cond_52
    move-object/from16 v1, p0

    move/from16 v2, p3

    move-object v3, v12

    move-object/from16 v4, v22

    move-object/from16 v5, p6

    move-object/from16 v6, p1

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->adjustScanFlags(ILcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Landroid/os/UserHandle;Landroid/content/pm/PackageParser$Package;)I

    move-result v1

    .line 11435
    .end local p3  # "scanFlags":I
    .local v1, "scanFlags":I
    iget-object v2, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 11436
    :try_start_64
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mPlatformPackage:Landroid/content/pm/PackageParser$Package;

    invoke-static {v15, v14, v1, v0}, Lcom/android/server/pm/PackageManagerService;->applyPolicy(Landroid/content/pm/PackageParser$Package;IILandroid/content/pm/PackageParser$Package;)V

    .line 11437
    invoke-direct {v7, v15, v14, v1}, Lcom/android/server/pm/PackageManagerService;->assertPackageIsValid(Landroid/content/pm/PackageParser$Package;II)V

    .line 11439
    const/4 v0, 0x0

    .line 11440
    .local v0, "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    iget-object v3, v15, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;
    :try_end_6f
    .catchall {:try_start_64 .. :try_end_6f} :catchall_ed

    const/4 v4, 0x1

    const/4 v5, 0x0

    if-eqz v3, :cond_b8

    .line 11442
    :try_start_73
    iget-object v3, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v15, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    invoke-virtual {v3, v6, v5, v5, v4}, Lcom/android/server/pm/Settings;->getSharedUserLPw(Ljava/lang/String;IIZ)Lcom/android/server/pm/SharedUserSetting;

    move-result-object v3

    move-object v0, v3

    .line 11444
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z

    if-eqz v3, :cond_b8

    .line 11445
    const/high16 v3, -0x80000000

    and-int/2addr v3, v14

    if-eqz v3, :cond_b8

    .line 11446
    const-string v3, "PackageManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Shared UserID "

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v8, v15, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, " (uid="

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v8, v0, Lcom/android/server/pm/SharedUserSetting;->userId:I

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v8, "): packages="

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v8, v0, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v3, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_b1
    .catchall {:try_start_73 .. :try_end_b1} :catchall_b2

    goto :goto_b8

    .line 11456
    .end local v0  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    :catchall_b2
    move-exception v0

    move-wide/from16 v8, p4

    move-object v4, v12

    move-object v5, v13

    goto :goto_f2

    .line 11451
    .restart local v0  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    :cond_b8
    :goto_b8
    :try_start_b8
    new-instance v3, Lcom/android/server/pm/PackageManagerService$ScanRequest;

    .line 11452
    if-nez v12, :cond_be

    const/4 v6, 0x0

    goto :goto_c0

    :cond_be
    iget-object v6, v12, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    :goto_c0
    move-object v11, v6

    iget-object v6, v7, Lcom/android/server/pm/PackageManagerService;->mPlatformPackage:Landroid/content/pm/PackageParser$Package;
    :try_end_c3
    .catchall {:try_start_b8 .. :try_end_c3} :catchall_ed

    if-ne v15, v6, :cond_c8

    move/from16 v18, v4

    goto :goto_ca

    :cond_c8
    move/from16 v18, v5

    :goto_ca
    move-object v8, v3

    move-object/from16 v9, p1

    move-object v10, v0

    move-object v4, v12

    .end local v12  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v4, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object v5, v13

    .end local v13  # "renamedPkgName":Ljava/lang/String;
    .local v5, "renamedPkgName":Ljava/lang/String;
    move-object/from16 v13, v22

    move-object/from16 v14, v21

    move-object/from16 v15, v20

    move/from16 v16, p2

    move/from16 v17, v1

    move-object/from16 v19, p6

    :try_start_dc
    invoke-direct/range {v8 .. v19}, Lcom/android/server/pm/PackageManagerService$ScanRequest;-><init>(Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/SharedUserSetting;Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Ljava/lang/String;IIZLandroid/os/UserHandle;)V

    .line 11455
    .local v3, "request":Lcom/android/server/pm/PackageManagerService$ScanRequest;
    iget-boolean v6, v7, Lcom/android/server/pm/PackageManagerService;->mFactoryTest:Z
    :try_end_e1
    .catchall {:try_start_dc .. :try_end_e1} :catchall_e9

    move-wide/from16 v8, p4

    :try_start_e3
    invoke-static {v3, v6, v8, v9}, Lcom/android/server/pm/PackageManagerService;->scanPackageOnlyLI(Lcom/android/server/pm/PackageManagerService$ScanRequest;ZJ)Lcom/android/server/pm/PackageManagerService$ScanResult;

    move-result-object v6

    monitor-exit v2

    return-object v6

    .line 11456
    .end local v0  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    .end local v3  # "request":Lcom/android/server/pm/PackageManagerService$ScanRequest;
    :catchall_e9
    move-exception v0

    move-wide/from16 v8, p4

    goto :goto_f2

    .end local v4  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "renamedPkgName":Ljava/lang/String;
    .restart local v12  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v13  # "renamedPkgName":Ljava/lang/String;
    :catchall_ed
    move-exception v0

    move-wide/from16 v8, p4

    move-object v4, v12

    move-object v5, v13

    .end local v12  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "renamedPkgName":Ljava/lang/String;
    .restart local v4  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "renamedPkgName":Ljava/lang/String;
    :goto_f2
    monitor-exit v2
    :try_end_f3
    .catchall {:try_start_e3 .. :try_end_f3} :catchall_f4

    throw v0

    :catchall_f4
    move-exception v0

    goto :goto_f2
.end method

.method private static scanPackageOnlyLI(Lcom/android/server/pm/PackageManagerService$ScanRequest;ZJ)Lcom/android/server/pm/PackageManagerService$ScanResult;
    .registers 49
    .param p0, "request"  # Lcom/android/server/pm/PackageManagerService$ScanRequest;
    .param p1, "isUnderFactoryTest"  # Z
    .param p2, "currentTime"  # J
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 11694
    move-object/from16 v8, p0

    move-wide/from16 v9, p2

    iget-object v11, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 11695
    .local v11, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->pkgSetting:Lcom/android/server/pm/PackageSetting;

    .line 11696
    .local v0, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v7, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->disabledPkgSetting:Lcom/android/server/pm/PackageSetting;

    .line 11697
    .local v7, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v6, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->originalPkgSetting:Lcom/android/server/pm/PackageSetting;

    .line 11698
    .local v6, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    iget v5, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->parseFlags:I

    .line 11699
    .local v5, "parseFlags":I
    iget v4, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->scanFlags:I

    .line 11700
    .local v4, "scanFlags":I
    iget-object v3, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->realPkgName:Ljava/lang/String;

    .line 11701
    .local v3, "realPkgName":Ljava/lang/String;
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->sharedUserSetting:Lcom/android/server/pm/SharedUserSetting;

    .line 11702
    .local v2, "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->user:Landroid/os/UserHandle;

    .line 11703
    .local v1, "user":Landroid/os/UserHandle;
    iget-boolean v15, v8, Lcom/android/server/pm/PackageManagerService$ScanRequest;->isPlatformPackage:Z

    .line 11705
    .local v15, "isPlatformPackage":Z
    const/16 v35, 0x0

    .line 11707
    .local v35, "changedAbiCodePath":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    sget-boolean v12, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z

    const-string v14, "PackageManager"

    if-eqz v12, :cond_3b

    .line 11708
    const/high16 v12, -0x80000000

    and-int/2addr v12, v5

    if-eqz v12, :cond_3b

    .line 11709
    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Scanning package "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    invoke-static {v14, v12}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 11713
    :cond_3b
    new-instance v12, Ljava/io/File;

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-direct {v12, v13}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    move-object/from16 v36, v12

    .line 11714
    .local v36, "scanFile":Ljava/io/File;
    new-instance v12, Ljava/io/File;

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v13}, Landroid/content/pm/ApplicationInfo;->getCodePath()Ljava/lang/String;

    move-result-object v13

    invoke-direct {v12, v13}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    move-object/from16 v17, v12

    .line 11715
    .local v17, "destCodeFile":Ljava/io/File;
    new-instance v12, Ljava/io/File;

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v13}, Landroid/content/pm/ApplicationInfo;->getResourcePath()Ljava/lang/String;

    move-result-object v13

    invoke-direct {v12, v13}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    move-object/from16 v18, v12

    .line 11719
    .local v18, "destResourceFile":Ljava/io/File;
    const/4 v12, 0x0

    .line 11720
    .local v12, "primaryCpuAbiFromSettings":Ljava/lang/String;
    const/4 v13, 0x0

    .line 11721
    .local v13, "secondaryCpuAbiFromSettings":Ljava/lang/String;
    and-int/lit16 v8, v4, 0x2000

    move/from16 v37, v5

    .end local v5  # "parseFlags":I
    .local v37, "parseFlags":I
    if-eqz v8, :cond_68

    const/4 v8, 0x1

    goto :goto_69

    :cond_68
    const/4 v8, 0x0

    .line 11722
    .local v8, "needToDeriveAbi":Z
    :goto_69
    if-nez v8, :cond_7e

    .line 11723
    if-eqz v0, :cond_77

    .line 11724
    iget-object v12, v0, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    .line 11725
    iget-object v13, v0, Lcom/android/server/pm/PackageSetting;->secondaryCpuAbiString:Ljava/lang/String;

    move-object/from16 v44, v13

    move-object v13, v12

    move-object/from16 v12, v44

    goto :goto_83

    .line 11728
    :cond_77
    const/4 v8, 0x1

    move-object/from16 v44, v13

    move-object v13, v12

    move-object/from16 v12, v44

    goto :goto_83

    .line 11722
    :cond_7e
    move-object/from16 v44, v13

    move-object v13, v12

    move-object/from16 v12, v44

    .line 11733
    .local v12, "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .local v13, "primaryCpuAbiFromSettings":Ljava/lang/String;
    :goto_83
    const/16 v16, 0x1

    .line 11734
    .local v16, "forceFullRecord":Z
    if-eqz v0, :cond_99

    .line 11735
    invoke-virtual {v0}, Lcom/android/server/pm/PackageSetting;->isForceFull()Z

    move-result v16

    .line 11736
    iget-object v5, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v5}, Landroid/content/pm/ApplicationInfo;->isMzApp()Z

    move-result v5

    if-eqz v5, :cond_96

    .line 11737
    const/4 v5, 0x1

    iput-boolean v5, v0, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    .line 11740
    :cond_96
    move/from16 v5, v16

    goto :goto_9b

    .line 11734
    :cond_99
    move/from16 v5, v16

    .line 11740
    .end local v16  # "forceFullRecord":Z
    .local v5, "forceFullRecord":Z
    :goto_9b
    move-object/from16 v16, v12

    .end local v12  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .local v16, "secondaryCpuAbiFromSettings":Ljava/lang/String;
    iget-object v12, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v12}, Landroid/content/pm/ApplicationInfo;->isForceFull()Z

    move-result v12

    if-eq v12, v5, :cond_ad

    .line 11741
    iget-object v12, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v12, v5}, Landroid/content/pm/ApplicationInfo;->setForceFull(Z)V

    .line 11742
    invoke-static {v11}, Landroid/content/pm/PackageParser;->setMaxAspectRatio(Landroid/content/pm/PackageParser$Package;)V

    .line 11746
    :cond_ad
    const-string v12, " to "

    if-eqz v0, :cond_f4

    iget-object v10, v0, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eq v10, v2, :cond_f4

    .line 11747
    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Package "

    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " shared user changed from "

    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 11749
    iget-object v9, v0, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    const-string v19, "<nothing>"

    if-eqz v9, :cond_d4

    .line 11750
    iget-object v9, v0, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v9, v9, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    goto :goto_d6

    :cond_d4
    move-object/from16 v9, v19

    :goto_d6
    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 11752
    if-eqz v2, :cond_e1

    iget-object v9, v2, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    goto :goto_e3

    :cond_e1
    move-object/from16 v9, v19

    :goto_e3
    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, "; replacing with new"

    invoke-virtual {v10, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    .line 11747
    const/4 v10, 0x5

    invoke-static {v10, v9}, Lcom/android/server/pm/PackageManagerService;->reportSettingsProblem(ILjava/lang/String;)V

    .line 11754
    const/4 v0, 0x0

    .line 11757
    :cond_f4
    const/4 v9, 0x0

    .line 11758
    .local v9, "usesStaticLibraries":[Ljava/lang/String;
    iget-object v10, v11, Landroid/content/pm/PackageParser$Package;->usesStaticLibraries:Ljava/util/ArrayList;

    if-eqz v10, :cond_106

    .line 11759
    iget-object v10, v11, Landroid/content/pm/PackageParser$Package;->usesStaticLibraries:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    new-array v9, v10, [Ljava/lang/String;

    .line 11760
    iget-object v10, v11, Landroid/content/pm/PackageParser$Package;->usesStaticLibraries:Ljava/util/ArrayList;

    invoke-virtual {v10, v9}, Ljava/util/ArrayList;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    .line 11762
    :cond_106
    if-nez v0, :cond_10a

    const/4 v10, 0x1

    goto :goto_10b

    :cond_10a
    const/4 v10, 0x0

    .line 11763
    .local v10, "createNewPackage":Z
    :goto_10b
    if-eqz v10, :cond_18f

    .line 11764
    move-object/from16 v19, v12

    iget-object v12, v11, Landroid/content/pm/PackageParser$Package;->parentPackage:Landroid/content/pm/PackageParser$Package;

    if-eqz v12, :cond_118

    .line 11765
    iget-object v12, v11, Landroid/content/pm/PackageParser$Package;->parentPackage:Landroid/content/pm/PackageParser$Package;

    iget-object v12, v12, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    goto :goto_119

    :cond_118
    const/4 v12, 0x0

    :goto_119
    move-object/from16 v30, v12

    .line 11766
    .local v30, "parentPackageName":Ljava/lang/String;
    and-int/lit16 v12, v4, 0x4000

    if-eqz v12, :cond_122

    const/16 v28, 0x1

    goto :goto_124

    :cond_122
    const/16 v28, 0x0

    .line 11767
    .local v28, "instantApp":Z
    :goto_124
    const/high16 v12, 0x10000

    and-int/2addr v12, v4

    if-eqz v12, :cond_12c

    const/16 v29, 0x1

    goto :goto_12e

    :cond_12c
    const/16 v29, 0x0

    .line 11769
    .local v29, "virtualPreload":Z
    :goto_12e
    iget-object v12, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    move-object/from16 v39, v16

    move-object/from16 v40, v19

    .end local v16  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .local v39, "secondaryCpuAbiFromSettings":Ljava/lang/String;
    move-object/from16 v16, v13

    .end local v13  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .local v16, "primaryCpuAbiFromSettings":Ljava/lang/String;
    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v13, v13, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    move-object/from16 v19, v13

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v13, v13, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    move-object/from16 v20, v13

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v13, v13, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    move-object/from16 v21, v13

    iget v13, v11, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    move-object/from16 v26, v14

    int-to-long v13, v13

    move-wide/from16 v22, v13

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v13, v13, Landroid/content/pm/ApplicationInfo;->flags:I

    move/from16 v24, v13

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v13, v13, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    move/from16 v25, v13

    const/16 v27, 0x1

    .line 11775
    invoke-virtual {v11}, Landroid/content/pm/PackageParser$Package;->getChildPackageNames()Ljava/util/List;

    move-result-object v31

    .line 11776
    invoke-static {}, Lcom/android/server/pm/UserManagerService;->getInstance()Lcom/android/server/pm/UserManagerService;

    move-result-object v32

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->usesStaticLibrariesVersions:[J

    move-object/from16 v34, v13

    .line 11769
    move-object/from16 v14, v16

    .end local v16  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .local v14, "primaryCpuAbiFromSettings":Ljava/lang/String;
    move-object v13, v6

    move-object/from16 v41, v14

    move-object/from16 v42, v26

    .end local v14  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .local v41, "primaryCpuAbiFromSettings":Ljava/lang/String;
    move-object v14, v7

    move/from16 v43, v15

    .end local v15  # "isPlatformPackage":Z
    .local v43, "isPlatformPackage":Z
    move-object v15, v3

    move-object/from16 v16, v2

    move-object/from16 v26, v1

    move-object/from16 v33, v9

    invoke-static/range {v12 .. v34}, Lcom/android/server/pm/Settings;->createNewSetting(Ljava/lang/String;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Ljava/lang/String;Lcom/android/server/pm/SharedUserSetting;Ljava/io/File;Ljava/io/File;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;JIILandroid/os/UserHandle;ZZZLjava/lang/String;Ljava/util/List;Lcom/android/server/pm/UserManagerService;[Ljava/lang/String;[J)Lcom/android/server/pm/PackageSetting;

    move-result-object v0

    .line 11780
    iget-object v12, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v12}, Landroid/content/pm/ApplicationInfo;->isMzApp()Z

    move-result v12

    iput-boolean v12, v0, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    .line 11782
    invoke-virtual {v0, v5}, Lcom/android/server/pm/PackageSetting;->setForceFull(Z)V

    .line 11784
    .end local v28  # "instantApp":Z
    .end local v29  # "virtualPreload":Z
    .end local v30  # "parentPackageName":Ljava/lang/String;
    move-object v12, v0

    move-object/from16 v16, v3

    move/from16 v33, v5

    goto :goto_1e7

    .line 11786
    .end local v39  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .end local v41  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .end local v43  # "isPlatformPackage":Z
    .restart local v13  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v15  # "isPlatformPackage":Z
    .local v16, "secondaryCpuAbiFromSettings":Ljava/lang/String;
    :cond_18f
    move-object/from16 v40, v12

    move-object/from16 v41, v13

    move-object/from16 v42, v14

    move/from16 v43, v15

    move-object/from16 v39, v16

    .end local v13  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .end local v15  # "isPlatformPackage":Z
    .end local v16  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v39  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v41  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v43  # "isPlatformPackage":Z
    iget-object v12, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v12}, Landroid/content/pm/ApplicationInfo;->isMzApp()Z

    move-result v12

    iput-boolean v12, v0, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    .line 11789
    new-instance v12, Lcom/android/server/pm/PackageSetting;

    invoke-direct {v12, v0}, Lcom/android/server/pm/PackageSetting;-><init>(Lcom/android/server/pm/PackageSetting;)V

    move-object v0, v12

    .line 11790
    iput-object v11, v0, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 11797
    iget-object v12, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v12, v12, Landroid/content/pm/ApplicationInfo;->nativeLibraryDir:Ljava/lang/String;

    iget-object v13, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v13, v13, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    iget-object v14, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v14, v14, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    iget-object v15, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v15, v15, Landroid/content/pm/ApplicationInfo;->flags:I

    move-object/from16 v16, v3

    .end local v3  # "realPkgName":Ljava/lang/String;
    .local v16, "realPkgName":Ljava/lang/String;
    iget-object v3, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    .line 11801
    invoke-virtual {v11}, Landroid/content/pm/PackageParser$Package;->getChildPackageNames()Ljava/util/List;

    move-result-object v29

    invoke-static {}, Lcom/android/server/pm/UserManagerService;->getInstance()Lcom/android/server/pm/UserManagerService;

    move-result-object v30

    move/from16 v33, v5

    .end local v5  # "forceFullRecord":Z
    .local v33, "forceFullRecord":Z
    iget-object v5, v11, Landroid/content/pm/PackageParser$Package;->usesStaticLibrariesVersions:[J

    .line 11797
    move-object/from16 v19, v0

    move-object/from16 v20, v7

    move-object/from16 v21, v2

    move-object/from16 v22, v17

    move-object/from16 v23, v18

    move-object/from16 v24, v12

    move-object/from16 v25, v13

    move-object/from16 v26, v14

    move/from16 v27, v15

    move/from16 v28, v3

    move-object/from16 v31, v9

    move-object/from16 v32, v5

    invoke-static/range {v19 .. v32}, Lcom/android/server/pm/Settings;->updatePackageSetting(Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/PackageSetting;Lcom/android/server/pm/SharedUserSetting;Ljava/io/File;Ljava/io/File;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IILjava/util/List;Lcom/android/server/pm/UserManagerService;[Ljava/lang/String;[J)V

    move-object v12, v0

    .line 11804
    .end local v0  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v12, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_1e7
    if-eqz v10, :cond_211

    if-eqz v6, :cond_211

    .line 11809
    iget-object v0, v6, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v11, v0}, Landroid/content/pm/PackageParser$Package;->setPackageName(Ljava/lang/String;)V

    .line 11812
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "New package "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v12, Lcom/android/server/pm/PackageSetting;->realName:Ljava/lang/String;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " renamed to replace old package "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v12, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 11814
    .local v0, "msg":Ljava/lang/String;
    const/4 v3, 0x5

    invoke-static {v3, v0}, Lcom/android/server/pm/PackageManagerService;->reportSettingsProblem(ILjava/lang/String;)V

    .line 11817
    .end local v0  # "msg":Ljava/lang/String;
    :cond_211
    if-nez v1, :cond_215

    const/4 v5, 0x0

    goto :goto_219

    :cond_215
    invoke-virtual {v1}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v5

    :goto_219
    move v13, v5

    .line 11819
    .local v13, "userId":I
    if-nez v10, :cond_22f

    .line 11820
    and-int/lit16 v0, v4, 0x4000

    if-eqz v0, :cond_222

    const/4 v0, 0x1

    goto :goto_223

    :cond_222
    const/4 v0, 0x0

    .line 11821
    .local v0, "instantApp":Z
    :goto_223
    const v3, 0x8000

    and-int/2addr v3, v4

    if-eqz v3, :cond_22b

    const/4 v3, 0x1

    goto :goto_22c

    :cond_22b
    const/4 v3, 0x0

    .line 11822
    .local v3, "fullApp":Z
    :goto_22c
    invoke-static {v12, v13, v0, v3}, Lcom/android/server/pm/PackageManagerService;->setInstantAppForUser(Lcom/android/server/pm/PackageSetting;IZZ)V

    .line 11825
    .end local v0  # "instantApp":Z
    .end local v3  # "fullApp":Z
    :cond_22f
    if-nez v7, :cond_23b

    and-int/lit8 v0, v4, 0x4

    if-eqz v0, :cond_243

    .line 11827
    invoke-virtual {v12}, Lcom/android/server/pm/PackageSetting;->isSystem()Z

    move-result v0

    if-eqz v0, :cond_243

    .line 11828
    :cond_23b
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    or-int/lit16 v3, v3, 0x80

    iput v3, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    .line 11840
    :cond_243
    if-eqz v2, :cond_250

    iget-object v0, v2, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v0}, Landroid/util/ArraySet;->size()I

    move-result v0

    if-eqz v0, :cond_250

    .line 11841
    iget v0, v2, Lcom/android/server/pm/SharedUserSetting;->seInfoTargetSdkVersion:I

    goto :goto_254

    :cond_250
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    :goto_254
    move v14, v0

    .line 11844
    .local v14, "targetSdkVersion":I
    if-eqz v2, :cond_261

    .line 11845
    invoke-virtual {v2}, Lcom/android/server/pm/SharedUserSetting;->isPrivileged()Z

    move-result v0

    invoke-virtual {v11}, Landroid/content/pm/PackageParser$Package;->isPrivileged()Z

    move-result v3

    or-int/2addr v0, v3

    goto :goto_265

    :cond_261
    invoke-virtual {v11}, Landroid/content/pm/PackageParser$Package;->isPrivileged()Z

    move-result v0

    :goto_265
    move v15, v0

    .line 11847
    .local v15, "isPrivileged":Z
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->targetSandboxVersion:I

    invoke-static {v11, v15, v3, v14}, Lcom/android/server/pm/SELinuxMMAC;->getSeInfo(Landroid/content/pm/PackageParser$Package;ZII)Ljava/lang/String;

    move-result-object v3

    iput-object v3, v0, Landroid/content/pm/ApplicationInfo;->seInfo:Ljava/lang/String;

    .line 11849
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 11850
    const/4 v3, -0x1

    if-ne v13, v3, :cond_279

    const/4 v3, 0x0

    goto :goto_27a

    :cond_279
    move v3, v13

    .line 11849
    :goto_27a
    invoke-virtual {v12, v3}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v3

    invoke-static {v3}, Landroid/content/pm/SELinuxUtil;->assignSeinfoUser(Landroid/content/pm/PackageUserState;)Ljava/lang/String;

    move-result-object v3

    iput-object v3, v0, Landroid/content/pm/ApplicationInfo;->seInfoUser:Ljava/lang/String;

    .line 11852
    iput-object v12, v11, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    .line 11853
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v5, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    invoke-static {v3, v5}, Lcom/android/server/pm/PackageManagerService;->fixProcessName(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    iput-object v3, v0, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    .line 11857
    if-nez v43, :cond_29e

    .line 11859
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v3, 0x0

    invoke-virtual {v0, v3}, Landroid/content/pm/ApplicationInfo;->initForUser(I)V

    .line 11862
    :cond_29e
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->cpuAbiOverride:Ljava/lang/String;

    invoke-static {v0, v12}, Lcom/android/server/pm/PackageManagerServiceUtils;->deriveAbiOverride(Ljava/lang/String;Lcom/android/server/pm/PackageSetting;)Ljava/lang/String;

    move-result-object v5

    .line 11864
    .local v5, "cpuAbiOverride":Ljava/lang/String;
    and-int/lit8 v0, v4, 0x4

    if-nez v0, :cond_335

    .line 11865
    if-eqz v8, :cond_2e1

    .line 11866
    move-object v3, v1

    .end local v1  # "user":Landroid/os/UserHandle;
    .local v3, "user":Landroid/os/UserHandle;
    const-wide/32 v0, 0x40000

    move-object/from16 v19, v2

    .end local v2  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    .local v19, "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    const-string v2, "derivePackageAbi"

    invoke-static {v0, v1, v2}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 11867
    invoke-virtual {v11}, Landroid/content/pm/PackageParser$Package;->isLibrary()Z

    move-result v2

    const/16 v20, 0x1

    xor-int/lit8 v2, v2, 0x1

    .line 11868
    .local v2, "extractNativeLibs":Z
    invoke-static {v11, v5, v2}, Lcom/android/server/pm/PackageManagerService;->derivePackageAbi(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;Z)V

    .line 11869
    invoke-static {v0, v1}, Landroid/os/Trace;->traceEnd(J)V

    .line 11874
    invoke-static {v11}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-eqz v0, :cond_2dd

    invoke-virtual {v11}, Landroid/content/pm/PackageParser$Package;->isUpdatedSystemApp()Z

    move-result v0

    if-nez v0, :cond_2dd

    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    if-nez v0, :cond_2dd

    .line 11876
    invoke-static {v11, v12}, Lcom/android/server/pm/PackageManagerService;->setBundledAppAbisAndRoots(Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/PackageSetting;)V

    .line 11877
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sAppLib32InstallDir:Ljava/io/File;

    invoke-static {v11, v0}, Lcom/android/server/pm/PackageManagerService;->setNativeLibraryPaths(Landroid/content/pm/PackageParser$Package;Ljava/io/File;)V

    .line 11879
    .end local v2  # "extractNativeLibs":Z
    :cond_2dd
    move-object/from16 v1, v42

    goto/16 :goto_356

    .line 11883
    .end local v3  # "user":Landroid/os/UserHandle;
    .end local v19  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    .restart local v1  # "user":Landroid/os/UserHandle;
    .local v2, "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    :cond_2e1
    move-object v3, v1

    move-object/from16 v19, v2

    .end local v1  # "user":Landroid/os/UserHandle;
    .end local v2  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    .restart local v3  # "user":Landroid/os/UserHandle;
    .restart local v19  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v2, v41

    .end local v41  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .local v2, "primaryCpuAbiFromSettings":Ljava/lang/String;
    iput-object v2, v0, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 11884
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v1, v39

    .end local v39  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .local v1, "secondaryCpuAbiFromSettings":Ljava/lang/String;
    iput-object v1, v0, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    .line 11886
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sAppLib32InstallDir:Ljava/io/File;

    invoke-static {v11, v0}, Lcom/android/server/pm/PackageManagerService;->setNativeLibraryPaths(Landroid/content/pm/PackageParser$Package;Ljava/io/File;)V

    .line 11888
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_ABI_SELECTION:Z

    if-eqz v0, :cond_32e

    .line 11889
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v39, v1

    .end local v1  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v39  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    const-string v1, "Using ABIS and native lib paths from settings : "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, ", "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    move-object/from16 v1, v42

    invoke-static {v1, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    move-object/from16 v41, v2

    goto :goto_356

    .line 11888
    .end local v39  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v1  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    :cond_32e
    move-object/from16 v39, v1

    move-object/from16 v1, v42

    .end local v1  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v39  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    move-object/from16 v41, v2

    goto :goto_356

    .line 11895
    .end local v3  # "user":Landroid/os/UserHandle;
    .end local v19  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    .local v1, "user":Landroid/os/UserHandle;
    .local v2, "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    .restart local v41  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    :cond_335
    move-object v3, v1

    move-object/from16 v19, v2

    move-object/from16 v2, v41

    move-object/from16 v1, v42

    .end local v1  # "user":Landroid/os/UserHandle;
    .end local v41  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .local v2, "primaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v3  # "user":Landroid/os/UserHandle;
    .restart local v19  # "sharedUserSetting":Lcom/android/server/pm/SharedUserSetting;
    and-int/lit16 v0, v4, 0x100

    if-eqz v0, :cond_34f

    .line 11899
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v41, v2

    .end local v2  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v41  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    iget-object v2, v12, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    iput-object v2, v0, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 11900
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v12, Lcom/android/server/pm/PackageSetting;->secondaryCpuAbiString:Ljava/lang/String;

    iput-object v2, v0, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    goto :goto_351

    .line 11895
    .end local v41  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v2  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    :cond_34f
    move-object/from16 v41, v2

    .line 11907
    .end local v2  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .restart local v41  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    :goto_351
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sAppLib32InstallDir:Ljava/io/File;

    invoke-static {v11, v0}, Lcom/android/server/pm/PackageManagerService;->setNativeLibraryPaths(Landroid/content/pm/PackageParser$Package;Ljava/io/File;)V

    .line 11914
    :goto_356
    if-eqz v43, :cond_374

    .line 11915
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-static {}, Ldalvik/system/VMRuntime;->getRuntime()Ldalvik/system/VMRuntime;

    move-result-object v2

    invoke-virtual {v2}, Ldalvik/system/VMRuntime;->is64Bit()Z

    move-result v2

    if-eqz v2, :cond_36b

    .line 11916
    sget-object v2, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    const/16 v20, 0x0

    aget-object v2, v2, v20

    goto :goto_371

    :cond_36b
    const/16 v20, 0x0

    sget-object v2, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    aget-object v2, v2, v20

    :goto_371
    iput-object v2, v0, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    goto :goto_376

    .line 11914
    :cond_374
    const/16 v20, 0x0

    .line 11923
    :goto_376
    and-int/lit8 v0, v4, 0x1

    if-nez v0, :cond_3a2

    and-int/lit8 v0, v4, 0x4

    if-eqz v0, :cond_3a2

    .line 11924
    if-nez v5, :cond_3a2

    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    if-eqz v0, :cond_3a2

    .line 11925
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Ignoring persisted ABI override "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " for package "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11930
    :cond_3a2
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    iput-object v0, v12, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    .line 11931
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    iput-object v0, v12, Lcom/android/server/pm/PackageSetting;->secondaryCpuAbiString:Ljava/lang/String;

    .line 11932
    iput-object v5, v12, Lcom/android/server/pm/PackageSetting;->cpuAbiOverrideString:Ljava/lang/String;

    .line 11936
    iput-object v5, v11, Landroid/content/pm/PackageParser$Package;->cpuAbiOverride:Ljava/lang/String;

    .line 11938
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_ABI_SELECTION:Z

    if-eqz v0, :cond_3e4

    .line 11939
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Resolved nativeLibraryRoot for "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " to root="

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, ", isa="

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-boolean v2, v2, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootRequiresIsa:Z

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 11946
    :cond_3e4
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    iput-object v0, v12, Lcom/android/server/pm/PackageSetting;->legacyNativeLibraryPathString:Ljava/lang/String;

    .line 11948
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_ABI_SELECTION:Z

    if-eqz v0, :cond_41c

    .line 11949
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Abis for package["

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, "] are primary="

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " secondary="

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 11954
    :cond_41c
    and-int/lit8 v0, v4, 0x10

    if-nez v0, :cond_42e

    iget-object v0, v12, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    if-eqz v0, :cond_42e

    .line 11961
    iget-object v0, v12, Lcom/android/server/pm/PackageSetting;->sharedUser:Lcom/android/server/pm/SharedUserSetting;

    iget-object v0, v0, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    .line 11962
    invoke-static {v0, v11}, Lcom/android/server/pm/PackageManagerService;->adjustCpuAbisForSharedUserLPw(Ljava/util/Set;Landroid/content/pm/PackageParser$Package;)Ljava/util/List;

    move-result-object v0

    move-object/from16 v35, v0

    .line 11965
    :cond_42e
    if-eqz p1, :cond_442

    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->requestedPermissions:Ljava/util/ArrayList;

    const-string v2, "android.permission.FACTORY_TEST"

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_442

    .line 11967
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    or-int/lit8 v2, v2, 0x10

    iput v2, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    .line 11970
    :cond_442
    invoke-static {v11}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    if-eqz v0, :cond_44c

    .line 11971
    const/4 v0, 0x1

    iput-boolean v0, v12, Lcom/android/server/pm/PackageSetting;->isOrphaned:Z

    goto :goto_44d

    .line 11970
    :cond_44c
    const/4 v0, 0x1

    .line 11975
    :goto_44d
    move-object/from16 v21, v3

    .end local v3  # "user":Landroid/os/UserHandle;
    .local v21, "user":Landroid/os/UserHandle;
    invoke-static {v11}, Lcom/android/server/pm/PackageManagerServiceUtils;->getLastModifiedTime(Landroid/content/pm/PackageParser$Package;)J

    move-result-wide v2

    .line 11976
    .local v2, "scanFileTime":J
    const-wide/16 v22, 0x0

    move/from16 v24, v8

    move-object/from16 v25, v9

    move-wide/from16 v8, p2

    .end local v8  # "needToDeriveAbi":Z
    .end local v9  # "usesStaticLibraries":[Ljava/lang/String;
    .local v24, "needToDeriveAbi":Z
    .local v25, "usesStaticLibraries":[Ljava/lang/String;
    cmp-long v26, v8, v22

    if-eqz v26, :cond_473

    .line 11977
    move-object/from16 v42, v1

    iget-wide v0, v12, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    cmp-long v0, v0, v22

    if-nez v0, :cond_46c

    .line 11978
    iput-wide v8, v12, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J

    iput-wide v8, v12, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    goto :goto_48c

    .line 11979
    :cond_46c
    and-int/lit8 v0, v4, 0x8

    if-eqz v0, :cond_48c

    .line 11980
    iput-wide v8, v12, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J

    goto :goto_48c

    .line 11982
    :cond_473
    move-object/from16 v42, v1

    iget-wide v0, v12, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    cmp-long v0, v0, v22

    if-nez v0, :cond_480

    .line 11984
    iput-wide v2, v12, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J

    iput-wide v2, v12, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    goto :goto_48c

    .line 11985
    :cond_480
    and-int/lit8 v0, v37, 0x10

    if-eqz v0, :cond_48c

    .line 11986
    iget-wide v0, v12, Lcom/android/server/pm/PackageSetting;->timeStamp:J

    cmp-long v0, v2, v0

    if-eqz v0, :cond_48c

    .line 11989
    iput-wide v2, v12, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J

    .line 11992
    :cond_48c
    :goto_48c
    invoke-virtual {v12, v2, v3}, Lcom/android/server/pm/PackageSetting;->setTimeStamp(J)V

    .line 11994
    iput-object v11, v12, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 11995
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    iput v0, v12, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    .line 11996
    invoke-virtual {v11}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v0

    move-wide/from16 v22, v2

    .end local v2  # "scanFileTime":J
    .local v22, "scanFileTime":J
    iget-wide v2, v12, Lcom/android/server/pm/PackageSetting;->versionCode:J

    cmp-long v0, v0, v2

    if-eqz v0, :cond_4a9

    .line 11997
    invoke-virtual {v11}, Landroid/content/pm/PackageParser$Package;->getLongVersionCode()J

    move-result-wide v0

    iput-wide v0, v12, Lcom/android/server/pm/PackageSetting;->versionCode:J

    .line 12000
    :cond_4a9
    iget-object v0, v11, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v0, Landroid/content/pm/ApplicationInfo;->volumeUuid:Ljava/lang/String;

    .line 12001
    .local v3, "volumeUuid":Ljava/lang/String;
    iget-object v0, v12, Lcom/android/server/pm/PackageSetting;->volumeUuid:Ljava/lang/String;

    invoke-static {v3, v0}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_4f4

    .line 12002
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Update"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 12003
    invoke-virtual {v12}, Lcom/android/server/pm/PackageSetting;->isSystem()Z

    move-result v1

    if-eqz v1, :cond_4c8

    const-string v1, " system"

    goto :goto_4ca

    :cond_4c8
    const-string v1, ""

    :goto_4ca
    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " package "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, v11, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " volume from "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, v12, Lcom/android/server/pm/PackageSetting;->volumeUuid:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v1, v40

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 12002
    move-object/from16 v1, v42

    invoke-static {v1, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 12007
    iput-object v3, v12, Lcom/android/server/pm/PackageSetting;->volumeUuid:Ljava/lang/String;

    .line 12010
    :cond_4f4
    const/4 v0, 0x0

    .line 12011
    .local v0, "staticSharedLibraryInfo":Landroid/content/pm/SharedLibraryInfo;
    iget-object v1, v11, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    invoke-static {v1}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v1

    if-nez v1, :cond_504

    .line 12012
    invoke-static {v11}, Landroid/content/pm/SharedLibraryInfo;->createForStatic(Landroid/content/pm/PackageParser$Package;)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v0

    move-object/from16 v26, v0

    goto :goto_506

    .line 12011
    :cond_504
    move-object/from16 v26, v0

    .line 12014
    .end local v0  # "staticSharedLibraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .local v26, "staticSharedLibraryInfo":Landroid/content/pm/SharedLibraryInfo;
    :goto_506
    const/4 v0, 0x0

    .line 12015
    .local v0, "dynamicSharedLibraryInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    iget-object v1, v11, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    invoke-static {v1}, Lcom/android/internal/util/ArrayUtils;->isEmpty(Ljava/util/Collection;)Z

    move-result v1

    if-nez v1, :cond_53c

    .line 12016
    new-instance v1, Ljava/util/ArrayList;

    iget-object v2, v11, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    invoke-direct {v1, v2}, Ljava/util/ArrayList;-><init>(I)V

    move-object v0, v1

    .line 12017
    iget-object v1, v11, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_521
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_539

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/String;

    .line 12018
    .local v2, "name":Ljava/lang/String;
    move-object/from16 v27, v1

    invoke-static {v11, v2}, Landroid/content/pm/SharedLibraryInfo;->createForDynamic(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v1

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 12019
    .end local v2  # "name":Ljava/lang/String;
    move-object/from16 v1, v27

    goto :goto_521

    .line 12017
    :cond_539
    move-object/from16 v27, v0

    goto :goto_53e

    .line 12015
    :cond_53c
    move-object/from16 v27, v0

    .line 12022
    .end local v0  # "dynamicSharedLibraryInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .local v27, "dynamicSharedLibraryInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    :goto_53e
    new-instance v28, Lcom/android/server/pm/PackageManagerService$ScanResult;

    const/4 v2, 0x1

    if-nez v10, :cond_545

    const/16 v20, 0x1

    :cond_545
    move-object/from16 v0, v28

    move-object/from16 v29, v39

    .end local v39  # "secondaryCpuAbiFromSettings":Ljava/lang/String;
    .local v29, "secondaryCpuAbiFromSettings":Ljava/lang/String;
    move-object/from16 v1, p0

    move-wide/from16 v30, v22

    move-object/from16 v22, v41

    .end local v41  # "primaryCpuAbiFromSettings":Ljava/lang/String;
    .local v22, "primaryCpuAbiFromSettings":Ljava/lang/String;
    .local v30, "scanFileTime":J
    move-object/from16 v23, v3

    .end local v3  # "volumeUuid":Ljava/lang/String;
    .local v23, "volumeUuid":Ljava/lang/String;
    move-object v3, v12

    move/from16 v32, v4

    .end local v4  # "scanFlags":I
    .local v32, "scanFlags":I
    move-object/from16 v4, v35

    move/from16 v34, v33

    move/from16 v33, v37

    move-object/from16 v37, v5

    .end local v5  # "cpuAbiOverride":Ljava/lang/String;
    .local v33, "parseFlags":I
    .local v34, "forceFullRecord":Z
    .local v37, "cpuAbiOverride":Ljava/lang/String;
    move/from16 v5, v20

    move-object/from16 v20, v6

    .end local v6  # "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v20, "originalPkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v6, v26

    move-object/from16 v38, v7

    .end local v7  # "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v38, "disabledPkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v7, v27

    invoke-direct/range {v0 .. v7}, Lcom/android/server/pm/PackageManagerService$ScanResult;-><init>(Lcom/android/server/pm/PackageManagerService$ScanRequest;ZLcom/android/server/pm/PackageSetting;Ljava/util/List;ZLandroid/content/pm/SharedLibraryInfo;Ljava/util/List;)V

    return-object v28
.end method

.method private scanPackageTracedLI(Ljava/io/File;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;
    .registers 10
    .param p1, "scanFile"  # Ljava/io/File;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .param p4, "currentTime"  # J
    .param p6, "user"  # Landroid/os/UserHandle;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock",
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 9625
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v1, "scanPackage ["

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Ljava/io/File;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "]"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-wide/32 v1, 0x40000

    invoke-static {v1, v2, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 9627
    :try_start_21
    invoke-direct/range {p0 .. p6}, Lcom/android/server/pm/PackageManagerService;->scanPackageLI(Ljava/io/File;IIJLandroid/os/UserHandle;)Landroid/content/pm/PackageParser$Package;

    move-result-object v0
    :try_end_25
    .catchall {:try_start_21 .. :try_end_25} :catchall_29

    .line 9629
    invoke-static {v1, v2}, Landroid/os/Trace;->traceEnd(J)V

    .line 9627
    return-object v0

    .line 9629
    :catchall_29
    move-exception v0

    invoke-static {v1, v2}, Landroid/os/Trace;->traceEnd(J)V

    throw v0
.end method

.method private scanPackageTracedLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Ljava/util/List;
    .registers 21
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "parseFlags"  # I
    .param p3, "scanFlags"  # I
    .param p4, "currentTime"  # J
    .param p6, "user"  # Landroid/os/UserHandle;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock",
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageParser$Package;",
            "IIJ",
            "Landroid/os/UserHandle;",
            ")",
            "Ljava/util/List<",
            "Lcom/android/server/pm/PackageManagerService$ScanResult;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 11186
    move-object v8, p1

    move/from16 v0, p3

    const-wide/32 v9, 0x40000

    const-string/jumbo v1, "scanPackage"

    invoke-static {v9, v10, v1}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 11192
    and-int/lit16 v1, v0, 0x400

    if-nez v1, :cond_22

    .line 11193
    iget-object v1, v8, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v1, :cond_20

    iget-object v1, v8, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_20

    .line 11194
    or-int/lit16 v0, v0, 0x400

    move v11, v0

    .end local p3  # "scanFlags":I
    .local v0, "scanFlags":I
    goto :goto_25

    .line 11200
    .end local v0  # "scanFlags":I
    .restart local p3  # "scanFlags":I
    :cond_20
    move v11, v0

    goto :goto_25

    .line 11197
    :cond_22
    and-int/lit16 v0, v0, -0x401

    move v11, v0

    .line 11200
    .end local p3  # "scanFlags":I
    .local v11, "scanFlags":I
    :goto_25
    iget-object v0, v8, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_30

    iget-object v0, v8, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_31

    :cond_30
    const/4 v0, 0x0

    :goto_31
    move v12, v0

    .line 11201
    .local v12, "childCount":I
    new-instance v0, Ljava/util/ArrayList;

    add-int/lit8 v1, v12, 0x1

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    move-object v13, v0

    .line 11204
    .local v13, "scanResults":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ScanResult;>;"
    move-object v1, p0

    move-object v2, p1

    move/from16 v3, p2

    move v4, v11

    move-wide/from16 v5, p4

    move-object/from16 v7, p6

    :try_start_43
    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->scanPackageNewLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Lcom/android/server/pm/PackageManagerService$ScanResult;

    move-result-object v0

    invoke-interface {v13, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 11206
    const/4 v0, 0x0

    .local v0, "i":I
    :goto_4b
    if-ge v0, v12, :cond_69

    .line 11207
    iget-object v1, v8, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    move-object v2, v1

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 11208
    .local v2, "childPkg":Landroid/content/pm/PackageParser$Package;
    move-object v1, p0

    move/from16 v3, p2

    move v4, v11

    move-wide/from16 v5, p4

    move-object/from16 v7, p6

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->scanPackageNewLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Lcom/android/server/pm/PackageManagerService$ScanResult;

    move-result-object v1

    invoke-interface {v13, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_65
    .catchall {:try_start_43 .. :try_end_65} :catchall_80

    .line 11206
    nop

    .end local v2  # "childPkg":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v0, v0, 0x1

    goto :goto_4b

    .line 11212
    .end local v0  # "i":I
    :cond_69
    invoke-static {v9, v10}, Landroid/os/Trace;->traceEnd(J)V

    .line 11213
    nop

    .line 11215
    and-int/lit16 v0, v11, 0x400

    if-eqz v0, :cond_7f

    .line 11216
    move-object v1, p0

    move-object v2, p1

    move/from16 v3, p2

    move v4, v11

    move-wide/from16 v5, p4

    move-object/from16 v7, p6

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->scanPackageTracedLI(Landroid/content/pm/PackageParser$Package;IIJLandroid/os/UserHandle;)Ljava/util/List;

    move-result-object v0

    return-object v0

    .line 11219
    :cond_7f
    return-object v13

    .line 11212
    :catchall_80
    move-exception v0

    invoke-static {v9, v10}, Landroid/os/Trace;->traceEnd(J)V

    throw v0
.end method

.method private scheduleDeferredNoKillInstallObserver(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/pm/IPackageInstallObserver2;)V
    .registers 8
    .param p1, "info"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .param p2, "observer"  # Landroid/content/pm/IPackageInstallObserver2;

    .line 2262
    iget-object v0, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 2263
    .local v0, "packageName":Ljava/lang/String;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mNoKillInstallObservers:Ljava/util/Map;

    invoke-static {p1, p2}, Landroid/util/Pair;->create(Ljava/lang/Object;Ljava/lang/Object;)Landroid/util/Pair;

    move-result-object v2

    invoke-interface {v1, v0, v2}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 2264
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v2, 0x18

    invoke-virtual {v1, v2, v0}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(ILjava/lang/Object;)Landroid/os/Message;

    move-result-object v1

    .line 2265
    .local v1, "message":Landroid/os/Message;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const-wide/16 v3, 0x1f4

    invoke-virtual {v2, v1, v3, v4}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2266
    return-void
.end method

.method private scheduleDeferredNoKillPostDelete(Lcom/android/server/pm/PackageManagerService$InstallArgs;)V
    .registers 6
    .param p1, "args"  # Lcom/android/server/pm/PackageManagerService$InstallArgs;

    .line 2256
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v1, 0x17

    invoke-virtual {v0, v1, p1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(ILjava/lang/Object;)Landroid/os/Message;

    move-result-object v0

    .line 2257
    .local v0, "message":Landroid/os/Message;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const-wide/16 v2, 0xbb8

    invoke-virtual {v1, v0, v2, v3}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2258
    return-void
.end method

.method private sendApplicationHiddenForUser(Ljava/lang/String;Lcom/android/server/pm/PackageSetting;I)V
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "pkgSetting"  # Lcom/android/server/pm/PackageSetting;
    .param p3, "userId"  # I

    .line 13933
    new-instance v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    invoke-direct {v0, p0}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;-><init>(Lcom/android/server/pm/PackageSender;)V

    .line 13934
    .local v0, "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    iput-object p1, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    .line 13935
    iget-object v1, p2, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    iput-object v1, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installerPackageName:Ljava/lang/String;

    .line 13936
    const/4 v1, 0x1

    new-array v2, v1, [I

    const/4 v3, 0x0

    aput p3, v2, v3

    iput-object v2, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedUsers:[I

    .line 13937
    new-array v2, v1, [I

    aput p3, v2, v3

    iput-object v2, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->broadcastUsers:[I

    .line 13938
    iget v2, p2, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-static {p3, v2}, Landroid/os/UserHandle;->getUid(II)I

    move-result v2

    iput v2, v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->uid:I

    .line 13939
    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->sendPackageRemovedBroadcasts(Z)V

    .line 13940
    return-void
.end method

.method private sendBootCompletedBroadcastToSystemApp(Ljava/lang/String;ZI)V
    .registers 31
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "includeStopped"  # Z
    .param p3, "userId"  # I

    .line 13759
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move/from16 v15, p3

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mUserManagerInternal:Landroid/os/UserManagerInternal;

    invoke-virtual {v0, v15}, Landroid/os/UserManagerInternal;->isUserRunning(I)Z

    move-result v0

    if-nez v0, :cond_f

    .line 13760
    return-void

    .line 13762
    :cond_f
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v26

    .line 13765
    .local v26, "am":Landroid/app/IActivityManager;
    :try_start_13
    new-instance v0, Landroid/content/Intent;

    const-string v3, "android.intent.action.LOCKED_BOOT_COMPLETED"

    invoke-direct {v0, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 13766
    invoke-virtual {v0, v2}, Landroid/content/Intent;->setPackage(Ljava/lang/String;)Landroid/content/Intent;

    move-result-object v0

    .line 13767
    .local v0, "lockedBcIntent":Landroid/content/Intent;
    const/16 v14, 0x20

    if-eqz p2, :cond_25

    .line 13768
    invoke-virtual {v0, v14}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 13770
    :cond_25
    const-string v3, "android.permission.RECEIVE_BOOT_COMPLETED"

    filled-new-array {v3}, [Ljava/lang/String;

    move-result-object v11
    :try_end_2b
    .catch Landroid/os/RemoteException; {:try_start_13 .. :try_end_2b} :catch_83

    .line 13771
    .local v11, "requiredPermissions":[Ljava/lang/String;
    const/4 v4, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v12, -0x1

    const/4 v13, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    move-object/from16 v3, v26

    move-object v5, v0

    move/from16 v14, v16

    move/from16 v15, v17

    move/from16 v16, p3

    :try_start_40
    invoke-interface/range {v3 .. v16}, Landroid/app/IActivityManager;->broadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;[Ljava/lang/String;ILandroid/os/Bundle;ZZI)I

    .line 13775
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mUserManagerInternal:Landroid/os/UserManagerInternal;
    :try_end_45
    .catch Landroid/os/RemoteException; {:try_start_40 .. :try_end_45} :catch_7f

    move/from16 v4, p3

    :try_start_47
    invoke-virtual {v3, v4}, Landroid/os/UserManagerInternal;->isUserUnlockingOrUnlocked(I)Z

    move-result v3

    if-eqz v3, :cond_7b

    .line 13776
    new-instance v3, Landroid/content/Intent;

    const-string v5, "android.intent.action.BOOT_COMPLETED"

    invoke-direct {v3, v5}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    invoke-virtual {v3, v2}, Landroid/content/Intent;->setPackage(Ljava/lang/String;)Landroid/content/Intent;

    move-result-object v3

    .line 13777
    .local v3, "bcIntent":Landroid/content/Intent;
    if-eqz p2, :cond_5f

    .line 13778
    const/16 v5, 0x20

    invoke-virtual {v3, v5}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 13780
    :cond_5f
    const/4 v13, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, 0x0

    const/16 v19, 0x0

    const/16 v21, -0x1

    const/16 v22, 0x0

    const/16 v23, 0x0

    const/16 v24, 0x0

    move-object/from16 v12, v26

    move-object v14, v3

    move-object/from16 v20, v11

    move/from16 v25, p3

    invoke-interface/range {v12 .. v25}, Landroid/app/IActivityManager;->broadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;[Ljava/lang/String;ILandroid/os/Bundle;ZZI)I
    :try_end_7b
    .catch Landroid/os/RemoteException; {:try_start_47 .. :try_end_7b} :catch_7d

    .line 13785
    .end local v0  # "lockedBcIntent":Landroid/content/Intent;
    .end local v3  # "bcIntent":Landroid/content/Intent;
    .end local v11  # "requiredPermissions":[Ljava/lang/String;
    :cond_7b
    nop

    .line 13786
    return-void

    .line 13783
    :catch_7d
    move-exception v0

    goto :goto_85

    :catch_7f
    move-exception v0

    move/from16 v4, p3

    goto :goto_85

    :catch_83
    move-exception v0

    move v4, v15

    .line 13784
    .local v0, "e":Landroid/os/RemoteException;
    :goto_85
    invoke-virtual {v0}, Landroid/os/RemoteException;->rethrowFromSystemServer()Ljava/lang/RuntimeException;

    move-result-object v3

    throw v3
.end method

.method private sendDistractingPackagesChanged([Ljava/lang/String;[III)V
    .registers 16
    .param p1, "pkgList"  # [Ljava/lang/String;
    .param p2, "uidList"  # [I
    .param p3, "userId"  # I
    .param p4, "distractionFlags"  # I

    .line 13944
    new-instance v0, Landroid/os/Bundle;

    const/4 v1, 0x3

    invoke-direct {v0, v1}, Landroid/os/Bundle;-><init>(I)V

    .line 13945
    .local v0, "extras":Landroid/os/Bundle;
    const-string v1, "android.intent.extra.changed_package_list"

    invoke-virtual {v0, v1, p1}, Landroid/os/Bundle;->putStringArray(Ljava/lang/String;[Ljava/lang/String;)V

    .line 13946
    const-string v1, "android.intent.extra.changed_uid_list"

    invoke-virtual {v0, v1, p2}, Landroid/os/Bundle;->putIntArray(Ljava/lang/String;[I)V

    .line 13947
    const-string v1, "android.intent.extra.distraction_restrictions"

    invoke-virtual {v0, v1, p4}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V

    .line 13948
    const/4 v1, 0x1

    new-array v9, v1, [I

    const/4 v1, 0x0

    aput p3, v9, v1

    const-string v3, "android.intent.action.DISTRACTING_PACKAGES_CHANGED"

    const/4 v4, 0x0

    const/high16 v6, 0x40000000  # 2.0f

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v10, 0x0

    move-object v2, p0

    move-object v5, v0

    invoke-virtual/range {v2 .. v10}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 13950
    return-void
.end method

.method private sendFirstLaunchBroadcast(Ljava/lang/String;Ljava/lang/String;[I[I)V
    .registers 14
    .param p1, "pkgName"  # Ljava/lang/String;
    .param p2, "installerPkg"  # Ljava/lang/String;
    .param p3, "userIds"  # [I
    .param p4, "instantUserIds"  # [I

    .line 15418
    const-string v1, "android.intent.action.PACKAGE_FIRST_LAUNCH"

    const/4 v3, 0x0

    const/4 v4, 0x0

    const/4 v6, 0x0

    move-object v0, p0

    move-object v2, p1

    move-object v5, p2

    move-object v7, p3

    move-object v8, p4

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 15420
    return-void
.end method

.method private sendMyPackageSuspendedOrUnsuspended([Ljava/lang/String;ZLandroid/os/PersistableBundle;I)V
    .registers 16
    .param p1, "affectedPackages"  # [Ljava/lang/String;
    .param p2, "suspended"  # Z
    .param p3, "appExtras"  # Landroid/os/PersistableBundle;
    .param p4, "userId"  # I

    .line 14407
    new-instance v0, Landroid/os/Bundle;

    invoke-direct {v0}, Landroid/os/Bundle;-><init>()V

    .line 14408
    .local v0, "intentExtras":Landroid/os/Bundle;
    if-eqz p2, :cond_1b

    .line 14409
    const-string v1, "android.intent.action.MY_PACKAGE_SUSPENDED"

    .line 14410
    .local v1, "action":Ljava/lang/String;
    if-eqz p3, :cond_19

    .line 14411
    new-instance v2, Landroid/os/Bundle;

    invoke-virtual {p3}, Landroid/os/PersistableBundle;->deepCopy()Landroid/os/PersistableBundle;

    move-result-object v3

    invoke-direct {v2, v3}, Landroid/os/Bundle;-><init>(Landroid/os/PersistableBundle;)V

    .line 14412
    .local v2, "bundledAppExtras":Landroid/os/Bundle;
    const-string v3, "android.intent.extra.SUSPENDED_PACKAGE_EXTRAS"

    invoke-virtual {v0, v3, v2}, Landroid/os/Bundle;->putBundle(Ljava/lang/String;Landroid/os/Bundle;)V

    .line 14417
    .end local v2  # "bundledAppExtras":Landroid/os/Bundle;
    :cond_19
    move-object v8, v1

    goto :goto_1e

    .line 14415
    .end local v1  # "action":Ljava/lang/String;
    :cond_1b
    const-string v1, "android.intent.action.MY_PACKAGE_UNSUSPENDED"

    move-object v8, v1

    .line 14417
    .local v8, "action":Ljava/lang/String;
    :goto_1e
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v10, Lcom/android/server/pm/-$$Lambda$PackageManagerService$lmWx5KdKJSi601pB8nl6c_pFRXI;

    move-object v1, v10

    move-object v2, p0

    move v3, p2

    move v4, p4

    move-object v5, p1

    move-object v6, v8

    move-object v7, v0

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$lmWx5KdKJSi601pB8nl6c_pFRXI;-><init>(Lcom/android/server/pm/PackageManagerService;ZI[Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;)V

    invoke-virtual {v9, v10}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 14435
    return-void
.end method

.method private sendPackageAddedForUser(Ljava/lang/String;Lcom/android/server/pm/PackageSetting;I)V
    .registers 14
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "pkgSetting"  # Lcom/android/server/pm/PackageSetting;
    .param p3, "userId"  # I

    .line 13712
    invoke-static {p2}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Lcom/android/server/pm/PackageSetting;)Z

    move-result v0

    const/4 v1, 0x0

    const/4 v2, 0x1

    if-nez v0, :cond_11

    invoke-static {p2}, Lcom/android/server/pm/PackageManagerService;->isUpdatedSystemApp(Lcom/android/server/pm/PackageSetting;)Z

    move-result v0

    if-eqz v0, :cond_f

    goto :goto_11

    :cond_f
    move v5, v1

    goto :goto_12

    :cond_11
    :goto_11
    move v5, v2

    .line 13713
    .local v5, "isSystem":Z
    :goto_12
    invoke-virtual {p2, p3}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v0

    .line 13714
    .local v0, "isInstantApp":Z
    if-eqz v0, :cond_1b

    sget-object v3, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    goto :goto_1f

    :cond_1b
    new-array v3, v2, [I

    aput p3, v3, v1

    :goto_1f
    move-object v8, v3

    .line 13715
    .local v8, "userIds":[I
    if-eqz v0, :cond_28

    new-array v2, v2, [I

    aput p3, v2, v1

    move-object v9, v2

    goto :goto_2b

    :cond_28
    sget-object v1, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    move-object v9, v1

    .line 13716
    .local v9, "instantUserIds":[I
    :goto_2b
    const/4 v6, 0x0

    iget v7, p2, Lcom/android/server/pm/PackageSetting;->appId:I

    move-object v3, p0

    move-object v4, p1

    invoke-virtual/range {v3 .. v9}, Lcom/android/server/pm/PackageManagerService;->sendPackageAddedForNewUsers(Ljava/lang/String;ZZI[I[I)V

    .line 13720
    new-instance v1, Landroid/content/pm/PackageInstaller$SessionInfo;

    invoke-direct {v1}, Landroid/content/pm/PackageInstaller$SessionInfo;-><init>()V

    .line 13721
    .local v1, "info":Landroid/content/pm/PackageInstaller$SessionInfo;
    invoke-virtual {p2, p3}, Lcom/android/server/pm/PackageSetting;->getInstallReason(I)I

    move-result v2

    iput v2, v1, Landroid/content/pm/PackageInstaller$SessionInfo;->installReason:I

    .line 13722
    iput-object p1, v1, Landroid/content/pm/PackageInstaller$SessionInfo;->appPackageName:Ljava/lang/String;

    .line 13723
    invoke-virtual {p0, v1, p3}, Lcom/android/server/pm/PackageManagerService;->sendSessionCommitBroadcast(Landroid/content/pm/PackageInstaller$SessionInfo;I)V

    .line 13724
    return-void
.end method

.method private sendPackageChangedBroadcast(Ljava/lang/String;ZLjava/util/ArrayList;I)V
    .registers 23
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "killFlag"  # Z
    .param p4, "packageUid"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Z",
            "Ljava/util/ArrayList<",
            "Ljava/lang/String;",
            ">;I)V"
        }
    .end annotation

    .line 22446
    .local p3, "componentNames":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    move-object/from16 v9, p1

    move-object/from16 v10, p3

    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_26

    .line 22447
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Sending package changed: package="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " components="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 22449
    :cond_26
    new-instance v0, Landroid/os/Bundle;

    const/4 v1, 0x4

    invoke-direct {v0, v1}, Landroid/os/Bundle;-><init>(I)V

    move-object v11, v0

    .line 22450
    .local v11, "extras":Landroid/os/Bundle;
    const/4 v0, 0x0

    invoke-virtual {v10, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/lang/String;

    const-string v2, "android.intent.extra.changed_component_name"

    invoke-virtual {v11, v2, v1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 22451
    invoke-virtual/range {p3 .. p3}, Ljava/util/ArrayList;->size()I

    move-result v1

    new-array v12, v1, [Ljava/lang/String;

    .line 22452
    .local v12, "nameList":[Ljava/lang/String;
    invoke-virtual {v10, v12}, Ljava/util/ArrayList;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    .line 22453
    const-string v1, "android.intent.extra.changed_component_name_list"

    invoke-virtual {v11, v1, v12}, Landroid/os/Bundle;->putStringArray(Ljava/lang/String;[Ljava/lang/String;)V

    .line 22454
    const-string v1, "android.intent.extra.DONT_KILL_APP"

    move/from16 v13, p2

    invoke-virtual {v11, v1, v13}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V

    .line 22455
    const-string v1, "android.intent.extra.UID"

    move/from16 v14, p4

    invoke-virtual {v11, v1, v14}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V

    .line 22459
    invoke-virtual {v10, v9}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v1

    if-nez v1, :cond_5f

    .line 22460
    const/high16 v1, 0x40000000  # 2.0f

    move v4, v1

    goto :goto_60

    :cond_5f
    move v4, v0

    .line 22461
    .local v4, "flags":I
    :goto_60
    invoke-static/range {p4 .. p4}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v15

    .line 22462
    .local v15, "userId":I
    move-object/from16 v6, p0

    invoke-virtual {v6, v9, v15}, Lcom/android/server/pm/PackageManagerService;->isInstantApp(Ljava/lang/String;I)Z

    move-result v16

    .line 22463
    .local v16, "isInstantApp":Z
    const/4 v1, 0x1

    if-eqz v16, :cond_70

    sget-object v2, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    goto :goto_74

    :cond_70
    new-array v2, v1, [I

    aput v15, v2, v0

    :goto_74
    move-object v7, v2

    .line 22464
    .local v7, "userIds":[I
    if-eqz v16, :cond_7d

    new-array v1, v1, [I

    aput v15, v1, v0

    move-object v8, v1

    goto :goto_80

    :cond_7d
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    move-object v8, v0

    .line 22465
    .local v8, "instantUserIds":[I
    :goto_80
    const/4 v5, 0x0

    const/16 v17, 0x0

    const-string v1, "android.intent.action.PACKAGE_CHANGED"

    move-object/from16 v0, p0

    move-object/from16 v2, p1

    move-object v3, v11

    move-object/from16 v6, v17

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 22467
    return-void
.end method

.method private sendPackagesSuspendedForUser([Ljava/lang/String;[IIZLandroid/os/PersistableBundle;)V
    .registers 19
    .param p1, "pkgList"  # [Ljava/lang/String;
    .param p2, "uidList"  # [I
    .param p3, "userId"  # I
    .param p4, "suspended"  # Z
    .param p5, "launcherExtras"  # Landroid/os/PersistableBundle;

    .line 13954
    new-instance v0, Landroid/os/Bundle;

    const/4 v1, 0x3

    invoke-direct {v0, v1}, Landroid/os/Bundle;-><init>(I)V

    .line 13955
    .local v0, "extras":Landroid/os/Bundle;
    const-string v1, "android.intent.extra.changed_package_list"

    move-object v11, p1

    invoke-virtual {v0, v1, p1}, Landroid/os/Bundle;->putStringArray(Ljava/lang/String;[Ljava/lang/String;)V

    .line 13956
    const-string v1, "android.intent.extra.changed_uid_list"

    move-object v12, p2

    invoke-virtual {v0, v1, p2}, Landroid/os/Bundle;->putIntArray(Ljava/lang/String;[I)V

    .line 13957
    if-eqz p5, :cond_22

    .line 13958
    new-instance v1, Landroid/os/Bundle;

    .line 13959
    invoke-virtual/range {p5 .. p5}, Landroid/os/PersistableBundle;->deepCopy()Landroid/os/PersistableBundle;

    move-result-object v2

    invoke-direct {v1, v2}, Landroid/os/Bundle;-><init>(Landroid/os/PersistableBundle;)V

    .line 13958
    const-string v2, "android.intent.extra.LAUNCHER_EXTRAS"

    invoke-virtual {v0, v2, v1}, Landroid/os/Bundle;->putBundle(Ljava/lang/String;Landroid/os/Bundle;)V

    .line 13961
    :cond_22
    nop

    .line 13962
    if-eqz p4, :cond_29

    const-string v1, "android.intent.action.PACKAGES_SUSPENDED"

    move-object v3, v1

    goto :goto_2c

    .line 13963
    :cond_29
    const-string v1, "android.intent.action.PACKAGES_UNSUSPENDED"

    move-object v3, v1

    :goto_2c
    const/4 v4, 0x0

    const/high16 v6, 0x40000000  # 2.0f

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v1, 0x1

    new-array v9, v1, [I

    const/4 v1, 0x0

    aput p3, v9, v1

    const/4 v10, 0x0

    .line 13961
    move-object v2, p0

    move-object v5, v0

    invoke-virtual/range {v2 .. v10}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 13966
    return-void
.end method

.method private sendResourcesChangedBroadcast(ZZLjava/util/ArrayList;Landroid/content/IIntentReceiver;)V
    .registers 14
    .param p1, "mediaStatus"  # Z
    .param p2, "replacing"  # Z
    .param p4, "finishedReceiver"  # Landroid/content/IIntentReceiver;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(ZZ",
            "Ljava/util/ArrayList<",
            "Landroid/content/pm/ApplicationInfo;",
            ">;",
            "Landroid/content/IIntentReceiver;",
            ")V"
        }
    .end annotation

    .line 23564
    .local p3, "infos":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    invoke-virtual {p3}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 23565
    .local v0, "size":I
    new-array v7, v0, [Ljava/lang/String;

    .line 23566
    .local v7, "packageNames":[Ljava/lang/String;
    new-array v8, v0, [I

    .line 23567
    .local v8, "packageUids":[I
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_9
    if-ge v1, v0, :cond_1c

    .line 23568
    invoke-virtual {p3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ApplicationInfo;

    .line 23569
    .local v2, "info":Landroid/content/pm/ApplicationInfo;
    iget-object v3, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    aput-object v3, v7, v1

    .line 23570
    iget v3, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    aput v3, v8, v1

    .line 23567
    .end local v2  # "info":Landroid/content/pm/ApplicationInfo;
    add-int/lit8 v1, v1, 0x1

    goto :goto_9

    .line 23572
    .end local v1  # "i":I
    :cond_1c
    move-object v1, p0

    move v2, p1

    move v3, p2

    move-object v4, v7

    move-object v5, v8

    move-object v6, p4

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->sendResourcesChangedBroadcast(ZZ[Ljava/lang/String;[ILandroid/content/IIntentReceiver;)V

    .line 23574
    return-void
.end method

.method private sendResourcesChangedBroadcast(ZZLjava/util/ArrayList;[ILandroid/content/IIntentReceiver;)V
    .registers 13
    .param p1, "mediaStatus"  # Z
    .param p2, "replacing"  # Z
    .param p4, "uidArr"  # [I
    .param p5, "finishedReceiver"  # Landroid/content/IIntentReceiver;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(ZZ",
            "Ljava/util/ArrayList<",
            "Ljava/lang/String;",
            ">;[I",
            "Landroid/content/IIntentReceiver;",
            ")V"
        }
    .end annotation

    .line 23578
    .local p3, "pkgList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    nop

    .line 23579
    invoke-virtual {p3}, Ljava/util/ArrayList;->size()I

    move-result v0

    new-array v0, v0, [Ljava/lang/String;

    invoke-virtual {p3, v0}, Ljava/util/ArrayList;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v0

    move-object v4, v0

    check-cast v4, [Ljava/lang/String;

    .line 23578
    move-object v1, p0

    move v2, p1

    move v3, p2

    move-object v5, p4

    move-object v6, p5

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->sendResourcesChangedBroadcast(ZZ[Ljava/lang/String;[ILandroid/content/IIntentReceiver;)V

    .line 23580
    return-void
.end method

.method private sendResourcesChangedBroadcast(ZZ[Ljava/lang/String;[ILandroid/content/IIntentReceiver;)V
    .registers 20
    .param p1, "mediaStatus"  # Z
    .param p2, "replacing"  # Z
    .param p3, "pkgList"  # [Ljava/lang/String;
    .param p4, "uidArr"  # [I
    .param p5, "finishedReceiver"  # Landroid/content/IIntentReceiver;

    .line 23584
    move/from16 v0, p2

    move-object/from16 v1, p3

    move-object/from16 v2, p4

    array-length v3, v1

    .line 23585
    .local v3, "size":I
    if-lez v3, :cond_37

    .line 23587
    new-instance v4, Landroid/os/Bundle;

    invoke-direct {v4}, Landroid/os/Bundle;-><init>()V

    .line 23588
    .local v4, "extras":Landroid/os/Bundle;
    const-string v5, "android.intent.extra.changed_package_list"

    invoke-virtual {v4, v5, v1}, Landroid/os/Bundle;->putStringArray(Ljava/lang/String;[Ljava/lang/String;)V

    .line 23589
    if-eqz v2, :cond_1a

    .line 23590
    const-string v5, "android.intent.extra.changed_uid_list"

    invoke-virtual {v4, v5, v2}, Landroid/os/Bundle;->putIntArray(Ljava/lang/String;[I)V

    .line 23592
    :cond_1a
    if-eqz v0, :cond_21

    .line 23593
    const-string v5, "android.intent.extra.REPLACING"

    invoke-virtual {v4, v5, v0}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V

    .line 23595
    :cond_21
    if-eqz p1, :cond_27

    const-string v5, "android.intent.action.EXTERNAL_APPLICATIONS_AVAILABLE"

    move-object v6, v5

    goto :goto_2a

    .line 23596
    :cond_27
    const-string v5, "android.intent.action.EXTERNAL_APPLICATIONS_UNAVAILABLE"

    move-object v6, v5

    :goto_2a
    nop

    .line 23597
    .local v6, "action":Ljava/lang/String;
    const/4 v7, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object v5, p0

    move-object v8, v4

    move-object/from16 v11, p5

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 23599
    .end local v4  # "extras":Landroid/os/Bundle;
    .end local v6  # "action":Ljava/lang/String;
    :cond_37
    return-void
.end method

.method private static setBundledAppAbi(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;Ljava/lang/String;)V
    .registers 11
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "apkRoot"  # Ljava/lang/String;
    .param p2, "apkName"  # Ljava/lang/String;

    .line 13278
    new-instance v0, Ljava/io/File;

    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-direct {v0, v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 13282
    .local v0, "codeFile":Ljava/io/File;
    invoke-static {v0}, Landroid/content/pm/PackageParser;->isApkFile(Ljava/io/File;)Z

    move-result v1

    const-string/jumbo v2, "lib"

    const/4 v3, 0x0

    if-eqz v1, :cond_3c

    .line 13284
    new-instance v1, Ljava/io/File;

    new-instance v4, Ljava/io/File;

    const-string/jumbo v5, "lib64"

    invoke-direct {v4, v5, p2}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v4}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v1, p1, v4}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v1}, Ljava/io/File;->exists()Z

    move-result v1

    .line 13285
    .local v1, "has64BitLibs":Z
    new-instance v4, Ljava/io/File;

    new-instance v5, Ljava/io/File;

    invoke-direct {v5, v2, p2}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v5}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v4, p1, v2}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v4}, Ljava/io/File;->exists()Z

    move-result v2

    move v7, v2

    move v2, v1

    move v1, v7

    .local v2, "has32BitLibs":Z
    goto :goto_8c

    .line 13288
    .end local v1  # "has64BitLibs":Z
    .end local v2  # "has32BitLibs":Z
    :cond_3c
    new-instance v1, Ljava/io/File;

    invoke-direct {v1, v0, v2}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 13289
    .local v1, "rootDir":Ljava/io/File;
    sget-object v2, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    invoke-static {v2}, Lcom/android/internal/util/ArrayUtils;->isEmpty([Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_65

    sget-object v2, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    aget-object v2, v2, v3

    .line 13290
    invoke-static {v2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v2

    if-nez v2, :cond_65

    .line 13291
    sget-object v2, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    aget-object v2, v2, v3

    invoke-static {v2}, Ldalvik/system/VMRuntime;->getInstructionSet(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 13292
    .local v2, "isa":Ljava/lang/String;
    new-instance v4, Ljava/io/File;

    invoke-direct {v4, v1, v2}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v4}, Ljava/io/File;->exists()Z

    move-result v2

    .line 13293
    .local v2, "has64BitLibs":Z
    goto :goto_66

    .line 13294
    .end local v2  # "has64BitLibs":Z
    :cond_65
    const/4 v2, 0x0

    .line 13296
    .restart local v2  # "has64BitLibs":Z
    :goto_66
    sget-object v4, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    invoke-static {v4}, Lcom/android/internal/util/ArrayUtils;->isEmpty([Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_8b

    sget-object v4, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    aget-object v4, v4, v3

    .line 13297
    invoke-static {v4}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v4

    if-nez v4, :cond_8b

    .line 13298
    sget-object v4, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    aget-object v4, v4, v3

    invoke-static {v4}, Ldalvik/system/VMRuntime;->getInstructionSet(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    .line 13299
    .local v4, "isa":Ljava/lang/String;
    new-instance v5, Ljava/io/File;

    invoke-direct {v5, v1, v4}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v5}, Ljava/io/File;->exists()Z

    move-result v4

    .line 13300
    .local v4, "has32BitLibs":Z
    move v1, v4

    goto :goto_8c

    .line 13301
    .end local v4  # "has32BitLibs":Z
    :cond_8b
    const/4 v1, 0x0

    .line 13305
    .local v1, "has32BitLibs":Z
    :goto_8c
    const/4 v4, 0x0

    if-eqz v2, :cond_9e

    if-nez v1, :cond_9e

    .line 13310
    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    sget-object v6, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    aget-object v3, v6, v3

    iput-object v3, v5, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 13311
    iget-object v3, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v4, v3, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    goto :goto_10b

    .line 13312
    :cond_9e
    if-eqz v1, :cond_af

    if-nez v2, :cond_af

    .line 13316
    iget-object v5, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    sget-object v6, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    aget-object v3, v6, v3

    iput-object v3, v5, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 13317
    iget-object v3, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v4, v3, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    goto :goto_10b

    .line 13318
    :cond_af
    if-eqz v1, :cond_103

    if-eqz v2, :cond_103

    .line 13326
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    const/high16 v5, -0x80000000

    and-int/2addr v4, v5

    if-nez v4, :cond_d7

    .line 13327
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Package "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v5, " has multiple bundled libs, but is not multiarch."

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v5, "PackageManager"

    invoke-static {v5, v4}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 13330
    :cond_d7
    invoke-static {}, Lcom/android/server/pm/InstructionSets;->getPreferredInstructionSet()Ljava/lang/String;

    move-result-object v4

    invoke-static {v4}, Ldalvik/system/VMRuntime;->is64BitInstructionSet(Ljava/lang/String;)Z

    move-result v4

    if-eqz v4, :cond_f2

    .line 13331
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    sget-object v5, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    aget-object v5, v5, v3

    iput-object v5, v4, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 13332
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    sget-object v5, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    aget-object v3, v5, v3

    iput-object v3, v4, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    goto :goto_10b

    .line 13334
    :cond_f2
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    sget-object v5, Landroid/os/Build;->SUPPORTED_32_BIT_ABIS:[Ljava/lang/String;

    aget-object v5, v5, v3

    iput-object v5, v4, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 13335
    iget-object v4, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    sget-object v5, Landroid/os/Build;->SUPPORTED_64_BIT_ABIS:[Ljava/lang/String;

    aget-object v3, v5, v3

    iput-object v3, v4, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    goto :goto_10b

    .line 13338
    :cond_103
    iget-object v3, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v4, v3, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    .line 13339
    iget-object v3, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v4, v3, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    .line 13341
    :goto_10b
    return-void
.end method

.method private static setBundledAppAbisAndRoots(Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/PackageSetting;)V
    .registers 5
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "pkgSetting"  # Lcom/android/server/pm/PackageSetting;

    .line 13251
    iget-object v0, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v0}, Landroid/content/pm/ApplicationInfo;->getCodePath()Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->deriveCodePathName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    .line 13255
    .local v0, "apkName":Ljava/lang/String;
    iget-object v1, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    invoke-static {v1}, Lcom/android/server/pm/PackageManagerService;->calculateBundledApkRoot(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    .line 13256
    .local v1, "apkRoot":Ljava/lang/String;
    invoke-static {p0, v1, v0}, Lcom/android/server/pm/PackageManagerService;->setBundledAppAbi(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;Ljava/lang/String;)V

    .line 13263
    if-eqz p1, :cond_23

    .line 13264
    iget-object v2, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->primaryCpuAbi:Ljava/lang/String;

    iput-object v2, p1, Lcom/android/server/pm/PackageSetting;->primaryCpuAbiString:Ljava/lang/String;

    .line 13265
    iget-object v2, p0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    iput-object v2, p1, Lcom/android/server/pm/PackageSetting;->secondaryCpuAbiString:Ljava/lang/String;

    .line 13267
    :cond_23
    return-void
.end method

.method private setDefaultBrowserAsyncLPw(Ljava/lang/String;I)V
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 15032
    const/4 v0, -0x1

    if-ne p2, v0, :cond_4

    .line 15033
    return-void

    .line 15035
    :cond_4
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultBrowserProvider:Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;

    if-nez v0, :cond_11

    .line 15036
    const-string v0, "PackageManager"

    const-string/jumbo v1, "mDefaultBrowserProvider is null"

    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 15037
    return-void

    .line 15039
    :cond_11
    invoke-interface {v0, p1, p2}, Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;->setDefaultBrowserAsync(Ljava/lang/String;I)V

    .line 15040
    if-eqz p1, :cond_23

    .line 15041
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 15042
    :try_start_19
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->grantDefaultPermissionsToDefaultBrowser(Ljava/lang/String;I)V

    .line 15044
    monitor-exit v0

    goto :goto_23

    :catchall_20
    move-exception v1

    monitor-exit v0
    :try_end_22
    .catchall {:try_start_19 .. :try_end_22} :catchall_20

    throw v1

    .line 15046
    :cond_23
    :goto_23
    return-void
.end method

.method private setEnableRollbackCode(II)V
    .registers 5
    .param p1, "token"  # I
    .param p2, "enableRollbackCode"  # I

    .line 14795
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v1, 0x15

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 14796
    .local v0, "msg":Landroid/os/Message;
    iput p1, v0, Landroid/os/Message;->arg1:I

    .line 14797
    iput p2, v0, Landroid/os/Message;->arg2:I

    .line 14798
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v1, v0}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 14799
    return-void
.end method

.method private setEnabledSetting(Ljava/lang/String;Ljava/lang/String;IIILjava/lang/String;)V
    .registers 31
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "className"  # Ljava/lang/String;
    .param p3, "newState"  # I
    .param p4, "flags"  # I
    .param p5, "userId"  # I
    .param p6, "callingPackage"  # Ljava/lang/String;

    .line 22210
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move-object/from16 v3, p2

    move/from16 v4, p3

    move/from16 v11, p5

    const/4 v0, 0x2

    const/4 v12, 0x3

    const/4 v13, 0x1

    if-eqz v4, :cond_30

    if-eq v4, v13, :cond_30

    if-eq v4, v0, :cond_30

    if-eq v4, v12, :cond_30

    const/4 v5, 0x4

    if-ne v4, v5, :cond_19

    goto :goto_30

    .line 22215
    :cond_19
    new-instance v0, Ljava/lang/IllegalArgumentException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Invalid new component state: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v0, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 22219
    :cond_30
    :goto_30
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v14

    .line 22221
    .local v14, "callingUid":I
    const/16 v5, 0x3e8

    if-ne v14, v5, :cond_3b

    .line 22222
    const/4 v5, 0x0

    move v15, v5

    .local v5, "permission":I
    goto :goto_44

    .line 22224
    .end local v5  # "permission":I
    :cond_3b
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v6, "android.permission.CHANGE_COMPONENT_ENABLED_STATE"

    invoke-virtual {v5, v6}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v5

    move v15, v5

    .line 22227
    .local v15, "permission":I
    :goto_44
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v8, 0x0

    const/4 v9, 0x1

    const-string/jumbo v10, "set enabled"

    move v6, v14

    move/from16 v7, p5

    invoke-virtual/range {v5 .. v10}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 22229
    if-nez v15, :cond_55

    move v6, v13

    goto :goto_56

    :cond_55
    const/4 v6, 0x0

    .line 22230
    .local v6, "allowedByPermission":Z
    :goto_56
    const/4 v7, 0x0

    .line 22231
    .local v7, "sendNow":Z
    if-nez v3, :cond_5b

    move v8, v13

    goto :goto_5c

    :cond_5b
    const/4 v8, 0x0

    .line 22232
    .local v8, "isApp":Z
    :goto_5c
    invoke-direct {v1, v14}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_64

    move v9, v13

    goto :goto_65

    :cond_64
    const/4 v9, 0x0

    .line 22233
    .local v9, "isCallerInstantApp":Z
    :goto_65
    if-eqz v8, :cond_69

    move-object v10, v2

    goto :goto_6a

    :cond_69
    move-object v10, v3

    .line 22237
    .local v10, "componentName":Ljava/lang/String;
    :goto_6a
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 22238
    :try_start_6d
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;
    :try_end_77
    .catchall {:try_start_6d .. :try_end_77} :catchall_37f

    move-object/from16 v18, v0

    .line 22239
    .local v18, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v13, v18

    .end local v18  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v13, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-nez v13, :cond_125

    .line 22240
    if-nez v9, :cond_c7

    .line 22241
    if-nez v3, :cond_a1

    .line 22242
    :try_start_81
    new-instance v0, Ljava/lang/IllegalArgumentException;

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V
    :try_end_88
    .catchall {:try_start_81 .. :try_end_88} :catchall_9a

    move/from16 v18, v7

    .end local v7  # "sendNow":Z
    .local v18, "sendNow":Z
    :try_start_8a
    const-string v7, "Unknown package: "

    invoke-virtual {v12, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v0, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v6  # "allowedByPermission":Z
    .end local v8  # "isApp":Z
    .end local v9  # "isCallerInstantApp":Z
    .end local v10  # "componentName":Ljava/lang/String;
    .end local v14  # "callingUid":I
    .end local v15  # "permission":I
    .end local v18  # "sendNow":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "className":Ljava/lang/String;
    .end local p3  # "newState":I
    .end local p4  # "flags":I
    .end local p5  # "userId":I
    .end local p6  # "callingPackage":Ljava/lang/String;
    throw v0

    .line 22257
    .end local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "allowedByPermission":Z
    .restart local v7  # "sendNow":Z
    .restart local v8  # "isApp":Z
    .restart local v9  # "isCallerInstantApp":Z
    .restart local v10  # "componentName":Ljava/lang/String;
    .restart local v14  # "callingUid":I
    .restart local v15  # "permission":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "className":Ljava/lang/String;
    .restart local p3  # "newState":I
    .restart local p4  # "flags":I
    .restart local p5  # "userId":I
    .restart local p6  # "callingPackage":Ljava/lang/String;
    :catchall_9a
    move-exception v0

    move/from16 v18, v7

    move/from16 v19, v8

    .end local v7  # "sendNow":Z
    .restart local v18  # "sendNow":Z
    goto/16 :goto_384

    .line 22244
    .end local v18  # "sendNow":Z
    .restart local v7  # "sendNow":Z
    .restart local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_a1
    move/from16 v18, v7

    .end local v7  # "sendNow":Z
    .restart local v18  # "sendNow":Z
    new-instance v0, Ljava/lang/IllegalArgumentException;

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Unknown component: "

    invoke-virtual {v7, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, "/"

    invoke-virtual {v7, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v0, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v6  # "allowedByPermission":Z
    .end local v8  # "isApp":Z
    .end local v9  # "isCallerInstantApp":Z
    .end local v10  # "componentName":Ljava/lang/String;
    .end local v14  # "callingUid":I
    .end local v15  # "permission":I
    .end local v18  # "sendNow":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "className":Ljava/lang/String;
    .end local p3  # "newState":I
    .end local p4  # "flags":I
    .end local p5  # "userId":I
    .end local p6  # "callingPackage":Ljava/lang/String;
    throw v0
    :try_end_c2
    .catchall {:try_start_8a .. :try_end_c2} :catchall_c2

    .line 22257
    .end local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "allowedByPermission":Z
    .restart local v8  # "isApp":Z
    .restart local v9  # "isCallerInstantApp":Z
    .restart local v10  # "componentName":Ljava/lang/String;
    .restart local v14  # "callingUid":I
    .restart local v15  # "permission":I
    .restart local v18  # "sendNow":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "className":Ljava/lang/String;
    .restart local p3  # "newState":I
    .restart local p4  # "flags":I
    .restart local p5  # "userId":I
    .restart local p6  # "callingPackage":Ljava/lang/String;
    :catchall_c2
    move-exception v0

    move/from16 v19, v8

    goto/16 :goto_384

    .line 22248
    .end local v18  # "sendNow":Z
    .restart local v7  # "sendNow":Z
    .restart local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_c7
    move/from16 v18, v7

    .end local v7  # "sendNow":Z
    .restart local v18  # "sendNow":Z
    :try_start_c9
    new-instance v0, Ljava/lang/SecurityException;

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Attempt to change component state; pid="

    invoke-virtual {v7, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 22250
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v12

    invoke-virtual {v7, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v12, ", uid="

    invoke-virtual {v7, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 22252
    if-nez v3, :cond_fa

    .line 22253
    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V
    :try_end_eb
    .catchall {:try_start_c9 .. :try_end_eb} :catchall_120

    move/from16 v19, v8

    .end local v8  # "isApp":Z
    .local v19, "isApp":Z
    :try_start_ed
    const-string v8, ", package="

    invoke-virtual {v12, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    goto :goto_115

    .line 22254
    .end local v19  # "isApp":Z
    .restart local v8  # "isApp":Z
    :cond_fa
    move/from16 v19, v8

    .end local v8  # "isApp":Z
    .restart local v19  # "isApp":Z
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, ", component="

    invoke-virtual {v8, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, "/"

    invoke-virtual {v8, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    :goto_115
    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v0, v7}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v6  # "allowedByPermission":Z
    .end local v9  # "isCallerInstantApp":Z
    .end local v10  # "componentName":Ljava/lang/String;
    .end local v14  # "callingUid":I
    .end local v15  # "permission":I
    .end local v18  # "sendNow":Z
    .end local v19  # "isApp":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "className":Ljava/lang/String;
    .end local p3  # "newState":I
    .end local p4  # "flags":I
    .end local p5  # "userId":I
    .end local p6  # "callingPackage":Ljava/lang/String;
    throw v0

    .line 22257
    .end local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "allowedByPermission":Z
    .restart local v8  # "isApp":Z
    .restart local v9  # "isCallerInstantApp":Z
    .restart local v10  # "componentName":Ljava/lang/String;
    .restart local v14  # "callingUid":I
    .restart local v15  # "permission":I
    .restart local v18  # "sendNow":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "className":Ljava/lang/String;
    .restart local p3  # "newState":I
    .restart local p4  # "flags":I
    .restart local p5  # "userId":I
    .restart local p6  # "callingPackage":Ljava/lang/String;
    :catchall_120
    move-exception v0

    move/from16 v19, v8

    .end local v8  # "isApp":Z
    .restart local v19  # "isApp":Z
    goto/16 :goto_384

    .end local v18  # "sendNow":Z
    .end local v19  # "isApp":Z
    .restart local v7  # "sendNow":Z
    .restart local v8  # "isApp":Z
    .restart local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_125
    move/from16 v18, v7

    move/from16 v19, v8

    .end local v7  # "sendNow":Z
    .end local v8  # "isApp":Z
    .restart local v18  # "sendNow":Z
    .restart local v19  # "isApp":Z
    monitor-exit v5
    :try_end_12a
    .catchall {:try_start_ed .. :try_end_12a} :catchall_386

    .line 22260
    iget v5, v13, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-static {v14, v5}, Landroid/os/UserHandle;->isSameApp(II)Z

    move-result v5

    if-nez v5, :cond_1ae

    .line 22262
    if-eqz v6, :cond_15b

    .line 22263
    invoke-direct {v1, v13, v14, v11}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v5

    if-eqz v5, :cond_13b

    goto :goto_15b

    .line 22273
    :cond_13b
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mProtectedPackages:Lcom/android/server/pm/ProtectedPackages;

    invoke-virtual {v5, v11, v2}, Lcom/android/server/pm/ProtectedPackages;->isPackageStateProtected(ILjava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_144

    goto :goto_1ae

    .line 22274
    :cond_144
    new-instance v0, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Cannot disable a protected package: "

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v0, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 22264
    :cond_15b
    :goto_15b
    new-instance v0, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Attempt to change component state; pid="

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 22266
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v7

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v7, ", uid="

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 22268
    if-nez v3, :cond_18a

    .line 22269
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, ", package="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    goto :goto_1a3

    .line 22270
    :cond_18a
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, ", component="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, "/"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    :goto_1a3
    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v0, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 22279
    :cond_1ae
    :goto_1ae
    sget-object v5, Landroid/content/pm/PackageManager;->APP_DETAILS_ACTIVITY_CLASS_NAME:Ljava/lang/String;

    invoke-virtual {v5, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_1c1

    if-eqz v6, :cond_1b9

    goto :goto_1c1

    .line 22281
    :cond_1b9
    new-instance v0, Ljava/lang/SecurityException;

    const-string v5, "Cannot disable a system-generated component"

    invoke-direct {v0, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 22284
    :cond_1c1
    :goto_1c1
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v7

    .line 22285
    const/16 v5, 0x7d0

    if-ne v14, v5, :cond_20a

    :try_start_1c8
    iget v5, v13, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    and-int/lit16 v5, v5, 0x100

    if-nez v5, :cond_20a

    .line 22289
    invoke-virtual {v13, v11}, Lcom/android/server/pm/PackageSetting;->getEnabled(I)I

    move-result v5

    .line 22290
    .local v5, "oldState":I
    if-nez v3, :cond_1e3

    if-eq v5, v12, :cond_1db

    if-eqz v5, :cond_1db

    const/4 v0, 0x1

    if-ne v5, v0, :cond_1e3

    :cond_1db
    if-eq v4, v12, :cond_1e2

    if-eqz v4, :cond_1e2

    const/4 v0, 0x1

    if-ne v4, v0, :cond_1e3

    :cond_1e2
    goto :goto_20a

    .line 22301
    :cond_1e3
    new-instance v0, Ljava/lang/SecurityException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Shell cannot change component state for "

    invoke-virtual {v8, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, "/"

    invoke-virtual {v8, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, " to "

    invoke-virtual {v8, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-direct {v0, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v6  # "allowedByPermission":Z
    .end local v9  # "isCallerInstantApp":Z
    .end local v10  # "componentName":Ljava/lang/String;
    .end local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v14  # "callingUid":I
    .end local v15  # "permission":I
    .end local v18  # "sendNow":Z
    .end local v19  # "isApp":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "className":Ljava/lang/String;
    .end local p3  # "newState":I
    .end local p4  # "flags":I
    .end local p5  # "userId":I
    .end local p6  # "callingPackage":Ljava/lang/String;
    throw v0

    .line 22306
    .end local v5  # "oldState":I
    .restart local v6  # "allowedByPermission":Z
    .restart local v9  # "isCallerInstantApp":Z
    .restart local v10  # "componentName":Ljava/lang/String;
    .restart local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v14  # "callingUid":I
    .restart local v15  # "permission":I
    .restart local v18  # "sendNow":Z
    .restart local v19  # "isApp":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "className":Ljava/lang/String;
    .restart local p3  # "newState":I
    .restart local p4  # "flags":I
    .restart local p5  # "userId":I
    .restart local p6  # "callingPackage":Ljava/lang/String;
    :cond_20a
    :goto_20a
    monitor-exit v7
    :try_end_20b
    .catchall {:try_start_1c8 .. :try_end_20b} :catchall_37c

    .line 22307
    if-nez v3, :cond_251

    .line 22309
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 22310
    :try_start_210
    invoke-virtual {v13, v11}, Lcom/android/server/pm/PackageSetting;->getEnabled(I)I

    move-result v7

    if-ne v7, v4, :cond_218

    .line 22312
    monitor-exit v5

    return-void

    .line 22314
    :cond_218
    monitor-exit v5
    :try_end_219
    .catchall {:try_start_210 .. :try_end_219} :catchall_24e

    .line 22318
    iget-object v7, v13, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 22319
    .local v7, "deletedPkg":Landroid/content/pm/PackageParser$Package;
    iget-boolean v5, v7, Landroid/content/pm/PackageParser$Package;->isStub:Z

    if-eqz v5, :cond_227

    .line 22320
    invoke-virtual {v7}, Landroid/content/pm/PackageParser$Package;->isSystem()Z

    move-result v5

    if-eqz v5, :cond_227

    const/4 v5, 0x1

    goto :goto_228

    :cond_227
    const/4 v5, 0x0

    :goto_228
    move v8, v5

    .line 22321
    .local v8, "isSystemStub":Z
    if-eqz v8, :cond_237

    if-eqz v4, :cond_230

    const/4 v0, 0x1

    if-ne v4, v0, :cond_237

    .line 22324
    :cond_230
    invoke-direct {v1, v7}, Lcom/android/server/pm/PackageManagerService;->enableCompressedPackage(Landroid/content/pm/PackageParser$Package;)Z

    move-result v5

    if-nez v5, :cond_237

    .line 22325
    return-void

    .line 22328
    :cond_237
    if-eqz v4, :cond_240

    const/4 v0, 0x1

    if-ne v4, v0, :cond_23d

    goto :goto_240

    :cond_23d
    move-object/from16 v12, p6

    goto :goto_242

    .line 22331
    :cond_240
    :goto_240
    const/4 v5, 0x0

    move-object v12, v5

    .line 22333
    .end local p6  # "callingPackage":Ljava/lang/String;
    .local v12, "callingPackage":Ljava/lang/String;
    :goto_242
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 22334
    :try_start_245
    invoke-virtual {v13, v4, v11, v12}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    .line 22335
    monitor-exit v5

    .line 22336
    .end local v7  # "deletedPkg":Landroid/content/pm/PackageParser$Package;
    .end local v8  # "isSystemStub":Z
    goto/16 :goto_2e1

    .line 22335
    .restart local v7  # "deletedPkg":Landroid/content/pm/PackageParser$Package;
    .restart local v8  # "isSystemStub":Z
    :catchall_24b
    move-exception v0

    monitor-exit v5
    :try_end_24d
    .catchall {:try_start_245 .. :try_end_24d} :catchall_24b

    throw v0

    .line 22314
    .end local v7  # "deletedPkg":Landroid/content/pm/PackageParser$Package;
    .end local v8  # "isSystemStub":Z
    .end local v12  # "callingPackage":Ljava/lang/String;
    .restart local p6  # "callingPackage":Ljava/lang/String;
    :catchall_24e
    move-exception v0

    :try_start_24f
    monitor-exit v5
    :try_end_250
    .catchall {:try_start_24f .. :try_end_250} :catchall_24e

    throw v0

    .line 22337
    :cond_251
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 22340
    :try_start_254
    iget-object v7, v13, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 22341
    .local v7, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v7, :cond_25e

    invoke-virtual {v7, v3}, Landroid/content/pm/PackageParser$Package;->hasComponentClassName(Ljava/lang/String;)Z

    move-result v8

    if-nez v8, :cond_2a6

    .line 22342
    :cond_25e
    if-eqz v7, :cond_288

    iget-object v8, v7, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->targetSdkVersion:I

    const/16 v12, 0x10

    if-ge v8, v12, :cond_269

    goto :goto_288

    .line 22345
    :cond_269
    new-instance v0, Ljava/lang/IllegalArgumentException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Component class "

    invoke-virtual {v8, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, " does not exist in "

    invoke-virtual {v8, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-direct {v0, v8}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v6  # "allowedByPermission":Z
    .end local v9  # "isCallerInstantApp":Z
    .end local v10  # "componentName":Ljava/lang/String;
    .end local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v14  # "callingUid":I
    .end local v15  # "permission":I
    .end local v18  # "sendNow":Z
    .end local v19  # "isApp":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "className":Ljava/lang/String;
    .end local p3  # "newState":I
    .end local p4  # "flags":I
    .end local p5  # "userId":I
    .end local p6  # "callingPackage":Ljava/lang/String;
    throw v0

    .line 22348
    .restart local v6  # "allowedByPermission":Z
    .restart local v9  # "isCallerInstantApp":Z
    .restart local v10  # "componentName":Ljava/lang/String;
    .restart local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v14  # "callingUid":I
    .restart local v15  # "permission":I
    .restart local v18  # "sendNow":Z
    .restart local v19  # "isApp":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "className":Ljava/lang/String;
    .restart local p3  # "newState":I
    .restart local p4  # "flags":I
    .restart local p5  # "userId":I
    .restart local p6  # "callingPackage":Ljava/lang/String;
    :cond_288
    :goto_288
    const-string v8, "PackageManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v0, "Failed setComponentEnabledSetting: component class "

    invoke-virtual {v12, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v0, " does not exist in "

    invoke-virtual {v12, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v8, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 22352
    :cond_2a6
    if-eqz v4, :cond_2d6

    const/4 v0, 0x1

    if-eq v4, v0, :cond_2ce

    const/4 v8, 0x2

    if-eq v4, v8, :cond_2c6

    .line 22369
    const-string v0, "PackageManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Invalid new component state: "

    invoke-virtual {v8, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v0, v8}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 22370
    monitor-exit v5

    return-void

    .line 22359
    :cond_2c6
    invoke-virtual {v13, v3, v11}, Lcom/android/server/pm/PackageSetting;->disableComponentLPw(Ljava/lang/String;I)Z

    move-result v8

    if-nez v8, :cond_2de

    .line 22360
    monitor-exit v5

    return-void

    .line 22354
    :cond_2ce
    invoke-virtual {v13, v3, v11}, Lcom/android/server/pm/PackageSetting;->enableComponentLPw(Ljava/lang/String;I)Z

    move-result v8

    if-nez v8, :cond_2de

    .line 22355
    monitor-exit v5

    return-void

    .line 22364
    :cond_2d6
    invoke-virtual {v13, v3, v11}, Lcom/android/server/pm/PackageSetting;->restoreComponentLPw(Ljava/lang/String;I)Z

    move-result v8

    if-nez v8, :cond_2de

    .line 22365
    monitor-exit v5

    return-void

    .line 22372
    .end local v7  # "pkg":Landroid/content/pm/PackageParser$Package;
    :cond_2de
    monitor-exit v5
    :try_end_2df
    .catchall {:try_start_254 .. :try_end_2df} :catchall_379

    move-object/from16 v12, p6

    .line 22374
    .end local p6  # "callingPackage":Ljava/lang/String;
    .restart local v12  # "callingPackage":Ljava/lang/String;
    :goto_2e1
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v7

    .line 22375
    :try_start_2e4
    invoke-virtual {v1, v11}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 22376
    const/4 v0, 0x1

    new-array v5, v0, [I

    const/4 v8, 0x0

    aput v11, v5, v8

    invoke-direct {v1, v13, v5}, Lcom/android/server/pm/PackageManagerService;->updateSequenceNumberLP(Lcom/android/server/pm/PackageSetting;[I)V

    .line 22377
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v16
    :try_end_2f4
    .catchall {:try_start_2e4 .. :try_end_2f4} :catchall_376

    .line 22379
    .local v16, "callingId":J
    :try_start_2f4
    invoke-direct/range {p0 .. p1}, Lcom/android/server/pm/PackageManagerService;->updateInstantAppInstallerLocked(Ljava/lang/String;)V
    :try_end_2f7
    .catchall {:try_start_2f4 .. :try_end_2f7} :catchall_370

    .line 22381
    :try_start_2f7
    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 22382
    nop

    .line 22383
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPendingBroadcasts:Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;

    invoke-virtual {v5, v11, v2}, Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;->get(ILjava/lang/String;)Ljava/util/ArrayList;

    move-result-object v5

    .line 22384
    .local v5, "components":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    if-nez v5, :cond_306

    const/16 v20, 0x1

    goto :goto_308

    :cond_306
    move/from16 v20, v8

    .line 22385
    .local v20, "newPackage":Z
    :goto_308
    if-eqz v20, :cond_311

    .line 22386
    new-instance v21, Ljava/util/ArrayList;

    invoke-direct/range {v21 .. v21}, Ljava/util/ArrayList;-><init>()V

    move-object/from16 v5, v21

    .line 22388
    :cond_311
    invoke-virtual {v5, v10}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v21

    if-nez v21, :cond_31a

    .line 22389
    invoke-virtual {v5, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 22391
    :cond_31a
    and-int/lit8 v21, p4, 0x1

    if-nez v21, :cond_327

    .line 22392
    const/16 v18, 0x1

    .line 22395
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mPendingBroadcasts:Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;

    invoke-virtual {v0, v11, v2}, Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;->remove(ILjava/lang/String;)V

    const/4 v0, 0x1

    goto :goto_34f

    .line 22397
    :cond_327
    if-eqz v20, :cond_32e

    .line 22398
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mPendingBroadcasts:Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;

    invoke-virtual {v0, v11, v2, v5}, Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;->put(ILjava/lang/String;Ljava/util/ArrayList;)V

    .line 22400
    :cond_32e
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/4 v8, 0x1

    invoke-virtual {v0, v8}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->hasMessages(I)Z

    move-result v22

    if-nez v22, :cond_34e

    .line 22405
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v22

    iget-wide v3, v1, Lcom/android/server/pm/PackageManagerService;->mServiceStartWithDelay:J

    cmp-long v3, v22, v3

    if-lez v3, :cond_344

    .line 22406
    const-wide/16 v3, 0x3e8

    goto :goto_346

    .line 22407
    :cond_344
    const-wide/16 v3, 0x2710

    :goto_346
    nop

    .line 22408
    .local v3, "broadcastDelay":J
    iget-object v8, v1, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/4 v0, 0x1

    invoke-virtual {v8, v0, v3, v4}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendEmptyMessageDelayed(IJ)Z

    goto :goto_34f

    .line 22400
    .end local v3  # "broadcastDelay":J
    :cond_34e
    const/4 v0, 0x1

    .line 22411
    .end local v16  # "callingId":J
    .end local v20  # "newPackage":Z
    :goto_34f
    monitor-exit v7
    :try_end_350
    .catchall {:try_start_2f7 .. :try_end_350} :catchall_376

    .line 22413
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 22415
    .local v3, "callingId":J
    if-eqz v18, :cond_36b

    .line 22416
    :try_start_356
    iget v7, v13, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-static {v11, v7}, Landroid/os/UserHandle;->getUid(II)I

    move-result v7

    .line 22417
    .local v7, "packageUid":I
    and-int/lit8 v8, p4, 0x1

    if-eqz v8, :cond_361

    goto :goto_362

    :cond_361
    const/4 v0, 0x0

    :goto_362
    invoke-direct {v1, v2, v0, v5, v7}, Lcom/android/server/pm/PackageManagerService;->sendPackageChangedBroadcast(Ljava/lang/String;ZLjava/util/ArrayList;I)V
    :try_end_365
    .catchall {:try_start_356 .. :try_end_365} :catchall_366

    goto :goto_36b

    .line 22421
    .end local v7  # "packageUid":I
    :catchall_366
    move-exception v0

    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0

    :cond_36b
    :goto_36b
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 22422
    nop

    .line 22423
    return-void

    .line 22381
    .end local v3  # "callingId":J
    .end local v5  # "components":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Ljava/lang/String;>;"
    .restart local v16  # "callingId":J
    :catchall_370
    move-exception v0

    move-object v3, v0

    :try_start_372
    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local v6  # "allowedByPermission":Z
    .end local v9  # "isCallerInstantApp":Z
    .end local v10  # "componentName":Ljava/lang/String;
    .end local v12  # "callingPackage":Ljava/lang/String;
    .end local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v14  # "callingUid":I
    .end local v15  # "permission":I
    .end local v18  # "sendNow":Z
    .end local v19  # "isApp":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "className":Ljava/lang/String;
    .end local p3  # "newState":I
    .end local p4  # "flags":I
    .end local p5  # "userId":I
    throw v3

    .line 22411
    .end local v16  # "callingId":J
    .restart local v6  # "allowedByPermission":Z
    .restart local v9  # "isCallerInstantApp":Z
    .restart local v10  # "componentName":Ljava/lang/String;
    .restart local v12  # "callingPackage":Ljava/lang/String;
    .restart local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v14  # "callingUid":I
    .restart local v15  # "permission":I
    .restart local v18  # "sendNow":Z
    .restart local v19  # "isApp":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "className":Ljava/lang/String;
    .restart local p3  # "newState":I
    .restart local p4  # "flags":I
    .restart local p5  # "userId":I
    :catchall_376
    move-exception v0

    monitor-exit v7
    :try_end_378
    .catchall {:try_start_372 .. :try_end_378} :catchall_376

    throw v0

    .line 22372
    .end local v12  # "callingPackage":Ljava/lang/String;
    .restart local p6  # "callingPackage":Ljava/lang/String;
    :catchall_379
    move-exception v0

    :try_start_37a
    monitor-exit v5
    :try_end_37b
    .catchall {:try_start_37a .. :try_end_37b} :catchall_379

    throw v0

    .line 22306
    :catchall_37c
    move-exception v0

    :try_start_37d
    monitor-exit v7
    :try_end_37e
    .catchall {:try_start_37d .. :try_end_37e} :catchall_37c

    throw v0

    .line 22257
    .end local v13  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v18  # "sendNow":Z
    .end local v19  # "isApp":Z
    .local v7, "sendNow":Z
    .local v8, "isApp":Z
    :catchall_37f
    move-exception v0

    move/from16 v18, v7

    move/from16 v19, v8

    .end local v7  # "sendNow":Z
    .end local v8  # "isApp":Z
    .restart local v18  # "sendNow":Z
    .restart local v19  # "isApp":Z
    :goto_384
    :try_start_384
    monitor-exit v5
    :try_end_385
    .catchall {:try_start_384 .. :try_end_385} :catchall_386

    throw v0

    :catchall_386
    move-exception v0

    goto :goto_384
.end method

.method private setInstallAndUpdateTime(Landroid/content/pm/PackageParser$Package;JJ)V
    .registers 11
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "firstInstallTime"  # J
    .param p4, "lastUpdateTime"  # J

    .line 10876
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 10877
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v0, :cond_a

    .line 10878
    iput-wide p2, v0, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    .line 10879
    iput-wide p4, v0, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J

    .line 10882
    :cond_a
    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v1, :cond_15

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    goto :goto_16

    :cond_15
    const/4 v1, 0x0

    .line 10883
    .local v1, "childCount":I
    :goto_16
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_17
    if-ge v2, v1, :cond_2f

    .line 10884
    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 10885
    .local v3, "childPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    move-object v0, v4

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 10886
    if-eqz v0, :cond_2c

    .line 10887
    iput-wide p2, v0, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    .line 10888
    iput-wide p4, v0, Lcom/android/server/pm/PackageSetting;->lastUpdateTime:J

    .line 10883
    .end local v3  # "childPkg":Landroid/content/pm/PackageParser$Package;
    :cond_2c
    add-int/lit8 v2, v2, 0x1

    goto :goto_17

    .line 10891
    .end local v2  # "i":I
    :cond_2f
    return-void
.end method

.method private setInstallerPackageNameLPw(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;)V
    .registers 8
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "installerPackageName"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 16882
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1, p2}, Lcom/android/server/pm/Settings;->setInstallerPackageName(Ljava/lang/String;Ljava/lang/String;)V

    .line 16884
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_12

    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_13

    :cond_12
    const/4 v0, 0x0

    .line 16885
    .local v0, "childCount":I
    :goto_13
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_14
    if-ge v1, v0, :cond_28

    .line 16886
    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 16887
    .local v2, "childPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v4, p2}, Lcom/android/server/pm/Settings;->setInstallerPackageName(Ljava/lang/String;Ljava/lang/String;)V

    .line 16885
    .end local v2  # "childPkg":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v1, v1, 0x1

    goto :goto_14

    .line 16889
    .end local v1  # "i":I
    :cond_28
    return-void
.end method

.method static setInstantAppForUser(Lcom/android/server/pm/PackageSetting;IZZ)V
    .registers 11
    .param p0, "pkgSetting"  # Lcom/android/server/pm/PackageSetting;
    .param p1, "userId"  # I
    .param p2, "instantApp"  # Z
    .param p3, "fullApp"  # Z

    .line 14202
    if-nez p2, :cond_5

    if-nez p3, :cond_5

    .line 14203
    return-void

    .line 14205
    :cond_5
    const/4 v0, -0x1

    const/4 v1, 0x1

    const/4 v2, 0x0

    if-eq p1, v0, :cond_22

    .line 14206
    if-eqz p2, :cond_16

    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v0

    if-nez v0, :cond_16

    .line 14207
    invoke-virtual {p0, v1, p1}, Lcom/android/server/pm/PackageSetting;->setInstantApp(ZI)V

    goto :goto_48

    .line 14208
    :cond_16
    if-eqz p3, :cond_48

    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v0

    if-eqz v0, :cond_48

    .line 14209
    invoke-virtual {p0, v2, p1}, Lcom/android/server/pm/PackageSetting;->setInstantApp(ZI)V

    goto :goto_48

    .line 14212
    :cond_22
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0

    array-length v3, v0

    move v4, v2

    :goto_2a
    if-ge v4, v3, :cond_48

    aget v5, v0, v4

    .line 14213
    .local v5, "currentUserId":I
    if-eqz p2, :cond_3a

    invoke-virtual {p0, v5}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v6

    if-nez v6, :cond_3a

    .line 14214
    invoke-virtual {p0, v1, v5}, Lcom/android/server/pm/PackageSetting;->setInstantApp(ZI)V

    goto :goto_45

    .line 14215
    :cond_3a
    if-eqz p3, :cond_45

    invoke-virtual {p0, v5}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v6

    if-eqz v6, :cond_45

    .line 14216
    invoke-virtual {p0, v2, v5}, Lcom/android/server/pm/PackageSetting;->setInstantApp(ZI)V

    .line 14212
    .end local v5  # "currentUserId":I
    :cond_45
    :goto_45
    add-int/lit8 v4, v4, 0x1

    goto :goto_2a

    .line 14220
    :cond_48
    :goto_48
    return-void
.end method

.method private static setNativeLibraryPaths(Landroid/content/pm/PackageParser$Package;Ljava/io/File;)V
    .registers 18
    .param p0, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p1, "appLib32InstallDir"  # Ljava/io/File;

    .line 13186
    move-object/from16 v0, p0

    iget-object v1, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 13187
    .local v1, "info":Landroid/content/pm/ApplicationInfo;
    iget-object v2, v0, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    .line 13188
    .local v2, "codePath":Ljava/lang/String;
    new-instance v3, Ljava/io/File;

    invoke-direct {v3, v2}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 13189
    .local v3, "codeFile":Ljava/io/File;
    invoke-virtual {v1}, Landroid/content/pm/ApplicationInfo;->isSystemApp()Z

    move-result v4

    const/4 v5, 0x1

    const/4 v6, 0x0

    if-eqz v4, :cond_1b

    invoke-virtual {v1}, Landroid/content/pm/ApplicationInfo;->isUpdatedSystemApp()Z

    move-result v4

    if-nez v4, :cond_1b

    move v4, v5

    goto :goto_1c

    :cond_1b
    move v4, v6

    .line 13191
    .local v4, "bundledApp":Z
    :goto_1c
    const/4 v7, 0x0

    iput-object v7, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    .line 13192
    iput-boolean v6, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootRequiresIsa:Z

    .line 13193
    iput-object v7, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryDir:Ljava/lang/String;

    .line 13194
    iput-object v7, v1, Landroid/content/pm/ApplicationInfo;->secondaryNativeLibraryDir:Ljava/lang/String;

    .line 13196
    invoke-static {v3}, Landroid/content/pm/PackageParser;->isApkFile(Ljava/io/File;)Z

    move-result v7

    const-string/jumbo v8, "lib"

    if-eqz v7, :cond_99

    .line 13199
    if-eqz v4, :cond_81

    .line 13202
    iget-object v7, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    invoke-static {v7}, Lcom/android/server/pm/PackageManagerService;->calculateBundledApkRoot(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v7

    .line 13203
    .local v7, "apkRoot":Ljava/lang/String;
    nop

    .line 13204
    invoke-static {v1}, Lcom/android/server/pm/InstructionSets;->getPrimaryInstructionSet(Landroid/content/pm/ApplicationInfo;)Ljava/lang/String;

    move-result-object v9

    .line 13203
    invoke-static {v9}, Ldalvik/system/VMRuntime;->is64BitInstructionSet(Ljava/lang/String;)Z

    move-result v9

    .line 13209
    .local v9, "is64Bit":Z
    invoke-static {v2}, Lcom/android/server/pm/PackageManagerService;->deriveCodePathName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v10

    .line 13210
    .local v10, "apkName":Ljava/lang/String;
    const-string/jumbo v11, "lib64"

    if-eqz v9, :cond_4a

    move-object v12, v11

    goto :goto_4b

    :cond_4a
    move-object v12, v8

    .line 13211
    .local v12, "libDir":Ljava/lang/String;
    :goto_4b
    new-instance v13, Ljava/io/File;

    invoke-direct {v13, v7}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    const/4 v14, 0x2

    new-array v15, v14, [Ljava/lang/String;

    aput-object v12, v15, v6

    aput-object v10, v15, v5

    invoke-static {v13, v15}, Landroid/os/Environment;->buildPath(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;

    move-result-object v13

    .line 13212
    invoke-virtual {v13}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v13

    iput-object v13, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    .line 13214
    iget-object v13, v1, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    if-eqz v13, :cond_7e

    .line 13215
    if-eqz v9, :cond_68

    goto :goto_69

    :cond_68
    move-object v8, v11

    .line 13216
    .local v8, "secondaryLibDir":Ljava/lang/String;
    :goto_69
    new-instance v11, Ljava/io/File;

    invoke-direct {v11, v7}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    new-array v13, v14, [Ljava/lang/String;

    aput-object v8, v13, v6

    aput-object v10, v13, v5

    invoke-static {v11, v13}, Landroid/os/Environment;->buildPath(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;

    move-result-object v5

    .line 13217
    invoke-virtual {v5}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v5

    iput-object v5, v1, Landroid/content/pm/ApplicationInfo;->secondaryNativeLibraryDir:Ljava/lang/String;

    .line 13219
    .end local v7  # "apkRoot":Ljava/lang/String;
    .end local v8  # "secondaryLibDir":Ljava/lang/String;
    .end local v9  # "is64Bit":Z
    .end local v10  # "apkName":Ljava/lang/String;
    .end local v12  # "libDir":Ljava/lang/String;
    :cond_7e
    move-object/from16 v9, p1

    goto :goto_92

    .line 13220
    :cond_81
    invoke-static {v2}, Lcom/android/server/pm/PackageManagerService;->deriveCodePathName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    .line 13221
    .local v5, "apkName":Ljava/lang/String;
    new-instance v7, Ljava/io/File;

    move-object/from16 v9, p1

    invoke-direct {v7, v9, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 13222
    invoke-virtual {v7}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v7

    iput-object v7, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    .line 13225
    .end local v5  # "apkName":Ljava/lang/String;
    :goto_92
    iput-boolean v6, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootRequiresIsa:Z

    .line 13226
    iget-object v5, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    iput-object v5, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryDir:Ljava/lang/String;

    goto :goto_d0

    .line 13229
    :cond_99
    move-object/from16 v9, p1

    new-instance v6, Ljava/io/File;

    invoke-direct {v6, v3, v8}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v6}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v6

    iput-object v6, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    .line 13230
    iput-boolean v5, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootRequiresIsa:Z

    .line 13232
    new-instance v5, Ljava/io/File;

    iget-object v6, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    .line 13233
    invoke-static {v1}, Lcom/android/server/pm/InstructionSets;->getPrimaryInstructionSet(Landroid/content/pm/ApplicationInfo;)Ljava/lang/String;

    move-result-object v7

    invoke-direct {v5, v6, v7}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v5}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v5

    iput-object v5, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryDir:Ljava/lang/String;

    .line 13235
    iget-object v5, v1, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    if-eqz v5, :cond_d0

    .line 13236
    new-instance v5, Ljava/io/File;

    iget-object v6, v1, Landroid/content/pm/ApplicationInfo;->nativeLibraryRootDir:Ljava/lang/String;

    iget-object v7, v1, Landroid/content/pm/ApplicationInfo;->secondaryCpuAbi:Ljava/lang/String;

    .line 13237
    invoke-static {v7}, Ldalvik/system/VMRuntime;->getInstructionSet(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v7

    invoke-direct {v5, v6, v7}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v5}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v5

    iput-object v5, v1, Landroid/content/pm/ApplicationInfo;->secondaryNativeLibraryDir:Ljava/lang/String;

    .line 13240
    :cond_d0
    :goto_d0
    return-void
.end method

.method private setUpCustomResolverActivity(Landroid/content/pm/PackageParser$Package;)V
    .registers 7
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 13091
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 13092
    const/4 v1, 0x1

    :try_start_4
    iput-boolean v1, p0, Lcom/android/server/pm/PackageManagerService;->mResolverReplaced:Z

    .line 13094
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-object v3, v2, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 13095
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mCustomResolverComponentName:Landroid/content/ComponentName;

    invoke-virtual {v3}, Landroid/content/ComponentName;->getClassName()Ljava/lang/String;

    move-result-object v3

    iput-object v3, v2, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    .line 13096
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v3, v2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    .line 13097
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v3, v2, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    .line 13098
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const/4 v3, 0x0

    iput v3, v2, Landroid/content/pm/ActivityInfo;->launchMode:I

    .line 13099
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    const/16 v4, 0x120

    iput v4, v2, Landroid/content/pm/ActivityInfo;->flags:I

    .line 13101
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iput v3, v2, Landroid/content/pm/ActivityInfo;->theme:I

    .line 13102
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iput-boolean v1, v2, Landroid/content/pm/ActivityInfo;->exported:Z

    .line 13103
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iput-boolean v1, v2, Landroid/content/pm/ActivityInfo;->enabled:Z

    .line 13104
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;

    iput-object v2, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 13105
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    iput v3, v1, Landroid/content/pm/ResolveInfo;->priority:I

    .line 13106
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    iput v3, v1, Landroid/content/pm/ResolveInfo;->preferredOrder:I

    .line 13107
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mResolveInfo:Landroid/content/pm/ResolveInfo;

    iput v3, v1, Landroid/content/pm/ResolveInfo;->match:I

    .line 13108
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mCustomResolverComponentName:Landroid/content/ComponentName;

    iput-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mResolveComponentName:Landroid/content/ComponentName;

    .line 13109
    const-string v1, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Replacing default ResolverActivity with custom activity: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mResolveComponentName:Landroid/content/ComponentName;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 13111
    monitor-exit v0

    .line 13112
    return-void

    .line 13111
    :catchall_6d
    move-exception v1

    monitor-exit v0
    :try_end_6f
    .catchall {:try_start_4 .. :try_end_6f} :catchall_6d

    throw v1
.end method

.method private setUpFsVerityIfPossible(Landroid/content/pm/PackageParser$Package;)V
    .registers 15
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/Installer$InstallerException;,
            Lcom/android/server/pm/PackageManagerService$PrepareFailure;,
            Ljava/io/IOException;,
            Ljava/security/DigestException;,
            Ljava/security/NoSuchAlgorithmException;
        }
    .end annotation

    .line 18709
    invoke-static {}, Lcom/android/server/pm/PackageManagerServiceUtils;->isApkVerityEnabled()Z

    move-result v0

    .line 18710
    .local v0, "standardMode":Z
    invoke-static {}, Lcom/android/server/pm/PackageManagerServiceUtils;->isLegacyApkVerityEnabled()Z

    move-result v1

    .line 18711
    .local v1, "legacyMode":Z
    if-nez v0, :cond_d

    if-nez v1, :cond_d

    .line 18712
    return-void

    .line 18716
    :cond_d
    new-instance v2, Landroid/util/ArrayMap;

    invoke-direct {v2}, Landroid/util/ArrayMap;-><init>()V

    .line 18717
    .local v2, "fsverityCandidates":Landroid/util/ArrayMap;, "Landroid/util/ArrayMap<Ljava/lang/String;Ljava/lang/String;>;"
    const/4 v3, 0x0

    if-eqz v1, :cond_49

    .line 18718
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v4

    .line 18719
    :try_start_18
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 18720
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v5, :cond_44

    invoke-virtual {v5}, Lcom/android/server/pm/PackageSetting;->isPrivileged()Z

    move-result v6

    if-eqz v6, :cond_44

    .line 18721
    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    const/4 v7, 0x0

    invoke-virtual {v2, v6, v7}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18722
    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    if-eqz v6, :cond_44

    .line 18723
    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    array-length v8, v6

    :goto_39
    if-ge v3, v8, :cond_44

    aget-object v9, v6, v3

    .line 18724
    .local v9, "splitPath":Ljava/lang/String;
    invoke-virtual {v2, v9, v7}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18723
    nop

    .end local v9  # "splitPath":Ljava/lang/String;
    add-int/lit8 v3, v3, 0x1

    goto :goto_39

    .line 18728
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_44
    monitor-exit v4

    goto :goto_98

    :catchall_46
    move-exception v3

    monitor-exit v4
    :try_end_48
    .catchall {:try_start_18 .. :try_end_48} :catchall_46

    throw v3

    .line 18732
    :cond_49
    iget-object v4, p1, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    .line 18733
    invoke-static {v5}, Lcom/android/server/security/VerityUtils;->getFsveritySignatureFilePath(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    .line 18732
    invoke-virtual {v2, v4, v5}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18735
    iget-object v4, p1, Landroid/content/pm/PackageParser$Package;->baseCodePath:Ljava/lang/String;

    invoke-static {v4}, Landroid/content/pm/dex/DexMetadataHelper;->buildDexMetadataPathForApk(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    .line 18736
    .local v4, "dmPath":Ljava/lang/String;
    new-instance v5, Ljava/io/File;

    invoke-direct {v5, v4}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-virtual {v5}, Ljava/io/File;->exists()Z

    move-result v5

    if-eqz v5, :cond_6c

    .line 18737
    invoke-static {v4}, Lcom/android/server/security/VerityUtils;->getFsveritySignatureFilePath(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v2, v4, v5}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18740
    :cond_6c
    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    if-eqz v5, :cond_98

    .line 18741
    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->splitCodePaths:[Ljava/lang/String;

    array-length v6, v5

    :goto_73
    if-ge v3, v6, :cond_98

    aget-object v7, v5, v3

    .line 18742
    .local v7, "path":Ljava/lang/String;
    invoke-static {v7}, Lcom/android/server/security/VerityUtils;->getFsveritySignatureFilePath(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v2, v7, v8}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18744
    invoke-static {v7}, Landroid/content/pm/dex/DexMetadataHelper;->buildDexMetadataPathForApk(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v8

    .line 18745
    .local v8, "splitDmPath":Ljava/lang/String;
    new-instance v9, Ljava/io/File;

    invoke-direct {v9, v8}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-virtual {v9}, Ljava/io/File;->exists()Z

    move-result v9

    if-eqz v9, :cond_95

    .line 18746
    nop

    .line 18747
    invoke-static {v8}, Lcom/android/server/security/VerityUtils;->getFsveritySignatureFilePath(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    .line 18746
    invoke-virtual {v2, v8, v9}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 18741
    .end local v7  # "path":Ljava/lang/String;
    .end local v8  # "splitDmPath":Ljava/lang/String;
    :cond_95
    add-int/lit8 v3, v3, 0x1

    goto :goto_73

    .line 18753
    .end local v4  # "dmPath":Ljava/lang/String;
    :cond_98
    :goto_98
    invoke-virtual {v2}, Landroid/util/ArrayMap;->entrySet()Ljava/util/Set;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :cond_a0
    :goto_a0
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_144

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/util/Map$Entry;

    .line 18754
    .local v4, "entry":Ljava/util/Map$Entry;, "Ljava/util/Map$Entry<Ljava/lang/String;Ljava/lang/String;>;"
    invoke-interface {v4}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/String;

    .line 18755
    .local v5, "filePath":Ljava/lang/String;
    invoke-interface {v4}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/String;

    .line 18757
    .local v6, "signaturePath":Ljava/lang/String;
    const/16 v7, -0x76

    if-nez v1, :cond_e9

    .line 18759
    new-instance v8, Ljava/io/File;

    invoke-direct {v8, v6}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-virtual {v8}, Ljava/io/File;->exists()Z

    move-result v8

    if-eqz v8, :cond_a0

    invoke-static {v5}, Lcom/android/server/security/VerityUtils;->hasFsverity(Ljava/lang/String;)Z

    move-result v8

    if-nez v8, :cond_a0

    .line 18761
    :try_start_cd
    invoke-static {v5, v6}, Lcom/android/server/security/VerityUtils;->setUpFsverity(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_d0
    .catch Ljava/io/IOException; {:try_start_cd .. :try_end_d0} :catch_d1
    .catch Ljava/security/DigestException; {:try_start_cd .. :try_end_d0} :catch_d1
    .catch Ljava/security/NoSuchAlgorithmException; {:try_start_cd .. :try_end_d0} :catch_d1
    .catch Ljava/lang/SecurityException; {:try_start_cd .. :try_end_d0} :catch_d1

    .line 18766
    goto :goto_a0

    .line 18762
    :catch_d1
    move-exception v3

    .line 18764
    .local v3, "e":Ljava/lang/Exception;
    new-instance v8, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Failed to enable fs-verity: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-direct {v8, v7, v9}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v8

    .line 18772
    .end local v3  # "e":Ljava/lang/Exception;
    :cond_e9
    invoke-static {v5}, Lcom/android/server/security/VerityUtils;->generateApkVeritySetupData(Ljava/lang/String;)Lcom/android/server/security/VerityUtils$SetupResult;

    move-result-object v8

    .line 18773
    .local v8, "result":Lcom/android/server/security/VerityUtils$SetupResult;
    invoke-virtual {v8}, Lcom/android/server/security/VerityUtils$SetupResult;->isOk()Z

    move-result v9

    if-eqz v9, :cond_133

    .line 18774
    sget-boolean v7, Landroid/os/Build;->IS_DEBUGGABLE:Z

    if-eqz v7, :cond_10d

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Enabling verity to "

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    const-string v9, "PackageManager"

    invoke-static {v9, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 18775
    :cond_10d
    invoke-virtual {v8}, Lcom/android/server/security/VerityUtils$SetupResult;->getUnownedFileDescriptor()Ljava/io/FileDescriptor;

    move-result-object v7

    .line 18777
    .local v7, "fd":Ljava/io/FileDescriptor;
    :try_start_111
    invoke-static {v5}, Lcom/android/server/security/VerityUtils;->generateApkVerityRootHash(Ljava/lang/String;)[B

    move-result-object v9
    :try_end_115
    .catchall {:try_start_111 .. :try_end_115} :catchall_12e

    .line 18781
    .local v9, "rootHash":[B
    :try_start_115
    iget-object v10, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v10, v5, v9}, Lcom/android/server/pm/Installer;->assertFsverityRootHashMatches(Ljava/lang/String;[B)V
    :try_end_11a
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_115 .. :try_end_11a} :catch_11b
    .catchall {:try_start_115 .. :try_end_11a} :catchall_12e

    .line 18785
    goto :goto_12a

    .line 18782
    :catch_11b
    move-exception v10

    .line 18783
    .local v10, "e":Lcom/android/server/pm/Installer$InstallerException;
    :try_start_11c
    iget-object v11, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v8}, Lcom/android/server/security/VerityUtils$SetupResult;->getContentSize()I

    move-result v12

    invoke-virtual {v11, v5, v7, v12}, Lcom/android/server/pm/Installer;->installApkVerity(Ljava/lang/String;Ljava/io/FileDescriptor;I)V

    .line 18784
    iget-object v11, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v11, v5, v9}, Lcom/android/server/pm/Installer;->assertFsverityRootHashMatches(Ljava/lang/String;[B)V
    :try_end_12a
    .catchall {:try_start_11c .. :try_end_12a} :catchall_12e

    .line 18787
    .end local v9  # "rootHash":[B
    .end local v10  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :goto_12a
    invoke-static {v7}, Llibcore/io/IoUtils;->closeQuietly(Ljava/io/FileDescriptor;)V

    .line 18788
    goto :goto_139

    .line 18787
    :catchall_12e
    move-exception v3

    invoke-static {v7}, Llibcore/io/IoUtils;->closeQuietly(Ljava/io/FileDescriptor;)V

    throw v3

    .line 18789
    .end local v7  # "fd":Ljava/io/FileDescriptor;
    :cond_133
    invoke-virtual {v8}, Lcom/android/server/security/VerityUtils$SetupResult;->isFailed()Z

    move-result v9

    if-nez v9, :cond_13c

    :goto_139
    nop

    .line 18793
    .end local v4  # "entry":Ljava/util/Map$Entry;, "Ljava/util/Map$Entry<Ljava/lang/String;Ljava/lang/String;>;"
    .end local v5  # "filePath":Ljava/lang/String;
    .end local v6  # "signaturePath":Ljava/lang/String;
    .end local v8  # "result":Lcom/android/server/security/VerityUtils$SetupResult;
    goto/16 :goto_a0

    .line 18790
    .restart local v4  # "entry":Ljava/util/Map$Entry;, "Ljava/util/Map$Entry<Ljava/lang/String;Ljava/lang/String;>;"
    .restart local v5  # "filePath":Ljava/lang/String;
    .restart local v6  # "signaturePath":Ljava/lang/String;
    .restart local v8  # "result":Lcom/android/server/security/VerityUtils$SetupResult;
    :cond_13c
    new-instance v3, Lcom/android/server/pm/PackageManagerService$PrepareFailure;

    const-string v9, "Failed to generate verity"

    invoke-direct {v3, v7, v9}, Lcom/android/server/pm/PackageManagerService$PrepareFailure;-><init>(ILjava/lang/String;)V

    throw v3

    .line 18794
    .end local v4  # "entry":Ljava/util/Map$Entry;, "Ljava/util/Map$Entry<Ljava/lang/String;Ljava/lang/String;>;"
    .end local v5  # "filePath":Ljava/lang/String;
    .end local v6  # "signaturePath":Ljava/lang/String;
    .end local v8  # "result":Lcom/android/server/security/VerityUtils$SetupResult;
    :cond_144
    return-void
.end method

.method private setUpInstantAppInstallerActivityLP(Landroid/content/pm/ActivityInfo;)V
    .registers 5
    .param p1, "installerActivity"  # Landroid/content/pm/ActivityInfo;

    .line 13115
    const-string v0, "PackageManager"

    if-nez p1, :cond_11

    .line 13116
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v1, :cond_d

    .line 13117
    const-string v1, "Clear ephemeral installer activity"

    invoke-static {v0, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 13119
    :cond_d
    const/4 v0, 0x0

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    .line 13120
    return-void

    .line 13123
    :cond_11
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v1, :cond_2d

    .line 13124
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Set ephemeral installer activity: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 13125
    invoke-virtual {p1}, Landroid/content/pm/ActivityInfo;->getComponentName()Landroid/content/ComponentName;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 13124
    invoke-static {v0, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 13128
    :cond_2d
    iput-object p1, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    .line 13129
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    iget v1, v0, Landroid/content/pm/ActivityInfo;->flags:I

    or-int/lit16 v1, v1, 0x120

    iput v1, v0, Landroid/content/pm/ActivityInfo;->flags:I

    .line 13131
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    const/4 v1, 0x1

    iput-boolean v1, v0, Landroid/content/pm/ActivityInfo;->exported:Z

    .line 13132
    iput-boolean v1, v0, Landroid/content/pm/ActivityInfo;->enabled:Z

    .line 13133
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerInfo:Landroid/content/pm/ResolveInfo;

    iput-object v0, v2, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 13134
    iput v1, v2, Landroid/content/pm/ResolveInfo;->priority:I

    .line 13135
    iput v1, v2, Landroid/content/pm/ResolveInfo;->preferredOrder:I

    .line 13136
    iput-boolean v1, v2, Landroid/content/pm/ResolveInfo;->isDefault:Z

    .line 13137
    const v0, 0x588000

    iput v0, v2, Landroid/content/pm/ResolveInfo;->match:I

    .line 13139
    return-void
.end method

.method private setWhitelistedRestrictedPermissions(Ljava/lang/String;Ljava/util/List;II)Z
    .registers 21
    .param p1, "packageName"  # Ljava/lang/String;
    .param p3, "whitelistFlag"  # I
    .param p4, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;II)Z"
        }
    .end annotation

    .line 6224
    .local p2, "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move-object/from16 v10, p2

    move/from16 v11, p3

    move/from16 v12, p4

    invoke-static/range {p1 .. p1}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6225
    const/4 v0, 0x7

    invoke-static {v11, v0}, Lcom/android/internal/util/Preconditions;->checkFlagsArgument(II)I

    .line 6229
    invoke-static/range {p3 .. p3}, Ljava/lang/Integer;->bitCount(I)I

    move-result v0

    const/4 v3, 0x0

    const/4 v13, 0x1

    if-ne v0, v13, :cond_1b

    move v0, v13

    goto :goto_1c

    :cond_1b
    move v0, v3

    :goto_1c
    invoke-static {v0}, Lcom/android/internal/util/Preconditions;->checkArgument(Z)V

    .line 6230
    int-to-float v0, v12

    const/4 v4, 0x0

    invoke-static {v0, v4}, Lcom/android/internal/util/Preconditions;->checkArgumentNonNegative(FLjava/lang/String;)F

    .line 6232
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    if-eq v0, v12, :cond_43

    .line 6233
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v5, "setWhitelistedRestrictedPermissions for user "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v5, "android.permission.INTERACT_ACROSS_USERS"

    invoke-virtual {v0, v5, v4}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6240
    :cond_43
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 6241
    :try_start_46
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 6242
    .local v0, "packageSetting":Lcom/android/server/pm/PackageSetting;
    if-nez v0, :cond_6a

    .line 6243
    const-string v4, "PackageManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unknown package: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v4, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6244
    monitor-exit v5

    return v3

    .line 6247
    :cond_6a
    iget-object v4, v0, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 6249
    .local v4, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v7, "android.permission.WHITELIST_RESTRICTED_PERMISSIONS"

    invoke-virtual {v6, v7}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v6

    if-nez v6, :cond_78

    move v6, v13

    goto :goto_79

    :cond_78
    move v6, v3

    .line 6252
    .local v6, "isCallerPrivileged":Z
    :goto_79
    iget-object v7, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v8, v0, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 6254
    .local v7, "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v7, :cond_95

    iget v8, v7, Lcom/android/server/pm/PackageSetting;->appId:I

    .line 6255
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v9

    invoke-static {v8, v9}, Landroid/os/UserHandle;->isSameApp(II)Z

    move-result v8

    if-eqz v8, :cond_95

    move v8, v13

    goto :goto_96

    :cond_95
    move v8, v3

    .line 6257
    .local v8, "isCallerInstallerOnRecord":Z
    :goto_96
    and-int/lit8 v9, v11, 0x1

    if-eqz v9, :cond_a5

    if-eqz v6, :cond_9d

    goto :goto_a5

    .line 6259
    :cond_9d
    new-instance v3, Ljava/lang/SecurityException;

    const-string v9, "Modifying system whitelist requires android.permission.WHITELIST_RESTRICTED_PERMISSIONS"

    invoke-direct {v3, v9}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local p3  # "whitelistFlag":I
    .end local p4  # "userId":I
    throw v3

    .line 6263
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p3  # "whitelistFlag":I
    .restart local p4  # "userId":I
    :cond_a5
    :goto_a5
    and-int/lit8 v9, v11, 0x4

    if-eqz v9, :cond_ee

    .line 6264
    if-nez v6, :cond_b6

    if-eqz v8, :cond_ae

    goto :goto_b6

    .line 6265
    :cond_ae
    new-instance v3, Ljava/lang/SecurityException;

    const-string v9, "Modifying upgrade whitelist requires being installer on record or android.permission.WHITELIST_RESTRICTED_PERMISSIONS"

    invoke-direct {v3, v9}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local p3  # "whitelistFlag":I
    .end local p4  # "userId":I
    throw v3

    .line 6269
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p3  # "whitelistFlag":I
    .restart local p4  # "userId":I
    :cond_b6
    :goto_b6
    invoke-virtual {v1, v2, v11, v12}, Lcom/android/server/pm/PackageManagerService;->getWhitelistedRestrictedPermissions(Ljava/lang/String;II)Ljava/util/List;

    move-result-object v9

    .line 6271
    .local v9, "whitelistedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v10, :cond_e4

    invoke-interface/range {p2 .. p2}, Ljava/util/List;->isEmpty()Z

    move-result v14

    if-eqz v14, :cond_c3

    goto :goto_e4

    .line 6277
    :cond_c3
    invoke-interface/range {p2 .. p2}, Ljava/util/List;->size()I

    move-result v14

    .line 6278
    .local v14, "permissionCount":I
    const/4 v15, 0x0

    .local v15, "i":I
    :goto_c8
    if-ge v15, v14, :cond_ee

    .line 6279
    if-eqz v9, :cond_d6

    .line 6280
    invoke-interface {v10, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-interface {v9, v3}, Ljava/util/List;->contains(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_d8

    :cond_d6
    if-eqz v6, :cond_dc

    .line 6278
    :cond_d8
    add-int/lit8 v15, v15, 0x1

    const/4 v3, 0x0

    goto :goto_c8

    .line 6282
    :cond_dc
    new-instance v3, Ljava/lang/SecurityException;

    const-string v13, "Adding to upgrade whitelist requiresandroid.permission.WHITELIST_RESTRICTED_PERMISSIONS"

    invoke-direct {v3, v13}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local p3  # "whitelistFlag":I
    .end local p4  # "userId":I
    throw v3

    .line 6272
    .end local v14  # "permissionCount":I
    .end local v15  # "i":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p3  # "whitelistFlag":I
    .restart local p4  # "userId":I
    :cond_e4
    :goto_e4
    if-eqz v9, :cond_ec

    invoke-interface {v9}, Ljava/util/List;->isEmpty()Z

    move-result v3

    if-eqz v3, :cond_ee

    .line 6273
    :cond_ec
    monitor-exit v5

    return v13

    .line 6289
    .end local v9  # "whitelistedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_ee
    and-int/lit8 v3, v11, 0x2

    if-eqz v3, :cond_ff

    .line 6290
    if-nez v6, :cond_ff

    if-eqz v8, :cond_f7

    goto :goto_ff

    .line 6291
    :cond_f7
    new-instance v3, Ljava/lang/SecurityException;

    const-string v9, "Modifying installer whitelist requires being installer on record or android.permission.WHITELIST_RESTRICTED_PERMISSIONS"

    invoke-direct {v3, v9}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local p3  # "whitelistFlag":I
    .end local p4  # "userId":I
    throw v3

    .line 6297
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p3  # "whitelistFlag":I
    .restart local p4  # "userId":I
    :cond_ff
    :goto_ff
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    .line 6298
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v9

    .line 6297
    invoke-direct {v1, v0, v3, v9}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-eqz v3, :cond_110

    .line 6299
    monitor-exit v5

    const/4 v3, 0x0

    return v3

    .line 6301
    .end local v0  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "isCallerPrivileged":Z
    .end local v7  # "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v8  # "isCallerInstallerOnRecord":Z
    :cond_110
    monitor-exit v5
    :try_end_111
    .catchall {:try_start_46 .. :try_end_111} :catchall_133

    .line 6303
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v14

    .line 6305
    .local v14, "identity":J
    :try_start_115
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    new-array v5, v13, [I

    const/4 v0, 0x0

    aput v12, v5, v0

    .line 6306
    invoke-static {}, Landroid/os/Process;->myUid()I

    move-result v7

    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 6305
    move-object/from16 v6, p2

    move/from16 v8, p3

    invoke-virtual/range {v3 .. v9}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->setWhitelistedRestrictedPermissions(Landroid/content/pm/PackageParser$Package;[ILjava/util/List;IILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V
    :try_end_129
    .catchall {:try_start_115 .. :try_end_129} :catchall_12e

    .line 6309
    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6310
    nop

    .line 6312
    return v13

    .line 6309
    :catchall_12e
    move-exception v0

    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0

    .line 6301
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v14  # "identity":J
    :catchall_133
    move-exception v0

    :try_start_134
    monitor-exit v5
    :try_end_135
    .catchall {:try_start_134 .. :try_end_135} :catchall_133

    throw v0
.end method

.method private static sharedLibExists(Ljava/lang/String;JLjava/util/Map;)Z
    .registers 6
    .param p0, "name"  # Ljava/lang/String;
    .param p1, "version"  # J
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "J",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/util/LongSparseArray<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;>;)Z"
        }
    .end annotation

    .line 12590
    .local p3, "librarySource":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;>;"
    invoke-interface {p3, p0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/util/LongSparseArray;

    .line 12591
    .local v0, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-eqz v0, :cond_10

    invoke-virtual {v0, p1, p2}, Landroid/util/LongSparseArray;->indexOfKey(J)I

    move-result v1

    if-ltz v1, :cond_10

    .line 12592
    const/4 v1, 0x1

    return v1

    .line 12594
    :cond_10
    const/4 v1, 0x0

    return v1
.end method

.method private shouldKeepUninstalledPackageLPr(Ljava/lang/String;)Z
    .registers 3
    .param p1, "packageName"  # Ljava/lang/String;

    .line 19436
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mKeepUninstalledPackages:Ljava/util/List;

    if-eqz v0, :cond_c

    invoke-interface {v0, p1}, Ljava/util/List;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_c

    const/4 v0, 0x1

    goto :goto_d

    :cond_c
    const/4 v0, 0x0

    :goto_d
    return v0
.end method

.method private startIntentFilterVerifications(IZLandroid/content/pm/PackageParser$Package;)V
    .registers 11
    .param p1, "userId"  # I
    .param p2, "replacing"  # Z
    .param p3, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 18798
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifierComponent:Landroid/content/ComponentName;

    if-nez v0, :cond_c

    .line 18799
    const-string v0, "PackageManager"

    const-string v1, "No IntentFilter verification will not be done as there is no IntentFilterVerifier available!"

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 18801
    return-void

    .line 18804
    :cond_c
    nop

    .line 18805
    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    const/high16 v1, 0x10000000

    .line 18807
    const/4 v2, -0x1

    const/4 v3, 0x0

    if-ne p1, v2, :cond_19

    move v2, v3

    goto :goto_1a

    :cond_19
    move v2, p1

    .line 18804
    :goto_1a
    invoke-virtual {p0, v0, v1, v2}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v0

    .line 18809
    .local v0, "verifierUid":I
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v2, 0x11

    invoke-virtual {v1, v2}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 18810
    .local v1, "msg":Landroid/os/Message;
    new-instance v4, Lcom/android/server/pm/PackageManagerService$IFVerificationParams;

    invoke-direct {v4, p3, p2, p1, v0}, Lcom/android/server/pm/PackageManagerService$IFVerificationParams;-><init>(Landroid/content/pm/PackageParser$Package;ZII)V

    iput-object v4, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 18811
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v4, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 18813
    iget-object v4, p3, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v4, :cond_3c

    iget-object v3, p3, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    .line 18814
    .local v3, "childCount":I
    :cond_3c
    const/4 v4, 0x0

    .local v4, "i":I
    :goto_3d
    if-ge v4, v3, :cond_5c

    .line 18815
    iget-object v5, p3, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v5, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Package;

    .line 18816
    .local v5, "childPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v6, v2}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 18817
    new-instance v6, Lcom/android/server/pm/PackageManagerService$IFVerificationParams;

    invoke-direct {v6, v5, p2, p1, v0}, Lcom/android/server/pm/PackageManagerService$IFVerificationParams;-><init>(Landroid/content/pm/PackageParser$Package;ZII)V

    iput-object v6, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 18818
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v6, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 18814
    .end local v5  # "childPkg":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v4, v4, 0x1

    goto :goto_3d

    .line 18820
    .end local v4  # "i":I
    :cond_5c
    return-void
.end method

.method private unloadPrivatePackages(Landroid/os/storage/VolumeInfo;)V
    .registers 4
    .param p1, "vol"  # Landroid/os/storage/VolumeInfo;

    .line 23695
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$1F746LEL3aKKL8Z1H1MLxe_4jO0;

    invoke-direct {v1, p0, p1}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$1F746LEL3aKKL8Z1H1MLxe_4jO0;-><init>(Lcom/android/server/pm/PackageManagerService;Landroid/os/storage/VolumeInfo;)V

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 23696
    return-void
.end method

.method private unloadPrivatePackagesInner(Landroid/os/storage/VolumeInfo;)V
    .registers 27
    .param p1, "vol"  # Landroid/os/storage/VolumeInfo;

    .line 23699
    move-object/from16 v10, p0

    move-object/from16 v11, p1

    iget-object v12, v11, Landroid/os/storage/VolumeInfo;->fsUuid:Ljava/lang/String;

    .line 23700
    .local v12, "volumeUuid":Ljava/lang/String;
    invoke-static {v12}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v0

    if-eqz v0, :cond_14

    .line 23701
    const-string v0, "PackageManager"

    const-string v1, "Unloading internal storage is probably a mistake; ignoring"

    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 23702
    return-void

    .line 23705
    :cond_14
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    move-object v13, v0

    .line 23706
    .local v13, "unloaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    iget-object v14, v10, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v14

    .line 23707
    :try_start_1d
    iget-object v15, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v15
    :try_end_20
    .catchall {:try_start_1d .. :try_end_20} :catchall_12c

    .line 23708
    :try_start_20
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v12}, Lcom/android/server/pm/Settings;->getVolumePackagesLPr(Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    move-object/from16 v16, v0

    .line 23709
    .local v16, "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    invoke-interface/range {v16 .. v16}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_2c
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    const/4 v9, 0x0

    if-eqz v1, :cond_dd

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    move-object v8, v1

    .line 23710
    .local v8, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v1, v8, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-nez v1, :cond_3f

    goto :goto_2c

    .line 23712
    :cond_3f
    iget-object v1, v8, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v1, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v6, v1

    .line 23713
    .local v6, "info":Landroid/content/pm/ApplicationInfo;
    const/16 v17, 0x1

    .line 23714
    .local v17, "deleteFlags":I
    new-instance v7, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    invoke-direct {v7, v10}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;-><init>(Lcom/android/server/pm/PackageSender;)V

    .line 23716
    .local v7, "outInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    iget-object v1, v8, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    const-string/jumbo v2, "unloadPrivatePackagesInner"

    const/4 v3, 0x1

    invoke-virtual {v10, v1, v3, v2}, Lcom/android/server/pm/PackageManagerService;->freezePackageForDelete(Ljava/lang/String;ILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v1
    :try_end_55
    .catchall {:try_start_20 .. :try_end_55} :catchall_129

    move-object v5, v1

    .line 23718
    .local v5, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :try_start_56
    iget-object v2, v8, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;
    :try_end_58
    .catchall {:try_start_56 .. :try_end_58} :catchall_cf

    const/4 v3, 0x0

    const/4 v4, 0x0

    const/16 v18, 0x0

    const/16 v19, 0x1

    const/16 v20, 0x0

    const/16 v21, 0x0

    move-object/from16 v1, p0

    move-object/from16 v22, v5

    .end local v5  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .local v22, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    move-object/from16 v5, v18

    move-object/from16 v23, v6

    .end local v6  # "info":Landroid/content/pm/ApplicationInfo;
    .local v23, "info":Landroid/content/pm/ApplicationInfo;
    move/from16 v6, v19

    move-object/from16 v24, v8

    .end local v8  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v24, "ps":Lcom/android/server/pm/PackageSetting;
    move/from16 v8, v20

    move-object/from16 v18, v0

    move-object v0, v9

    move-object/from16 v9, v21

    :try_start_75
    invoke-direct/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->deletePackageLIF(Ljava/lang/String;Landroid/os/UserHandle;Z[IILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ZLandroid/content/pm/PackageParser$Package;)Z

    move-result v1
    :try_end_79
    .catchall {:try_start_75 .. :try_end_79} :catchall_c6

    if-eqz v1, :cond_8a

    .line 23720
    move-object/from16 v1, v23

    .end local v23  # "info":Landroid/content/pm/ApplicationInfo;
    .local v1, "info":Landroid/content/pm/ApplicationInfo;
    :try_start_7d
    invoke-virtual {v13, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_80
    .catchall {:try_start_7d .. :try_end_80} :catchall_83

    move-object/from16 v4, v24

    goto :goto_a6

    .line 23716
    :catchall_83
    move-exception v0

    move-object v3, v0

    move-object/from16 v2, v22

    move-object/from16 v4, v24

    goto :goto_d4

    .line 23722
    .end local v1  # "info":Landroid/content/pm/ApplicationInfo;
    .restart local v23  # "info":Landroid/content/pm/ApplicationInfo;
    :cond_8a
    move-object/from16 v1, v23

    .end local v23  # "info":Landroid/content/pm/ApplicationInfo;
    .restart local v1  # "info":Landroid/content/pm/ApplicationInfo;
    :try_start_8c
    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Failed to unload "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    :try_end_98
    .catchall {:try_start_8c .. :try_end_98} :catchall_bf

    move-object/from16 v4, v24

    .end local v24  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    :try_start_9a
    iget-object v5, v4, Lcom/android/server/pm/PackageSetting;->codePath:Ljava/io/File;

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_a6
    .catchall {:try_start_9a .. :try_end_a6} :catchall_ba

    .line 23724
    :goto_a6
    move-object/from16 v2, v22

    .end local v22  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .local v2, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    if-eqz v2, :cond_ad

    :try_start_aa
    invoke-static {v0, v2}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    .line 23729
    .end local v2  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :cond_ad
    invoke-static {}, Lcom/android/server/AttributeCache;->instance()Lcom/android/server/AttributeCache;

    move-result-object v0

    iget-object v2, v4, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v0, v2}, Lcom/android/server/AttributeCache;->removePackage(Ljava/lang/String;)V
    :try_end_b6
    .catchall {:try_start_aa .. :try_end_b6} :catchall_129

    .line 23730
    .end local v1  # "info":Landroid/content/pm/ApplicationInfo;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "outInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v17  # "deleteFlags":I
    move-object/from16 v0, v18

    goto/16 :goto_2c

    .line 23716
    .restart local v1  # "info":Landroid/content/pm/ApplicationInfo;
    .restart local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "outInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v17  # "deleteFlags":I
    .restart local v22  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :catchall_ba
    move-exception v0

    move-object/from16 v2, v22

    move-object v3, v0

    .end local v22  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v2  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    goto :goto_d4

    .end local v2  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v22  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v24  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_bf
    move-exception v0

    move-object/from16 v2, v22

    move-object/from16 v4, v24

    move-object v3, v0

    .end local v22  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v24  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v2  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    goto :goto_d4

    .end local v1  # "info":Landroid/content/pm/ApplicationInfo;
    .end local v2  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v22  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v23  # "info":Landroid/content/pm/ApplicationInfo;
    .restart local v24  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_c6
    move-exception v0

    move-object/from16 v2, v22

    move-object/from16 v1, v23

    move-object/from16 v4, v24

    move-object v3, v0

    .end local v22  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v23  # "info":Landroid/content/pm/ApplicationInfo;
    .end local v24  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v1  # "info":Landroid/content/pm/ApplicationInfo;
    .restart local v2  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    goto :goto_d4

    .end local v1  # "info":Landroid/content/pm/ApplicationInfo;
    .end local v2  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v6  # "info":Landroid/content/pm/ApplicationInfo;
    .restart local v8  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_cf
    move-exception v0

    move-object v2, v5

    move-object v1, v6

    move-object v4, v8

    move-object v3, v0

    .end local v5  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v6  # "info":Landroid/content/pm/ApplicationInfo;
    .end local v7  # "outInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v8  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "volumeUuid":Ljava/lang/String;
    .end local v13  # "unloaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    .end local v16  # "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    .end local v17  # "deleteFlags":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "vol":Landroid/os/storage/VolumeInfo;
    :goto_d4
    :try_start_d4
    throw v3
    :try_end_d5
    .catchall {:try_start_d4 .. :try_end_d5} :catchall_d5

    .line 23724
    .restart local v1  # "info":Landroid/content/pm/ApplicationInfo;
    .restart local v2  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "outInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v12  # "volumeUuid":Ljava/lang/String;
    .restart local v13  # "unloaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    .restart local v16  # "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    .restart local v17  # "deleteFlags":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "vol":Landroid/os/storage/VolumeInfo;
    :catchall_d5
    move-exception v0

    move-object v5, v0

    if-eqz v2, :cond_dc

    :try_start_d9
    invoke-static {v3, v2}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    .end local v12  # "volumeUuid":Ljava/lang/String;
    .end local v13  # "unloaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "vol":Landroid/os/storage/VolumeInfo;
    :cond_dc
    throw v5

    .line 23732
    .end local v1  # "info":Landroid/content/pm/ApplicationInfo;
    .end local v2  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "outInfo":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v17  # "deleteFlags":I
    .restart local v12  # "volumeUuid":Ljava/lang/String;
    .restart local v13  # "unloaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "vol":Landroid/os/storage/VolumeInfo;
    :cond_dd
    move-object v0, v9

    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 23733
    .end local v16  # "packages":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageSetting;>;"
    monitor-exit v15
    :try_end_e4
    .catchall {:try_start_d9 .. :try_end_e4} :catchall_129

    .line 23734
    :try_start_e4
    monitor-exit v14
    :try_end_e5
    .catchall {:try_start_e4 .. :try_end_e5} :catchall_12c

    .line 23736
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v1, :cond_ff

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unloaded packages "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 23737
    :cond_ff
    const/4 v1, 0x0

    invoke-direct {v10, v1, v1, v13, v0}, Lcom/android/server/pm/PackageManagerService;->sendResourcesChangedBroadcast(ZZLjava/util/ArrayList;Landroid/content/IIntentReceiver;)V

    .line 23738
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mLoadedVolumes:Landroid/util/ArraySet;

    invoke-virtual/range {p1 .. p1}, Landroid/os/storage/VolumeInfo;->getId()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Landroid/util/ArraySet;->remove(Ljava/lang/Object;)Z

    .line 23742
    invoke-static {}, Landroid/app/ResourcesManager;->getInstance()Landroid/app/ResourcesManager;

    move-result-object v0

    invoke-virtual/range {p1 .. p1}, Landroid/os/storage/VolumeInfo;->getPath()Ljava/io/File;

    move-result-object v1

    invoke-virtual {v1}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Landroid/app/ResourcesManager;->invalidatePath(Ljava/lang/String;)V

    .line 23744
    const/4 v0, 0x0

    .local v0, "i":I
    :goto_11c
    const/4 v1, 0x3

    if-ge v0, v1, :cond_128

    .line 23745
    invoke-static {}, Ljava/lang/System;->gc()V

    .line 23746
    invoke-static {}, Ljava/lang/System;->runFinalization()V

    .line 23744
    add-int/lit8 v0, v0, 0x1

    goto :goto_11c

    .line 23748
    .end local v0  # "i":I
    :cond_128
    return-void

    .line 23733
    :catchall_129
    move-exception v0

    :try_start_12a
    monitor-exit v15
    :try_end_12b
    .catchall {:try_start_12a .. :try_end_12b} :catchall_129

    .end local v12  # "volumeUuid":Ljava/lang/String;
    .end local v13  # "unloaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "vol":Landroid/os/storage/VolumeInfo;
    :try_start_12b
    throw v0

    .line 23734
    .restart local v12  # "volumeUuid":Ljava/lang/String;
    .restart local v13  # "unloaded":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ApplicationInfo;>;"
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "vol":Landroid/os/storage/VolumeInfo;
    :catchall_12c
    move-exception v0

    monitor-exit v14
    :try_end_12e
    .catchall {:try_start_12b .. :try_end_12e} :catchall_12c

    throw v0
.end method

.method private unsuspendForSuspendingPackages(Ljava/util/function/Predicate;I)V
    .registers 16
    .param p2, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/function/Predicate<",
            "Ljava/lang/String;",
            ">;I)V"
        }
    .end annotation

    .line 14489
    .local p1, "packagePredicate":Ljava/util/function/Predicate;, "Ljava/util/function/Predicate<Ljava/lang/String;>;"
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 14490
    .local v0, "affectedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    new-instance v1, Landroid/util/IntArray;

    invoke-direct {v1}, Landroid/util/IntArray;-><init>()V

    .line 14491
    .local v1, "affectedUids":Landroid/util/IntArray;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 14492
    :try_start_d
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :goto_19
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_51

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 14493
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v4, p2}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v5

    move-object v12, v5

    .line 14494
    .local v12, "pus":Landroid/content/pm/PackageUserState;
    iget-boolean v5, v12, Landroid/content/pm/PackageUserState;->suspended:Z

    if-eqz v5, :cond_50

    iget-object v5, v12, Landroid/content/pm/PackageUserState;->suspendingPackage:Ljava/lang/String;

    invoke-interface {p1, v5}, Ljava/util/function/Predicate;->test(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_50

    .line 14495
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    move-object v5, v4

    move v11, p2

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/pm/PackageSetting;->setSuspended(ZLjava/lang/String;Landroid/content/pm/SuspendDialogInfo;Landroid/os/PersistableBundle;Landroid/os/PersistableBundle;I)V

    .line 14496
    iget-object v5, v4, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-interface {v0, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 14497
    invoke-virtual {v4}, Lcom/android/server/pm/PackageSetting;->getAppId()I

    move-result v5

    invoke-static {p2, v5}, Landroid/os/UserHandle;->getUid(II)I

    move-result v5

    invoke-virtual {v1, v5}, Landroid/util/IntArray;->add(I)V

    .line 14499
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "pus":Landroid/content/pm/PackageUserState;
    :cond_50
    goto :goto_19

    .line 14500
    :cond_51
    monitor-exit v2
    :try_end_52
    .catchall {:try_start_d .. :try_end_52} :catchall_7d

    .line 14501
    invoke-interface {v0}, Ljava/util/List;->isEmpty()Z

    move-result v2

    if-nez v2, :cond_7c

    .line 14502
    nop

    .line 14503
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v2

    new-array v2, v2, [Ljava/lang/String;

    .line 14502
    invoke-interface {v0, v2}, Ljava/util/List;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v2

    check-cast v2, [Ljava/lang/String;

    .line 14504
    .local v2, "packageArray":[Ljava/lang/String;
    const/4 v3, 0x0

    const/4 v4, 0x0

    invoke-direct {p0, v2, v3, v4, p2}, Lcom/android/server/pm/PackageManagerService;->sendMyPackageSuspendedOrUnsuspended([Ljava/lang/String;ZLandroid/os/PersistableBundle;I)V

    .line 14505
    nop

    .line 14506
    invoke-virtual {v1}, Landroid/util/IntArray;->toArray()[I

    move-result-object v5

    const/4 v7, 0x0

    const/4 v8, 0x0

    .line 14505
    move-object v3, p0

    move-object v4, v2

    move v6, p2

    invoke-direct/range {v3 .. v8}, Lcom/android/server/pm/PackageManagerService;->sendPackagesSuspendedForUser([Ljava/lang/String;[IIZLandroid/os/PersistableBundle;)V

    .line 14508
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, p2}, Lcom/android/server/pm/Settings;->writePackageRestrictionsLPr(I)V

    .line 14510
    .end local v2  # "packageArray":[Ljava/lang/String;
    :cond_7c
    return-void

    .line 14500
    :catchall_7d
    move-exception v3

    :try_start_7e
    monitor-exit v2
    :try_end_7f
    .catchall {:try_start_7e .. :try_end_7f} :catchall_7d

    throw v3
.end method

.method private updateAllSharedLibrariesLocked(Landroid/content/pm/PackageParser$Package;Ljava/util/Map;)Ljava/util/ArrayList;
    .registers 24
    .param p1, "updatedPkg"  # Landroid/content/pm/PackageParser$Package;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageParser$Package;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/content/pm/PackageParser$Package;",
            ">;)",
            "Ljava/util/ArrayList<",
            "Landroid/content/pm/PackageParser$Package;",
            ">;"
        }
    .end annotation

    .line 11126
    .local p2, "availablePackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    move-object/from16 v10, p0

    move-object/from16 v11, p1

    const/4 v0, 0x0

    .line 11128
    .local v0, "resultList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    const/4 v1, 0x0

    .line 11130
    .local v1, "descendants":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    const/4 v2, 0x0

    .line 11131
    .local v2, "needsUpdating":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    const/4 v12, 0x1

    if-eqz v11, :cond_15

    .line 11132
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3, v12}, Ljava/util/ArrayList;-><init>(I)V

    move-object v2, v3

    .line 11133
    invoke-virtual {v2, v11}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    move-object v13, v2

    goto :goto_16

    .line 11131
    :cond_15
    move-object v13, v2

    .line 11137
    .end local v2  # "needsUpdating":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    .local v13, "needsUpdating":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    :cond_16
    :goto_16
    const/4 v14, 0x0

    if-nez v13, :cond_1b

    const/4 v2, 0x0

    goto :goto_21

    :cond_1b
    invoke-virtual {v13, v14}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    :goto_21
    move-object v15, v2

    .line 11138
    .local v15, "changingPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v2, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->size()I

    move-result v2

    sub-int/2addr v2, v12

    move v9, v2

    .local v9, "i":I
    :goto_2a
    if-ltz v9, :cond_f6

    .line 11139
    iget-object v2, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, v9}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    move-object v8, v2

    check-cast v8, Landroid/content/pm/PackageParser$Package;

    .line 11140
    .local v8, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v15, :cond_59

    iget-object v2, v8, Landroid/content/pm/PackageParser$Package;->usesLibraries:Ljava/util/ArrayList;

    iget-object v3, v15, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    .line 11141
    invoke-static {v2, v3}, Lcom/android/server/pm/PackageManagerService;->hasString(Ljava/util/List;Ljava/util/List;)Z

    move-result v2

    if-nez v2, :cond_59

    iget-object v2, v8, Landroid/content/pm/PackageParser$Package;->usesOptionalLibraries:Ljava/util/ArrayList;

    iget-object v3, v15, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    .line 11142
    invoke-static {v2, v3}, Lcom/android/server/pm/PackageManagerService;->hasString(Ljava/util/List;Ljava/util/List;)Z

    move-result v2

    if-nez v2, :cond_59

    iget-object v2, v8, Landroid/content/pm/PackageParser$Package;->usesStaticLibraries:Ljava/util/ArrayList;

    iget-object v3, v15, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    .line 11143
    invoke-static {v2, v3}, Lcom/android/internal/util/ArrayUtils;->contains(Ljava/util/Collection;Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_59

    .line 11145
    move/from16 v19, v9

    goto/16 :goto_f2

    .line 11147
    :cond_59
    if-nez v0, :cond_63

    .line 11148
    new-instance v2, Ljava/util/ArrayList;

    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V

    move-object v0, v2

    move-object v7, v0

    goto :goto_64

    .line 11147
    :cond_63
    move-object v7, v0

    .line 11150
    .end local v0  # "resultList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    .local v7, "resultList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    :goto_64
    invoke-virtual {v7, v8}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11152
    if-eqz v15, :cond_84

    .line 11153
    if-nez v1, :cond_71

    .line 11154
    new-instance v0, Landroid/util/ArraySet;

    invoke-direct {v0}, Landroid/util/ArraySet;-><init>()V

    move-object v1, v0

    .line 11156
    :cond_71
    iget-object v0, v8, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v0}, Landroid/util/ArraySet;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_81

    .line 11157
    iget-object v0, v8, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v0}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 11158
    invoke-virtual {v13, v8}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11162
    :cond_81
    move-object/from16 v16, v1

    goto :goto_86

    .line 11152
    :cond_84
    move-object/from16 v16, v1

    .line 11162
    .end local v1  # "descendants":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .local v16, "descendants":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    :goto_86
    move-object/from16 v5, p2

    :try_start_88
    invoke-direct {v10, v8, v15, v5}, Lcom/android/server/pm/PackageManagerService;->updateSharedLibrariesLocked(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/Map;)V
    :try_end_8b
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_88 .. :try_end_8b} :catch_90

    .line 11176
    move-object/from16 v17, v7

    move/from16 v19, v9

    goto :goto_ee

    .line 11163
    :catch_90
    move-exception v0

    move-object v1, v0

    move-object v0, v1

    .line 11169
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    invoke-virtual {v8}, Landroid/content/pm/PackageParser$Package;->isSystem()Z

    move-result v1

    if-eqz v1, :cond_a7

    invoke-virtual {v8}, Landroid/content/pm/PackageParser$Package;->isUpdatedSystemApp()Z

    move-result v1

    if-eqz v1, :cond_a0

    goto :goto_a7

    :cond_a0
    move-object/from16 v17, v7

    move-object/from16 v18, v8

    move/from16 v19, v9

    goto :goto_d3

    .line 11170
    :cond_a7
    :goto_a7
    invoke-virtual {v8}, Landroid/content/pm/PackageParser$Package;->isUpdatedSystemApp()Z

    move-result v1

    if-eqz v1, :cond_af

    .line 11171
    move v6, v12

    goto :goto_b0

    :cond_af
    move v6, v14

    .line 11172
    .local v6, "flags":I
    :goto_b0
    iget-object v2, v8, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v3, 0x0

    const/4 v4, 0x1

    sget-object v1, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v17

    const/16 v18, 0x0

    const/16 v19, 0x1

    const/16 v20, 0x0

    move-object/from16 v1, p0

    move-object/from16 v5, v17

    move-object/from16 v17, v7

    .end local v7  # "resultList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    .local v17, "resultList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    move-object/from16 v7, v18

    move-object/from16 v18, v8

    .end local v8  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v18, "pkg":Landroid/content/pm/PackageParser$Package;
    move/from16 v8, v19

    move/from16 v19, v9

    .end local v9  # "i":I
    .local v19, "i":I
    move-object/from16 v9, v20

    invoke-direct/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->deletePackageLIF(Ljava/lang/String;Landroid/os/UserHandle;Z[IILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ZLandroid/content/pm/PackageParser$Package;)Z

    .line 11175
    .end local v6  # "flags":I
    :goto_d3
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v2, "updateAllSharedLibrariesLPw failed: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Lcom/android/server/pm/PackageManagerException;->getMessage()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 11138
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    .end local v17  # "resultList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    .end local v18  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v19  # "i":I
    .restart local v7  # "resultList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    .restart local v9  # "i":I
    :goto_ee
    move-object/from16 v1, v16

    move-object/from16 v0, v17

    .end local v7  # "resultList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    .end local v9  # "i":I
    .end local v16  # "descendants":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .local v0, "resultList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    .restart local v1  # "descendants":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .restart local v19  # "i":I
    :goto_f2
    add-int/lit8 v9, v19, -0x1

    .end local v19  # "i":I
    .restart local v9  # "i":I
    goto/16 :goto_2a

    :cond_f6
    move/from16 v19, v9

    .line 11178
    .end local v9  # "i":I
    .end local v15  # "changingPkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v13, :cond_100

    invoke-virtual {v13}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-gtz v2, :cond_16

    .line 11179
    :cond_100
    return-object v0
.end method

.method private updateDefaultHomeNotLocked(Landroid/util/SparseBooleanArray;)V
    .registers 5
    .param p1, "userIds"  # Landroid/util/SparseBooleanArray;

    .line 21937
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-static {v0}, Ljava/lang/Thread;->holdsLock(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_30

    .line 21938
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Calling thread "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-static {}, Ljava/lang/Thread;->currentThread()Ljava/lang/Thread;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/Thread;->getName()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " is holding mPackages"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    new-instance v1, Ljava/lang/Throwable;

    invoke-direct {v1}, Ljava/lang/Throwable;-><init>()V

    const-string v2, "PackageManager"

    invoke-static {v2, v0, v1}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 21941
    :cond_30
    invoke-virtual {p1}, Landroid/util/SparseBooleanArray;->size()I

    move-result v0

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_36
    if-ltz v0, :cond_42

    .line 21942
    invoke-virtual {p1, v0}, Landroid/util/SparseBooleanArray;->keyAt(I)I

    move-result v1

    .line 21943
    .local v1, "userId":I
    invoke-direct {p0, v1}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(I)Z

    .line 21941
    .end local v1  # "userId":I
    add-int/lit8 v0, v0, -0x1

    goto :goto_36

    .line 21945
    .end local v0  # "i":I
    :cond_42
    return-void
.end method

.method private updateDefaultHomeNotLocked(I)Z
    .registers 16
    .param p1, "userId"  # I

    .line 21953
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-static {v0}, Ljava/lang/Thread;->holdsLock(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_30

    .line 21954
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Calling thread "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-static {}, Ljava/lang/Thread;->currentThread()Ljava/lang/Thread;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/Thread;->getName()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " is holding mPackages"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    new-instance v1, Ljava/lang/Throwable;

    invoke-direct {v1}, Ljava/lang/Throwable;-><init>()V

    const-string v2, "PackageManager"

    invoke-static {v2, v0, v1}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 21957
    :cond_30
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mSystemReady:Z

    const/4 v1, 0x0

    if-nez v0, :cond_36

    .line 21961
    return v1

    .line 21963
    :cond_36
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getHomeIntent()Landroid/content/Intent;

    move-result-object v0

    .line 21964
    .local v0, "intent":Landroid/content/Intent;
    const/16 v2, 0x80

    const/4 v12, 0x0

    invoke-direct {p0, v0, v12, v2, p1}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v13

    .line 21966
    .local v13, "resolveInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x1

    const/4 v9, 0x0

    const/4 v10, 0x0

    move-object v2, p0

    move-object v3, v0

    move-object v6, v13

    move v11, p1

    invoke-virtual/range {v2 .. v11}, Lcom/android/server/pm/PackageManagerService;->findPreferredActivityNotLocked(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;IZZZI)Landroid/content/pm/ResolveInfo;

    move-result-object v2

    .line 21969
    .local v2, "preferredResolveInfo":Landroid/content/pm/ResolveInfo;
    if-eqz v2, :cond_5a

    iget-object v3, v2, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    if-eqz v3, :cond_5a

    .line 21970
    iget-object v3, v2, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v12, v3, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    goto :goto_5b

    :cond_5a
    nop

    :goto_5b
    move-object v3, v12

    .line 21972
    .local v3, "packageName":Ljava/lang/String;
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v4

    .line 21973
    :try_start_5f
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultHomeProvider:Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;

    .line 21974
    .local v5, "provider":Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;
    monitor-exit v4
    :try_end_62
    .catchall {:try_start_5f .. :try_end_62} :catchall_94

    .line 21975
    if-nez v5, :cond_6c

    .line 21976
    const-string v4, "PackageManager"

    const-string v6, "Default home provider has not been set"

    invoke-static {v4, v6}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 21977
    return v1

    .line 21979
    :cond_6c
    invoke-interface {v5, p1}, Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;->getDefaultHome(I)Ljava/lang/String;

    move-result-object v4

    .line 21980
    .local v4, "currentPackageName":Ljava/lang/String;
    invoke-static {v4, v3}, Landroid/text/TextUtils;->equals(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Z

    move-result v6

    if-eqz v6, :cond_77

    .line 21981
    return v1

    .line 21983
    :cond_77
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {p0, v6}, Lcom/android/server/pm/PackageManagerService;->getPackagesForUid(I)[Ljava/lang/String;

    move-result-object v6

    .line 21984
    .local v6, "callingPackages":[Ljava/lang/String;
    if-eqz v6, :cond_8a

    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredPermissionControllerPackage:Ljava/lang/String;

    invoke-static {v6, v7}, Lcom/android/internal/util/ArrayUtils;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_8a

    .line 21987
    return v1

    .line 21989
    :cond_8a
    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$qwyU25HqNXbbzFqzpDmVq8u1E1k;

    invoke-direct {v1, p0, p1}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$qwyU25HqNXbbzFqzpDmVq8u1E1k;-><init>(Lcom/android/server/pm/PackageManagerService;I)V

    invoke-interface {v5, v3, p1, v1}, Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;->setDefaultHomeAsync(Ljava/lang/String;ILjava/util/function/Consumer;)V

    .line 21994
    const/4 v1, 0x1

    return v1

    .line 21974
    .end local v4  # "currentPackageName":Ljava/lang/String;
    .end local v5  # "provider":Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;
    .end local v6  # "callingPackages":[Ljava/lang/String;
    :catchall_94
    move-exception v1

    :try_start_95
    monitor-exit v4
    :try_end_96
    .catchall {:try_start_95 .. :try_end_96} :catchall_94

    throw v1
.end method

.method private static updateDigest(Ljava/security/MessageDigest;Ljava/io/File;)V
    .registers 5
    .param p0, "digest"  # Ljava/security/MessageDigest;
    .param p1, "file"  # Ljava/io/File;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .line 16795
    new-instance v0, Ljava/security/DigestInputStream;

    new-instance v1, Ljava/io/FileInputStream;

    invoke-direct {v1, p1}, Ljava/io/FileInputStream;-><init>(Ljava/io/File;)V

    invoke-direct {v0, v1, p0}, Ljava/security/DigestInputStream;-><init>(Ljava/io/InputStream;Ljava/security/MessageDigest;)V

    .line 16797
    .local v0, "digestStream":Ljava/security/DigestInputStream;
    :goto_a
    :try_start_a
    invoke-virtual {v0}, Ljava/security/DigestInputStream;->read()I

    move-result v1
    :try_end_e
    .catchall {:try_start_a .. :try_end_e} :catchall_17

    const/4 v2, -0x1

    if-eq v1, v2, :cond_12

    goto :goto_a

    .line 16798
    :cond_12
    const/4 v1, 0x0

    invoke-static {v1, v0}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    .line 16799
    .end local v0  # "digestStream":Ljava/security/DigestInputStream;
    return-void

    .line 16795
    .restart local v0  # "digestStream":Ljava/security/DigestInputStream;
    :catchall_17
    move-exception v1

    .end local v0  # "digestStream":Ljava/security/DigestInputStream;
    .end local p0  # "digest":Ljava/security/MessageDigest;
    .end local p1  # "file":Ljava/io/File;
    :try_start_18
    throw v1
    :try_end_19
    .catchall {:try_start_18 .. :try_end_19} :catchall_19

    .line 16798
    .restart local v0  # "digestStream":Ljava/security/DigestInputStream;
    .restart local p0  # "digest":Ljava/security/MessageDigest;
    .restart local p1  # "file":Ljava/io/File;
    :catchall_19
    move-exception v2

    invoke-static {v1, v0}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    throw v2
.end method

.method private updateFlags(II)I
    .registers 5
    .param p1, "flags"  # I
    .param p2, "userId"  # I

    .line 5199
    const/high16 v0, 0xc0000

    and-int v1, p1, v0

    if-eqz v1, :cond_7

    goto :goto_16

    .line 5206
    :cond_7
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getUserManagerInternal()Landroid/os/UserManagerInternal;

    move-result-object v1

    invoke-virtual {v1, p2}, Landroid/os/UserManagerInternal;->isUserUnlockingOrUnlocked(I)Z

    move-result v1

    if-eqz v1, :cond_13

    .line 5207
    or-int/2addr p1, v0

    goto :goto_16

    .line 5209
    :cond_13
    const/high16 v0, 0x80000

    or-int/2addr p1, v0

    .line 5212
    :goto_16
    return p1
.end method

.method private updateFlagsForApplication(IILjava/lang/Object;)I
    .registers 5
    .param p1, "flags"  # I
    .param p2, "userId"  # I
    .param p3, "cookie"  # Ljava/lang/Object;

    .line 5280
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForPackage(IILjava/lang/Object;)I

    move-result v0

    return v0
.end method

.method private updateFlagsForComponent(IILjava/lang/Object;)I
    .registers 5
    .param p1, "flags"  # I
    .param p2, "userId"  # I
    .param p3, "cookie"  # Ljava/lang/Object;

    .line 5287
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->updateFlags(II)I

    move-result v0

    return v0
.end method

.method private updateFlagsForPackage(IILjava/lang/Object;)I
    .registers 16
    .param p1, "flags"  # I
    .param p2, "userId"  # I
    .param p3, "cookie"  # Ljava/lang/Object;

    .line 5256
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    const/4 v1, 0x1

    const/4 v2, 0x0

    if-nez v0, :cond_a

    move v0, v1

    goto :goto_b

    :cond_a
    move v0, v2

    .line 5257
    .local v0, "isCallerSystemUser":Z
    :goto_b
    const/high16 v3, 0x400000

    and-int v4, p1, v3

    if-eqz v4, :cond_3e

    .line 5260
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 5261
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    const/4 v8, 0x0

    const/4 v9, 0x0

    .line 5262
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-direct {p0, v2, p2}, Lcom/android/server/pm/PackageManagerService;->isRecentsAccessingChildProfiles(II)Z

    move-result v2

    xor-int/lit8 v10, v2, 0x1

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "MATCH_ANY_USER flag requires INTERACT_ACROSS_USERS permission at "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const/4 v2, 0x5

    .line 5264
    invoke-static {v2}, Landroid/os/Debug;->getCallers(I)Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    .line 5260
    move v7, p2

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZZLjava/lang/String;)V

    goto :goto_4d

    .line 5265
    :cond_3e
    and-int/lit16 v1, p1, 0x2000

    if-eqz v1, :cond_4d

    if-eqz v0, :cond_4d

    sget-object v1, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    .line 5266
    invoke-virtual {v1, v2}, Lcom/android/server/pm/UserManagerService;->hasManagedProfile(I)Z

    move-result v1

    if-eqz v1, :cond_4d

    .line 5271
    or-int/2addr p1, v3

    .line 5273
    :cond_4d
    :goto_4d
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->updateFlags(II)I

    move-result v1

    return v1
.end method

.method private updateInactiveVersion(Ljava/lang/String;)V
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;

    .line 26648
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->bootCompleteInstall:Z

    if-eqz v0, :cond_54

    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->bootPkgName:Ljava/lang/String;

    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_54

    .line 26649
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v0, v0, Lcom/android/server/pm/PackageDefaultOpService;->mPackages:Ljava/util/HashMap;

    invoke-virtual {v0, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    if-eqz v0, :cond_4e

    .line 26651
    :try_start_16
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0
    :try_end_19
    .catch Ljava/lang/Exception; {:try_start_16 .. :try_end_19} :catch_4a

    .line 26652
    :try_start_19
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 26653
    .local v1, "p":Landroid/content/pm/PackageParser$Package;
    const v2, 0x7fffffff

    if-eqz v1, :cond_33

    .line 26654
    iput v2, v1, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    .line 26655
    iget-object v3, v1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 26656
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_33

    .line 26657
    const-wide/32 v4, 0x7fffffff

    iput-wide v4, v3, Lcom/android/server/pm/PackageSetting;->versionCode:J

    .line 26660
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_33
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 26661
    .restart local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_45

    .line 26662
    iget-object v4, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 26663
    .local v4, "opser":Landroid/content/pm/PackageParser$Package;
    if-eqz v4, :cond_45

    .line 26664
    iput v2, v1, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    .line 26667
    .end local v1  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "opser":Landroid/content/pm/PackageParser$Package;
    :cond_45
    monitor-exit v0

    .line 26671
    goto :goto_4e

    .line 26667
    :catchall_47
    move-exception v1

    monitor-exit v0
    :try_end_49
    .catchall {:try_start_19 .. :try_end_49} :catchall_47

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    :try_start_49
    throw v1
    :try_end_4a
    .catch Ljava/lang/Exception; {:try_start_49 .. :try_end_4a} :catch_4a

    .line 26669
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    :catch_4a
    move-exception v0

    .line 26670
    .local v0, "e":Ljava/lang/Exception;
    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V

    .line 26673
    .end local v0  # "e":Ljava/lang/Exception;
    :cond_4e
    :goto_4e
    const/4 v0, 0x0

    iput-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->bootCompleteInstall:Z

    .line 26674
    const/4 v0, 0x0

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->bootPkgName:Ljava/lang/String;

    .line 26677
    :cond_54
    return-void
.end method

.method private updateInstantAppInstallerLocked(Ljava/lang/String;)V
    .registers 3
    .param p1, "modifiedPackage"  # Ljava/lang/String;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 3802
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    if-eqz v0, :cond_13

    .line 3803
    invoke-virtual {v0}, Landroid/content/pm/ActivityInfo;->getComponentName()Landroid/content/ComponentName;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    .line 3804
    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_13

    .line 3805
    return-void

    .line 3807
    :cond_13
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppInstallerLPr()Landroid/content/pm/ActivityInfo;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->setUpInstantAppInstallerActivityLP(Landroid/content/pm/ActivityInfo;)V

    .line 3808
    return-void
.end method

.method private updateIntentForResolve(Landroid/content/Intent;)Landroid/content/Intent;
    .registers 3
    .param p1, "intent"  # Landroid/content/Intent;

    .line 5294
    invoke-virtual {p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object v0

    if-eqz v0, :cond_a

    .line 5295
    invoke-virtual {p1}, Landroid/content/Intent;->getSelector()Landroid/content/Intent;

    move-result-object p1

    .line 5297
    :cond_a
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v0, :cond_13

    .line 5298
    const/16 v0, 0x8

    invoke-virtual {p1, v0}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 5300
    :cond_13
    return-object p1
.end method

.method private updateSequenceNumberLP(Lcom/android/server/pm/PackageSetting;[I)V
    .registers 10
    .param p1, "pkgSetting"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "userList"  # [I
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 5776
    array-length v0, p2

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_3
    if-ltz v0, :cond_5e

    .line 5777
    aget v1, p2, v0

    .line 5779
    .local v1, "userId":I
    invoke-virtual {p1, v1}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v2

    if-eqz v2, :cond_e

    .line 5780
    goto :goto_5b

    .line 5782
    :cond_e
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackages:Landroid/util/SparseArray;

    invoke-virtual {v2, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/util/SparseArray;

    .line 5783
    .local v2, "changedPackages":Landroid/util/SparseArray;, "Landroid/util/SparseArray<Ljava/lang/String;>;"
    if-nez v2, :cond_23

    .line 5784
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    move-object v2, v3

    .line 5785
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackages:Landroid/util/SparseArray;

    invoke-virtual {v3, v1, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 5787
    :cond_23
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumbers:Landroid/util/SparseArray;

    invoke-virtual {v3, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/util/Map;

    .line 5788
    .local v3, "sequenceNumbers":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Integer;>;"
    if-nez v3, :cond_38

    .line 5789
    new-instance v4, Ljava/util/HashMap;

    invoke-direct {v4}, Ljava/util/HashMap;-><init>()V

    move-object v3, v4

    .line 5790
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumbers:Landroid/util/SparseArray;

    invoke-virtual {v4, v1, v3}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 5792
    :cond_38
    iget-object v4, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-interface {v3, v4}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/Integer;

    .line 5793
    .local v4, "sequenceNumber":Ljava/lang/Integer;
    if-eqz v4, :cond_49

    .line 5794
    invoke-virtual {v4}, Ljava/lang/Integer;->intValue()I

    move-result v5

    invoke-virtual {v2, v5}, Landroid/util/SparseArray;->remove(I)V

    .line 5796
    :cond_49
    iget v5, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumber:I

    iget-object v6, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v2, v5, v6}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 5797
    iget-object v5, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    iget v6, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumber:I

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    invoke-interface {v3, v5, v6}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 5776
    .end local v1  # "userId":I
    .end local v2  # "changedPackages":Landroid/util/SparseArray;, "Landroid/util/SparseArray<Ljava/lang/String;>;"
    .end local v3  # "sequenceNumbers":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Integer;>;"
    .end local v4  # "sequenceNumber":Ljava/lang/Integer;
    :goto_5b
    add-int/lit8 v0, v0, -0x1

    goto :goto_3

    .line 5799
    .end local v0  # "i":I
    :cond_5e
    iget v0, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumber:I

    add-int/lit8 v0, v0, 0x1

    iput v0, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumber:I

    .line 5800
    return-void
.end method

.method private updateSettingsInternalLI(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;[I[ILcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/os/UserHandle;I)V
    .registers 28
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "installerPackageName"  # Ljava/lang/String;
    .param p3, "allUsers"  # [I
    .param p4, "installedForUsers"  # [I
    .param p5, "res"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .param p6, "user"  # Landroid/os/UserHandle;
    .param p7, "installReason"  # I

    .line 16910
    move-object/from16 v1, p0

    move-object/from16 v8, p1

    move-object/from16 v9, p2

    move-object/from16 v10, p3

    move-object/from16 v11, p4

    move-object/from16 v12, p5

    move/from16 v13, p7

    const-wide/32 v14, 0x40000

    const-string/jumbo v0, "updateSettings"

    invoke-static {v14, v15, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 16912
    iget-object v7, v8, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 16914
    .local v7, "pkgName":Ljava/lang/String;
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_35

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "New package installed in "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v2, v8, Landroid/content/pm/PackageParser$Package;->codePath:Ljava/lang/String;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v2, "PackageManager"

    invoke-static {v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 16915
    :cond_35
    const/4 v0, 0x0

    if-eqz v7, :cond_3d

    .line 16916
    const/16 v2, 0x8

    invoke-direct {v1, v2, v7, v0}, Lcom/android/server/pm/PackageManagerService;->acquireUxPerfLock(ILjava/lang/String;I)V

    .line 16917
    :cond_3d
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6

    .line 16919
    :try_start_40
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v3, v8, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v5, 0x1

    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v16

    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;
    :try_end_4d
    .catchall {:try_start_40 .. :try_end_4d} :catchall_18e

    move-object/from16 v17, v4

    move-object/from16 v4, p1

    move-object/from16 v18, v6

    move-object/from16 v6, v16

    move-object v14, v7

    .end local v7  # "pkgName":Ljava/lang/String;
    .local v14, "pkgName":Ljava/lang/String;
    move-object/from16 v7, v17

    :try_start_58
    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updatePermissions(Ljava/lang/String;Landroid/content/pm/PackageParser$Package;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 16924
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, v14}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 16925
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual/range {p6 .. p6}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v3

    .line 16926
    .local v3, "userId":I
    if-eqz v2, :cond_165

    .line 16927
    invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z

    move-result v5

    const/4 v6, -0x1

    if-eqz v5, :cond_e8

    .line 16928
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v5, :cond_8c

    .line 16929
    const-string v5, "PackageManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Implicitly enabling system package on upgrade: "

    invoke-virtual {v7, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v5, v7}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 16932
    :cond_8c
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origUsers:[I

    if-eqz v5, :cond_a9

    .line 16933
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origUsers:[I

    array-length v7, v5

    move v15, v0

    :goto_94
    if-ge v15, v7, :cond_a9

    aget v16, v5, v15

    move/from16 v17, v16

    .line 16934
    .local v17, "origUserId":I
    if-eq v3, v6, :cond_a1

    move/from16 v4, v17

    .end local v17  # "origUserId":I
    .local v4, "origUserId":I
    if-ne v3, v4, :cond_a6

    goto :goto_a3

    .end local v4  # "origUserId":I
    .restart local v17  # "origUserId":I
    :cond_a1
    move/from16 v4, v17

    .line 16935
    .end local v17  # "origUserId":I
    .restart local v4  # "origUserId":I
    :goto_a3
    invoke-virtual {v2, v0, v4, v9}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    .line 16933
    .end local v4  # "origUserId":I
    :cond_a6
    add-int/lit8 v15, v15, 0x1

    goto :goto_94

    .line 16941
    :cond_a9
    if-eqz v10, :cond_e8

    if-eqz v11, :cond_e8

    .line 16942
    array-length v4, v10

    move v5, v0

    :goto_af
    if-ge v5, v4, :cond_e8

    aget v7, v10, v5

    .line 16943
    .local v7, "currentUserId":I
    invoke-static {v11, v7}, Lcom/android/internal/util/ArrayUtils;->contains([II)Z

    move-result v15

    .line 16945
    .local v15, "installed":Z
    sget-boolean v17, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v17, :cond_dc

    .line 16946
    const-string v0, "PackageManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v19, v4

    const-string v4, "    user "

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, " => "

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v15}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v0, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_de

    .line 16945
    :cond_dc
    move/from16 v19, v4

    .line 16948
    :goto_de
    invoke-virtual {v2, v15, v7}, Lcom/android/server/pm/PackageSetting;->setInstalled(ZI)V

    .line 16942
    .end local v7  # "currentUserId":I
    .end local v15  # "installed":Z
    add-int/lit8 v5, v5, 0x1

    move/from16 v4, v19

    const/4 v0, 0x0

    const/4 v6, -0x1

    goto :goto_af

    .line 16956
    :cond_e8
    const/4 v0, -0x1

    if-eq v3, v0, :cond_f4

    .line 16957
    const/4 v0, 0x1

    invoke-virtual {v2, v0, v3}, Lcom/android/server/pm/PackageSetting;->setInstalled(ZI)V

    .line 16958
    const/4 v0, 0x0

    invoke-virtual {v2, v0, v3, v9}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    goto :goto_f5

    .line 16956
    :cond_f4
    const/4 v0, 0x0

    .line 16963
    :goto_f5
    new-instance v4, Landroid/util/ArraySet;

    invoke-direct {v4}, Landroid/util/ArraySet;-><init>()V

    .line 16964
    .local v4, "previousUserIds":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/Integer;>;"
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    if-eqz v5, :cond_134

    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v5, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installReasons:Landroid/util/SparseArray;

    if-eqz v5, :cond_134

    .line 16965
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v5, v5, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installReasons:Landroid/util/SparseArray;

    invoke-virtual {v5}, Landroid/util/SparseArray;->size()I

    move-result v5

    .line 16966
    .local v5, "installReasonCount":I
    const/4 v6, 0x0

    .local v6, "i":I
    :goto_10d
    if-ge v6, v5, :cond_134

    .line 16967
    iget-object v7, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v7, v7, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installReasons:Landroid/util/SparseArray;

    invoke-virtual {v7, v6}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v7

    .line 16968
    .local v7, "previousUserId":I
    iget-object v15, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v15, v15, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->installReasons:Landroid/util/SparseArray;

    invoke-virtual {v15, v6}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Ljava/lang/Integer;

    invoke-virtual {v15}, Ljava/lang/Integer;->intValue()I

    move-result v15

    .line 16969
    .local v15, "previousInstallReason":I
    invoke-virtual {v2, v15, v7}, Lcom/android/server/pm/PackageSetting;->setInstallReason(II)V

    .line 16970
    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v0

    invoke-interface {v4, v0}, Ljava/util/Set;->add(Ljava/lang/Object;)Z

    .line 16966
    nop

    .end local v7  # "previousUserId":I
    .end local v15  # "previousInstallReason":I
    add-int/lit8 v6, v6, 0x1

    const/4 v0, 0x0

    goto :goto_10d

    .line 16975
    .end local v5  # "installReasonCount":I
    .end local v6  # "i":I
    :cond_134
    const/4 v0, -0x1

    if-ne v3, v0, :cond_153

    .line 16976
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0

    array-length v5, v0

    const/4 v6, 0x0

    :goto_13f
    if-ge v6, v5, :cond_160

    aget v7, v0, v6

    .line 16977
    .local v7, "currentUserId":I
    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v15

    invoke-interface {v4, v15}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v15

    if-nez v15, :cond_150

    .line 16978
    invoke-virtual {v2, v13, v7}, Lcom/android/server/pm/PackageSetting;->setInstallReason(II)V

    .line 16976
    .end local v7  # "currentUserId":I
    :cond_150
    add-int/lit8 v6, v6, 0x1

    goto :goto_13f

    .line 16981
    :cond_153
    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v0

    invoke-interface {v4, v0}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_160

    .line 16982
    invoke-virtual {v2, v13, v3}, Lcom/android/server/pm/PackageSetting;->setInstallReason(II)V

    .line 16984
    :cond_160
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v2}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V

    .line 16986
    .end local v4  # "previousUserIds":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/Integer;>;"
    :cond_165
    iput-object v14, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->name:Ljava/lang/String;

    .line 16987
    iget-object v0, v8, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v0, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->uid:I

    .line 16988
    iput-object v8, v12, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 16989
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v14, v9}, Lcom/android/server/pm/Settings;->setInstallerPackageName(Ljava/lang/String;Ljava/lang/String;)V

    .line 16990
    const/4 v0, 0x1

    invoke-virtual {v12, v0}, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->setReturnCode(I)V

    .line 16992
    const-string/jumbo v0, "writeSettings"

    const-wide/32 v4, 0x40000

    invoke-static {v4, v5, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 16993
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 16994
    invoke-static {v4, v5}, Landroid/os/Trace;->traceEnd(J)V

    .line 16995
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "userId":I
    monitor-exit v18
    :try_end_18a
    .catchall {:try_start_58 .. :try_end_18a} :catchall_194

    .line 16997
    invoke-static {v4, v5}, Landroid/os/Trace;->traceEnd(J)V

    .line 16998
    return-void

    .line 16995
    .end local v14  # "pkgName":Ljava/lang/String;
    .local v7, "pkgName":Ljava/lang/String;
    :catchall_18e
    move-exception v0

    move-object/from16 v18, v6

    move-object v14, v7

    .end local v7  # "pkgName":Ljava/lang/String;
    .restart local v14  # "pkgName":Ljava/lang/String;
    :goto_192
    :try_start_192
    monitor-exit v18
    :try_end_193
    .catchall {:try_start_192 .. :try_end_193} :catchall_194

    throw v0

    :catchall_194
    move-exception v0

    goto :goto_192
.end method

.method private updateSettingsLI(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;[ILcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/os/UserHandle;I)V
    .registers 25
    .param p1, "newPackage"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "installerPackageName"  # Ljava/lang/String;
    .param p3, "allUsers"  # [I
    .param p4, "res"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .param p5, "user"  # Landroid/os/UserHandle;
    .param p6, "installReason"  # I

    .line 16894
    move-object/from16 v8, p1

    move-object/from16 v9, p4

    iget-object v4, v9, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origUsers:[I

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    move-object/from16 v3, p3

    move-object/from16 v5, p4

    move-object/from16 v6, p5

    move/from16 v7, p6

    invoke-direct/range {v0 .. v7}, Lcom/android/server/pm/PackageManagerService;->updateSettingsInternalLI(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;[I[ILcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/os/UserHandle;I)V

    .line 16897
    iget-object v0, v8, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v0, :cond_22

    .line 16898
    iget-object v0, v8, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_23

    :cond_22
    const/4 v0, 0x0

    .line 16899
    .local v0, "childCount":I
    :goto_23
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_24
    if-ge v1, v0, :cond_4c

    .line 16900
    iget-object v2, v8, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 16901
    .local v2, "childPackage":Landroid/content/pm/PackageParser$Package;
    iget-object v3, v9, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->addedChildPackages:Landroid/util/ArrayMap;

    iget-object v4, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    .line 16902
    .local v3, "childRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    iget-object v14, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origUsers:[I

    move-object/from16 v10, p0

    move-object v11, v2

    move-object/from16 v12, p2

    move-object/from16 v13, p3

    move-object v15, v3

    move-object/from16 v16, p5

    move/from16 v17, p6

    invoke-direct/range {v10 .. v17}, Lcom/android/server/pm/PackageManagerService;->updateSettingsInternalLI(Landroid/content/pm/PackageParser$Package;Ljava/lang/String;[I[ILcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/os/UserHandle;I)V

    .line 16899
    .end local v2  # "childPackage":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "childRes":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    add-int/lit8 v1, v1, 0x1

    goto :goto_24

    .line 16905
    .end local v1  # "i":I
    :cond_4c
    return-void
.end method

.method private updateSharedLibrariesLocked(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/Map;)V
    .registers 6
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "changingLib"  # Landroid/content/pm/PackageParser$Package;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageParser$Package;",
            "Landroid/content/pm/PackageParser$Package;",
            "Ljava/util/Map<",
            "Ljava/lang/String;",
            "Landroid/content/pm/PackageParser$Package;",
            ">;)V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 10955
    .local p3, "availablePackages":Ljava/util/Map;, "Ljava/util/Map<Ljava/lang/String;Landroid/content/pm/PackageParser$Package;>;"
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    .line 10956
    const/4 v1, 0x0

    invoke-static {p1, p3, v0, v1}, Lcom/android/server/pm/PackageManagerService;->collectSharedLibraryInfos(Landroid/content/pm/PackageParser$Package;Ljava/util/Map;Ljava/util/Map;Ljava/util/Map;)Ljava/util/ArrayList;

    move-result-object v0

    .line 10957
    .local v0, "sharedLibraryInfos":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/SharedLibraryInfo;>;"
    invoke-direct {p0, p1, p2, v0}, Lcom/android/server/pm/PackageManagerService;->executeSharedLibrariesUpdateLPr(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/ArrayList;)V

    .line 10958
    return-void
.end method

.method private updateVersion()V
    .registers 10

    .line 26707
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v0, v0, Lcom/android/server/pm/PackageDefaultOpService;->mPackages:Ljava/util/HashMap;

    invoke-virtual {v0}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_c
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_168

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageDefaultOpService$Op;

    .line 26708
    .local v1, "pkg":Lcom/android/server/pm/PackageDefaultOpService$Op;
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v3, "updateVersion "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, ":  pkg : "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v3, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->uid:I

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, "  "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, "  "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v3, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->newVersion:I

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, " "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v3, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "PackageDefaultOp"

    invoke-static {v3, v2}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26711
    iget-boolean v2, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->activate:Z

    if-nez v2, :cond_166

    .line 26712
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 26713
    :try_start_60
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v4, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 26714
    .local v3, "p":Landroid/content/pm/PackageParser$Package;
    const-string v4, "PackageDefaultOp"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v6, "updateVersion "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, ": "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v6, " pkg : "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->uid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, "  "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, "  "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->newVersion:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, " "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26717
    if-eqz v3, :cond_11e

    .line 26718
    const-string v4, "PackageDefaultOp"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v6, "updateVersion 1 "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " change version from "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, " to "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->newVersion:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26721
    iget v4, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->newVersion:I

    iput v4, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    .line 26722
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 26723
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v4, :cond_11e

    .line 26724
    const-string v5, "PackageDefaultOp"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v7, "updateVersion 2  "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " change version from "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v7, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v7, " to "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v7, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->newVersion:I

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26728
    iget v5, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->newVersion:I

    int-to-long v5, v5

    iput-wide v5, v4, Lcom/android/server/pm/PackageSetting;->versionCode:J

    .line 26731
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_11e
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v5, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 26732
    .restart local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v4, :cond_161

    .line 26733
    iget-object v5, v4, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 26734
    .local v5, "pkgser":Landroid/content/pm/PackageParser$Package;
    if-eqz v5, :cond_161

    .line 26735
    const-string v6, "PackageDefaultOp"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v8, "updateVersion  3 "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v8, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, " change version from "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v8, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v8, " to "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v8, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->newVersion:I

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26739
    iget v6, v1, Lcom/android/server/pm/PackageDefaultOpService$Op;->newVersion:I

    iput v6, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    .line 26742
    .end local v3  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "pkgser":Landroid/content/pm/PackageParser$Package;
    :cond_161
    monitor-exit v2

    goto :goto_166

    :catchall_163
    move-exception v0

    monitor-exit v2
    :try_end_165
    .catchall {:try_start_60 .. :try_end_165} :catchall_163

    throw v0

    .line 26744
    .end local v1  # "pkg":Lcom/android/server/pm/PackageDefaultOpService$Op;
    :cond_166
    :goto_166
    goto/16 :goto_c

    .line 26745
    :cond_168
    return-void
.end method

.method private userNeedsBadging(I)Z
    .registers 8
    .param p1, "userId"  # I

    .line 24795
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mUserNeedsBadging:Landroid/util/SparseBooleanArray;

    invoke-virtual {v0, p1}, Landroid/util/SparseBooleanArray;->indexOfKey(I)I

    move-result v0

    .line 24796
    .local v0, "index":I
    if-gez v0, :cond_2c

    .line 24798
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 24800
    .local v1, "token":J
    :try_start_c
    sget-object v3, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v3, p1}, Lcom/android/server/pm/UserManagerService;->getUserInfo(I)Landroid/content/pm/UserInfo;

    move-result-object v3
    :try_end_12
    .catchall {:try_start_c .. :try_end_12} :catchall_27

    .line 24802
    .local v3, "userInfo":Landroid/content/pm/UserInfo;
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 24803
    nop

    .line 24805
    if-eqz v3, :cond_20

    invoke-virtual {v3}, Landroid/content/pm/UserInfo;->isManagedProfile()Z

    move-result v4

    if-eqz v4, :cond_20

    .line 24806
    const/4 v4, 0x1

    .local v4, "b":Z
    goto :goto_21

    .line 24808
    .end local v4  # "b":Z
    :cond_20
    const/4 v4, 0x0

    .line 24810
    .restart local v4  # "b":Z
    :goto_21
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mUserNeedsBadging:Landroid/util/SparseBooleanArray;

    invoke-virtual {v5, p1, v4}, Landroid/util/SparseBooleanArray;->put(IZ)V

    .line 24811
    return v4

    .line 24802
    .end local v3  # "userInfo":Landroid/content/pm/UserInfo;
    .end local v4  # "b":Z
    :catchall_27
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v3

    .line 24813
    .end local v1  # "token":J
    :cond_2c
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mUserNeedsBadging:Landroid/util/SparseBooleanArray;

    invoke-virtual {v1, v0}, Landroid/util/SparseBooleanArray;->valueAt(I)Z

    move-result v1

    return v1
.end method

.method private verifyIntentFiltersIfNeeded(IIZLandroid/content/pm/PackageParser$Package;)V
    .registers 31
    .param p1, "userId"  # I
    .param p2, "verifierUid"  # I
    .param p3, "replacing"  # Z
    .param p4, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 18824
    move-object/from16 v1, p0

    move/from16 v8, p1

    move-object/from16 v9, p4

    iget-object v0, v9, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v10

    .line 18825
    .local v10, "size":I
    if-nez v10, :cond_1a

    .line 18826
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v0, :cond_19

    const-string v0, "PackageManager"

    const-string v2, "No activity, so no need to verify any IntentFilter!"

    invoke-static {v0, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 18828
    :cond_19
    return-void

    .line 18831
    :cond_1a
    invoke-static/range {p4 .. p4}, Lcom/android/server/pm/PackageManagerService;->hasDomainURLs(Landroid/content/pm/PackageParser$Package;)Z

    move-result v11

    .line 18832
    .local v11, "hasDomainURLs":Z
    if-nez v11, :cond_2c

    .line 18833
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v0, :cond_2b

    const-string v0, "PackageManager"

    const-string v2, "No domain URLs, so no need to verify any IntentFilter!"

    invoke-static {v0, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 18835
    :cond_2b
    return-void

    .line 18838
    :cond_2c
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v0, :cond_53

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Checking for userId:"

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, " if any IntentFilter from the "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, " Activities needs verification ..."

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v2, "PackageManager"

    invoke-static {v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 18842
    :cond_53
    const/4 v2, 0x0

    .line 18843
    .local v2, "count":I
    iget-object v12, v9, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    .line 18844
    .local v12, "packageName":Ljava/lang/String;
    const/4 v3, 0x0

    .line 18845
    .local v3, "handlesWebUris":Z
    new-instance v0, Landroid/util/ArraySet;

    invoke-direct {v0}, Landroid/util/ArraySet;-><init>()V

    move-object v13, v0

    .line 18847
    .local v13, "domains":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    const/4 v14, 0x0

    .line 18848
    .local v14, "hostSetExpanded":Z
    const/4 v4, 0x0

    .line 18849
    .local v4, "needToRunVerify":Z
    iget-object v15, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v15

    .line 18852
    :try_start_62
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    .line 18853
    invoke-virtual {v0, v12}, Lcom/android/server/pm/Settings;->getIntentFilterVerificationLPr(Ljava/lang/String;)Landroid/content/pm/IntentFilterVerificationInfo;

    move-result-object v0

    .line 18854
    .local v0, "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    if-eqz v0, :cond_6c

    const/4 v5, 0x1

    goto :goto_6d

    :cond_6c
    const/4 v5, 0x0

    :goto_6d
    move/from16 v16, v5

    .line 18855
    .local v16, "previouslyVerified":Z
    if-nez p3, :cond_9b

    if-eqz v16, :cond_9b

    .line 18856
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v5, :cond_99

    .line 18857
    const-string v5, "PackageManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Package "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " already verified: status="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 18858
    invoke-virtual {v0}, Landroid/content/pm/IntentFilterVerificationInfo;->getStatusString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    .line 18857
    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 18860
    :cond_99
    monitor-exit v15

    return-void

    .line 18863
    :cond_9b
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v5, :cond_be

    .line 18864
    const-string v5, "PackageManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "    Previous verified hosts: "

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 18865
    if-nez v0, :cond_b0

    const-string v6, "[none]"

    goto :goto_b4

    :cond_b0
    invoke-virtual {v0}, Landroid/content/pm/IntentFilterVerificationInfo;->getDomainsString()Ljava/lang/String;

    move-result-object v6

    :goto_b4
    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    .line 18864
    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 18871
    :cond_be
    invoke-direct {v1, v12}, Lcom/android/server/pm/PackageManagerService;->needsNetworkVerificationLPr(Ljava/lang/String;)Z

    move-result v5

    move/from16 v19, v5

    .line 18872
    .local v19, "needsVerification":Z
    iget-object v5, v9, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v5
    :try_end_ca
    .catchall {:try_start_62 .. :try_end_ca} :catchall_270

    move/from16 v21, v3

    move/from16 v20, v4

    .end local v3  # "handlesWebUris":Z
    .end local v4  # "needToRunVerify":Z
    .local v20, "needToRunVerify":Z
    .local v21, "handlesWebUris":Z
    :goto_ce
    :try_start_ce
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_110

    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Activity;

    .line 18873
    .local v3, "a":Landroid/content/pm/PackageParser$Activity;
    iget-object v4, v3, Landroid/content/pm/PackageParser$Activity;->intents:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_e0
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v6

    if-eqz v6, :cond_10f

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/PackageParser$ActivityIntentInfo;

    .line 18874
    .local v6, "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    const/4 v7, 0x1

    invoke-virtual {v6, v7}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->handlesWebUris(Z)Z

    move-result v18

    if-eqz v18, :cond_f7

    .line 18875
    const/16 v18, 0x1

    move/from16 v21, v18

    .line 18877
    :cond_f7
    if-eqz v19, :cond_10e

    invoke-virtual {v6}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->needsVerification()Z

    move-result v18

    if-eqz v18, :cond_10e

    .line 18878
    sget-boolean v4, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v4, :cond_10a

    .line 18879
    const-string v4, "PackageManager"

    const-string v7, "autoVerify requested, processing all filters"

    invoke-static {v4, v7}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 18881
    :cond_10a
    const/4 v4, 0x1

    .line 18885
    .end local v20  # "needToRunVerify":Z
    .restart local v4  # "needToRunVerify":Z
    move/from16 v20, v4

    goto :goto_10f

    .line 18887
    .end local v4  # "needToRunVerify":Z
    .end local v6  # "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    .restart local v20  # "needToRunVerify":Z
    :cond_10e
    goto :goto_e0

    .line 18888
    .end local v3  # "a":Landroid/content/pm/PackageParser$Activity;
    :cond_10f
    :goto_10f
    goto :goto_ce

    .line 18892
    :cond_110
    if-nez v20, :cond_11a

    if-eqz v16, :cond_115

    goto :goto_11a

    :cond_115
    const/4 v9, 0x1

    const/16 v25, 0x0

    goto/16 :goto_1ac

    .line 18893
    :cond_11a
    :goto_11a
    iget v5, v1, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerificationToken:I

    add-int/lit8 v3, v5, 0x1

    iput v3, v1, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerificationToken:I

    .line 18894
    .local v5, "verificationId":I
    iget-object v3, v9, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v22

    :goto_126
    invoke-interface/range {v22 .. v22}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1a9

    invoke-interface/range {v22 .. v22}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Activity;

    move-object v7, v3

    .line 18895
    .local v7, "a":Landroid/content/pm/PackageParser$Activity;
    iget-object v3, v7, Landroid/content/pm/PackageParser$Activity;->intents:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v23
    :try_end_139
    .catchall {:try_start_ce .. :try_end_139} :catchall_26a

    move/from16 v24, v2

    .end local v2  # "count":I
    .local v24, "count":I
    :goto_13b
    :try_start_13b
    invoke-interface/range {v23 .. v23}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_196

    invoke-interface/range {v23 .. v23}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$ActivityIntentInfo;

    move-object v6, v2

    .line 18898
    .restart local v6  # "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    const/4 v4, 0x0

    invoke-virtual {v6, v4}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->handlesWebUris(Z)Z

    move-result v2

    if-eqz v2, :cond_18a

    .line 18899
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v2, :cond_16d

    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Verification needed for IntentFilter:"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 18900
    invoke-virtual {v6}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 18899
    invoke-static {v2, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 18901
    :cond_16d
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifier:Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;

    move/from16 v3, p2

    const/16 v17, 0x0

    move/from16 v4, p1

    move-object/from16 v18, v6

    const/4 v9, 0x1

    .end local v6  # "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    .local v18, "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    move/from16 v25, v17

    move-object/from16 v17, v7

    .end local v7  # "a":Landroid/content/pm/PackageParser$Activity;
    .local v17, "a":Landroid/content/pm/PackageParser$Activity;
    move-object v7, v12

    invoke-interface/range {v2 .. v7}, Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;->addOneIntentFilterVerification(IIILandroid/content/IntentFilter;Ljava/lang/String;)Z

    .line 18903
    invoke-virtual/range {v18 .. v18}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->getHostsList()Ljava/util/ArrayList;

    move-result-object v2

    invoke-virtual {v13, v2}, Landroid/util/ArraySet;->addAll(Ljava/util/Collection;)Z
    :try_end_187
    .catchall {:try_start_13b .. :try_end_187} :catchall_1a0

    .line 18904
    add-int/lit8 v24, v24, 0x1

    goto :goto_191

    .line 18898
    .end local v17  # "a":Landroid/content/pm/PackageParser$Activity;
    .end local v18  # "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    .restart local v6  # "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    .restart local v7  # "a":Landroid/content/pm/PackageParser$Activity;
    :cond_18a
    move/from16 v25, v4

    move-object/from16 v18, v6

    move-object/from16 v17, v7

    const/4 v9, 0x1

    .line 18906
    .end local v6  # "filter":Landroid/content/pm/PackageParser$ActivityIntentInfo;
    .end local v7  # "a":Landroid/content/pm/PackageParser$Activity;
    .restart local v17  # "a":Landroid/content/pm/PackageParser$Activity;
    :goto_191
    move-object/from16 v9, p4

    move-object/from16 v7, v17

    goto :goto_13b

    .line 18895
    .end local v17  # "a":Landroid/content/pm/PackageParser$Activity;
    .restart local v7  # "a":Landroid/content/pm/PackageParser$Activity;
    :cond_196
    move-object/from16 v17, v7

    const/4 v9, 0x1

    const/16 v25, 0x0

    .line 18907
    .end local v7  # "a":Landroid/content/pm/PackageParser$Activity;
    move-object/from16 v9, p4

    move/from16 v2, v24

    goto :goto_126

    .line 18947
    .end local v0  # "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    .end local v5  # "verificationId":I
    .end local v16  # "previouslyVerified":Z
    .end local v19  # "needsVerification":Z
    :catchall_1a0
    move-exception v0

    move/from16 v4, v20

    move/from16 v3, v21

    move/from16 v2, v24

    goto/16 :goto_271

    .line 18894
    .end local v24  # "count":I
    .restart local v0  # "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    .restart local v2  # "count":I
    .restart local v5  # "verificationId":I
    .restart local v16  # "previouslyVerified":Z
    .restart local v19  # "needsVerification":Z
    :cond_1a9
    const/4 v9, 0x1

    const/16 v25, 0x0

    .line 18910
    .end local v5  # "verificationId":I
    :goto_1ac
    :try_start_1ac
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v3, :cond_1ca

    .line 18911
    const-string v3, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "    Update published hosts: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Landroid/util/ArraySet;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 18927
    :cond_1ca
    if-eqz v16, :cond_1dc

    if-eqz v0, :cond_1d9

    .line 18928
    invoke-virtual {v0}, Landroid/content/pm/IntentFilterVerificationInfo;->getDomains()Ljava/util/Set;

    move-result-object v3

    invoke-interface {v3, v13}, Ljava/util/Set;->containsAll(Ljava/util/Collection;)Z

    move-result v3

    if-nez v3, :cond_1d9

    goto :goto_1dc

    :cond_1d9
    move/from16 v3, v25

    goto :goto_1dd

    :cond_1dc
    :goto_1dc
    move v3, v9

    :goto_1dd
    move v14, v3

    .line 18929
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    .line 18930
    invoke-virtual {v3, v12, v8}, Lcom/android/server/pm/Settings;->getIntentFilterVerificationStatusLPr(Ljava/lang/String;I)I

    move-result v3

    .line 18931
    .local v3, "currentPolicy":I
    if-nez v14, :cond_1eb

    const/4 v4, 0x2

    if-ne v3, v4, :cond_1eb

    move v4, v9

    goto :goto_1ed

    :cond_1eb
    move/from16 v4, v25

    .line 18934
    .local v4, "keepCurState":Z
    :goto_1ed
    if-eqz v20, :cond_204

    if-eqz v4, :cond_204

    .line 18935
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v5, :cond_1fc

    .line 18936
    const-string v5, "PackageManager"

    const-string v6, "Host set not expanding + ALWAYS -> no need to reverify"

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 18938
    :cond_1fc
    invoke-virtual {v0, v13}, Landroid/content/pm/IntentFilterVerificationInfo;->setDomains(Landroid/util/ArraySet;)V

    .line 18939
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->scheduleWriteSettingsLocked()V

    .line 18940
    monitor-exit v15

    return-void

    .line 18941
    :cond_204
    if-eqz v16, :cond_212

    if-nez v20, :cond_212

    .line 18944
    if-nez v4, :cond_20b

    goto :goto_20d

    :cond_20b
    move/from16 v9, v25

    :goto_20d
    invoke-virtual {v1, v12, v8, v9}, Lcom/android/server/pm/PackageManagerService;->clearIntentFilterVerificationsLPw(Ljava/lang/String;IZ)V

    .line 18945
    monitor-exit v15

    return-void

    .line 18947
    .end local v0  # "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    .end local v3  # "currentPolicy":I
    .end local v4  # "keepCurState":Z
    .end local v19  # "needsVerification":Z
    :cond_212
    monitor-exit v15
    :try_end_213
    .catchall {:try_start_1ac .. :try_end_213} :catchall_26a

    .line 18949
    if-eqz v20, :cond_24f

    if-lez v2, :cond_24f

    .line 18951
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v0, :cond_249

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Starting "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, " IntentFilter verification"

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 18952
    if-le v2, v9, :cond_233

    const-string/jumbo v3, "s"

    goto :goto_235

    :cond_233
    const-string v3, ""

    :goto_235
    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " for userId:"

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 18951
    const-string v3, "PackageManager"

    invoke-static {v3, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 18954
    :cond_249
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifier:Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;

    invoke-interface {v0, v8}, Lcom/android/server/pm/PackageManagerService$IntentFilterVerifier;->startVerifications(I)V

    goto :goto_269

    .line 18956
    :cond_24f
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-eqz v0, :cond_269

    .line 18957
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "No web filters or no new host policy for "

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v3, "PackageManager"

    invoke-static {v3, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 18960
    :cond_269
    :goto_269
    return-void

    .line 18947
    .end local v16  # "previouslyVerified":Z
    :catchall_26a
    move-exception v0

    move/from16 v4, v20

    move/from16 v3, v21

    goto :goto_271

    .end local v20  # "needToRunVerify":Z
    .end local v21  # "handlesWebUris":Z
    .local v3, "handlesWebUris":Z
    .local v4, "needToRunVerify":Z
    :catchall_270
    move-exception v0

    :goto_271
    :try_start_271
    monitor-exit v15
    :try_end_272
    .catchall {:try_start_271 .. :try_end_272} :catchall_270

    throw v0
.end method

.method private verifyPackageUpdateLPr(Lcom/android/server/pm/PackageSetting;Landroid/content/pm/PackageParser$Package;)Z
    .registers 10
    .param p1, "oldPkg"  # Lcom/android/server/pm/PackageSetting;
    .param p2, "newPkg"  # Landroid/content/pm/PackageParser$Package;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 10751
    iget v0, p1, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    const/4 v1, 0x1

    and-int/2addr v0, v1

    const/4 v2, 0x0

    const-string v3, " to "

    const-string v4, "Unable to update from "

    const-string v5, "PackageManager"

    if-nez v0, :cond_2f

    .line 10752
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, p2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, ": old package not in system partition"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v5, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10755
    return v2

    .line 10756
    :cond_2f
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v6, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v0, v6}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    if-eqz v0, :cond_5b

    .line 10757
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, p2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, ": old package still exists"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v5, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10760
    return v2

    .line 10762
    :cond_5b
    return v1
.end method

.method private verifyVersion()V
    .registers 14

    .line 26682
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v0, v0, Lcom/android/server/pm/PackageDefaultOpService;->mPackageList:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_8
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_b0

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/lang/String;

    .line 26683
    .local v1, "pkg":Ljava/lang/String;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v2, v2, Lcom/android/server/pm/PackageDefaultOpService;->mPackages:Ljava/util/HashMap;

    invoke-virtual {v2, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    if-nez v2, :cond_92

    .line 26684
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v3, "pkg  "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " create"

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v5, "PackageDefaultOp"

    invoke-static {v5, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 26688
    const/16 v2, 0x2000

    :try_start_3c
    invoke-virtual {p0, v1, v2}, Lcom/android/server/pm/PackageManagerService;->getPackageInfoForVersion(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;

    move-result-object v2

    .line 26689
    .local v2, "packInfo":Landroid/content/pm/PackageInfo;
    if-eqz v2, :cond_8c

    .line 26690
    new-instance v12, Lcom/android/server/pm/PackageDefaultOpService$Op;

    iget-object v6, v2, Landroid/content/pm/PackageInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v8, v2, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    iget v9, v2, Landroid/content/pm/PackageInfo;->versionCode:I

    const v10, 0x7fffffff

    const/4 v11, 0x0

    move-object v6, v12

    invoke-direct/range {v6 .. v11}, Lcom/android/server/pm/PackageDefaultOpService$Op;-><init>(ILjava/lang/String;IIZ)V

    move-object v6, v12

    .line 26692
    .local v6, "op":Lcom/android/server/pm/PackageDefaultOpService$Op;
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v7, v7, Lcom/android/server/pm/PackageDefaultOpService;->mPackages:Ljava/util/HashMap;

    invoke-virtual {v7, v1, v6}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 26693
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v2, Landroid/content/pm/PackageInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, "  "

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v2, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " "

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v3, v2, Landroid/content/pm/PackageInfo;->versionCode:I

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v5, v3}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_8c
    .catch Ljava/lang/Exception; {:try_start_3c .. :try_end_8c} :catch_8d

    .line 26699
    .end local v6  # "op":Lcom/android/server/pm/PackageDefaultOpService$Op;
    :cond_8c
    goto :goto_ae

    .line 26697
    .end local v2  # "packInfo":Landroid/content/pm/PackageInfo;
    :catch_8d
    move-exception v2

    .line 26698
    .local v2, "e":Ljava/lang/Exception;
    invoke-virtual {v2}, Ljava/lang/Exception;->printStackTrace()V

    .line 26699
    .end local v2  # "e":Ljava/lang/Exception;
    goto :goto_ae

    .line 26701
    :cond_92
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v3, "verifyVersion : "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " not in list"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "PackageManager"

    invoke-static {v3, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 26703
    .end local v1  # "pkg":Ljava/lang/String;
    :goto_ae
    goto/16 :goto_8

    .line 26704
    :cond_b0
    return-void
.end method


# virtual methods
.method public activitySupportsIntent(Landroid/content/ComponentName;Landroid/content/Intent;Ljava/lang/String;)Z
    .registers 24
    .param p1, "component"  # Landroid/content/ComponentName;
    .param p2, "intent"  # Landroid/content/Intent;
    .param p3, "resolvedType"  # Ljava/lang/String;

    .line 5414
    move-object/from16 v7, p0

    move-object/from16 v8, p1

    iget-object v9, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v9

    .line 5415
    :try_start_7
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mResolveComponentName:Landroid/content/ComponentName;

    invoke-virtual {v8, v0}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v0

    const/4 v10, 0x1

    if-eqz v0, :cond_12

    .line 5417
    monitor-exit v9

    return v10

    .line 5419
    :cond_12
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    .line 5420
    .local v3, "callingUid":I
    invoke-static {v3}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v6

    .line 5421
    .local v6, "callingUserId":I
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, v8}, Lcom/android/server/pm/ComponentResolver;->getActivity(Landroid/content/ComponentName;)Landroid/content/pm/PackageParser$Activity;

    move-result-object v0

    .line 5422
    .local v0, "a":Landroid/content/pm/PackageParser$Activity;
    const/4 v11, 0x0

    if-nez v0, :cond_25

    .line 5423
    monitor-exit v9

    return v11

    .line 5425
    :cond_25
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual/range {p1 .. p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    move-object v12, v1

    .line 5426
    .local v12, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v12, :cond_38

    .line 5427
    monitor-exit v9

    return v11

    .line 5429
    :cond_38
    const/4 v5, 0x1

    move-object/from16 v1, p0

    move-object v2, v12

    move-object/from16 v4, p1

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v1

    if-eqz v1, :cond_46

    .line 5430
    monitor-exit v9

    return v11

    .line 5432
    :cond_46
    move v1, v11

    .local v1, "i":I
    :goto_47
    iget-object v2, v0, Landroid/content/pm/PackageParser$Activity;->intents:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-ge v1, v2, :cond_77

    .line 5433
    iget-object v2, v0, Landroid/content/pm/PackageParser$Activity;->intents:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    move-object v13, v2

    check-cast v13, Landroid/content/pm/PackageParser$ActivityIntentInfo;

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v14

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getScheme()Ljava/lang/String;

    move-result-object v16

    .line 5434
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v17

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getCategories()Ljava/util/Set;

    move-result-object v18

    const-string v19, "PackageManager"

    .line 5433
    move-object/from16 v15, p3

    invoke-virtual/range {v13 .. v19}, Landroid/content/pm/PackageParser$ActivityIntentInfo;->match(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Landroid/net/Uri;Ljava/util/Set;Ljava/lang/String;)I

    move-result v2

    if-ltz v2, :cond_74

    .line 5435
    monitor-exit v9

    return v10

    .line 5432
    :cond_74
    add-int/lit8 v1, v1, 0x1

    goto :goto_47

    .line 5438
    .end local v1  # "i":I
    :cond_77
    monitor-exit v9

    return v11

    .line 5439
    .end local v0  # "a":Landroid/content/pm/PackageParser$Activity;
    .end local v3  # "callingUid":I
    .end local v6  # "callingUserId":I
    .end local v12  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_79
    move-exception v0

    monitor-exit v9
    :try_end_7b
    .catchall {:try_start_7 .. :try_end_7b} :catchall_79

    throw v0
.end method

.method public addCrossProfileIntentFilter(Landroid/content/IntentFilter;Ljava/lang/String;III)V
    .registers 14
    .param p1, "intentFilter"  # Landroid/content/IntentFilter;
    .param p2, "ownerPackage"  # Ljava/lang/String;
    .param p3, "sourceUserId"  # I
    .param p4, "targetUserId"  # I
    .param p5, "flags"  # I

    .line 21739
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.INTERACT_ACROSS_USERS_FULL"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 21741
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 21742
    .local v0, "callingUid":I
    invoke-direct {p0, p2, v0}, Lcom/android/server/pm/PackageManagerService;->enforceOwnerRights(Ljava/lang/String;I)V

    .line 21743
    const-string/jumbo v1, "no_debugging_features"

    invoke-static {v1, v0, p3}, Lcom/android/server/pm/PackageManagerServiceUtils;->enforceShellRestriction(Ljava/lang/String;II)V

    .line 21745
    invoke-virtual {p1}, Landroid/content/IntentFilter;->countActions()I

    move-result v1

    if-nez v1, :cond_23

    .line 21746
    const-string v1, "PackageManager"

    const-string v2, "Cannot set a crossProfile intent filter with no filter actions"

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 21747
    return-void

    .line 21749
    :cond_23
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 21750
    :try_start_26
    new-instance v2, Lcom/android/server/pm/CrossProfileIntentFilter;

    invoke-direct {v2, p1, p2, p4, p5}, Lcom/android/server/pm/CrossProfileIntentFilter;-><init>(Landroid/content/IntentFilter;Ljava/lang/String;II)V

    .line 21752
    .local v2, "newFilter":Lcom/android/server/pm/CrossProfileIntentFilter;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    .line 21753
    invoke-virtual {v3, p3}, Lcom/android/server/pm/Settings;->editCrossProfileIntentResolverLPw(I)Lcom/android/server/pm/CrossProfileIntentResolver;

    move-result-object v3

    .line 21754
    .local v3, "resolver":Lcom/android/server/pm/CrossProfileIntentResolver;
    invoke-virtual {v3, p1}, Lcom/android/server/pm/CrossProfileIntentResolver;->findFilters(Landroid/content/IntentFilter;)Ljava/util/ArrayList;

    move-result-object v4

    .line 21756
    .local v4, "existing":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    if-eqz v4, :cond_4f

    .line 21757
    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v5

    .line 21758
    .local v5, "size":I
    const/4 v6, 0x0

    .local v6, "i":I
    :goto_3c
    if-ge v6, v5, :cond_4f

    .line 21759
    invoke-virtual {v4, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/CrossProfileIntentFilter;

    invoke-virtual {v2, v7}, Lcom/android/server/pm/CrossProfileIntentFilter;->equalsIgnoreFilter(Lcom/android/server/pm/CrossProfileIntentFilter;)Z

    move-result v7

    if-eqz v7, :cond_4c

    .line 21760
    monitor-exit v1

    return-void

    .line 21758
    :cond_4c
    add-int/lit8 v6, v6, 0x1

    goto :goto_3c

    .line 21764
    .end local v5  # "size":I
    .end local v6  # "i":I
    :cond_4f
    invoke-virtual {v3, v2}, Lcom/android/server/pm/CrossProfileIntentResolver;->addFilter(Landroid/content/IntentFilter;)V

    .line 21765
    invoke-virtual {p0, p3}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 21766
    .end local v2  # "newFilter":Lcom/android/server/pm/CrossProfileIntentFilter;
    .end local v3  # "resolver":Lcom/android/server/pm/CrossProfileIntentResolver;
    .end local v4  # "existing":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    monitor-exit v1

    .line 21767
    return-void

    .line 21766
    :catchall_57
    move-exception v2

    monitor-exit v1
    :try_end_59
    .catchall {:try_start_26 .. :try_end_59} :catchall_57

    throw v2
.end method

.method public addOnPermissionsChangeListener(Landroid/content/pm/IOnPermissionsChangeListener;)V
    .registers 5
    .param p1, "listener"  # Landroid/content/pm/IOnPermissionsChangeListener;

    .line 6357
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.OBSERVE_GRANT_REVOKE_PERMISSIONS"

    const-string v2, "addOnPermissionsChangeListener"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6361
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 6362
    :try_start_c
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mOnPermissionChangeListeners:Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;

    invoke-virtual {v1, p1}, Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;->addListenerLocked(Landroid/content/pm/IOnPermissionsChangeListener;)V

    .line 6363
    monitor-exit v0

    .line 6364
    return-void

    .line 6363
    :catchall_13
    move-exception v1

    monitor-exit v0
    :try_end_15
    .catchall {:try_start_c .. :try_end_15} :catchall_13

    throw v1
.end method

.method public addPermission(Landroid/content/pm/PermissionInfo;)Z
    .registers 4
    .param p1, "info"  # Landroid/content/pm/PermissionInfo;

    .line 5968
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5969
    const/4 v1, 0x0

    :try_start_4
    invoke-direct {p0, p1, v1}, Lcom/android/server/pm/PackageManagerService;->addDynamicPermission(Landroid/content/pm/PermissionInfo;Z)Z

    move-result v1

    monitor-exit v0

    return v1

    .line 5970
    :catchall_a
    move-exception v1

    monitor-exit v0
    :try_end_c
    .catchall {:try_start_4 .. :try_end_c} :catchall_a

    throw v1
.end method

.method public addPermissionAsync(Landroid/content/pm/PermissionInfo;)Z
    .registers 4
    .param p1, "info"  # Landroid/content/pm/PermissionInfo;

    .line 5975
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5976
    const/4 v1, 0x1

    :try_start_4
    invoke-direct {p0, p1, v1}, Lcom/android/server/pm/PackageManagerService;->addDynamicPermission(Landroid/content/pm/PermissionInfo;Z)Z

    move-result v1

    monitor-exit v0

    return v1

    .line 5977
    :catchall_a
    move-exception v1

    monitor-exit v0
    :try_end_c
    .catchall {:try_start_4 .. :try_end_c} :catchall_a

    throw v1
.end method

.method public addPersistentPreferredActivity(Landroid/content/IntentFilter;Landroid/content/ComponentName;I)V
    .registers 8
    .param p1, "filter"  # Landroid/content/IntentFilter;
    .param p2, "activity"  # Landroid/content/ComponentName;
    .param p3, "userId"  # I

    .line 21455
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 21456
    .local v0, "callingUid":I
    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_69

    .line 21460
    invoke-virtual {p1}, Landroid/content/IntentFilter;->countActions()I

    move-result v1

    if-nez v1, :cond_16

    .line 21461
    const-string v1, "PackageManager"

    const-string v2, "Cannot set a preferred activity with no filter actions"

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 21462
    return-void

    .line 21464
    :cond_16
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v1, :cond_4a

    .line 21465
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Adding persistent preferred activity "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v2, " for user "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, ":"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21467
    new-instance v1, Landroid/util/LogPrinter;

    const/4 v2, 0x4

    const-string v3, "PackageManager"

    invoke-direct {v1, v2, v3}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;)V

    const-string v2, "  "

    invoke-virtual {p1, v1, v2}, Landroid/content/IntentFilter;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 21469
    :cond_4a
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 21470
    :try_start_4d
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, p3}, Lcom/android/server/pm/Settings;->editPersistentPreferredActivitiesLPw(I)Lcom/android/server/pm/PersistentPreferredIntentResolver;

    move-result-object v2

    new-instance v3, Lcom/android/server/pm/PersistentPreferredActivity;

    invoke-direct {v3, p1, p2}, Lcom/android/server/pm/PersistentPreferredActivity;-><init>(Landroid/content/IntentFilter;Landroid/content/ComponentName;)V

    invoke-virtual {v2, v3}, Lcom/android/server/pm/PersistentPreferredIntentResolver;->addFilter(Landroid/content/IntentFilter;)V

    .line 21472
    invoke-virtual {p0, p3}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 21473
    monitor-exit v1
    :try_end_5f
    .catchall {:try_start_4d .. :try_end_5f} :catchall_66

    .line 21474
    invoke-direct {p0, p3}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(I)Z

    .line 21475
    invoke-direct {p0, p3}, Lcom/android/server/pm/PackageManagerService;->postPreferredActivityChangedBroadcast(I)V

    .line 21476
    return-void

    .line 21473
    :catchall_66
    move-exception v2

    :try_start_67
    monitor-exit v1
    :try_end_68
    .catchall {:try_start_67 .. :try_end_68} :catchall_66

    throw v2

    .line 21457
    :cond_69
    new-instance v1, Ljava/lang/SecurityException;

    const-string v2, "addPersistentPreferredActivity can only be run by the system"

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method public addPreferredActivity(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;I)V
    .registers 14
    .param p1, "filter"  # Landroid/content/IntentFilter;
    .param p2, "match"  # I
    .param p3, "set"  # [Landroid/content/ComponentName;
    .param p4, "activity"  # Landroid/content/ComponentName;
    .param p5, "userId"  # I

    .line 21113
    const/4 v5, 0x1

    const-string v7, "Adding preferred"

    move-object v0, p0

    move-object v1, p1

    move v2, p2

    move-object v3, p3

    move-object v4, p4

    move v6, p5

    invoke-direct/range {v0 .. v7}, Lcom/android/server/pm/PackageManagerService;->addPreferredActivityInternal(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;ZILjava/lang/String;)V

    .line 21115
    return-void
.end method

.method public addWhitelistedRestrictedPermission(Ljava/lang/String;Ljava/lang/String;II)Z
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "permission"  # Ljava/lang/String;
    .param p3, "whitelistFlags"  # I
    .param p4, "userId"  # I

    .line 6163
    invoke-static {p2}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6165
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->checkExistsAndEnforceCannotModifyImmutablyRestrictedPermission(Ljava/lang/String;)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_b

    .line 6166
    return v1

    .line 6169
    :cond_b
    invoke-virtual {p0, p1, p3, p4}, Lcom/android/server/pm/PackageManagerService;->getWhitelistedRestrictedPermissions(Ljava/lang/String;II)Ljava/util/List;

    move-result-object v0

    .line 6171
    .local v0, "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    if-nez v0, :cond_18

    .line 6172
    new-instance v2, Ljava/util/ArrayList;

    const/4 v3, 0x1

    invoke-direct {v2, v3}, Ljava/util/ArrayList;-><init>(I)V

    move-object v0, v2

    .line 6174
    :cond_18
    invoke-interface {v0, p2}, Ljava/util/List;->indexOf(Ljava/lang/Object;)I

    move-result v2

    if-gez v2, :cond_26

    .line 6175
    invoke-interface {v0, p2}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 6176
    invoke-direct {p0, p1, v0, p3, p4}, Lcom/android/server/pm/PackageManagerService;->setWhitelistedRestrictedPermissions(Ljava/lang/String;Ljava/util/List;II)Z

    move-result v1

    return v1

    .line 6179
    :cond_26
    return v1
.end method

.method public canForwardTo(Landroid/content/Intent;Ljava/lang/String;II)Z
    .registers 20
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "sourceUserId"  # I
    .param p4, "targetUserId"  # I

    .line 7412
    move-object v7, p0

    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.INTERACT_ACROSS_USERS_FULL"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7414
    nop

    .line 7415
    invoke-direct/range {p0 .. p3}, Lcom/android/server/pm/PackageManagerService;->getMatchingCrossProfileIntentFilters(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;

    move-result-object v8

    .line 7416
    .local v8, "matches":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    const/4 v0, 0x1

    if-eqz v8, :cond_2d

    .line 7417
    invoke-interface {v8}, Ljava/util/List;->size()I

    move-result v1

    .line 7418
    .local v1, "size":I
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_16
    if-ge v2, v1, :cond_2a

    .line 7419
    invoke-interface {v8, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/CrossProfileIntentFilter;

    invoke-virtual {v3}, Lcom/android/server/pm/CrossProfileIntentFilter;->getTargetUserId()I

    move-result v3

    move/from16 v9, p4

    if-ne v3, v9, :cond_27

    return v0

    .line 7418
    :cond_27
    add-int/lit8 v2, v2, 0x1

    goto :goto_16

    :cond_2a
    move/from16 v9, p4

    goto :goto_2f

    .line 7416
    .end local v1  # "size":I
    .end local v2  # "i":I
    :cond_2d
    move/from16 v9, p4

    .line 7422
    :goto_2f
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->hasWebURI()Z

    move-result v1

    const/4 v10, 0x0

    if-eqz v1, :cond_65

    .line 7424
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v11

    .line 7425
    .local v11, "callingUid":I
    move/from16 v12, p3

    invoke-direct {p0, v12}, Lcom/android/server/pm/PackageManagerService;->getProfileParent(I)Landroid/content/pm/UserInfo;

    move-result-object v13

    .line 7426
    .local v13, "parent":Landroid/content/pm/UserInfo;
    iget-object v14, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v14

    .line 7427
    const/4 v2, 0x0

    :try_start_44
    iget v3, v13, Landroid/content/pm/UserInfo;->id:I

    const/4 v6, 0x0

    move-object v1, p0

    move-object/from16 v4, p1

    move v5, v11

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZ)I

    move-result v4

    .line 7429
    .local v4, "flags":I
    iget v6, v13, Landroid/content/pm/UserInfo;->id:I

    move-object v1, p0

    move-object/from16 v2, p1

    move-object/from16 v3, p2

    move/from16 v5, p3

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->getCrossProfileDomainPreferredLpr(Landroid/content/Intent;Ljava/lang/String;III)Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;

    move-result-object v1

    .line 7431
    .local v1, "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    if-eqz v1, :cond_5f

    goto :goto_60

    :cond_5f
    move v0, v10

    :goto_60
    monitor-exit v14

    return v0

    .line 7432
    .end local v1  # "xpDomainInfo":Lcom/android/server/pm/PackageManagerService$CrossProfileDomainInfo;
    .end local v4  # "flags":I
    :catchall_62
    move-exception v0

    monitor-exit v14
    :try_end_64
    .catchall {:try_start_44 .. :try_end_64} :catchall_62

    throw v0

    .line 7434
    .end local v11  # "callingUid":I
    .end local v13  # "parent":Landroid/content/pm/UserInfo;
    :cond_65
    move/from16 v12, p3

    return v10
.end method

.method canHaveOatDir(Ljava/lang/String;)Z
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;

    .line 26407
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26408
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 26409
    .local v1, "p":Landroid/content/pm/PackageParser$Package;
    if-nez v1, :cond_10

    .line 26410
    const/4 v2, 0x0

    monitor-exit v0

    return v2

    .line 26412
    :cond_10
    invoke-virtual {v1}, Landroid/content/pm/PackageParser$Package;->canHaveOatDir()Z

    move-result v2

    monitor-exit v0

    return v2

    .line 26413
    .end local v1  # "p":Landroid/content/pm/PackageParser$Package;
    :catchall_16
    move-exception v1

    monitor-exit v0
    :try_end_18
    .catchall {:try_start_3 .. :try_end_18} :catchall_16

    throw v1
.end method

.method public canRequestPackageInstalls(Ljava/lang/String;I)Z
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26330
    const/4 v0, 0x0

    const/4 v1, 0x1

    invoke-direct {p0, p1, v0, p2, v1}, Lcom/android/server/pm/PackageManagerService;->canRequestPackageInstallsInternal(Ljava/lang/String;IIZ)Z

    move-result v0

    return v0
.end method

.method public canonicalToCurrentPackageNames([Ljava/lang/String;)[Ljava/lang/String;
    .registers 18
    .param p1, "names"  # [Ljava/lang/String;

    .line 4724
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    .line 4725
    .local v3, "callingUid":I
    invoke-direct {v1, v3}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_f

    .line 4726
    return-object v2

    .line 4728
    :cond_f
    array-length v0, v2

    new-array v4, v0, [Ljava/lang/String;

    .line 4730
    .local v4, "out":[Ljava/lang/String;
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 4731
    :try_start_15
    invoke-static {v3}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v0

    .line 4732
    .local v0, "callingUserId":I
    invoke-direct {v1, v3, v0}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v6

    .line 4733
    .local v6, "canViewInstantApps":Z
    array-length v7, v2

    const/4 v8, 0x1

    sub-int/2addr v7, v8

    .local v7, "i":I
    :goto_20
    if-ltz v7, :cond_65

    .line 4734
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    aget-object v10, v2, v7

    invoke-virtual {v9, v10}, Lcom/android/server/pm/Settings;->getRenamedPackageLPr(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    .line 4735
    .local v9, "cur":Ljava/lang/String;
    const/4 v10, 0x0

    .line 4736
    .local v10, "translateName":Z
    if-eqz v9, :cond_59

    .line 4737
    iget-object v11, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v11, v11, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    aget-object v12, v2, v7

    invoke-virtual {v11, v12}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/pm/PackageSetting;

    .line 4738
    .local v11, "ps":Lcom/android/server/pm/PackageSetting;
    const/4 v12, 0x0

    if-eqz v11, :cond_44

    .line 4739
    invoke-virtual {v11, v0}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v13

    if-eqz v13, :cond_44

    move v13, v8

    goto :goto_45

    :cond_44
    move v13, v12

    .line 4740
    .local v13, "targetIsInstantApp":Z
    :goto_45
    if-eqz v13, :cond_57

    if-nez v6, :cond_57

    iget-object v14, v1, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    .line 4743
    invoke-static {v3}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v15

    iget v8, v11, Lcom/android/server/pm/PackageSetting;->appId:I

    .line 4742
    invoke-virtual {v14, v0, v15, v8}, Lcom/android/server/pm/InstantAppRegistry;->isInstantAccessGranted(III)Z

    move-result v8

    if-eqz v8, :cond_58

    :cond_57
    const/4 v12, 0x1

    :cond_58
    move v10, v12

    .line 4745
    .end local v11  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "targetIsInstantApp":Z
    :cond_59
    if-eqz v10, :cond_5d

    move-object v8, v9

    goto :goto_5f

    :cond_5d
    aget-object v8, v2, v7

    :goto_5f
    aput-object v8, v4, v7

    .line 4733
    .end local v9  # "cur":Ljava/lang/String;
    .end local v10  # "translateName":Z
    add-int/lit8 v7, v7, -0x1

    const/4 v8, 0x1

    goto :goto_20

    .line 4747
    .end local v0  # "callingUserId":I
    .end local v6  # "canViewInstantApps":Z
    .end local v7  # "i":I
    :cond_65
    monitor-exit v5

    .line 4748
    return-object v4

    .line 4747
    :catchall_67
    move-exception v0

    monitor-exit v5
    :try_end_69
    .catchall {:try_start_15 .. :try_end_69} :catchall_67

    throw v0
.end method

.method public checkPackageStartable(Ljava/lang/String;I)V
    .registers 10
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 4371
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 4372
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    if-nez v1, :cond_e2

    .line 4375
    invoke-static {p2}, Landroid/os/storage/StorageManager;->isUserKeyUnlocked(I)Z

    move-result v1

    .line 4376
    .local v1, "userKeyUnlocked":Z
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 4377
    :try_start_11
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 4378
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_c3

    invoke-direct {p0, v3, v0, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v4

    if-nez v4, :cond_c3

    .line 4382
    invoke-virtual {v3, p2}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v4

    if-eqz v4, :cond_9f

    .line 4387
    iget-boolean v4, p0, Lcom/android/server/pm/PackageManagerService;->mSafeMode:Z

    if-eqz v4, :cond_50

    invoke-virtual {v3}, Lcom/android/server/pm/PackageSetting;->isSystem()Z

    move-result v4

    if-eqz v4, :cond_34

    goto :goto_50

    .line 4388
    :cond_34
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " not a system app!"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local v1  # "userKeyUnlocked":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    throw v4

    .line 4391
    .restart local v0  # "callingUid":I
    .restart local v1  # "userKeyUnlocked":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    :cond_50
    :goto_50
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mFrozenPackages:Landroid/util/ArraySet;

    invoke-virtual {v4, p1}, Landroid/util/ArraySet;->contains(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_83

    .line 4395
    if-nez v1, :cond_81

    iget-object v4, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v4}, Landroid/content/pm/ApplicationInfo;->isEncryptionAware()Z

    move-result v4

    if-eqz v4, :cond_65

    goto :goto_81

    .line 4396
    :cond_65
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " is not encryption aware!"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local v1  # "userKeyUnlocked":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    throw v4

    .line 4398
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v0  # "callingUid":I
    .restart local v1  # "userKeyUnlocked":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    :cond_81
    :goto_81
    monitor-exit v2

    .line 4399
    return-void

    .line 4392
    .restart local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_83
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " is currently frozen!"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local v1  # "userKeyUnlocked":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    throw v4

    .line 4383
    .restart local v0  # "callingUid":I
    .restart local v1  # "userKeyUnlocked":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    :cond_9f
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " was not installed for user "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, "!"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local v1  # "userKeyUnlocked":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    throw v4

    .line 4379
    .restart local v0  # "callingUid":I
    .restart local v1  # "userKeyUnlocked":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    :cond_c3
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " was not found!"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local v1  # "userKeyUnlocked":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    throw v4

    .line 4398
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v0  # "callingUid":I
    .restart local v1  # "userKeyUnlocked":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    :catchall_df
    move-exception v3

    monitor-exit v2
    :try_end_e1
    .catchall {:try_start_11 .. :try_end_e1} :catchall_df

    throw v3

    .line 4373
    .end local v1  # "userKeyUnlocked":Z
    :cond_e2
    new-instance v1, Ljava/lang/SecurityException;

    const-string v2, "Instant applications don\'t have access to this method"

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method public checkPermission(Ljava/lang/String;Ljava/lang/String;I)I
    .registers 6
    .param p1, "permName"  # Ljava/lang/String;
    .param p2, "pkgName"  # Ljava/lang/String;
    .param p3, "userId"  # I

    .line 5860
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5861
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mCheckPermissionDelegate:Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;

    if-nez v1, :cond_d

    .line 5862
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->checkPermissionImpl(Ljava/lang/String;Ljava/lang/String;I)I

    move-result v1

    monitor-exit v0

    return v1

    .line 5864
    :cond_d
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mCheckPermissionDelegate:Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;

    .line 5865
    .local v1, "checkPermissionDelegate":Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;
    monitor-exit v0
    :try_end_10
    .catchall {:try_start_3 .. :try_end_10} :catchall_1a

    .line 5866
    new-instance v0, Lcom/android/server/pm/-$$Lambda$PackageManagerService$b2Z8hEDt-0dbtmX9ytdWFgSa9tc;

    invoke-direct {v0, p0}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$b2Z8hEDt-0dbtmX9ytdWFgSa9tc;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    invoke-interface {v1, p1, p2, p3, v0}, Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;->checkPermission(Ljava/lang/String;Ljava/lang/String;ILcom/android/internal/util/function/TriFunction;)I

    move-result v0

    return v0

    .line 5865
    .end local v1  # "checkPermissionDelegate":Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;
    :catchall_1a
    move-exception v1

    :try_start_1b
    monitor-exit v0
    :try_end_1c
    .catchall {:try_start_1b .. :try_end_1c} :catchall_1a

    throw v1
.end method

.method public checkSignatures(Ljava/lang/String;Ljava/lang/String;)I
    .registers 12
    .param p1, "pkg1"  # Ljava/lang/String;
    .param p2, "pkg2"  # Ljava/lang/String;

    .line 6397
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 6398
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 6399
    .local v1, "p1":Landroid/content/pm/PackageParser$Package;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 6400
    .local v2, "p2":Landroid/content/pm/PackageParser$Package;
    const/4 v3, -0x4

    if-eqz v1, :cond_4e

    iget-object v4, v1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    if-eqz v4, :cond_4e

    if-eqz v2, :cond_4e

    iget-object v4, v2, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    if-nez v4, :cond_21

    goto :goto_4e

    .line 6404
    :cond_21
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v4

    .line 6405
    .local v4, "callingUid":I
    invoke-static {v4}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v5

    .line 6406
    .local v5, "callingUserId":I
    iget-object v6, v1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    .line 6407
    .local v6, "ps1":Lcom/android/server/pm/PackageSetting;
    iget-object v7, v2, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 6408
    .local v7, "ps2":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v6, v4, v5}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v8

    if-nez v8, :cond_4c

    .line 6409
    invoke-direct {p0, v7, v4, v5}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v8

    if-eqz v8, :cond_3e

    goto :goto_4c

    .line 6412
    :cond_3e
    iget-object v3, v1, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v3, v3, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    iget-object v8, v2, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v8, v8, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    invoke-static {v3, v8}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v3

    monitor-exit v0

    return v3

    .line 6410
    :cond_4c
    :goto_4c
    monitor-exit v0

    return v3

    .line 6402
    .end local v4  # "callingUid":I
    .end local v5  # "callingUserId":I
    .end local v6  # "ps1":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "ps2":Lcom/android/server/pm/PackageSetting;
    :cond_4e
    :goto_4e
    monitor-exit v0

    return v3

    .line 6413
    .end local v1  # "p1":Landroid/content/pm/PackageParser$Package;
    .end local v2  # "p2":Landroid/content/pm/PackageParser$Package;
    :catchall_50
    move-exception v1

    monitor-exit v0
    :try_end_52
    .catchall {:try_start_3 .. :try_end_52} :catchall_50

    throw v1
.end method

.method public checkUidPermission(Ljava/lang/String;I)I
    .registers 5
    .param p1, "permName"  # Ljava/lang/String;
    .param p2, "uid"  # I

    .line 5884
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5885
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mCheckPermissionDelegate:Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;

    if-nez v1, :cond_d

    .line 5886
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->checkUidPermissionImpl(Ljava/lang/String;I)I

    move-result v1

    monitor-exit v0

    return v1

    .line 5888
    :cond_d
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mCheckPermissionDelegate:Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;

    .line 5889
    .local v1, "checkPermissionDelegate":Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;
    monitor-exit v0
    :try_end_10
    .catchall {:try_start_3 .. :try_end_10} :catchall_1a

    .line 5890
    new-instance v0, Lcom/android/server/pm/-$$Lambda$PackageManagerService$XJQWfaGM1EYfvHM2L3JN55XapIQ;

    invoke-direct {v0, p0}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$XJQWfaGM1EYfvHM2L3JN55XapIQ;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    invoke-interface {v1, p1, p2, v0}, Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;->checkUidPermission(Ljava/lang/String;ILjava/util/function/BiFunction;)I

    move-result v0

    return v0

    .line 5889
    .end local v1  # "checkPermissionDelegate":Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;
    :catchall_1a
    move-exception v1

    :try_start_1b
    monitor-exit v0
    :try_end_1c
    .catchall {:try_start_1b .. :try_end_1c} :catchall_1a

    throw v1
.end method

.method public checkUidSignatures(II)I
    .registers 14
    .param p1, "uid1"  # I
    .param p2, "uid2"  # I

    .line 6418
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 6419
    .local v0, "callingUid":I
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    .line 6420
    .local v1, "callingUserId":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v2

    if-eqz v2, :cond_10

    const/4 v2, 0x1

    goto :goto_11

    :cond_10
    const/4 v2, 0x0

    .line 6422
    .local v2, "isCallerInstantApp":Z
    :goto_11
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v3

    .line 6423
    .local v3, "appId1":I
    invoke-static {p2}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v4

    .line 6425
    .local v4, "appId2":I
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 6428
    :try_start_1c
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v6, v3}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v6

    .line 6429
    .local v6, "obj":Ljava/lang/Object;
    const/4 v7, -0x4

    if-eqz v6, :cond_8b

    .line 6430
    instance-of v8, v6, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v8, :cond_37

    .line 6431
    if-eqz v2, :cond_2d

    .line 6432
    monitor-exit v5

    return v7

    .line 6434
    :cond_2d
    move-object v8, v6

    check-cast v8, Lcom/android/server/pm/SharedUserSetting;

    iget-object v8, v8, Lcom/android/server/pm/SharedUserSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v8, v8, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v8, v8, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .local v8, "s1":[Landroid/content/pm/Signature;
    goto :goto_4e

    .line 6435
    .end local v8  # "s1":[Landroid/content/pm/Signature;
    :cond_37
    instance-of v8, v6, Lcom/android/server/pm/PackageSetting;

    if-eqz v8, :cond_89

    .line 6436
    move-object v8, v6

    check-cast v8, Lcom/android/server/pm/PackageSetting;

    .line 6437
    .local v8, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v8, v0, v1}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v9

    if-eqz v9, :cond_46

    .line 6438
    monitor-exit v5

    return v7

    .line 6440
    :cond_46
    iget-object v9, v8, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v9, v9, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v9, v9, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    move-object v8, v9

    .line 6441
    .local v8, "s1":[Landroid/content/pm/Signature;
    nop

    .line 6447
    :goto_4e
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v9, v4}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v9

    move-object v6, v9

    .line 6448
    if-eqz v6, :cond_87

    .line 6449
    instance-of v9, v6, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v9, :cond_69

    .line 6450
    if-eqz v2, :cond_5f

    .line 6451
    monitor-exit v5

    return v7

    .line 6453
    :cond_5f
    move-object v7, v6

    check-cast v7, Lcom/android/server/pm/SharedUserSetting;

    iget-object v7, v7, Lcom/android/server/pm/SharedUserSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v7, v7, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v7, v7, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .local v7, "s2":[Landroid/content/pm/Signature;
    goto :goto_7f

    .line 6454
    .end local v7  # "s2":[Landroid/content/pm/Signature;
    :cond_69
    instance-of v9, v6, Lcom/android/server/pm/PackageSetting;

    if-eqz v9, :cond_85

    .line 6455
    move-object v9, v6

    check-cast v9, Lcom/android/server/pm/PackageSetting;

    .line 6456
    .local v9, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v9, v0, v1}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v10

    if-eqz v10, :cond_78

    .line 6457
    monitor-exit v5

    return v7

    .line 6459
    :cond_78
    iget-object v7, v9, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v7, v7, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v7, v7, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .line 6460
    .end local v9  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "s2":[Landroid/content/pm/Signature;
    nop

    .line 6466
    :goto_7f
    invoke-static {v8, v7}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v9

    monitor-exit v5

    return v9

    .line 6461
    .end local v7  # "s2":[Landroid/content/pm/Signature;
    :cond_85
    monitor-exit v5

    return v7

    .line 6464
    :cond_87
    monitor-exit v5

    return v7

    .line 6442
    .end local v8  # "s1":[Landroid/content/pm/Signature;
    :cond_89
    monitor-exit v5

    return v7

    .line 6445
    :cond_8b
    monitor-exit v5

    return v7

    .line 6467
    .end local v6  # "obj":Ljava/lang/Object;
    :catchall_8d
    move-exception v6

    monitor-exit v5
    :try_end_8f
    .catchall {:try_start_1c .. :try_end_8f} :catchall_8d

    throw v6
.end method

.method cleanPackageDataStructuresLILPw(Landroid/content/pm/PackageParser$Package;Z)V
    .registers 13
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "chatty"  # Z

    .line 13422
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, p1, p2}, Lcom/android/server/pm/ComponentResolver;->removeAllComponents(Landroid/content/pm/PackageParser$Package;Z)V

    .line 13424
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-virtual {v0, p1, p2}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->removeAllPermissions(Landroid/content/pm/PackageParser$Package;Z)V

    .line 13426
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->instrumentation:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 13427
    .local v0, "instrumentationSize":I
    const/4 v1, 0x0

    .line 13429
    .local v1, "r":Ljava/lang/StringBuilder;
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_12
    const/16 v3, 0x100

    const/16 v4, 0x20

    if-ge v2, v0, :cond_45

    .line 13430
    iget-object v5, p1, Landroid/content/pm/PackageParser$Package;->instrumentation:Ljava/util/ArrayList;

    invoke-virtual {v5, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Instrumentation;

    .line 13431
    .local v5, "a":Landroid/content/pm/PackageParser$Instrumentation;
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mInstrumentation:Landroid/util/ArrayMap;

    invoke-virtual {v5}, Landroid/content/pm/PackageParser$Instrumentation;->getComponentName()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v6, v7}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 13432
    sget-boolean v6, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v6, :cond_42

    if-eqz p2, :cond_42

    .line 13433
    if-nez v1, :cond_38

    .line 13434
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4, v3}, Ljava/lang/StringBuilder;-><init>(I)V

    move-object v1, v4

    goto :goto_3b

    .line 13436
    :cond_38
    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;

    .line 13438
    :goto_3b
    iget-object v3, v5, Landroid/content/pm/PackageParser$Instrumentation;->info:Landroid/content/pm/InstrumentationInfo;

    iget-object v3, v3, Landroid/content/pm/InstrumentationInfo;->name:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 13429
    .end local v5  # "a":Landroid/content/pm/PackageParser$Instrumentation;
    :cond_42
    add-int/lit8 v2, v2, 0x1

    goto :goto_12

    .line 13441
    :cond_45
    const-string v5, "PackageManager"

    if-eqz v1, :cond_61

    .line 13442
    sget-boolean v6, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v6, :cond_61

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  Instrumentation: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 13445
    :cond_61
    const/4 v1, 0x0

    .line 13446
    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v6, v6, 0x1

    if-eqz v6, :cond_9f

    .line 13448
    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    if-eqz v6, :cond_9f

    .line 13449
    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    .line 13450
    .local v6, "libraryNamesSize":I
    const/4 v2, 0x0

    :goto_75
    if-ge v2, v6, :cond_9f

    .line 13451
    iget-object v7, p1, Landroid/content/pm/PackageParser$Package;->libraryNames:Ljava/util/ArrayList;

    invoke-virtual {v7, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/lang/String;

    .line 13452
    .local v7, "name":Ljava/lang/String;
    const-wide/16 v8, 0x0

    invoke-direct {p0, v7, v8, v9}, Lcom/android/server/pm/PackageManagerService;->removeSharedLibraryLPw(Ljava/lang/String;J)Z

    move-result v8

    if-eqz v8, :cond_9c

    .line 13453
    sget-boolean v8, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v8, :cond_9c

    if-eqz p2, :cond_9c

    .line 13454
    if-nez v1, :cond_96

    .line 13455
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8, v3}, Ljava/lang/StringBuilder;-><init>(I)V

    move-object v1, v8

    goto :goto_99

    .line 13457
    :cond_96
    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;

    .line 13459
    :goto_99
    invoke-virtual {v1, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 13450
    .end local v7  # "name":Ljava/lang/String;
    :cond_9c
    add-int/lit8 v2, v2, 0x1

    goto :goto_75

    .line 13466
    .end local v6  # "libraryNamesSize":I
    :cond_9f
    const/4 v1, 0x0

    .line 13469
    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-eqz v6, :cond_c5

    .line 13470
    iget-object v6, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    iget-wide v7, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibVersion:J

    invoke-direct {p0, v6, v7, v8}, Lcom/android/server/pm/PackageManagerService;->removeSharedLibraryLPw(Ljava/lang/String;J)Z

    move-result v6

    if-eqz v6, :cond_c5

    .line 13471
    sget-boolean v6, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v6, :cond_c5

    if-eqz p2, :cond_c5

    .line 13472
    if-nez v1, :cond_bd

    .line 13473
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4, v3}, Ljava/lang/StringBuilder;-><init>(I)V

    move-object v1, v4

    goto :goto_c0

    .line 13475
    :cond_bd
    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(C)Ljava/lang/StringBuilder;

    .line 13477
    :goto_c0
    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 13482
    :cond_c5
    if-eqz v1, :cond_df

    .line 13483
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v3, :cond_df

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  Libraries: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v5, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 13485
    :cond_df
    return-void
.end method

.method cleanUpUser(Lcom/android/server/pm/UserManagerService;I)V
    .registers 6
    .param p1, "userManager"  # Lcom/android/server/pm/UserManagerService;
    .param p2, "userHandle"  # I

    .line 24631
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 24632
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mDirtyUsers:Landroid/util/ArraySet;

    invoke-static {p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    invoke-virtual {v1, v2}, Landroid/util/ArraySet;->remove(Ljava/lang/Object;)Z

    .line 24633
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mUserNeedsBadging:Landroid/util/SparseBooleanArray;

    invoke-virtual {v1, p2}, Landroid/util/SparseBooleanArray;->delete(I)V

    .line 24634
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p2}, Lcom/android/server/pm/Settings;->removeUserLPw(I)V

    .line 24635
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPendingBroadcasts:Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;

    invoke-virtual {v1, p2}, Lcom/android/server/pm/PackageManagerService$PendingPackageBroadcasts;->remove(I)V

    .line 24636
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    invoke-virtual {v1, p2}, Lcom/android/server/pm/InstantAppRegistry;->onUserRemovedLPw(I)V

    .line 24637
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->removeUnusedPackagesLPw(Lcom/android/server/pm/UserManagerService;I)V

    .line 24638
    monitor-exit v0

    .line 24639
    return-void

    .line 24638
    :catchall_25
    move-exception v1

    monitor-exit v0
    :try_end_27
    .catchall {:try_start_3 .. :try_end_27} :catchall_25

    throw v1
.end method

.method public clearApplicationProfileData(Ljava/lang/String;)V
    .registers 7
    .param p1, "packageName"  # Ljava/lang/String;

    .line 20633
    const-string v0, "Only the system can clear all profile data"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrRoot(Ljava/lang/String;)V

    .line 20636
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 20637
    :try_start_8
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 20638
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    monitor-exit v0
    :try_end_11
    .catchall {:try_start_8 .. :try_end_11} :catchall_32

    .line 20640
    const-string v0, "clearApplicationProfileData"

    invoke-virtual {p0, p1, v0}, Lcom/android/server/pm/PackageManagerService;->freezePackage(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v0

    .local v0, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    const/4 v2, 0x0

    .line 20641
    :try_start_18
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v3
    :try_end_1b
    .catchall {:try_start_18 .. :try_end_1b} :catchall_29

    .line 20642
    const/4 v4, -0x1

    :try_start_1c
    invoke-direct {p0, v1, v4}, Lcom/android/server/pm/PackageManagerService;->clearAppProfilesLIF(Landroid/content/pm/PackageParser$Package;I)V

    .line 20643
    monitor-exit v3
    :try_end_20
    .catchall {:try_start_1c .. :try_end_20} :catchall_26

    .line 20644
    if-eqz v0, :cond_25

    invoke-static {v2, v0}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    .line 20645
    .end local v0  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :cond_25
    return-void

    .line 20643
    .restart local v0  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :catchall_26
    move-exception v2

    :try_start_27
    monitor-exit v3
    :try_end_28
    .catchall {:try_start_27 .. :try_end_28} :catchall_26

    .end local v0  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    :try_start_28
    throw v2
    :try_end_29
    .catchall {:try_start_28 .. :try_end_29} :catchall_29

    .line 20640
    .restart local v0  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    :catchall_29
    move-exception v2

    .end local v0  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    :try_start_2a
    throw v2
    :try_end_2b
    .catchall {:try_start_2a .. :try_end_2b} :catchall_2b

    .line 20644
    .restart local v0  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    :catchall_2b
    move-exception v3

    if-eqz v0, :cond_31

    invoke-static {v2, v0}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    :cond_31
    throw v3

    .line 20638
    .end local v0  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_32
    move-exception v1

    :try_start_33
    monitor-exit v0
    :try_end_34
    .catchall {:try_start_33 .. :try_end_34} :catchall_32

    throw v1
.end method

.method public clearApplicationUserData(Ljava/lang/String;Landroid/content/pm/IPackageDataObserver;I)V
    .registers 15
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "observer"  # Landroid/content/pm/IPackageDataObserver;
    .param p3, "userId"  # I

    .line 20650
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.CLEAR_APP_USER_DATA"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 20653
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 20654
    .local v0, "callingUid":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v6, 0x1

    const/4 v7, 0x0

    const-string v8, "clear application data"

    move v4, v0

    move v5, p3

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 20657
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v1

    .line 20658
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_27

    invoke-direct {p0, v1, v0, p3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v2

    if-eqz v2, :cond_27

    const/4 v2, 0x1

    goto :goto_28

    :cond_27
    const/4 v2, 0x0

    .line 20659
    .local v2, "filterApp":Z
    :goto_28
    if-nez v2, :cond_4a

    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mProtectedPackages:Lcom/android/server/pm/ProtectedPackages;

    invoke-virtual {v3, p3, p1}, Lcom/android/server/pm/ProtectedPackages;->isPackageDataProtected(ILjava/lang/String;)Z

    move-result v3

    if-nez v3, :cond_33

    goto :goto_4a

    .line 20660
    :cond_33
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Cannot clear data for a protected package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 20664
    :cond_4a
    :goto_4a
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v10, Lcom/android/server/pm/PackageManagerService$4;

    move-object v3, v10

    move-object v4, p0

    move v5, v2

    move-object v6, p1

    move v7, p3

    move-object v8, p2

    invoke-direct/range {v3 .. v8}, Lcom/android/server/pm/PackageManagerService$4;-><init>(Lcom/android/server/pm/PackageManagerService;ZLjava/lang/String;ILandroid/content/pm/IPackageDataObserver;)V

    invoke-virtual {v9, v10}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 20703
    return-void
.end method

.method public clearCrossProfileIntentFilters(ILjava/lang/String;)V
    .registers 10
    .param p1, "sourceUserId"  # I
    .param p2, "ownerPackage"  # Ljava/lang/String;

    .line 21771
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.INTERACT_ACROSS_USERS_FULL"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 21773
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 21774
    .local v0, "callingUid":I
    invoke-direct {p0, p2, v0}, Lcom/android/server/pm/PackageManagerService;->enforceOwnerRights(Ljava/lang/String;I)V

    .line 21775
    const-string/jumbo v1, "no_debugging_features"

    invoke-static {v1, v0, p1}, Lcom/android/server/pm/PackageManagerServiceUtils;->enforceShellRestriction(Ljava/lang/String;II)V

    .line 21777
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 21778
    :try_start_18
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    .line 21779
    invoke-virtual {v2, p1}, Lcom/android/server/pm/Settings;->editCrossProfileIntentResolverLPw(I)Lcom/android/server/pm/CrossProfileIntentResolver;

    move-result-object v2

    .line 21780
    .local v2, "resolver":Lcom/android/server/pm/CrossProfileIntentResolver;
    new-instance v3, Landroid/util/ArraySet;

    .line 21781
    invoke-virtual {v2}, Lcom/android/server/pm/CrossProfileIntentResolver;->filterSet()Ljava/util/Set;

    move-result-object v4

    invoke-direct {v3, v4}, Landroid/util/ArraySet;-><init>(Ljava/util/Collection;)V

    .line 21782
    .local v3, "set":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    invoke-virtual {v3}, Landroid/util/ArraySet;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_2b
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_45

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/CrossProfileIntentFilter;

    .line 21783
    .local v5, "filter":Lcom/android/server/pm/CrossProfileIntentFilter;
    invoke-virtual {v5}, Lcom/android/server/pm/CrossProfileIntentFilter;->getOwnerPackage()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6, p2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_44

    .line 21784
    invoke-virtual {v2, v5}, Lcom/android/server/pm/CrossProfileIntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 21786
    .end local v5  # "filter":Lcom/android/server/pm/CrossProfileIntentFilter;
    :cond_44
    goto :goto_2b

    .line 21787
    :cond_45
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 21788
    .end local v2  # "resolver":Lcom/android/server/pm/CrossProfileIntentResolver;
    .end local v3  # "set":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Lcom/android/server/pm/CrossProfileIntentFilter;>;"
    monitor-exit v1

    .line 21789
    return-void

    .line 21788
    :catchall_4a
    move-exception v2

    monitor-exit v1
    :try_end_4c
    .catchall {:try_start_18 .. :try_end_4c} :catchall_4a

    throw v2
.end method

.method clearDefaultBrowserIfNeeded(Ljava/lang/String;)V
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;

    .line 21373
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0

    array-length v1, v0

    const/4 v2, 0x0

    :goto_8
    if-ge v2, v1, :cond_12

    aget v3, v0, v2

    .line 21374
    .local v3, "oneUserId":I
    invoke-direct {p0, p1, v3}, Lcom/android/server/pm/PackageManagerService;->clearDefaultBrowserIfNeededForUser(Ljava/lang/String;I)V

    .line 21373
    .end local v3  # "oneUserId":I
    add-int/lit8 v2, v2, 0x1

    goto :goto_8

    .line 21376
    :cond_12
    return-void
.end method

.method clearIntentFilterVerificationsLPw(Ljava/lang/String;IZ)V
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "alsoResetStatus"  # Z
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 21356
    const/4 v0, -0x1

    if-ne p2, v0, :cond_23

    .line 21357
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    sget-object v1, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    .line 21358
    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v1

    .line 21357
    invoke-virtual {v0, p1, v1}, Lcom/android/server/pm/Settings;->removeIntentFilterVerificationLPw(Ljava/lang/String;[I)Z

    move-result v0

    if-eqz v0, :cond_2e

    .line 21359
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0

    array-length v1, v0

    const/4 v2, 0x0

    :goto_19
    if-ge v2, v1, :cond_2e

    aget v3, v0, v2

    .line 21360
    .local v3, "oneUserId":I
    invoke-virtual {p0, v3}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 21359
    .end local v3  # "oneUserId":I
    add-int/lit8 v2, v2, 0x1

    goto :goto_19

    .line 21364
    :cond_23
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, p1, p2, p3}, Lcom/android/server/pm/Settings;->removeIntentFilterVerificationLPw(Ljava/lang/String;IZ)Z

    move-result v0

    if-eqz v0, :cond_2e

    .line 21366
    invoke-virtual {p0, p2}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 21369
    :cond_2e
    return-void
.end method

.method public clearPackagePersistentPreferredActivities(Ljava/lang/String;I)V
    .registers 14
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 21480
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 21481
    .local v0, "callingUid":I
    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_87

    .line 21485
    const/4 v1, 0x0

    .line 21486
    .local v1, "removed":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PersistentPreferredActivity;>;"
    const/4 v2, 0x0

    .line 21487
    .local v2, "changed":Z
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 21488
    const/4 v4, 0x0

    move v5, v4

    .local v5, "i":I
    :goto_f
    :try_start_f
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v6, Lcom/android/server/pm/Settings;->mPersistentPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I

    move-result v6

    if-ge v5, v6, :cond_6f

    .line 21489
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v6, v6, Lcom/android/server/pm/Settings;->mPersistentPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v6, v5}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v6

    .line 21490
    .local v6, "thisUserId":I
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mPersistentPreferredActivities:Landroid/util/SparseArray;

    .line 21491
    invoke-virtual {v7, v5}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PersistentPreferredIntentResolver;

    .line 21492
    .local v7, "ppir":Lcom/android/server/pm/PersistentPreferredIntentResolver;
    if-eq p2, v6, :cond_2e

    .line 21493
    goto :goto_6c

    .line 21495
    :cond_2e
    invoke-virtual {v7}, Lcom/android/server/pm/PersistentPreferredIntentResolver;->filterIterator()Ljava/util/Iterator;

    move-result-object v8

    .line 21496
    .local v8, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PersistentPreferredActivity;>;"
    :goto_32
    invoke-interface {v8}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_56

    .line 21497
    invoke-interface {v8}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/pm/PersistentPreferredActivity;

    .line 21499
    .local v9, "ppa":Lcom/android/server/pm/PersistentPreferredActivity;
    iget-object v10, v9, Lcom/android/server/pm/PersistentPreferredActivity;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v10}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v10, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v10

    if-eqz v10, :cond_55

    .line 21500
    if-nez v1, :cond_52

    .line 21501
    new-instance v10, Ljava/util/ArrayList;

    invoke-direct {v10}, Ljava/util/ArrayList;-><init>()V

    move-object v1, v10

    .line 21503
    :cond_52
    invoke-virtual {v1, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 21505
    .end local v9  # "ppa":Lcom/android/server/pm/PersistentPreferredActivity;
    :cond_55
    goto :goto_32

    .line 21506
    :cond_56
    if-eqz v1, :cond_6c

    .line 21507
    move v9, v4

    .local v9, "j":I
    :goto_59
    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v9, v10, :cond_6b

    .line 21508
    invoke-virtual {v1, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/pm/PersistentPreferredActivity;

    .line 21509
    .local v10, "ppa":Lcom/android/server/pm/PersistentPreferredActivity;
    invoke-virtual {v7, v10}, Lcom/android/server/pm/PersistentPreferredIntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 21507
    .end local v10  # "ppa":Lcom/android/server/pm/PersistentPreferredActivity;
    add-int/lit8 v9, v9, 0x1

    goto :goto_59

    .line 21511
    .end local v9  # "j":I
    :cond_6b
    const/4 v2, 0x1

    .line 21488
    .end local v6  # "thisUserId":I
    .end local v7  # "ppir":Lcom/android/server/pm/PersistentPreferredIntentResolver;
    .end local v8  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PersistentPreferredActivity;>;"
    :cond_6c
    :goto_6c
    add-int/lit8 v5, v5, 0x1

    goto :goto_f

    .line 21514
    .end local v5  # "i":I
    :cond_6f
    monitor-exit v3
    :try_end_70
    .catchall {:try_start_f .. :try_end_70} :catchall_84

    .line 21515
    if-eqz v2, :cond_83

    .line 21516
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(I)Z

    .line 21517
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->postPreferredActivityChangedBroadcast(I)V

    .line 21518
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 21519
    :try_start_7b
    invoke-virtual {p0, p2}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 21520
    monitor-exit v3

    goto :goto_83

    :catchall_80
    move-exception v4

    monitor-exit v3
    :try_end_82
    .catchall {:try_start_7b .. :try_end_82} :catchall_80

    throw v4

    .line 21522
    :cond_83
    :goto_83
    return-void

    .line 21514
    :catchall_84
    move-exception v4

    :try_start_85
    monitor-exit v3
    :try_end_86
    .catchall {:try_start_85 .. :try_end_86} :catchall_84

    throw v4

    .line 21482
    .end local v1  # "removed":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PersistentPreferredActivity;>;"
    .end local v2  # "changed":Z
    :cond_87
    new-instance v1, Ljava/lang/SecurityException;

    const-string v2, "clearPackagePersistentPreferredActivities can only be run by the system"

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method public clearPackagePreferredActivities(Ljava/lang/String;)V
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;

    .line 21268
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 21269
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    if-eqz v1, :cond_b

    .line 21270
    return-void

    .line 21273
    :cond_b
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 21274
    :try_start_e
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 21275
    .local v2, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v2, :cond_1e

    invoke-direct {p0, p1, v0}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v3

    if-nez v3, :cond_50

    .line 21276
    :cond_1e
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v4, "android.permission.SET_PREFERRED_APPLICATIONS"

    invoke-virtual {v3, v4}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v3

    if-eqz v3, :cond_50

    .line 21279
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getUidTargetSdkVersionLockedLPr(I)I

    move-result v3

    const/16 v4, 0x8

    if-ge v3, v4, :cond_48

    .line 21281
    const-string v3, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Ignoring clearPackagePreferredActivities() from uid "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 21283
    monitor-exit v1

    return-void

    .line 21285
    :cond_48
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v4, "android.permission.SET_PREFERRED_APPLICATIONS"

    const/4 v5, 0x0

    invoke-virtual {v3, v4, v5}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 21289
    :cond_50
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, p1}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v3

    .line 21290
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_64

    .line 21291
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v4

    invoke-direct {p0, v3, v0, v4}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v4

    if-eqz v4, :cond_64

    .line 21292
    monitor-exit v1

    return-void

    .line 21294
    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_64
    monitor-exit v1
    :try_end_65
    .catchall {:try_start_e .. :try_end_65} :catchall_89

    .line 21295
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v1

    .line 21296
    .local v1, "callingUserId":I
    new-instance v2, Landroid/util/SparseBooleanArray;

    invoke-direct {v2}, Landroid/util/SparseBooleanArray;-><init>()V

    .line 21297
    .local v2, "changedUsers":Landroid/util/SparseBooleanArray;
    invoke-direct {p0, p1, v2, v1}, Lcom/android/server/pm/PackageManagerService;->clearPackagePreferredActivitiesLPw(Ljava/lang/String;Landroid/util/SparseBooleanArray;I)V

    .line 21298
    invoke-virtual {v2}, Landroid/util/SparseBooleanArray;->size()I

    move-result v3

    if-lez v3, :cond_88

    .line 21299
    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(Landroid/util/SparseBooleanArray;)V

    .line 21300
    invoke-direct {p0, v1}, Lcom/android/server/pm/PackageManagerService;->postPreferredActivityChangedBroadcast(I)V

    .line 21301
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 21302
    :try_start_80
    invoke-virtual {p0, v1}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 21303
    monitor-exit v3

    goto :goto_88

    :catchall_85
    move-exception v4

    monitor-exit v3
    :try_end_87
    .catchall {:try_start_80 .. :try_end_87} :catchall_85

    throw v4

    .line 21305
    :cond_88
    :goto_88
    return-void

    .line 21294
    .end local v1  # "callingUserId":I
    .end local v2  # "changedUsers":Landroid/util/SparseBooleanArray;
    :catchall_89
    move-exception v2

    :try_start_8a
    monitor-exit v1
    :try_end_8b
    .catchall {:try_start_8a .. :try_end_8b} :catchall_89

    throw v2
.end method

.method public compileLayouts(Ljava/lang/String;)Z
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;

    .line 10408
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 10409
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 10410
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    if-nez v1, :cond_10

    .line 10411
    const/4 v2, 0x0

    monitor-exit v0

    return v2

    .line 10413
    :cond_10
    monitor-exit v0
    :try_end_11
    .catchall {:try_start_3 .. :try_end_11} :catchall_18

    .line 10414
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mViewCompiler:Lcom/android/server/pm/dex/ViewCompiler;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/dex/ViewCompiler;->compileLayouts(Landroid/content/pm/PackageParser$Package;)Z

    move-result v0

    return v0

    .line 10413
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_18
    move-exception v1

    :try_start_19
    monitor-exit v0
    :try_end_1a
    .catchall {:try_start_19 .. :try_end_1a} :catchall_18

    throw v1
.end method

.method createNewUser(I[Ljava/lang/String;)V
    .registers 6
    .param p1, "userId"  # I
    .param p2, "disallowedPackages"  # [Ljava/lang/String;

    .line 24695
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v0

    .line 24696
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v1, p0, v2, p1, p2}, Lcom/android/server/pm/Settings;->createNewUserLI(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/Installer;I[Ljava/lang/String;)V

    .line 24697
    monitor-exit v0
    :try_end_b
    .catchall {:try_start_3 .. :try_end_b} :catchall_1c

    .line 24698
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 24699
    :try_start_e
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 24700
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageListLocked(I)V

    .line 24701
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->primeDomainVerificationsLPw(I)V

    .line 24702
    monitor-exit v1

    .line 24703
    return-void

    .line 24702
    :catchall_19
    move-exception v0

    monitor-exit v1
    :try_end_1b
    .catchall {:try_start_e .. :try_end_1b} :catchall_19

    throw v0

    .line 24697
    :catchall_1c
    move-exception v1

    :try_start_1d
    monitor-exit v0
    :try_end_1e
    .catchall {:try_start_1d .. :try_end_1e} :catchall_1c

    throw v1
.end method

.method public currentToCanonicalPackageNames([Ljava/lang/String;)[Ljava/lang/String;
    .registers 15
    .param p1, "names"  # [Ljava/lang/String;

    .line 4697
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 4698
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    if-eqz v1, :cond_b

    .line 4699
    return-object p1

    .line 4701
    :cond_b
    array-length v1, p1

    new-array v1, v1, [Ljava/lang/String;

    .line 4703
    .local v1, "out":[Ljava/lang/String;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 4704
    :try_start_11
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v3

    .line 4705
    .local v3, "callingUserId":I
    invoke-direct {p0, v0, v3}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v4

    .line 4706
    .local v4, "canViewInstantApps":Z
    array-length v5, p1

    const/4 v6, 0x1

    sub-int/2addr v5, v6

    .local v5, "i":I
    :goto_1c
    if-ltz v5, :cond_58

    .line 4707
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    aget-object v8, p1, v5

    invoke-virtual {v7, v8}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 4708
    .local v7, "ps":Lcom/android/server/pm/PackageSetting;
    const/4 v8, 0x0

    .line 4709
    .local v8, "translateName":Z
    if-eqz v7, :cond_4c

    iget-object v9, v7, Lcom/android/server/pm/PackageSetting;->realName:Ljava/lang/String;

    if-eqz v9, :cond_4c

    .line 4710
    invoke-virtual {v7, v3}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v9

    .line 4711
    .local v9, "targetIsInstantApp":Z
    if-eqz v9, :cond_4a

    if-nez v4, :cond_4a

    iget-object v10, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    .line 4714
    invoke-static {v0}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v11

    iget v12, v7, Lcom/android/server/pm/PackageSetting;->appId:I

    .line 4713
    invoke-virtual {v10, v3, v11, v12}, Lcom/android/server/pm/InstantAppRegistry;->isInstantAccessGranted(III)Z

    move-result v10

    if-eqz v10, :cond_48

    goto :goto_4a

    :cond_48
    const/4 v10, 0x0

    goto :goto_4b

    :cond_4a
    :goto_4a
    move v10, v6

    :goto_4b
    move v8, v10

    .line 4716
    .end local v9  # "targetIsInstantApp":Z
    :cond_4c
    if-eqz v8, :cond_51

    iget-object v9, v7, Lcom/android/server/pm/PackageSetting;->realName:Ljava/lang/String;

    goto :goto_53

    :cond_51
    aget-object v9, p1, v5

    :goto_53
    aput-object v9, v1, v5

    .line 4706
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v8  # "translateName":Z
    add-int/lit8 v5, v5, -0x1

    goto :goto_1c

    .line 4718
    .end local v3  # "callingUserId":I
    .end local v4  # "canViewInstantApps":Z
    .end local v5  # "i":I
    :cond_58
    monitor-exit v2

    .line 4719
    return-object v1

    .line 4718
    :catchall_5a
    move-exception v3

    monitor-exit v2
    :try_end_5c
    .catchall {:try_start_11 .. :try_end_5c} :catchall_5a

    throw v3
.end method

.method public deleteApplicationCacheFiles(Ljava/lang/String;Landroid/content/pm/IPackageDataObserver;)V
    .registers 4
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "observer"  # Landroid/content/pm/IPackageDataObserver;

    .line 20971
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    .line 20972
    .local v0, "userId":I
    invoke-virtual {p0, p1, v0, p2}, Lcom/android/server/pm/PackageManagerService;->deleteApplicationCacheFilesAsUser(Ljava/lang/String;ILandroid/content/pm/IPackageDataObserver;)V

    .line 20973
    return-void
.end method

.method public deleteApplicationCacheFilesAsUser(Ljava/lang/String;ILandroid/content/pm/IPackageDataObserver;)V
    .registers 16
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "observer"  # Landroid/content/pm/IPackageDataObserver;

    .line 20978
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    .line 20979
    .local v8, "callingUid":I
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.INTERNAL_DELETE_CACHE_FILES"

    invoke-virtual {v0, v1}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_46

    .line 20983
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.DELETE_CACHE_FILES"

    invoke-virtual {v0, v1}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    if-nez v0, :cond_3e

    .line 20986
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Calling uid "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, " does not have "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "android.permission.INTERNAL_DELETE_CACHE_FILES"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, ", silently ignoring"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 20989
    return-void

    .line 20991
    :cond_3e
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const/4 v1, 0x0

    const-string v2, "android.permission.INTERNAL_DELETE_CACHE_FILES"

    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 20994
    :cond_46
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v3, 0x1

    const/4 v4, 0x0

    const-string v5, "delete application cache files"

    move v1, v8

    move v2, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 20997
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.ACCESS_INSTANT_APPS"

    invoke-virtual {v0, v1}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v9

    .line 21001
    .local v9, "hasAccessInstantApps":I
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 21002
    :try_start_5c
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    move-object v2, v1

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 21003
    .local v2, "pkg":Landroid/content/pm/PackageParser$Package;
    monitor-exit v0
    :try_end_66
    .catchall {:try_start_5c .. :try_end_66} :catchall_78

    .line 21006
    iget-object v10, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v11, Lcom/android/server/pm/-$$Lambda$PackageManagerService$QTvvdwSiCiDunKinsETE3x3ruu8;

    move-object v0, v11

    move-object v1, p0

    move v3, v8

    move v4, v9

    move v5, p2

    move-object v6, p3

    move-object v7, p1

    invoke-direct/range {v0 .. v7}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$QTvvdwSiCiDunKinsETE3x3ruu8;-><init>(Lcom/android/server/pm/PackageManagerService;Landroid/content/pm/PackageParser$Package;IIILandroid/content/pm/IPackageDataObserver;Ljava/lang/String;)V

    invoke-virtual {v10, v11}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 21032
    return-void

    .line 21003
    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_78
    move-exception v1

    :try_start_79
    monitor-exit v0
    :try_end_7a
    .catchall {:try_start_79 .. :try_end_7a} :catchall_78

    throw v1
.end method

.method public deleteCompilerPackageStats(Ljava/lang/String;)V
    .registers 3
    .param p1, "pkgName"  # Ljava/lang/String;

    .line 26289
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mCompilerStats:Lcom/android/server/pm/CompilerStats;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/CompilerStats;->deletePackageStats(Ljava/lang/String;)V

    .line 26290
    return-void
.end method

.method deleteOatArtifactsOfPackage(Ljava/lang/String;)V
    .registers 14
    .param p1, "packageName"  # Ljava/lang/String;

    .line 26432
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26433
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 26434
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    monitor-exit v0
    :try_end_c
    .catchall {:try_start_3 .. :try_end_c} :catchall_52

    .line 26435
    iget-object v0, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-static {v0}, Lcom/android/server/pm/InstructionSets;->getAppDexInstructionSets(Landroid/content/pm/ApplicationInfo;)[Ljava/lang/String;

    move-result-object v0

    .line 26436
    .local v0, "instructionSets":[Ljava/lang/String;
    invoke-virtual {v1}, Landroid/content/pm/PackageParser$Package;->getAllCodePaths()Ljava/util/List;

    move-result-object v2

    .line 26437
    .local v2, "codePaths":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    invoke-direct {p0, v1}, Lcom/android/server/pm/PackageManagerService;->getOatDir(Landroid/content/pm/PackageParser$Package;)Ljava/lang/String;

    move-result-object v3

    .line 26439
    .local v3, "oatDir":Ljava/lang/String;
    invoke-interface {v2}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_1e
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_51

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/String;

    .line 26440
    .local v5, "codePath":Ljava/lang/String;
    array-length v6, v0

    const/4 v7, 0x0

    :goto_2c
    if-ge v7, v6, :cond_50

    aget-object v8, v0, v7

    .line 26442
    .local v8, "isa":Ljava/lang/String;
    :try_start_30
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v9, v5, v8, v3}, Lcom/android/server/pm/Installer;->deleteOdex(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
    :try_end_35
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_30 .. :try_end_35} :catch_36

    .line 26445
    goto :goto_4d

    .line 26443
    :catch_36
    move-exception v9

    .line 26444
    .local v9, "e":Lcom/android/server/pm/Installer$InstallerException;
    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Failed deleting oat files for "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    const-string v11, "PackageManager"

    invoke-static {v11, v10, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 26440
    .end local v8  # "isa":Ljava/lang/String;
    .end local v9  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :goto_4d
    add-int/lit8 v7, v7, 0x1

    goto :goto_2c

    .line 26447
    .end local v5  # "codePath":Ljava/lang/String;
    :cond_50
    goto :goto_1e

    .line 26448
    :cond_51
    return-void

    .line 26434
    .end local v0  # "instructionSets":[Ljava/lang/String;
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v2  # "codePaths":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v3  # "oatDir":Ljava/lang/String;
    :catchall_52
    move-exception v1

    :try_start_53
    monitor-exit v0
    :try_end_54
    .catchall {:try_start_53 .. :try_end_54} :catchall_52

    throw v1
.end method

.method public deletePackageAsUser(Ljava/lang/String;ILandroid/content/pm/IPackageDeleteObserver;II)V
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "versionCode"  # I
    .param p3, "observer"  # Landroid/content/pm/IPackageDeleteObserver;
    .param p4, "userId"  # I
    .param p5, "flags"  # I

    .line 19071
    new-instance v0, Landroid/content/pm/VersionedPackage;

    invoke-direct {v0, p1, p2}, Landroid/content/pm/VersionedPackage;-><init>(Ljava/lang/String;I)V

    new-instance v1, Landroid/content/pm/PackageManager$LegacyPackageDeleteObserver;

    invoke-direct {v1, p3}, Landroid/content/pm/PackageManager$LegacyPackageDeleteObserver;-><init>(Landroid/content/pm/IPackageDeleteObserver;)V

    .line 19072
    invoke-virtual {v1}, Landroid/content/pm/PackageManager$LegacyPackageDeleteObserver;->getBinder()Landroid/content/pm/IPackageDeleteObserver2;

    move-result-object v1

    .line 19071
    invoke-virtual {p0, v0, v1, p4, p5}, Lcom/android/server/pm/PackageManagerService;->deletePackageVersioned(Landroid/content/pm/VersionedPackage;Landroid/content/pm/IPackageDeleteObserver2;II)V

    .line 19073
    return-void
.end method

.method public deletePackageVersioned(Landroid/content/pm/VersionedPackage;Landroid/content/pm/IPackageDeleteObserver2;II)V
    .registers 30
    .param p1, "versionedPackage"  # Landroid/content/pm/VersionedPackage;
    .param p2, "observer"  # Landroid/content/pm/IPackageDeleteObserver2;
    .param p3, "userId"  # I
    .param p4, "deleteFlags"  # I

    .line 19078
    move-object/from16 v14, p0

    move-object/from16 v15, p2

    move/from16 v13, p3

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v12

    .line 19079
    .local v12, "callingUid":I
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const/4 v1, 0x0

    const-string v2, "android.permission.DELETE_PACKAGES"

    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 19081
    invoke-direct {v14, v12, v13}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v16

    .line 19082
    .local v16, "canViewInstantApps":Z
    invoke-static/range {p1 .. p1}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;)Ljava/lang/Object;

    .line 19083
    invoke-static/range {p2 .. p2}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;)Ljava/lang/Object;

    .line 19084
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/VersionedPackage;->getLongVersionCode()J

    move-result-wide v2

    const-wide/16 v4, -0x1

    const-wide v6, 0x7fffffffffffffffL

    const-string/jumbo v8, "versionCode must be >= -1"

    invoke-static/range {v2 .. v8}, Lcom/android/internal/util/Preconditions;->checkArgumentInRange(JJJLjava/lang/String;)J

    .line 19088
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/VersionedPackage;->getPackageName()Ljava/lang/String;

    move-result-object v11

    .line 19089
    .local v11, "packageName":Ljava/lang/String;
    invoke-virtual/range {p1 .. p1}, Landroid/content/pm/VersionedPackage;->getLongVersionCode()J

    move-result-wide v9

    .line 19091
    .local v9, "versionCode":J
    iget-object v2, v14, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 19093
    :try_start_38
    invoke-direct {v14, v11, v9, v10}, Lcom/android/server/pm/PackageManagerService;->resolveInternalPackageNameLPr(Ljava/lang/String;J)Ljava/lang/String;

    move-result-object v0

    move-object v7, v0

    .line 19094
    .local v7, "internalPackageName":Ljava/lang/String;
    monitor-exit v2
    :try_end_3e
    .catchall {:try_start_38 .. :try_end_3e} :catchall_20d

    .line 19096
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    .line 19097
    .local v8, "uid":I
    invoke-virtual {v14, v7}, Lcom/android/server/pm/PackageManagerService;->isOrphaned(Ljava/lang/String;)Z

    move-result v0

    if-nez v0, :cond_59

    .line 19098
    invoke-direct {v14, v8, v7}, Lcom/android/server/pm/PackageManagerService;->isCallerAllowedToSilentlyUninstall(ILjava/lang/String;)Z

    move-result v0

    if-nez v0, :cond_59

    .line 19099
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$fswFUK6dCGUD9_CR_zyaZxmYAp0;

    invoke-direct {v1, v11, v15}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$fswFUK6dCGUD9_CR_zyaZxmYAp0;-><init>(Ljava/lang/String;Landroid/content/pm/IPackageDeleteObserver2;)V

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 19108
    return-void

    .line 19110
    :cond_59
    and-int/lit8 v0, p4, 0x2

    const/4 v2, 0x0

    const/4 v3, 0x1

    if-eqz v0, :cond_61

    move v0, v3

    goto :goto_62

    :cond_61
    move v0, v2

    :goto_62
    move v6, v0

    .line 19111
    .local v6, "deleteAllUsers":Z
    if-eqz v6, :cond_6c

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0

    goto :goto_70

    :cond_6c
    new-array v0, v3, [I

    aput v13, v0, v2

    :goto_70
    move-object v5, v0

    .line 19112
    .local v5, "users":[I
    invoke-static {v8}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v0

    if-ne v0, v13, :cond_7c

    if-eqz v6, :cond_9a

    array-length v0, v5

    if-le v0, v3, :cond_9a

    .line 19114
    :cond_7c
    invoke-static {}, Landroid/os/UserHandle;->isFlymeLauncherCalling()Z

    move-result v0

    .line 19116
    .local v0, "isFlymeLauncherCalling":Z
    if-nez v0, :cond_9a

    .line 19117
    iget-object v4, v14, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "deletePackage for user "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "android.permission.INTERACT_ACROSS_USERS_FULL"

    invoke-virtual {v4, v2, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 19123
    .end local v0  # "isFlymeLauncherCalling":Z
    :cond_9a
    const-string/jumbo v0, "no_uninstall_apps"

    invoke-virtual {v14, v13, v0}, Lcom/android/server/pm/PackageManagerService;->isUserRestricted(ILjava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_ae

    .line 19124
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$CS3aJUelGPn4PWtkx1QPsjrbNtc;

    invoke-direct {v1, v15, v11}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$CS3aJUelGPn4PWtkx1QPsjrbNtc;-><init>(Landroid/content/pm/IPackageDeleteObserver2;Ljava/lang/String;)V

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 19131
    return-void

    .line 19134
    :cond_ae
    if-nez v6, :cond_c1

    invoke-virtual {v14, v7, v13}, Lcom/android/server/pm/PackageManagerService;->getBlockUninstallForUser(Ljava/lang/String;I)Z

    move-result v0

    if-eqz v0, :cond_c1

    .line 19135
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$A9GGP3Sl3gE_C_zP7bNUbtlbRjI;

    invoke-direct {v1, v15, v11}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$A9GGP3Sl3gE_C_zP7bNUbtlbRjI;-><init>(Landroid/content/pm/IPackageDeleteObserver2;Ljava/lang/String;)V

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 19142
    return-void

    .line 19145
    :cond_c1
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z

    if-eqz v0, :cond_100

    .line 19146
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "deletePackageAsUser: pkg="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " user="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, " deleteAllUsers: "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    const-string v1, " version="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 19148
    const-wide/16 v1, -0x1

    cmp-long v1, v9, v1

    if-nez v1, :cond_f0

    .line 19149
    const-string v1, "VERSION_CODE_HIGHEST"

    goto :goto_f4

    :cond_f0
    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v1

    :goto_f4
    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 19146
    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 19152
    :cond_100
    invoke-direct/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getInstallerSettings()I

    move-result v0

    if-ne v0, v3, :cond_1e1

    .line 19154
    :try_start_106
    invoke-virtual {v14, v8}, Lcom/android/server/pm/PackageManagerService;->getNameForUid(I)Ljava/lang/String;

    move-result-object v0

    move-object v1, v0

    .line 19155
    .local v1, "callerUninstallPkg":Ljava/lang/String;
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mRequiredUninstallerPackage:Ljava/lang/String;

    invoke-static {v1, v0}, Landroid/text/TextUtils;->equals(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Z

    move-result v0

    if-nez v0, :cond_1da

    .line 19156
    new-instance v0, Ljava/util/HashMap;

    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V

    move-object v2, v0

    .line 19157
    .local v2, "properties":Ljava/util/HashMap;, "Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/String;>;"
    const-string v0, "callerPkg"

    invoke-virtual {v2, v0, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 19158
    const-string v0, "calleeUninstallPkg"

    invoke-virtual {v2, v0, v11}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 19159
    const-string/jumbo v0, "realCallerUid"

    invoke-static {v8}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v0, v3}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 19160
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v0
    :try_end_131
    .catch Ljava/lang/Exception; {:try_start_106 .. :try_end_131} :catch_1dd

    move-object v3, v0

    .line 19161
    .local v3, "am":Landroid/app/IActivityManager;
    if-eqz v3, :cond_1b3

    .line 19163
    :try_start_134
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v0

    .line 19164
    .local v0, "callUninstallPid":I
    invoke-interface {v3}, Landroid/app/IActivityManager;->getRunningAppProcesses()Ljava/util/List;

    move-result-object v4

    invoke-interface {v4}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_140
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v19

    if-eqz v19, :cond_1a3

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Landroid/app/ActivityManager$RunningAppProcessInfo;
    :try_end_14c
    .catch Landroid/os/RemoteException; {:try_start_134 .. :try_end_14c} :catch_1aa
    .catch Ljava/lang/Exception; {:try_start_134 .. :try_end_14c} :catch_1dd

    move-object/from16 v20, v19

    .line 19165
    .local v20, "appProcess":Landroid/app/ActivityManager$RunningAppProcessInfo;
    move-object/from16 v19, v1

    move-object/from16 v1, v20

    move-object/from16 v20, v3

    .end local v3  # "am":Landroid/app/IActivityManager;
    .local v1, "appProcess":Landroid/app/ActivityManager$RunningAppProcessInfo;
    .local v19, "callerUninstallPkg":Ljava/lang/String;
    .local v20, "am":Landroid/app/IActivityManager;
    :try_start_154
    iget v3, v1, Landroid/app/ActivityManager$RunningAppProcessInfo;->pid:I

    if-ne v3, v0, :cond_198

    .line 19166
    iget-object v3, v1, Landroid/app/ActivityManager$RunningAppProcessInfo;->processName:Ljava/lang/String;

    .line 19167
    .local v3, "realCallerProcessName":Ljava/lang/String;
    const-string/jumbo v4, "realCallerProcessName"

    invoke-virtual {v2, v4, v3}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 19168
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    .line 19169
    .local v4, "realCallerPkg2":Ljava/lang/StringBuilder;
    const/16 v18, 0x0

    move/from16 v21, v0

    move/from16 v0, v18

    .local v0, "i":I
    .local v21, "callUninstallPid":I
    :goto_16b
    move-object/from16 v22, v3

    .end local v3  # "realCallerProcessName":Ljava/lang/String;
    .local v22, "realCallerProcessName":Ljava/lang/String;
    iget-object v3, v1, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    array-length v3, v3

    if-ge v0, v3, :cond_18d

    .line 19170
    if-eqz v0, :cond_181

    .line 19171
    const-string v3, ","

    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v1, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    aget-object v3, v3, v0

    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_188

    .line 19173
    :cond_181
    iget-object v3, v1, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    aget-object v3, v3, v0

    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 19169
    :goto_188
    add-int/lit8 v0, v0, 0x1

    move-object/from16 v3, v22

    goto :goto_16b

    .line 19176
    .end local v0  # "i":I
    :cond_18d
    const-string/jumbo v0, "realCallerPkg2"

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v0, v3}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_197
    .catch Landroid/os/RemoteException; {:try_start_154 .. :try_end_197} :catch_1a1
    .catch Ljava/lang/Exception; {:try_start_154 .. :try_end_197} :catch_1dd

    .line 19177
    goto :goto_1a9

    .line 19165
    .end local v4  # "realCallerPkg2":Ljava/lang/StringBuilder;
    .end local v21  # "callUninstallPid":I
    .end local v22  # "realCallerProcessName":Ljava/lang/String;
    .local v0, "callUninstallPid":I
    :cond_198
    move/from16 v21, v0

    const/16 v18, 0x0

    .line 19179
    .end local v0  # "callUninstallPid":I
    .end local v1  # "appProcess":Landroid/app/ActivityManager$RunningAppProcessInfo;
    .restart local v21  # "callUninstallPid":I
    move-object/from16 v1, v19

    move-object/from16 v3, v20

    goto :goto_140

    .line 19180
    .end local v21  # "callUninstallPid":I
    :catch_1a1
    move-exception v0

    goto :goto_1af

    .line 19164
    .end local v19  # "callerUninstallPkg":Ljava/lang/String;
    .end local v20  # "am":Landroid/app/IActivityManager;
    .restart local v0  # "callUninstallPid":I
    .local v1, "callerUninstallPkg":Ljava/lang/String;
    .local v3, "am":Landroid/app/IActivityManager;
    :cond_1a3
    move/from16 v21, v0

    move-object/from16 v19, v1

    move-object/from16 v20, v3

    .line 19182
    .end local v0  # "callUninstallPid":I
    .end local v1  # "callerUninstallPkg":Ljava/lang/String;
    .end local v3  # "am":Landroid/app/IActivityManager;
    .restart local v19  # "callerUninstallPkg":Ljava/lang/String;
    .restart local v20  # "am":Landroid/app/IActivityManager;
    :goto_1a9
    goto :goto_1b7

    .line 19180
    .end local v19  # "callerUninstallPkg":Ljava/lang/String;
    .end local v20  # "am":Landroid/app/IActivityManager;
    .restart local v1  # "callerUninstallPkg":Ljava/lang/String;
    .restart local v3  # "am":Landroid/app/IActivityManager;
    :catch_1aa
    move-exception v0

    move-object/from16 v19, v1

    move-object/from16 v20, v3

    .line 19181
    .end local v1  # "callerUninstallPkg":Ljava/lang/String;
    .end local v3  # "am":Landroid/app/IActivityManager;
    .local v0, "e":Landroid/os/RemoteException;
    .restart local v19  # "callerUninstallPkg":Ljava/lang/String;
    .restart local v20  # "am":Landroid/app/IActivityManager;
    :goto_1af
    :try_start_1af
    invoke-virtual {v0}, Landroid/os/RemoteException;->printStackTrace()V

    goto :goto_1b7

    .line 19161
    .end local v0  # "e":Landroid/os/RemoteException;
    .end local v19  # "callerUninstallPkg":Ljava/lang/String;
    .end local v20  # "am":Landroid/app/IActivityManager;
    .restart local v1  # "callerUninstallPkg":Ljava/lang/String;
    .restart local v3  # "am":Landroid/app/IActivityManager;
    :cond_1b3
    move-object/from16 v19, v1

    move-object/from16 v20, v3

    .line 19184
    .end local v1  # "callerUninstallPkg":Ljava/lang/String;
    .end local v3  # "am":Landroid/app/IActivityManager;
    .restart local v19  # "callerUninstallPkg":Ljava/lang/String;
    .restart local v20  # "am":Landroid/app/IActivityManager;
    :goto_1b7
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-static {v0}, Landroid/nonvccUsageStats/UsageStatsNonVccProxy3;->getInstance(Landroid/content/Context;)Landroid/nonvccUsageStats/UsageStatsNonVccProxy3;

    move-result-object v0

    const-string v1, "PkgSilentDelete"

    .line 19185
    const/4 v3, 0x0

    invoke-virtual {v0, v1, v3, v2}, Landroid/nonvccUsageStats/UsageStatsNonVccProxy3;->onOsEvent(Ljava/lang/String;Ljava/lang/String;Ljava/util/Map;)V

    .line 19186
    const-string v0, "PackageManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "delete package "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_1d9
    .catch Ljava/lang/Exception; {:try_start_1af .. :try_end_1d9} :catch_1dd

    goto :goto_1dc

    .line 19155
    .end local v2  # "properties":Ljava/util/HashMap;, "Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/String;>;"
    .end local v19  # "callerUninstallPkg":Ljava/lang/String;
    .end local v20  # "am":Landroid/app/IActivityManager;
    .restart local v1  # "callerUninstallPkg":Ljava/lang/String;
    :cond_1da
    move-object/from16 v19, v1

    .line 19190
    .end local v1  # "callerUninstallPkg":Ljava/lang/String;
    :goto_1dc
    goto :goto_1e1

    .line 19188
    :catch_1dd
    move-exception v0

    .line 19189
    .local v0, "ex":Ljava/lang/Exception;
    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V

    .line 19194
    .end local v0  # "ex":Ljava/lang/Exception;
    :cond_1e1
    :goto_1e1
    iget-object v0, v14, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v4, Lcom/android/server/pm/-$$Lambda$PackageManagerService$_6B9au9z1U04Ew3TKUI7EAfYytI;

    move-object v1, v4

    move-object/from16 v2, p0

    move-object v3, v7

    move-object v14, v4

    move v4, v12

    move-object/from16 v17, v5

    .end local v5  # "users":[I
    .local v17, "users":[I
    move/from16 v5, v16

    move/from16 v18, v6

    .end local v6  # "deleteAllUsers":Z
    .local v18, "deleteAllUsers":Z
    move-object/from16 v19, v7

    move/from16 v20, v8

    .end local v7  # "internalPackageName":Ljava/lang/String;
    .end local v8  # "uid":I
    .local v19, "internalPackageName":Ljava/lang/String;
    .local v20, "uid":I
    move-wide v7, v9

    move-wide/from16 v21, v9

    .end local v9  # "versionCode":J
    .local v21, "versionCode":J
    move/from16 v9, p3

    move/from16 v10, p4

    move-object/from16 v23, v11

    .end local v11  # "packageName":Ljava/lang/String;
    .local v23, "packageName":Ljava/lang/String;
    move-object/from16 v11, v17

    move/from16 v24, v12

    .end local v12  # "callingUid":I
    .local v24, "callingUid":I
    move-object/from16 v12, p2

    move-object/from16 v13, v23

    invoke-direct/range {v1 .. v13}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$_6B9au9z1U04Ew3TKUI7EAfYytI;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;IZZJII[ILandroid/content/pm/IPackageDeleteObserver2;Ljava/lang/String;)V

    invoke-virtual {v0, v14}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 19242
    return-void

    .line 19094
    .end local v17  # "users":[I
    .end local v18  # "deleteAllUsers":Z
    .end local v19  # "internalPackageName":Ljava/lang/String;
    .end local v20  # "uid":I
    .end local v21  # "versionCode":J
    .end local v23  # "packageName":Ljava/lang/String;
    .end local v24  # "callingUid":I
    .restart local v9  # "versionCode":J
    .restart local v11  # "packageName":Ljava/lang/String;
    .restart local v12  # "callingUid":I
    :catchall_20d
    move-exception v0

    move-wide/from16 v21, v9

    move-object/from16 v23, v11

    move/from16 v24, v12

    .end local v9  # "versionCode":J
    .end local v11  # "packageName":Ljava/lang/String;
    .end local v12  # "callingUid":I
    .restart local v21  # "versionCode":J
    .restart local v23  # "packageName":Ljava/lang/String;
    .restart local v24  # "callingUid":I
    :goto_214
    :try_start_214
    monitor-exit v2
    :try_end_215
    .catchall {:try_start_214 .. :try_end_215} :catchall_216

    throw v0

    :catchall_216
    move-exception v0

    goto :goto_214
.end method

.method deletePackageX(Ljava/lang/String;JII)I
    .registers 34
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "versionCode"  # J
    .param p4, "userId"  # I
    .param p5, "deleteFlags"  # I

    .line 19454
    move-object/from16 v10, p0

    move-object/from16 v11, p1

    move-wide/from16 v12, p2

    move/from16 v14, p4

    move/from16 v15, p5

    new-instance v0, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    invoke-direct {v0, v10}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;-><init>(Lcom/android/server/pm/PackageSender;)V

    move-object v9, v0

    .line 19457
    .local v9, "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    and-int/lit8 v0, v15, 0x2

    const/4 v8, -0x1

    if-eqz v0, :cond_17

    .line 19458
    move v0, v8

    goto :goto_18

    :cond_17
    move v0, v14

    :goto_18
    move v7, v0

    .line 19460
    .local v7, "removeUser":I
    invoke-direct {v10, v11, v7}, Lcom/android/server/pm/PackageManagerService;->isPackageDeviceAdmin(Ljava/lang/String;I)Z

    move-result v0

    if-eqz v0, :cond_3c

    .line 19461
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Not removing package "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, ": has active device admin"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 19462
    const/4 v0, -0x2

    return v0

    .line 19474
    :cond_3c
    iget-object v1, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 19475
    :try_start_3f
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v11}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;
    :try_end_49
    .catchall {:try_start_3f .. :try_end_49} :catchall_341

    move-object v6, v0

    .line 19476
    .local v6, "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    if-nez v6, :cond_6a

    .line 19477
    :try_start_4c
    const-string v0, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Not removing non-existent package "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 19478
    monitor-exit v1

    return v8

    .line 19521
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    :catchall_64
    move-exception v0

    move/from16 v16, v7

    move-object v12, v9

    goto/16 :goto_345

    .line 19481
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    :cond_6a
    const-wide/16 v2, -0x1

    cmp-long v0, v12, v2

    if-eqz v0, :cond_a0

    iget-wide v2, v6, Lcom/android/server/pm/PackageSetting;->versionCode:J

    cmp-long v0, v2, v12

    if-eqz v0, :cond_a0

    .line 19483
    const-string v0, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Not removing package "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " with versionCode "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v3, v6, Lcom/android/server/pm/PackageSetting;->versionCode:J

    invoke-virtual {v2, v3, v4}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v3, " != "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v12, v13}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 19485
    monitor-exit v1
    :try_end_9f
    .catchall {:try_start_4c .. :try_end_9f} :catchall_64

    return v8

    .line 19488
    :cond_a0
    :try_start_a0
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v11}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v0

    move-object v5, v0

    .line 19491
    .local v5, "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    nop

    .line 19492
    invoke-virtual {v6, v14}, Lcom/android/server/pm/PackageSetting;->getEnabled(I)I

    move-result v0

    move v4, v0

    .line 19495
    .local v4, "origEnabledState":I
    iget-object v0, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v11}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/PackageParser$Package;

    move-object v3, v0

    .line 19497
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0
    :try_end_bc
    .catchall {:try_start_a0 .. :try_end_bc} :catchall_341

    move-object v2, v0

    .line 19499
    .local v2, "allUsers":[I
    if-eqz v3, :cond_157

    :try_start_bf
    iget-object v0, v3, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-eqz v0, :cond_157

    .line 19500
    iget-object v0, v3, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;
    :try_end_c5
    .catchall {:try_start_bf .. :try_end_c5} :catchall_151

    move-object/from16 v16, v9

    .end local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .local v16, "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :try_start_c7
    iget-wide v8, v3, Landroid/content/pm/PackageParser$Package;->staticSharedLibVersion:J

    invoke-direct {v10, v0, v8, v9}, Lcom/android/server/pm/PackageManagerService;->getSharedLibraryInfoLPr(Ljava/lang/String;J)Landroid/content/pm/SharedLibraryInfo;

    move-result-object v0

    .line 19502
    .local v0, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    if-eqz v0, :cond_145

    .line 19503
    array-length v8, v2

    const/4 v9, 0x0

    :goto_d1
    if-ge v9, v8, :cond_140

    aget v18, v2, v9

    move/from16 v19, v18

    .line 19504
    .local v19, "currUserId":I
    move/from16 v18, v4

    const/4 v4, -0x1

    .end local v4  # "origEnabledState":I
    .local v18, "origEnabledState":I
    if-eq v7, v4, :cond_e3

    move/from16 v4, v19

    .end local v19  # "currUserId":I
    .local v4, "currUserId":I
    if-eq v7, v4, :cond_e5

    .line 19505
    move-object/from16 v19, v5

    goto :goto_137

    .line 19504
    .end local v4  # "currUserId":I
    .restart local v19  # "currUserId":I
    :cond_e3
    move/from16 v4, v19

    .line 19507
    .end local v19  # "currUserId":I
    .restart local v4  # "currUserId":I
    :cond_e5
    move-object/from16 v19, v5

    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .local v19, "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    const v5, 0x402000

    invoke-direct {v10, v0, v5, v4}, Lcom/android/server/pm/PackageManagerService;->getPackagesUsingSharedLibraryLPr(Landroid/content/pm/SharedLibraryInfo;II)Ljava/util/List;

    move-result-object v5

    .line 19509
    .local v5, "libClientPackages":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    invoke-static {v5}, Lcom/android/internal/util/ArrayUtils;->isEmpty(Ljava/util/Collection;)Z

    move-result v20

    if-nez v20, :cond_137

    .line 19510
    const-string v8, "PackageManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Not removing package "

    invoke-virtual {v9, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v12, v3, Landroid/content/pm/PackageParser$Package;->manifestPackageName:Ljava/lang/String;

    invoke-virtual {v9, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, " hosting lib "

    invoke-virtual {v9, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 19511
    invoke-virtual {v0}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v12

    invoke-virtual {v9, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v12, " version "

    invoke-virtual {v9, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 19512
    invoke-virtual {v0}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v12

    invoke-virtual {v9, v12, v13}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v12, " used by "

    invoke-virtual {v9, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v12, " for user "

    invoke-virtual {v9, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v9, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    .line 19510
    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 19514
    const/4 v8, -0x6

    monitor-exit v1
    :try_end_136
    .catchall {:try_start_c7 .. :try_end_136} :catchall_14a

    return v8

    .line 19503
    .end local v4  # "currUserId":I
    .end local v5  # "libClientPackages":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/VersionedPackage;>;"
    :cond_137
    :goto_137
    add-int/lit8 v9, v9, 0x1

    move-wide/from16 v12, p2

    move/from16 v4, v18

    move-object/from16 v5, v19

    goto :goto_d1

    .end local v18  # "origEnabledState":I
    .end local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .local v4, "origEnabledState":I
    .local v5, "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    :cond_140
    move/from16 v18, v4

    move-object/from16 v19, v5

    .end local v4  # "origEnabledState":I
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v18  # "origEnabledState":I
    .restart local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    goto :goto_15d

    .line 19502
    .end local v18  # "origEnabledState":I
    .end local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "origEnabledState":I
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    :cond_145
    move/from16 v18, v4

    move-object/from16 v19, v5

    .end local v4  # "origEnabledState":I
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v18  # "origEnabledState":I
    .restart local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    goto :goto_15d

    .line 19521
    .end local v0  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v2  # "allUsers":[I
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .end local v18  # "origEnabledState":I
    .end local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    :catchall_14a
    move-exception v0

    move-object/from16 v12, v16

    move/from16 v16, v7

    goto/16 :goto_345

    .end local v16  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :catchall_151
    move-exception v0

    move/from16 v16, v7

    move-object v12, v9

    .end local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v16  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    goto/16 :goto_345

    .line 19499
    .end local v16  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v2  # "allUsers":[I
    .restart local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v4  # "origEnabledState":I
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :cond_157
    move/from16 v18, v4

    move-object/from16 v19, v5

    move-object/from16 v16, v9

    .line 19520
    .end local v4  # "origEnabledState":I
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v16  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v18  # "origEnabledState":I
    .restart local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    :goto_15d
    const/4 v0, 0x1

    :try_start_15e
    invoke-virtual {v6, v2, v0}, Lcom/android/server/pm/PackageSetting;->queryInstalledUsers([IZ)[I

    move-result-object v4
    :try_end_162
    .catchall {:try_start_15e .. :try_end_162} :catchall_33b

    move-object/from16 v9, v16

    .end local v16  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :try_start_164
    iput-object v4, v9, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->origUsers:[I

    .line 19521
    monitor-exit v1
    :try_end_167
    .catchall {:try_start_164 .. :try_end_167} :catchall_341

    .line 19524
    invoke-static {v6}, Lcom/android/server/pm/PackageManagerService;->isUpdatedSystemApp(Lcom/android/server/pm/PackageSetting;)Z

    move-result v1

    if-eqz v1, :cond_174

    and-int/lit8 v1, v15, 0x4

    if-nez v1, :cond_174

    .line 19528
    const/4 v1, -0x1

    move v12, v1

    .local v1, "freezeUser":I
    goto :goto_176

    .line 19530
    .end local v1  # "freezeUser":I
    :cond_174
    move v1, v7

    move v12, v1

    .line 19533
    .local v12, "freezeUser":I
    :goto_176
    iget-object v13, v10, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v13

    .line 19534
    :try_start_179
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_REMOVE:Z
    :try_end_17b
    .catchall {:try_start_179 .. :try_end_17b} :catchall_32a

    if-eqz v1, :cond_1ab

    :try_start_17d
    const-string v1, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "deletePackageX: pkg="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " user="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v1, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_19b
    .catchall {:try_start_17d .. :try_end_19b} :catchall_19c

    goto :goto_1ab

    .line 19549
    :catchall_19c
    move-exception v0

    move-object/from16 v22, v2

    move-object v4, v3

    move/from16 v16, v7

    move/from16 v2, v18

    move-object/from16 v5, v19

    move/from16 v18, v12

    move-object v12, v9

    goto/16 :goto_337

    .line 19535
    :cond_1ab
    :goto_1ab
    :try_start_1ab
    const-string v1, "deletePackageX"

    invoke-virtual {v10, v11, v12, v15, v1}, Lcom/android/server/pm/PackageManagerService;->freezePackageForDelete(Ljava/lang/String;IILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v1
    :try_end_1b1
    .catchall {:try_start_1ab .. :try_end_1b1} :catchall_32a

    move-object v8, v1

    .line 19537
    .local v8, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :try_start_1b2
    invoke-static {v7}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;

    move-result-object v4
    :try_end_1b6
    .catchall {:try_start_1b2 .. :try_end_1b6} :catchall_312

    const/4 v5, 0x1

    const/high16 v1, -0x80000000

    or-int v16, v15, v1

    const/16 v20, 0x1

    const/16 v21, 0x0

    move-object/from16 v1, p0

    move-object/from16 v22, v2

    .end local v2  # "allUsers":[I
    .local v22, "allUsers":[I
    move-object/from16 v2, p1

    move-object/from16 v23, v3

    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v23, "pkg":Landroid/content/pm/PackageParser$Package;
    move-object v3, v4

    move/from16 v24, v18

    const/16 v17, -0x1

    .end local v18  # "origEnabledState":I
    .local v24, "origEnabledState":I
    move v4, v5

    move-object/from16 v25, v19

    .end local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .local v25, "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v5, v22

    move-object/from16 v26, v6

    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .local v26, "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    move/from16 v6, v16

    move/from16 v16, v7

    .end local v7  # "removeUser":I
    .local v16, "removeUser":I
    move-object v7, v9

    move-object/from16 v27, v8

    .end local v8  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .local v27, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    move/from16 v8, v20

    move/from16 v18, v12

    move-object v12, v9

    .end local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .local v12, "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .local v18, "freezeUser":I
    move-object/from16 v9, v21

    :try_start_1e1
    invoke-direct/range {v1 .. v9}, Lcom/android/server/pm/PackageManagerService;->deletePackageLIF(Ljava/lang/String;Landroid/os/UserHandle;Z[IILcom/android/server/pm/PackageManagerService$PackageRemovedInfo;ZLandroid/content/pm/PackageParser$Package;)Z

    move-result v1
    :try_end_1e5
    .catchall {:try_start_1e1 .. :try_end_1e5} :catchall_305

    .line 19539
    .local v1, "res":Z
    const/4 v2, 0x0

    move-object/from16 v3, v27

    .end local v27  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .local v3, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    if-eqz v3, :cond_1f9

    :try_start_1ea
    invoke-static {v2, v3}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V
    :try_end_1ed
    .catchall {:try_start_1ea .. :try_end_1ed} :catchall_1ee

    goto :goto_1f9

    .line 19549
    .end local v1  # "res":Z
    .end local v3  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :catchall_1ee
    move-exception v0

    move-object/from16 v4, v23

    move/from16 v2, v24

    move-object/from16 v5, v25

    move-object/from16 v6, v26

    goto/16 :goto_337

    .line 19540
    .restart local v1  # "res":Z
    :cond_1f9
    :goto_1f9
    :try_start_1f9
    iget-object v3, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3
    :try_end_1fc
    .catchall {:try_start_1f9 .. :try_end_1fc} :catchall_2fb

    .line 19541
    if-eqz v1, :cond_22e

    .line 19542
    move-object/from16 v4, v23

    .end local v23  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v4, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v4, :cond_213

    .line 19543
    :try_start_202
    iget-object v5, v10, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    iget-object v6, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedUsers:[I

    invoke-virtual {v5, v4, v6}, Lcom/android/server/pm/InstantAppRegistry;->onPackageUninstalledLPw(Landroid/content/pm/PackageParser$Package;[I)V
    :try_end_209
    .catchall {:try_start_202 .. :try_end_209} :catchall_20a

    goto :goto_213

    .line 19548
    :catchall_20a
    move-exception v0

    move/from16 v2, v24

    move-object/from16 v5, v25

    move-object/from16 v6, v26

    goto/16 :goto_2f7

    .line 19545
    :cond_213
    :goto_213
    :try_start_213
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedUsers:[I
    :try_end_215
    .catchall {:try_start_213 .. :try_end_215} :catchall_225

    move-object/from16 v6, v26

    .end local v26  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    :try_start_217
    invoke-direct {v10, v6, v5}, Lcom/android/server/pm/PackageManagerService;->updateSequenceNumberLP(Lcom/android/server/pm/PackageSetting;[I)V

    .line 19546
    invoke-direct/range {p0 .. p1}, Lcom/android/server/pm/PackageManagerService;->updateInstantAppInstallerLocked(Ljava/lang/String;)V
    :try_end_21d
    .catchall {:try_start_217 .. :try_end_21d} :catchall_21e

    goto :goto_232

    .line 19548
    :catchall_21e
    move-exception v0

    move/from16 v2, v24

    move-object/from16 v5, v25

    goto/16 :goto_2f7

    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v26  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    :catchall_225
    move-exception v0

    move-object/from16 v6, v26

    move/from16 v2, v24

    move-object/from16 v5, v25

    .end local v26  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    goto/16 :goto_2f7

    .line 19541
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v23  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v26  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    :cond_22e
    move-object/from16 v4, v23

    move-object/from16 v6, v26

    .line 19548
    .end local v23  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v26  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    :goto_232
    :try_start_232
    monitor-exit v3
    :try_end_233
    .catchall {:try_start_232 .. :try_end_233} :catchall_2f2

    .line 19549
    :try_start_233
    monitor-exit v13
    :try_end_234
    .catchall {:try_start_233 .. :try_end_234} :catchall_2ec

    .line 19551
    if-eqz v1, :cond_246

    .line 19552
    and-int/lit8 v3, v15, 0x8

    if-nez v3, :cond_23c

    move v3, v0

    goto :goto_23d

    :cond_23c
    const/4 v3, 0x0

    .line 19553
    .local v3, "killApp":Z
    :goto_23d
    invoke-virtual {v12, v3}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->sendPackageRemovedBroadcasts(Z)V

    .line 19554
    invoke-virtual {v12}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->sendSystemPackageUpdatedBroadcasts()V

    .line 19555
    invoke-virtual {v12}, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->sendSystemPackageAppearedBroadcasts()V

    .line 19558
    .end local v3  # "killApp":Z
    :cond_246
    invoke-static {}, Ljava/lang/Runtime;->getRuntime()Ljava/lang/Runtime;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Runtime;->gc()V

    .line 19561
    iget-object v3, v10, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v3

    .line 19562
    :try_start_250
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;
    :try_end_252
    .catchall {:try_start_250 .. :try_end_252} :catchall_2e3

    if-eqz v5, :cond_261

    .line 19563
    :try_start_254
    iget-object v5, v12, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    invoke-virtual {v5, v0}, Lcom/android/server/pm/PackageManagerService$InstallArgs;->doPostDeleteLI(Z)Z
    :try_end_259
    .catchall {:try_start_254 .. :try_end_259} :catchall_25a

    goto :goto_261

    .line 19585
    :catchall_25a
    move-exception v0

    move/from16 v13, v24

    move-object/from16 v5, v25

    goto/16 :goto_2e8

    .line 19566
    :cond_261
    :goto_261
    move-object/from16 v5, v25

    .end local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    if-nez v5, :cond_266

    goto :goto_268

    :cond_266
    :try_start_266
    iget-object v2, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 19567
    .local v2, "stubPkg":Landroid/content/pm/PackageParser$Package;
    :goto_268
    if-eqz v2, :cond_2b5

    iget-boolean v7, v2, Landroid/content/pm/PackageParser$Package;->isStub:Z

    if-eqz v7, :cond_2b5

    .line 19568
    iget-object v7, v10, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v7
    :try_end_271
    .catchall {:try_start_266 .. :try_end_271} :catchall_2df

    .line 19571
    :try_start_271
    iget-object v8, v10, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v8, v8, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v9, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/pm/PackageSetting;

    .line 19572
    .local v8, "stubPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v8, :cond_287

    .line 19573
    const-string v9, "android"
    :try_end_281
    .catchall {:try_start_271 .. :try_end_281} :catchall_2ae

    move/from16 v13, v24

    .end local v24  # "origEnabledState":I
    .local v13, "origEnabledState":I
    :try_start_283
    invoke-virtual {v8, v13, v14, v9}, Lcom/android/server/pm/PackageSetting;->setEnabled(IILjava/lang/String;)V

    goto :goto_289

    .line 19572
    .end local v13  # "origEnabledState":I
    .restart local v24  # "origEnabledState":I
    :cond_287
    move/from16 v13, v24

    .line 19575
    .end local v8  # "stubPs":Lcom/android/server/pm/PackageSetting;
    .end local v24  # "origEnabledState":I
    .restart local v13  # "origEnabledState":I
    :goto_289
    monitor-exit v7
    :try_end_28a
    .catchall {:try_start_283 .. :try_end_28a} :catchall_2b3

    .line 19576
    if-eqz v13, :cond_28e

    if-ne v13, v0, :cond_2b7

    .line 19578
    :cond_28e
    :try_start_28e
    sget-boolean v7, Lcom/android/server/pm/PackageManagerService;->DEBUG_COMPRESSION:Z

    if-eqz v7, :cond_2aa

    .line 19579
    const-string v7, "PackageManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Enabling system stub after removal; pkg: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 19582
    :cond_2aa
    invoke-direct {v10, v2}, Lcom/android/server/pm/PackageManagerService;->enableCompressedPackage(Landroid/content/pm/PackageParser$Package;)Z
    :try_end_2ad
    .catchall {:try_start_28e .. :try_end_2ad} :catchall_2ea

    goto :goto_2b7

    .line 19575
    .end local v13  # "origEnabledState":I
    .restart local v24  # "origEnabledState":I
    :catchall_2ae
    move-exception v0

    move/from16 v13, v24

    .end local v24  # "origEnabledState":I
    .restart local v13  # "origEnabledState":I
    :goto_2b1
    :try_start_2b1
    monitor-exit v7
    :try_end_2b2
    .catchall {:try_start_2b1 .. :try_end_2b2} :catchall_2b3

    .end local v1  # "res":Z
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v13  # "origEnabledState":I
    .end local v16  # "removeUser":I
    .end local v18  # "freezeUser":I
    .end local v22  # "allUsers":[I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "versionCode":J
    .end local p4  # "userId":I
    .end local p5  # "deleteFlags":I
    :try_start_2b2
    throw v0

    .restart local v1  # "res":Z
    .restart local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v12  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v13  # "origEnabledState":I
    .restart local v16  # "removeUser":I
    .restart local v18  # "freezeUser":I
    .restart local v22  # "allUsers":[I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "versionCode":J
    .restart local p4  # "userId":I
    .restart local p5  # "deleteFlags":I
    :catchall_2b3
    move-exception v0

    goto :goto_2b1

    .line 19567
    .end local v13  # "origEnabledState":I
    .restart local v24  # "origEnabledState":I
    :cond_2b5
    move/from16 v13, v24

    .line 19585
    .end local v2  # "stubPkg":Landroid/content/pm/PackageParser$Package;
    .end local v24  # "origEnabledState":I
    .restart local v13  # "origEnabledState":I
    :cond_2b7
    :goto_2b7
    monitor-exit v3
    :try_end_2b8
    .catchall {:try_start_2b2 .. :try_end_2b8} :catchall_2ea

    .line 19587
    if-eqz v1, :cond_2c0

    if-eqz v11, :cond_2c0

    .line 19588
    const/4 v2, 0x7

    invoke-direct {v10, v2, v11, v14}, Lcom/android/server/pm/PackageManagerService;->acquireUxPerfLock(ILjava/lang/String;I)V

    .line 19592
    :cond_2c0
    if-eqz v1, :cond_2d9

    .line 19593
    const-string v2, "com.google.android.installpackageswhitelist.gts"

    invoke-virtual {v2, v11}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_2ce

    .line 19594
    const/4 v2, 0x0

    iput-boolean v2, v10, Lcom/android/server/pm/PackageManagerService;->runningGtsInstall:Z

    goto :goto_2cf

    .line 19593
    :cond_2ce
    const/4 v2, 0x0

    .line 19596
    :goto_2cf
    const-string v3, "com.google.android.permission.gts"

    invoke-virtual {v3, v11}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_2d9

    .line 19597
    iput-boolean v2, v10, Lcom/android/server/pm/PackageManagerService;->runningGtsPermission:Z

    .line 19601
    :cond_2d9
    if-eqz v1, :cond_2dc

    goto :goto_2de

    :cond_2dc
    move/from16 v0, v17

    :goto_2de
    return v0

    .line 19585
    .end local v13  # "origEnabledState":I
    .restart local v24  # "origEnabledState":I
    :catchall_2df
    move-exception v0

    move/from16 v13, v24

    .end local v24  # "origEnabledState":I
    .restart local v13  # "origEnabledState":I
    goto :goto_2e8

    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "origEnabledState":I
    .restart local v24  # "origEnabledState":I
    .restart local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    :catchall_2e3
    move-exception v0

    move/from16 v13, v24

    move-object/from16 v5, v25

    .end local v24  # "origEnabledState":I
    .end local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v13  # "origEnabledState":I
    :goto_2e8
    :try_start_2e8
    monitor-exit v3
    :try_end_2e9
    .catchall {:try_start_2e8 .. :try_end_2e9} :catchall_2ea

    throw v0

    :catchall_2ea
    move-exception v0

    goto :goto_2e8

    .line 19549
    .end local v1  # "res":Z
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "origEnabledState":I
    .restart local v24  # "origEnabledState":I
    .restart local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    :catchall_2ec
    move-exception v0

    move/from16 v2, v24

    move-object/from16 v5, v25

    .end local v24  # "origEnabledState":I
    .end local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .local v2, "origEnabledState":I
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    goto :goto_337

    .line 19548
    .end local v2  # "origEnabledState":I
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v1  # "res":Z
    .restart local v24  # "origEnabledState":I
    .restart local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    :catchall_2f2
    move-exception v0

    move/from16 v2, v24

    move-object/from16 v5, v25

    .end local v24  # "origEnabledState":I
    .end local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v2  # "origEnabledState":I
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    :goto_2f7
    :try_start_2f7
    monitor-exit v3
    :try_end_2f8
    .catchall {:try_start_2f7 .. :try_end_2f8} :catchall_2f9

    .end local v2  # "origEnabledState":I
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v16  # "removeUser":I
    .end local v18  # "freezeUser":I
    .end local v22  # "allUsers":[I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "versionCode":J
    .end local p4  # "userId":I
    .end local p5  # "deleteFlags":I
    :try_start_2f8
    throw v0
    :try_end_2f9
    .catchall {:try_start_2f8 .. :try_end_2f9} :catchall_339

    .restart local v2  # "origEnabledState":I
    .restart local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v12  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v16  # "removeUser":I
    .restart local v18  # "freezeUser":I
    .restart local v22  # "allUsers":[I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "versionCode":J
    .restart local p4  # "userId":I
    .restart local p5  # "deleteFlags":I
    :catchall_2f9
    move-exception v0

    goto :goto_2f7

    .line 19549
    .end local v1  # "res":Z
    .end local v2  # "origEnabledState":I
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v23  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v24  # "origEnabledState":I
    .restart local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v26  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    :catchall_2fb
    move-exception v0

    move-object/from16 v4, v23

    move/from16 v2, v24

    move-object/from16 v5, v25

    move-object/from16 v6, v26

    .end local v23  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v24  # "origEnabledState":I
    .end local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v26  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v2  # "origEnabledState":I
    .restart local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    goto :goto_337

    .line 19535
    .end local v2  # "origEnabledState":I
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v23  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v24  # "origEnabledState":I
    .restart local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v26  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v27  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    :catchall_305
    move-exception v0

    move-object/from16 v4, v23

    move/from16 v2, v24

    move-object/from16 v5, v25

    move-object/from16 v6, v26

    move-object/from16 v3, v27

    move-object v1, v0

    .end local v23  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v24  # "origEnabledState":I
    .end local v25  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v26  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .end local v27  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v2  # "origEnabledState":I
    .local v3, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    goto :goto_321

    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v16  # "removeUser":I
    .end local v22  # "allUsers":[I
    .local v2, "allUsers":[I
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v7  # "removeUser":I
    .local v8, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .local v12, "freezeUser":I
    .local v18, "origEnabledState":I
    .restart local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    :catchall_312
    move-exception v0

    move-object/from16 v22, v2

    move-object v4, v3

    move/from16 v16, v7

    move-object v3, v8

    move/from16 v2, v18

    move-object/from16 v5, v19

    move/from16 v18, v12

    move-object v12, v9

    move-object v1, v0

    .end local v2  # "allUsers":[I
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "removeUser":I
    .end local v8  # "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .end local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v12  # "freezeUser":I
    .end local v18  # "origEnabledState":I
    .end local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "versionCode":J
    .end local p4  # "userId":I
    .end local p5  # "deleteFlags":I
    :goto_321
    :try_start_321
    throw v1
    :try_end_322
    .catchall {:try_start_321 .. :try_end_322} :catchall_322

    .line 19539
    .local v2, "origEnabledState":I
    .local v3, "freezer":Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .restart local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .local v12, "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v16  # "removeUser":I
    .local v18, "freezeUser":I
    .restart local v22  # "allUsers":[I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "versionCode":J
    .restart local p4  # "userId":I
    .restart local p5  # "deleteFlags":I
    :catchall_322
    move-exception v0

    move-object v7, v0

    if-eqz v3, :cond_329

    :try_start_326
    invoke-static {v1, v3}, Lcom/android/server/pm/PackageManagerService;->$closeResource(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V

    .end local v2  # "origEnabledState":I
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v16  # "removeUser":I
    .end local v18  # "freezeUser":I
    .end local v22  # "allUsers":[I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "versionCode":J
    .end local p4  # "userId":I
    .end local p5  # "deleteFlags":I
    :cond_329
    throw v7

    .line 19549
    .local v2, "allUsers":[I
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .restart local v7  # "removeUser":I
    .restart local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .local v12, "freezeUser":I
    .local v18, "origEnabledState":I
    .restart local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "versionCode":J
    .restart local p4  # "userId":I
    .restart local p5  # "deleteFlags":I
    :catchall_32a
    move-exception v0

    move-object/from16 v22, v2

    move-object v4, v3

    move/from16 v16, v7

    move/from16 v2, v18

    move-object/from16 v5, v19

    move/from16 v18, v12

    move-object v12, v9

    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v7  # "removeUser":I
    .end local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v19  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .local v2, "origEnabledState":I
    .restart local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .local v12, "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v16  # "removeUser":I
    .local v18, "freezeUser":I
    .restart local v22  # "allUsers":[I
    :goto_337
    monitor-exit v13
    :try_end_338
    .catchall {:try_start_326 .. :try_end_338} :catchall_339

    throw v0

    :catchall_339
    move-exception v0

    goto :goto_337

    .line 19521
    .end local v2  # "origEnabledState":I
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "disabledSystemPs":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "uninstalledPs":Lcom/android/server/pm/PackageSetting;
    .end local v12  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v18  # "freezeUser":I
    .end local v22  # "allUsers":[I
    .restart local v7  # "removeUser":I
    .local v16, "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :catchall_33b
    move-exception v0

    move-object/from16 v12, v16

    move/from16 v16, v7

    .end local v7  # "removeUser":I
    .restart local v12  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .local v16, "removeUser":I
    goto :goto_345

    .end local v12  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .end local v16  # "removeUser":I
    .restart local v7  # "removeUser":I
    .restart local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    :catchall_341
    move-exception v0

    move/from16 v16, v7

    move-object v12, v9

    .end local v7  # "removeUser":I
    .end local v9  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v12  # "info":Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;
    .restart local v16  # "removeUser":I
    :goto_345
    :try_start_345
    monitor-exit v1
    :try_end_346
    .catchall {:try_start_345 .. :try_end_346} :catchall_347

    throw v0

    :catchall_347
    move-exception v0

    goto :goto_345
.end method

.method public deletePreloadsFileCache()V
    .registers 4

    .line 4986
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.CLEAR_APP_CACHE"

    const-string v2, "deletePreloadsFileCache"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 4988
    invoke-static {}, Landroid/os/Environment;->getDataPreloadsFileCacheDirectory()Ljava/io/File;

    move-result-object v0

    .line 4989
    .local v0, "dir":Ljava/io/File;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Deleting preloaded file cache "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4990
    invoke-static {v0}, Landroid/os/FileUtils;->deleteContents(Ljava/io/File;)Z

    .line 4991
    return-void
.end method

.method protected dump(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
    .registers 33
    .param p1, "fd"  # Ljava/io/FileDescriptor;
    .param p2, "pw"  # Ljava/io/PrintWriter;
    .param p3, "args"  # [Ljava/lang/String;

    .line 22777
    move-object/from16 v1, p0

    move-object/from16 v9, p2

    move-object/from16 v10, p3

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v2, "PackageManager"

    invoke-static {v0, v2, v9}, Lcom/android/internal/util/DumpUtils;->checkDumpAndUsageStatsPermission(Landroid/content/Context;Ljava/lang/String;Ljava/io/PrintWriter;)Z

    move-result v0

    if-nez v0, :cond_11

    return-void

    .line 22779
    :cond_11
    const-string/jumbo v0, "package"

    invoke-static {v0}, Lcom/android/server/utils/DebugOptions;->getInstance(Ljava/lang/String;)Lcom/android/server/utils/DebugOptions;

    move-result-object v0

    invoke-virtual {v0, v9, v10}, Lcom/android/server/utils/DebugOptions;->dumpOptions(Ljava/io/PrintWriter;[Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_1f

    .line 22780
    return-void

    .line 22782
    :cond_1f
    new-instance v0, Lcom/android/server/pm/DumpState;

    invoke-direct {v0}, Lcom/android/server/pm/DumpState;-><init>()V

    move-object v11, v0

    .line 22783
    .local v11, "dumpState":Lcom/android/server/pm/DumpState;
    const/4 v2, 0x0

    .line 22784
    .local v2, "fullPreferred":Z
    const/4 v0, 0x0

    .line 22786
    .local v0, "checkin":Z
    const/4 v3, 0x0

    .line 22787
    .local v3, "packageName":Ljava/lang/String;
    const/4 v4, 0x0

    .line 22789
    .local v4, "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    const/4 v5, 0x0

    move v12, v0

    .line 22790
    .end local v0  # "checkin":Z
    .local v5, "opti":I
    .local v12, "checkin":Z
    :goto_2b
    array-length v0, v10

    const/4 v6, 0x2

    const/4 v13, 0x0

    const/4 v14, 0x1

    if-ge v5, v0, :cond_13e

    .line 22791
    aget-object v0, v10, v5

    .line 22792
    .local v0, "opt":Ljava/lang/String;
    if-eqz v0, :cond_13e

    invoke-virtual {v0}, Ljava/lang/String;->length()I

    move-result v7

    if-lez v7, :cond_13e

    invoke-virtual {v0, v13}, Ljava/lang/String;->charAt(I)C

    move-result v7

    const/16 v8, 0x2d

    if-eq v7, v8, :cond_45

    .line 22793
    goto/16 :goto_13e

    .line 22795
    :cond_45
    add-int/lit8 v5, v5, 0x1

    .line 22797
    const-string v7, "-a"

    invoke-virtual {v7, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_51

    goto/16 :goto_13c

    .line 22799
    :cond_51
    const-string v7, "-h"

    invoke-virtual {v7, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_f5

    .line 22800
    const-string v6, "Package manager dump options:"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22801
    const-string v6, "  [-h] [-f] [--checkin] [--all-components] [cmd] ..."

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22802
    const-string v6, "    --checkin: dump for a checkin"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22803
    const-string v6, "    -f: print details of intent filters"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22804
    const-string v6, "    -h: print this help"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22805
    const-string v6, "    --all-components: include all component names in package dump"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22806
    const-string v6, "  cmd may be one of:"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22807
    const-string v6, "    apex: list active APEXes and APEX session state"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22808
    const-string v6, "    l[ibraries]: list known shared libraries"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22809
    const-string v6, "    f[eatures]: list device features"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22810
    const-string v6, "    k[eysets]: print known keysets"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22811
    const-string v6, "    r[esolvers] [activity|service|receiver|content]: dump intent resolvers"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22812
    const-string v6, "    perm[issions]: dump permissions"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22813
    const-string v6, "    permission [name ...]: dump declaration and use of given permission"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22814
    const-string v6, "    pref[erred]: print preferred package settings"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22815
    const-string v6, "    preferred-xml [--full]: print preferred package settings as xml"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22816
    const-string v6, "    prov[iders]: dump content providers"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22817
    const-string v6, "    p[ackages]: dump installed packages"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22818
    const-string v6, "    s[hared-users]: dump shared user IDs"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22819
    const-string v6, "    m[essages]: print collected runtime messages"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22820
    const-string v6, "    v[erifiers]: print package verifier info"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22821
    const-string v6, "    d[omain-preferred-apps]: print domains preferred apps"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22822
    const-string v6, "    i[ntent-filter-verifiers]|ifv: print intent filter verifier info"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22823
    const-string v6, "    version: print database version info"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22824
    const-string v6, "    write: write current settings now"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22825
    const-string v6, "    installs: details about install sessions"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22826
    const-string v6, "    check-permission <permission> <package> [<user>]: does pkg hold perm?"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22827
    const-string v6, "    dexopt: dump dexopt state"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22828
    const-string v6, "    compiler-stats: dump compiler statistics"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22829
    const-string v6, "    service-permissions: dump permissions required by services"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22830
    const-string v6, "    <package.name>: info about given package"

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22831
    return-void

    .line 22832
    :cond_f5
    const-string v7, "--checkin"

    invoke-virtual {v7, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_ff

    .line 22833
    const/4 v12, 0x1

    goto :goto_13c

    .line 22834
    :cond_ff
    const-string v7, "--all-components"

    invoke-virtual {v7, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_10b

    .line 22835
    invoke-virtual {v11, v6}, Lcom/android/server/pm/DumpState;->setOptionEnabled(I)V

    goto :goto_13c

    .line 22836
    :cond_10b
    const-string v6, "-f"

    invoke-virtual {v6, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_117

    .line 22837
    invoke-virtual {v11, v14}, Lcom/android/server/pm/DumpState;->setOptionEnabled(I)V

    goto :goto_13c

    .line 22838
    :cond_117
    const-string v6, "--proto"

    invoke-virtual {v6, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_123

    .line 22839
    invoke-direct/range {p0 .. p1}, Lcom/android/server/pm/PackageManagerService;->dumpProto(Ljava/io/FileDescriptor;)V

    .line 22840
    return-void

    .line 22842
    :cond_123
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unknown argument: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, "; use -h for help"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22844
    .end local v0  # "opt":Ljava/lang/String;
    :goto_13c
    goto/16 :goto_2b

    .line 22847
    :cond_13e
    :goto_13e
    array-length v0, v10

    const/high16 v6, 0x20000

    const/16 v15, 0x800

    const v7, 0x8000

    const/16 v13, 0x200

    if-ge v5, v0, :cond_4c1

    .line 22848
    aget-object v8, v10, v5

    .line 22849
    .local v8, "cmd":Ljava/lang/String;
    add-int/lit8 v5, v5, 0x1

    .line 22851
    const-string v0, "android"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_4b6

    const-string v0, "."

    invoke-virtual {v8, v0}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v0

    if-eqz v0, :cond_161

    move v13, v14

    goto/16 :goto_4b7

    .line 22856
    :cond_161
    const-string v0, "check-permission"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1ba

    .line 22857
    array-length v0, v10

    if-lt v5, v0, :cond_172

    .line 22858
    const-string v0, "Error: check-permission missing permission argument"

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22859
    return-void

    .line 22861
    :cond_172
    aget-object v6, v10, v5

    .line 22862
    .local v6, "perm":Ljava/lang/String;
    add-int/2addr v5, v14

    .line 22863
    array-length v0, v10

    if-lt v5, v0, :cond_17e

    .line 22864
    const-string v0, "Error: check-permission missing package argument"

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22865
    return-void

    .line 22868
    :cond_17e
    aget-object v7, v10, v5

    .line 22869
    .local v7, "pkg":Ljava/lang/String;
    add-int/2addr v5, v14

    .line 22870
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v13

    .line 22871
    .local v13, "user":I
    array-length v0, v10

    if-ge v5, v0, :cond_1ac

    .line 22873
    :try_start_18c
    aget-object v0, v10, v5

    invoke-static {v0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I

    move-result v0
    :try_end_192
    .catch Ljava/lang/NumberFormatException; {:try_start_18c .. :try_end_192} :catch_194

    move v13, v0

    .line 22878
    goto :goto_1ac

    .line 22874
    :catch_194
    move-exception v0

    .line 22875
    .local v0, "e":Ljava/lang/NumberFormatException;
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Error: check-permission user argument is not a number: "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    aget-object v15, v10, v5

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    invoke-virtual {v9, v14}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22877
    return-void

    .line 22882
    .end local v0  # "e":Ljava/lang/NumberFormatException;
    :cond_1ac
    :goto_1ac
    const-wide/16 v14, -0x1

    invoke-direct {v1, v7, v14, v15}, Lcom/android/server/pm/PackageManagerService;->resolveInternalPackageNameLPr(Ljava/lang/String;J)Ljava/lang/String;

    move-result-object v0

    .line 22884
    .end local v7  # "pkg":Ljava/lang/String;
    .local v0, "pkg":Ljava/lang/String;
    invoke-virtual {v1, v6, v0, v13}, Lcom/android/server/pm/PackageManagerService;->checkPermission(Ljava/lang/String;Ljava/lang/String;I)I

    move-result v7

    invoke-virtual {v9, v7}, Ljava/io/PrintWriter;->println(I)V

    .line 22885
    return-void

    .line 22886
    .end local v0  # "pkg":Ljava/lang/String;
    .end local v6  # "perm":Ljava/lang/String;
    .end local v13  # "user":I
    :cond_1ba
    const-string/jumbo v0, "l"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_4ac

    const-string/jumbo v0, "libraries"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1ce

    goto/16 :goto_4ac

    .line 22888
    :cond_1ce
    const-string v0, "f"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_4a6

    const-string v0, "features"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1e0

    goto/16 :goto_4a6

    .line 22890
    :cond_1e0
    const-string/jumbo v0, "r"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_417

    const-string/jumbo v0, "resolvers"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1f4

    goto/16 :goto_417

    .line 22914
    :cond_1f4
    const-string/jumbo v0, "perm"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_40f

    const-string/jumbo v0, "permissions"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_208

    goto/16 :goto_40f

    .line 22916
    :cond_208
    const-string/jumbo v0, "permission"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_236

    .line 22917
    array-length v0, v10

    if-lt v5, v0, :cond_21a

    .line 22918
    const-string v0, "Error: permission requires permission name"

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22919
    return-void

    .line 22921
    :cond_21a
    new-instance v0, Landroid/util/ArraySet;

    invoke-direct {v0}, Landroid/util/ArraySet;-><init>()V

    .line 22922
    .end local v4  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .local v0, "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    :goto_21f
    array-length v4, v10

    if-ge v5, v4, :cond_22a

    .line 22923
    aget-object v4, v10, v5

    invoke-virtual {v0, v4}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 22924
    add-int/lit8 v5, v5, 0x1

    goto :goto_21f

    .line 22926
    :cond_22a
    const/16 v4, 0x1c0

    invoke-virtual {v11, v4}, Lcom/android/server/pm/DumpState;->setDump(I)V

    move-object v8, v0

    move v14, v2

    move-object v13, v3

    move/from16 v21, v5

    goto/16 :goto_4c6

    .line 22928
    .end local v0  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .restart local v4  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    :cond_236
    const-string/jumbo v0, "pref"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_407

    const-string/jumbo v0, "preferred"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_24a

    goto/16 :goto_407

    .line 22930
    :cond_24a
    const-string/jumbo v0, "preferred-xml"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_272

    .line 22931
    const/16 v0, 0x2000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    .line 22932
    array-length v0, v10

    if-ge v5, v0, :cond_26f

    aget-object v0, v10, v5

    const-string v14, "--full"

    invoke-virtual {v14, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_26f

    .line 22933
    const/4 v2, 0x1

    .line 22934
    add-int/lit8 v5, v5, 0x1

    move v14, v2

    move-object v13, v3

    move-object v8, v4

    move/from16 v21, v5

    goto/16 :goto_4c6

    .line 22932
    :cond_26f
    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22936
    :cond_272
    const-string v0, "d"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3ff

    const-string v0, "domain-preferred-apps"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_284

    goto/16 :goto_3ff

    .line 22938
    :cond_284
    const-string/jumbo v0, "p"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3f7

    const-string/jumbo v0, "packages"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_298

    goto/16 :goto_3f7

    .line 22940
    :cond_298
    const-string/jumbo v0, "s"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3da

    const-string/jumbo v0, "shared-users"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_2ac

    goto/16 :goto_3da

    .line 22945
    :cond_2ac
    const-string/jumbo v0, "prov"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3d2

    const-string/jumbo v0, "providers"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_2c0

    goto/16 :goto_3d2

    .line 22947
    :cond_2c0
    const-string/jumbo v0, "m"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3cc

    const-string/jumbo v0, "messages"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_2d4

    goto/16 :goto_3cc

    .line 22949
    :cond_2d4
    const-string/jumbo v0, "v"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3c6

    const-string/jumbo v0, "verifiers"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_2e8

    goto/16 :goto_3c6

    .line 22951
    :cond_2e8
    const-string v0, "i"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3c0

    const-string/jumbo v0, "ifv"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3c0

    .line 22952
    const-string/jumbo v0, "intent-filter-verifiers"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_304

    goto/16 :goto_3c0

    .line 22954
    :cond_304
    const-string/jumbo v0, "version"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_313

    .line 22955
    invoke-virtual {v11, v7}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22956
    :cond_313
    const-string/jumbo v0, "k"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3b8

    const-string/jumbo v0, "keysets"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_327

    goto/16 :goto_3b8

    .line 22958
    :cond_327
    const-string/jumbo v0, "installs"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_338

    .line 22959
    const/high16 v0, 0x10000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22960
    :cond_338
    const-string v0, "frozen"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_348

    .line 22961
    const/high16 v0, 0x80000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22962
    :cond_348
    const-string/jumbo v0, "volumes"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_359

    .line 22963
    const/high16 v0, 0x800000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22964
    :cond_359
    const-string v0, "dexopt"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_369

    .line 22965
    const/high16 v0, 0x100000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22966
    :cond_369
    const-string v0, "compiler-stats"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_379

    .line 22967
    const/high16 v0, 0x200000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22968
    :cond_379
    const-string v0, "changes"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_389

    .line 22969
    const/high16 v0, 0x400000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22970
    :cond_389
    const-string/jumbo v0, "service-permissions"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_39a

    .line 22971
    const/high16 v0, 0x1000000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22972
    :cond_39a
    const-string/jumbo v0, "write"

    invoke-virtual {v0, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_3b5

    .line 22973
    iget-object v14, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v14

    .line 22974
    :try_start_3a6
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 22975
    const-string v0, "Settings written."

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22976
    monitor-exit v14

    return-void

    .line 22977
    :catchall_3b2
    move-exception v0

    monitor-exit v14
    :try_end_3b4
    .catchall {:try_start_3a6 .. :try_end_3b4} :catchall_3b2

    throw v0

    .line 22972
    :cond_3b5
    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22957
    :cond_3b8
    :goto_3b8
    const/16 v0, 0x4000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22953
    :cond_3c0
    :goto_3c0
    invoke-virtual {v11, v6}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22950
    :cond_3c6
    :goto_3c6
    invoke-virtual {v11, v15}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22948
    :cond_3cc
    :goto_3cc
    invoke-virtual {v11, v13}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22946
    :cond_3d2
    :goto_3d2
    const/16 v0, 0x400

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22941
    :cond_3da
    :goto_3da
    const/16 v0, 0x100

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    .line 22942
    array-length v0, v10

    if-ge v5, v0, :cond_3f4

    aget-object v0, v10, v5

    const-string/jumbo v14, "noperm"

    invoke-virtual {v14, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_3f4

    .line 22943
    const/4 v0, 0x4

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setOptionEnabled(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22942
    :cond_3f4
    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22939
    :cond_3f7
    :goto_3f7
    const/16 v14, 0x80

    invoke-virtual {v11, v14}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22937
    :cond_3ff
    :goto_3ff
    const/high16 v14, 0x40000

    invoke-virtual {v11, v14}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22929
    :cond_407
    :goto_407
    const/16 v14, 0x1000

    invoke-virtual {v11, v14}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22915
    :cond_40f
    :goto_40f
    const/16 v14, 0x40

    invoke-virtual {v11, v14}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22891
    :cond_417
    :goto_417
    array-length v14, v10

    if-lt v5, v14, :cond_422

    .line 22892
    const/16 v14, 0x3c

    invoke-virtual {v11, v14}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto/16 :goto_4b0

    .line 22897
    :cond_422
    :goto_422
    array-length v14, v10

    if-ge v5, v14, :cond_4a0

    .line 22898
    aget-object v14, v10, v5

    .line 22899
    .local v14, "name":Ljava/lang/String;
    const-string v0, "a"

    invoke-virtual {v0, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_496

    const-string v0, "activity"

    invoke-virtual {v0, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_438

    goto :goto_496

    .line 22901
    :cond_438
    const-string/jumbo v0, "s"

    invoke-virtual {v0, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_490

    const-string/jumbo v0, "service"

    invoke-virtual {v0, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_44b

    goto :goto_490

    .line 22903
    :cond_44b
    const-string/jumbo v0, "r"

    invoke-virtual {v0, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_48a

    const-string/jumbo v0, "receiver"

    invoke-virtual {v0, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_45e

    goto :goto_48a

    .line 22905
    :cond_45e
    const-string v0, "c"

    invoke-virtual {v0, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_484

    const-string v0, "content"

    invoke-virtual {v0, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_46f

    goto :goto_484

    .line 22908
    :cond_46f
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Error: unknown resolver table type: "

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22909
    return-void

    .line 22906
    :cond_484
    :goto_484
    const/16 v13, 0x20

    invoke-virtual {v11, v13}, Lcom/android/server/pm/DumpState;->setDump(I)V

    goto :goto_49a

    .line 22904
    :cond_48a
    :goto_48a
    const/16 v0, 0x10

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    goto :goto_49a

    .line 22902
    :cond_490
    :goto_490
    const/16 v0, 0x8

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    goto :goto_49a

    .line 22900
    :cond_496
    :goto_496
    const/4 v0, 0x4

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->setDump(I)V

    .line 22911
    :goto_49a
    nop

    .end local v14  # "name":Ljava/lang/String;
    add-int/lit8 v5, v5, 0x1

    .line 22912
    const/16 v13, 0x200

    goto :goto_422

    .line 22897
    :cond_4a0
    move v14, v2

    move-object v13, v3

    move-object v8, v4

    move/from16 v21, v5

    goto :goto_4c6

    .line 22889
    :cond_4a6
    :goto_4a6
    const/4 v13, 0x2

    invoke-virtual {v11, v13}, Lcom/android/server/pm/DumpState;->setDump(I)V

    const/4 v13, 0x1

    goto :goto_4b0

    .line 22887
    :cond_4ac
    :goto_4ac
    const/4 v13, 0x1

    invoke-virtual {v11, v13}, Lcom/android/server/pm/DumpState;->setDump(I)V

    .line 22981
    .end local v8  # "cmd":Ljava/lang/String;
    :goto_4b0
    move v14, v2

    move-object v13, v3

    move-object v8, v4

    move/from16 v21, v5

    goto :goto_4c6

    .line 22851
    .restart local v8  # "cmd":Ljava/lang/String;
    :cond_4b6
    move v13, v14

    .line 22852
    :goto_4b7
    move-object v3, v8

    .line 22855
    invoke-virtual {v11, v13}, Lcom/android/server/pm/DumpState;->setOptionEnabled(I)V

    move v14, v2

    move-object v13, v3

    move-object v8, v4

    move/from16 v21, v5

    goto :goto_4c6

    .line 22847
    .end local v8  # "cmd":Ljava/lang/String;
    :cond_4c1
    move v14, v2

    move-object v13, v3

    move-object v8, v4

    move/from16 v21, v5

    .line 22981
    .end local v2  # "fullPreferred":Z
    .end local v3  # "packageName":Ljava/lang/String;
    .end local v4  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .end local v5  # "opti":I
    .local v8, "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .local v13, "packageName":Ljava/lang/String;
    .local v14, "fullPreferred":Z
    .local v21, "opti":I
    :goto_4c6
    if-eqz v12, :cond_4ce

    .line 22982
    const-string/jumbo v2, "vers,1"

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22986
    :cond_4ce
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 22987
    :try_start_4d1
    invoke-virtual {v11, v7}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2
    :try_end_4d5
    .catchall {:try_start_4d1 .. :try_end_4d5} :catchall_bf6

    if-eqz v2, :cond_4fe

    if-nez v13, :cond_4fe

    .line 22988
    if-nez v12, :cond_4fe

    .line 22989
    :try_start_4db
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v2

    if-eqz v2, :cond_4e4

    .line 22990
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 22991
    :cond_4e4
    const-string v2, "Database versions:"

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 22992
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    new-instance v3, Lcom/android/internal/util/IndentingPrintWriter;

    const-string v4, "  "

    invoke-direct {v3, v9, v4}, Lcom/android/internal/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;)V

    invoke-virtual {v2, v3}, Lcom/android/server/pm/Settings;->dumpVersionLPr(Lcom/android/internal/util/IndentingPrintWriter;)V
    :try_end_4f5
    .catchall {:try_start_4db .. :try_end_4f5} :catchall_4f6

    goto :goto_4fe

    .line 23328
    :catchall_4f6
    move-exception v0

    move-object/from16 v19, v5

    move-object v10, v8

    move-object/from16 v8, p1

    goto/16 :goto_bfc

    .line 22996
    :cond_4fe
    :goto_4fe
    :try_start_4fe
    invoke-virtual {v11, v15}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2
    :try_end_502
    .catchall {:try_start_4fe .. :try_end_502} :catchall_bf6

    const/high16 v3, 0x10000000

    if-eqz v2, :cond_555

    if-nez v13, :cond_555

    .line 22997
    if-nez v12, :cond_537

    .line 22998
    :try_start_50a
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v2

    if-eqz v2, :cond_513

    .line 22999
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23000
    :cond_513
    const-string v2, "Verifiers:"

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23001
    const-string v2, "  Required: "

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23002
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23003
    const-string v2, " (uid="

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23004
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    const/4 v4, 0x0

    invoke-virtual {v1, v2, v3, v4}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->print(I)V

    .line 23006
    const-string v2, ")"

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_555

    .line 23007
    :cond_537
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    if-eqz v2, :cond_555

    .line 23008
    const-string/jumbo v2, "vrfy,"

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23009
    const-string v2, ","

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23010
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    const/4 v4, 0x0

    invoke-virtual {v1, v2, v3, v4}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v2

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(I)V
    :try_end_555
    .catchall {:try_start_50a .. :try_end_555} :catchall_4f6

    .line 23015
    :cond_555
    :goto_555
    :try_start_555
    invoke-virtual {v11, v6}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2
    :try_end_559
    .catchall {:try_start_555 .. :try_end_559} :catchall_bf6

    if-eqz v2, :cond_5b3

    if-nez v13, :cond_5b3

    .line 23017
    :try_start_55d
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifierComponent:Landroid/content/ComponentName;

    if-eqz v2, :cond_5ab

    .line 23018
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mIntentFilterVerifierComponent:Landroid/content/ComponentName;

    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v2

    .line 23019
    .local v2, "verifierPackageName":Ljava/lang/String;
    if-nez v12, :cond_592

    .line 23020
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v4

    if-eqz v4, :cond_572

    .line 23021
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23022
    :cond_572
    const-string v4, "Intent Filter Verifier:"

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23023
    const-string v4, "  Using: "

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23024
    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23025
    const-string v4, " (uid="

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23026
    const/4 v4, 0x0

    invoke-virtual {v1, v2, v3, v4}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v3

    invoke-virtual {v9, v3}, Ljava/io/PrintWriter;->print(I)V

    .line 23028
    const-string v3, ")"

    invoke-virtual {v9, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_5aa

    .line 23029
    :cond_592
    if-eqz v2, :cond_5aa

    .line 23030
    const-string/jumbo v4, "ifv,"

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23031
    const-string v4, ","

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23032
    const/4 v4, 0x0

    invoke-virtual {v1, v2, v3, v4}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v3

    invoke-virtual {v9, v3}, Ljava/io/PrintWriter;->println(I)V

    .line 23035
    .end local v2  # "verifierPackageName":Ljava/lang/String;
    :cond_5aa
    :goto_5aa
    goto :goto_5b3

    .line 23036
    :cond_5ab
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23037
    const-string v2, "No Intent Filter Verifier available!"

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V
    :try_end_5b3
    .catchall {:try_start_55d .. :try_end_5b3} :catchall_4f6

    .line 23041
    :cond_5b3
    :goto_5b3
    const/4 v2, 0x1

    :try_start_5b4
    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v3
    :try_end_5b8
    .catchall {:try_start_5b4 .. :try_end_5b8} :catchall_bf6

    if-eqz v3, :cond_66f

    if-nez v13, :cond_66f

    .line 23042
    const/4 v2, 0x0

    .line 23043
    .local v2, "printedHeader":Z
    :try_start_5bd
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->keySet()Ljava/util/Set;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 23044
    .local v3, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    :goto_5c7
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_66d

    .line 23045
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/String;

    .line 23046
    .local v4, "libName":Ljava/lang/String;
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    .line 23047
    invoke-virtual {v6, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/util/LongSparseArray;

    .line 23048
    .local v6, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-nez v6, :cond_5de

    .line 23049
    goto :goto_5c7

    .line 23051
    :cond_5de
    invoke-virtual {v6}, Landroid/util/LongSparseArray;->size()I

    move-result v7

    .line 23052
    .local v7, "versionCount":I
    const/4 v15, 0x0

    .local v15, "i":I
    :goto_5e3
    if-ge v15, v7, :cond_669

    .line 23053
    invoke-virtual {v6, v15}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Landroid/content/pm/SharedLibraryInfo;

    .line 23054
    .local v23, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    if-nez v12, :cond_604

    .line 23055
    if-nez v2, :cond_5fe

    .line 23056
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v24

    if-eqz v24, :cond_5f8

    .line 23057
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23058
    :cond_5f8
    const-string v0, "Libraries:"

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23059
    const/4 v2, 0x1

    .line 23061
    :cond_5fe
    const-string v0, "  "

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    goto :goto_60a

    .line 23063
    :cond_604
    const-string/jumbo v0, "lib,"

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23065
    :goto_60a
    invoke-virtual/range {v23 .. v23}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23066
    invoke-virtual/range {v23 .. v23}, Landroid/content/pm/SharedLibraryInfo;->isStatic()Z

    move-result v0

    if-eqz v0, :cond_634

    .line 23067
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v25, v2

    .end local v2  # "printedHeader":Z
    .local v25, "printedHeader":Z
    const-string v2, " version="

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v26, v3

    .end local v3  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    .local v26, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    invoke-virtual/range {v23 .. v23}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v2

    invoke-virtual {v0, v2, v3}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    goto :goto_638

    .line 23066
    .end local v25  # "printedHeader":Z
    .end local v26  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    .restart local v2  # "printedHeader":Z
    .restart local v3  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    :cond_634
    move/from16 v25, v2

    move-object/from16 v26, v3

    .line 23069
    .end local v2  # "printedHeader":Z
    .end local v3  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    .restart local v25  # "printedHeader":Z
    .restart local v26  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    :goto_638
    if-nez v12, :cond_63f

    .line 23070
    const-string v0, " -> "

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23072
    :cond_63f
    invoke-virtual/range {v23 .. v23}, Landroid/content/pm/SharedLibraryInfo;->getPath()Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_652

    .line 23073
    const-string v0, " (jar) "

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23074
    invoke-virtual/range {v23 .. v23}, Landroid/content/pm/SharedLibraryInfo;->getPath()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    goto :goto_65e

    .line 23076
    :cond_652
    const-string v0, " (apk) "

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23077
    invoke-virtual/range {v23 .. v23}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23079
    :goto_65e
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V
    :try_end_661
    .catchall {:try_start_5bd .. :try_end_661} :catchall_4f6

    .line 23052
    .end local v23  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    add-int/lit8 v15, v15, 0x1

    move/from16 v2, v25

    move-object/from16 v3, v26

    goto/16 :goto_5e3

    .end local v25  # "printedHeader":Z
    .end local v26  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    .restart local v2  # "printedHeader":Z
    .restart local v3  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    :cond_669
    move-object/from16 v26, v3

    .line 23081
    .end local v3  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    .end local v4  # "libName":Ljava/lang/String;
    .end local v6  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v7  # "versionCount":I
    .end local v15  # "i":I
    .restart local v26  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    goto/16 :goto_5c7

    .line 23044
    .end local v26  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    .restart local v3  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    :cond_66d
    move-object/from16 v26, v3

    .line 23084
    .end local v2  # "printedHeader":Z
    .end local v3  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Ljava/lang/String;>;"
    :cond_66f
    const/4 v0, 0x2

    :try_start_670
    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0
    :try_end_674
    .catchall {:try_start_670 .. :try_end_674} :catchall_bf6

    if-eqz v0, :cond_6d9

    if-nez v13, :cond_6d9

    .line 23085
    :try_start_678
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v0

    if-eqz v0, :cond_681

    .line 23086
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23087
    :cond_681
    if-nez v12, :cond_688

    .line 23088
    const-string v0, "Features:"

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23091
    :cond_688
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    monitor-enter v2
    :try_end_68b
    .catchall {:try_start_678 .. :try_end_68b} :catchall_4f6

    .line 23092
    :try_start_68b
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_695
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_6d4

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/FeatureInfo;

    .line 23093
    .local v3, "feat":Landroid/content/pm/FeatureInfo;
    if-eqz v12, :cond_6b8

    .line 23094
    const-string v4, "feat,"

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23095
    iget-object v4, v3, Landroid/content/pm/FeatureInfo;->name:Ljava/lang/String;

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23096
    const-string v4, ","

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23097
    iget v4, v3, Landroid/content/pm/FeatureInfo;->version:I

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->println(I)V

    goto :goto_6d3

    .line 23099
    :cond_6b8
    const-string v4, "  "

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23100
    iget-object v4, v3, Landroid/content/pm/FeatureInfo;->name:Ljava/lang/String;

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23101
    iget v4, v3, Landroid/content/pm/FeatureInfo;->version:I

    if-lez v4, :cond_6d0

    .line 23102
    const-string v4, " version="

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23103
    iget v4, v3, Landroid/content/pm/FeatureInfo;->version:I

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(I)V

    .line 23105
    :cond_6d0
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23107
    .end local v3  # "feat":Landroid/content/pm/FeatureInfo;
    :goto_6d3
    goto :goto_695

    .line 23108
    :cond_6d4
    monitor-exit v2

    goto :goto_6d9

    :catchall_6d6
    move-exception v0

    monitor-exit v2
    :try_end_6d8
    .catchall {:try_start_68b .. :try_end_6d8} :catchall_6d6

    .end local v8  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .end local v11  # "dumpState":Lcom/android/server/pm/DumpState;
    .end local v12  # "checkin":Z
    .end local v13  # "packageName":Ljava/lang/String;
    .end local v14  # "fullPreferred":Z
    .end local v21  # "opti":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "fd":Ljava/io/FileDescriptor;
    .end local p2  # "pw":Ljava/io/PrintWriter;
    .end local p3  # "args":[Ljava/lang/String;
    :try_start_6d8
    throw v0
    :try_end_6d9
    .catchall {:try_start_6d8 .. :try_end_6d9} :catchall_4f6

    .line 23111
    .restart local v8  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .restart local v11  # "dumpState":Lcom/android/server/pm/DumpState;
    .restart local v12  # "checkin":Z
    .restart local v13  # "packageName":Ljava/lang/String;
    .restart local v14  # "fullPreferred":Z
    .restart local v21  # "opti":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "fd":Ljava/io/FileDescriptor;
    .restart local p2  # "pw":Ljava/io/PrintWriter;
    .restart local p3  # "args":[Ljava/lang/String;
    :cond_6d9
    :goto_6d9
    :try_start_6d9
    const-string/jumbo v0, "persist.sys.cts_Myanmar_state"

    const/4 v2, 0x0

    invoke-static {v0, v2}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z

    move-result v0
    :try_end_6e1
    .catchall {:try_start_6d9 .. :try_end_6e1} :catchall_bf6

    move v15, v0

    .line 23113
    .local v15, "isCtsRunning":Z
    if-nez v12, :cond_6f0

    const/4 v0, 0x4

    :try_start_6e5
    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_6f0

    .line 23114
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, v9, v11, v13}, Lcom/android/server/pm/ComponentResolver;->dumpActivityResolvers(Ljava/io/PrintWriter;Lcom/android/server/pm/DumpState;Ljava/lang/String;)V

    .line 23116
    :cond_6f0
    if-nez v12, :cond_6ff

    const/16 v0, 0x10

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_6ff

    .line 23117
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, v9, v11, v13}, Lcom/android/server/pm/ComponentResolver;->dumpReceiverResolvers(Ljava/io/PrintWriter;Lcom/android/server/pm/DumpState;Ljava/lang/String;)V

    .line 23119
    :cond_6ff
    if-nez v12, :cond_70e

    const/16 v0, 0x8

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_70e

    .line 23120
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, v9, v11, v13}, Lcom/android/server/pm/ComponentResolver;->dumpServiceResolvers(Ljava/io/PrintWriter;Lcom/android/server/pm/DumpState;Ljava/lang/String;)V

    .line 23122
    :cond_70e
    if-nez v12, :cond_71e

    const/16 v7, 0x20

    invoke-virtual {v11, v7}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_720

    .line 23123
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, v9, v11, v13}, Lcom/android/server/pm/ComponentResolver;->dumpProviderResolvers(Ljava/io/PrintWriter;Lcom/android/server/pm/DumpState;Ljava/lang/String;)V
    :try_end_71d
    .catchall {:try_start_6e5 .. :try_end_71d} :catchall_4f6

    goto :goto_720

    .line 23122
    :cond_71e
    const/16 v7, 0x20

    .line 23126
    :cond_720
    :goto_720
    if-nez v12, :cond_7b1

    const/16 v0, 0x1000

    :try_start_724
    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_7b1

    .line 23127
    const/4 v2, 0x0

    move v0, v2

    .local v0, "i":I
    :goto_72c
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v2}, Landroid/util/SparseArray;->size()I

    move-result v2

    if-ge v0, v2, :cond_7ab

    .line 23128
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v2, v0}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PreferredIntentResolver;

    .line 23129
    .local v2, "pir":Lcom/android/server/pm/PreferredIntentResolver;
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v3, v0}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move v6, v3

    .line 23130
    .local v6, "user":I
    nop

    .line 23131
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->getTitlePrinted()Z

    move-result v3
    :try_end_74e
    .catchall {:try_start_724 .. :try_end_74e} :catchall_bf6

    if-eqz v3, :cond_768

    .line 23132
    :try_start_750
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "\nPreferred Activities User "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, ":"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3
    :try_end_766
    .catchall {:try_start_750 .. :try_end_766} :catchall_4f6

    move-object v4, v3

    goto :goto_77f

    .line 23133
    :cond_768
    :try_start_768
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Preferred Activities User "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, ":"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v4, v3

    :goto_77f
    const-string v16, "  "
    :try_end_781
    .catchall {:try_start_768 .. :try_end_781} :catchall_bf6

    const/16 v17, 0x1

    const/16 v18, 0x0

    .line 23130
    move-object/from16 v3, p2

    move-object/from16 v19, v5

    move-object/from16 v5, v16

    move/from16 v16, v6

    .end local v6  # "user":I
    .local v16, "user":I
    move-object v6, v13

    move/from16 v20, v7

    move/from16 v7, v17

    move-object v10, v8

    move/from16 v17, v20

    .end local v8  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .local v10, "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    move/from16 v8, v18

    :try_start_797
    invoke-virtual/range {v2 .. v8}, Lcom/android/server/pm/PreferredIntentResolver;->dump(Ljava/io/PrintWriter;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZZ)Z

    move-result v3

    if-eqz v3, :cond_7a1

    .line 23135
    const/4 v3, 0x1

    invoke-virtual {v11, v3}, Lcom/android/server/pm/DumpState;->setTitlePrinted(Z)V

    .line 23127
    .end local v2  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    .end local v16  # "user":I
    :cond_7a1
    add-int/lit8 v0, v0, 0x1

    move-object v8, v10

    move/from16 v7, v17

    move-object/from16 v5, v19

    move-object/from16 v10, p3

    goto :goto_72c

    .end local v10  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .restart local v8  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    :cond_7ab
    move-object/from16 v19, v5

    move/from16 v17, v7

    move-object v10, v8

    .end local v8  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .restart local v10  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    goto :goto_7b6

    .line 23126
    .end local v0  # "i":I
    .end local v10  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .restart local v8  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    :cond_7b1
    move-object/from16 v19, v5

    move/from16 v17, v7

    move-object v10, v8

    .line 23140
    .end local v8  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .restart local v10  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    :goto_7b6
    if-nez v12, :cond_842

    const/16 v0, 0x2000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_842

    .line 23141
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->flush()V

    .line 23142
    new-instance v0, Ljava/io/FileOutputStream;
    :try_end_7c5
    .catchall {:try_start_797 .. :try_end_7c5} :catchall_83d

    move-object/from16 v8, p1

    :try_start_7c7
    invoke-direct {v0, v8}, Ljava/io/FileOutputStream;-><init>(Ljava/io/FileDescriptor;)V

    move-object v2, v0

    .line 23143
    .local v2, "fout":Ljava/io/FileOutputStream;
    new-instance v0, Ljava/io/BufferedOutputStream;

    invoke-direct {v0, v2}, Ljava/io/BufferedOutputStream;-><init>(Ljava/io/OutputStream;)V

    move-object v3, v0

    .line 23144
    .local v3, "str":Ljava/io/BufferedOutputStream;
    new-instance v0, Lcom/android/internal/util/FastXmlSerializer;

    invoke-direct {v0}, Lcom/android/internal/util/FastXmlSerializer;-><init>()V
    :try_end_7d6
    .catchall {:try_start_7c7 .. :try_end_7d6} :catchall_bfe

    move-object v4, v0

    .line 23146
    .local v4, "serializer":Lorg/xmlpull/v1/XmlSerializer;
    :try_start_7d7
    sget-object v0, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;

    invoke-virtual {v0}, Ljava/nio/charset/Charset;->name()Ljava/lang/String;

    move-result-object v0

    invoke-interface {v4, v3, v0}, Lorg/xmlpull/v1/XmlSerializer;->setOutput(Ljava/io/OutputStream;Ljava/lang/String;)V

    .line 23147
    const/4 v0, 0x0

    const/4 v5, 0x1

    invoke-static {v5}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v6

    invoke-interface {v4, v0, v6}, Lorg/xmlpull/v1/XmlSerializer;->startDocument(Ljava/lang/String;Ljava/lang/Boolean;)V

    .line 23148
    const-string v0, "http://xmlpull.org/v1/doc/features.html#indent-output"

    invoke-interface {v4, v0, v5}, Lorg/xmlpull/v1/XmlSerializer;->setFeature(Ljava/lang/String;Z)V

    .line 23150
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/4 v5, 0x0

    invoke-virtual {v0, v4, v5, v14}, Lcom/android/server/pm/Settings;->writePreferredActivitiesLPr(Lorg/xmlpull/v1/XmlSerializer;IZ)V

    .line 23151
    invoke-interface {v4}, Lorg/xmlpull/v1/XmlSerializer;->endDocument()V

    .line 23152
    invoke-interface {v4}, Lorg/xmlpull/v1/XmlSerializer;->flush()V
    :try_end_7fa
    .catch Ljava/lang/IllegalArgumentException; {:try_start_7d7 .. :try_end_7fa} :catch_827
    .catch Ljava/lang/IllegalStateException; {:try_start_7d7 .. :try_end_7fa} :catch_811
    .catch Ljava/io/IOException; {:try_start_7d7 .. :try_end_7fa} :catch_7fb
    .catchall {:try_start_7d7 .. :try_end_7fa} :catchall_bfe

    goto :goto_83c

    .line 23157
    :catch_7fb
    move-exception v0

    .line 23158
    .local v0, "e":Ljava/io/IOException;
    :try_start_7fc
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failed writing: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v9, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_844

    .line 23155
    .end local v0  # "e":Ljava/io/IOException;
    :catch_811
    move-exception v0

    .line 23156
    .local v0, "e":Ljava/lang/IllegalStateException;
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failed writing: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v9, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .end local v0  # "e":Ljava/lang/IllegalStateException;
    goto :goto_83c

    .line 23153
    :catch_827
    move-exception v0

    .line 23154
    .local v0, "e":Ljava/lang/IllegalArgumentException;
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failed writing: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v9, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23159
    .end local v0  # "e":Ljava/lang/IllegalArgumentException;
    :goto_83c
    goto :goto_844

    .line 23328
    .end local v2  # "fout":Ljava/io/FileOutputStream;
    .end local v3  # "str":Ljava/io/BufferedOutputStream;
    .end local v4  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    .end local v15  # "isCtsRunning":Z
    :catchall_83d
    move-exception v0

    move-object/from16 v8, p1

    goto/16 :goto_bfc

    .line 23140
    .restart local v15  # "isCtsRunning":Z
    :cond_842
    move-object/from16 v8, p1

    .line 23162
    :goto_844
    if-nez v12, :cond_9d1

    const/high16 v0, 0x40000

    .line 23163
    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_9d1

    if-nez v13, :cond_9d1

    .line 23165
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23166
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v0

    .line 23167
    .local v0, "count":I
    if-nez v0, :cond_867

    .line 23168
    const-string v2, "No applications!"

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23169
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    goto/16 :goto_9d1

    .line 23171
    :cond_867
    const-string v2, "  "

    .line 23172
    .local v2, "prefix":Ljava/lang/String;
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v3

    .line 23173
    .local v3, "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    invoke-interface {v3}, Ljava/util/Collection;->size()I

    move-result v4

    if-nez v4, :cond_881

    .line 23174
    const-string v4, "No domain preferred apps!"

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23175
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    goto/16 :goto_9d1

    .line 23177
    :cond_881
    const-string v4, "App verification status:"

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23178
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23179
    const/4 v0, 0x0

    .line 23180
    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v4

    :goto_88e
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_901

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 23181
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v5}, Lcom/android/server/pm/PackageSetting;->getIntentFilterVerificationInfo()Landroid/content/pm/IntentFilterVerificationInfo;

    move-result-object v6

    .line 23182
    .local v6, "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    if-eqz v6, :cond_8fc

    invoke-virtual {v6}, Landroid/content/pm/IntentFilterVerificationInfo;->getPackageName()Ljava/lang/String;

    move-result-object v7

    if-nez v7, :cond_8a9

    move-object/from16 v16, v2

    goto :goto_8fe

    .line 23183
    :cond_8a9
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v16, v2

    .end local v2  # "prefix":Ljava/lang/String;
    .local v16, "prefix":Ljava/lang/String;
    const-string v2, "  Package: "

    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Landroid/content/pm/IntentFilterVerificationInfo;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23184
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  Domains: "

    invoke-virtual {v2, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Landroid/content/pm/IntentFilterVerificationInfo;->getDomainsString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v2, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23185
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  Status:  "

    invoke-virtual {v2, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Landroid/content/pm/IntentFilterVerificationInfo;->getStatusString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v2, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23186
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23187
    nop

    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    add-int/lit8 v0, v0, 0x1

    .line 23188
    move-object/from16 v2, v16

    goto :goto_88e

    .line 23182
    .end local v16  # "prefix":Ljava/lang/String;
    .restart local v2  # "prefix":Ljava/lang/String;
    .restart local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    :cond_8fc
    move-object/from16 v16, v2

    .line 23180
    .end local v2  # "prefix":Ljava/lang/String;
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "ivi":Landroid/content/pm/IntentFilterVerificationInfo;
    .restart local v16  # "prefix":Ljava/lang/String;
    :goto_8fe
    move-object/from16 v2, v16

    goto :goto_88e

    .line 23189
    .end local v16  # "prefix":Ljava/lang/String;
    .restart local v2  # "prefix":Ljava/lang/String;
    :cond_901
    move-object/from16 v16, v2

    .end local v2  # "prefix":Ljava/lang/String;
    .restart local v16  # "prefix":Ljava/lang/String;
    if-nez v0, :cond_90d

    .line 23190
    const-string v2, "  No app verification established."

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23191
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23193
    :cond_90d
    sget-object v2, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v2}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v2

    array-length v4, v2

    move v5, v0

    const/4 v0, 0x0

    .end local v0  # "count":I
    .local v5, "count":I
    :goto_916
    if-ge v0, v4, :cond_9cf

    aget v6, v2, v0

    .line 23194
    .local v6, "userId":I
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v18, v2

    const-string v2, "App linkages for user "

    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, ":"

    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23195
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23196
    const/4 v2, 0x0

    .line 23197
    .end local v5  # "count":I
    .local v2, "count":I
    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v5

    :goto_93d
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_9b6

    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 23198
    .local v7, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v7, v6}, Lcom/android/server/pm/PackageSetting;->getDomainVerificationStatusForUser(I)J

    move-result-wide v23

    .line 23199
    .local v23, "status":J
    shr-long v25, v23, v17

    const-wide/16 v27, 0x0

    cmp-long v20, v25, v27

    if-nez v20, :cond_95a

    sget-boolean v20, Lcom/android/server/pm/PackageManagerService;->DEBUG_DOMAIN_VERIFICATION:Z

    if-nez v20, :cond_95a

    .line 23201
    goto :goto_93d

    .line 23203
    :cond_95a
    move-object/from16 v20, v3

    .end local v3  # "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    .local v20, "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v22, v4

    const-string v4, "  Package: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v7, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v9, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23204
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  Domains: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v7, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    invoke-direct {v1, v4}, Lcom/android/server/pm/PackageManagerService;->dumpDomainString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v9, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23205
    nop

    .line 23206
    invoke-static/range {v23 .. v24}, Landroid/content/pm/IntentFilterVerificationInfo;->getStatusStringFromValue(J)Ljava/lang/String;

    move-result-object v3

    .line 23207
    .local v3, "statusStr":Ljava/lang/String;
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v25, v5

    const-string v5, "  Status:  "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23208
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23209
    nop

    .end local v3  # "statusStr":Ljava/lang/String;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v23  # "status":J
    add-int/lit8 v2, v2, 0x1

    .line 23210
    move-object/from16 v3, v20

    move/from16 v4, v22

    move-object/from16 v5, v25

    goto :goto_93d

    .line 23211
    .end local v20  # "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    .local v3, "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    :cond_9b6
    move-object/from16 v20, v3

    move/from16 v22, v4

    .end local v3  # "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    .restart local v20  # "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    if-nez v2, :cond_9c4

    .line 23212
    const-string v3, "  No configured app linkages."

    invoke-virtual {v9, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23213
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23193
    .end local v6  # "userId":I
    :cond_9c4
    add-int/lit8 v0, v0, 0x1

    move v5, v2

    move-object/from16 v2, v18

    move-object/from16 v3, v20

    move/from16 v4, v22

    goto/16 :goto_916

    .end local v2  # "count":I
    .end local v20  # "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    .restart local v3  # "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    .restart local v5  # "count":I
    :cond_9cf
    move-object/from16 v20, v3

    .line 23220
    .end local v3  # "allPackageSettings":Ljava/util/Collection;, "Ljava/util/Collection<Lcom/android/server/pm/PackageSetting;>;"
    .end local v5  # "count":I
    .end local v16  # "prefix":Ljava/lang/String;
    :cond_9d1
    :goto_9d1
    if-nez v12, :cond_9e0

    const/16 v2, 0x40

    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_9e0

    .line 23221
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v9, v13, v10, v11}, Lcom/android/server/pm/Settings;->dumpPermissionsLPr(Ljava/io/PrintWriter;Ljava/lang/String;Landroid/util/ArraySet;Lcom/android/server/pm/DumpState;)V

    .line 23224
    :cond_9e0
    if-nez v12, :cond_9ef

    const/16 v0, 0x400

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_9ef

    .line 23225
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v0, v9, v11, v13}, Lcom/android/server/pm/ComponentResolver;->dumpContentProviders(Ljava/io/PrintWriter;Lcom/android/server/pm/DumpState;Ljava/lang/String;)V

    .line 23228
    :cond_9ef
    if-nez v12, :cond_a00

    const/16 v0, 0x4000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_a00

    .line 23229
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    invoke-virtual {v0, v9, v13, v11}, Lcom/android/server/pm/KeySetManagerService;->dumpLPr(Ljava/io/PrintWriter;Ljava/lang/String;Lcom/android/server/pm/DumpState;)V

    .line 23232
    :cond_a00
    const/16 v0, 0x80

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_a13

    .line 23233
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    move-object/from16 v3, p2

    move-object v4, v13

    move-object v5, v10

    move-object v6, v11

    move v7, v12

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/Settings;->dumpPackagesLPr(Ljava/io/PrintWriter;Ljava/lang/String;Landroid/util/ArraySet;Lcom/android/server/pm/DumpState;Z)V

    .line 23236
    :cond_a13
    const/16 v0, 0x100

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_a26

    .line 23237
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    move-object/from16 v3, p2

    move-object v4, v13

    move-object v5, v10

    move-object v6, v11

    move v7, v12

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/Settings;->dumpSharedUsersLPr(Ljava/io/PrintWriter;Ljava/lang/String;Landroid/util/ArraySet;Lcom/android/server/pm/DumpState;Z)V

    .line 23240
    :cond_a26
    const/high16 v0, 0x400000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_ab0

    .line 23241
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v0

    if-eqz v0, :cond_a37

    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23242
    :cond_a37
    const-string v0, "Package Changes:"

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23243
    const-string v0, "  Sequence number="

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget v0, v1, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumber:I

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->println(I)V

    .line 23244
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mChangedPackages:Landroid/util/SparseArray;

    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I

    move-result v0

    .line 23245
    .local v0, "K":I
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_a4d
    if-ge v2, v0, :cond_aae

    .line 23246
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mChangedPackages:Landroid/util/SparseArray;

    invoke-virtual {v3, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/util/SparseArray;

    .line 23247
    .local v3, "changes":Landroid/util/SparseArray;, "Landroid/util/SparseArray<Ljava/lang/String;>;"
    const-string v4, "  User "

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService;->mChangedPackages:Landroid/util/SparseArray;

    invoke-virtual {v4, v2}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v4

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->print(I)V

    const-string v4, ":"

    invoke-virtual {v9, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23248
    invoke-virtual {v3}, Landroid/util/SparseArray;->size()I

    move-result v4

    .line 23249
    .local v4, "N":I
    if-nez v4, :cond_a7d

    .line 23250
    const-string v5, "    "

    invoke-virtual {v9, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    const-string v5, "No packages changed"

    invoke-virtual {v9, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    move/from16 v16, v0

    goto :goto_aa9

    .line 23252
    :cond_a7d
    const/4 v5, 0x0

    .local v5, "j":I
    :goto_a7e
    if-ge v5, v4, :cond_aa7

    .line 23253
    invoke-virtual {v3, v5}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/String;

    .line 23254
    .local v6, "pkgName":Ljava/lang/String;
    invoke-virtual {v3, v5}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v7

    .line 23255
    .local v7, "sequenceNumber":I
    move/from16 v16, v0

    .end local v0  # "K":I
    .local v16, "K":I
    const-string v0, "    "

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23256
    const-string/jumbo v0, "seq="

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23257
    invoke-virtual {v9, v7}, Ljava/io/PrintWriter;->print(I)V

    .line 23258
    const-string v0, ", package="

    invoke-virtual {v9, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 23259
    invoke-virtual {v9, v6}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23252
    .end local v6  # "pkgName":Ljava/lang/String;
    .end local v7  # "sequenceNumber":I
    add-int/lit8 v5, v5, 0x1

    move/from16 v0, v16

    goto :goto_a7e

    .end local v16  # "K":I
    .restart local v0  # "K":I
    :cond_aa7
    move/from16 v16, v0

    .line 23245
    .end local v0  # "K":I
    .end local v3  # "changes":Landroid/util/SparseArray;, "Landroid/util/SparseArray<Ljava/lang/String;>;"
    .end local v4  # "N":I
    .end local v5  # "j":I
    .restart local v16  # "K":I
    :goto_aa9
    add-int/lit8 v2, v2, 0x1

    move/from16 v0, v16

    goto :goto_a4d

    .end local v16  # "K":I
    .restart local v0  # "K":I
    :cond_aae
    move/from16 v16, v0

    .line 23265
    .end local v0  # "K":I
    .end local v2  # "i":I
    :cond_ab0
    const/16 v0, 0x78

    if-nez v12, :cond_b02

    const/high16 v2, 0x80000

    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2

    if-eqz v2, :cond_b02

    if-nez v13, :cond_b02

    .line 23268
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v2

    if-eqz v2, :cond_ac7

    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23270
    :cond_ac7
    new-instance v2, Lcom/android/internal/util/IndentingPrintWriter;

    const-string v3, "  "

    invoke-direct {v2, v9, v3, v0}, Lcom/android/internal/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;I)V

    .line 23271
    .local v2, "ipw":Lcom/android/internal/util/IndentingPrintWriter;
    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V

    .line 23272
    const-string v3, "Frozen packages:"

    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23273
    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23274
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mFrozenPackages:Landroid/util/ArraySet;

    invoke-virtual {v3}, Landroid/util/ArraySet;->size()I

    move-result v3

    if-nez v3, :cond_ae7

    .line 23275
    const-string v3, "(none)"

    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    goto :goto_aff

    .line 23277
    :cond_ae7
    const/4 v3, 0x0

    move v4, v3

    .local v4, "i":I
    :goto_ae9
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mFrozenPackages:Landroid/util/ArraySet;

    invoke-virtual {v3}, Landroid/util/ArraySet;->size()I

    move-result v3

    if-ge v4, v3, :cond_aff

    .line 23278
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mFrozenPackages:Landroid/util/ArraySet;

    invoke-virtual {v3, v4}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23277
    add-int/lit8 v4, v4, 0x1

    goto :goto_ae9

    .line 23281
    .end local v4  # "i":I
    :cond_aff
    :goto_aff
    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23284
    .end local v2  # "ipw":Lcom/android/internal/util/IndentingPrintWriter;
    :cond_b02
    if-nez v12, :cond_b51

    const/high16 v2, 0x800000

    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2

    if-eqz v2, :cond_b51

    if-nez v13, :cond_b51

    .line 23285
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v2

    if-eqz v2, :cond_b17

    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23287
    :cond_b17
    new-instance v2, Lcom/android/internal/util/IndentingPrintWriter;

    const-string v3, "  "

    invoke-direct {v2, v9, v3, v0}, Lcom/android/internal/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;I)V

    .line 23288
    .restart local v2  # "ipw":Lcom/android/internal/util/IndentingPrintWriter;
    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->println()V

    .line 23289
    const-string v3, "Loaded volumes:"

    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23290
    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->increaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23291
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mLoadedVolumes:Landroid/util/ArraySet;

    invoke-virtual {v3}, Landroid/util/ArraySet;->size()I

    move-result v3

    if-nez v3, :cond_b37

    .line 23292
    const-string v3, "(none)"

    invoke-virtual {v2, v3}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    goto :goto_b4e

    .line 23294
    :cond_b37
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_b38
    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService;->mLoadedVolumes:Landroid/util/ArraySet;

    invoke-virtual {v4}, Landroid/util/ArraySet;->size()I

    move-result v4

    if-ge v3, v4, :cond_b4e

    .line 23295
    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService;->mLoadedVolumes:Landroid/util/ArraySet;

    invoke-virtual {v4, v3}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/lang/String;

    invoke-virtual {v2, v4}, Lcom/android/internal/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    .line 23294
    add-int/lit8 v3, v3, 0x1

    goto :goto_b38

    .line 23298
    .end local v3  # "i":I
    :cond_b4e
    :goto_b4e
    invoke-virtual {v2}, Lcom/android/internal/util/IndentingPrintWriter;->decreaseIndent()Lcom/android/internal/util/IndentingPrintWriter;

    .line 23301
    .end local v2  # "ipw":Lcom/android/internal/util/IndentingPrintWriter;
    :cond_b51
    if-nez v12, :cond_b62

    const/high16 v2, 0x1000000

    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2

    if-eqz v2, :cond_b62

    if-nez v13, :cond_b62

    .line 23303
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v2, v9, v11, v13}, Lcom/android/server/pm/ComponentResolver;->dumpServicePermissions(Ljava/io/PrintWriter;Lcom/android/server/pm/DumpState;Ljava/lang/String;)V

    .line 23306
    :cond_b62
    if-nez v12, :cond_b78

    const/high16 v2, 0x100000

    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2

    if-eqz v2, :cond_b78

    .line 23307
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v2

    if-eqz v2, :cond_b75

    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23308
    :cond_b75
    invoke-direct {v1, v9, v13}, Lcom/android/server/pm/PackageManagerService;->dumpDexoptStateLPr(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 23311
    :cond_b78
    if-nez v12, :cond_b8e

    const/high16 v2, 0x200000

    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2

    if-eqz v2, :cond_b8e

    .line 23312
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v2

    if-eqz v2, :cond_b8b

    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23313
    :cond_b8b
    invoke-direct {v1, v9, v13}, Lcom/android/server/pm/PackageManagerService;->dumpCompilerStatsLPr(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 23316
    :cond_b8e
    if-nez v12, :cond_bb4

    const/16 v2, 0x200

    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v3

    if-eqz v3, :cond_bb4

    if-nez v13, :cond_bb4

    .line 23317
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v2

    if-eqz v2, :cond_ba3

    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23318
    :cond_ba3
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v9, v11}, Lcom/android/server/pm/Settings;->dumpReadMessagesLPr(Ljava/io/PrintWriter;Lcom/android/server/pm/DumpState;)V

    .line 23320
    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23321
    const-string v2, "Package warning messages:"

    invoke-virtual {v9, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 23322
    const/4 v2, 0x0

    invoke-static {v9, v2}, Lcom/android/server/pm/PackageManagerServiceUtils;->dumpCriticalInfo(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 23325
    :cond_bb4
    if-eqz v12, :cond_bc4

    const/16 v2, 0x200

    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2

    if-eqz v2, :cond_bc4

    .line 23326
    const-string/jumbo v2, "msg,"

    invoke-static {v9, v2}, Lcom/android/server/pm/PackageManagerServiceUtils;->dumpCriticalInfo(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 23328
    .end local v15  # "isCtsRunning":Z
    :cond_bc4
    monitor-exit v19
    :try_end_bc5
    .catchall {:try_start_7fc .. :try_end_bc5} :catchall_bfe

    .line 23331
    if-nez v12, :cond_be6

    const/high16 v2, 0x10000

    invoke-virtual {v11, v2}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v2

    if-eqz v2, :cond_be6

    if-nez v13, :cond_be6

    .line 23334
    invoke-virtual {v11}, Lcom/android/server/pm/DumpState;->onTitlePrinted()Z

    move-result v2

    if-eqz v2, :cond_bda

    invoke-virtual/range {p2 .. p2}, Ljava/io/PrintWriter;->println()V

    .line 23335
    :cond_bda
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mInstallerService:Lcom/android/server/pm/PackageInstallerService;

    new-instance v3, Lcom/android/internal/util/IndentingPrintWriter;

    const-string v4, "  "

    invoke-direct {v3, v9, v4, v0}, Lcom/android/internal/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;I)V

    invoke-virtual {v2, v3}, Lcom/android/server/pm/PackageInstallerService;->dump(Lcom/android/internal/util/IndentingPrintWriter;)V

    .line 23338
    :cond_be6
    if-nez v12, :cond_bf5

    const/high16 v0, 0x2000000

    invoke-virtual {v11, v0}, Lcom/android/server/pm/DumpState;->isDumping(I)Z

    move-result v0

    if-eqz v0, :cond_bf5

    .line 23339
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    invoke-virtual {v0, v9, v13}, Lcom/android/server/pm/ApexManager;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 23341
    :cond_bf5
    return-void

    .line 23328
    .end local v10  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .restart local v8  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    :catchall_bf6
    move-exception v0

    move-object/from16 v19, v5

    move-object v10, v8

    move-object/from16 v8, p1

    .end local v8  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .restart local v10  # "permissionNames":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    :goto_bfc
    :try_start_bfc
    monitor-exit v19
    :try_end_bfd
    .catchall {:try_start_bfc .. :try_end_bfd} :catchall_bfe

    throw v0

    :catchall_bfe
    move-exception v0

    goto :goto_bfc
.end method

.method public dumpProfiles(Ljava/lang/String;)V
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;

    .line 10698
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 10699
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 10700
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v1, :cond_3f

    .line 10703
    monitor-exit v0
    :try_end_e
    .catchall {:try_start_3 .. :try_end_e} :catchall_56

    .line 10705
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    .line 10706
    .local v2, "callingUid":I
    const/16 v0, 0x7d0

    if-eq v2, v0, :cond_27

    if-eqz v2, :cond_27

    iget-object v0, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v2, v0, :cond_1f

    goto :goto_27

    .line 10709
    :cond_1f
    new-instance v0, Ljava/lang/SecurityException;

    const-string v3, "dumpProfiles"

    invoke-direct {v0, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 10712
    :cond_27
    :goto_27
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v3

    .line 10713
    :try_start_2a
    const-string v0, "dump profiles"

    const-wide/32 v4, 0x40000

    invoke-static {v4, v5, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 10714
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mArtManagerService:Lcom/android/server/pm/dex/ArtManagerService;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/dex/ArtManagerService;->dumpProfiles(Landroid/content/pm/PackageParser$Package;)V

    .line 10715
    invoke-static {v4, v5}, Landroid/os/Trace;->traceEnd(J)V

    .line 10716
    monitor-exit v3

    .line 10717
    return-void

    .line 10716
    :catchall_3c
    move-exception v0

    monitor-exit v3
    :try_end_3e
    .catchall {:try_start_2a .. :try_end_3e} :catchall_3c

    throw v0

    .line 10701
    .end local v2  # "callingUid":I
    :cond_3f
    :try_start_3f
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unknown package: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    throw v2

    .line 10703
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    :catchall_56
    move-exception v1

    monitor-exit v0
    :try_end_58
    .catchall {:try_start_3f .. :try_end_58} :catchall_56

    throw v1
.end method

.method public enterSafeMode()V
    .registers 2

    .line 22551
    const-string v0, "Only the system can request entering safe mode"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrRoot(Ljava/lang/String;)V

    .line 22553
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mSystemReady:Z

    if-nez v0, :cond_c

    .line 22554
    const/4 v0, 0x1

    iput-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mSafeMode:Z

    .line 22556
    :cond_c
    return-void
.end method

.method public extendVerificationTimeout(IIJ)V
    .registers 9
    .param p1, "id"  # I
    .param p2, "verificationCodeAtTimeout"  # I
    .param p3, "millisecondsToDelay"  # J

    .line 14658
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.PACKAGE_VERIFICATION_AGENT"

    const-string v2, "Only package verification agents can extend verification timeouts"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 14662
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPendingVerification:Landroid/util/SparseArray;

    invoke-virtual {v0, p1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageVerificationState;

    .line 14663
    .local v0, "state":Lcom/android/server/pm/PackageVerificationState;
    new-instance v1, Lcom/android/server/pm/PackageVerificationResponse;

    .line 14664
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-direct {v1, p2, v2}, Lcom/android/server/pm/PackageVerificationResponse;-><init>(II)V

    .line 14666
    .local v1, "response":Lcom/android/server/pm/PackageVerificationResponse;
    const-wide/32 v2, 0x36ee80

    cmp-long v2, p3, v2

    if-lez v2, :cond_24

    .line 14667
    const-wide/32 p3, 0x36ee80

    .line 14669
    :cond_24
    const-wide/16 v2, 0x0

    cmp-long v2, p3, v2

    if-gez v2, :cond_2c

    .line 14670
    const-wide/16 p3, 0x0

    .line 14672
    :cond_2c
    const/4 v2, 0x1

    if-eq p2, v2, :cond_33

    const/4 v2, -0x1

    if-eq p2, v2, :cond_33

    .line 14674
    const/4 p2, -0x1

    .line 14677
    :cond_33
    if-eqz v0, :cond_4f

    invoke-virtual {v0}, Lcom/android/server/pm/PackageVerificationState;->timeoutExtended()Z

    move-result v2

    if-nez v2, :cond_4f

    .line 14678
    invoke-virtual {v0}, Lcom/android/server/pm/PackageVerificationState;->extendTimeout()V

    .line 14680
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v3, 0xf

    invoke-virtual {v2, v3}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v2

    .line 14681
    .local v2, "msg":Landroid/os/Message;
    iput p1, v2, Landroid/os/Message;->arg1:I

    .line 14682
    iput-object v1, v2, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 14683
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v3, v2, p3, p4}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 14685
    .end local v2  # "msg":Landroid/os/Message;
    :cond_4f
    return-void
.end method

.method extrasForInstallResult(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;)Landroid/os/Bundle;
    .registers 5
    .param p1, "res"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    .line 2348
    const/4 v0, 0x0

    .line 2349
    .local v0, "extras":Landroid/os/Bundle;
    iget v1, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    const/16 v2, -0x70

    if-eq v1, v2, :cond_23

    const/4 v2, 0x1

    if-eq v1, v2, :cond_b

    goto :goto_38

    .line 2359
    :cond_b
    new-instance v1, Landroid/os/Bundle;

    invoke-direct {v1}, Landroid/os/Bundle;-><init>()V

    move-object v0, v1

    .line 2360
    iget-object v1, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    if-eqz v1, :cond_1c

    iget-object v1, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->removedInfo:Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;

    iget-object v1, v1, Lcom/android/server/pm/PackageManagerService$PackageRemovedInfo;->removedPackage:Ljava/lang/String;

    if-eqz v1, :cond_1c

    goto :goto_1d

    :cond_1c
    const/4 v2, 0x0

    :goto_1d
    const-string v1, "android.intent.extra.REPLACING"

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putBoolean(Ljava/lang/String;Z)V

    goto :goto_38

    .line 2351
    :cond_23
    new-instance v1, Landroid/os/Bundle;

    invoke-direct {v1}, Landroid/os/Bundle;-><init>()V

    move-object v0, v1

    .line 2352
    iget-object v1, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origPermission:Ljava/lang/String;

    const-string v2, "android.content.pm.extra.FAILURE_EXISTING_PERMISSION"

    invoke-virtual {v0, v2, v1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 2354
    iget-object v1, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->origPackage:Ljava/lang/String;

    const-string v2, "android.content.pm.extra.FAILURE_EXISTING_PACKAGE"

    invoke-virtual {v0, v2, v1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 2356
    nop

    .line 2365
    :goto_38
    return-object v0
.end method

.method public findPersistentPreferredActivity(Landroid/content/Intent;I)Landroid/content/pm/ResolveInfo;
    .registers 16
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "userId"  # I

    .line 6875
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    const/16 v1, 0x3e8

    invoke-static {v0, v1}, Landroid/os/UserHandle;->isSameApp(II)Z

    move-result v0

    if-eqz v0, :cond_49

    .line 6879
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p2}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_16

    .line 6880
    const/4 v0, 0x0

    return-object v0

    .line 6882
    :cond_16
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 6883
    .local v0, "callingUid":I
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->updateIntentForResolve(Landroid/content/Intent;)Landroid/content/Intent;

    move-result-object v8

    .line 6884
    .end local p1  # "intent":Landroid/content/Intent;
    .local v8, "intent":Landroid/content/Intent;
    iget-object p1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object p1

    invoke-virtual {v8, p1}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;

    move-result-object v9

    .line 6885
    .local v9, "resolvedType":Ljava/lang/String;
    const/4 v2, 0x0

    const/4 v6, 0x0

    move-object v1, p0

    move v3, p2

    move-object v4, v8

    move v5, v0

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZ)I

    move-result v10

    .line 6887
    .local v10, "flags":I
    invoke-direct {p0, v8, v9, v10, p2}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v11

    .line 6889
    .local v11, "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    iget-object v12, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v12

    .line 6890
    const/4 v6, 0x0

    move-object v1, p0

    move-object v2, v8

    move-object v3, v9

    move v4, v10

    move-object v5, v11

    move v7, p2

    :try_start_40
    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->findPersistentPreferredActivityLP(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;ZI)Landroid/content/pm/ResolveInfo;

    move-result-object p1

    monitor-exit v12

    return-object p1

    .line 6892
    :catchall_46
    move-exception p1

    monitor-exit v12
    :try_end_48
    .catchall {:try_start_40 .. :try_end_48} :catchall_46

    throw p1

    .line 6876
    .end local v0  # "callingUid":I
    .end local v8  # "intent":Landroid/content/Intent;
    .end local v9  # "resolvedType":Ljava/lang/String;
    .end local v10  # "flags":I
    .end local v11  # "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local p1  # "intent":Landroid/content/Intent;
    :cond_49
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "findPersistentPreferredActivity can only be run by the system"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method findPreferredActivityNotLocked(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;IZZZI)Landroid/content/pm/ResolveInfo;
    .registers 41
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p5, "priority"  # I
    .param p6, "always"  # Z
    .param p7, "removeMatches"  # Z
    .param p8, "debug"  # Z
    .param p9, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "I",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;IZZZI)",
            "Landroid/content/pm/ResolveInfo;"
        }
    .end annotation

    .line 7207
    .local p4, "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    move-object/from16 v8, p0

    move-object/from16 v9, p2

    move-object/from16 v10, p4

    move/from16 v11, p9

    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-static {v0}, Ljava/lang/Thread;->holdsLock(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_38

    .line 7208
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Calling thread "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-static {}, Ljava/lang/Thread;->currentThread()Ljava/lang/Thread;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/Thread;->getName()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " is holding mPackages"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    new-instance v1, Ljava/lang/Throwable;

    invoke-direct {v1}, Ljava/lang/Throwable;-><init>()V

    const-string v2, "PackageManager"

    invoke-static {v2, v0, v1}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 7211
    :cond_38
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v11}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v12, 0x0

    if-nez v0, :cond_42

    return-object v12

    .line 7212
    :cond_42
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v13

    .line 7215
    .local v13, "callingUid":I
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 7216
    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const/4 v14, 0x0

    const-string v1, "device_provisioned"

    invoke-static {v0, v1, v14}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v0

    const/4 v15, 0x1

    if-ne v0, v15, :cond_58

    move v0, v15

    goto :goto_59

    :cond_58
    move v0, v14

    :goto_59
    move/from16 v16, v0

    .line 7218
    .local v16, "isDeviceProvisioned":Z
    const/4 v6, 0x0

    move-object/from16 v1, p0

    move/from16 v2, p3

    move/from16 v3, p9

    move-object/from16 v4, p1

    move v5, v13

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZ)I

    move-result v7

    .line 7220
    .end local p3  # "flags":I
    .local v7, "flags":I
    invoke-direct/range {p0 .. p1}, Lcom/android/server/pm/PackageManagerService;->updateIntentForResolve(Landroid/content/Intent;)Landroid/content/Intent;

    move-result-object v6

    .line 7222
    .end local p1  # "intent":Landroid/content/Intent;
    .local v6, "intent":Landroid/content/Intent;
    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 7224
    move-object/from16 v1, p0

    move-object v2, v6

    move-object/from16 v3, p2

    move v4, v7

    move-object/from16 v17, v5

    move-object/from16 v5, p4

    move-object v15, v6

    .end local v6  # "intent":Landroid/content/Intent;
    .local v15, "intent":Landroid/content/Intent;
    move/from16 v6, p8

    move v12, v7

    .end local v7  # "flags":I
    .local v12, "flags":I
    move/from16 v7, p9

    :try_start_80
    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->findPersistentPreferredActivityLP(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;ZI)Landroid/content/pm/ResolveInfo;

    move-result-object v1
    :try_end_84
    .catchall {:try_start_80 .. :try_end_84} :catchall_48b

    .line 7228
    .local v1, "pri":Landroid/content/pm/ResolveInfo;
    if-eqz v1, :cond_8d

    .line 7229
    :try_start_86
    monitor-exit v17
    :try_end_87
    .catchall {:try_start_86 .. :try_end_87} :catchall_88

    return-object v1

    .line 7401
    .end local v1  # "pri":Landroid/content/pm/ResolveInfo;
    :catchall_88
    move-exception v0

    move/from16 v18, v13

    goto/16 :goto_48e

    .line 7232
    .restart local v1  # "pri":Landroid/content/pm/ResolveInfo;
    :cond_8d
    :try_start_8d
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v2, v11}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PreferredIntentResolver;

    .line 7234
    .local v2, "pir":Lcom/android/server/pm/PreferredIntentResolver;
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v3, :cond_9d

    if-eqz p8, :cond_a4

    :cond_9d
    const-string v3, "PackageManager"

    const-string v4, "Looking for preferred activities..."

    invoke-static {v3, v4}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_a4
    .catchall {:try_start_8d .. :try_end_a4} :catchall_48b

    .line 7235
    :cond_a4
    if-eqz v2, :cond_b3

    .line 7236
    const/high16 v3, 0x10000

    and-int/2addr v3, v12

    if-eqz v3, :cond_ad

    const/4 v3, 0x1

    goto :goto_ae

    :cond_ad
    move v3, v14

    :goto_ae
    :try_start_ae
    invoke-virtual {v2, v15, v9, v3, v11}, Lcom/android/server/pm/PreferredIntentResolver;->queryIntent(Landroid/content/Intent;Ljava/lang/String;ZI)Ljava/util/List;

    move-result-object v3
    :try_end_b2
    .catchall {:try_start_ae .. :try_end_b2} :catchall_88

    goto :goto_b4

    .line 7239
    :cond_b3
    const/4 v3, 0x0

    :goto_b4
    nop

    .line 7240
    .local v3, "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    if-eqz v3, :cond_475

    :try_start_b7
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v4
    :try_end_bb
    .catchall {:try_start_b7 .. :try_end_bb} :catchall_48b

    if-lez v4, :cond_475

    .line 7241
    const/4 v4, 0x0

    .line 7246
    .local v4, "changed":Z
    const/4 v5, 0x0

    .line 7248
    .local v5, "match":I
    :try_start_bf
    sget-boolean v6, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v6, :cond_c5

    if-eqz p8, :cond_cc

    :cond_c5
    const-string v6, "PackageManager"

    const-string v7, "Figuring out best match..."

    invoke-static {v6, v7}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7250
    :cond_cc
    invoke-interface/range {p4 .. p4}, Ljava/util/List;->size()I

    move-result v6
    :try_end_d0
    .catchall {:try_start_bf .. :try_end_d0} :catchall_458

    .line 7251
    .local v6, "N":I
    const/4 v7, 0x0

    .local v7, "j":I
    :goto_d1
    if-ge v7, v6, :cond_143

    .line 7252
    :try_start_d3
    invoke-interface {v10, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v18

    check-cast v18, Landroid/content/pm/ResolveInfo;

    move-object/from16 p1, v18

    .line 7253
    .local p1, "ri":Landroid/content/pm/ResolveInfo;
    sget-boolean v18, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v18, :cond_e9

    if-eqz p8, :cond_e2

    goto :goto_e9

    :cond_e2
    move-object/from16 v19, v1

    move-object/from16 v1, p1

    move/from16 p1, v4

    goto :goto_113

    :cond_e9
    :goto_e9
    const-string v0, "PackageManager"

    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V
    :try_end_f0
    .catchall {:try_start_d3 .. :try_end_f0} :catchall_136

    move-object/from16 v19, v1

    .end local v1  # "pri":Landroid/content/pm/ResolveInfo;
    .local v19, "pri":Landroid/content/pm/ResolveInfo;
    :try_start_f2
    const-string v1, "Match for "

    invoke-virtual {v14, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    :try_end_f7
    .catchall {:try_start_f2 .. :try_end_f7} :catchall_12b

    move-object/from16 v1, p1

    move/from16 p1, v4

    .end local v4  # "changed":Z
    .local v1, "ri":Landroid/content/pm/ResolveInfo;
    .local p1, "changed":Z
    :try_start_fb
    iget-object v4, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    invoke-virtual {v14, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v4, ": 0x"

    invoke-virtual {v14, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 7254
    invoke-static {v5}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v14, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    .line 7253
    invoke-static {v0, v4}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7255
    :goto_113
    iget v0, v1, Landroid/content/pm/ResolveInfo;->match:I

    if-le v0, v5, :cond_11a

    .line 7256
    iget v0, v1, Landroid/content/pm/ResolveInfo;->match:I
    :try_end_119
    .catchall {:try_start_fb .. :try_end_119} :catchall_122

    move v5, v0

    .line 7251
    .end local v1  # "ri":Landroid/content/pm/ResolveInfo;
    :cond_11a
    add-int/lit8 v7, v7, 0x1

    move/from16 v4, p1

    move-object/from16 v1, v19

    const/4 v14, 0x0

    goto :goto_d1

    .line 7393
    .end local v5  # "match":I
    .end local v6  # "N":I
    .end local v7  # "j":I
    :catchall_122
    move-exception v0

    move/from16 v5, p1

    move-object/from16 v27, v3

    move/from16 v18, v13

    goto/16 :goto_463

    .end local p1  # "changed":Z
    .restart local v4  # "changed":Z
    :catchall_12b
    move-exception v0

    move/from16 p1, v4

    move/from16 v5, p1

    move-object/from16 v27, v3

    move/from16 v18, v13

    .end local v4  # "changed":Z
    .restart local p1  # "changed":Z
    goto/16 :goto_463

    .end local v19  # "pri":Landroid/content/pm/ResolveInfo;
    .end local p1  # "changed":Z
    .local v1, "pri":Landroid/content/pm/ResolveInfo;
    .restart local v4  # "changed":Z
    :catchall_136
    move-exception v0

    move-object/from16 v19, v1

    move/from16 p1, v4

    move/from16 v5, p1

    move-object/from16 v27, v3

    move/from16 v18, v13

    .end local v1  # "pri":Landroid/content/pm/ResolveInfo;
    .end local v4  # "changed":Z
    .restart local v19  # "pri":Landroid/content/pm/ResolveInfo;
    .restart local p1  # "changed":Z
    goto/16 :goto_463

    .line 7251
    .end local v19  # "pri":Landroid/content/pm/ResolveInfo;
    .end local p1  # "changed":Z
    .restart local v1  # "pri":Landroid/content/pm/ResolveInfo;
    .restart local v4  # "changed":Z
    .restart local v5  # "match":I
    .restart local v6  # "N":I
    .restart local v7  # "j":I
    :cond_143
    move-object/from16 v19, v1

    move/from16 p1, v4

    .line 7260
    .end local v1  # "pri":Landroid/content/pm/ResolveInfo;
    .end local v4  # "changed":Z
    .end local v7  # "j":I
    .restart local v19  # "pri":Landroid/content/pm/ResolveInfo;
    .restart local p1  # "changed":Z
    :try_start_147
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v0, :cond_14d

    if-eqz p8, :cond_167

    :cond_14d
    const-string v0, "PackageManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Best match: 0x"

    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 7261
    invoke-static {v5}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 7260
    invoke-static {v0, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7263
    :cond_167
    const/high16 v0, 0xfff0000

    and-int/2addr v0, v5

    .line 7264
    .end local v5  # "match":I
    .local v0, "match":I
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v1
    :try_end_16e
    .catchall {:try_start_147 .. :try_end_16e} :catchall_450

    .line 7265
    .local v1, "M":I
    const/4 v4, 0x0

    move/from16 v5, p1

    .end local p1  # "changed":Z
    .local v4, "i":I
    .local v5, "changed":Z
    :goto_171
    if-ge v4, v1, :cond_435

    .line 7266
    :try_start_173
    invoke-interface {v3, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PreferredActivity;

    .line 7267
    .local v7, "pa":Lcom/android/server/pm/PreferredActivity;
    sget-boolean v14, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    move/from16 v26, v1

    .end local v1  # "M":I
    .local v26, "M":I
    if-nez v14, :cond_187

    if-eqz p8, :cond_182

    goto :goto_187

    :cond_182
    move-object/from16 v27, v3

    move/from16 v18, v13

    goto :goto_1d1

    .line 7268
    :cond_187
    :goto_187
    const-string v14, "PackageManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
    :try_end_18e
    .catchall {:try_start_173 .. :try_end_18e} :catchall_42f

    move-object/from16 v27, v3

    .end local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .local v27, "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    :try_start_190
    const-string v3, "Checking PreferredActivity ds="

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 7269
    invoke-virtual {v7}, Lcom/android/server/pm/PreferredActivity;->countDataSchemes()I

    move-result v3
    :try_end_199
    .catchall {:try_start_190 .. :try_end_199} :catchall_42b

    if-lez v3, :cond_1a6

    const/4 v3, 0x0

    :try_start_19c
    invoke-virtual {v7, v3}, Lcom/android/server/pm/PreferredActivity;->getDataScheme(I)Ljava/lang/String;

    move-result-object v18
    :try_end_1a0
    .catchall {:try_start_19c .. :try_end_1a0} :catchall_1a1

    goto :goto_1a9

    .line 7393
    .end local v0  # "match":I
    .end local v4  # "i":I
    .end local v6  # "N":I
    .end local v7  # "pa":Lcom/android/server/pm/PreferredActivity;
    .end local v26  # "M":I
    :catchall_1a1
    move-exception v0

    move/from16 v18, v13

    goto/16 :goto_463

    .line 7269
    .restart local v0  # "match":I
    .restart local v4  # "i":I
    .restart local v6  # "N":I
    .restart local v7  # "pa":Lcom/android/server/pm/PreferredActivity;
    .restart local v26  # "M":I
    :cond_1a6
    const/4 v3, 0x0

    :try_start_1a7
    const-string v18, "<none>"

    :goto_1a9
    move-object/from16 v3, v18

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, "\n  component="

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v3, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v3, v3, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 7268
    invoke-static {v14, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7271
    new-instance v1, Landroid/util/LogPrinter;

    const-string v3, "PackageManager"
    :try_end_1c5
    .catchall {:try_start_1a7 .. :try_end_1c5} :catchall_42b

    move/from16 v18, v13

    const/4 v13, 0x2

    const/4 v14, 0x3

    .end local v13  # "callingUid":I
    .local v18, "callingUid":I
    :try_start_1c9
    invoke-direct {v1, v13, v3, v14}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;I)V

    const-string v3, "  "

    invoke-virtual {v7, v1, v3}, Lcom/android/server/pm/PreferredActivity;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 7273
    :goto_1d1
    iget-object v1, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget v1, v1, Lcom/android/server/pm/PreferredComponent;->mMatch:I

    if-eq v1, v0, :cond_203

    .line 7274
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v1, :cond_1e4

    if-eqz p8, :cond_1de

    goto :goto_1e4

    :cond_1de
    :goto_1de
    move/from16 v28, v0

    move/from16 v29, v6

    goto/16 :goto_41b

    :cond_1e4
    :goto_1e4
    const-string v1, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Skipping bad match "

    invoke-virtual {v3, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget v13, v13, Lcom/android/server/pm/PreferredComponent;->mMatch:I

    .line 7275
    invoke-static {v13}, Ljava/lang/Integer;->toHexString(I)Ljava/lang/String;

    move-result-object v13

    invoke-virtual {v3, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 7274
    invoke-static {v1, v3}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_1de

    .line 7280
    :cond_203
    if-eqz p6, :cond_220

    iget-object v1, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-boolean v1, v1, Lcom/android/server/pm/PreferredComponent;->mAlways:Z

    if-nez v1, :cond_220

    .line 7281
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v1, :cond_218

    if-eqz p8, :cond_212

    goto :goto_218

    :cond_212
    :goto_212
    move/from16 v28, v0

    move/from16 v29, v6

    goto/16 :goto_41b

    :cond_218
    :goto_218
    const-string v1, "PackageManager"

    const-string v3, "Skipping mAlways=false entry"

    invoke-static {v1, v3}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_212

    .line 7284
    :cond_220
    iget-object v1, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v1, v1, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    or-int/lit16 v3, v12, 0x200

    const/high16 v13, 0x80000

    or-int/2addr v3, v13

    const/high16 v13, 0x40000

    or-int/2addr v3, v13

    invoke-virtual {v8, v1, v3, v11}, Lcom/android/server/pm/PackageManagerService;->getActivityInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ActivityInfo;

    move-result-object v1

    .line 7288
    .local v1, "ai":Landroid/content/pm/ActivityInfo;
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v3, :cond_23a

    if-eqz p8, :cond_237

    goto :goto_23a

    :cond_237
    move/from16 v28, v0

    goto :goto_25d

    .line 7289
    :cond_23a
    :goto_23a
    const-string v3, "PackageManager"

    const-string v13, "Found preferred activity:"

    invoke-static {v3, v13}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7290
    if-eqz v1, :cond_254

    .line 7291
    new-instance v3, Landroid/util/LogPrinter;

    const-string v13, "PackageManager"

    move/from16 v28, v0

    const/4 v0, 0x2

    const/4 v14, 0x3

    .end local v0  # "match":I
    .local v28, "match":I
    invoke-direct {v3, v0, v13, v14}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;I)V

    const-string v0, "  "

    invoke-virtual {v1, v3, v0}, Landroid/content/pm/ActivityInfo;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    goto :goto_25d

    .line 7293
    .end local v28  # "match":I
    .restart local v0  # "match":I
    :cond_254
    move/from16 v28, v0

    .end local v0  # "match":I
    .restart local v28  # "match":I
    const-string v0, "PackageManager"

    const-string v3, "  null"

    invoke-static {v0, v3}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7296
    :goto_25d
    invoke-direct {v8, v15}, Lcom/android/server/pm/PackageManagerService;->isHomeIntent(Landroid/content/Intent;)Z

    move-result v0

    if-eqz v0, :cond_267

    if-nez v16, :cond_267

    const/4 v0, 0x1

    goto :goto_268

    :cond_267
    const/4 v0, 0x0

    .line 7298
    .local v0, "excludeSetupWizardHomeActivity":Z
    :goto_268
    if-nez v1, :cond_293

    .line 7301
    if-eqz v0, :cond_270

    .line 7302
    move/from16 v29, v6

    goto/16 :goto_41b

    .line 7310
    :cond_270
    const-string v3, "PackageManager"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Removing dangling preferred activity: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v14, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v14, v14, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-static {v3, v13}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 7312
    invoke-virtual {v2, v7}, Lcom/android/server/pm/PreferredIntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 7313
    const/4 v3, 0x1

    .line 7314
    .end local v5  # "changed":Z
    .local v3, "changed":Z
    move v5, v3

    move/from16 v29, v6

    goto/16 :goto_41b

    .line 7316
    .end local v3  # "changed":Z
    .restart local v5  # "changed":Z
    :cond_293
    const/4 v3, 0x0

    .local v3, "j":I
    :goto_294
    if-ge v3, v6, :cond_415

    .line 7317
    invoke-interface {v10, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Landroid/content/pm/ResolveInfo;

    .line 7318
    .local v13, "ri":Landroid/content/pm/ResolveInfo;
    iget-object v14, v13, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v14, v14, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v14, v14, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move/from16 v29, v6

    .end local v6  # "N":I
    .local v29, "N":I
    iget-object v6, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    .line 7319
    invoke-virtual {v14, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_2af

    .line 7320
    goto :goto_2bc

    .line 7322
    :cond_2af
    iget-object v6, v13, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    iget-object v14, v1, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v6, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_2c1

    .line 7323
    nop

    .line 7316
    .end local v13  # "ri":Landroid/content/pm/ResolveInfo;
    :goto_2bc
    add-int/lit8 v3, v3, 0x1

    move/from16 v6, v29

    goto :goto_294

    .line 7326
    .restart local v13  # "ri":Landroid/content/pm/ResolveInfo;
    :cond_2c1
    if-eqz p7, :cond_2ed

    .line 7327
    invoke-virtual {v2, v7}, Lcom/android/server/pm/PreferredIntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 7328
    const/4 v5, 0x1

    .line 7329
    sget-boolean v6, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v6, :cond_2e9

    .line 7330
    const-string v6, "PackageManager"

    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 p1, v1

    .end local v1  # "ai":Landroid/content/pm/ActivityInfo;
    .local p1, "ai":Landroid/content/pm/ActivityInfo;
    const-string v1, "Removing match "

    invoke-virtual {v14, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v1, v1, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v14, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v6, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    goto/16 :goto_41b

    .line 7329
    .end local p1  # "ai":Landroid/content/pm/ActivityInfo;
    .restart local v1  # "ai":Landroid/content/pm/ActivityInfo;
    :cond_2e9
    move-object/from16 p1, v1

    .end local v1  # "ai":Landroid/content/pm/ActivityInfo;
    .restart local p1  # "ai":Landroid/content/pm/ActivityInfo;
    goto/16 :goto_41b

    .line 7341
    .end local p1  # "ai":Landroid/content/pm/ActivityInfo;
    .restart local v1  # "ai":Landroid/content/pm/ActivityInfo;
    :cond_2ed
    move-object/from16 p1, v1

    .end local v1  # "ai":Landroid/content/pm/ActivityInfo;
    .restart local p1  # "ai":Landroid/content/pm/ActivityInfo;
    if-eqz p6, :cond_3d4

    iget-object v1, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    invoke-virtual {v1, v10, v0}, Lcom/android/server/pm/PreferredComponent;->sameSet(Ljava/util/List;Z)Z

    move-result v1

    if-nez v1, :cond_3d4

    .line 7342
    iget-object v1, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    invoke-virtual {v1, v10, v0}, Lcom/android/server/pm/PreferredComponent;->isSuperset(Ljava/util/List;Z)Z

    move-result v1

    if-eqz v1, :cond_362

    .line 7343
    if-nez v0, :cond_353

    .line 7346
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v1, :cond_325

    .line 7347
    const-string v1, "PackageManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Result set changed, but PreferredActivity is still valid as only non-preferred components were removed for "

    invoke-virtual {v6, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v14, " type "

    invoke-virtual {v6, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v1, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 7354
    :cond_325
    new-instance v1, Lcom/android/server/pm/PreferredActivity;

    iget-object v6, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget v6, v6, Lcom/android/server/pm/PreferredComponent;->mMatch:I

    iget-object v14, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    .line 7356
    invoke-virtual {v14, v10}, Lcom/android/server/pm/PreferredComponent;->discardObsoleteComponents(Ljava/util/List;)[Landroid/content/ComponentName;

    move-result-object v23

    iget-object v14, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v14, v14, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    move/from16 v30, v0

    .end local v0  # "excludeSetupWizardHomeActivity":Z
    .local v30, "excludeSetupWizardHomeActivity":Z
    iget-object v0, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-boolean v0, v0, Lcom/android/server/pm/PreferredComponent;->mAlways:Z

    move-object/from16 v20, v1

    move-object/from16 v21, v7

    move/from16 v22, v6

    move-object/from16 v24, v14

    move/from16 v25, v0

    invoke-direct/range {v20 .. v25}, Lcom/android/server/pm/PreferredActivity;-><init>(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;Z)V

    move-object v0, v1

    .line 7359
    .local v0, "freshPa":Lcom/android/server/pm/PreferredActivity;
    invoke-virtual {v2, v7}, Lcom/android/server/pm/PreferredIntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 7360
    invoke-virtual {v2, v0}, Lcom/android/server/pm/PreferredIntentResolver;->addFilter(Landroid/content/IntentFilter;)V

    .line 7361
    const/4 v0, 0x1

    .line 7362
    .end local v5  # "changed":Z
    .local v0, "changed":Z
    move v5, v0

    goto/16 :goto_3d6

    .line 7363
    .end local v30  # "excludeSetupWizardHomeActivity":Z
    .local v0, "excludeSetupWizardHomeActivity":Z
    .restart local v5  # "changed":Z
    :cond_353
    move/from16 v30, v0

    .end local v0  # "excludeSetupWizardHomeActivity":Z
    .restart local v30  # "excludeSetupWizardHomeActivity":Z
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v0, :cond_3d6

    .line 7364
    const-string v0, "PackageManager"

    const-string v1, "Do not remove preferred activity for launcher during SetupWizard"

    invoke-static {v0, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    goto/16 :goto_3d6

    .line 7369
    .end local v30  # "excludeSetupWizardHomeActivity":Z
    .restart local v0  # "excludeSetupWizardHomeActivity":Z
    :cond_362
    move/from16 v30, v0

    .end local v0  # "excludeSetupWizardHomeActivity":Z
    .restart local v30  # "excludeSetupWizardHomeActivity":Z
    const-string v0, "PackageManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Result set changed, dropping preferred activity for "

    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v6, " type "

    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 7372
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v0, :cond_3a0

    .line 7373
    const-string v0, "PackageManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Removing preferred activity since set changed "

    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v6, v6, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7376
    :cond_3a0
    invoke-virtual {v2, v7}, Lcom/android/server/pm/PreferredIntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 7378
    new-instance v0, Lcom/android/server/pm/PreferredActivity;

    iget-object v1, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget v1, v1, Lcom/android/server/pm/PreferredComponent;->mMatch:I

    const/16 v23, 0x0

    iget-object v6, v7, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v6, v6, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    const/16 v25, 0x0

    move-object/from16 v20, v0

    move-object/from16 v21, v7

    move/from16 v22, v1

    move-object/from16 v24, v6

    invoke-direct/range {v20 .. v25}, Lcom/android/server/pm/PreferredActivity;-><init>(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;Z)V

    .line 7380
    .local v0, "lastChosen":Lcom/android/server/pm/PreferredActivity;
    invoke-virtual {v2, v0}, Lcom/android/server/pm/PreferredIntentResolver;->addFilter(Landroid/content/IntentFilter;)V
    :try_end_3bf
    .catchall {:try_start_1c9 .. :try_end_3bf} :catchall_429

    .line 7381
    const/4 v1, 0x1

    .line 7382
    .end local v5  # "changed":Z
    .local v1, "changed":Z
    nop

    .line 7393
    if-eqz v1, :cond_3d1

    .line 7394
    :try_start_3c3
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v5, :cond_3ce

    .line 7395
    const-string v5, "PackageManager"

    const-string v6, "Preferred activity bookkeeping changed; writing restrictions"

    invoke-static {v5, v6}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7397
    :cond_3ce
    invoke-virtual {v8, v11}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    :cond_3d1
    monitor-exit v17
    :try_end_3d2
    .catchall {:try_start_3c3 .. :try_end_3d2} :catchall_490

    .line 7382
    const/4 v5, 0x0

    return-object v5

    .line 7341
    .end local v1  # "changed":Z
    .end local v30  # "excludeSetupWizardHomeActivity":Z
    .local v0, "excludeSetupWizardHomeActivity":Z
    .restart local v5  # "changed":Z
    :cond_3d4
    move/from16 v30, v0

    .line 7387
    .end local v0  # "excludeSetupWizardHomeActivity":Z
    .restart local v30  # "excludeSetupWizardHomeActivity":Z
    :cond_3d6
    :goto_3d6
    :try_start_3d6
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v0, :cond_3dc

    if-eqz p8, :cond_402

    :cond_3dc
    const-string v0, "PackageManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Returning preferred activity: "

    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v13, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, "/"

    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v13, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_402
    .catchall {:try_start_3d6 .. :try_end_402} :catchall_429

    .line 7389
    :cond_402
    nop

    .line 7393
    if-eqz v5, :cond_413

    .line 7394
    :try_start_405
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v0, :cond_410

    .line 7395
    const-string v0, "PackageManager"

    const-string v1, "Preferred activity bookkeeping changed; writing restrictions"

    invoke-static {v0, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7397
    :cond_410
    invoke-virtual {v8, v11}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    :cond_413
    monitor-exit v17

    .line 7389
    return-object v13

    .line 7316
    .end local v13  # "ri":Landroid/content/pm/ResolveInfo;
    .end local v29  # "N":I
    .end local v30  # "excludeSetupWizardHomeActivity":Z
    .end local p1  # "ai":Landroid/content/pm/ActivityInfo;
    .restart local v0  # "excludeSetupWizardHomeActivity":Z
    .local v1, "ai":Landroid/content/pm/ActivityInfo;
    .restart local v6  # "N":I
    :cond_415
    move/from16 v30, v0

    move-object/from16 p1, v1

    move/from16 v29, v6

    .line 7265
    .end local v0  # "excludeSetupWizardHomeActivity":Z
    .end local v1  # "ai":Landroid/content/pm/ActivityInfo;
    .end local v3  # "j":I
    .end local v6  # "N":I
    .end local v7  # "pa":Lcom/android/server/pm/PreferredActivity;
    .restart local v29  # "N":I
    :goto_41b
    add-int/lit8 v4, v4, 0x1

    move/from16 v13, v18

    move/from16 v1, v26

    move-object/from16 v3, v27

    move/from16 v0, v28

    move/from16 v6, v29

    goto/16 :goto_171

    .line 7393
    .end local v4  # "i":I
    .end local v26  # "M":I
    .end local v28  # "match":I
    .end local v29  # "N":I
    :catchall_429
    move-exception v0

    goto :goto_463

    .end local v18  # "callingUid":I
    .local v13, "callingUid":I
    :catchall_42b
    move-exception v0

    move/from16 v18, v13

    .end local v13  # "callingUid":I
    .restart local v18  # "callingUid":I
    goto :goto_463

    .end local v18  # "callingUid":I
    .end local v27  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .local v3, "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .restart local v13  # "callingUid":I
    :catchall_42f
    move-exception v0

    move-object/from16 v27, v3

    move/from16 v18, v13

    .end local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .end local v13  # "callingUid":I
    .restart local v18  # "callingUid":I
    .restart local v27  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    goto :goto_463

    .line 7265
    .end local v18  # "callingUid":I
    .end local v27  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .local v0, "match":I
    .local v1, "M":I
    .restart local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .restart local v4  # "i":I
    .restart local v6  # "N":I
    .restart local v13  # "callingUid":I
    :cond_435
    move/from16 v28, v0

    move/from16 v26, v1

    move-object/from16 v27, v3

    move/from16 v29, v6

    move/from16 v18, v13

    .line 7393
    .end local v0  # "match":I
    .end local v1  # "M":I
    .end local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .end local v4  # "i":I
    .end local v6  # "N":I
    .end local v13  # "callingUid":I
    .restart local v18  # "callingUid":I
    .restart local v27  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    if-eqz v5, :cond_47b

    .line 7394
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v0, :cond_44c

    .line 7395
    const-string v0, "PackageManager"

    const-string v1, "Preferred activity bookkeeping changed; writing restrictions"

    invoke-static {v0, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7397
    :cond_44c
    invoke-virtual {v8, v11}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    goto :goto_47b

    .line 7393
    .end local v5  # "changed":Z
    .end local v18  # "callingUid":I
    .end local v27  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .restart local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .restart local v13  # "callingUid":I
    .local p1, "changed":Z
    :catchall_450
    move-exception v0

    move-object/from16 v27, v3

    move/from16 v18, v13

    move/from16 v5, p1

    .end local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .end local v13  # "callingUid":I
    .restart local v18  # "callingUid":I
    .restart local v27  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    goto :goto_463

    .end local v18  # "callingUid":I
    .end local v19  # "pri":Landroid/content/pm/ResolveInfo;
    .end local v27  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .end local p1  # "changed":Z
    .local v1, "pri":Landroid/content/pm/ResolveInfo;
    .restart local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .local v4, "changed":Z
    .restart local v13  # "callingUid":I
    :catchall_458
    move-exception v0

    move-object/from16 v19, v1

    move-object/from16 v27, v3

    move/from16 p1, v4

    move/from16 v18, v13

    move/from16 v5, p1

    .end local v1  # "pri":Landroid/content/pm/ResolveInfo;
    .end local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .end local v4  # "changed":Z
    .end local v13  # "callingUid":I
    .restart local v5  # "changed":Z
    .restart local v18  # "callingUid":I
    .restart local v19  # "pri":Landroid/content/pm/ResolveInfo;
    .restart local v27  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    :goto_463
    if-eqz v5, :cond_473

    .line 7394
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v1, :cond_470

    .line 7395
    const-string v1, "PackageManager"

    const-string v3, "Preferred activity bookkeeping changed; writing restrictions"

    invoke-static {v1, v3}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7397
    :cond_470
    invoke-virtual {v8, v11}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    :cond_473
    nop

    .end local v12  # "flags":I
    .end local v15  # "intent":Landroid/content/Intent;
    .end local v16  # "isDeviceProvisioned":Z
    .end local v18  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p2  # "resolvedType":Ljava/lang/String;
    .end local p4  # "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local p5  # "priority":I
    .end local p6  # "always":Z
    .end local p7  # "removeMatches":Z
    .end local p8  # "debug":Z
    .end local p9  # "userId":I
    throw v0

    .line 7240
    .end local v5  # "changed":Z
    .end local v19  # "pri":Landroid/content/pm/ResolveInfo;
    .end local v27  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .restart local v1  # "pri":Landroid/content/pm/ResolveInfo;
    .restart local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .restart local v12  # "flags":I
    .restart local v13  # "callingUid":I
    .restart local v15  # "intent":Landroid/content/Intent;
    .restart local v16  # "isDeviceProvisioned":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p2  # "resolvedType":Ljava/lang/String;
    .restart local p4  # "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local p5  # "priority":I
    .restart local p6  # "always":Z
    .restart local p7  # "removeMatches":Z
    .restart local p8  # "debug":Z
    .restart local p9  # "userId":I
    :cond_475
    move-object/from16 v19, v1

    move-object/from16 v27, v3

    move/from16 v18, v13

    .line 7401
    .end local v1  # "pri":Landroid/content/pm/ResolveInfo;
    .end local v2  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    .end local v3  # "prefs":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PreferredActivity;>;"
    .end local v13  # "callingUid":I
    .restart local v18  # "callingUid":I
    :cond_47b
    :goto_47b
    monitor-exit v17
    :try_end_47c
    .catchall {:try_start_405 .. :try_end_47c} :catchall_490

    .line 7402
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-nez v0, :cond_482

    if-eqz p8, :cond_489

    :cond_482
    const-string v0, "PackageManager"

    const-string v1, "No preferred activity to return"

    invoke-static {v0, v1}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 7403
    :cond_489
    const/4 v0, 0x0

    return-object v0

    .line 7401
    .end local v18  # "callingUid":I
    .restart local v13  # "callingUid":I
    :catchall_48b
    move-exception v0

    move/from16 v18, v13

    .end local v13  # "callingUid":I
    .restart local v18  # "callingUid":I
    :goto_48e
    :try_start_48e
    monitor-exit v17
    :try_end_48f
    .catchall {:try_start_48e .. :try_end_48f} :catchall_490

    throw v0

    :catchall_490
    move-exception v0

    goto :goto_48e
.end method

.method findSharedNonSystemLibraries(Landroid/content/pm/PackageParser$Package;)Ljava/util/List;
    .registers 9
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/pm/PackageParser$Package;",
            ")",
            "Ljava/util/List<",
            "Landroid/content/pm/PackageParser$Package;",
            ">;"
        }
    .end annotation

    .line 10599
    invoke-static {p1}, Lcom/android/server/pm/PackageManagerService;->findSharedLibraries(Landroid/content/pm/PackageParser$Package;)Ljava/util/List;

    move-result-object v0

    .line 10600
    .local v0, "deps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    invoke-interface {v0}, Ljava/util/List;->isEmpty()Z

    move-result v1

    if-nez v1, :cond_39

    .line 10601
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 10602
    .local v1, "retValue":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 10603
    :try_start_12
    invoke-interface {v0}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :goto_16
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_34

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/SharedLibraryInfo;

    .line 10604
    .local v4, "info":Landroid/content/pm/SharedLibraryInfo;
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/content/pm/PackageParser$Package;

    .line 10605
    .local v5, "depPackage":Landroid/content/pm/PackageParser$Package;
    if-eqz v5, :cond_33

    .line 10606
    invoke-virtual {v1, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10608
    .end local v4  # "info":Landroid/content/pm/SharedLibraryInfo;
    .end local v5  # "depPackage":Landroid/content/pm/PackageParser$Package;
    :cond_33
    goto :goto_16

    .line 10609
    :cond_34
    monitor-exit v2

    .line 10610
    return-object v1

    .line 10609
    :catchall_36
    move-exception v3

    monitor-exit v2
    :try_end_38
    .catchall {:try_start_12 .. :try_end_38} :catchall_36

    throw v3

    .line 10612
    .end local v1  # "retValue":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageParser$Package;>;"
    :cond_39
    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v1

    return-object v1
.end method

.method public finishPackageInstall(IZ)V
    .registers 6
    .param p1, "token"  # I
    .param p2, "didLaunch"  # Z

    .line 14803
    const-string v0, "Only the system is allowed to finish installs"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrRoot(Ljava/lang/String;)V

    .line 14805
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_1f

    .line 14806
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "BM finishing package install for "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 14808
    :cond_1f
    const-wide/32 v0, 0x40000

    const-string/jumbo v2, "restore"

    invoke-static {v0, v1, v2, p1}, Landroid/os/Trace;->asyncTraceEnd(JLjava/lang/String;I)V

    .line 14810
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v1, 0x9

    invoke-virtual {v0, v1, p1, p2}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(III)Landroid/os/Message;

    move-result-object v0

    .line 14811
    .local v0, "msg":Landroid/os/Message;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v1, v0}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 14812
    return-void
.end method

.method public flushPackageRestrictionsAsUser(I)V
    .registers 9
    .param p1, "userId"  # I

    .line 22427
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_b

    .line 22428
    return-void

    .line 22430
    :cond_b
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_14

    .line 22431
    return-void

    .line 22433
    :cond_14
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    const/4 v4, 0x0

    const/4 v5, 0x0

    const-string v6, "flushPackageRestrictions"

    move v3, p1

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 22435
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 22436
    :try_start_25
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1}, Lcom/android/server/pm/Settings;->writePackageRestrictionsLPr(I)V

    .line 22437
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mDirtyUsers:Landroid/util/ArraySet;

    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    invoke-virtual {v1, v2}, Landroid/util/ArraySet;->remove(Ljava/lang/Object;)Z

    .line 22438
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mDirtyUsers:Landroid/util/ArraySet;

    invoke-virtual {v1}, Landroid/util/ArraySet;->isEmpty()Z

    move-result v1

    if-eqz v1, :cond_42

    .line 22439
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v2, 0xe

    invoke-virtual {v1, v2}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->removeMessages(I)V

    .line 22441
    :cond_42
    monitor-exit v0

    .line 22442
    return-void

    .line 22441
    :catchall_44
    move-exception v1

    monitor-exit v0
    :try_end_46
    .catchall {:try_start_25 .. :try_end_46} :catchall_44

    throw v1
.end method

.method forEachInstalledPackage(Ljava/util/function/Consumer;I)V
    .registers 9
    .param p2, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/function/Consumer<",
            "Landroid/content/pm/PackageParser$Package;",
            ">;I)V"
        }
    .end annotation

    .line 26206
    .local p1, "actionLocked":Ljava/util/function/Consumer;, "Ljava/util/function/Consumer<Landroid/content/pm/PackageParser$Package;>;"
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26207
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/util/ArrayMap;->size()I

    move-result v1

    .line 26208
    .local v1, "numPackages":I
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_a
    if-ge v2, v1, :cond_2b

    .line 26209
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, v2}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 26210
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v4

    .line 26211
    .local v4, "setting":Lcom/android/server/pm/PackageSetting;
    if-eqz v4, :cond_28

    invoke-virtual {v4, p2}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v5

    if-nez v5, :cond_25

    .line 26212
    goto :goto_28

    .line 26214
    :cond_25
    invoke-interface {p1, v3}, Ljava/util/function/Consumer;->accept(Ljava/lang/Object;)V

    .line 26208
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "setting":Lcom/android/server/pm/PackageSetting;
    :cond_28
    :goto_28
    add-int/lit8 v2, v2, 0x1

    goto :goto_a

    .line 26216
    .end local v1  # "numPackages":I
    .end local v2  # "i":I
    :cond_2b
    monitor-exit v0

    .line 26217
    return-void

    .line 26216
    :catchall_2d
    move-exception v1

    monitor-exit v0
    :try_end_2f
    .catchall {:try_start_3 .. :try_end_2f} :catchall_2d

    throw v1
.end method

.method forEachPackage(Ljava/util/function/Consumer;)V
    .registers 6
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/function/Consumer<",
            "Landroid/content/pm/PackageParser$Package;",
            ">;)V"
        }
    .end annotation

    .line 26196
    .local p1, "actionLocked":Ljava/util/function/Consumer;, "Ljava/util/function/Consumer<Landroid/content/pm/PackageParser$Package;>;"
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26197
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/util/ArrayMap;->size()I

    move-result v1

    .line 26198
    .local v1, "numPackages":I
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_a
    if-ge v2, v1, :cond_1a

    .line 26199
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, v2}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    invoke-interface {p1, v3}, Ljava/util/function/Consumer;->accept(Ljava/lang/Object;)V

    .line 26198
    add-int/lit8 v2, v2, 0x1

    goto :goto_a

    .line 26201
    .end local v1  # "numPackages":I
    .end local v2  # "i":I
    :cond_1a
    monitor-exit v0

    .line 26202
    return-void

    .line 26201
    :catchall_1c
    move-exception v1

    monitor-exit v0
    :try_end_1e
    .catchall {:try_start_3 .. :try_end_1e} :catchall_1c

    throw v1
.end method

.method public forceDexOpt(Ljava/lang/String;)V
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;

    .line 10721
    const-string v0, "forceDexOpt"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrRoot(Ljava/lang/String;)V

    .line 10724
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 10725
    :try_start_8
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 10726
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v1, :cond_4e

    .line 10729
    monitor-exit v0
    :try_end_13
    .catchall {:try_start_8 .. :try_end_13} :catchall_65

    .line 10731
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v2

    .line 10732
    :try_start_16
    const-string v0, "dexopt"

    const-wide/32 v3, 0x40000

    invoke-static {v3, v4, v0}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 10736
    new-instance v0, Lcom/android/server/pm/dex/DexoptOptions;

    .line 10739
    invoke-static {}, Lcom/android/server/pm/PackageManagerServiceCompilerMapping;->getDefaultCompilerFilter()Ljava/lang/String;

    move-result-object v5

    const/4 v6, 0x6

    invoke-direct {v0, p1, v5, v6}, Lcom/android/server/pm/dex/DexoptOptions;-><init>(Ljava/lang/String;Ljava/lang/String;I)V

    .line 10736
    invoke-direct {p0, v1, v0}, Lcom/android/server/pm/PackageManagerService;->performDexOptInternalWithDependenciesLI(Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/dex/DexoptOptions;)I

    move-result v0

    .line 10742
    .local v0, "res":I
    invoke-static {v3, v4}, Landroid/os/Trace;->traceEnd(J)V

    .line 10743
    const/4 v3, 0x1

    if-ne v0, v3, :cond_34

    .line 10746
    .end local v0  # "res":I
    monitor-exit v2

    .line 10747
    return-void

    .line 10744
    .restart local v0  # "res":I
    :cond_34
    new-instance v3, Ljava/lang/IllegalStateException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failed to dexopt: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    throw v3

    .line 10746
    .end local v0  # "res":I
    .restart local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    :catchall_4b
    move-exception v0

    monitor-exit v2
    :try_end_4d
    .catchall {:try_start_16 .. :try_end_4d} :catchall_4b

    throw v0

    .line 10727
    :cond_4e
    :try_start_4e
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unknown package: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    throw v2

    .line 10729
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    :catchall_65
    move-exception v1

    monitor-exit v0
    :try_end_67
    .catchall {:try_start_4e .. :try_end_67} :catchall_65

    throw v1
.end method

.method public freeStorage(Ljava/lang/String;JI)V
    .registers 25
    .param p1, "volumeUuid"  # Ljava/lang/String;
    .param p2, "bytes"  # J
    .param p4, "storageFlags"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .line 5044
    move-object/from16 v1, p0

    move-object/from16 v9, p1

    move-wide/from16 v10, p2

    move/from16 v12, p4

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v2, Landroid/os/storage/StorageManager;

    invoke-virtual {v0, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    move-object v13, v0

    check-cast v13, Landroid/os/storage/StorageManager;

    .line 5045
    .local v13, "storage":Landroid/os/storage/StorageManager;
    invoke-virtual {v13, v9}, Landroid/os/storage/StorageManager;->findPathForUuid(Ljava/lang/String;)Ljava/io/File;

    move-result-object v14

    .line 5046
    .local v14, "file":Ljava/io/File;
    invoke-virtual {v14}, Ljava/io/File;->getUsableSpace()J

    move-result-wide v2

    cmp-long v0, v2, v10

    if-ltz v0, :cond_20

    return-void

    .line 5048
    :cond_20
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->ENABLE_FREE_CACHE_V2:Z

    if-eqz v0, :cond_e8

    .line 5049
    sget-object v0, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    invoke-static {v0, v9}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v15

    .line 5051
    .local v15, "internalVolume":Z
    and-int/lit8 v0, v12, 0x1

    const/4 v2, 0x0

    if-eqz v0, :cond_31

    const/4 v0, 0x1

    goto :goto_32

    :cond_31
    move v0, v2

    :goto_32
    move/from16 v16, v0

    .line 5053
    .local v16, "aggressive":Z
    invoke-virtual {v13, v14, v12}, Landroid/os/storage/StorageManager;->getStorageCacheBytes(Ljava/io/File;I)J

    move-result-wide v17

    .line 5057
    .local v17, "reservedBytes":J
    if-eqz v15, :cond_51

    if-nez v16, :cond_45

    .line 5058
    const-string/jumbo v0, "persist.sys.preloads.file_cache_expired"

    invoke-static {v0, v2}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z

    move-result v0

    if-eqz v0, :cond_51

    .line 5059
    :cond_45
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->deletePreloadsFileCache()V

    .line 5060
    invoke-virtual {v14}, Ljava/io/File;->getUsableSpace()J

    move-result-wide v2

    cmp-long v0, v2, v10

    if-ltz v0, :cond_51

    return-void

    .line 5064
    :cond_51
    if-eqz v15, :cond_63

    if-eqz v16, :cond_63

    .line 5065
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mCacheDir:Ljava/io/File;

    invoke-static {v0}, Landroid/os/FileUtils;->deleteContents(Ljava/io/File;)Z

    .line 5066
    invoke-virtual {v14}, Ljava/io/File;->getUsableSpace()J

    move-result-wide v2

    cmp-long v0, v2, v10

    if-ltz v0, :cond_63

    return-void

    .line 5071
    :cond_63
    :try_start_63
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    const/16 v8, 0x100

    move-object/from16 v3, p1

    move-wide/from16 v4, p2

    move-wide/from16 v6, v17

    invoke-virtual/range {v2 .. v8}, Lcom/android/server/pm/Installer;->freeCache(Ljava/lang/String;JJI)V
    :try_end_70
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_63 .. :try_end_70} :catch_71

    .line 5074
    goto :goto_72

    .line 5073
    :catch_71
    move-exception v0

    .line 5075
    :goto_72
    invoke-virtual {v14}, Ljava/io/File;->getUsableSpace()J

    move-result-wide v2

    cmp-long v0, v2, v10

    if-ltz v0, :cond_7b

    return-void

    .line 5078
    :cond_7b
    if-eqz v15, :cond_94

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 5079
    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-wide/32 v2, 0x6ddd00

    const-string/jumbo v4, "unused_static_shared_lib_min_cache_period"

    invoke-static {v0, v4, v2, v3}, Landroid/provider/Settings$Global;->getLong(Landroid/content/ContentResolver;Ljava/lang/String;J)J

    move-result-wide v2

    .line 5078
    invoke-direct {v1, v10, v11, v2, v3}, Lcom/android/server/pm/PackageManagerService;->pruneUnusedStaticSharedLibraries(JJ)Z

    move-result v0

    if-eqz v0, :cond_94

    .line 5082
    return-void

    .line 5089
    :cond_94
    const-wide/32 v6, 0x240c8400

    if-eqz v15, :cond_af

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 5090
    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    const-string/jumbo v3, "installed_instant_app_min_cache_period"

    invoke-static {v2, v3, v6, v7}, Landroid/provider/Settings$Global;->getLong(Landroid/content/ContentResolver;Ljava/lang/String;J)J

    move-result-wide v2

    .line 5089
    invoke-virtual {v0, v10, v11, v2, v3}, Lcom/android/server/pm/InstantAppRegistry;->pruneInstalledInstantApps(JJ)Z

    move-result v0

    if-eqz v0, :cond_af

    .line 5093
    return-void

    .line 5098
    :cond_af
    :try_start_af
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;
    :try_end_b1
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_af .. :try_end_b1} :catch_c2

    const/16 v8, 0x300

    move-object/from16 v3, p1

    move-wide/from16 v4, p2

    move-object/from16 v19, v13

    move-wide v12, v6

    .end local v13  # "storage":Landroid/os/storage/StorageManager;
    .local v19, "storage":Landroid/os/storage/StorageManager;
    move-wide/from16 v6, v17

    :try_start_bc
    invoke-virtual/range {v2 .. v8}, Lcom/android/server/pm/Installer;->freeCache(Ljava/lang/String;JJI)V
    :try_end_bf
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_bc .. :try_end_bf} :catch_c0

    .line 5101
    goto :goto_c6

    .line 5100
    :catch_c0
    move-exception v0

    goto :goto_c6

    .end local v19  # "storage":Landroid/os/storage/StorageManager;
    .restart local v13  # "storage":Landroid/os/storage/StorageManager;
    :catch_c2
    move-exception v0

    move-object/from16 v19, v13

    move-wide v12, v6

    .line 5102
    .end local v13  # "storage":Landroid/os/storage/StorageManager;
    .restart local v19  # "storage":Landroid/os/storage/StorageManager;
    :goto_c6
    invoke-virtual {v14}, Ljava/io/File;->getUsableSpace()J

    move-result-wide v2

    cmp-long v0, v2, v10

    if-ltz v0, :cond_cf

    return-void

    .line 5108
    :cond_cf
    if-eqz v15, :cond_e7

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 5109
    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    const-string/jumbo v3, "uninstalled_instant_app_min_cache_period"

    invoke-static {v2, v3, v12, v13}, Landroid/provider/Settings$Global;->getLong(Landroid/content/ContentResolver;Ljava/lang/String;J)J

    move-result-wide v2

    .line 5108
    invoke-virtual {v0, v10, v11, v2, v3}, Lcom/android/server/pm/InstantAppRegistry;->pruneUninstalledInstantApps(JJ)Z

    move-result v0

    if-eqz v0, :cond_e7

    .line 5112
    return-void

    .line 5114
    .end local v15  # "internalVolume":Z
    .end local v16  # "aggressive":Z
    .end local v17  # "reservedBytes":J
    :cond_e7
    goto :goto_101

    .line 5116
    .end local v19  # "storage":Landroid/os/storage/StorageManager;
    .restart local v13  # "storage":Landroid/os/storage/StorageManager;
    :cond_e8
    move-object/from16 v19, v13

    .end local v13  # "storage":Landroid/os/storage/StorageManager;
    .restart local v19  # "storage":Landroid/os/storage/StorageManager;
    :try_start_ea
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    const-wide/16 v6, 0x0

    const/4 v8, 0x0

    move-object/from16 v3, p1

    move-wide/from16 v4, p2

    invoke-virtual/range {v2 .. v8}, Lcom/android/server/pm/Installer;->freeCache(Ljava/lang/String;JJI)V
    :try_end_f6
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_ea .. :try_end_f6} :catch_f7

    .line 5118
    goto :goto_f8

    .line 5117
    :catch_f7
    move-exception v0

    .line 5119
    :goto_f8
    invoke-virtual {v14}, Ljava/io/File;->getUsableSpace()J

    move-result-wide v2

    cmp-long v0, v2, v10

    if-ltz v0, :cond_101

    return-void

    .line 5122
    :cond_101
    :goto_101
    new-instance v0, Ljava/io/IOException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Failed to free "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v10, v11}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v3, " on storage device at "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v0, v2}, Ljava/io/IOException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public freeStorage(Ljava/lang/String;JILandroid/content/IntentSender;)V
    .registers 15
    .param p1, "volumeUuid"  # Ljava/lang/String;
    .param p2, "freeStorageSize"  # J
    .param p4, "storageFlags"  # I
    .param p5, "pi"  # Landroid/content/IntentSender;

    .line 5019
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.CLEAR_APP_CACHE"

    const-string v2, "PackageManager"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 5021
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v8, Lcom/android/server/pm/-$$Lambda$PackageManagerService$gqdNHYJiYM0w_nIH0nGMWWU8yzQ;

    move-object v1, v8

    move-object v2, p0

    move-object v3, p1

    move-wide v4, p2

    move v6, p4

    move-object v7, p5

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$gqdNHYJiYM0w_nIH0nGMWWU8yzQ;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;JILandroid/content/IntentSender;)V

    invoke-virtual {v0, v8}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 5037
    return-void
.end method

.method public freeStorageAndNotify(Ljava/lang/String;JILandroid/content/pm/IPackageDataObserver;)V
    .registers 15
    .param p1, "volumeUuid"  # Ljava/lang/String;
    .param p2, "freeStorageSize"  # J
    .param p4, "storageFlags"  # I
    .param p5, "observer"  # Landroid/content/pm/IPackageDataObserver;

    .line 4996
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.CLEAR_APP_CACHE"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 4998
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v8, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Iz1l7RVtATr5Ybl_zHeYuCbGMvA;

    move-object v1, v8

    move-object v2, p0

    move-object v3, p1

    move-wide v4, p2

    move v6, p4

    move-object v7, p5

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Iz1l7RVtATr5Ybl_zHeYuCbGMvA;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;JILandroid/content/pm/IPackageDataObserver;)V

    invoke-virtual {v0, v8}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 5014
    return-void
.end method

.method public freezePackage(Ljava/lang/String;ILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "killReason"  # Ljava/lang/String;

    .line 24161
    new-instance v0, Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-direct {v0, p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;ILjava/lang/String;)V

    return-object v0
.end method

.method public freezePackage(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .registers 4
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "killReason"  # Ljava/lang/String;

    .line 24157
    const/4 v0, -0x1

    invoke-virtual {p0, p1, v0, p2}, Lcom/android/server/pm/PackageManagerService;->freezePackage(Ljava/lang/String;ILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v0

    return-object v0
.end method

.method public freezePackageForDelete(Ljava/lang/String;IILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "deleteFlags"  # I
    .param p4, "killReason"  # Ljava/lang/String;

    .line 24185
    and-int/lit8 v0, p3, 0x8

    if-eqz v0, :cond_a

    .line 24186
    new-instance v0, Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-direct {v0, p0}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    return-object v0

    .line 24188
    :cond_a
    invoke-virtual {p0, p1, p2, p4}, Lcom/android/server/pm/PackageManagerService;->freezePackage(Ljava/lang/String;ILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v0

    return-object v0
.end method

.method public freezePackageForDelete(Ljava/lang/String;ILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "deleteFlags"  # I
    .param p3, "killReason"  # Ljava/lang/String;

    .line 24180
    const/4 v0, -0x1

    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/pm/PackageManagerService;->freezePackageForDelete(Ljava/lang/String;IILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v0

    return-object v0
.end method

.method public freezePackageForInstall(Ljava/lang/String;IILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "installFlags"  # I
    .param p4, "killReason"  # Ljava/lang/String;

    .line 24171
    and-int/lit16 v0, p3, 0x1000

    if-eqz v0, :cond_a

    .line 24172
    new-instance v0, Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    invoke-direct {v0, p0}, Lcom/android/server/pm/PackageManagerService$PackageFreezer;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    return-object v0

    .line 24174
    :cond_a
    invoke-virtual {p0, p1, p2, p4}, Lcom/android/server/pm/PackageManagerService;->freezePackage(Ljava/lang/String;ILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v0

    return-object v0
.end method

.method public freezePackageForInstall(Ljava/lang/String;ILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "installFlags"  # I
    .param p3, "killReason"  # Ljava/lang/String;

    .line 24166
    const/4 v0, -0x1

    invoke-virtual {p0, p1, v0, p2, p3}, Lcom/android/server/pm/PackageManagerService;->freezePackageForInstall(Ljava/lang/String;IILjava/lang/String;)Lcom/android/server/pm/PackageManagerService$PackageFreezer;

    move-result-object v0

    return-object v0
.end method

.method public getActivityInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ActivityInfo;
    .registers 5
    .param p1, "component"  # Landroid/content/ComponentName;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 5352
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, p1, p2, v0, p3}, Lcom/android/server/pm/PackageManagerService;->getActivityInfoInternal(Landroid/content/ComponentName;III)Landroid/content/pm/ActivityInfo;

    move-result-object v0

    return-object v0
.end method

.method public getAllIntentFilters(Ljava/lang/String;)Landroid/content/pm/ParceledListSlice;
    .registers 12
    .param p1, "packageName"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            ")",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/IntentFilter;",
            ">;"
        }
    .end annotation

    .line 14970
    invoke-static {p1}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v0

    if-eqz v0, :cond_b

    .line 14971
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v0

    return-object v0

    .line 14973
    :cond_b
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 14974
    .local v0, "callingUid":I
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    .line 14975
    .local v1, "callingUserId":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 14976
    :try_start_16
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 14977
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v3, :cond_70

    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;

    if-nez v4, :cond_25

    goto :goto_70

    .line 14980
    :cond_25
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    if-nez v4, :cond_2f

    .line 14981
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v4

    monitor-exit v2

    return-object v4

    .line 14983
    :cond_2f
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 14984
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v4, v0, v1}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v5

    if-eqz v5, :cond_3f

    .line 14985
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v5

    monitor-exit v2

    return-object v5

    .line 14987
    :cond_3f
    iget-object v5, v3, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    .line 14988
    .local v5, "count":I
    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V

    .line 14989
    .local v6, "result":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/IntentFilter;>;"
    const/4 v7, 0x0

    .local v7, "n":I
    :goto_4b
    if-ge v7, v5, :cond_69

    .line 14990
    iget-object v8, v3, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;

    invoke-virtual {v8, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/pm/PackageParser$Activity;

    .line 14991
    .local v8, "activity":Landroid/content/pm/PackageParser$Activity;
    iget-object v9, v8, Landroid/content/pm/PackageParser$Activity;->intents:Ljava/util/ArrayList;

    if-eqz v9, :cond_66

    iget-object v9, v8, Landroid/content/pm/PackageParser$Activity;->intents:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-lez v9, :cond_66

    .line 14992
    iget-object v9, v8, Landroid/content/pm/PackageParser$Activity;->intents:Ljava/util/ArrayList;

    invoke-virtual {v6, v9}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    .line 14989
    .end local v8  # "activity":Landroid/content/pm/PackageParser$Activity;
    :cond_66
    add-int/lit8 v7, v7, 0x1

    goto :goto_4b

    .line 14995
    .end local v7  # "n":I
    :cond_69
    new-instance v7, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v7, v6}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    monitor-exit v2

    return-object v7

    .line 14978
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "count":I
    .end local v6  # "result":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/IntentFilter;>;"
    :cond_70
    :goto_70
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v4

    monitor-exit v2

    return-object v4

    .line 14996
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_76
    move-exception v3

    monitor-exit v2
    :try_end_78
    .catchall {:try_start_16 .. :try_end_78} :catchall_76

    throw v3
.end method

.method public getAllPackages()Ljava/util/List;
    .registers 12
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 6583
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 6584
    .local v0, "callingUid":I
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    .line 6585
    .local v1, "callingUserId":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 6586
    :try_start_b
    invoke-direct {p0, v0, v1}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v3

    if-eqz v3, :cond_1e

    .line 6587
    new-instance v3, Ljava/util/ArrayList;

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4}, Landroid/util/ArrayMap;->keySet()Ljava/util/Set;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    monitor-exit v2

    return-object v3

    .line 6589
    :cond_1e
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v3

    .line 6590
    .local v3, "instantAppPkgName":Ljava/lang/String;
    new-instance v4, Ljava/util/ArrayList;

    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 6591
    .local v4, "result":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v3, :cond_4c

    .line 6593
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v5

    :goto_33
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v6

    if-eqz v6, :cond_4b

    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/PackageParser$Package;

    .line 6594
    .local v6, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-boolean v7, v6, Landroid/content/pm/PackageParser$Package;->visibleToInstantApps:Z

    if-nez v7, :cond_44

    .line 6595
    goto :goto_33

    .line 6597
    :cond_44
    iget-object v7, v6, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-interface {v4, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 6598
    nop

    .end local v6  # "pkg":Landroid/content/pm/PackageParser$Package;
    goto :goto_33

    :cond_4b
    goto :goto_8a

    .line 6601
    :cond_4c
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v5

    :goto_56
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v6

    if-eqz v6, :cond_8a

    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/PackageParser$Package;

    .line 6603
    .restart local v6  # "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v7, v6, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    if-eqz v7, :cond_6b

    iget-object v7, v6, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    goto :goto_6c

    :cond_6b
    const/4 v7, 0x0

    .line 6604
    .local v7, "ps":Lcom/android/server/pm/PackageSetting;
    :goto_6c
    if-eqz v7, :cond_83

    .line 6605
    invoke-virtual {v7, v1}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v8

    if-eqz v8, :cond_83

    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    .line 6607
    invoke-static {v0}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v9

    iget v10, v7, Lcom/android/server/pm/PackageSetting;->appId:I

    .line 6606
    invoke-virtual {v8, v1, v9, v10}, Lcom/android/server/pm/InstantAppRegistry;->isInstantAccessGranted(III)Z

    move-result v8

    if-nez v8, :cond_83

    .line 6608
    goto :goto_56

    .line 6610
    :cond_83
    iget-object v8, v6, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-interface {v4, v8}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 6611
    nop

    .end local v6  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    goto :goto_56

    .line 6613
    :cond_8a
    :goto_8a
    monitor-exit v2

    return-object v4

    .line 6614
    .end local v3  # "instantAppPkgName":Ljava/lang/String;
    .end local v4  # "result":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :catchall_8c
    move-exception v3

    monitor-exit v2
    :try_end_8e
    .catchall {:try_start_b .. :try_end_8e} :catchall_8c

    throw v3
.end method

.method public getAllPermissionGroups(I)Landroid/content/pm/ParceledListSlice;
    .registers 4
    .param p1, "flags"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(I)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/PermissionGroupInfo;",
            ">;"
        }
    .end annotation

    .line 4882
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 4883
    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, p1, v1}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getAllPermissionGroups(II)Ljava/util/List;

    move-result-object v0

    .line 4884
    .local v0, "permissionList":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/PermissionGroupInfo;>;"
    if-nez v0, :cond_11

    .line 4885
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v1

    goto :goto_16

    :cond_11
    new-instance v1, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v1, v0}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    .line 4884
    :goto_16
    return-object v1
.end method

.method public getAppOpPermissionPackages(Ljava/lang/String;)[Ljava/lang/String;
    .registers 8
    .param p1, "permName"  # Ljava/lang/String;

    .line 6817
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getAppOpPermissionPackages(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v0

    .line 6818
    .local v0, "pkgArray":[Ljava/lang/String;
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 6819
    .local v1, "pkgList":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v0, :cond_25

    array-length v2, v0

    if-lez v2, :cond_25

    .line 6820
    array-length v2, v0

    const/4 v3, 0x0

    :goto_12
    if-ge v3, v2, :cond_25

    aget-object v4, v0, v3

    .line 6821
    .local v4, "pkg":Ljava/lang/String;
    const-string v5, "com.meizu.regservice"

    invoke-virtual {v5, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_1f

    .line 6823
    goto :goto_22

    .line 6825
    :cond_1f
    invoke-interface {v1, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 6820
    .end local v4  # "pkg":Ljava/lang/String;
    :goto_22
    add-int/lit8 v3, v3, 0x1

    goto :goto_12

    .line 6828
    :cond_25
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v2

    new-array v2, v2, [Ljava/lang/String;

    invoke-interface {v1, v2}, Ljava/util/List;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v2

    check-cast v2, [Ljava/lang/String;

    return-object v2
.end method

.method public getAppPredictionServicePackageName()Ljava/lang/String;
    .registers 4

    .line 22110
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 22111
    const v1, 0x1040151

    invoke-virtual {v0, v1}, Landroid/content/Context;->getString(I)Ljava/lang/String;

    move-result-object v0

    .line 22112
    .local v0, "flattenedAppPredictionServiceComponentName":Ljava/lang/String;
    const/4 v1, 0x0

    if-nez v0, :cond_d

    .line 22113
    return-object v1

    .line 22115
    :cond_d
    nop

    .line 22116
    invoke-static {v0}, Landroid/content/ComponentName;->unflattenFromString(Ljava/lang/String;)Landroid/content/ComponentName;

    move-result-object v2

    .line 22117
    .local v2, "appPredictionServiceComponentName":Landroid/content/ComponentName;
    if-nez v2, :cond_15

    .line 22118
    return-object v1

    .line 22120
    :cond_15
    invoke-virtual {v2}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v1

    invoke-direct {p0, v1}, Lcom/android/server/pm/PackageManagerService;->ensureSystemPackageName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    return-object v1
.end method

.method public getApplicationEnabledSetting(Ljava/lang/String;I)I
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 22520
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p2}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x2

    if-nez v0, :cond_a

    return v1

    .line 22521
    :cond_a
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 22522
    .local v0, "callingUid":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v7, "get enabled"

    move v3, v0

    move v4, p2

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 22525
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 22526
    :try_start_1c
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, p1}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v3

    invoke-direct {p0, v3, v0, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-eqz v3, :cond_2a

    .line 22527
    monitor-exit v2

    return v1

    .line 22529
    :cond_2a
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/Settings;->getApplicationEnabledSettingLPr(Ljava/lang/String;I)I

    move-result v1

    monitor-exit v2

    return v1

    .line 22530
    :catchall_32
    move-exception v1

    monitor-exit v2
    :try_end_34
    .catchall {:try_start_1c .. :try_end_34} :catchall_32

    throw v1
.end method

.method public getApplicationHiddenSettingAsUser(Ljava/lang/String;I)Z
    .registers 12
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 13974
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.MANAGE_USERS"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 13975
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 13976
    .local v0, "callingUid":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "getApplicationHidden for user "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    const/4 v6, 0x1

    const/4 v7, 0x0

    move v4, v0

    move v5, p2

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 13980
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 13983
    .local v1, "callingId":J
    :try_start_2a
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3
    :try_end_2d
    .catchall {:try_start_2a .. :try_end_2d} :catchall_56

    .line 13984
    :try_start_2d
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 13985
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    const/4 v5, 0x1

    if-nez v4, :cond_3f

    .line 13986
    monitor-exit v3
    :try_end_3b
    .catchall {:try_start_2d .. :try_end_3b} :catchall_53

    .line 13994
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13986
    return v5

    .line 13988
    :cond_3f
    :try_start_3f
    invoke-direct {p0, v4, v0, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v6

    if-eqz v6, :cond_4a

    .line 13989
    monitor-exit v3
    :try_end_46
    .catchall {:try_start_3f .. :try_end_46} :catchall_53

    .line 13994
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13989
    return v5

    .line 13991
    :cond_4a
    :try_start_4a
    invoke-virtual {v4, p2}, Lcom/android/server/pm/PackageSetting;->getHidden(I)Z

    move-result v5

    monitor-exit v3
    :try_end_4f
    .catchall {:try_start_4a .. :try_end_4f} :catchall_53

    .line 13994
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13991
    return v5

    .line 13992
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_53
    move-exception v4

    :try_start_54
    monitor-exit v3
    :try_end_55
    .catchall {:try_start_54 .. :try_end_55} :catchall_53

    .end local v0  # "callingUid":I
    .end local v1  # "callingId":J
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    :try_start_55
    throw v4
    :try_end_56
    .catchall {:try_start_55 .. :try_end_56} :catchall_56

    .line 13994
    .restart local v0  # "callingUid":I
    .restart local v1  # "callingId":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    :catchall_56
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v3
.end method

.method public getApplicationInfo(Ljava/lang/String;II)Landroid/content/pm/ApplicationInfo;
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 4919
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, p1, p2, v0, p3}, Lcom/android/server/pm/PackageManagerService;->getApplicationInfoInternal(Ljava/lang/String;III)Landroid/content/pm/ApplicationInfo;

    move-result-object v0

    return-object v0
.end method

.method public getArtManager()Landroid/content/pm/dex/IArtManager;
    .registers 2

    .line 24791
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mArtManagerService:Lcom/android/server/pm/dex/ArtManagerService;

    return-object v0
.end method

.method public getAttentionServicePackageName()Ljava/lang/String;
    .registers 4

    .line 22067
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 22068
    const v1, 0x1040153

    invoke-virtual {v0, v1}, Landroid/content/Context;->getString(I)Ljava/lang/String;

    move-result-object v0

    .line 22069
    .local v0, "flattenedComponentName":Ljava/lang/String;
    if-eqz v0, :cond_20

    .line 22070
    invoke-static {v0}, Landroid/content/ComponentName;->unflattenFromString(Ljava/lang/String;)Landroid/content/ComponentName;

    move-result-object v1

    .line 22071
    .local v1, "componentName":Landroid/content/ComponentName;
    if-eqz v1, :cond_20

    invoke-virtual {v1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v2

    if-eqz v2, :cond_20

    .line 22072
    invoke-virtual {v1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->ensureSystemPackageName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    return-object v2

    .line 22075
    .end local v1  # "componentName":Landroid/content/ComponentName;
    :cond_20
    const/4 v1, 0x0

    return-object v1
.end method

.method public getBlockUninstallForUser(Ljava/lang/String;I)Z
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 20232
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 20233
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 20234
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_22

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-direct {p0, v1, v2, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v2

    if-eqz v2, :cond_1a

    goto :goto_22

    .line 20237
    :cond_1a
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, p2, p1}, Lcom/android/server/pm/Settings;->getBlockUninstallLPr(ILjava/lang/String;)Z

    move-result v2

    monitor-exit v0

    return v2

    .line 20235
    :cond_22
    :goto_22
    const/4 v2, 0x0

    monitor-exit v0

    return v2

    .line 20238
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_25
    move-exception v1

    monitor-exit v0
    :try_end_27
    .catchall {:try_start_3 .. :try_end_27} :catchall_25

    throw v1
.end method

.method public getChangedPackages(II)Landroid/content/pm/ChangedPackages;
    .registers 9
    .param p1, "sequenceNumber"  # I
    .param p2, "userId"  # I

    .line 5804
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    const/4 v1, 0x0

    if-eqz v0, :cond_c

    .line 5805
    return-object v1

    .line 5807
    :cond_c
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5808
    :try_start_f
    iget v2, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumber:I

    if-lt p1, v2, :cond_15

    .line 5809
    monitor-exit v0

    return-object v1

    .line 5811
    :cond_15
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackages:Landroid/util/SparseArray;

    invoke-virtual {v2, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/util/SparseArray;

    .line 5812
    .local v2, "changedPackages":Landroid/util/SparseArray;, "Landroid/util/SparseArray<Ljava/lang/String;>;"
    if-nez v2, :cond_21

    .line 5813
    monitor-exit v0

    return-object v1

    .line 5815
    :cond_21
    new-instance v3, Ljava/util/ArrayList;

    iget v4, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumber:I

    sub-int/2addr v4, p1

    invoke-direct {v3, v4}, Ljava/util/ArrayList;-><init>(I)V

    .line 5817
    .local v3, "packageNames":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move v4, p1

    .local v4, "i":I
    :goto_2a
    iget v5, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumber:I

    if-ge v4, v5, :cond_3c

    .line 5818
    invoke-virtual {v2, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/String;

    .line 5819
    .local v5, "packageName":Ljava/lang/String;
    if-eqz v5, :cond_39

    .line 5820
    invoke-interface {v3, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 5817
    .end local v5  # "packageName":Ljava/lang/String;
    :cond_39
    add-int/lit8 v4, v4, 0x1

    goto :goto_2a

    .line 5823
    .end local v4  # "i":I
    :cond_3c
    invoke-interface {v3}, Ljava/util/List;->isEmpty()Z

    move-result v4

    if-eqz v4, :cond_43

    .line 5824
    :goto_42
    goto :goto_4b

    :cond_43
    new-instance v1, Landroid/content/pm/ChangedPackages;

    iget v4, p0, Lcom/android/server/pm/PackageManagerService;->mChangedPackagesSequenceNumber:I

    invoke-direct {v1, v4, v3}, Landroid/content/pm/ChangedPackages;-><init>(ILjava/util/List;)V

    goto :goto_42

    :goto_4b
    monitor-exit v0

    .line 5823
    return-object v1

    .line 5825
    .end local v2  # "changedPackages":Landroid/util/SparseArray;, "Landroid/util/SparseArray<Ljava/lang/String;>;"
    .end local v3  # "packageNames":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :catchall_4d
    move-exception v1

    monitor-exit v0
    :try_end_4f
    .catchall {:try_start_f .. :try_end_4f} :catchall_4d

    throw v1
.end method

.method public getCheckPermissionDelegateLocked()Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;
    .registers 2
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 10313
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mCheckPermissionDelegate:Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;

    return-object v0
.end method

.method public getCompilerPackageStats(Ljava/lang/String;)Lcom/android/server/pm/CompilerStats$PackageStats;
    .registers 3
    .param p1, "pkgName"  # Ljava/lang/String;

    .line 26268
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mCompilerStats:Lcom/android/server/pm/CompilerStats;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/CompilerStats;->getPackageStats(Ljava/lang/String;)Lcom/android/server/pm/CompilerStats$PackageStats;

    move-result-object v0

    return-object v0
.end method

.method public getComponentEnabledSetting(Landroid/content/ComponentName;I)I
    .registers 12
    .param p1, "component"  # Landroid/content/ComponentName;
    .param p2, "userId"  # I

    .line 22535
    if-nez p1, :cond_4

    const/4 v0, 0x0

    return v0

    .line 22536
    :cond_4
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p2}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x2

    if-nez v0, :cond_e

    return v1

    .line 22537
    :cond_e
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 22538
    .local v0, "callingUid":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v7, "getComponentEnabled"

    move v3, v0

    move v4, p2

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 22540
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8

    .line 22541
    :try_start_20
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v3

    const/4 v6, 0x0

    move-object v2, p0

    move v4, v0

    move-object v5, p1

    move v7, p2

    invoke-direct/range {v2 .. v7}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v2

    if-eqz v2, :cond_37

    .line 22543
    monitor-exit v8

    return v1

    .line 22545
    :cond_37
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/Settings;->getComponentEnabledSettingLPr(Landroid/content/ComponentName;I)I

    move-result v1

    monitor-exit v8

    return v1

    .line 22546
    :catchall_3f
    move-exception v1

    monitor-exit v8
    :try_end_41
    .catchall {:try_start_20 .. :try_end_41} :catchall_3f

    throw v1
.end method

.method public getDeclaredSharedLibraries(Ljava/lang/String;II)Landroid/content/pm/ParceledListSlice;
    .registers 34
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;"
        }
    .end annotation

    .line 5542
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move/from16 v3, p2

    move/from16 v10, p3

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v4, "android.permission.ACCESS_SHARED_LIBRARIES"

    const-string v5, "getDeclaredSharedLibraries"

    invoke-virtual {v0, v4, v5}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 5544
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v11

    .line 5545
    .local v11, "callingUid":I
    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v7, 0x1

    const/4 v8, 0x0

    const-string v9, "getDeclaredSharedLibraries"

    move v5, v11

    move/from16 v6, p3

    invoke-virtual/range {v4 .. v9}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 5549
    const-string/jumbo v0, "packageName cannot be null"

    invoke-static {v2, v0}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 5550
    const-string/jumbo v0, "userId must be >= 0"

    invoke-static {v10, v0}, Lcom/android/internal/util/Preconditions;->checkArgumentNonnegative(ILjava/lang/String;)I

    .line 5551
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v10}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v4, 0x0

    if-nez v0, :cond_37

    .line 5552
    return-object v4

    .line 5555
    :cond_37
    invoke-direct {v1, v11}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_3e

    .line 5556
    return-object v4

    .line 5559
    :cond_3e
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 5560
    const/4 v0, 0x0

    .line 5562
    .local v0, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    :try_start_42
    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v6}, Landroid/util/ArrayMap;->size()I

    move-result v6

    .line 5563
    .local v6, "libraryCount":I
    const/4 v7, 0x0

    .local v7, "i":I
    :goto_49
    if-ge v7, v6, :cond_e4

    .line 5564
    iget-object v8, v1, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v8, v7}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/util/LongSparseArray;

    .line 5565
    .local v8, "versionedLibrary":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-nez v8, :cond_57

    .line 5566
    goto/16 :goto_dd

    .line 5569
    :cond_57
    invoke-virtual {v8}, Landroid/util/LongSparseArray;->size()I

    move-result v9

    .line 5570
    .local v9, "versionCount":I
    const/4 v12, 0x0

    move-object v13, v0

    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .local v12, "j":I
    .local v13, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    :goto_5d
    if-ge v12, v9, :cond_dc

    .line 5571
    invoke-virtual {v8, v12}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/SharedLibraryInfo;

    move-object v14, v0

    .line 5573
    .local v14, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v0

    move-object v15, v0

    .line 5574
    .local v15, "declaringPackage":Landroid/content/pm/VersionedPackage;
    invoke-virtual {v15}, Landroid/content/pm/VersionedPackage;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-static {v0, v2}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_76

    .line 5575
    goto :goto_d0

    .line 5578
    :cond_76
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v16
    :try_end_7a
    .catchall {:try_start_42 .. :try_end_7a} :catchall_f2

    .line 5580
    .local v16, "identity":J
    const/high16 v0, 0x4000000

    or-int/2addr v0, v3

    :try_start_7d
    invoke-virtual {v1, v15, v0, v10}, Lcom/android/server/pm/PackageManagerService;->getPackageInfoVersioned(Landroid/content/pm/VersionedPackage;II)Landroid/content/pm/PackageInfo;

    move-result-object v0
    :try_end_81
    .catchall {:try_start_7d .. :try_end_81} :catchall_d6

    .line 5582
    .local v0, "packageInfo":Landroid/content/pm/PackageInfo;
    if-nez v0, :cond_87

    .line 5586
    :try_start_83
    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_d0

    .end local v0  # "packageInfo":Landroid/content/pm/PackageInfo;
    :cond_87
    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5587
    nop

    .line 5589
    new-instance v0, Landroid/content/pm/SharedLibraryInfo;

    .line 5590
    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getPath()Ljava/lang/String;

    move-result-object v19

    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v20

    .line 5591
    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getAllCodePaths()Ljava/util/List;

    move-result-object v21

    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v22

    .line 5592
    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v23

    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getType()I

    move-result v25

    .line 5593
    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v26

    invoke-direct {v1, v14, v3, v10}, Lcom/android/server/pm/PackageManagerService;->getPackagesUsingSharedLibraryLPr(Landroid/content/pm/SharedLibraryInfo;II)Ljava/util/List;

    move-result-object v27

    .line 5594
    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getDependencies()Ljava/util/List;

    move-result-object v18

    if-nez v18, :cond_b6

    .line 5595
    :goto_b3
    move-object/from16 v28, v4

    goto :goto_c0

    :cond_b6
    new-instance v4, Ljava/util/ArrayList;

    invoke-virtual {v14}, Landroid/content/pm/SharedLibraryInfo;->getDependencies()Ljava/util/List;

    move-result-object v1

    invoke-direct {v4, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    goto :goto_b3

    :goto_c0
    move-object/from16 v18, v0

    invoke-direct/range {v18 .. v28}, Landroid/content/pm/SharedLibraryInfo;-><init>(Ljava/lang/String;Ljava/lang/String;Ljava/util/List;Ljava/lang/String;JILandroid/content/pm/VersionedPackage;Ljava/util/List;Ljava/util/List;)V

    .line 5597
    .local v0, "resultLibraryInfo":Landroid/content/pm/SharedLibraryInfo;
    if-nez v13, :cond_cd

    .line 5598
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    move-object v13, v1

    .line 5600
    :cond_cd
    invoke-interface {v13, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 5570
    .end local v0  # "resultLibraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v14  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v15  # "declaringPackage":Landroid/content/pm/VersionedPackage;
    .end local v16  # "identity":J
    :goto_d0
    add-int/lit8 v12, v12, 0x1

    const/4 v4, 0x0

    move-object/from16 v1, p0

    goto :goto_5d

    .line 5586
    .restart local v14  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .restart local v15  # "declaringPackage":Landroid/content/pm/VersionedPackage;
    .restart local v16  # "identity":J
    :catchall_d6
    move-exception v0

    move-object v1, v0

    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local v11  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "flags":I
    .end local p3  # "userId":I
    throw v1

    .line 5570
    .end local v14  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v15  # "declaringPackage":Landroid/content/pm/VersionedPackage;
    .end local v16  # "identity":J
    .restart local v11  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "flags":I
    .restart local p3  # "userId":I
    :cond_dc
    move-object v0, v13

    .line 5563
    .end local v8  # "versionedLibrary":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v9  # "versionCount":I
    .end local v12  # "j":I
    .end local v13  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .local v0, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    :goto_dd
    add-int/lit8 v7, v7, 0x1

    const/4 v4, 0x0

    move-object/from16 v1, p0

    goto/16 :goto_49

    .line 5604
    .end local v7  # "i":I
    :cond_e4
    if-eqz v0, :cond_ee

    new-instance v4, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v4, v0}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    move-object/from16 v29, v4

    goto :goto_f0

    :cond_ee
    const/16 v29, 0x0

    :goto_f0
    monitor-exit v5

    return-object v29

    .line 5605
    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v6  # "libraryCount":I
    :catchall_f2
    move-exception v0

    monitor-exit v5
    :try_end_f4
    .catchall {:try_start_83 .. :try_end_f4} :catchall_f2

    throw v0
.end method

.method public getDefaultAppsBackup(I)[B
    .registers 7
    .param p1, "userId"  # I

    .line 21624
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_53

    .line 21628
    new-instance v0, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v0}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 21630
    .local v0, "dataStream":Ljava/io/ByteArrayOutputStream;
    const/4 v1, 0x0

    :try_start_e
    new-instance v2, Lcom/android/internal/util/FastXmlSerializer;

    invoke-direct {v2}, Lcom/android/internal/util/FastXmlSerializer;-><init>()V

    .line 21631
    .local v2, "serializer":Lorg/xmlpull/v1/XmlSerializer;
    sget-object v3, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;

    invoke-virtual {v3}, Ljava/nio/charset/Charset;->name()Ljava/lang/String;

    move-result-object v3

    invoke-interface {v2, v0, v3}, Lorg/xmlpull/v1/XmlSerializer;->setOutput(Ljava/io/OutputStream;Ljava/lang/String;)V

    .line 21632
    const/4 v3, 0x1

    invoke-static {v3}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v3

    invoke-interface {v2, v1, v3}, Lorg/xmlpull/v1/XmlSerializer;->startDocument(Ljava/lang/String;Ljava/lang/Boolean;)V

    .line 21633
    const-string v3, "da"

    invoke-interface {v2, v1, v3}, Lorg/xmlpull/v1/XmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    .line 21635
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3
    :try_end_2c
    .catch Ljava/lang/Exception; {:try_start_e .. :try_end_2c} :catch_46

    .line 21636
    :try_start_2c
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, v2, p1}, Lcom/android/server/pm/Settings;->writeDefaultAppsLPr(Lorg/xmlpull/v1/XmlSerializer;I)V

    .line 21637
    monitor-exit v3
    :try_end_32
    .catchall {:try_start_2c .. :try_end_32} :catchall_43

    .line 21639
    :try_start_32
    const-string v3, "da"

    invoke-interface {v2, v1, v3}, Lorg/xmlpull/v1/XmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    .line 21640
    invoke-interface {v2}, Lorg/xmlpull/v1/XmlSerializer;->endDocument()V

    .line 21641
    invoke-interface {v2}, Lorg/xmlpull/v1/XmlSerializer;->flush()V
    :try_end_3d
    .catch Ljava/lang/Exception; {:try_start_32 .. :try_end_3d} :catch_46

    .line 21647
    .end local v2  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    nop

    .line 21649
    invoke-virtual {v0}, Ljava/io/ByteArrayOutputStream;->toByteArray()[B

    move-result-object v1

    return-object v1

    .line 21637
    .restart local v2  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    :catchall_43
    move-exception v4

    :try_start_44
    monitor-exit v3
    :try_end_45
    .catchall {:try_start_44 .. :try_end_45} :catchall_43

    .end local v0  # "dataStream":Ljava/io/ByteArrayOutputStream;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "userId":I
    :try_start_45
    throw v4
    :try_end_46
    .catch Ljava/lang/Exception; {:try_start_45 .. :try_end_46} :catch_46

    .line 21642
    .end local v2  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    .restart local v0  # "dataStream":Ljava/io/ByteArrayOutputStream;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "userId":I
    :catch_46
    move-exception v2

    .line 21643
    .local v2, "e":Ljava/lang/Exception;
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v3, :cond_52

    .line 21644
    const-string v3, "PackageManager"

    const-string v4, "Unable to write default apps for backup"

    invoke-static {v3, v4, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 21646
    :cond_52
    return-object v1

    .line 21625
    .end local v0  # "dataStream":Ljava/io/ByteArrayOutputStream;
    .end local v2  # "e":Ljava/lang/Exception;
    :cond_53
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Only the system may call getDefaultAppsBackup()"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public getDefaultBrowserPackageName(I)Ljava/lang/String;
    .registers 6
    .param p1, "userId"  # I

    .line 15050
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    const/4 v1, 0x0

    if-eq v0, p1, :cond_e

    .line 15051
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v2, "android.permission.INTERACT_ACROSS_USERS_FULL"

    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 15054
    :cond_e
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_19

    .line 15055
    return-object v1

    .line 15058
    :cond_19
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 15059
    :try_start_1c
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultBrowserProvider:Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;

    .line 15060
    .local v2, "provider":Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;
    monitor-exit v0
    :try_end_1f
    .catchall {:try_start_1c .. :try_end_1f} :catchall_2f

    .line 15061
    if-nez v2, :cond_2a

    .line 15062
    const-string v0, "PackageManager"

    const-string/jumbo v3, "mDefaultBrowserProvider is null"

    invoke-static {v0, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 15063
    return-object v1

    .line 15065
    :cond_2a
    invoke-interface {v2, p1}, Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;->getDefaultBrowser(I)Ljava/lang/String;

    move-result-object v0

    return-object v0

    .line 15060
    .end local v2  # "provider":Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;
    :catchall_2f
    move-exception v1

    :try_start_30
    monitor-exit v0
    :try_end_31
    .catchall {:try_start_30 .. :try_end_31} :catchall_2f

    throw v1
.end method

.method getDexManager()Lcom/android/server/pm/dex/DexManager;
    .registers 2

    .line 10551
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    return-object v0
.end method

.method public getFlagsForUid(I)I
    .registers 9
    .param p1, "uid"  # I

    .line 6744
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 6745
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    const/4 v2, 0x0

    if-eqz v1, :cond_c

    .line 6746
    return v2

    .line 6748
    :cond_c
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v1

    .line 6749
    .local v1, "appId":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 6750
    :try_start_13
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, v1}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v4

    .line 6751
    .local v4, "obj":Ljava/lang/Object;
    instance-of v5, v4, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v5, :cond_24

    .line 6752
    move-object v2, v4

    check-cast v2, Lcom/android/server/pm/SharedUserSetting;

    .line 6753
    .local v2, "sus":Lcom/android/server/pm/SharedUserSetting;
    iget v5, v2, Lcom/android/server/pm/SharedUserSetting;->pkgFlags:I

    monitor-exit v3

    return v5

    .line 6754
    .end local v2  # "sus":Lcom/android/server/pm/SharedUserSetting;
    :cond_24
    instance-of v5, v4, Lcom/android/server/pm/PackageSetting;

    if-eqz v5, :cond_3b

    .line 6755
    move-object v5, v4

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 6756
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v6

    invoke-direct {p0, v5, v0, v6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v6

    if-eqz v6, :cond_37

    .line 6757
    monitor-exit v3

    return v2

    .line 6759
    :cond_37
    iget v2, v5, Lcom/android/server/pm/PackageSetting;->pkgFlags:I

    monitor-exit v3

    return v2

    .line 6761
    .end local v4  # "obj":Ljava/lang/Object;
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_3b
    monitor-exit v3

    .line 6762
    return v2

    .line 6761
    :catchall_3d
    move-exception v2

    monitor-exit v3
    :try_end_3f
    .catchall {:try_start_13 .. :try_end_3f} :catchall_3d

    throw v2
.end method

.method public getHarmfulAppWarning(Ljava/lang/String;I)Ljava/lang/CharSequence;
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26497
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 26498
    .local v6, "callingUid":I
    invoke-static {v6}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v7

    .line 26500
    .local v7, "callingAppId":I
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v3, 0x1

    const/4 v4, 0x1

    const-string v5, "getHarmfulAppInfo"

    move v1, v6

    move v2, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 26503
    const/16 v0, 0x3e8

    if-eq v7, v0, :cond_2a

    if-eqz v7, :cond_2a

    .line 26504
    const-string v0, "android.permission.SET_HARMFUL_APP_WARNINGS"

    invoke-virtual {p0, v0, v6}, Lcom/android/server/pm/PackageManagerService;->checkUidPermission(Ljava/lang/String;I)I

    move-result v0

    if-nez v0, :cond_22

    goto :goto_2a

    .line 26505
    :cond_22
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Caller must have the android.permission.SET_HARMFUL_APP_WARNINGS permission."

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 26509
    :cond_2a
    :goto_2a
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26510
    :try_start_2d
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/Settings;->getHarmfulAppWarningLPr(Ljava/lang/String;I)Ljava/lang/String;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 26511
    :catchall_35
    move-exception v1

    monitor-exit v0
    :try_end_37
    .catchall {:try_start_2d .. :try_end_37} :catchall_35

    throw v1
.end method

.method public getHomeActivities(Ljava/util/List;)Landroid/content/ComponentName;
    .registers 3
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;)",
            "Landroid/content/ComponentName;"
        }
    .end annotation

    .line 21811
    .local p1, "allHomeCandidates":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_c

    .line 21812
    const/4 v0, 0x0

    return-object v0

    .line 21814
    :cond_c
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    invoke-virtual {p0, p1, v0}, Lcom/android/server/pm/PackageManagerService;->getHomeActivitiesAsUser(Ljava/util/List;I)Landroid/content/ComponentName;

    move-result-object v0

    return-object v0
.end method

.method getHomeActivitiesAsUser(Ljava/util/List;I)Landroid/content/ComponentName;
    .registers 13
    .param p2, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/pm/ResolveInfo;",
            ">;I)",
            "Landroid/content/ComponentName;"
        }
    .end annotation

    .line 21901
    .local p1, "allHomeCandidates":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getHomeIntent()Landroid/content/Intent;

    move-result-object v0

    .line 21902
    .local v0, "intent":Landroid/content/Intent;
    const/4 v1, 0x0

    const/16 v2, 0x80

    invoke-direct {p0, v0, v1, v2, p2}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v2

    .line 21904
    .local v2, "resolveInfos":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    invoke-interface {p1}, Ljava/util/List;->clear()V

    .line 21905
    if-nez v2, :cond_11

    .line 21906
    return-object v1

    .line 21908
    :cond_11
    invoke-interface {p1, v2}, Ljava/util/List;->addAll(Ljava/util/Collection;)Z

    .line 21911
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 21912
    :try_start_17
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultHomeProvider:Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;

    .line 21913
    .local v4, "provider":Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;
    monitor-exit v3
    :try_end_1a
    .catchall {:try_start_17 .. :try_end_1a} :catchall_59

    .line 21914
    if-nez v4, :cond_25

    .line 21915
    const-string v3, "PackageManager"

    const-string/jumbo v5, "mDefaultHomeProvider is null"

    invoke-static {v3, v5}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 21916
    return-object v1

    .line 21918
    :cond_25
    invoke-interface {v4, p2}, Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;->getDefaultHome(I)Ljava/lang/String;

    move-result-object v3

    .line 21919
    .local v3, "packageName":Ljava/lang/String;
    if-nez v3, :cond_2c

    .line 21920
    return-object v1

    .line 21922
    :cond_2c
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v5

    .line 21923
    .local v5, "resolveInfosSize":I
    const/4 v6, 0x0

    .local v6, "i":I
    :goto_31
    if-ge v6, v5, :cond_58

    .line 21924
    invoke-interface {v2, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Landroid/content/pm/ResolveInfo;

    .line 21926
    .local v7, "resolveInfo":Landroid/content/pm/ResolveInfo;
    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    if-eqz v8, :cond_55

    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-static {v8, v3}, Landroid/text/TextUtils;->equals(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Z

    move-result v8

    if-eqz v8, :cond_55

    .line 21928
    new-instance v1, Landroid/content/ComponentName;

    iget-object v8, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v9, v7, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v9, v9, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v1, v8, v9}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    return-object v1

    .line 21923
    .end local v7  # "resolveInfo":Landroid/content/pm/ResolveInfo;
    :cond_55
    add-int/lit8 v6, v6, 0x1

    goto :goto_31

    .line 21932
    .end local v6  # "i":I
    :cond_58
    return-object v1

    .line 21913
    .end local v3  # "packageName":Ljava/lang/String;
    .end local v4  # "provider":Landroid/content/pm/PackageManagerInternal$DefaultHomeProvider;
    .end local v5  # "resolveInfosSize":I
    :catchall_59
    move-exception v1

    :try_start_5a
    monitor-exit v3
    :try_end_5b
    .catchall {:try_start_5a .. :try_end_5b} :catchall_59

    throw v1
.end method

.method public getIncidentReportApproverPackageName()Ljava/lang/String;
    .registers 3

    .line 22141
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const v1, 0x1040181

    invoke-virtual {v0, v1}, Landroid/content/Context;->getString(I)Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->ensureSystemPackageName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method public getInstallLocation()I
    .registers 4

    .line 24624
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string v1, "default_install_location"

    const/4 v2, 0x0

    invoke-static {v0, v1, v2}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v0

    return v0
.end method

.method public getInstallReason(Ljava/lang/String;I)I
    .registers 10
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26312
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 26313
    .local v6, "callingUid":I
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v3, 0x1

    const/4 v4, 0x0

    const-string v5, "get install reason"

    move v1, v6

    move v2, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 26316
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26317
    :try_start_12
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 26318
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v1, v6, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v2

    const/4 v3, 0x0

    if-eqz v2, :cond_25

    .line 26319
    monitor-exit v0

    return v3

    .line 26321
    :cond_25
    if-eqz v1, :cond_2d

    .line 26322
    invoke-virtual {v1, p2}, Lcom/android/server/pm/PackageSetting;->getInstallReason(I)I

    move-result v2

    monitor-exit v0

    return v2

    .line 26324
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_2d
    monitor-exit v0

    .line 26325
    return v3

    .line 26324
    :catchall_2f
    move-exception v1

    monitor-exit v0
    :try_end_31
    .catchall {:try_start_12 .. :try_end_31} :catchall_2f

    throw v1
.end method

.method public getInstalledApplications(II)Landroid/content/pm/ParceledListSlice;
    .registers 6
    .param p1, "flags"  # I
    .param p2, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/ApplicationInfo;",
            ">;"
        }
    .end annotation

    .line 9055
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 9056
    .local v0, "callingUid":I
    new-instance v1, Landroid/content/pm/ParceledListSlice;

    .line 9057
    invoke-direct {p0, p1, p2, v0}, Lcom/android/server/pm/PackageManagerService;->getInstalledApplicationsListInternal(III)Ljava/util/List;

    move-result-object v2

    invoke-direct {v1, v2}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    .line 9056
    return-object v1
.end method

.method public getInstalledModules(I)Ljava/util/List;
    .registers 3
    .param p1, "flags"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(I)",
            "Ljava/util/List<",
            "Landroid/content/pm/ModuleInfo;",
            ">;"
        }
    .end annotation

    .line 5711
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mModuleInfoProvider:Lcom/android/server/pm/ModuleInfoProvider;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/ModuleInfoProvider;->getInstalledModules(I)Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method public getInstalledPackages(II)Landroid/content/pm/ParceledListSlice;
    .registers 16
    .param p1, "flags"  # I
    .param p2, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/PackageInfo;",
            ">;"
        }
    .end annotation

    .line 8859
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 8860
    .local v6, "callingUid":I
    invoke-direct {p0, v6}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_f

    .line 8861
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v0

    return-object v0

    .line 8863
    :cond_f
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p2}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_1c

    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v0

    return-object v0

    .line 8864
    :cond_1c
    const/4 v0, 0x0

    invoke-direct {p0, p1, p2, v0}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForPackage(IILjava/lang/Object;)I

    move-result p1

    .line 8865
    const v0, 0x402000

    and-int/2addr v0, p1

    const/4 v1, 0x1

    const/4 v2, 0x0

    if-eqz v0, :cond_2b

    move v0, v1

    goto :goto_2c

    :cond_2b
    move v0, v2

    :goto_2c
    move v7, v0

    .line 8866
    .local v7, "listUninstalled":Z
    const/high16 v0, 0x40000000  # 2.0f

    and-int/2addr v0, p1

    if-eqz v0, :cond_34

    move v0, v1

    goto :goto_35

    :cond_34
    move v0, v2

    :goto_35
    move v8, v0

    .line 8867
    .local v8, "listApex":Z
    const/high16 v0, 0x200000

    and-int/2addr v0, p1

    if-eqz v0, :cond_3c

    goto :goto_3d

    :cond_3c
    move v1, v2

    :goto_3d
    move v9, v1

    .line 8869
    .local v9, "listFactory":Z
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "get installed packages"

    move v1, v6

    move v2, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 8873
    const/4 v0, 0x0

    .line 8874
    .local v0, "callOutOfSystem":Z
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v1

    invoke-static {}, Landroid/os/Process;->myPid()I

    move-result v2

    if-eq v1, v2, :cond_55

    .line 8875
    const/4 v0, 0x1

    .line 8880
    :cond_55
    const/16 v1, 0x38

    .line 8881
    invoke-static {v1}, Lmeizu/security/FlymePermissionManager;->isFlymePermissionGranted(I)Z

    move-result v1

    if-nez v1, :cond_68

    .line 8882
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 8883
    .local v1, "empty":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageInfo;>;"
    new-instance v2, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v2, v1}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    return-object v2

    .line 8888
    .end local v1  # "empty":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageInfo;>;"
    :cond_68
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 8890
    if-eqz v7, :cond_d7

    .line 8891
    :try_start_6d
    new-instance v2, Ljava/util/ArrayList;

    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->size()I

    move-result v3

    invoke-direct {v2, v3}, Ljava/util/ArrayList;-><init>(I)V

    .line 8892
    .local v2, "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageInfo;>;"
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :goto_86
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_d5

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 8893
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v4, v6, p2, p1}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v5

    if-eqz v5, :cond_99

    .line 8894
    goto :goto_86

    .line 8896
    :cond_99
    invoke-direct {p0, v4, v6, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v5

    if-eqz v5, :cond_a0

    .line 8897
    goto :goto_86

    .line 8899
    :cond_a0
    invoke-direct {p0, v4, p1, p2}, Lcom/android/server/pm/PackageManagerService;->generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;

    move-result-object v5

    .line 8900
    .local v5, "pi":Landroid/content/pm/PackageInfo;
    if-eqz v5, :cond_d4

    .line 8902
    iget-boolean v10, p0, Lcom/android/server/pm/PackageManagerService;->runningGtsInstall:Z

    if-eqz v10, :cond_b5

    sget-object v10, Lcom/android/CtsStateMonitor;->MEIZU_CTSINSTALL_PACKAGES_WHITELIST:Ljava/util/ArrayList;

    iget-object v11, v5, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    .line 8903
    invoke-virtual {v10, v11}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v10

    if-eqz v10, :cond_b5

    .line 8904
    goto :goto_86

    .line 8906
    :cond_b5
    iget-boolean v10, p0, Lcom/android/server/pm/PackageManagerService;->runningGtsPermission:Z

    if-eqz v10, :cond_c4

    sget-object v10, Lcom/android/CtsStateMonitor;->MEIZU_DEFAULT_PERMISSION_PACKAGES_WHITELIST:Ljava/util/ArrayList;

    iget-object v11, v5, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    .line 8908
    invoke-virtual {v10, v11}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v10

    if-eqz v10, :cond_c4

    .line 8909
    goto :goto_86

    .line 8913
    :cond_c4
    if-eqz v0, :cond_d1

    const-string v10, "com.meizu.regservice"

    iget-object v11, v5, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v10

    if-eqz v10, :cond_d1

    .line 8915
    goto :goto_86

    .line 8918
    :cond_d1
    invoke-virtual {v2, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 8920
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "pi":Landroid/content/pm/PackageInfo;
    :cond_d4
    goto :goto_86

    :cond_d5
    goto/16 :goto_143

    .line 8922
    .end local v2  # "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageInfo;>;"
    :cond_d7
    new-instance v2, Ljava/util/ArrayList;

    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->size()I

    move-result v3

    invoke-direct {v2, v3}, Ljava/util/ArrayList;-><init>(I)V

    .line 8923
    .restart local v2  # "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageInfo;>;"
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :goto_ec
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_143

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/PackageParser$Package;

    .line 8924
    .local v4, "p":Landroid/content/pm/PackageParser$Package;
    iget-object v5, v4, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 8925
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v5, v6, p2, p1}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v10

    if-eqz v10, :cond_103

    .line 8926
    goto :goto_ec

    .line 8928
    :cond_103
    invoke-direct {p0, v5, v6, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v10

    if-eqz v10, :cond_10a

    .line 8929
    goto :goto_ec

    .line 8931
    :cond_10a
    iget-object v10, v4, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v10, Lcom/android/server/pm/PackageSetting;

    invoke-direct {p0, v10, p1, p2}, Lcom/android/server/pm/PackageManagerService;->generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;

    move-result-object v10

    .line 8933
    .local v10, "pi":Landroid/content/pm/PackageInfo;
    if-eqz v10, :cond_142

    .line 8936
    iget-boolean v11, p0, Lcom/android/server/pm/PackageManagerService;->runningGtsInstall:Z

    if-eqz v11, :cond_123

    sget-object v11, Lcom/android/CtsStateMonitor;->MEIZU_CTSINSTALL_PACKAGES_WHITELIST:Ljava/util/ArrayList;

    iget-object v12, v10, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    .line 8937
    invoke-virtual {v11, v12}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_123

    .line 8938
    goto :goto_ec

    .line 8940
    :cond_123
    iget-boolean v11, p0, Lcom/android/server/pm/PackageManagerService;->runningGtsPermission:Z

    if-eqz v11, :cond_132

    sget-object v11, Lcom/android/CtsStateMonitor;->MEIZU_DEFAULT_PERMISSION_PACKAGES_WHITELIST:Ljava/util/ArrayList;

    iget-object v12, v10, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    .line 8942
    invoke-virtual {v11, v12}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_132

    .line 8943
    goto :goto_ec

    .line 8947
    :cond_132
    if-eqz v0, :cond_13f

    const-string v11, "com.meizu.regservice"

    iget-object v12, v10, Landroid/content/pm/PackageInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_13f

    .line 8949
    goto :goto_ec

    .line 8952
    :cond_13f
    invoke-virtual {v2, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 8954
    .end local v4  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v10  # "pi":Landroid/content/pm/PackageInfo;
    :cond_142
    goto :goto_ec

    .line 8956
    :cond_143
    :goto_143
    if-eqz v8, :cond_165

    .line 8957
    if-eqz v9, :cond_151

    .line 8958
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    invoke-virtual {v3}, Lcom/android/server/pm/ApexManager;->getFactoryPackages()Ljava/util/List;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    goto :goto_15a

    .line 8960
    :cond_151
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    invoke-virtual {v3}, Lcom/android/server/pm/ApexManager;->getActivePackages()Ljava/util/List;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    .line 8962
    :goto_15a
    if-eqz v7, :cond_165

    .line 8963
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    invoke-virtual {v3}, Lcom/android/server/pm/ApexManager;->getInactivePackages()Ljava/util/List;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    .line 8966
    :cond_165
    new-instance v3, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v3, v2}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    monitor-exit v1

    return-object v3

    .line 8967
    .end local v2  # "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageInfo;>;"
    :catchall_16c
    move-exception v2

    monitor-exit v1
    :try_end_16e
    .catchall {:try_start_6d .. :try_end_16e} :catchall_16c

    throw v2
.end method

.method public getInstallerPackageName(Ljava/lang/String;)Ljava/lang/String;
    .registers 7
    .param p1, "packageName"  # Ljava/lang/String;

    .line 22494
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 22495
    .local v0, "callingUid":I
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 22496
    :try_start_7
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 22497
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v3

    invoke-direct {p0, v2, v0, v3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    const/4 v4, 0x0

    if-eqz v3, :cond_1e

    .line 22498
    monitor-exit v1

    return-object v4

    .line 22501
    :cond_1e
    if-nez v2, :cond_2a

    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    invoke-virtual {v3, p1}, Lcom/android/server/pm/ApexManager;->isApexPackage(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_2a

    .line 22502
    monitor-exit v1

    return-object v4

    .line 22504
    :cond_2a
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, p1}, Lcom/android/server/pm/Settings;->getInstallerPackageNameLPr(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    monitor-exit v1

    return-object v3

    .line 22505
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_32
    move-exception v2

    monitor-exit v1
    :try_end_34
    .catchall {:try_start_7 .. :try_end_34} :catchall_32

    throw v2
.end method

.method public getInstantAppAndroidId(Ljava/lang/String;I)Ljava/lang/String;
    .registers 12
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26392
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.ACCESS_INSTANT_APPS"

    const-string v2, "getInstantAppAndroidId"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 26394
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v4

    const/4 v6, 0x1

    const/4 v7, 0x0

    const-string v8, "getInstantAppAndroidId"

    move v5, p2

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 26398
    invoke-virtual {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->isInstantApp(Ljava/lang/String;I)Z

    move-result v0

    if-nez v0, :cond_1f

    .line 26399
    const/4 v0, 0x0

    return-object v0

    .line 26401
    :cond_1f
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26402
    :try_start_22
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/InstantAppRegistry;->getInstantAppAndroidIdLPw(Ljava/lang/String;I)Ljava/lang/String;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 26403
    :catchall_2a
    move-exception v1

    monitor-exit v0
    :try_end_2c
    .catchall {:try_start_22 .. :try_end_2c} :catchall_2a

    throw v1
.end method

.method public getInstantAppCookie(Ljava/lang/String;I)[B
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 9217
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    const/4 v3, 0x1

    const/4 v4, 0x0

    const-string v5, "getInstantAppCookie"

    move v2, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 9220
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, p1, v0}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v0

    if-nez v0, :cond_1a

    .line 9221
    const/4 v0, 0x0

    return-object v0

    .line 9223
    :cond_1a
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 9224
    :try_start_1d
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/InstantAppRegistry;->getInstantAppCookieLPw(Ljava/lang/String;I)[B

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 9226
    :catchall_25
    move-exception v1

    monitor-exit v0
    :try_end_27
    .catchall {:try_start_1d .. :try_end_27} :catchall_25

    throw v1
.end method

.method public getInstantAppIcon(Ljava/lang/String;I)Landroid/graphics/Bitmap;
    .registers 12
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 9253
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0, p2}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v0

    if-nez v0, :cond_13

    .line 9254
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.ACCESS_INSTANT_APPS"

    const-string v2, "getInstantAppIcon"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 9257
    :cond_13
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v4

    const/4 v6, 0x1

    const/4 v7, 0x0

    const-string v8, "getInstantAppIcon"

    move v5, p2

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 9261
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 9262
    :try_start_24
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/InstantAppRegistry;->getInstantAppIconLPw(Ljava/lang/String;I)Landroid/graphics/Bitmap;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 9264
    :catchall_2c
    move-exception v1

    monitor-exit v0
    :try_end_2e
    .catchall {:try_start_24 .. :try_end_2e} :catchall_2c

    throw v1
.end method

.method public getInstantAppInstallerComponent()Landroid/content/ComponentName;
    .registers 3

    .line 26383
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    const/4 v1, 0x0

    if-eqz v0, :cond_c

    .line 26384
    return-object v1

    .line 26386
    :cond_c
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppInstallerActivity:Landroid/content/pm/ActivityInfo;

    if-nez v0, :cond_11

    .line 26387
    goto :goto_15

    :cond_11
    invoke-virtual {v0}, Landroid/content/pm/ActivityInfo;->getComponentName()Landroid/content/ComponentName;

    move-result-object v1

    .line 26386
    :goto_15
    return-object v1
.end method

.method public getInstantAppResolverComponent()Landroid/content/ComponentName;
    .registers 4

    .line 4046
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    const/4 v1, 0x0

    if-eqz v0, :cond_c

    .line 4047
    return-object v1

    .line 4049
    :cond_c
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 4050
    :try_start_f
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppResolverLPr()Landroid/util/Pair;

    move-result-object v2

    .line 4051
    .local v2, "instantAppResolver":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    if-nez v2, :cond_17

    .line 4052
    monitor-exit v0

    return-object v1

    .line 4054
    :cond_17
    iget-object v1, v2, Landroid/util/Pair;->first:Ljava/lang/Object;

    check-cast v1, Landroid/content/ComponentName;

    monitor-exit v0

    return-object v1

    .line 4055
    .end local v2  # "instantAppResolver":Landroid/util/Pair;, "Landroid/util/Pair<Landroid/content/ComponentName;Ljava/lang/String;>;"
    :catchall_1d
    move-exception v1

    monitor-exit v0
    :try_end_1f
    .catchall {:try_start_f .. :try_end_1f} :catchall_1d

    throw v1
.end method

.method public getInstantAppResolverSettingsComponent()Landroid/content/ComponentName;
    .registers 2

    .line 26378
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppResolverSettingsComponent:Landroid/content/ComponentName;

    return-object v0
.end method

.method public getInstantApps(I)Landroid/content/pm/ParceledListSlice;
    .registers 11
    .param p1, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(I)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/InstantAppInfo;",
            ">;"
        }
    .end annotation

    .line 9165
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0, p1}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v0

    if-nez v0, :cond_13

    .line 9166
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.ACCESS_INSTANT_APPS"

    const-string v2, "getEphemeralApplications"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 9169
    :cond_13
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v4

    const/4 v6, 0x1

    const/4 v7, 0x0

    const-string v8, "getEphemeralApplications"

    move v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 9172
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 9173
    :try_start_24
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    .line 9174
    invoke-virtual {v1, p1}, Lcom/android/server/pm/InstantAppRegistry;->getInstantAppsLPr(I)Ljava/util/List;

    move-result-object v1

    .line 9175
    .local v1, "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/InstantAppInfo;>;"
    if-eqz v1, :cond_33

    .line 9176
    new-instance v2, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v2, v1}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    monitor-exit v0

    return-object v2

    .line 9178
    .end local v1  # "instantApps":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/InstantAppInfo;>;"
    :cond_33
    monitor-exit v0

    .line 9179
    const/4 v0, 0x0

    return-object v0

    .line 9178
    :catchall_36
    move-exception v1

    monitor-exit v0
    :try_end_38
    .catchall {:try_start_24 .. :try_end_38} :catchall_36

    throw v1
.end method

.method public getInstrumentationInfo(Landroid/content/ComponentName;I)Landroid/content/pm/InstrumentationInfo;
    .registers 12
    .param p1, "component"  # Landroid/content/ComponentName;
    .param p2, "flags"  # I

    .line 9407
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 9408
    :try_start_3
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    .line 9409
    .local v3, "callingUid":I
    invoke-static {v3}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v6

    .line 9410
    .local v6, "callingUserId":I
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    move-object v7, v1

    .line 9411
    .local v7, "ps":Lcom/android/server/pm/PackageSetting;
    const/4 v8, 0x0

    if-nez v7, :cond_1f

    monitor-exit v0

    return-object v8

    .line 9412
    :cond_1f
    const/4 v5, 0x0

    move-object v1, p0

    move-object v2, v7

    move-object v4, p1

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v1

    if-eqz v1, :cond_2b

    .line 9413
    monitor-exit v0

    return-object v8

    .line 9415
    :cond_2b
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstrumentation:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Instrumentation;

    .line 9416
    .local v1, "i":Landroid/content/pm/PackageParser$Instrumentation;
    invoke-static {v1, p2}, Landroid/content/pm/PackageParser;->generateInstrumentationInfo(Landroid/content/pm/PackageParser$Instrumentation;I)Landroid/content/pm/InstrumentationInfo;

    move-result-object v2

    monitor-exit v0

    return-object v2

    .line 9417
    .end local v1  # "i":Landroid/content/pm/PackageParser$Instrumentation;
    .end local v3  # "callingUid":I
    .end local v6  # "callingUserId":I
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_39
    move-exception v1

    monitor-exit v0
    :try_end_3b
    .catchall {:try_start_3 .. :try_end_3b} :catchall_39

    throw v1
.end method

.method public getIntentFilterVerificationBackup(I)[B
    .registers 7
    .param p1, "userId"  # I

    .line 21685
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_55

    .line 21689
    new-instance v0, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v0}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 21691
    .local v0, "dataStream":Ljava/io/ByteArrayOutputStream;
    const/4 v1, 0x0

    :try_start_e
    new-instance v2, Lcom/android/internal/util/FastXmlSerializer;

    invoke-direct {v2}, Lcom/android/internal/util/FastXmlSerializer;-><init>()V

    .line 21692
    .local v2, "serializer":Lorg/xmlpull/v1/XmlSerializer;
    sget-object v3, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;

    invoke-virtual {v3}, Ljava/nio/charset/Charset;->name()Ljava/lang/String;

    move-result-object v3

    invoke-interface {v2, v0, v3}, Lorg/xmlpull/v1/XmlSerializer;->setOutput(Ljava/io/OutputStream;Ljava/lang/String;)V

    .line 21693
    const/4 v3, 0x1

    invoke-static {v3}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v3

    invoke-interface {v2, v1, v3}, Lorg/xmlpull/v1/XmlSerializer;->startDocument(Ljava/lang/String;Ljava/lang/Boolean;)V

    .line 21694
    const-string/jumbo v3, "iv"

    invoke-interface {v2, v1, v3}, Lorg/xmlpull/v1/XmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    .line 21696
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3
    :try_end_2d
    .catch Ljava/lang/Exception; {:try_start_e .. :try_end_2d} :catch_48

    .line 21697
    :try_start_2d
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, v2, p1}, Lcom/android/server/pm/Settings;->writeAllDomainVerificationsLPr(Lorg/xmlpull/v1/XmlSerializer;I)V

    .line 21698
    monitor-exit v3
    :try_end_33
    .catchall {:try_start_2d .. :try_end_33} :catchall_45

    .line 21700
    :try_start_33
    const-string/jumbo v3, "iv"

    invoke-interface {v2, v1, v3}, Lorg/xmlpull/v1/XmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    .line 21701
    invoke-interface {v2}, Lorg/xmlpull/v1/XmlSerializer;->endDocument()V

    .line 21702
    invoke-interface {v2}, Lorg/xmlpull/v1/XmlSerializer;->flush()V
    :try_end_3f
    .catch Ljava/lang/Exception; {:try_start_33 .. :try_end_3f} :catch_48

    .line 21708
    .end local v2  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    nop

    .line 21710
    invoke-virtual {v0}, Ljava/io/ByteArrayOutputStream;->toByteArray()[B

    move-result-object v1

    return-object v1

    .line 21698
    .restart local v2  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    :catchall_45
    move-exception v4

    :try_start_46
    monitor-exit v3
    :try_end_47
    .catchall {:try_start_46 .. :try_end_47} :catchall_45

    .end local v0  # "dataStream":Ljava/io/ByteArrayOutputStream;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "userId":I
    :try_start_47
    throw v4
    :try_end_48
    .catch Ljava/lang/Exception; {:try_start_47 .. :try_end_48} :catch_48

    .line 21703
    .end local v2  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    .restart local v0  # "dataStream":Ljava/io/ByteArrayOutputStream;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "userId":I
    :catch_48
    move-exception v2

    .line 21704
    .local v2, "e":Ljava/lang/Exception;
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v3, :cond_54

    .line 21705
    const-string v3, "PackageManager"

    const-string v4, "Unable to write default apps for backup"

    invoke-static {v3, v4, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 21707
    :cond_54
    return-object v1

    .line 21686
    .end local v0  # "dataStream":Ljava/io/ByteArrayOutputStream;
    .end local v2  # "e":Ljava/lang/Exception;
    :cond_55
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Only the system may call getIntentFilterVerificationBackup()"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public getIntentFilterVerifications(Ljava/lang/String;)Landroid/content/pm/ParceledListSlice;
    .registers 7
    .param p1, "packageName"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            ")",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/IntentFilterVerificationInfo;",
            ">;"
        }
    .end annotation

    .line 14955
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 14956
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    if-eqz v1, :cond_f

    .line 14957
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v1

    return-object v1

    .line 14959
    :cond_f
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 14960
    :try_start_12
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 14961
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v3

    invoke-direct {p0, v2, v0, v3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-eqz v3, :cond_2c

    .line 14962
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v3

    monitor-exit v1

    return-object v3

    .line 14964
    :cond_2c
    new-instance v3, Landroid/content/pm/ParceledListSlice;

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, p1}, Lcom/android/server/pm/Settings;->getIntentFilterVerificationsLPr(Ljava/lang/String;)Ljava/util/List;

    move-result-object v4

    invoke-direct {v3, v4}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    monitor-exit v1

    return-object v3

    .line 14965
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_39
    move-exception v2

    monitor-exit v1
    :try_end_3b
    .catchall {:try_start_12 .. :try_end_3b} :catchall_39

    throw v2
.end method

.method public getIntentVerificationStatus(Ljava/lang/String;I)I
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 14914
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 14915
    .local v0, "callingUid":I
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    if-eq v1, p2, :cond_22

    .line 14916
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "getIntentVerificationStatus"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "android.permission.INTERACT_ACROSS_USERS_FULL"

    invoke-virtual {v1, v3, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 14920
    :cond_22
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    const/4 v2, 0x0

    if-eqz v1, :cond_2a

    .line 14921
    return v2

    .line 14923
    :cond_2a
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 14924
    :try_start_2d
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 14925
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_4c

    .line 14926
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v4

    invoke-direct {p0, v3, v0, v4}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v4

    if-eqz v4, :cond_44

    goto :goto_4c

    .line 14929
    :cond_44
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, p1, p2}, Lcom/android/server/pm/Settings;->getIntentFilterVerificationStatusLPr(Ljava/lang/String;I)I

    move-result v2

    monitor-exit v1

    return v2

    .line 14927
    :cond_4c
    :goto_4c
    monitor-exit v1

    return v2

    .line 14930
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_4e
    move-exception v2

    monitor-exit v1
    :try_end_50
    .catchall {:try_start_2d .. :try_end_50} :catchall_4e

    throw v2
.end method

.method public getInternalAppList()Ljava/util/List;
    .registers 2
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 26827
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v0, v0, Lcom/android/server/pm/PackageDefaultOpService;->mPackageList:Ljava/util/ArrayList;

    return-object v0
.end method

.method public getKeySetByAlias(Ljava/lang/String;Ljava/lang/String;)Landroid/content/pm/KeySet;
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "alias"  # Ljava/lang/String;

    .line 24818
    if-eqz p1, :cond_91

    if-nez p2, :cond_6

    goto/16 :goto_91

    .line 24821
    :cond_6
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 24822
    :try_start_9
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 24823
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v1, :cond_61

    .line 24827
    iget-object v2, v1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 24828
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v4

    invoke-direct {p0, v2, v3, v4}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-nez v3, :cond_34

    .line 24832
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 24833
    .local v3, "ksms":Lcom/android/server/pm/KeySetManagerService;
    new-instance v4, Landroid/content/pm/KeySet;

    invoke-virtual {v3, p1, p2}, Lcom/android/server/pm/KeySetManagerService;->getKeySetByAliasAndPackageNameLPr(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/pm/KeySetHandle;

    move-result-object v5

    invoke-direct {v4, v5}, Landroid/content/pm/KeySet;-><init>(Landroid/os/IBinder;)V

    monitor-exit v0

    return-object v4

    .line 24829
    .end local v3  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_34
    const-string v3, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "KeySet requested for filtered package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 24830
    new-instance v3, Ljava/lang/IllegalArgumentException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unknown package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "alias":Ljava/lang/String;
    throw v3

    .line 24824
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "alias":Ljava/lang/String;
    :cond_61
    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "KeySet requested for unknown package: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 24825
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unknown package: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "alias":Ljava/lang/String;
    throw v2

    .line 24834
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "alias":Ljava/lang/String;
    :catchall_8e
    move-exception v1

    monitor-exit v0
    :try_end_90
    .catchall {:try_start_9 .. :try_end_90} :catchall_8e

    throw v1

    .line 24819
    :cond_91
    :goto_91
    const/4 v0, 0x0

    return-object v0
.end method

.method public getLastChosenActivity(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;
    .registers 16
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I

    .line 6924
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_c

    .line 6925
    const/4 v0, 0x0

    return-object v0

    .line 6927
    :cond_c
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    .line 6928
    .local v0, "userId":I
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v1, :cond_2a

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Querying last chosen activity for "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 6929
    :cond_2a
    invoke-direct {p0, p1, p2, p3, v0}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v11

    .line 6931
    .local v11, "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    move-object v1, p0

    move-object v2, p1

    move-object v3, p2

    move v4, p3

    move-object v5, v11

    move v10, v0

    invoke-virtual/range {v1 .. v10}, Lcom/android/server/pm/PackageManagerService;->findPreferredActivityNotLocked(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;IZZZI)Landroid/content/pm/ResolveInfo;

    move-result-object v1

    return-object v1
.end method

.method public getModuleInfo(Ljava/lang/String;I)Landroid/content/pm/ModuleInfo;
    .registers 4
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I

    .line 5706
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mModuleInfoProvider:Lcom/android/server/pm/ModuleInfoProvider;

    invoke-virtual {v0, p1, p2}, Lcom/android/server/pm/ModuleInfoProvider;->getModuleInfo(Ljava/lang/String;I)Landroid/content/pm/ModuleInfo;

    move-result-object v0

    return-object v0
.end method

.method public getMoveStatus(I)I
    .registers 5
    .param p1, "moveId"  # I

    .line 24586
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.MOUNT_UNMOUNT_FILESYSTEMS"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 24588
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;->access$5900(Lcom/android/server/pm/PackageManagerService$MoveCallbacks;)Landroid/util/SparseIntArray;

    move-result-object v0

    invoke-virtual {v0, p1}, Landroid/util/SparseIntArray;->get(I)I

    move-result v0

    return v0
.end method

.method public getNameForUid(I)Ljava/lang/String;
    .registers 9
    .param p1, "uid"  # I

    .line 6666
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 6667
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    const/4 v2, 0x0

    if-eqz v1, :cond_c

    .line 6668
    return-object v2

    .line 6670
    :cond_c
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v1

    .line 6671
    .local v1, "appId":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 6672
    :try_start_13
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, v1}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v4

    .line 6673
    .local v4, "obj":Ljava/lang/Object;
    instance-of v5, v4, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v5, :cond_3a

    .line 6674
    move-object v2, v4

    check-cast v2, Lcom/android/server/pm/SharedUserSetting;

    .line 6675
    .local v2, "sus":Lcom/android/server/pm/SharedUserSetting;
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    iget-object v6, v2, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, ":"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v2, Lcom/android/server/pm/SharedUserSetting;->userId:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    monitor-exit v3

    return-object v5

    .line 6676
    .end local v2  # "sus":Lcom/android/server/pm/SharedUserSetting;
    :cond_3a
    instance-of v5, v4, Lcom/android/server/pm/PackageSetting;

    if-eqz v5, :cond_51

    .line 6677
    move-object v5, v4

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 6678
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v6

    invoke-direct {p0, v5, v0, v6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v6

    if-eqz v6, :cond_4d

    .line 6679
    monitor-exit v3

    return-object v2

    .line 6681
    :cond_4d
    iget-object v2, v5, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    monitor-exit v3

    return-object v2

    .line 6683
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_51
    monitor-exit v3

    return-object v2

    .line 6684
    .end local v4  # "obj":Ljava/lang/Object;
    :catchall_53
    move-exception v2

    monitor-exit v3
    :try_end_55
    .catchall {:try_start_13 .. :try_end_55} :catchall_53

    throw v2
.end method

.method public getNamesForUids([I)[Ljava/lang/String;
    .registers 12
    .param p1, "uids"  # [I

    .line 6689
    const/4 v0, 0x0

    if-eqz p1, :cond_6a

    array-length v1, p1

    if-nez v1, :cond_7

    goto :goto_6a

    .line 6692
    :cond_7
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    .line 6693
    .local v1, "callingUid":I
    invoke-direct {p0, v1}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v2

    if-eqz v2, :cond_12

    .line 6694
    return-object v0

    .line 6696
    :cond_12
    array-length v2, p1

    new-array v2, v2, [Ljava/lang/String;

    .line 6697
    .local v2, "names":[Ljava/lang/String;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 6698
    :try_start_18
    array-length v4, p1

    add-int/lit8 v4, v4, -0x1

    .local v4, "i":I
    :goto_1b
    if-ltz v4, :cond_65

    .line 6699
    aget v5, p1, v4

    invoke-static {v5}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v5

    .line 6700
    .local v5, "appId":I
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v6, v5}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v6

    .line 6701
    .local v6, "obj":Ljava/lang/Object;
    instance-of v7, v6, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v7, :cond_47

    .line 6702
    move-object v7, v6

    check-cast v7, Lcom/android/server/pm/SharedUserSetting;

    .line 6703
    .local v7, "sus":Lcom/android/server/pm/SharedUserSetting;
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v9, "shared:"

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v7, Lcom/android/server/pm/SharedUserSetting;->name:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    aput-object v8, v2, v4

    .line 6704
    .end local v7  # "sus":Lcom/android/server/pm/SharedUserSetting;
    goto :goto_62

    :cond_47
    instance-of v7, v6, Lcom/android/server/pm/PackageSetting;

    if-eqz v7, :cond_60

    .line 6705
    move-object v7, v6

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 6706
    .local v7, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {v1}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v8

    invoke-direct {p0, v7, v1, v8}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v8

    if-eqz v8, :cond_5b

    .line 6707
    aput-object v0, v2, v4

    goto :goto_5f

    .line 6709
    :cond_5b
    iget-object v8, v7, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    aput-object v8, v2, v4

    .line 6711
    .end local v7  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_5f
    goto :goto_62

    .line 6712
    :cond_60
    aput-object v0, v2, v4

    .line 6698
    .end local v5  # "appId":I
    .end local v6  # "obj":Ljava/lang/Object;
    :goto_62
    add-int/lit8 v4, v4, -0x1

    goto :goto_1b

    .line 6715
    .end local v4  # "i":I
    :cond_65
    monitor-exit v3

    .line 6716
    return-object v2

    .line 6715
    :catchall_67
    move-exception v0

    monitor-exit v3
    :try_end_69
    .catchall {:try_start_18 .. :try_end_69} :catchall_67

    throw v0

    .line 6690
    .end local v1  # "callingUid":I
    .end local v2  # "names":[Ljava/lang/String;
    :cond_6a
    :goto_6a
    return-object v0
.end method

.method public getOptimizablePackages()Landroid/util/ArraySet;
    .registers 6
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Landroid/util/ArraySet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 10478
    new-instance v0, Landroid/util/ArraySet;

    invoke-direct {v0}, Landroid/util/ArraySet;-><init>()V

    .line 10479
    .local v0, "pkgs":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 10480
    :try_start_8
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_12
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_2a

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 10481
    .local v3, "p":Landroid/content/pm/PackageParser$Package;
    invoke-static {v3}, Lcom/android/server/pm/PackageDexOptimizer;->canOptimizePackage(Landroid/content/pm/PackageParser$Package;)Z

    move-result v4

    if-eqz v4, :cond_29

    .line 10482
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v4}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 10484
    .end local v3  # "p":Landroid/content/pm/PackageParser$Package;
    :cond_29
    goto :goto_12

    .line 10485
    :cond_2a
    monitor-exit v1

    .line 10486
    return-object v0

    .line 10485
    :catchall_2c
    move-exception v2

    monitor-exit v1
    :try_end_2e
    .catchall {:try_start_8 .. :try_end_2e} :catchall_2c

    throw v2
.end method

.method public getOrCreateCompilerPackageStats(Landroid/content/pm/PackageParser$Package;)Lcom/android/server/pm/CompilerStats$PackageStats;
    .registers 4
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;

    .line 26274
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    if-eqz v0, :cond_e

    .line 26275
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 26276
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    iget-boolean v1, v0, Lcom/android/server/pm/PackageSetting;->mzApp:Z

    if-eqz v1, :cond_e

    .line 26277
    const/4 v1, 0x0

    return-object v1

    .line 26281
    .end local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_e
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getOrCreateCompilerPackageStats(Ljava/lang/String;)Lcom/android/server/pm/CompilerStats$PackageStats;

    move-result-object v0

    return-object v0
.end method

.method public getOrCreateCompilerPackageStats(Ljava/lang/String;)Lcom/android/server/pm/CompilerStats$PackageStats;
    .registers 3
    .param p1, "pkgName"  # Ljava/lang/String;

    .line 26285
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mCompilerStats:Lcom/android/server/pm/CompilerStats;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/CompilerStats;->getOrCreatePackageStats(Ljava/lang/String;)Lcom/android/server/pm/CompilerStats$PackageStats;

    move-result-object v0

    return-object v0
.end method

.method public getPackageActivateState(Ljava/lang/String;)Z
    .registers 4
    .param p1, "pkgName"  # Ljava/lang/String;

    .line 26831
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v0, v0, Lcom/android/server/pm/PackageDefaultOpService;->mPackages:Ljava/util/HashMap;

    invoke-virtual {v0, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageDefaultOpService$Op;

    .line 26832
    .local v0, "pkg":Lcom/android/server/pm/PackageDefaultOpService$Op;
    if-eqz v0, :cond_f

    .line 26833
    iget-boolean v1, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->activate:Z

    return v1

    .line 26835
    :cond_f
    const/4 v1, 0x1

    return v1
.end method

.method public getPackageGids(Ljava/lang/String;II)[I
    .registers 12
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 4832
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p3}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    return-object v1

    .line 4833
    :cond_a
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 4834
    .local v0, "callingUid":I
    invoke-direct {p0, p2, p3, p1}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForPackage(IILjava/lang/Object;)I

    move-result p2

    .line 4835
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v7, "getPackageGids"

    move v3, v0

    move v4, p3

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 4839
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 4840
    :try_start_20
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 4841
    .local v3, "p":Landroid/content/pm/PackageParser$Package;
    if-eqz v3, :cond_46

    invoke-virtual {v3, p2}, Landroid/content/pm/PackageParser$Package;->isMatch(I)Z

    move-result v4

    if-eqz v4, :cond_46

    .line 4842
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 4843
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v4, v0, p3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v5

    if-eqz v5, :cond_3c

    .line 4844
    monitor-exit v2

    return-object v1

    .line 4848
    :cond_3c
    invoke-virtual {v4}, Lcom/android/server/pm/PackageSetting;->getPermissionsState()Lcom/android/server/pm/permission/PermissionsState;

    move-result-object v1

    invoke-virtual {v1, p3}, Lcom/android/server/pm/permission/PermissionsState;->computeGids(I)[I

    move-result-object v1

    monitor-exit v2

    return-object v1

    .line 4850
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_46
    const v4, 0x402000

    and-int/2addr v4, p2

    if-eqz v4, :cond_6e

    .line 4851
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 4852
    .restart local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v4, :cond_6e

    invoke-virtual {v4, p2}, Lcom/android/server/pm/PackageSetting;->isMatch(I)Z

    move-result v5

    if-eqz v5, :cond_6e

    .line 4853
    invoke-direct {p0, v4, v0, p3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v5

    if-nez v5, :cond_6e

    .line 4854
    invoke-virtual {v4}, Lcom/android/server/pm/PackageSetting;->getPermissionsState()Lcom/android/server/pm/permission/PermissionsState;

    move-result-object v1

    invoke-virtual {v1, p3}, Lcom/android/server/pm/permission/PermissionsState;->computeGids(I)[I

    move-result-object v1

    monitor-exit v2

    return-object v1

    .line 4857
    .end local v3  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_6e
    monitor-exit v2

    .line 4859
    return-object v1

    .line 4857
    :catchall_70
    move-exception v1

    monitor-exit v2
    :try_end_72
    .catchall {:try_start_20 .. :try_end_72} :catchall_70

    throw v1
.end method

.method public getPackageInfo(Ljava/lang/String;II)Landroid/content/pm/PackageInfo;
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 4427
    nop

    .line 4428
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    .line 4427
    const-wide/16 v2, -0x1

    move-object v0, p0

    move-object v1, p1

    move v4, p2

    move v6, p3

    invoke-direct/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->getPackageInfoInternal(Ljava/lang/String;JIII)Landroid/content/pm/PackageInfo;

    move-result-object v0

    return-object v0
.end method

.method public getPackageInfoForVersion(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I

    .line 26793
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v6

    .line 26794
    .local v6, "userId":I
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v6}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_e

    .line 26795
    const/4 v0, 0x0

    return-object v0

    .line 26796
    :cond_e
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "get package info"

    move v2, v6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 26798
    const/4 v0, 0x0

    .line 26799
    .local v0, "info":Landroid/content/pm/PackageInfo;
    const/4 v1, 0x0

    .line 26800
    .local v1, "pkgLite":Landroid/content/pm/PackageParser$PackageLite;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 26801
    :try_start_21
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 26802
    .local v3, "p":Lcom/android/server/pm/PackageSetting;
    sget-boolean v4, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_INFO:Z

    if-eqz v4, :cond_4d

    .line 26803
    const-string v4, "PackageManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "getPackageInfo "

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, ": "

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26804
    :cond_4d
    if-eqz v3, :cond_54

    .line 26805
    invoke-direct {p0, v3, p2, v6}, Lcom/android/server/pm/PackageManagerService;->generatePackageInfo(Lcom/android/server/pm/PackageSetting;II)Landroid/content/pm/PackageInfo;

    move-result-object v4

    move-object v0, v4

    .line 26807
    .end local v3  # "p":Lcom/android/server/pm/PackageSetting;
    :cond_54
    monitor-exit v2
    :try_end_55
    .catchall {:try_start_21 .. :try_end_55} :catchall_a5

    .line 26808
    if-eqz v0, :cond_70

    .line 26809
    new-instance v2, Ljava/io/File;

    iget-object v3, v0, Landroid/content/pm/PackageInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    invoke-direct {v2, v3}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 26811
    .local v2, "tempFile":Ljava/io/File;
    const/4 v3, 0x0

    :try_start_61
    invoke-static {v2, v3}, Landroid/content/pm/PackageParser;->parsePackageLite(Ljava/io/File;I)Landroid/content/pm/PackageParser$PackageLite;

    move-result-object v3
    :try_end_65
    .catch Landroid/content/pm/PackageParser$PackageParserException; {:try_start_61 .. :try_end_65} :catch_67

    move-object v1, v3

    .line 26814
    goto :goto_70

    .line 26812
    :catch_67
    move-exception v3

    .line 26813
    .local v3, "e":Landroid/content/pm/PackageParser$PackageParserException;
    const-string v4, "PackageDefaultOp"

    const-string/jumbo v5, "should never happened"

    invoke-static {v4, v5}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 26816
    .end local v2  # "tempFile":Ljava/io/File;
    .end local v3  # "e":Landroid/content/pm/PackageParser$PackageParserException;
    :cond_70
    :goto_70
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v2, v2, Lcom/android/server/pm/PackageDefaultOpService;->mPackages:Ljava/util/HashMap;

    invoke-virtual {v2, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageDefaultOpService$Op;

    .line 26817
    .local v2, "pkg":Lcom/android/server/pm/PackageDefaultOpService$Op;
    if-eqz v0, :cond_a4

    if-eqz v2, :cond_a4

    if-eqz v1, :cond_a4

    .line 26818
    iget v3, v1, Landroid/content/pm/PackageParser$PackageLite;->versionCode:I

    iput v3, v0, Landroid/content/pm/PackageInfo;->versionCode:I

    .line 26819
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "getPackageInfo "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, ": "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v4, v2, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, "PackageDefaultOp"

    invoke-static {v4, v3}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26823
    :cond_a4
    return-object v0

    .line 26807
    .end local v2  # "pkg":Lcom/android/server/pm/PackageDefaultOpService$Op;
    :catchall_a5
    move-exception v3

    :try_start_a6
    monitor-exit v2
    :try_end_a7
    .catchall {:try_start_a6 .. :try_end_a7} :catchall_a5

    throw v3
.end method

.method public getPackageInfoVersioned(Landroid/content/pm/VersionedPackage;II)Landroid/content/pm/PackageInfo;
    .registers 11
    .param p1, "versionedPackage"  # Landroid/content/pm/VersionedPackage;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 4434
    invoke-virtual {p1}, Landroid/content/pm/VersionedPackage;->getPackageName()Ljava/lang/String;

    move-result-object v1

    .line 4435
    invoke-virtual {p1}, Landroid/content/pm/VersionedPackage;->getLongVersionCode()J

    move-result-wide v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    .line 4434
    move-object v0, p0

    move v4, p2

    move v6, p3

    invoke-direct/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->getPackageInfoInternal(Ljava/lang/String;JIII)Landroid/content/pm/PackageInfo;

    move-result-object v0

    return-object v0
.end method

.method public getPackageInstaller()Landroid/content/pm/IPackageInstaller;
    .registers 2

    .line 24783
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_c

    .line 24784
    const/4 v0, 0x0

    return-object v0

    .line 24786
    :cond_c
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstallerService:Lcom/android/server/pm/PackageInstallerService;

    return-object v0
.end method

.method getPackageInstallerPackageName()Ljava/lang/String;
    .registers 3

    .line 5947
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5948
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    monitor-exit v0

    return-object v1

    .line 5949
    :catchall_7
    move-exception v1

    monitor-exit v0
    :try_end_9
    .catchall {:try_start_3 .. :try_end_9} :catchall_7

    throw v1
.end method

.method public getPackageSizeInfo(Ljava/lang/String;ILandroid/content/pm/IPackageStatsObserver;)V
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userHandle"  # I
    .param p3, "observer"  # Landroid/content/pm/IPackageStatsObserver;

    .line 21037
    new-instance v0, Ljava/lang/UnsupportedOperationException;

    const-string v1, "Shame on you for calling the hidden API getPackageSizeInfo(). Shame!"

    invoke-direct {v0, v1}, Ljava/lang/UnsupportedOperationException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public getPackageUid(Ljava/lang/String;II)I
    .registers 12
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 4753
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p3}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, -0x1

    if-nez v0, :cond_a

    return v1

    .line 4754
    :cond_a
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 4755
    .local v0, "callingUid":I
    invoke-direct {p0, p2, p3, p1}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForPackage(IILjava/lang/Object;)I

    move-result p2

    .line 4756
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v7, "getPackageUid"

    move v3, v0

    move v4, p3

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 4760
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 4761
    :try_start_20
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 4762
    .local v3, "p":Landroid/content/pm/PackageParser$Package;
    if-eqz v3, :cond_46

    invoke-virtual {v3, p2}, Landroid/content/pm/PackageParser$Package;->isMatch(I)Z

    move-result v4

    if-eqz v4, :cond_46

    .line 4763
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 4764
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v4, v0, p3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v5

    if-eqz v5, :cond_3c

    .line 4765
    monitor-exit v2

    return v1

    .line 4767
    :cond_3c
    iget-object v1, v3, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {p3, v1}, Landroid/os/UserHandle;->getUid(II)I

    move-result v1

    monitor-exit v2

    return v1

    .line 4769
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_46
    const v4, 0x402000

    and-int/2addr v4, p2

    if-eqz v4, :cond_6c

    .line 4770
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 4771
    .restart local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v4, :cond_6c

    invoke-virtual {v4, p2}, Lcom/android/server/pm/PackageSetting;->isMatch(I)Z

    move-result v5

    if-eqz v5, :cond_6c

    .line 4772
    invoke-direct {p0, v4, v0, p3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v5

    if-nez v5, :cond_6c

    .line 4773
    iget v1, v4, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-static {p3, v1}, Landroid/os/UserHandle;->getUid(II)I

    move-result v1

    monitor-exit v2

    return v1

    .line 4776
    .end local v3  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_6c
    monitor-exit v2

    .line 4778
    return v1

    .line 4776
    :catchall_6e
    move-exception v1

    monitor-exit v2
    :try_end_70
    .catchall {:try_start_20 .. :try_end_70} :catchall_6e

    throw v1
.end method

.method getPackages()Ljava/util/Collection;
    .registers 4
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/Collection<",
            "Landroid/content/pm/PackageParser$Package;",
            ">;"
        }
    .end annotation

    .line 26236
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26237
    :try_start_3
    new-instance v1, Ljava/util/ArrayList;

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-direct {v1, v2}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    monitor-exit v0

    return-object v1

    .line 26238
    :catchall_10
    move-exception v1

    monitor-exit v0
    :try_end_12
    .catchall {:try_start_3 .. :try_end_12} :catchall_10

    throw v1
.end method

.method public getPackagesForUid(I)[Ljava/lang/String;
    .registers 16
    .param p1, "uid"  # I

    .line 6629
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 6630
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    const/4 v2, 0x1

    const/4 v3, 0x0

    if-eqz v1, :cond_e

    move v1, v2

    goto :goto_f

    :cond_e
    move v1, v3

    .line 6631
    .local v1, "isCallerInstantApp":Z
    :goto_f
    invoke-static {p1}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v4

    .line 6632
    .local v4, "userId":I
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v5

    .line 6634
    .local v5, "appId":I
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6

    .line 6635
    :try_start_1a
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v7, v5}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v7

    .line 6636
    .local v7, "obj":Ljava/lang/Object;
    instance-of v8, v7, Lcom/android/server/pm/SharedUserSetting;

    const/4 v9, 0x0

    if-eqz v8, :cond_63

    .line 6637
    if-eqz v1, :cond_29

    .line 6638
    monitor-exit v6

    return-object v9

    .line 6640
    :cond_29
    move-object v2, v7

    check-cast v2, Lcom/android/server/pm/SharedUserSetting;

    .line 6641
    .local v2, "sus":Lcom/android/server/pm/SharedUserSetting;
    iget-object v8, v2, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v8}, Landroid/util/ArraySet;->size()I

    move-result v8

    .line 6642
    .local v8, "N":I
    new-array v9, v8, [Ljava/lang/String;

    .line 6643
    .local v9, "res":[Ljava/lang/String;
    iget-object v10, v2, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v10}, Landroid/util/ArraySet;->iterator()Ljava/util/Iterator;

    move-result-object v10

    .line 6644
    .local v10, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    nop

    .line 6645
    .local v3, "i":I
    :goto_3b
    invoke-interface {v10}, Ljava/util/Iterator;->hasNext()Z

    move-result v11

    if-eqz v11, :cond_61

    .line 6646
    invoke-interface {v10}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/pm/PackageSetting;

    .line 6647
    .local v11, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v11, v4}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v12

    if-eqz v12, :cond_55

    .line 6648
    add-int/lit8 v12, v3, 0x1

    .end local v3  # "i":I
    .local v12, "i":I
    iget-object v13, v11, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    aput-object v13, v9, v3

    move v3, v12

    goto :goto_60

    .line 6650
    .end local v12  # "i":I
    .restart local v3  # "i":I
    :cond_55
    const-class v12, Ljava/lang/String;

    aget-object v13, v9, v3

    invoke-static {v12, v9, v13}, Lcom/android/internal/util/ArrayUtils;->removeElement(Ljava/lang/Class;[Ljava/lang/Object;Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v12

    check-cast v12, [Ljava/lang/String;

    move-object v9, v12

    .line 6652
    .end local v11  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_60
    goto :goto_3b

    .line 6653
    :cond_61
    monitor-exit v6

    return-object v9

    .line 6654
    .end local v2  # "sus":Lcom/android/server/pm/SharedUserSetting;
    .end local v3  # "i":I
    .end local v8  # "N":I
    .end local v9  # "res":[Ljava/lang/String;
    .end local v10  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    :cond_63
    instance-of v8, v7, Lcom/android/server/pm/PackageSetting;

    if-eqz v8, :cond_7e

    .line 6655
    move-object v8, v7

    check-cast v8, Lcom/android/server/pm/PackageSetting;

    .line 6656
    .local v8, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v8, v4}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v10

    if-eqz v10, :cond_7e

    invoke-direct {p0, v8, v0, v4}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v10

    if-nez v10, :cond_7e

    .line 6657
    new-array v2, v2, [Ljava/lang/String;

    iget-object v9, v8, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    aput-object v9, v2, v3

    monitor-exit v6

    return-object v2

    .line 6660
    .end local v7  # "obj":Ljava/lang/Object;
    .end local v8  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_7e
    monitor-exit v6

    .line 6661
    return-object v9

    .line 6660
    :catchall_80
    move-exception v2

    monitor-exit v6
    :try_end_82
    .catchall {:try_start_1a .. :try_end_82} :catchall_80

    throw v2
.end method

.method public getPackagesHoldingPermissions([Ljava/lang/String;II)Landroid/content/pm/ParceledListSlice;
    .registers 22
    .param p1, "permissions"  # [Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "([",
            "Ljava/lang/String;",
            "II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/PackageInfo;",
            ">;"
        }
    .end annotation

    .line 9012
    move-object/from16 v13, p0

    move-object/from16 v14, p1

    move/from16 v15, p3

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v15}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_13

    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v0

    return-object v0

    .line 9013
    :cond_13
    move/from16 v0, p2

    invoke-direct {v13, v0, v15, v14}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForPackage(IILjava/lang/Object;)I

    move-result v16

    .line 9014
    .end local p2  # "flags":I
    .local v16, "flags":I
    iget-object v1, v13, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    const/4 v4, 0x1

    const/4 v5, 0x0

    const-string v6, "get packages holding permissions"

    move/from16 v3, p3

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 9017
    const v0, 0x402000

    and-int v0, v16, v0

    if-eqz v0, :cond_31

    const/4 v0, 0x1

    goto :goto_32

    :cond_31
    const/4 v0, 0x0

    :goto_32
    move/from16 v17, v0

    .line 9020
    .local v17, "listUninstalled":Z
    iget-object v12, v13, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v12

    .line 9022
    :try_start_37
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->CTS_SERVICEPERMISSION_WHITE:[Ljava/lang/String;

    invoke-static {v14, v0}, Lcom/android/internal/util/ArrayUtils;->containsAny([Ljava/lang/Object;[Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_61

    .line 9023
    iget-object v0, v13, Lcom/android/server/pm/PackageManagerService;->mDeviceStateManager:Lmeizu/os/DeviceStateManager;

    if-nez v0, :cond_4f

    .line 9024
    iget-object v0, v13, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "device_states"

    .line 9025
    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lmeizu/os/DeviceStateManager;

    iput-object v0, v13, Lcom/android/server/pm/PackageManagerService;->mDeviceStateManager:Lmeizu/os/DeviceStateManager;

    .line 9027
    :cond_4f
    iget-object v0, v13, Lcom/android/server/pm/PackageManagerService;->mDeviceStateManager:Lmeizu/os/DeviceStateManager;

    if-eqz v0, :cond_61

    iget-object v0, v13, Lcom/android/server/pm/PackageManagerService;->mDeviceStateManager:Lmeizu/os/DeviceStateManager;

    invoke-virtual {v0}, Lmeizu/os/DeviceStateManager;->isCtsRunning()Z

    move-result v0

    if-eqz v0, :cond_61

    .line 9028
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v0

    monitor-exit v12

    return-object v0

    .line 9032
    :cond_61
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 9033
    .local v0, "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageInfo;>;"
    array-length v1, v14

    new-array v5, v1, [Z

    .line 9034
    .local v5, "tmpBools":[Z
    if-eqz v17, :cond_93

    .line 9035
    iget-object v1, v13, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v8

    :goto_77
    invoke-interface {v8}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_91

    invoke-interface {v8}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    move-object v3, v1

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    .line 9036
    .local v3, "ps":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v1, p0

    move-object v2, v0

    move-object/from16 v4, p1

    move/from16 v6, v16

    move/from16 v7, p3

    invoke-direct/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->addPackageHoldingPermissions(Ljava/util/ArrayList;Lcom/android/server/pm/PackageSetting;[Ljava/lang/String;[ZII)V

    .line 9038
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    goto :goto_77

    :cond_91
    move-object v4, v12

    goto :goto_c3

    .line 9040
    :cond_93
    iget-object v1, v13, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_9d
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_c2

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/PackageParser$Package;

    .line 9041
    .local v2, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v3, v2, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v3, Lcom/android/server/pm/PackageSetting;
    :try_end_ad
    .catchall {:try_start_37 .. :try_end_ad} :catchall_ca

    .line 9042
    .restart local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_bf

    .line 9043
    move-object/from16 v6, p0

    move-object v7, v0

    move-object v8, v3

    move-object/from16 v9, p1

    move-object v10, v5

    move/from16 v11, v16

    move-object v4, v12

    move/from16 v12, p3

    :try_start_bb
    invoke-direct/range {v6 .. v12}, Lcom/android/server/pm/PackageManagerService;->addPackageHoldingPermissions(Ljava/util/ArrayList;Lcom/android/server/pm/PackageSetting;[Ljava/lang/String;[ZII)V

    goto :goto_c0

    .line 9042
    :cond_bf
    move-object v4, v12

    .line 9046
    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_c0
    move-object v12, v4

    goto :goto_9d

    .line 9040
    :cond_c2
    move-object v4, v12

    .line 9049
    :goto_c3
    new-instance v1, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v1, v0}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    monitor-exit v4

    return-object v1

    .line 9050
    .end local v0  # "list":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/PackageInfo;>;"
    .end local v5  # "tmpBools":[Z
    :catchall_ca
    move-exception v0

    move-object v4, v12

    :goto_cc
    monitor-exit v4
    :try_end_cd
    .catchall {:try_start_bb .. :try_end_cd} :catchall_ce

    throw v0

    :catchall_ce
    move-exception v0

    goto :goto_cc
.end method

.method public getPermissionControllerPackageName()Ljava/lang/String;
    .registers 3

    .line 5941
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5942
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredPermissionControllerPackage:Ljava/lang/String;

    monitor-exit v0

    return-object v1

    .line 5943
    :catchall_7
    move-exception v1

    monitor-exit v0
    :try_end_9
    .catchall {:try_start_3 .. :try_end_9} :catchall_7

    throw v1
.end method

.method public getPermissionFlags(Ljava/lang/String;Ljava/lang/String;I)I
    .registers 6
    .param p1, "permName"  # Ljava/lang/String;
    .param p2, "packageName"  # Ljava/lang/String;
    .param p3, "userId"  # I

    .line 6038
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 6039
    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v1

    .line 6038
    invoke-virtual {v0, p1, p2, v1, p3}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getPermissionFlags(Ljava/lang/String;Ljava/lang/String;II)I

    move-result v0

    return v0
.end method

.method public getPermissionGroupInfo(Ljava/lang/String;I)Landroid/content/pm/PermissionGroupInfo;
    .registers 5
    .param p1, "groupName"  # Ljava/lang/String;
    .param p2, "flags"  # I

    .line 4877
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, p1, p2, v1}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getPermissionGroupInfo(Ljava/lang/String;II)Landroid/content/pm/PermissionGroupInfo;

    move-result-object v0

    return-object v0
.end method

.method public getPermissionInfo(Ljava/lang/String;Ljava/lang/String;I)Landroid/content/pm/PermissionInfo;
    .registers 6
    .param p1, "name"  # Ljava/lang/String;
    .param p2, "packageName"  # Ljava/lang/String;
    .param p3, "flags"  # I

    .line 4864
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, p1, p2, p3, v1}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getPermissionInfo(Ljava/lang/String;Ljava/lang/String;II)Landroid/content/pm/PermissionInfo;

    move-result-object v0

    return-object v0
.end method

.method public getPersistentApplications(I)Landroid/content/pm/ParceledListSlice;
    .registers 4
    .param p1, "flags"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(I)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/ApplicationInfo;",
            ">;"
        }
    .end annotation

    .line 9275
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_f

    .line 9276
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v0

    return-object v0

    .line 9278
    :cond_f
    new-instance v0, Landroid/content/pm/ParceledListSlice;

    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->getPersistentApplicationsInternal(I)Ljava/util/List;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    return-object v0
.end method

.method public getPreferredActivities(Ljava/util/List;Ljava/util/List;Ljava/lang/String;)I
    .registers 11
    .param p3, "packageName"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Landroid/content/IntentFilter;",
            ">;",
            "Ljava/util/List<",
            "Landroid/content/ComponentName;",
            ">;",
            "Ljava/lang/String;",
            ")I"
        }
    .end annotation

    .line 21423
    .local p1, "outFilters":Ljava/util/List;, "Ljava/util/List<Landroid/content/IntentFilter;>;"
    .local p2, "outActivities":Ljava/util/List;, "Ljava/util/List<Landroid/content/ComponentName;>;"
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_c

    .line 21424
    const/4 v0, 0x0

    return v0

    .line 21426
    :cond_c
    const/4 v0, 0x0

    .line 21427
    .local v0, "num":I
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v1

    .line 21429
    .local v1, "userId":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 21430
    :try_start_14
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v3, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PreferredIntentResolver;

    .line 21431
    .local v3, "pir":Lcom/android/server/pm/PreferredIntentResolver;
    if-eqz v3, :cond_5a

    .line 21432
    invoke-virtual {v3}, Lcom/android/server/pm/PreferredIntentResolver;->filterIterator()Ljava/util/Iterator;

    move-result-object v4

    .line 21433
    .local v4, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PreferredActivity;>;"
    :goto_24
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_5a

    .line 21434
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PreferredActivity;

    .line 21435
    .local v5, "pa":Lcom/android/server/pm/PreferredActivity;
    if-eqz p3, :cond_46

    iget-object v6, v5, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v6, v6, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    .line 21436
    invoke-virtual {v6}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6, p3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_59

    iget-object v6, v5, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-boolean v6, v6, Lcom/android/server/pm/PreferredComponent;->mAlways:Z

    if-eqz v6, :cond_59

    .line 21438
    :cond_46
    if-eqz p1, :cond_50

    .line 21439
    new-instance v6, Landroid/content/IntentFilter;

    invoke-direct {v6, v5}, Landroid/content/IntentFilter;-><init>(Landroid/content/IntentFilter;)V

    invoke-interface {p1, v6}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 21441
    :cond_50
    if-eqz p2, :cond_59

    .line 21442
    iget-object v6, v5, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v6, v6, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    invoke-interface {p2, v6}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 21445
    .end local v5  # "pa":Lcom/android/server/pm/PreferredActivity;
    :cond_59
    goto :goto_24

    .line 21447
    .end local v3  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    .end local v4  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PreferredActivity;>;"
    :cond_5a
    monitor-exit v2

    .line 21449
    return v0

    .line 21447
    :catchall_5c
    move-exception v3

    monitor-exit v2
    :try_end_5e
    .catchall {:try_start_14 .. :try_end_5e} :catchall_5c

    throw v3
.end method

.method public getPreferredActivityBackup(I)[B
    .registers 8
    .param p1, "userId"  # I

    .line 21566
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_55

    .line 21570
    new-instance v0, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v0}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 21572
    .local v0, "dataStream":Ljava/io/ByteArrayOutputStream;
    const/4 v1, 0x0

    :try_start_e
    new-instance v2, Lcom/android/internal/util/FastXmlSerializer;

    invoke-direct {v2}, Lcom/android/internal/util/FastXmlSerializer;-><init>()V

    .line 21573
    .local v2, "serializer":Lorg/xmlpull/v1/XmlSerializer;
    sget-object v3, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;

    invoke-virtual {v3}, Ljava/nio/charset/Charset;->name()Ljava/lang/String;

    move-result-object v3

    invoke-interface {v2, v0, v3}, Lorg/xmlpull/v1/XmlSerializer;->setOutput(Ljava/io/OutputStream;Ljava/lang/String;)V

    .line 21574
    const/4 v3, 0x1

    invoke-static {v3}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v4

    invoke-interface {v2, v1, v4}, Lorg/xmlpull/v1/XmlSerializer;->startDocument(Ljava/lang/String;Ljava/lang/Boolean;)V

    .line 21575
    const-string/jumbo v4, "pa"

    invoke-interface {v2, v1, v4}, Lorg/xmlpull/v1/XmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    .line 21577
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v4
    :try_end_2d
    .catch Ljava/lang/Exception; {:try_start_e .. :try_end_2d} :catch_48

    .line 21578
    :try_start_2d
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v5, v2, p1, v3}, Lcom/android/server/pm/Settings;->writePreferredActivitiesLPr(Lorg/xmlpull/v1/XmlSerializer;IZ)V

    .line 21579
    monitor-exit v4
    :try_end_33
    .catchall {:try_start_2d .. :try_end_33} :catchall_45

    .line 21581
    :try_start_33
    const-string/jumbo v3, "pa"

    invoke-interface {v2, v1, v3}, Lorg/xmlpull/v1/XmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    .line 21582
    invoke-interface {v2}, Lorg/xmlpull/v1/XmlSerializer;->endDocument()V

    .line 21583
    invoke-interface {v2}, Lorg/xmlpull/v1/XmlSerializer;->flush()V
    :try_end_3f
    .catch Ljava/lang/Exception; {:try_start_33 .. :try_end_3f} :catch_48

    .line 21589
    .end local v2  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    nop

    .line 21591
    invoke-virtual {v0}, Ljava/io/ByteArrayOutputStream;->toByteArray()[B

    move-result-object v1

    return-object v1

    .line 21579
    .restart local v2  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    :catchall_45
    move-exception v3

    :try_start_46
    monitor-exit v4
    :try_end_47
    .catchall {:try_start_46 .. :try_end_47} :catchall_45

    .end local v0  # "dataStream":Ljava/io/ByteArrayOutputStream;
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "userId":I
    :try_start_47
    throw v3
    :try_end_48
    .catch Ljava/lang/Exception; {:try_start_47 .. :try_end_48} :catch_48

    .line 21584
    .end local v2  # "serializer":Lorg/xmlpull/v1/XmlSerializer;
    .restart local v0  # "dataStream":Ljava/io/ByteArrayOutputStream;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "userId":I
    :catch_48
    move-exception v2

    .line 21585
    .local v2, "e":Ljava/lang/Exception;
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v3, :cond_54

    .line 21586
    const-string v3, "PackageManager"

    const-string v4, "Unable to write preferred activities for backup"

    invoke-static {v3, v4, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 21588
    :cond_54
    return-object v1

    .line 21567
    .end local v0  # "dataStream":Ljava/io/ByteArrayOutputStream;
    .end local v2  # "e":Ljava/lang/Exception;
    :cond_55
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Only the system may call getPreferredActivityBackup()"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public getPrivateFlagsForUid(I)I
    .registers 9
    .param p1, "uid"  # I

    .line 6767
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 6768
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    const/4 v2, 0x0

    if-eqz v1, :cond_c

    .line 6769
    return v2

    .line 6771
    :cond_c
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v1

    .line 6772
    .local v1, "appId":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 6773
    :try_start_13
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, v1}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v4

    .line 6774
    .local v4, "obj":Ljava/lang/Object;
    instance-of v5, v4, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v5, :cond_24

    .line 6775
    move-object v2, v4

    check-cast v2, Lcom/android/server/pm/SharedUserSetting;

    .line 6776
    .local v2, "sus":Lcom/android/server/pm/SharedUserSetting;
    iget v5, v2, Lcom/android/server/pm/SharedUserSetting;->pkgPrivateFlags:I

    monitor-exit v3

    return v5

    .line 6777
    .end local v2  # "sus":Lcom/android/server/pm/SharedUserSetting;
    :cond_24
    instance-of v5, v4, Lcom/android/server/pm/PackageSetting;

    if-eqz v5, :cond_3b

    .line 6778
    move-object v5, v4

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 6779
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v6

    invoke-direct {p0, v5, v0, v6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v6

    if-eqz v6, :cond_37

    .line 6780
    monitor-exit v3

    return v2

    .line 6782
    :cond_37
    iget v2, v5, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    monitor-exit v3

    return v2

    .line 6784
    .end local v4  # "obj":Ljava/lang/Object;
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_3b
    monitor-exit v3

    .line 6785
    return v2

    .line 6784
    :catchall_3d
    move-exception v2

    monitor-exit v3
    :try_end_3f
    .catchall {:try_start_13 .. :try_end_3f} :catchall_3d

    throw v2
.end method

.method public getProviderInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ProviderInfo;
    .registers 15
    .param p1, "component"  # Landroid/content/ComponentName;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 5682
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p3}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    return-object v1

    .line 5683
    :cond_a
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 5684
    .local v0, "callingUid":I
    invoke-direct {p0, p2, p3, p1}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForComponent(IILjava/lang/Object;)I

    move-result p2

    .line 5685
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v7, "get provider info"

    move v3, v0

    move v4, p3

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 5687
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8

    .line 5688
    :try_start_20
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v2, p1}, Lcom/android/server/pm/ComponentResolver;->getProvider(Landroid/content/ComponentName;)Landroid/content/pm/PackageParser$Provider;

    move-result-object v2

    move-object v9, v2

    .line 5689
    .local v9, "p":Landroid/content/pm/PackageParser$Provider;
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_INFO:Z

    if-eqz v2, :cond_49

    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "getProviderInfo "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v4, ": "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 5691
    :cond_49
    if-eqz v9, :cond_81

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v9, Landroid/content/pm/PackageParser$Provider;->info:Landroid/content/pm/ProviderInfo;

    invoke-virtual {v2, v3, p2, p3}, Lcom/android/server/pm/Settings;->isEnabledAndMatchLPr(Landroid/content/pm/ComponentInfo;II)Z

    move-result v2

    if-eqz v2, :cond_81

    .line 5692
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    move-object v10, v2

    .line 5693
    .local v10, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v10, :cond_68

    monitor-exit v8

    return-object v1

    .line 5694
    :cond_68
    const/4 v6, 0x4

    move-object v2, p0

    move-object v3, v10

    move v4, v0

    move-object v5, p1

    move v7, p3

    invoke-direct/range {v2 .. v7}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v2

    if-eqz v2, :cond_76

    .line 5695
    monitor-exit v8

    return-object v1

    .line 5697
    :cond_76
    nop

    .line 5698
    invoke-virtual {v10, p3}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v1

    .line 5697
    invoke-static {v9, p2, v1, p3}, Landroid/content/pm/PackageParser;->generateProviderInfo(Landroid/content/pm/PackageParser$Provider;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ProviderInfo;

    move-result-object v1

    monitor-exit v8

    return-object v1

    .line 5700
    .end local v9  # "p":Landroid/content/pm/PackageParser$Provider;
    .end local v10  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_81
    monitor-exit v8

    .line 5701
    return-object v1

    .line 5700
    :catchall_83
    move-exception v1

    monitor-exit v8
    :try_end_85
    .catchall {:try_start_20 .. :try_end_85} :catchall_83

    throw v1
.end method

.method public getReceiverInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ActivityInfo;
    .registers 15
    .param p1, "component"  # Landroid/content/ComponentName;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 5444
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p3}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    return-object v1

    .line 5445
    :cond_a
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 5446
    .local v0, "callingUid":I
    invoke-direct {p0, p2, p3, p1}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForComponent(IILjava/lang/Object;)I

    move-result p2

    .line 5447
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v7, "get receiver info"

    move v3, v0

    move v4, p3

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 5449
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8

    .line 5450
    :try_start_20
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v2, p1}, Lcom/android/server/pm/ComponentResolver;->getReceiver(Landroid/content/ComponentName;)Landroid/content/pm/PackageParser$Activity;

    move-result-object v2

    move-object v9, v2

    .line 5451
    .local v9, "a":Landroid/content/pm/PackageParser$Activity;
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_INFO:Z

    if-eqz v2, :cond_49

    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "getReceiverInfo "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v4, ": "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 5453
    :cond_49
    if-eqz v9, :cond_81

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v9, Landroid/content/pm/PackageParser$Activity;->info:Landroid/content/pm/ActivityInfo;

    invoke-virtual {v2, v3, p2, p3}, Lcom/android/server/pm/Settings;->isEnabledAndMatchLPr(Landroid/content/pm/ComponentInfo;II)Z

    move-result v2

    if-eqz v2, :cond_81

    .line 5454
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    move-object v10, v2

    .line 5455
    .local v10, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v10, :cond_68

    monitor-exit v8

    return-object v1

    .line 5456
    :cond_68
    const/4 v6, 0x2

    move-object v2, p0

    move-object v3, v10

    move v4, v0

    move-object v5, p1

    move v7, p3

    invoke-direct/range {v2 .. v7}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v2

    if-eqz v2, :cond_76

    .line 5457
    monitor-exit v8

    return-object v1

    .line 5459
    :cond_76
    nop

    .line 5460
    invoke-virtual {v10, p3}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v1

    .line 5459
    invoke-static {v9, p2, v1, p3}, Landroid/content/pm/PackageParser;->generateActivityInfo(Landroid/content/pm/PackageParser$Activity;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ActivityInfo;

    move-result-object v1

    monitor-exit v8

    return-object v1

    .line 5462
    .end local v9  # "a":Landroid/content/pm/PackageParser$Activity;
    .end local v10  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_81
    monitor-exit v8

    .line 5463
    return-object v1

    .line 5462
    :catchall_83
    move-exception v1

    monitor-exit v8
    :try_end_85
    .catchall {:try_start_20 .. :try_end_85} :catchall_83

    throw v1
.end method

.method public getRuntimePermissionsVersion(I)I
    .registers 5
    .param p1, "userId"  # I

    .line 26097
    invoke-static {p1}, Lcom/android/internal/util/Preconditions;->checkArgumentNonnegative(I)I

    .line 26098
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.ADJUST_RUNTIME_PERMISSIONS_POLICY"

    const-string/jumbo v2, "setRuntimePermissionVersion"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 26101
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26102
    :try_start_10
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1}, Lcom/android/server/pm/Settings;->getDefaultRuntimePermissionsVersionLPr(I)I

    move-result v1

    monitor-exit v0

    return v1

    .line 26103
    :catchall_18
    move-exception v1

    monitor-exit v0
    :try_end_1a
    .catchall {:try_start_10 .. :try_end_1a} :catchall_18

    throw v1
.end method

.method public getServiceInfo(Landroid/content/ComponentName;II)Landroid/content/pm/ServiceInfo;
    .registers 15
    .param p1, "component"  # Landroid/content/ComponentName;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 5658
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p3}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    return-object v1

    .line 5659
    :cond_a
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 5660
    .local v0, "callingUid":I
    invoke-direct {p0, p2, p3, p1}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForComponent(IILjava/lang/Object;)I

    move-result p2

    .line 5661
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v7, "get service info"

    move v3, v0

    move v4, p3

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 5663
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8

    .line 5664
    :try_start_20
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    invoke-virtual {v2, p1}, Lcom/android/server/pm/ComponentResolver;->getService(Landroid/content/ComponentName;)Landroid/content/pm/PackageParser$Service;

    move-result-object v2

    move-object v9, v2

    .line 5665
    .local v9, "s":Landroid/content/pm/PackageParser$Service;
    sget-boolean v2, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_INFO:Z

    if-eqz v2, :cond_49

    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "getServiceInfo "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v4, ": "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 5667
    :cond_49
    if-eqz v9, :cond_81

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v9, Landroid/content/pm/PackageParser$Service;->info:Landroid/content/pm/ServiceInfo;

    invoke-virtual {v2, v3, p2, p3}, Lcom/android/server/pm/Settings;->isEnabledAndMatchLPr(Landroid/content/pm/ComponentInfo;II)Z

    move-result v2

    if-eqz v2, :cond_81

    .line 5668
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    move-object v10, v2

    .line 5669
    .local v10, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v10, :cond_68

    monitor-exit v8

    return-object v1

    .line 5670
    :cond_68
    const/4 v6, 0x3

    move-object v2, p0

    move-object v3, v10

    move v4, v0

    move-object v5, p1

    move v7, p3

    invoke-direct/range {v2 .. v7}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v2

    if-eqz v2, :cond_76

    .line 5671
    monitor-exit v8

    return-object v1

    .line 5673
    :cond_76
    nop

    .line 5674
    invoke-virtual {v10, p3}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v1

    .line 5673
    invoke-static {v9, p2, v1, p3}, Landroid/content/pm/PackageParser;->generateServiceInfo(Landroid/content/pm/PackageParser$Service;ILandroid/content/pm/PackageUserState;I)Landroid/content/pm/ServiceInfo;

    move-result-object v1

    monitor-exit v8

    return-object v1

    .line 5676
    .end local v9  # "s":Landroid/content/pm/PackageParser$Service;
    .end local v10  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_81
    monitor-exit v8

    .line 5677
    return-object v1

    .line 5676
    :catchall_83
    move-exception v1

    monitor-exit v8
    :try_end_85
    .catchall {:try_start_20 .. :try_end_85} :catchall_83

    throw v1
.end method

.method public getServicesSystemSharedLibraryPackageName()Ljava/lang/String;
    .registers 3

    .line 5761
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5762
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mServicesSystemSharedLibraryPackageName:Ljava/lang/String;

    monitor-exit v0

    return-object v1

    .line 5763
    :catchall_7
    move-exception v1

    monitor-exit v0
    :try_end_9
    .catchall {:try_start_3 .. :try_end_9} :catchall_7

    throw v1
.end method

.method public getSharedLibraries(Ljava/lang/String;II)Landroid/content/pm/ParceledListSlice;
    .registers 34
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/SharedLibraryInfo;",
            ">;"
        }
    .end annotation

    .line 5469
    move-object/from16 v1, p0

    move/from16 v2, p3

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v2}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v3, 0x0

    if-nez v0, :cond_e

    return-object v3

    .line 5470
    :cond_e
    const-string/jumbo v0, "userId must be >= 0"

    invoke-static {v2, v0}, Lcom/android/internal/util/Preconditions;->checkArgumentNonnegative(ILjava/lang/String;)I

    .line 5471
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {v1, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_1f

    .line 5472
    return-object v3

    .line 5475
    :cond_1f
    move/from16 v0, p2

    invoke-direct {v1, v0, v2, v3}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForPackage(IILjava/lang/Object;)I

    move-result v4

    .line 5477
    .end local p2  # "flags":I
    .local v4, "flags":I
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 5478
    const-string v5, "android.permission.INSTALL_PACKAGES"

    invoke-virtual {v0, v5}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    const/4 v5, 0x0

    const/high16 v6, 0x4000000

    if-eqz v0, :cond_5c

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 5480
    const-string v7, "android.permission.DELETE_PACKAGES"

    invoke-virtual {v0, v7}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_59

    .line 5482
    move-object/from16 v7, p1

    invoke-direct {v1, v7, v6, v2, v5}, Lcom/android/server/pm/PackageManagerService;->canRequestPackageInstallsInternal(Ljava/lang/String;IIZ)Z

    move-result v0

    if-nez v0, :cond_5e

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 5485
    const-string v8, "android.permission.REQUEST_DELETE_PACKAGES"

    invoke-virtual {v0, v8}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_5e

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 5487
    const-string v8, "android.permission.ACCESS_SHARED_LIBRARIES"

    invoke-virtual {v0, v8}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    if-nez v0, :cond_5f

    goto :goto_5e

    .line 5480
    :cond_59
    move-object/from16 v7, p1

    goto :goto_5e

    .line 5478
    :cond_5c
    move-object/from16 v7, p1

    .line 5487
    :cond_5e
    :goto_5e
    const/4 v5, 0x1

    .line 5490
    .local v5, "canSeeStaticLibraries":Z
    :cond_5f
    iget-object v8, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v8

    .line 5491
    const/4 v0, 0x0

    .line 5493
    .local v0, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    :try_start_63
    iget-object v9, v1, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v9}, Landroid/util/ArrayMap;->size()I

    move-result v9

    .line 5494
    .local v9, "libCount":I
    const/4 v10, 0x0

    .local v10, "i":I
    :goto_6a
    if-ge v10, v9, :cond_102

    .line 5495
    iget-object v11, v1, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v11, v10}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/util/LongSparseArray;

    .line 5496
    .local v11, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-nez v11, :cond_78

    .line 5497
    goto/16 :goto_fb

    .line 5500
    :cond_78
    invoke-virtual {v11}, Landroid/util/LongSparseArray;->size()I

    move-result v12

    .line 5501
    .local v12, "versionCount":I
    const/4 v13, 0x0

    move-object v14, v0

    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .local v13, "j":I
    .local v14, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    :goto_7e
    if-ge v13, v12, :cond_fa

    .line 5502
    invoke-virtual {v11, v13}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/content/pm/SharedLibraryInfo;

    move-object v15, v0

    .line 5503
    .local v15, "libInfo":Landroid/content/pm/SharedLibraryInfo;
    if-nez v5, :cond_90

    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->isStatic()Z

    move-result v0

    if-eqz v0, :cond_90

    .line 5504
    goto :goto_fa

    .line 5506
    :cond_90
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v16
    :try_end_94
    .catchall {:try_start_63 .. :try_end_94} :catchall_110

    .line 5508
    .local v16, "identity":J
    nop

    .line 5509
    :try_start_95
    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v0

    or-int v3, v4, v6

    .line 5508
    invoke-virtual {v1, v0, v3, v2}, Lcom/android/server/pm/PackageManagerService;->getPackageInfoVersioned(Landroid/content/pm/VersionedPackage;II)Landroid/content/pm/PackageInfo;

    move-result-object v0
    :try_end_9f
    .catchall {:try_start_95 .. :try_end_9f} :catchall_f5

    .line 5511
    .local v0, "packageInfo":Landroid/content/pm/PackageInfo;
    if-nez v0, :cond_a5

    .line 5515
    :try_start_a1
    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_ef

    .end local v0  # "packageInfo":Landroid/content/pm/PackageInfo;
    :cond_a5
    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5516
    nop

    .line 5518
    new-instance v0, Landroid/content/pm/SharedLibraryInfo;

    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getPath()Ljava/lang/String;

    move-result-object v20

    .line 5519
    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v21

    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getAllCodePaths()Ljava/util/List;

    move-result-object v22

    .line 5520
    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v23

    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getLongVersion()J

    move-result-wide v24

    .line 5521
    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getType()I

    move-result v26

    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getDeclaringPackage()Landroid/content/pm/VersionedPackage;

    move-result-object v27

    .line 5522
    invoke-direct {v1, v15, v4, v2}, Lcom/android/server/pm/PackageManagerService;->getPackagesUsingSharedLibraryLPr(Landroid/content/pm/SharedLibraryInfo;II)Ljava/util/List;

    move-result-object v28

    .line 5523
    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getDependencies()Ljava/util/List;

    move-result-object v3

    if-nez v3, :cond_d4

    .line 5524
    const/16 v29, 0x0

    goto :goto_df

    .line 5525
    :cond_d4
    new-instance v3, Ljava/util/ArrayList;

    invoke-virtual {v15}, Landroid/content/pm/SharedLibraryInfo;->getDependencies()Ljava/util/List;

    move-result-object v6

    invoke-direct {v3, v6}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    move-object/from16 v29, v3

    :goto_df
    move-object/from16 v19, v0

    invoke-direct/range {v19 .. v29}, Landroid/content/pm/SharedLibraryInfo;-><init>(Ljava/lang/String;Ljava/lang/String;Ljava/util/List;Ljava/lang/String;JILandroid/content/pm/VersionedPackage;Ljava/util/List;Ljava/util/List;)V

    .line 5527
    .local v0, "resLibInfo":Landroid/content/pm/SharedLibraryInfo;
    if-nez v14, :cond_ec

    .line 5528
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    move-object v14, v3

    .line 5530
    :cond_ec
    invoke-interface {v14, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 5501
    .end local v0  # "resLibInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v15  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v16  # "identity":J
    :goto_ef
    add-int/lit8 v13, v13, 0x1

    const/4 v3, 0x0

    const/high16 v6, 0x4000000

    goto :goto_7e

    .line 5515
    .restart local v15  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .restart local v16  # "identity":J
    :catchall_f5
    move-exception v0

    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local v4  # "flags":I
    .end local v5  # "canSeeStaticLibraries":Z
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p3  # "userId":I
    throw v0

    .line 5494
    .end local v11  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v12  # "versionCount":I
    .end local v13  # "j":I
    .end local v15  # "libInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v16  # "identity":J
    .restart local v4  # "flags":I
    .restart local v5  # "canSeeStaticLibraries":Z
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p3  # "userId":I
    :cond_fa
    :goto_fa
    move-object v0, v14

    .end local v14  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .local v0, "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    :goto_fb
    add-int/lit8 v10, v10, 0x1

    const/4 v3, 0x0

    const/high16 v6, 0x4000000

    goto/16 :goto_6a

    .line 5534
    .end local v10  # "i":I
    :cond_102
    if-eqz v0, :cond_10c

    new-instance v3, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v3, v0}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    move-object/from16 v18, v3

    goto :goto_10e

    :cond_10c
    const/16 v18, 0x0

    :goto_10e
    monitor-exit v8

    return-object v18

    .line 5535
    .end local v0  # "result":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v9  # "libCount":I
    :catchall_110
    move-exception v0

    monitor-exit v8
    :try_end_112
    .catchall {:try_start_a1 .. :try_end_112} :catchall_110

    throw v0
.end method

.method public getSharedSystemSharedLibraryPackageName()Ljava/lang/String;
    .registers 3

    .line 5769
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5770
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSharedSystemSharedLibraryPackageName:Ljava/lang/String;

    monitor-exit v0

    return-object v1

    .line 5771
    :catchall_7
    move-exception v1

    monitor-exit v0
    :try_end_9
    .catchall {:try_start_3 .. :try_end_9} :catchall_7

    throw v1
.end method

.method public getSigningKeySet(Ljava/lang/String;)Landroid/content/pm/KeySet;
    .registers 10
    .param p1, "packageName"  # Ljava/lang/String;

    .line 24839
    if-nez p1, :cond_4

    .line 24840
    const/4 v0, 0x0

    return-object v0

    .line 24842
    :cond_4
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 24843
    :try_start_7
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    .line 24844
    .local v1, "callingUid":I
    invoke-static {v1}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v2

    .line 24845
    .local v2, "callingUserId":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 24846
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v3, :cond_7a

    .line 24850
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 24851
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v4, v1, v2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v5

    if-nez v5, :cond_45

    .line 24857
    iget-object v5, v3, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    if-eq v5, v1, :cond_36

    const/16 v5, 0x3e8

    if-ne v5, v1, :cond_2e

    goto :goto_36

    .line 24859
    :cond_2e
    new-instance v5, Ljava/lang/SecurityException;

    const-string v6, "May not access signing KeySet of other apps."

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    throw v5

    .line 24861
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    :cond_36
    :goto_36
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 24862
    .local v5, "ksms":Lcom/android/server/pm/KeySetManagerService;
    new-instance v6, Landroid/content/pm/KeySet;

    invoke-virtual {v5, p1}, Lcom/android/server/pm/KeySetManagerService;->getSigningKeySetByPackageNameLPr(Ljava/lang/String;)Lcom/android/server/pm/KeySetHandle;

    move-result-object v7

    invoke-direct {v6, v7}, Landroid/content/pm/KeySet;-><init>(Landroid/os/IBinder;)V

    monitor-exit v0

    return-object v6

    .line 24853
    .end local v5  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_45
    const-string v5, "PackageManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "KeySet requested for filtered package: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, ", uid:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 24855
    new-instance v5, Ljava/lang/IllegalArgumentException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unknown package: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    throw v5

    .line 24847
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    :cond_7a
    const-string v4, "PackageManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "KeySet requested for unknown package: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 24848
    new-instance v4, Ljava/lang/IllegalArgumentException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unknown package: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    throw v4

    .line 24863
    .end local v1  # "callingUid":I
    .end local v2  # "callingUserId":I
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    :catchall_a7
    move-exception v1

    monitor-exit v0
    :try_end_a9
    .catchall {:try_start_7 .. :try_end_a9} :catchall_a7

    throw v1
.end method

.method public getSuspendedPackageAppExtras(Ljava/lang/String;I)Landroid/os/PersistableBundle;
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 14386
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 14387
    .local v0, "callingUid":I
    const/4 v1, 0x0

    invoke-virtual {p0, p1, v1, p2}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v1

    if-ne v1, v0, :cond_49

    .line 14391
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 14392
    :try_start_e
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 14393
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v2, :cond_2f

    invoke-direct {p0, v2, v0, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-nez v3, :cond_2f

    .line 14396
    invoke-virtual {v2, p2}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v3

    .line 14397
    .local v3, "packageUserState":Landroid/content/pm/PackageUserState;
    iget-boolean v4, v3, Landroid/content/pm/PackageUserState;->suspended:Z

    if-eqz v4, :cond_2c

    .line 14398
    iget-object v4, v3, Landroid/content/pm/PackageUserState;->suspendedAppExtras:Landroid/os/PersistableBundle;

    monitor-exit v1

    return-object v4

    .line 14400
    :cond_2c
    const/4 v4, 0x0

    monitor-exit v1

    return-object v4

    .line 14394
    .end local v3  # "packageUserState":Landroid/content/pm/PackageUserState;
    :cond_2f
    new-instance v3, Ljava/lang/IllegalArgumentException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unknown target package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    throw v3

    .line 14401
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    :catchall_46
    move-exception v2

    monitor-exit v1
    :try_end_48
    .catchall {:try_start_e .. :try_end_48} :catchall_46

    throw v2

    .line 14388
    :cond_49
    new-instance v1, Ljava/lang/SecurityException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Calling package "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " does not belong to calling uid "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method public getSystemAvailableFeatures()Landroid/content/pm/ParceledListSlice;
    .registers 5
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/FeatureInfo;",
            ">;"
        }
    .end annotation

    .line 5832
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5833
    :try_start_3
    new-instance v1, Ljava/util/ArrayList;

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->size()I

    move-result v2

    add-int/lit8 v2, v2, 0x1

    invoke-direct {v1, v2}, Ljava/util/ArrayList;-><init>(I)V

    .line 5834
    .local v1, "res":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/FeatureInfo;>;"
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/util/ArrayList;->addAll(Ljava/util/Collection;)Z

    .line 5835
    monitor-exit v0
    :try_end_1a
    .catchall {:try_start_3 .. :try_end_1a} :catchall_32

    .line 5836
    new-instance v0, Landroid/content/pm/FeatureInfo;

    invoke-direct {v0}, Landroid/content/pm/FeatureInfo;-><init>()V

    .line 5837
    .local v0, "fi":Landroid/content/pm/FeatureInfo;
    const/4 v2, 0x0

    const-string/jumbo v3, "ro.opengles.version"

    invoke-static {v3, v2}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I

    move-result v2

    iput v2, v0, Landroid/content/pm/FeatureInfo;->reqGlEsVersion:I

    .line 5839
    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 5841
    new-instance v2, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v2, v1}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    return-object v2

    .line 5835
    .end local v0  # "fi":Landroid/content/pm/FeatureInfo;
    .end local v1  # "res":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/FeatureInfo;>;"
    :catchall_32
    move-exception v1

    :try_start_33
    monitor-exit v0
    :try_end_34
    .catchall {:try_start_33 .. :try_end_34} :catchall_32

    throw v1
.end method

.method public getSystemCaptionsServicePackageName()Ljava/lang/String;
    .registers 4

    .line 22125
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 22126
    const v1, 0x1040160

    invoke-virtual {v0, v1}, Landroid/content/Context;->getString(I)Ljava/lang/String;

    move-result-object v0

    .line 22128
    .local v0, "flattenedSystemCaptionsServiceComponentName":Ljava/lang/String;
    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v1

    const/4 v2, 0x0

    if-eqz v1, :cond_11

    .line 22129
    return-object v2

    .line 22132
    :cond_11
    nop

    .line 22133
    invoke-static {v0}, Landroid/content/ComponentName;->unflattenFromString(Ljava/lang/String;)Landroid/content/ComponentName;

    move-result-object v1

    .line 22134
    .local v1, "systemCaptionsServiceComponentName":Landroid/content/ComponentName;
    if-nez v1, :cond_19

    .line 22135
    return-object v2

    .line 22137
    :cond_19
    invoke-virtual {v1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->ensureSystemPackageName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    return-object v2
.end method

.method public getSystemSharedLibraryNames()[Ljava/lang/String;
    .registers 13

    .line 5717
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5718
    const/4 v1, 0x0

    .line 5719
    .local v1, "libs":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    :try_start_4
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->size()I

    move-result v2

    .line 5720
    .local v2, "libCount":I
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_b
    if-ge v3, v2, :cond_71

    .line 5721
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSharedLibraries:Landroid/util/ArrayMap;

    invoke-virtual {v4, v3}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/util/LongSparseArray;

    .line 5722
    .local v4, "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    if-nez v4, :cond_18

    .line 5723
    goto :goto_6e

    .line 5725
    :cond_18
    invoke-virtual {v4}, Landroid/util/LongSparseArray;->size()I

    move-result v5

    .line 5726
    .local v5, "versionCount":I
    const/4 v6, 0x0

    .local v6, "j":I
    :goto_1d
    if-ge v6, v5, :cond_6e

    .line 5727
    invoke-virtual {v4, v6}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Landroid/content/pm/SharedLibraryInfo;

    .line 5728
    .local v7, "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    invoke-virtual {v7}, Landroid/content/pm/SharedLibraryInfo;->isStatic()Z

    move-result v8

    if-nez v8, :cond_3b

    .line 5729
    if-nez v1, :cond_33

    .line 5730
    new-instance v8, Landroid/util/ArraySet;

    invoke-direct {v8}, Landroid/util/ArraySet;-><init>()V

    move-object v1, v8

    .line 5732
    :cond_33
    invoke-virtual {v7}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v8

    invoke-interface {v1, v8}, Ljava/util/Set;->add(Ljava/lang/Object;)Z

    .line 5733
    goto :goto_6e

    .line 5735
    :cond_3b
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v7}, Landroid/content/pm/SharedLibraryInfo;->getPackageName()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v8, v9}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v8

    .line 5736
    .local v8, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v8, :cond_6b

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v9

    .line 5737
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v10

    invoke-static {v10}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v10

    const/high16 v11, 0x4000000

    .line 5736
    invoke-direct {p0, v8, v9, v10, v11}, Lcom/android/server/pm/PackageManagerService;->filterSharedLibPackageLPr(Lcom/android/server/pm/PackageSetting;III)Z

    move-result v9

    if-nez v9, :cond_6b

    .line 5739
    if-nez v1, :cond_63

    .line 5740
    new-instance v9, Landroid/util/ArraySet;

    invoke-direct {v9}, Landroid/util/ArraySet;-><init>()V

    move-object v1, v9

    .line 5742
    :cond_63
    invoke-virtual {v7}, Landroid/content/pm/SharedLibraryInfo;->getName()Ljava/lang/String;

    move-result-object v9

    invoke-interface {v1, v9}, Ljava/util/Set;->add(Ljava/lang/Object;)Z

    .line 5743
    goto :goto_6e

    .line 5726
    .end local v7  # "libraryInfo":Landroid/content/pm/SharedLibraryInfo;
    .end local v8  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_6b
    add-int/lit8 v6, v6, 0x1

    goto :goto_1d

    .line 5720
    .end local v4  # "versionedLib":Landroid/util/LongSparseArray;, "Landroid/util/LongSparseArray<Landroid/content/pm/SharedLibraryInfo;>;"
    .end local v5  # "versionCount":I
    .end local v6  # "j":I
    :cond_6e
    :goto_6e
    add-int/lit8 v3, v3, 0x1

    goto :goto_b

    .line 5748
    .end local v3  # "i":I
    :cond_71
    if-eqz v1, :cond_7e

    .line 5749
    invoke-interface {v1}, Ljava/util/Set;->size()I

    move-result v3

    new-array v3, v3, [Ljava/lang/String;

    .line 5750
    .local v3, "libsArray":[Ljava/lang/String;
    invoke-interface {v1, v3}, Ljava/util/Set;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    .line 5751
    monitor-exit v0

    return-object v3

    .line 5754
    .end local v3  # "libsArray":[Ljava/lang/String;
    :cond_7e
    const/4 v3, 0x0

    monitor-exit v0

    return-object v3

    .line 5755
    .end local v1  # "libs":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    .end local v2  # "libCount":I
    :catchall_81
    move-exception v1

    monitor-exit v0
    :try_end_83
    .catchall {:try_start_4 .. :try_end_83} :catchall_81

    throw v1
.end method

.method public getSystemTextClassifierPackageName()Ljava/lang/String;
    .registers 3

    .line 22061
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const v1, 0x1040161

    invoke-virtual {v0, v1}, Landroid/content/Context;->getString(I)Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->ensureSystemPackageName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method public getUidForSharedUser(Ljava/lang/String;)I
    .registers 6
    .param p1, "sharedUserName"  # Ljava/lang/String;

    .line 6721
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    const/4 v1, -0x1

    if-eqz v0, :cond_c

    .line 6722
    return v1

    .line 6724
    :cond_c
    if-nez p1, :cond_f

    .line 6725
    return v1

    .line 6728
    :cond_f
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 6731
    :try_start_12
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/4 v3, 0x0

    invoke-virtual {v2, p1, v3, v3, v3}, Lcom/android/server/pm/Settings;->getSharedUserLPw(Ljava/lang/String;IIZ)Lcom/android/server/pm/SharedUserSetting;

    move-result-object v2

    .line 6732
    .local v2, "suid":Lcom/android/server/pm/SharedUserSetting;
    if-eqz v2, :cond_1f

    .line 6733
    iget v1, v2, Lcom/android/server/pm/SharedUserSetting;->userId:I
    :try_end_1d
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_12 .. :try_end_1d} :catch_22
    .catchall {:try_start_12 .. :try_end_1d} :catchall_20

    :try_start_1d
    monitor-exit v0

    return v1

    .line 6737
    :cond_1f
    goto :goto_23

    .line 6739
    .end local v2  # "suid":Lcom/android/server/pm/SharedUserSetting;
    :catchall_20
    move-exception v1

    goto :goto_25

    .line 6735
    :catch_22
    move-exception v2

    .line 6738
    :goto_23
    monitor-exit v0

    return v1

    .line 6739
    :goto_25
    monitor-exit v0
    :try_end_26
    .catchall {:try_start_1d .. :try_end_26} :catchall_20

    throw v1
.end method

.method public getUnsuspendablePackagesForUser([Ljava/lang/String;I)[Ljava/lang/String;
    .registers 8
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "userId"  # I

    .line 14514
    const-string/jumbo v0, "packageNames cannot be null"

    invoke-static {v0, p1}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 14515
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.SUSPEND_APPS"

    const-string v2, "getUnsuspendablePackagesForUser"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 14517
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 14518
    .local v0, "callingUid":I
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    if-ne v1, p2, :cond_3f

    .line 14522
    new-instance v1, Landroid/util/ArraySet;

    invoke-direct {v1}, Landroid/util/ArraySet;-><init>()V

    .line 14523
    .local v1, "unactionablePackages":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->canSuspendPackageForUserInternal([Ljava/lang/String;I)[Z

    move-result-object v2

    .line 14524
    .local v2, "canSuspend":[Z
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_23
    array-length v4, p1

    if-ge v3, v4, :cond_32

    .line 14525
    aget-boolean v4, v2, v3

    if-nez v4, :cond_2f

    .line 14526
    aget-object v4, p1, v3

    invoke-virtual {v1, v4}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 14524
    :cond_2f
    add-int/lit8 v3, v3, 0x1

    goto :goto_23

    .line 14529
    .end local v3  # "i":I
    :cond_32
    invoke-virtual {v1}, Landroid/util/ArraySet;->size()I

    move-result v3

    new-array v3, v3, [Ljava/lang/String;

    invoke-virtual {v1, v3}, Landroid/util/ArraySet;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v3

    check-cast v3, [Ljava/lang/String;

    return-object v3

    .line 14519
    .end local v1  # "unactionablePackages":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/String;>;"
    .end local v2  # "canSuspend":[Z
    :cond_3f
    new-instance v1, Ljava/lang/SecurityException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Calling uid "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, " cannot query getUnsuspendablePackagesForUser for user "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method getUnusedPackages(J)Ljava/util/Set;
    .registers 24
    .param p1, "downgradeTimeThresholdMillis"  # J
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(J)",
            "Ljava/util/Set<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 26451
    move-object/from16 v1, p0

    new-instance v0, Ljava/util/HashSet;

    invoke-direct {v0}, Ljava/util/HashSet;-><init>()V

    move-object v2, v0

    .line 26452
    .local v2, "unusedPackages":Ljava/util/Set;, "Ljava/util/Set<Ljava/lang/String;>;"
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v14

    .line 26453
    .local v14, "currentTimeInMillis":J
    iget-object v12, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v12

    .line 26454
    :try_start_f
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_19
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_69

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    move-object v13, v3

    .line 26455
    .local v13, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v4, v13, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    move-object v10, v3

    .line 26456
    .local v10, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v10, :cond_36

    .line 26457
    goto :goto_19

    .line 26459
    :cond_36
    nop

    .line 26460
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/pm/PackageManagerService;->getDexManager()Lcom/android/server/pm/dex/DexManager;

    move-result-object v3

    iget-object v4, v13, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Lcom/android/server/pm/dex/DexManager;->getPackageUseInfoOrDefault(Ljava/lang/String;)Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;

    move-result-object v9

    .line 26461
    .local v9, "packageUseInfo":Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;
    iget-wide v3, v10, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J

    .line 26464
    invoke-virtual {v13}, Landroid/content/pm/PackageParser$Package;->getLatestPackageUseTimeInMills()J

    move-result-wide v16

    .line 26465
    invoke-virtual {v13}, Landroid/content/pm/PackageParser$Package;->getLatestForegroundPackageUseTimeInMills()J

    move-result-wide v18
    :try_end_4b
    .catchall {:try_start_f .. :try_end_4b} :catchall_6d

    .line 26462
    move-wide v5, v14

    move-wide/from16 v7, p1

    move-object/from16 v20, v10

    .end local v10  # "ps":Lcom/android/server/pm/PackageSetting;
    .local v20, "ps":Lcom/android/server/pm/PackageSetting;
    move-wide/from16 v10, v16

    move-object/from16 v17, v0

    move-object/from16 v16, v12

    move-object v0, v13

    .end local v13  # "pkg":Landroid/content/pm/PackageParser$Package;
    .local v0, "pkg":Landroid/content/pm/PackageParser$Package;
    move-wide/from16 v12, v18

    :try_start_59
    invoke-static/range {v3 .. v13}, Lcom/android/server/pm/PackageManagerServiceUtils;->isUnusedSinceTimeInMillis(JJJLcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;JJ)Z

    move-result v3

    if-eqz v3, :cond_64

    .line 26466
    iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    invoke-interface {v2, v3}, Ljava/util/Set;->add(Ljava/lang/Object;)Z

    .line 26468
    .end local v0  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v9  # "packageUseInfo":Lcom/android/server/pm/dex/PackageDexUsage$PackageUseInfo;
    .end local v20  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_64
    move-object/from16 v12, v16

    move-object/from16 v0, v17

    goto :goto_19

    .line 26469
    :cond_69
    move-object/from16 v16, v12

    monitor-exit v16

    .line 26470
    return-object v2

    .line 26469
    :catchall_6d
    move-exception v0

    move-object/from16 v16, v12

    :goto_70
    monitor-exit v16
    :try_end_71
    .catchall {:try_start_59 .. :try_end_71} :catchall_72

    throw v0

    :catchall_72
    move-exception v0

    goto :goto_70
.end method

.method public getVerifierDeviceIdentity()Landroid/content/pm/VerifierDeviceIdentity;
    .registers 4
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .line 24717
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.PACKAGE_VERIFICATION_AGENT"

    const-string v2, "Only package verification agents can read the verifier device identity"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 24721
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 24722
    :try_start_c
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1}, Lcom/android/server/pm/Settings;->getVerifierDeviceIdentityLPw()Landroid/content/pm/VerifierDeviceIdentity;

    move-result-object v1

    monitor-exit v0

    return-object v1

    .line 24723
    :catchall_14
    move-exception v1

    monitor-exit v0
    :try_end_16
    .catchall {:try_start_c .. :try_end_16} :catchall_14

    throw v1
.end method

.method public getWellbeingPackageName()Ljava/lang/String;
    .registers 3

    .line 22105
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const v1, 0x1040163

    invoke-virtual {v0, v1}, Landroid/content/Context;->getString(I)Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->ensureSystemPackageName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method public getWhitelistedRestrictedPermissions(Ljava/lang/String;II)Ljava/util/List;
    .registers 14
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "whitelistFlags"  # I
    .param p3, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "II)",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .line 6096
    invoke-static {p1}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6097
    const/4 v0, 0x7

    invoke-static {p2, v0}, Lcom/android/internal/util/Preconditions;->checkFlagsArgument(II)I

    .line 6101
    int-to-float v0, p3

    const/4 v1, 0x0

    invoke-static {v0, v1}, Lcom/android/internal/util/Preconditions;->checkArgumentNonNegative(FLjava/lang/String;)F

    .line 6103
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    if-eq v0, p3, :cond_2a

    .line 6104
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "getWhitelistedRestrictedPermissions for user "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "android.permission.INTERACT_ACROSS_USERS"

    invoke-virtual {v0, v3, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6111
    :cond_2a
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 6112
    :try_start_2d
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 6113
    .local v2, "packageSetting":Lcom/android/server/pm/PackageSetting;
    if-nez v2, :cond_51

    .line 6114
    const-string v3, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unknown package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6115
    monitor-exit v0

    return-object v1

    .line 6118
    :cond_51
    iget-object v3, v2, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 6120
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v5, "android.permission.WHITELIST_RESTRICTED_PERMISSIONS"

    invoke-virtual {v4, v5}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v4

    const/4 v5, 0x0

    const/4 v6, 0x1

    if-nez v4, :cond_61

    move v4, v6

    goto :goto_62

    :cond_61
    move v4, v5

    .line 6123
    .local v4, "isCallerPrivileged":Z
    :goto_62
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v8, v2, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 6125
    .local v7, "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v7, :cond_7e

    iget v8, v7, Lcom/android/server/pm/PackageSetting;->appId:I

    .line 6126
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v9

    invoke-static {v8, v9}, Landroid/os/UserHandle;->isSameApp(II)Z

    move-result v8

    if-eqz v8, :cond_7e

    move v5, v6

    goto :goto_7f

    :cond_7e
    nop

    .line 6128
    .local v5, "isCallerInstallerOnRecord":Z
    :goto_7f
    and-int/lit8 v6, p2, 0x1

    if-eqz v6, :cond_8e

    if-eqz v4, :cond_86

    goto :goto_8e

    .line 6130
    :cond_86
    new-instance v1, Ljava/lang/SecurityException;

    const-string v6, "Querying system whitelist requires android.permission.WHITELIST_RESTRICTED_PERMISSIONS"

    invoke-direct {v1, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "whitelistFlags":I
    .end local p3  # "userId":I
    throw v1

    .line 6134
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "whitelistFlags":I
    .restart local p3  # "userId":I
    :cond_8e
    :goto_8e
    and-int/lit8 v6, p2, 0x6

    if-eqz v6, :cond_9f

    .line 6136
    if-nez v4, :cond_9f

    if-eqz v5, :cond_97

    goto :goto_9f

    .line 6137
    :cond_97
    new-instance v1, Ljava/lang/SecurityException;

    const-string v6, "Querying upgrade or installer whitelist requires being installer on record or android.permission.WHITELIST_RESTRICTED_PERMISSIONS"

    invoke-direct {v1, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "whitelistFlags":I
    .end local p3  # "userId":I
    throw v1

    .line 6143
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "whitelistFlags":I
    .restart local p3  # "userId":I
    :cond_9f
    :goto_9f
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 6144
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v8

    .line 6143
    invoke-direct {p0, v2, v6, v8}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v6

    if-eqz v6, :cond_af

    .line 6145
    monitor-exit v0

    return-object v1

    .line 6147
    .end local v2  # "packageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "isCallerPrivileged":Z
    .end local v5  # "isCallerInstallerOnRecord":Z
    .end local v7  # "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    :cond_af
    monitor-exit v0
    :try_end_b0
    .catchall {:try_start_2d .. :try_end_b0} :catchall_c3

    .line 6149
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 6151
    .local v0, "identity":J
    :try_start_b4
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-virtual {v2, v3, p2, p3}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getWhitelistedRestrictedPermissions(Landroid/content/pm/PackageParser$Package;II)Ljava/util/List;

    move-result-object v2
    :try_end_ba
    .catchall {:try_start_b4 .. :try_end_ba} :catchall_be

    .line 6154
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6151
    return-object v2

    .line 6154
    :catchall_be
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v2

    .line 6147
    .end local v0  # "identity":J
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_c3
    move-exception v1

    :try_start_c4
    monitor-exit v0
    :try_end_c5
    .catchall {:try_start_c4 .. :try_end_c5} :catchall_c3

    throw v1
.end method

.method public grantDefaultPermissionsToActiveLuiApp(Ljava/lang/String;I)V
    .registers 7
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26170
    const-string v0, "grantDefaultPermissionsToActiveLuiApp"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrPhoneCaller(Ljava/lang/String;)V

    .line 26171
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26172
    :try_start_8
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1
    :try_end_c
    .catchall {:try_start_8 .. :try_end_c} :catchall_1c

    .line 26174
    .local v1, "identity":J
    :try_start_c
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    invoke-virtual {v3, p1, p2}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->grantDefaultPermissionsToActiveLuiApp(Ljava/lang/String;I)V
    :try_end_11
    .catchall {:try_start_c .. :try_end_11} :catchall_17

    .line 26177
    :try_start_11
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 26178
    nop

    .line 26179
    .end local v1  # "identity":J
    monitor-exit v0

    .line 26180
    return-void

    .line 26177
    .restart local v1  # "identity":J
    :catchall_17
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    throw v3

    .line 26179
    .end local v1  # "identity":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    :catchall_1c
    move-exception v1

    monitor-exit v0
    :try_end_1e
    .catchall {:try_start_11 .. :try_end_1e} :catchall_1c

    throw v1
.end method

.method public grantDefaultPermissionsToEnabledCarrierApps([Ljava/lang/String;I)V
    .registers 7
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26120
    const-string v0, "grantPermissionsToEnabledCarrierApps"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrPhoneCaller(Ljava/lang/String;)V

    .line 26121
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26122
    :try_start_8
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1
    :try_end_c
    .catchall {:try_start_8 .. :try_end_c} :catchall_1c

    .line 26124
    .local v1, "identity":J
    :try_start_c
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    invoke-virtual {v3, p1, p2}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->grantDefaultPermissionsToEnabledCarrierApps([Ljava/lang/String;I)V
    :try_end_11
    .catchall {:try_start_c .. :try_end_11} :catchall_17

    .line 26127
    :try_start_11
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 26128
    nop

    .line 26129
    .end local v1  # "identity":J
    monitor-exit v0

    .line 26130
    return-void

    .line 26127
    .restart local v1  # "identity":J
    :catchall_17
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageNames":[Ljava/lang/String;
    .end local p2  # "userId":I
    throw v3

    .line 26129
    .end local v1  # "identity":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageNames":[Ljava/lang/String;
    .restart local p2  # "userId":I
    :catchall_1c
    move-exception v1

    monitor-exit v0
    :try_end_1e
    .catchall {:try_start_11 .. :try_end_1e} :catchall_1c

    throw v1
.end method

.method public grantDefaultPermissionsToEnabledImsServices([Ljava/lang/String;I)V
    .registers 7
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26134
    const-string v0, "grantDefaultPermissionsToEnabledImsServices"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrPhoneCaller(Ljava/lang/String;)V

    .line 26135
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26136
    :try_start_8
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1
    :try_end_c
    .catchall {:try_start_8 .. :try_end_c} :catchall_1c

    .line 26138
    .local v1, "identity":J
    :try_start_c
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    invoke-virtual {v3, p1, p2}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->grantDefaultPermissionsToEnabledImsServices([Ljava/lang/String;I)V
    :try_end_11
    .catchall {:try_start_c .. :try_end_11} :catchall_17

    .line 26141
    :try_start_11
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 26142
    nop

    .line 26143
    .end local v1  # "identity":J
    monitor-exit v0

    .line 26144
    return-void

    .line 26141
    .restart local v1  # "identity":J
    :catchall_17
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageNames":[Ljava/lang/String;
    .end local p2  # "userId":I
    throw v3

    .line 26143
    .end local v1  # "identity":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageNames":[Ljava/lang/String;
    .restart local p2  # "userId":I
    :catchall_1c
    move-exception v1

    monitor-exit v0
    :try_end_1e
    .catchall {:try_start_11 .. :try_end_1e} :catchall_1c

    throw v1
.end method

.method public grantDefaultPermissionsToEnabledTelephonyDataServices([Ljava/lang/String;I)V
    .registers 5
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26149
    const-string v0, "grantDefaultPermissionsToEnabledTelephonyDataServices"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrPhoneCaller(Ljava/lang/String;)V

    .line 26150
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26151
    :try_start_8
    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Jk56TooKBJVbCXzf9mkL2I94Ey0;

    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Jk56TooKBJVbCXzf9mkL2I94Ey0;-><init>(Lcom/android/server/pm/PackageManagerService;[Ljava/lang/String;I)V

    invoke-static {v1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V

    .line 26154
    monitor-exit v0

    .line 26155
    return-void

    .line 26154
    :catchall_12
    move-exception v1

    monitor-exit v0
    :try_end_14
    .catchall {:try_start_8 .. :try_end_14} :catchall_12

    throw v1
.end method

.method public grantRuntimePermission(Ljava/lang/String;Ljava/lang/String;I)V
    .registers 12
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "permName"  # Ljava/lang/String;
    .param p3, "userId"  # I

    .line 5987
    nop

    .line 5988
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 5987
    const-string v1, "android.permission.ADJUST_RUNTIME_PERMISSIONS_POLICY"

    invoke-virtual {p0, v1, v0}, Lcom/android/server/pm/PackageManagerService;->checkUidPermission(Ljava/lang/String;I)I

    move-result v0

    if-nez v0, :cond_f

    const/4 v0, 0x1

    goto :goto_10

    :cond_f
    const/4 v0, 0x0

    :goto_10
    move v4, v0

    .line 5991
    .local v4, "overridePolicy":Z
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 5992
    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v5

    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 5991
    move-object v2, p2

    move-object v3, p1

    move v6, p3

    invoke-virtual/range {v1 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->grantRuntimePermission(Ljava/lang/String;Ljava/lang/String;ZIILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 5993
    return-void
.end method

.method public hasSigningCertificate(Ljava/lang/String;[BI)Z
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "certificate"  # [B
    .param p3, "type"  # I

    .line 6474
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 6475
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 6476
    .local v1, "p":Landroid/content/pm/PackageParser$Package;
    const/4 v2, 0x0

    if-eqz v1, :cond_3e

    iget-object v3, v1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    if-nez v3, :cond_13

    goto :goto_3e

    .line 6479
    :cond_13
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    .line 6480
    .local v3, "callingUid":I
    invoke-static {v3}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v4

    .line 6481
    .local v4, "callingUserId":I
    iget-object v5, v1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 6482
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v5, v3, v4}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v6

    if-eqz v6, :cond_27

    .line 6483
    monitor-exit v0

    return v2

    .line 6485
    :cond_27
    if-eqz p3, :cond_36

    const/4 v6, 0x1

    if-eq p3, v6, :cond_2e

    .line 6491
    monitor-exit v0

    return v2

    .line 6489
    :cond_2e
    iget-object v2, v1, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    invoke-virtual {v2, p2}, Landroid/content/pm/PackageParser$SigningDetails;->hasSha256Certificate([B)Z

    move-result v2

    monitor-exit v0

    return v2

    .line 6487
    :cond_36
    iget-object v2, v1, Landroid/content/pm/PackageParser$Package;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    invoke-virtual {v2, p2}, Landroid/content/pm/PackageParser$SigningDetails;->hasCertificate([B)Z

    move-result v2

    monitor-exit v0

    return v2

    .line 6477
    .end local v3  # "callingUid":I
    .end local v4  # "callingUserId":I
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_3e
    :goto_3e
    monitor-exit v0

    return v2

    .line 6493
    .end local v1  # "p":Landroid/content/pm/PackageParser$Package;
    :catchall_40
    move-exception v1

    monitor-exit v0
    :try_end_42
    .catchall {:try_start_3 .. :try_end_42} :catchall_40

    throw v1
.end method

.method public hasSystemFeature(Ljava/lang/String;I)Z
    .registers 7
    .param p1, "name"  # Ljava/lang/String;
    .param p2, "version"  # I

    .line 5847
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 5848
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mAvailableFeatures:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/FeatureInfo;

    .line 5849
    .local v1, "feat":Landroid/content/pm/FeatureInfo;
    const/4 v2, 0x0

    if-nez v1, :cond_10

    .line 5850
    monitor-exit v0

    return v2

    .line 5852
    :cond_10
    iget v3, v1, Landroid/content/pm/FeatureInfo;->version:I

    if-lt v3, p2, :cond_15

    const/4 v2, 0x1

    :cond_15
    monitor-exit v0

    return v2

    .line 5854
    .end local v1  # "feat":Landroid/content/pm/FeatureInfo;
    :catchall_17
    move-exception v1

    monitor-exit v0
    :try_end_19
    .catchall {:try_start_3 .. :try_end_19} :catchall_17

    throw v1
.end method

.method public hasSystemUidErrors()Z
    .registers 2

    .line 22750
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mHasSystemUidErrors:Z

    return v0
.end method

.method public hasUidSigningCertificate(I[BI)Z
    .registers 13
    .param p1, "uid"  # I
    .param p2, "certificate"  # [B
    .param p3, "type"  # I

    .line 6499
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 6500
    .local v0, "callingUid":I
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    .line 6502
    .local v1, "callingUserId":I
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v2

    .line 6504
    .local v2, "appId":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 6506
    :try_start_f
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v4, v2}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v4

    .line 6507
    .local v4, "obj":Ljava/lang/Object;
    const/4 v5, 0x0

    if-eqz v4, :cond_5c

    .line 6508
    instance-of v6, v4, Lcom/android/server/pm/SharedUserSetting;

    const/4 v7, 0x1

    if-eqz v6, :cond_33

    .line 6509
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v6

    if-eqz v6, :cond_25

    move v6, v7

    goto :goto_26

    :cond_25
    move v6, v5

    .line 6510
    .local v6, "isCallerInstantApp":Z
    :goto_26
    if-eqz v6, :cond_2a

    .line 6511
    monitor-exit v3

    return v5

    .line 6513
    :cond_2a
    move-object v8, v4

    check-cast v8, Lcom/android/server/pm/SharedUserSetting;

    iget-object v8, v8, Lcom/android/server/pm/SharedUserSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v8, v8, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    move-object v6, v8

    .line 6514
    .local v6, "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    goto :goto_48

    .end local v6  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    :cond_33
    instance-of v6, v4, Lcom/android/server/pm/PackageSetting;

    if-eqz v6, :cond_5a

    .line 6515
    move-object v6, v4

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    .line 6516
    .local v6, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v6, v0, v1}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v8

    if-eqz v8, :cond_42

    .line 6517
    monitor-exit v3

    return v5

    .line 6519
    :cond_42
    iget-object v8, v6, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v8, v8, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    move-object v6, v8

    .line 6520
    .local v6, "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    nop

    .line 6526
    :goto_48
    if-eqz p3, :cond_54

    if-eq p3, v7, :cond_4e

    .line 6532
    monitor-exit v3

    return v5

    .line 6530
    :cond_4e
    invoke-virtual {v6, p2}, Landroid/content/pm/PackageParser$SigningDetails;->hasSha256Certificate([B)Z

    move-result v5

    monitor-exit v3

    return v5

    .line 6528
    :cond_54
    invoke-virtual {v6, p2}, Landroid/content/pm/PackageParser$SigningDetails;->hasCertificate([B)Z

    move-result v5

    monitor-exit v3

    return v5

    .line 6521
    .end local v6  # "signingDetails":Landroid/content/pm/PackageParser$SigningDetails;
    :cond_5a
    monitor-exit v3

    return v5

    .line 6524
    :cond_5c
    monitor-exit v3

    return v5

    .line 6534
    .end local v4  # "obj":Ljava/lang/Object;
    :catchall_5e
    move-exception v4

    monitor-exit v3
    :try_end_60
    .catchall {:try_start_f .. :try_end_60} :catchall_5e

    throw v4
.end method

.method public initDefaultOpService()V
    .registers 3

    .line 26867
    new-instance v0, Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-direct {v0, v1}, Lcom/android/server/pm/PackageDefaultOpService;-><init>(Landroid/content/Context;)V

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    .line 26868
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->verifyVersion()V

    .line 26869
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->updateVersion()V

    .line 26871
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    invoke-virtual {v0}, Lcom/android/server/pm/PackageDefaultOpService;->writeState()V

    .line 26872
    return-void
.end method

.method public installExistingPackageAsUser(Ljava/lang/String;IIILjava/util/List;)I
    .registers 13
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "installFlags"  # I
    .param p4, "installReason"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "III",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;)I"
        }
    .end annotation

    .line 14004
    .local p5, "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    const/4 v6, 0x0

    move-object v0, p0

    move-object v1, p1

    move v2, p2

    move v3, p3

    move v4, p4

    move-object v5, p5

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->installExistingPackageAsUser(Ljava/lang/String;IIILjava/util/List;Landroid/content/IntentSender;)I

    move-result v0

    return v0
.end method

.method installExistingPackageAsUser(Ljava/lang/String;IIILjava/util/List;Landroid/content/IntentSender;)I
    .registers 35
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "installFlags"  # I
    .param p4, "installReason"  # I
    .param p6, "intentSender"  # Landroid/content/IntentSender;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "III",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;",
            "Landroid/content/IntentSender;",
            ")I"
        }
    .end annotation

    .line 14012
    .local p5, "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move-object/from16 v8, p0

    move-object/from16 v9, p1

    move/from16 v10, p2

    move/from16 v11, p3

    move/from16 v12, p4

    move-object/from16 v13, p6

    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_4a

    .line 14013
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v1, "installExistingPackageAsUser package="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " userId="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, " installFlags="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, " installReason="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, " whiteListedPermissions="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v7, p5

    invoke-virtual {v0, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_4c

    .line 14012
    :cond_4a
    move-object/from16 v7, p5

    .line 14018
    :goto_4c
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v14

    .line 14019
    .local v14, "callingUid":I
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.INSTALL_PACKAGES"

    invoke-virtual {v0, v1}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_8b

    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 14021
    const-string v1, "com.android.permission.INSTALL_EXISTING_PACKAGES"

    invoke-virtual {v0, v1}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    if-nez v0, :cond_65

    goto :goto_8b

    .line 14024
    :cond_65
    new-instance v0, Ljava/lang/SecurityException;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Neither user "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, " nor current process has "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, "android.permission.INSTALL_PACKAGES"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, "."

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 14028
    :cond_8b
    :goto_8b
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v4, 0x1

    const/4 v5, 0x1

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v2, "installExistingPackage for user "

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move v2, v14

    move/from16 v3, p2

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 14031
    const-string/jumbo v0, "no_install_apps"

    invoke-virtual {v8, v10, v0}, Lcom/android/server/pm/PackageManagerService;->isUserRestricted(ILjava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_b3

    .line 14032
    const/16 v0, -0x6f

    return v0

    .line 14035
    :cond_b3
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v15

    .line 14037
    .local v15, "callingId":J
    const/4 v1, 0x0

    .line 14038
    .local v1, "installed":Z
    and-int/lit16 v0, v11, 0x800

    if-eqz v0, :cond_be

    const/4 v0, 0x1

    goto :goto_bf

    :cond_be
    const/4 v0, 0x0

    :goto_bf
    move v4, v0

    .line 14040
    .local v4, "instantApp":Z
    and-int/lit16 v0, v11, 0x4000

    if-eqz v0, :cond_c6

    const/4 v0, 0x1

    goto :goto_c7

    :cond_c6
    const/4 v0, 0x0

    :goto_c7
    move v3, v0

    .line 14043
    .local v3, "fullApp":Z
    :try_start_c8
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v2
    :try_end_cb
    .catchall {:try_start_c8 .. :try_end_cb} :catchall_395

    .line 14044
    :try_start_cb
    iget-object v6, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6
    :try_end_ce
    .catchall {:try_start_cb .. :try_end_ce} :catchall_388

    .line 14045
    :try_start_ce
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v9}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;
    :try_end_d8
    .catchall {:try_start_ce .. :try_end_d8} :catchall_37d

    .line 14046
    .local v0, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-nez v0, :cond_f8

    :try_start_da
    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->inCts()Z

    move-result v18

    if-nez v18, :cond_f8

    .line 14047
    invoke-direct/range {p0 .. p1}, Lcom/android/server/pm/PackageManagerService;->installBultInMzAppIfNeeded(Ljava/lang/String;)Landroid/content/pm/PackageParser$Package;

    .line 14048
    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v9}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;
    :try_end_ed
    .catchall {:try_start_da .. :try_end_ed} :catchall_ef

    move-object v0, v5

    goto :goto_f9

    .line 14050
    .end local v0  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :catchall_ef
    move-exception v0

    move/from16 v19, v1

    move/from16 v25, v14

    move v14, v3

    move v3, v4

    goto/16 :goto_384

    .restart local v0  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_f8
    move-object v5, v0

    .end local v0  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v5, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_f9
    :try_start_f9
    monitor-exit v6
    :try_end_fa
    .catchall {:try_start_f9 .. :try_end_fa} :catchall_37d

    .line 14051
    :try_start_fa
    monitor-exit v2
    :try_end_fb
    .catchall {:try_start_fa .. :try_end_fb} :catchall_388

    .line 14054
    :try_start_fb
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2
    :try_end_fe
    .catchall {:try_start_fb .. :try_end_fe} :catchall_395

    .line 14055
    :try_start_fe
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v9}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;
    :try_end_108
    .catchall {:try_start_fe .. :try_end_108} :catchall_372

    move-object v6, v0

    .line 14056
    .end local v5  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v6, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    const/4 v0, -0x3

    if-nez v6, :cond_11b

    .line 14057
    :try_start_10c
    monitor-exit v2
    :try_end_10d
    .catchall {:try_start_10c .. :try_end_10d} :catchall_111

    .line 14183
    invoke-static/range {v15 .. v16}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 14057
    return v0

    .line 14073
    :catchall_111
    move-exception v0

    move/from16 v19, v1

    move-object v5, v6

    move/from16 v25, v14

    move v14, v3

    move v3, v4

    goto/16 :goto_379

    .line 14059
    :cond_11b
    :try_start_11b
    invoke-static {v14}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v5

    invoke-direct {v8, v14, v5}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v5
    :try_end_123
    .catchall {:try_start_11b .. :try_end_123} :catchall_369

    if-nez v5, :cond_168

    .line 14062
    const/4 v5, 0x0

    .line 14063
    .local v5, "installAllowed":Z
    :try_start_126
    sget-object v19, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual/range {v19 .. v19}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v0
    :try_end_12c
    .catchall {:try_start_126 .. :try_end_12c} :catchall_15e

    move/from16 v19, v1

    .end local v1  # "installed":Z
    .local v19, "installed":Z
    :try_start_12e
    array-length v1, v0

    move/from16 v21, v5

    const/4 v5, 0x0

    .end local v5  # "installAllowed":Z
    .local v21, "installAllowed":Z
    :goto_132
    if-ge v5, v1, :cond_14e

    aget v22, v0, v5

    move/from16 v23, v22

    .line 14064
    .local v23, "checkUserId":I
    move-object/from16 v22, v0

    move/from16 v0, v23

    .end local v23  # "checkUserId":I
    .local v0, "checkUserId":I
    invoke-virtual {v6, v0}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v23

    const/16 v18, 0x1

    xor-int/lit8 v23, v23, 0x1

    move/from16 v21, v23

    .line 14065
    if-eqz v21, :cond_149

    .line 14066
    goto :goto_14e

    .line 14063
    .end local v0  # "checkUserId":I
    :cond_149
    add-int/lit8 v5, v5, 0x1

    move-object/from16 v0, v22

    goto :goto_132

    .line 14069
    :cond_14e
    :goto_14e
    if-nez v21, :cond_16a

    .line 14070
    monitor-exit v2
    :try_end_151
    .catchall {:try_start_12e .. :try_end_151} :catchall_156

    .line 14183
    invoke-static/range {v15 .. v16}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 14070
    const/4 v0, -0x3

    return v0

    .line 14073
    .end local v21  # "installAllowed":Z
    :catchall_156
    move-exception v0

    move-object v5, v6

    move/from16 v25, v14

    move v14, v3

    move v3, v4

    goto/16 :goto_379

    .end local v19  # "installed":Z
    .restart local v1  # "installed":Z
    :catchall_15e
    move-exception v0

    move/from16 v19, v1

    move-object v5, v6

    move/from16 v25, v14

    move v14, v3

    move v3, v4

    .end local v1  # "installed":Z
    .restart local v19  # "installed":Z
    goto/16 :goto_379

    .line 14059
    .end local v19  # "installed":Z
    .restart local v1  # "installed":Z
    :cond_168
    move/from16 v19, v1

    .line 14073
    .end local v1  # "installed":Z
    .restart local v19  # "installed":Z
    :cond_16a
    :try_start_16a
    monitor-exit v2
    :try_end_16b
    .catchall {:try_start_16a .. :try_end_16b} :catchall_362

    .line 14076
    if-nez v10, :cond_2af

    :try_start_16d
    iget-object v2, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v2, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->privateFlags:I

    const/high16 v20, -0x80000000

    and-int v2, v2, v20

    if-eqz v2, :cond_2af

    .line 14078
    sget-object v2, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v2}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v2

    .line 14079
    .local v2, "tallUsers":[I
    const/16 v5, 0x3e7

    invoke-static {v2, v5}, Lcom/android/internal/util/ArrayUtils;->removeInt([II)[I

    move-result-object v5

    .line 14080
    .local v5, "allUsers":[I
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1
    :try_end_188
    .catchall {:try_start_16d .. :try_end_188} :catchall_395

    .line 14081
    :try_start_188
    array-length v0, v5
    :try_end_189
    .catchall {:try_start_188 .. :try_end_189} :catchall_2a2

    move-object/from16 v23, v2

    const/4 v2, 0x0

    .end local v2  # "tallUsers":[I
    .local v23, "tallUsers":[I
    :goto_18c
    if-ge v2, v0, :cond_1cf

    :try_start_18e
    aget v24, v5, v2

    .line 14082
    .local v24, "checkUserId":I
    invoke-virtual {v6, v10}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v25

    if-nez v25, :cond_1b1

    .line 14083
    move/from16 v25, v0

    const/4 v0, 0x1

    invoke-virtual {v6, v0, v10}, Lcom/android/server/pm/PackageSetting;->setInstalled(ZI)V

    .line 14084
    const/4 v0, 0x0

    invoke-virtual {v6, v0, v10}, Lcom/android/server/pm/PackageSetting;->setHidden(ZI)V

    .line 14085
    invoke-virtual {v6, v12, v10}, Lcom/android/server/pm/PackageSetting;->setInstallReason(II)V

    .line 14086
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v10}, Lcom/android/server/pm/Settings;->writePackageRestrictionsLPr(I)V

    .line 14087
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v6}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V

    .line 14088
    const/4 v0, 0x1

    move/from16 v19, v0

    .end local v19  # "installed":Z
    .local v0, "installed":Z
    goto :goto_1be

    .line 14089
    .end local v0  # "installed":Z
    .restart local v19  # "installed":Z
    :cond_1b1
    move/from16 v25, v0

    if-eqz v3, :cond_1be

    invoke-virtual {v6, v10}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v0

    if-eqz v0, :cond_1be

    .line 14091
    const/4 v0, 0x1

    move/from16 v19, v0

    .line 14093
    :cond_1be
    :goto_1be
    invoke-static {v6, v10, v4, v3}, Lcom/android/server/pm/PackageManagerService;->setInstantAppForUser(Lcom/android/server/pm/PackageSetting;IZZ)V

    .line 14081
    .end local v24  # "checkUserId":I
    add-int/lit8 v2, v2, 0x1

    move/from16 v0, v25

    goto :goto_18c

    .line 14098
    :catchall_1c6
    move-exception v0

    move/from16 v26, v4

    move-object v2, v5

    move/from16 v25, v14

    move v14, v3

    goto/16 :goto_2ab

    .line 14095
    :cond_1cf
    if-eqz v19, :cond_1d6

    .line 14096
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v0, v6}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V
    :try_end_1d6
    .catchall {:try_start_18e .. :try_end_1d6} :catchall_1c6

    .line 14098
    :cond_1d6
    :try_start_1d6
    monitor-exit v1
    :try_end_1d7
    .catchall {:try_start_1d6 .. :try_end_1d7} :catchall_29a

    .line 14099
    if-eqz v19, :cond_28f

    .line 14100
    const/high16 v0, 0x400000

    and-int/2addr v0, v11

    if-eqz v0, :cond_1ed

    :try_start_1de
    iget-object v0, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v0, :cond_1ed

    .line 14102
    iget-object v0, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->requestedPermissions:Ljava/util/ArrayList;
    :try_end_1e6
    .catchall {:try_start_1de .. :try_end_1e6} :catchall_1e8

    move-object v7, v0

    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v0, "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    goto :goto_1ed

    .line 14183
    .end local v0  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v3  # "fullApp":Z
    .end local v4  # "instantApp":Z
    .end local v5  # "allUsers":[I
    .end local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v19  # "installed":Z
    .end local v23  # "tallUsers":[I
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :catchall_1e8
    move-exception v0

    move/from16 v25, v14

    goto/16 :goto_398

    .line 14104
    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v3  # "fullApp":Z
    .restart local v4  # "instantApp":Z
    .restart local v5  # "allUsers":[I
    .restart local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v7, "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v19  # "installed":Z
    .restart local v23  # "tallUsers":[I
    :cond_1ed
    :goto_1ed
    const/4 v0, 0x2

    :try_start_1ee
    invoke-direct {v8, v9, v7, v0, v10}, Lcom/android/server/pm/PackageManagerService;->setWhitelistedRestrictedPermissions(Ljava/lang/String;Ljava/util/List;II)Z

    .line 14107
    iget-object v0, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;
    :try_end_1f3
    .catchall {:try_start_1ee .. :try_end_1f3} :catchall_288

    if-eqz v0, :cond_207

    .line 14108
    :try_start_1f5
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v1
    :try_end_1f8
    .catchall {:try_start_1f5 .. :try_end_1f8} :catchall_202

    .line 14110
    :try_start_1f8
    iget-object v0, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-direct {v8, v0}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataAfterInstallLIF(Landroid/content/pm/PackageParser$Package;)V

    .line 14111
    monitor-exit v1

    goto :goto_207

    :catchall_1ff
    move-exception v0

    monitor-exit v1
    :try_end_201
    .catchall {:try_start_1f8 .. :try_end_201} :catchall_1ff

    .end local v7  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v14  # "callingUid":I
    .end local v15  # "callingId":J
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    .end local p3  # "installFlags":I
    .end local p4  # "installReason":I
    .end local p6  # "intentSender":Landroid/content/IntentSender;
    :try_start_201
    throw v0
    :try_end_202
    .catchall {:try_start_201 .. :try_end_202} :catchall_202

    .line 14183
    .end local v3  # "fullApp":Z
    .end local v4  # "instantApp":Z
    .end local v5  # "allUsers":[I
    .end local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v19  # "installed":Z
    .end local v23  # "tallUsers":[I
    .restart local v7  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v14  # "callingUid":I
    .restart local v15  # "callingId":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    .restart local p3  # "installFlags":I
    .restart local p4  # "installReason":I
    .restart local p6  # "intentSender":Landroid/content/IntentSender;
    :catchall_202
    move-exception v0

    move/from16 v25, v14

    goto/16 :goto_398

    .line 14114
    .restart local v3  # "fullApp":Z
    .restart local v4  # "instantApp":Z
    .restart local v5  # "allUsers":[I
    .restart local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v19  # "installed":Z
    .restart local v23  # "tallUsers":[I
    :cond_207
    :goto_207
    const/4 v0, 0x0

    const/16 v21, 0x0

    :try_start_20a
    iget v2, v6, Lcom/android/server/pm/PackageSetting;->appId:I

    sget-object v22, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I
    :try_end_20e
    .catchall {:try_start_20a .. :try_end_20e} :catchall_288

    move-object/from16 v1, p0

    move/from16 v24, v2

    move-object/from16 v2, p1

    move/from16 v25, v14

    move v14, v3

    .end local v3  # "fullApp":Z
    .local v14, "fullApp":Z
    .local v25, "callingUid":I
    move v3, v0

    move/from16 v26, v4

    .end local v4  # "instantApp":Z
    .local v26, "instantApp":Z
    move/from16 v4, v21

    move-object/from16 v21, v5

    const/4 v0, 0x1

    .end local v5  # "allUsers":[I
    .local v21, "allUsers":[I
    move/from16 v5, v24

    move-object/from16 v27, v6

    .end local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v27, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    move-object/from16 v6, v21

    move-object/from16 v17, v7

    .end local v7  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v17, "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move-object/from16 v7, v22

    :try_start_229
    invoke-virtual/range {v1 .. v7}, Lcom/android/server/pm/PackageManagerService;->sendPackageAddedForNewUsers(Ljava/lang/String;ZZI[I[I)V

    .line 14115
    move-object/from16 v2, v21

    .end local v21  # "allUsers":[I
    .local v2, "allUsers":[I
    array-length v1, v2

    const/4 v3, 0x0

    :goto_230
    if-ge v3, v1, :cond_24b

    aget v4, v2, v3

    .line 14116
    .local v4, "checkUserId":I
    new-instance v5, Landroid/content/pm/PackageInstaller$SessionInfo;

    invoke-direct {v5}, Landroid/content/pm/PackageInstaller$SessionInfo;-><init>()V

    .line 14117
    .local v5, "info":Landroid/content/pm/PackageInstaller$SessionInfo;
    move-object/from16 v6, v27

    .end local v27  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v6, v4}, Lcom/android/server/pm/PackageSetting;->getInstallReason(I)I

    move-result v7

    iput v7, v5, Landroid/content/pm/PackageInstaller$SessionInfo;->installReason:I

    .line 14118
    iput-object v9, v5, Landroid/content/pm/PackageInstaller$SessionInfo;->appPackageName:Ljava/lang/String;

    .line 14119
    invoke-virtual {v8, v5, v4}, Lcom/android/server/pm/PackageManagerService;->sendSessionCommitBroadcast(Landroid/content/pm/PackageInstaller$SessionInfo;I)V

    .line 14115
    .end local v4  # "checkUserId":I
    .end local v5  # "info":Landroid/content/pm/PackageInstaller$SessionInfo;
    add-int/lit8 v3, v3, 0x1

    move-object/from16 v27, v6

    goto :goto_230

    .line 14122
    .end local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v27  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_24b
    move-object/from16 v6, v27

    .end local v27  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1
    :try_end_250
    .catchall {:try_start_229 .. :try_end_250} :catchall_283

    .line 14123
    :try_start_250
    new-array v3, v0, [I

    const/4 v4, 0x0

    aput v10, v3, v4

    invoke-direct {v8, v6, v3}, Lcom/android/server/pm/PackageManagerService;->updateSequenceNumberLP(Lcom/android/server/pm/PackageSetting;[I)V

    .line 14124
    monitor-exit v1
    :try_end_259
    .catchall {:try_start_250 .. :try_end_259} :catchall_280

    .line 14126
    nop

    .line 14127
    :try_start_25a
    invoke-direct {v8, v0}, Lcom/android/server/pm/PackageManagerService;->createPackageInstalledInfo(I)Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    move-result-object v1

    .line 14128
    .local v1, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    iget-object v3, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iput-object v3, v1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 14129
    new-array v3, v0, [I

    aput v10, v3, v4

    iput-object v3, v1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    .line 14130
    if-nez v13, :cond_26d

    const/16 v20, 0x0

    goto :goto_27a

    .line 14131
    :cond_26d
    new-instance v5, Lcom/android/server/pm/PackageManagerService$PostInstallData;

    new-instance v3, Lcom/android/server/pm/-$$Lambda$PackageManagerService$TfnapVkUze7EtdWImq0cww0iVcc;

    invoke-direct {v3, v8, v1, v13}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$TfnapVkUze7EtdWImq0cww0iVcc;-><init>(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/IntentSender;)V

    const/4 v4, 0x0

    invoke-direct {v5, v4, v1, v3}, Lcom/android/server/pm/PackageManagerService$PostInstallData;-><init>(Lcom/android/server/pm/PackageManagerService$InstallArgs;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Ljava/lang/Runnable;)V

    move-object/from16 v20, v5

    :goto_27a
    move-object/from16 v3, v20

    .line 14133
    .local v3, "postInstallData":Lcom/android/server/pm/PackageManagerService$PostInstallData;
    invoke-direct {v8, v10, v1, v3}, Lcom/android/server/pm/PackageManagerService;->restoreAndPostInstall(ILcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Lcom/android/server/pm/PackageManagerService$PostInstallData;)V
    :try_end_27f
    .catchall {:try_start_25a .. :try_end_27f} :catchall_283

    goto :goto_298

    .line 14124
    .end local v1  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .end local v3  # "postInstallData":Lcom/android/server/pm/PackageManagerService$PostInstallData;
    :catchall_280
    move-exception v0

    :try_start_281
    monitor-exit v1
    :try_end_282
    .catchall {:try_start_281 .. :try_end_282} :catchall_280

    .end local v15  # "callingId":J
    .end local v17  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v25  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    .end local p3  # "installFlags":I
    .end local p4  # "installReason":I
    .end local p6  # "intentSender":Landroid/content/IntentSender;
    :try_start_282
    throw v0
    :try_end_283
    .catchall {:try_start_282 .. :try_end_283} :catchall_283

    .line 14183
    .end local v2  # "allUsers":[I
    .end local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v14  # "fullApp":Z
    .end local v19  # "installed":Z
    .end local v23  # "tallUsers":[I
    .end local v26  # "instantApp":Z
    .restart local v15  # "callingId":J
    .restart local v17  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v25  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    .restart local p3  # "installFlags":I
    .restart local p4  # "installReason":I
    .restart local p6  # "intentSender":Landroid/content/IntentSender;
    :catchall_283
    move-exception v0

    move-object/from16 v7, v17

    goto/16 :goto_398

    .end local v17  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v25  # "callingUid":I
    .restart local v7  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v14, "callingUid":I
    :catchall_288
    move-exception v0

    move-object/from16 v17, v7

    move/from16 v25, v14

    .end local v7  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v14  # "callingUid":I
    .restart local v17  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v25  # "callingUid":I
    goto/16 :goto_398

    .line 14099
    .end local v17  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v25  # "callingUid":I
    .local v3, "fullApp":Z
    .local v4, "instantApp":Z
    .local v5, "allUsers":[I
    .restart local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v14  # "callingUid":I
    .restart local v19  # "installed":Z
    .restart local v23  # "tallUsers":[I
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_28f
    move/from16 v26, v4

    move-object v2, v5

    move/from16 v25, v14

    const/4 v0, 0x1

    move v14, v3

    .end local v3  # "fullApp":Z
    .end local v4  # "instantApp":Z
    .end local v5  # "allUsers":[I
    .restart local v2  # "allUsers":[I
    .local v14, "fullApp":Z
    .restart local v25  # "callingUid":I
    .restart local v26  # "instantApp":Z
    move-object/from16 v17, v7

    .line 14135
    .end local v2  # "allUsers":[I
    .end local v23  # "tallUsers":[I
    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v17  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :goto_298
    goto/16 :goto_351

    .line 14098
    .end local v17  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v25  # "callingUid":I
    .end local v26  # "instantApp":Z
    .restart local v3  # "fullApp":Z
    .restart local v4  # "instantApp":Z
    .restart local v5  # "allUsers":[I
    .local v14, "callingUid":I
    .restart local v23  # "tallUsers":[I
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :catchall_29a
    move-exception v0

    move/from16 v26, v4

    move-object v2, v5

    move/from16 v25, v14

    move v14, v3

    .end local v3  # "fullApp":Z
    .end local v4  # "instantApp":Z
    .end local v5  # "allUsers":[I
    .restart local v2  # "allUsers":[I
    .local v14, "fullApp":Z
    .restart local v25  # "callingUid":I
    .restart local v26  # "instantApp":Z
    goto :goto_2ab

    .end local v23  # "tallUsers":[I
    .end local v25  # "callingUid":I
    .end local v26  # "instantApp":Z
    .local v2, "tallUsers":[I
    .restart local v3  # "fullApp":Z
    .restart local v4  # "instantApp":Z
    .restart local v5  # "allUsers":[I
    .local v14, "callingUid":I
    :catchall_2a2
    move-exception v0

    move-object/from16 v23, v2

    move/from16 v26, v4

    move-object v2, v5

    move/from16 v25, v14

    move v14, v3

    .end local v3  # "fullApp":Z
    .end local v4  # "instantApp":Z
    .end local v5  # "allUsers":[I
    .local v2, "allUsers":[I
    .local v14, "fullApp":Z
    .restart local v23  # "tallUsers":[I
    .restart local v25  # "callingUid":I
    .restart local v26  # "instantApp":Z
    :goto_2ab
    :try_start_2ab
    monitor-exit v1
    :try_end_2ac
    .catchall {:try_start_2ab .. :try_end_2ac} :catchall_2ad

    .end local v15  # "callingId":J
    .end local v25  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    .end local p3  # "installFlags":I
    .end local p4  # "installReason":I
    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local p6  # "intentSender":Landroid/content/IntentSender;
    :try_start_2ac
    throw v0

    .restart local v15  # "callingId":J
    .restart local v25  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    .restart local p3  # "installFlags":I
    .restart local p4  # "installReason":I
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p6  # "intentSender":Landroid/content/IntentSender;
    :catchall_2ad
    move-exception v0

    goto :goto_2ab

    .line 14076
    .end local v2  # "allUsers":[I
    .end local v23  # "tallUsers":[I
    .end local v25  # "callingUid":I
    .end local v26  # "instantApp":Z
    .restart local v3  # "fullApp":Z
    .restart local v4  # "instantApp":Z
    .local v14, "callingUid":I
    :cond_2af
    move/from16 v26, v4

    move/from16 v25, v14

    const/4 v0, 0x1

    const/4 v4, 0x0

    move v14, v3

    .line 14137
    .end local v3  # "fullApp":Z
    .end local v4  # "instantApp":Z
    .local v14, "fullApp":Z
    .restart local v25  # "callingUid":I
    .restart local v26  # "instantApp":Z
    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1
    :try_end_2b9
    .catchall {:try_start_2ac .. :try_end_2b9} :catchall_391

    .line 14138
    :try_start_2b9
    invoke-virtual {v6, v10}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v2
    :try_end_2bd
    .catchall {:try_start_2b9 .. :try_end_2bd} :catchall_35b

    if-nez v2, :cond_2d9

    .line 14139
    :try_start_2bf
    invoke-virtual {v6, v0, v10}, Lcom/android/server/pm/PackageSetting;->setInstalled(ZI)V

    .line 14140
    invoke-virtual {v6, v4, v10}, Lcom/android/server/pm/PackageSetting;->setHidden(ZI)V

    .line 14141
    invoke-virtual {v6, v12, v10}, Lcom/android/server/pm/PackageSetting;->setInstallReason(II)V

    .line 14142
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v10}, Lcom/android/server/pm/Settings;->writePackageRestrictionsLPr(I)V

    .line 14143
    iget-object v2, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, v6}, Lcom/android/server/pm/Settings;->writeKernelMappingLPr(Lcom/android/server/pm/PackageSetting;)V

    .line 14144
    const/4 v2, 0x1

    .end local v19  # "installed":Z
    .local v2, "installed":Z
    goto :goto_2e5

    .line 14150
    .end local v2  # "installed":Z
    .restart local v19  # "installed":Z
    :catchall_2d4
    move-exception v0

    move/from16 v3, v26

    goto/16 :goto_35e

    .line 14145
    :cond_2d9
    if-eqz v14, :cond_2e3

    invoke-virtual {v6, v10}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v2
    :try_end_2df
    .catchall {:try_start_2bf .. :try_end_2df} :catchall_2d4

    if-eqz v2, :cond_2e3

    .line 14147
    const/4 v2, 0x1

    .end local v19  # "installed":Z
    .restart local v2  # "installed":Z
    goto :goto_2e5

    .line 14149
    .end local v2  # "installed":Z
    .restart local v19  # "installed":Z
    :cond_2e3
    move/from16 v2, v19

    .end local v19  # "installed":Z
    .restart local v2  # "installed":Z
    :goto_2e5
    move/from16 v3, v26

    .end local v26  # "instantApp":Z
    .local v3, "instantApp":Z
    :try_start_2e7
    invoke-static {v6, v10, v3, v14}, Lcom/android/server/pm/PackageManagerService;->setInstantAppForUser(Lcom/android/server/pm/PackageSetting;IZZ)V

    .line 14150
    monitor-exit v1
    :try_end_2eb
    .catchall {:try_start_2e7 .. :try_end_2eb} :catchall_357

    .line 14152
    if-eqz v2, :cond_34f

    .line 14153
    const/high16 v1, 0x400000

    and-int/2addr v1, v11

    if-eqz v1, :cond_2fb

    :try_start_2f2
    iget-object v1, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v1, :cond_2fb

    .line 14155
    iget-object v1, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v1, v1, Landroid/content/pm/PackageParser$Package;->requestedPermissions:Ljava/util/ArrayList;
    :try_end_2fa
    .catchall {:try_start_2f2 .. :try_end_2fa} :catchall_391

    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v1, "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    goto :goto_2fc

    .line 14157
    .end local v1  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_2fb
    move-object v1, v7

    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v1  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :goto_2fc
    const/4 v5, 0x2

    :try_start_2fd
    invoke-direct {v8, v9, v1, v5, v10}, Lcom/android/server/pm/PackageManagerService;->setWhitelistedRestrictedPermissions(Ljava/lang/String;Ljava/util/List;II)Z

    .line 14160
    iget-object v5, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    if-eqz v5, :cond_311

    .line 14161
    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v5
    :try_end_307
    .catchall {:try_start_2fd .. :try_end_307} :catchall_34b

    .line 14163
    :try_start_307
    iget-object v7, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    invoke-direct {v8, v7}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataAfterInstallLIF(Landroid/content/pm/PackageParser$Package;)V

    .line 14164
    monitor-exit v5

    goto :goto_311

    :catchall_30e
    move-exception v0

    monitor-exit v5
    :try_end_310
    .catchall {:try_start_307 .. :try_end_310} :catchall_30e

    .end local v1  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v15  # "callingId":J
    .end local v25  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    .end local p3  # "installFlags":I
    .end local p4  # "installReason":I
    .end local p6  # "intentSender":Landroid/content/IntentSender;
    :try_start_310
    throw v0

    .line 14166
    .restart local v1  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v15  # "callingId":J
    .restart local v25  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    .restart local p3  # "installFlags":I
    .restart local p4  # "installReason":I
    .restart local p6  # "intentSender":Landroid/content/IntentSender;
    :cond_311
    :goto_311
    invoke-direct {v8, v9, v6, v10}, Lcom/android/server/pm/PackageManagerService;->sendPackageAddedForUser(Ljava/lang/String;Lcom/android/server/pm/PackageSetting;I)V

    .line 14167
    iget-object v5, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5
    :try_end_317
    .catchall {:try_start_310 .. :try_end_317} :catchall_34b

    .line 14168
    :try_start_317
    new-array v7, v0, [I

    aput v10, v7, v4

    invoke-direct {v8, v6, v7}, Lcom/android/server/pm/PackageManagerService;->updateSequenceNumberLP(Lcom/android/server/pm/PackageSetting;[I)V

    .line 14169
    monitor-exit v5
    :try_end_31f
    .catchall {:try_start_317 .. :try_end_31f} :catchall_348

    .line 14171
    nop

    .line 14172
    :try_start_320
    invoke-direct {v8, v0}, Lcom/android/server/pm/PackageManagerService;->createPackageInstalledInfo(I)Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    move-result-object v5

    .line 14173
    .local v5, "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    iget-object v7, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    iput-object v7, v5, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 14174
    new-array v7, v0, [I

    aput v10, v7, v4

    iput-object v7, v5, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    .line 14175
    if-nez v13, :cond_333

    const/16 v20, 0x0

    goto :goto_340

    .line 14176
    :cond_333
    new-instance v4, Lcom/android/server/pm/PackageManagerService$PostInstallData;

    new-instance v7, Lcom/android/server/pm/-$$Lambda$PackageManagerService$5bfG3NWHFMyAy9KctvBO9i2pciI;

    invoke-direct {v7, v8, v5, v13}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$5bfG3NWHFMyAy9KctvBO9i2pciI;-><init>(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/IntentSender;)V

    const/4 v0, 0x0

    invoke-direct {v4, v0, v5, v7}, Lcom/android/server/pm/PackageManagerService$PostInstallData;-><init>(Lcom/android/server/pm/PackageManagerService$InstallArgs;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Ljava/lang/Runnable;)V

    move-object/from16 v20, v4

    :goto_340
    move-object/from16 v0, v20

    .line 14178
    .local v0, "postInstallData":Lcom/android/server/pm/PackageManagerService$PostInstallData;
    invoke-direct {v8, v10, v5, v0}, Lcom/android/server/pm/PackageManagerService;->restoreAndPostInstall(ILcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Lcom/android/server/pm/PackageManagerService$PostInstallData;)V
    :try_end_345
    .catchall {:try_start_320 .. :try_end_345} :catchall_34b

    move-object/from16 v17, v1

    goto :goto_351

    .line 14169
    .end local v0  # "postInstallData":Lcom/android/server/pm/PackageManagerService$PostInstallData;
    .end local v5  # "res":Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    :catchall_348
    move-exception v0

    :try_start_349
    monitor-exit v5
    :try_end_34a
    .catchall {:try_start_349 .. :try_end_34a} :catchall_348

    .end local v1  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v15  # "callingId":J
    .end local v25  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    .end local p3  # "installFlags":I
    .end local p4  # "installReason":I
    .end local p6  # "intentSender":Landroid/content/IntentSender;
    :try_start_34a
    throw v0
    :try_end_34b
    .catchall {:try_start_34a .. :try_end_34b} :catchall_34b

    .line 14183
    .end local v2  # "installed":Z
    .end local v3  # "instantApp":Z
    .end local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v14  # "fullApp":Z
    .restart local v1  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v15  # "callingId":J
    .restart local v25  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    .restart local p3  # "installFlags":I
    .restart local p4  # "installReason":I
    .restart local p6  # "intentSender":Landroid/content/IntentSender;
    :catchall_34b
    move-exception v0

    move-object v7, v1

    goto/16 :goto_398

    .line 14152
    .end local v1  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v2  # "installed":Z
    .restart local v3  # "instantApp":Z
    .restart local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v14  # "fullApp":Z
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_34f
    move-object/from16 v17, v7

    .line 14183
    .end local v2  # "installed":Z
    .end local v3  # "instantApp":Z
    .end local v14  # "fullApp":Z
    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v17  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :goto_351
    invoke-static/range {v15 .. v16}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 14184
    nop

    .line 14186
    const/4 v0, 0x1

    return v0

    .line 14150
    .end local v17  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v2  # "installed":Z
    .restart local v3  # "instantApp":Z
    .restart local v14  # "fullApp":Z
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :catchall_357
    move-exception v0

    move/from16 v19, v2

    goto :goto_35e

    .end local v2  # "installed":Z
    .end local v3  # "instantApp":Z
    .restart local v19  # "installed":Z
    .restart local v26  # "instantApp":Z
    :catchall_35b
    move-exception v0

    move/from16 v3, v26

    .end local v26  # "instantApp":Z
    .restart local v3  # "instantApp":Z
    :goto_35e
    :try_start_35e
    monitor-exit v1
    :try_end_35f
    .catchall {:try_start_35e .. :try_end_35f} :catchall_360

    .end local v15  # "callingId":J
    .end local v25  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    .end local p3  # "installFlags":I
    .end local p4  # "installReason":I
    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local p6  # "intentSender":Landroid/content/IntentSender;
    :try_start_35f
    throw v0
    :try_end_360
    .catchall {:try_start_35f .. :try_end_360} :catchall_391

    .restart local v15  # "callingId":J
    .restart local v25  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    .restart local p3  # "installFlags":I
    .restart local p4  # "installReason":I
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p6  # "intentSender":Landroid/content/IntentSender;
    :catchall_360
    move-exception v0

    goto :goto_35e

    .line 14073
    .end local v25  # "callingUid":I
    .local v3, "fullApp":Z
    .restart local v4  # "instantApp":Z
    .local v14, "callingUid":I
    :catchall_362
    move-exception v0

    move/from16 v25, v14

    move v14, v3

    move v3, v4

    move-object v5, v6

    .end local v4  # "instantApp":Z
    .local v3, "instantApp":Z
    .local v14, "fullApp":Z
    .restart local v25  # "callingUid":I
    goto :goto_379

    .end local v19  # "installed":Z
    .end local v25  # "callingUid":I
    .local v1, "installed":Z
    .local v3, "fullApp":Z
    .restart local v4  # "instantApp":Z
    .local v14, "callingUid":I
    :catchall_369
    move-exception v0

    move/from16 v19, v1

    move/from16 v25, v14

    move v14, v3

    move v3, v4

    move-object v5, v6

    .end local v1  # "installed":Z
    .end local v4  # "instantApp":Z
    .local v3, "instantApp":Z
    .local v14, "fullApp":Z
    .restart local v19  # "installed":Z
    .restart local v25  # "callingUid":I
    goto :goto_379

    .end local v6  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v19  # "installed":Z
    .end local v25  # "callingUid":I
    .restart local v1  # "installed":Z
    .local v3, "fullApp":Z
    .restart local v4  # "instantApp":Z
    .local v5, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v14, "callingUid":I
    :catchall_372
    move-exception v0

    move/from16 v19, v1

    move/from16 v25, v14

    move v14, v3

    move v3, v4

    .end local v1  # "installed":Z
    .end local v4  # "instantApp":Z
    .local v3, "instantApp":Z
    .local v14, "fullApp":Z
    .restart local v19  # "installed":Z
    .restart local v25  # "callingUid":I
    :goto_379
    :try_start_379
    monitor-exit v2
    :try_end_37a
    .catchall {:try_start_379 .. :try_end_37a} :catchall_37b

    .end local v15  # "callingId":J
    .end local v25  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    .end local p3  # "installFlags":I
    .end local p4  # "installReason":I
    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local p6  # "intentSender":Landroid/content/IntentSender;
    :try_start_37a
    throw v0
    :try_end_37b
    .catchall {:try_start_37a .. :try_end_37b} :catchall_391

    .restart local v15  # "callingId":J
    .restart local v25  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    .restart local p3  # "installFlags":I
    .restart local p4  # "installReason":I
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p6  # "intentSender":Landroid/content/IntentSender;
    :catchall_37b
    move-exception v0

    goto :goto_379

    .line 14050
    .end local v5  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v19  # "installed":Z
    .end local v25  # "callingUid":I
    .restart local v1  # "installed":Z
    .local v3, "fullApp":Z
    .restart local v4  # "instantApp":Z
    .local v14, "callingUid":I
    :catchall_37d
    move-exception v0

    move/from16 v19, v1

    move/from16 v25, v14

    move v14, v3

    move v3, v4

    .end local v1  # "installed":Z
    .end local v4  # "instantApp":Z
    .local v3, "instantApp":Z
    .local v14, "fullApp":Z
    .restart local v19  # "installed":Z
    .restart local v25  # "callingUid":I
    :goto_384
    :try_start_384
    monitor-exit v6
    :try_end_385
    .catchall {:try_start_384 .. :try_end_385} :catchall_386

    .end local v3  # "instantApp":Z
    .end local v14  # "fullApp":Z
    .end local v15  # "callingId":J
    .end local v19  # "installed":Z
    .end local v25  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    .end local p3  # "installFlags":I
    .end local p4  # "installReason":I
    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local p6  # "intentSender":Landroid/content/IntentSender;
    :try_start_385
    throw v0

    .restart local v3  # "instantApp":Z
    .restart local v14  # "fullApp":Z
    .restart local v15  # "callingId":J
    .restart local v19  # "installed":Z
    .restart local v25  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    .restart local p3  # "installFlags":I
    .restart local p4  # "installReason":I
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p6  # "intentSender":Landroid/content/IntentSender;
    :catchall_386
    move-exception v0

    goto :goto_384

    .line 14051
    .end local v19  # "installed":Z
    .end local v25  # "callingUid":I
    .restart local v1  # "installed":Z
    .local v3, "fullApp":Z
    .restart local v4  # "instantApp":Z
    .local v14, "callingUid":I
    :catchall_388
    move-exception v0

    move/from16 v19, v1

    move/from16 v25, v14

    move v14, v3

    move v3, v4

    .end local v1  # "installed":Z
    .end local v4  # "instantApp":Z
    .local v3, "instantApp":Z
    .local v14, "fullApp":Z
    .restart local v19  # "installed":Z
    .restart local v25  # "callingUid":I
    :goto_38f
    monitor-exit v2
    :try_end_390
    .catchall {:try_start_385 .. :try_end_390} :catchall_393

    .end local v15  # "callingId":J
    .end local v25  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    .end local p3  # "installFlags":I
    .end local p4  # "installReason":I
    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local p6  # "intentSender":Landroid/content/IntentSender;
    :try_start_390
    throw v0
    :try_end_391
    .catchall {:try_start_390 .. :try_end_391} :catchall_391

    .line 14183
    .end local v3  # "instantApp":Z
    .end local v14  # "fullApp":Z
    .end local v19  # "installed":Z
    .restart local v15  # "callingId":J
    .restart local v25  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    .restart local p3  # "installFlags":I
    .restart local p4  # "installReason":I
    .restart local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local p6  # "intentSender":Landroid/content/IntentSender;
    :catchall_391
    move-exception v0

    goto :goto_398

    .line 14051
    .restart local v3  # "instantApp":Z
    .restart local v14  # "fullApp":Z
    .restart local v19  # "installed":Z
    :catchall_393
    move-exception v0

    goto :goto_38f

    .line 14183
    .end local v3  # "instantApp":Z
    .end local v19  # "installed":Z
    .end local v25  # "callingUid":I
    .local v14, "callingUid":I
    :catchall_395
    move-exception v0

    move/from16 v25, v14

    .end local v14  # "callingUid":I
    .end local p5  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v7  # "whiteListedPermissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v25  # "callingUid":I
    :goto_398
    invoke-static/range {v15 .. v16}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0
.end method

.method installStage(Lcom/android/server/pm/PackageManagerService$ActiveInstallSession;)V
    .registers 8
    .param p1, "activeInstallSession"  # Lcom/android/server/pm/PackageManagerService$ActiveInstallSession;

    .line 13669
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTANT:Z

    if-eqz v0, :cond_28

    .line 13670
    invoke-virtual {p1}, Lcom/android/server/pm/PackageManagerService$ActiveInstallSession;->getSessionParams()Landroid/content/pm/PackageInstaller$SessionParams;

    move-result-object v0

    iget v0, v0, Landroid/content/pm/PackageInstaller$SessionParams;->installFlags:I

    and-int/lit16 v0, v0, 0x800

    if-eqz v0, :cond_28

    .line 13672
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Ephemeral install of "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Lcom/android/server/pm/PackageManagerService$ActiveInstallSession;->getPackageName()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 13676
    :cond_28
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredInstallerPackage:Ljava/lang/String;

    if-eqz v0, :cond_3f

    .line 13677
    invoke-static {}, Landroid/scene/SceneClient;->getInstance()Landroid/scene/SceneClient;

    move-result-object v0

    new-instance v1, Landroid/scene/Scene;

    const v2, 0x100000f

    const/4 v3, 0x0

    const/4 v4, 0x1

    const-string v5, "AppInstall"

    invoke-direct {v1, v2, v5, v3, v4}, Landroid/scene/Scene;-><init>(ILjava/lang/String;Ljava/lang/String;I)V

    invoke-virtual {v0, v1}, Landroid/scene/SceneClient;->notifyScene(Landroid/scene/Scene;)V

    .line 13681
    :cond_3f
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/4 v1, 0x5

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 13682
    .local v0, "msg":Landroid/os/Message;
    new-instance v1, Lcom/android/server/pm/PackageManagerService$InstallParams;

    invoke-direct {v1, p0, p1}, Lcom/android/server/pm/PackageManagerService$InstallParams;-><init>(Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/PackageManagerService$ActiveInstallSession;)V

    .line 13683
    .local v1, "params":Lcom/android/server/pm/PackageManagerService$InstallParams;
    const-string/jumbo v2, "installStage"

    invoke-virtual {v1, v2}, Lcom/android/server/pm/PackageManagerService$InstallParams;->setTraceMethod(Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$HandlerParams;

    move-result-object v3

    invoke-static {v1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-virtual {v3, v4}, Lcom/android/server/pm/PackageManagerService$HandlerParams;->setTraceCookie(I)Lcom/android/server/pm/PackageManagerService$HandlerParams;

    .line 13684
    iput-object v1, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 13686
    iget-object v3, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 13687
    invoke-static {v3}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v3

    .line 13686
    const-wide/32 v4, 0x40000

    invoke-static {v4, v5, v2, v3}, Landroid/os/Trace;->asyncTraceBegin(JLjava/lang/String;I)V

    .line 13688
    iget-object v2, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 13689
    invoke-static {v2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v2

    .line 13688
    const-string/jumbo v3, "queueInstall"

    invoke-static {v4, v5, v3, v2}, Landroid/os/Trace;->asyncTraceBegin(JLjava/lang/String;I)V

    .line 13691
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v2, v0}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 13692
    return-void
.end method

.method installStage(Ljava/util/List;)V
    .registers 8
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Lcom/android/server/pm/PackageManagerService$ActiveInstallSession;",
            ">;)V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/android/server/pm/PackageManagerException;
        }
    .end annotation

    .line 13696
    .local p1, "children":Ljava/util/List;, "Ljava/util/List<Lcom/android/server/pm/PackageManagerService$ActiveInstallSession;>;"
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/4 v1, 0x5

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 13697
    .local v0, "msg":Landroid/os/Message;
    new-instance v1, Lcom/android/server/pm/PackageManagerService$MultiPackageInstallParams;

    sget-object v2, Landroid/os/UserHandle;->ALL:Landroid/os/UserHandle;

    invoke-direct {v1, p0, v2, p1}, Lcom/android/server/pm/PackageManagerService$MultiPackageInstallParams;-><init>(Lcom/android/server/pm/PackageManagerService;Landroid/os/UserHandle;Ljava/util/List;)V

    .line 13699
    .local v1, "params":Lcom/android/server/pm/PackageManagerService$MultiPackageInstallParams;
    const-string/jumbo v2, "installStageMultiPackage"

    invoke-virtual {v1, v2}, Lcom/android/server/pm/PackageManagerService$MultiPackageInstallParams;->setTraceMethod(Ljava/lang/String;)Lcom/android/server/pm/PackageManagerService$HandlerParams;

    move-result-object v3

    .line 13700
    invoke-static {v1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-virtual {v3, v4}, Lcom/android/server/pm/PackageManagerService$HandlerParams;->setTraceCookie(I)Lcom/android/server/pm/PackageManagerService$HandlerParams;

    .line 13701
    iput-object v1, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 13703
    iget-object v3, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 13704
    invoke-static {v3}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v3

    .line 13703
    const-wide/32 v4, 0x40000

    invoke-static {v4, v5, v2, v3}, Landroid/os/Trace;->asyncTraceBegin(JLjava/lang/String;I)V

    .line 13705
    iget-object v2, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 13706
    invoke-static {v2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v2

    .line 13705
    const-string/jumbo v3, "queueInstall"

    invoke-static {v4, v5, v3, v2}, Landroid/os/Trace;->asyncTraceBegin(JLjava/lang/String;I)V

    .line 13707
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v2, v0}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 13708
    return-void
.end method

.method isCallerVerifier(I)Z
    .registers 5
    .param p1, "callingUid"  # I

    .line 19319
    invoke-static {p1}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v0

    .line 19320
    .local v0, "callingUserId":I
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mRequiredVerifierPackage:Ljava/lang/String;

    const/4 v2, 0x0

    if-eqz v1, :cond_11

    .line 19321
    invoke-virtual {p0, v1, v2, v0}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v1

    if-ne p1, v1, :cond_11

    const/4 v2, 0x1

    goto :goto_12

    :cond_11
    nop

    .line 19320
    :goto_12
    return v2
.end method

.method public isDeviceUpgrading()Z
    .registers 3

    .line 3902
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mIsUpgrade:Z

    const/4 v1, 0x0

    if-nez v0, :cond_e

    const-string/jumbo v0, "persist.pm.mock-upgrade"

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->getBoolean(Ljava/lang/String;Z)Z

    move-result v0

    if-eqz v0, :cond_f

    :cond_e
    const/4 v1, 0x1

    :cond_f
    return v1
.end method

.method public isFirstBoot()Z
    .registers 2

    .line 3889
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mFirstBoot:Z

    return v0
.end method

.method public isForceFullForUid(I)Z
    .registers 5
    .param p1, "uid"  # I

    .line 26939
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.FORCE_STOP_PACKAGES"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 26941
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26942
    :try_start_b
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v2

    invoke-virtual {v1, v2}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v1

    .line 26943
    .local v1, "obj":Ljava/lang/Object;
    instance-of v2, v1, Lcom/android/server/pm/PackageSetting;

    if-eqz v2, :cond_22

    .line 26944
    move-object v2, v1

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    invoke-virtual {v2}, Lcom/android/server/pm/PackageSetting;->isForceFull()Z

    move-result v2

    monitor-exit v0

    return v2

    .line 26946
    .end local v1  # "obj":Ljava/lang/Object;
    :cond_22
    monitor-exit v0

    .line 26947
    const/4 v0, 0x1

    return v0

    .line 26946
    :catchall_25
    move-exception v1

    monitor-exit v0
    :try_end_27
    .catchall {:try_start_b .. :try_end_27} :catchall_25

    throw v1
.end method

.method isHistoricalPackageUsageAvailable()Z
    .registers 2

    .line 26228
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageUsage:Lcom/android/server/pm/PackageUsage;

    invoke-virtual {v0}, Lcom/android/server/pm/PackageUsage;->isHistoricalPackageUsageAvailable()Z

    move-result v0

    return v0
.end method

.method public isInstantApp(Ljava/lang/String;I)Z
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 9184
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    const/4 v3, 0x1

    const/4 v4, 0x0

    const-string/jumbo v5, "isInstantApp"

    move v2, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 9191
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 9192
    :try_start_12
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    .line 9193
    .local v1, "callingUid":I
    invoke-static {v1}, Landroid/os/Process;->isIsolated(I)Z

    move-result v2

    if-eqz v2, :cond_23

    .line 9194
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mIsolatedOwners:Landroid/util/SparseIntArray;

    invoke-virtual {v2, v1}, Landroid/util/SparseIntArray;->get(I)I

    move-result v2

    move v1, v2

    .line 9196
    :cond_23
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 9197
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 9198
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    const/4 v4, 0x0

    if-eqz v2, :cond_54

    .line 9200
    invoke-direct {p0, p1, v1}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v5

    if-nez v5, :cond_52

    .line 9201
    invoke-direct {p0, v1, p2}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v5

    if-nez v5, :cond_52

    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    .line 9203
    invoke-static {v1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v6

    iget v7, v2, Lcom/android/server/pm/PackageSetting;->appId:I

    .line 9202
    invoke-virtual {v5, p2, v6, v7}, Lcom/android/server/pm/InstantAppRegistry;->isInstantAccessGranted(III)Z

    move-result v5

    if-eqz v5, :cond_54

    :cond_52
    const/4 v5, 0x1

    goto :goto_55

    :cond_54
    move v5, v4

    .line 9204
    .local v5, "returnAllowed":Z
    :goto_55
    if-eqz v5, :cond_5d

    .line 9205
    invoke-virtual {v2, p2}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v4

    monitor-exit v0

    return v4

    .line 9207
    .end local v1  # "callingUid":I
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v5  # "returnAllowed":Z
    :cond_5d
    monitor-exit v0

    .line 9208
    return v4

    .line 9207
    :catchall_5f
    move-exception v1

    monitor-exit v0
    :try_end_61
    .catchall {:try_start_12 .. :try_end_61} :catchall_5f

    throw v1
.end method

.method public isOnlyCoreApps()Z
    .registers 2

    .line 3895
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mOnlyCore:Z

    return v0
.end method

.method public isOrphaned(Ljava/lang/String;)Z
    .registers 4
    .param p1, "packageName"  # Ljava/lang/String;

    .line 22510
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 22511
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->containsKey(Ljava/lang/Object;)Z

    move-result v1

    if-nez v1, :cond_e

    .line 22512
    const/4 v1, 0x0

    monitor-exit v0

    return v1

    .line 22514
    :cond_e
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1}, Lcom/android/server/pm/Settings;->isOrphaned(Ljava/lang/String;)Z

    move-result v1

    monitor-exit v0

    return v1

    .line 22515
    :catchall_16
    move-exception v1

    monitor-exit v0
    :try_end_18
    .catchall {:try_start_3 .. :try_end_18} :catchall_16

    throw v1
.end method

.method public isPackageAvailable(Ljava/lang/String;I)Z
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 4403
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p2}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_a

    return v1

    .line 4404
    :cond_a
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 4405
    .local v0, "callingUid":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string/jumbo v7, "is package available"

    move v3, v0

    move v4, p2

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 4407
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 4408
    :try_start_1d
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 4409
    .local v3, "p":Landroid/content/pm/PackageParser$Package;
    if-eqz v3, :cond_41

    .line 4410
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 4411
    .local v4, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v4, v0, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v5

    if-eqz v5, :cond_33

    .line 4412
    monitor-exit v2

    return v1

    .line 4414
    :cond_33
    if-eqz v4, :cond_41

    .line 4415
    invoke-virtual {v4, p2}, Lcom/android/server/pm/PackageSetting;->readUserState(I)Landroid/content/pm/PackageUserState;

    move-result-object v5

    .line 4416
    .local v5, "state":Landroid/content/pm/PackageUserState;
    if-eqz v5, :cond_41

    .line 4417
    invoke-static {v5}, Landroid/content/pm/PackageParser;->isAvailable(Landroid/content/pm/PackageUserState;)Z

    move-result v1

    monitor-exit v2

    return v1

    .line 4421
    .end local v3  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "state":Landroid/content/pm/PackageUserState;
    :cond_41
    monitor-exit v2

    .line 4422
    return v1

    .line 4421
    :catchall_43
    move-exception v1

    monitor-exit v2
    :try_end_45
    .catchall {:try_start_1d .. :try_end_45} :catchall_43

    throw v1
.end method

.method public isPackageDeviceAdminOnAnyUser(Ljava/lang/String;)Z
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;

    .line 19387
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 19388
    .local v0, "callingUid":I
    const-string v1, "android.permission.MANAGE_USERS"

    invoke-virtual {p0, v1, v0}, Lcom/android/server/pm/PackageManagerService;->checkUidPermission(Ljava/lang/String;I)I

    move-result v1

    const/4 v2, -0x1

    const/4 v3, 0x0

    if-nez v1, :cond_20

    .line 19394
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    if-eqz v1, :cond_1b

    .line 19395
    invoke-direct {p0, p1, v0}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v1

    if-nez v1, :cond_1b

    .line 19396
    return v3

    .line 19398
    :cond_1b
    invoke-direct {p0, p1, v2}, Lcom/android/server/pm/PackageManagerService;->isPackageDeviceAdmin(Ljava/lang/String;I)Z

    move-result v1

    return v1

    .line 19390
    :cond_20
    const v1, 0x534e4554

    const/4 v4, 0x3

    new-array v4, v4, [Ljava/lang/Object;

    const-string v5, "128599183"

    aput-object v5, v4, v3

    const/4 v3, 0x1

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v4, v3

    const/4 v2, 0x2

    const-string v3, ""

    aput-object v3, v4, v2

    invoke-static {v1, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 19391
    new-instance v1, Ljava/lang/SecurityException;

    const-string v2, "android.permission.MANAGE_USERS permission is required to call this API"

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method public isPackageSignedByKeySet(Ljava/lang/String;Landroid/content/pm/KeySet;)Z
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "ks"  # Landroid/content/pm/KeySet;

    .line 24868
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 24869
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    const/4 v2, 0x0

    if-eqz v1, :cond_c

    .line 24870
    return v2

    .line 24872
    :cond_c
    if-eqz p1, :cond_73

    if-nez p2, :cond_11

    goto :goto_73

    .line 24875
    :cond_11
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 24876
    :try_start_14
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 24877
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v3, :cond_43

    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 24879
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v5

    .line 24878
    invoke-direct {p0, v4, v0, v5}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v4

    if-nez v4, :cond_43

    .line 24883
    invoke-virtual {p2}, Landroid/content/pm/KeySet;->getToken()Landroid/os/IBinder;

    move-result-object v4

    .line 24884
    .local v4, "ksh":Landroid/os/IBinder;
    instance-of v5, v4, Lcom/android/server/pm/KeySetHandle;

    if-eqz v5, :cond_41

    .line 24885
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 24886
    .local v2, "ksms":Lcom/android/server/pm/KeySetManagerService;
    move-object v5, v4

    check-cast v5, Lcom/android/server/pm/KeySetHandle;

    invoke-virtual {v2, p1, v5}, Lcom/android/server/pm/KeySetManagerService;->packageIsSignedByLPr(Ljava/lang/String;Lcom/android/server/pm/KeySetHandle;)Z

    move-result v5

    monitor-exit v1

    return v5

    .line 24888
    .end local v2  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_41
    monitor-exit v1

    return v2

    .line 24880
    .end local v4  # "ksh":Landroid/os/IBinder;
    :cond_43
    const-string v2, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "KeySet requested for unknown package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v2, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 24881
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unknown package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v2, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "ks":Landroid/content/pm/KeySet;
    throw v2

    .line 24889
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "ks":Landroid/content/pm/KeySet;
    :catchall_70
    move-exception v2

    monitor-exit v1
    :try_end_72
    .catchall {:try_start_14 .. :try_end_72} :catchall_70

    throw v2

    .line 24873
    :cond_73
    :goto_73
    return v2
.end method

.method public isPackageSignedByKeySetExactly(Ljava/lang/String;Landroid/content/pm/KeySet;)Z
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "ks"  # Landroid/content/pm/KeySet;

    .line 24894
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 24895
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    const/4 v2, 0x0

    if-eqz v1, :cond_c

    .line 24896
    return v2

    .line 24898
    :cond_c
    if-eqz p1, :cond_73

    if-nez p2, :cond_11

    goto :goto_73

    .line 24901
    :cond_11
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 24902
    :try_start_14
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 24903
    .local v3, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v3, :cond_43

    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 24905
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v5

    .line 24904
    invoke-direct {p0, v4, v0, v5}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v4

    if-nez v4, :cond_43

    .line 24909
    invoke-virtual {p2}, Landroid/content/pm/KeySet;->getToken()Landroid/os/IBinder;

    move-result-object v4

    .line 24910
    .local v4, "ksh":Landroid/os/IBinder;
    instance-of v5, v4, Lcom/android/server/pm/KeySetHandle;

    if-eqz v5, :cond_41

    .line 24911
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mKeySetManagerService:Lcom/android/server/pm/KeySetManagerService;

    .line 24912
    .local v2, "ksms":Lcom/android/server/pm/KeySetManagerService;
    move-object v5, v4

    check-cast v5, Lcom/android/server/pm/KeySetHandle;

    invoke-virtual {v2, p1, v5}, Lcom/android/server/pm/KeySetManagerService;->packageIsSignedByExactlyLPr(Ljava/lang/String;Lcom/android/server/pm/KeySetHandle;)Z

    move-result v5

    monitor-exit v1

    return v5

    .line 24914
    .end local v2  # "ksms":Lcom/android/server/pm/KeySetManagerService;
    :cond_41
    monitor-exit v1

    return v2

    .line 24906
    .end local v4  # "ksh":Landroid/os/IBinder;
    :cond_43
    const-string v2, "PackageManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "KeySet requested for unknown package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v2, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 24907
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unknown package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v2, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "ks":Landroid/content/pm/KeySet;
    throw v2

    .line 24915
    .end local v3  # "pkg":Landroid/content/pm/PackageParser$Package;
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "ks":Landroid/content/pm/KeySet;
    :catchall_70
    move-exception v2

    monitor-exit v1
    :try_end_72
    .catchall {:try_start_14 .. :try_end_72} :catchall_70

    throw v2

    .line 24899
    :cond_73
    :goto_73
    return v2
.end method

.method public isPackageStateProtected(Ljava/lang/String;I)Z
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26516
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 26517
    .local v6, "callingUid":I
    invoke-static {v6}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v7

    .line 26519
    .local v7, "callingAppId":I
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v3, 0x0

    const/4 v4, 0x1

    const-string/jumbo v5, "isPackageStateProtected"

    move v1, v6

    move v2, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 26522
    const/16 v0, 0x3e8

    if-eq v7, v0, :cond_2b

    if-eqz v7, :cond_2b

    .line 26523
    const-string v0, "android.permission.MANAGE_DEVICE_ADMINS"

    invoke-virtual {p0, v0, v6}, Lcom/android/server/pm/PackageManagerService;->checkUidPermission(Ljava/lang/String;I)I

    move-result v0

    if-nez v0, :cond_23

    goto :goto_2b

    .line 26524
    :cond_23
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Caller must have the android.permission.MANAGE_DEVICE_ADMINS permission."

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 26528
    :cond_2b
    :goto_2b
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mProtectedPackages:Lcom/android/server/pm/ProtectedPackages;

    invoke-virtual {v0, p2, p1}, Lcom/android/server/pm/ProtectedPackages;->isPackageStateProtected(ILjava/lang/String;)Z

    move-result v0

    return v0
.end method

.method public isPackageSuspendedForUser(Ljava/lang/String;I)Z
    .registers 10
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 14439
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 14440
    .local v6, "callingUid":I
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v2, "isPackageSuspendedForUser for user "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const/4 v3, 0x1

    const/4 v4, 0x0

    move v1, v6

    move v2, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 14443
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 14444
    :try_start_22
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 14445
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_3a

    invoke-direct {p0, v1, v6, p2}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v2

    if-nez v2, :cond_3a

    .line 14448
    invoke-virtual {v1, p2}, Lcom/android/server/pm/PackageSetting;->getSuspended(I)Z

    move-result v2

    monitor-exit v0

    return v2

    .line 14446
    :cond_3a
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unknown target package: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v6  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "userId":I
    throw v2

    .line 14449
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local v6  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "userId":I
    :catchall_51
    move-exception v1

    monitor-exit v0
    :try_end_53
    .catchall {:try_start_22 .. :try_end_53} :catchall_51

    throw v1
.end method

.method public isPermissionEnforced(Ljava/lang/String;)Z
    .registers 3
    .param p1, "permission"  # Ljava/lang/String;
    .annotation runtime Ljava/lang/Deprecated;
    .end annotation

    .line 24761
    const/4 v0, 0x1

    return v0
.end method

.method public isPermissionRevokedByPolicy(Ljava/lang/String;Ljava/lang/String;I)Z
    .registers 10
    .param p1, "permission"  # Ljava/lang/String;
    .param p2, "packageName"  # Ljava/lang/String;
    .param p3, "userId"  # I

    .line 5908
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    if-eq v0, p3, :cond_1f

    .line 5909
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v2, "isPermissionRevokedByPolicy for user "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "android.permission.INTERACT_ACROSS_USERS_FULL"

    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 5914
    :cond_1f
    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->checkPermission(Ljava/lang/String;Ljava/lang/String;I)I

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_27

    .line 5916
    return v1

    .line 5919
    :cond_27
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 5920
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v2

    if-eqz v2, :cond_38

    .line 5921
    invoke-direct {p0, p2, v0}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v2

    if-nez v2, :cond_3f

    .line 5922
    return v1

    .line 5925
    :cond_38
    invoke-virtual {p0, p2, p3}, Lcom/android/server/pm/PackageManagerService;->isInstantApp(Ljava/lang/String;I)Z

    move-result v2

    if-eqz v2, :cond_3f

    .line 5926
    return v1

    .line 5930
    :cond_3f
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 5932
    .local v2, "identity":J
    :try_start_43
    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->getPermissionFlags(Ljava/lang/String;Ljava/lang/String;I)I

    move-result v4
    :try_end_47
    .catchall {:try_start_43 .. :try_end_47} :catchall_50

    .line 5933
    .local v4, "flags":I
    and-int/lit8 v5, v4, 0x4

    if-eqz v5, :cond_4c

    const/4 v1, 0x1

    .line 5935
    :cond_4c
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5933
    return v1

    .line 5935
    .end local v4  # "flags":I
    :catchall_50
    move-exception v1

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v1
.end method

.method public isProtectedBroadcast(Ljava/lang/String;)Z
    .registers 5
    .param p1, "actionName"  # Ljava/lang/String;

    .line 6379
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mProtectedBroadcasts:Landroid/util/ArraySet;

    monitor-enter v0

    .line 6380
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mProtectedBroadcasts:Landroid/util/ArraySet;

    invoke-virtual {v1, p1}, Landroid/util/ArraySet;->contains(Ljava/lang/Object;)Z

    move-result v1

    const/4 v2, 0x1

    if-eqz v1, :cond_e

    .line 6381
    monitor-exit v0

    return v2

    .line 6382
    :cond_e
    if-eqz p1, :cond_32

    .line 6384
    const-string v1, "android.net.netmon.lingerExpired"

    invoke-virtual {p1, v1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-nez v1, :cond_30

    const-string v1, "com.android.server.sip.SipWakeupTimer"

    .line 6385
    invoke-virtual {p1, v1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-nez v1, :cond_30

    const-string v1, "com.android.internal.telephony.data-reconnect"

    .line 6386
    invoke-virtual {p1, v1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-nez v1, :cond_30

    const-string v1, "android.net.netmon.launchCaptivePortalApp"

    .line 6387
    invoke-virtual {p1, v1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_32

    .line 6388
    :cond_30
    monitor-exit v0

    return v2

    .line 6391
    :cond_32
    monitor-exit v0

    .line 6392
    const/4 v0, 0x0

    return v0

    .line 6391
    :catchall_35
    move-exception v1

    monitor-exit v0
    :try_end_37
    .catchall {:try_start_3 .. :try_end_37} :catchall_35

    throw v1
.end method

.method public isSafeMode()Z
    .registers 2

    .line 22744
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mSafeMode:Z

    return v0
.end method

.method public isStorageLow()Z
    .registers 5

    .line 24767
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 24770
    .local v0, "token":J
    :try_start_4
    const-class v2, Lcom/android/server/storage/DeviceStorageMonitorInternal;

    invoke-static {v2}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/storage/DeviceStorageMonitorInternal;

    .line 24771
    .local v2, "dsm":Lcom/android/server/storage/DeviceStorageMonitorInternal;
    if-eqz v2, :cond_16

    .line 24772
    invoke-interface {v2}, Lcom/android/server/storage/DeviceStorageMonitorInternal;->isMemoryLow()Z

    move-result v3
    :try_end_12
    .catchall {:try_start_4 .. :try_end_12} :catchall_1b

    .line 24777
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 24772
    return v3

    .line 24774
    :cond_16
    const/4 v3, 0x0

    .line 24777
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 24774
    return v3

    .line 24777
    .end local v2  # "dsm":Lcom/android/server/storage/DeviceStorageMonitorInternal;
    :catchall_1b
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v2
.end method

.method public isUidPrivileged(I)Z
    .registers 9
    .param p1, "uid"  # I

    .line 6790
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    const/4 v1, 0x0

    if-eqz v0, :cond_c

    .line 6791
    return v1

    .line 6793
    :cond_c
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v0

    .line 6795
    .local v0, "appId":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 6796
    :try_start_13
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, v0}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v3

    .line 6797
    .local v3, "obj":Ljava/lang/Object;
    instance-of v4, v3, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v4, :cond_3c

    .line 6798
    move-object v4, v3

    check-cast v4, Lcom/android/server/pm/SharedUserSetting;

    .line 6799
    .local v4, "sus":Lcom/android/server/pm/SharedUserSetting;
    iget-object v5, v4, Lcom/android/server/pm/SharedUserSetting;->packages:Landroid/util/ArraySet;

    invoke-virtual {v5}, Landroid/util/ArraySet;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .line 6800
    .local v5, "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    :cond_26
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v6

    if-eqz v6, :cond_3b

    .line 6801
    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/pm/PackageSetting;

    invoke-virtual {v6}, Lcom/android/server/pm/PackageSetting;->isPrivileged()Z

    move-result v6

    if-eqz v6, :cond_26

    .line 6802
    const/4 v1, 0x1

    monitor-exit v2

    return v1

    .line 6800
    .end local v4  # "sus":Lcom/android/server/pm/SharedUserSetting;
    .end local v5  # "it":Ljava/util/Iterator;, "Ljava/util/Iterator<Lcom/android/server/pm/PackageSetting;>;"
    :cond_3b
    goto :goto_49

    .line 6805
    :cond_3c
    instance-of v4, v3, Lcom/android/server/pm/PackageSetting;

    if-eqz v4, :cond_49

    .line 6806
    move-object v1, v3

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 6807
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-virtual {v1}, Lcom/android/server/pm/PackageSetting;->isPrivileged()Z

    move-result v4

    monitor-exit v2

    return v4

    .line 6805
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_49
    :goto_49
    nop

    .line 6809
    .end local v3  # "obj":Ljava/lang/Object;
    monitor-exit v2

    .line 6810
    return v1

    .line 6809
    :catchall_4c
    move-exception v1

    monitor-exit v2
    :try_end_4e
    .catchall {:try_start_13 .. :try_end_4e} :catchall_4c

    throw v1
.end method

.method isUserRestricted(ILjava/lang/String;)Z
    .registers 6
    .param p1, "userId"  # I
    .param p2, "restrictionKey"  # Ljava/lang/String;

    .line 14223
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/UserManagerService;->getUserRestrictions(I)Landroid/os/Bundle;

    move-result-object v0

    .line 14224
    .local v0, "restrictions":Landroid/os/Bundle;
    const/4 v1, 0x0

    invoke-virtual {v0, p2, v1}, Landroid/os/Bundle;->getBoolean(Ljava/lang/String;Z)Z

    move-result v2

    if-eqz v2, :cond_25

    .line 14225
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "User is restricted: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14226
    const/4 v1, 0x1

    return v1

    .line 14228
    :cond_25
    return v1
.end method

.method public synthetic lambda$commitPackageSettings$6$PackageManagerService(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/ArrayList;)V
    .registers 6
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "oldPkg"  # Landroid/content/pm/PackageParser$Package;
    .param p3, "allPackageNames"  # Ljava/util/ArrayList;

    .line 12824
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    invoke-virtual {v0, p1, p2, p3, v1}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->revokeRuntimePermissionsIfGroupChanged(Landroid/content/pm/PackageParser$Package;Landroid/content/pm/PackageParser$Package;Ljava/util/ArrayList;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    return-void
.end method

.method public synthetic lambda$deleteApplicationCacheFilesAsUser$23$PackageManagerService(Landroid/content/pm/PackageParser$Package;IIILandroid/content/pm/IPackageDataObserver;Ljava/lang/String;)V
    .registers 13
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "callingUid"  # I
    .param p3, "hasAccessInstantApps"  # I
    .param p4, "userId"  # I
    .param p5, "observer"  # Landroid/content/pm/IPackageDataObserver;
    .param p6, "packageName"  # Ljava/lang/String;

    .line 21007
    if-nez p1, :cond_4

    const/4 v0, 0x0

    goto :goto_8

    :cond_4
    iget-object v0, p1, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 21008
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    :goto_8
    const/4 v1, 0x1

    .line 21009
    .local v1, "doClearData":Z
    const/4 v2, 0x1

    if-eqz v0, :cond_1e

    .line 21010
    nop

    .line 21011
    invoke-static {p2}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v3

    invoke-virtual {v0, v3}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v3

    .line 21012
    .local v3, "targetIsInstantApp":Z
    if-eqz v3, :cond_1c

    if-nez p3, :cond_1a

    goto :goto_1c

    :cond_1a
    const/4 v4, 0x0

    goto :goto_1d

    :cond_1c
    :goto_1c
    move v4, v2

    :goto_1d
    move v1, v4

    .line 21015
    .end local v3  # "targetIsInstantApp":Z
    :cond_1e
    if-eqz v1, :cond_33

    .line 21016
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v3

    .line 21017
    const/4 v4, 0x7

    .line 21020
    .local v4, "flags":I
    const/16 v5, 0x17

    :try_start_26
    invoke-direct {p0, p1, p4, v5}, Lcom/android/server/pm/PackageManagerService;->clearAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 21021
    const/16 v5, 0x27

    invoke-direct {p0, p1, p4, v5}, Lcom/android/server/pm/PackageManagerService;->clearAppDataLIF(Landroid/content/pm/PackageParser$Package;II)V

    .line 21022
    .end local v4  # "flags":I
    monitor-exit v3

    goto :goto_33

    :catchall_30
    move-exception v2

    monitor-exit v3
    :try_end_32
    .catchall {:try_start_26 .. :try_end_32} :catchall_30

    throw v2

    .line 21024
    :cond_33
    :goto_33
    if-eqz p5, :cond_41

    .line 21026
    :try_start_35
    invoke-interface {p5, p6, v2}, Landroid/content/pm/IPackageDataObserver;->onRemoveCompleted(Ljava/lang/String;Z)V
    :try_end_38
    .catch Landroid/os/RemoteException; {:try_start_35 .. :try_end_38} :catch_39

    .line 21029
    goto :goto_41

    .line 21027
    :catch_39
    move-exception v2

    .line 21028
    .local v2, "e":Landroid/os/RemoteException;
    const-string v3, "PackageManager"

    const-string v4, "Observer no longer exists."

    invoke-static {v3, v4}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21031
    .end local v2  # "e":Landroid/os/RemoteException;
    :cond_41
    :goto_41
    return-void
.end method

.method public synthetic lambda$deletePackageIfUnusedLPr$35$PackageManagerService(Ljava/lang/String;)V
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;

    .line 24928
    const-wide/16 v2, -0x1

    const/4 v4, 0x0

    const/4 v5, 0x2

    move-object v0, p0

    move-object v1, p1

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/PackageManagerService;->deletePackageX(Ljava/lang/String;JII)I

    return-void
.end method

.method public synthetic lambda$deletePackageVersioned$20$PackageManagerService(Ljava/lang/String;IZZJII[ILandroid/content/pm/IPackageDeleteObserver2;Ljava/lang/String;)V
    .registers 30
    .param p1, "internalPackageName"  # Ljava/lang/String;
    .param p2, "callingUid"  # I
    .param p3, "canViewInstantApps"  # Z
    .param p4, "deleteAllUsers"  # Z
    .param p5, "versionCode"  # J
    .param p7, "userId"  # I
    .param p8, "deleteFlags"  # I
    .param p9, "users"  # [I
    .param p10, "observer"  # Landroid/content/pm/IPackageDeleteObserver2;
    .param p11, "packageName"  # Ljava/lang/String;

    .line 19196
    move-object/from16 v7, p0

    move-object/from16 v8, p1

    move-object/from16 v9, p9

    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v8}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    move-object v10, v0

    check-cast v10, Lcom/android/server/pm/PackageSetting;

    .line 19197
    .local v10, "ps":Lcom/android/server/pm/PackageSetting;
    const/4 v0, 0x1

    .line 19198
    .local v0, "doDeletePackage":Z
    const/4 v1, 0x0

    const/4 v11, 0x1

    if-eqz v10, :cond_2a

    .line 19199
    nop

    .line 19200
    invoke-static/range {p2 .. p2}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v2

    invoke-virtual {v10, v2}, Lcom/android/server/pm/PackageSetting;->getInstantApp(I)Z

    move-result v2

    .line 19201
    .local v2, "targetIsInstantApp":Z
    if-eqz v2, :cond_26

    if-eqz p3, :cond_24

    goto :goto_26

    :cond_24
    move v3, v1

    goto :goto_27

    :cond_26
    :goto_26
    move v3, v11

    :goto_27
    move v0, v3

    move v12, v0

    goto :goto_2b

    .line 19198
    .end local v2  # "targetIsInstantApp":Z
    :cond_2a
    move v12, v0

    .line 19204
    .end local v0  # "doDeletePackage":Z
    .local v12, "doDeletePackage":Z
    :goto_2b
    const-string v13, "PackageManager"

    if-eqz v12, :cond_a6

    .line 19205
    if-nez p4, :cond_42

    .line 19206
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move-wide/from16 v3, p5

    move/from16 v5, p7

    move/from16 v6, p8

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->deletePackageX(Ljava/lang/String;JII)I

    move-result v0

    move v1, v0

    .local v0, "returnCode":I
    goto/16 :goto_a8

    .line 19209
    .end local v0  # "returnCode":I
    :cond_42
    invoke-direct {v7, v8, v9}, Lcom/android/server/pm/PackageManagerService;->getBlockUninstallForUsers(Ljava/lang/String;[I)[I

    move-result-object v0

    .line 19212
    .local v0, "blockUninstallUserIds":[I
    invoke-static {v0}, Lcom/android/internal/util/ArrayUtils;->isEmpty([I)Z

    move-result v2

    if-eqz v2, :cond_5c

    .line 19213
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move-wide/from16 v3, p5

    move/from16 v5, p7

    move/from16 v6, p8

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->deletePackageX(Ljava/lang/String;JII)I

    move-result v1

    move v0, v1

    .local v1, "returnCode":I
    goto :goto_a4

    .line 19217
    .end local v1  # "returnCode":I
    :cond_5c
    and-int/lit8 v14, p8, -0x3

    .line 19218
    .local v14, "userFlags":I
    array-length v15, v9

    move v6, v1

    :goto_60
    if-ge v6, v15, :cond_a3

    aget v5, v9, v6

    .line 19219
    .local v5, "userId1":I
    invoke-static {v0, v5}, Lcom/android/internal/util/ArrayUtils;->contains([II)Z

    move-result v1

    if-nez v1, :cond_9d

    .line 19220
    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move-wide/from16 v3, p5

    move/from16 v16, v5

    .end local v5  # "userId1":I
    .local v16, "userId1":I
    move/from16 v17, v6

    move v6, v14

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->deletePackageX(Ljava/lang/String;JII)I

    move-result v1

    .line 19222
    .restart local v1  # "returnCode":I
    if-eq v1, v11, :cond_9a

    .line 19223
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Package delete failed for user "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move/from16 v3, v16

    .end local v16  # "userId1":I
    .local v3, "userId1":I
    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, ", returnCode "

    invoke-virtual {v2, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v13, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_a0

    .line 19222
    .end local v3  # "userId1":I
    .restart local v16  # "userId1":I
    :cond_9a
    move/from16 v3, v16

    .end local v16  # "userId1":I
    .restart local v3  # "userId1":I
    goto :goto_a0

    .line 19219
    .end local v1  # "returnCode":I
    .end local v3  # "userId1":I
    .restart local v5  # "userId1":I
    :cond_9d
    move v3, v5

    move/from16 v17, v6

    .line 19218
    .end local v5  # "userId1":I
    :goto_a0
    add-int/lit8 v6, v17, 0x1

    goto :goto_60

    .line 19230
    :cond_a3
    const/4 v0, -0x4

    .line 19232
    .end local v14  # "userFlags":I
    .local v0, "returnCode":I
    :goto_a4
    move v1, v0

    goto :goto_a8

    .line 19234
    .end local v0  # "returnCode":I
    :cond_a6
    const/4 v0, -0x1

    move v1, v0

    .line 19237
    .restart local v1  # "returnCode":I
    :goto_a8
    const/4 v0, 0x0

    move-object/from16 v2, p10

    move-object/from16 v3, p11

    :try_start_ad
    invoke-interface {v2, v3, v1, v0}, Landroid/content/pm/IPackageDeleteObserver2;->onPackageDeleted(Ljava/lang/String;ILjava/lang/String;)V
    :try_end_b0
    .catch Landroid/os/RemoteException; {:try_start_ad .. :try_end_b0} :catch_b1

    .line 19240
    goto :goto_b9

    .line 19238
    :catch_b1
    move-exception v0

    move-object v4, v0

    move-object v0, v4

    .line 19239
    .local v0, "e":Landroid/os/RemoteException;
    const-string v4, "Observer no longer exists."

    invoke-static {v13, v4}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 19241
    .end local v0  # "e":Landroid/os/RemoteException;
    :goto_b9
    return-void
.end method

.method public synthetic lambda$freeStorage$2$PackageManagerService(Ljava/lang/String;JILandroid/content/IntentSender;)V
    .registers 14
    .param p1, "volumeUuid"  # Ljava/lang/String;
    .param p2, "freeStorageSize"  # J
    .param p4, "storageFlags"  # I
    .param p5, "pi"  # Landroid/content/IntentSender;

    .line 5022
    const-string v0, "PackageManager"

    const/4 v1, 0x0

    .line 5024
    .local v1, "success":Z
    :try_start_3
    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->freeStorage(Ljava/lang/String;JI)V
    :try_end_6
    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_6} :catch_8

    .line 5025
    const/4 v1, 0x1

    .line 5028
    goto :goto_c

    .line 5026
    :catch_8
    move-exception v2

    .line 5027
    .local v2, "e":Ljava/io/IOException;
    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5029
    .end local v2  # "e":Ljava/io/IOException;
    :goto_c
    if-eqz p5, :cond_21

    .line 5031
    const/4 v3, 0x0

    if-eqz v1, :cond_13

    const/4 v2, 0x1

    goto :goto_14

    :cond_13
    const/4 v2, 0x0

    :goto_14
    move v4, v2

    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    move-object v2, p5

    :try_start_19
    invoke-virtual/range {v2 .. v7}, Landroid/content/IntentSender;->sendIntent(Landroid/content/Context;ILandroid/content/Intent;Landroid/content/IntentSender$OnFinished;Landroid/os/Handler;)V
    :try_end_1c
    .catch Landroid/content/IntentSender$SendIntentException; {:try_start_19 .. :try_end_1c} :catch_1d

    .line 5034
    goto :goto_21

    .line 5032
    :catch_1d
    move-exception v2

    .line 5033
    .local v2, "e":Landroid/content/IntentSender$SendIntentException;
    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5036
    .end local v2  # "e":Landroid/content/IntentSender$SendIntentException;
    :cond_21
    :goto_21
    return-void
.end method

.method public synthetic lambda$freeStorageAndNotify$1$PackageManagerService(Ljava/lang/String;JILandroid/content/pm/IPackageDataObserver;)V
    .registers 9
    .param p1, "volumeUuid"  # Ljava/lang/String;
    .param p2, "freeStorageSize"  # J
    .param p4, "storageFlags"  # I
    .param p5, "observer"  # Landroid/content/pm/IPackageDataObserver;

    .line 4999
    const-string v0, "PackageManager"

    const/4 v1, 0x0

    .line 5001
    .local v1, "success":Z
    :try_start_3
    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->freeStorage(Ljava/lang/String;JI)V
    :try_end_6
    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_6} :catch_8

    .line 5002
    const/4 v1, 0x1

    .line 5005
    goto :goto_c

    .line 5003
    :catch_8
    move-exception v2

    .line 5004
    .local v2, "e":Ljava/io/IOException;
    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5006
    .end local v2  # "e":Ljava/io/IOException;
    :goto_c
    if-eqz p5, :cond_17

    .line 5008
    const/4 v2, 0x0

    :try_start_f
    invoke-interface {p5, v2, v1}, Landroid/content/pm/IPackageDataObserver;->onRemoveCompleted(Ljava/lang/String;Z)V
    :try_end_12
    .catch Landroid/os/RemoteException; {:try_start_f .. :try_end_12} :catch_13

    .line 5011
    goto :goto_17

    .line 5009
    :catch_13
    move-exception v2

    .line 5010
    .local v2, "e":Landroid/os/RemoteException;
    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5013
    .end local v2  # "e":Landroid/os/RemoteException;
    :cond_17
    :goto_17
    return-void
.end method

.method public synthetic lambda$grantDefaultPermissionsToEnabledTelephonyDataServices$36$PackageManagerService([Ljava/lang/String;I)V
    .registers 4
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "userId"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .line 26151
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    .line 26152
    invoke-virtual {v0, p1, p2}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->grantDefaultPermissionsToEnabledTelephonyDataServices([Ljava/lang/String;I)V

    .line 26151
    return-void
.end method

.method public synthetic lambda$installExistingPackageAsUser$10$PackageManagerService(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/IntentSender;)V
    .registers 5
    .param p1, "res"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .param p2, "intentSender"  # Landroid/content/IntentSender;

    .line 14131
    iget v0, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-static {v0, v1, p2}, Lcom/android/server/pm/PackageManagerService;->onRestoreComplete(ILandroid/content/Context;Landroid/content/IntentSender;)V

    return-void
.end method

.method public synthetic lambda$installExistingPackageAsUser$11$PackageManagerService(Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Landroid/content/IntentSender;)V
    .registers 5
    .param p1, "res"  # Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;
    .param p2, "intentSender"  # Landroid/content/IntentSender;

    .line 14176
    iget v0, p1, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-static {v0, v1, p2}, Lcom/android/server/pm/PackageManagerService;->onRestoreComplete(ILandroid/content/Context;Landroid/content/IntentSender;)V

    return-void
.end method

.method public synthetic lambda$loadPrivatePackages$30$PackageManagerService(Landroid/os/storage/VolumeInfo;)V
    .registers 2
    .param p1, "vol"  # Landroid/os/storage/VolumeInfo;

    .line 23602
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->loadPrivatePackagesInner(Landroid/os/storage/VolumeInfo;)V

    return-void
.end method

.method public synthetic lambda$movePackage$32$PackageManagerService(Ljava/lang/String;Ljava/lang/String;IILandroid/os/UserHandle;)V
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "volumeUuid"  # Ljava/lang/String;
    .param p3, "moveId"  # I
    .param p4, "callingUid"  # I
    .param p5, "user"  # Landroid/os/UserHandle;

    .line 24293
    :try_start_0
    invoke-direct/range {p0 .. p5}, Lcom/android/server/pm/PackageManagerService;->movePackageInternal(Ljava/lang/String;Ljava/lang/String;IILandroid/os/UserHandle;)V
    :try_end_3
    .catch Lcom/android/server/pm/PackageManagerException; {:try_start_0 .. :try_end_3} :catch_4

    .line 24297
    goto :goto_22

    .line 24294
    :catch_4
    move-exception v0

    .line 24295
    .local v0, "e":Lcom/android/server/pm/PackageManagerException;
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Failed to move "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 24296
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    iget v2, v0, Lcom/android/server/pm/PackageManagerException;->error:I

    invoke-static {v1, p3, v2}, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;->access$5500(Lcom/android/server/pm/PackageManagerService$MoveCallbacks;II)V

    .line 24298
    .end local v0  # "e":Lcom/android/server/pm/PackageManagerException;
    :goto_22
    return-void
.end method

.method public synthetic lambda$movePackageInternal$33$PackageManagerService(Ljava/util/concurrent/CountDownLatch;JLjava/io/File;JI)V
    .registers 20
    .param p1, "installedLatch"  # Ljava/util/concurrent/CountDownLatch;
    .param p2, "startFreeBytes"  # J
    .param p4, "measurePath"  # Ljava/io/File;
    .param p5, "sizeBytes"  # J
    .param p7, "moveId"  # I

    .line 24488
    :goto_0
    const-wide/16 v0, 0x1

    :try_start_2
    sget-object v2, Ljava/util/concurrent/TimeUnit;->SECONDS:Ljava/util/concurrent/TimeUnit;
    :try_end_4
    .catch Ljava/lang/InterruptedException; {:try_start_2 .. :try_end_4} :catch_10

    move-object v3, p1

    :try_start_5
    invoke-virtual {p1, v0, v1, v2}, Ljava/util/concurrent/CountDownLatch;->await(JLjava/util/concurrent/TimeUnit;)Z

    move-result v0
    :try_end_9
    .catch Ljava/lang/InterruptedException; {:try_start_5 .. :try_end_9} :catch_e

    if-eqz v0, :cond_d

    .line 24489
    nop

    .line 24499
    return-void

    .line 24492
    :cond_d
    goto :goto_12

    .line 24491
    :catch_e
    move-exception v0

    goto :goto_12

    :catch_10
    move-exception v0

    move-object v3, p1

    .line 24494
    :goto_12
    invoke-virtual/range {p4 .. p4}, Ljava/io/File;->getUsableSpace()J

    move-result-wide v0

    sub-long v0, p2, v0

    .line 24495
    .local v0, "deltaFreeBytes":J
    const-wide/16 v4, 0x50

    mul-long/2addr v4, v0

    div-long v6, v4, p5

    const-wide/16 v8, 0x0

    const-wide/16 v10, 0x50

    invoke-static/range {v6 .. v11}, Landroid/util/MathUtils;->constrain(JJJ)J

    move-result-wide v4

    long-to-int v2, v4

    add-int/lit8 v2, v2, 0xa

    .line 24497
    .local v2, "progress":I
    move-object v4, p0

    iget-object v5, v4, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    move/from16 v6, p7

    invoke-static {v5, v6, v2}, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;->access$5500(Lcom/android/server/pm/PackageManagerService$MoveCallbacks;II)V

    .line 24498
    .end local v0  # "deltaFreeBytes":J
    .end local v2  # "progress":I
    goto :goto_0
.end method

.method public synthetic lambda$new$0$PackageManagerService(Ljava/util/List;I)V
    .registers 12
    .param p1, "deferPackages"  # Ljava/util/List;
    .param p2, "storageFlags"  # I

    .line 3373
    new-instance v0, Landroid/util/TimingsTraceLog;

    const-string v1, "SystemServerTimingAsync"

    const-wide/32 v2, 0x40000

    invoke-direct {v0, v1, v2, v3}, Landroid/util/TimingsTraceLog;-><init>(Ljava/lang/String;J)V

    .line 3375
    .local v0, "traceLog":Landroid/util/TimingsTraceLog;
    const-string v1, "AppDataFixup"

    invoke-virtual {v0, v1}, Landroid/util/TimingsTraceLog;->traceBegin(Ljava/lang/String;)V

    .line 3377
    :try_start_f
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    sget-object v2, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    const/4 v3, 0x3

    invoke-virtual {v1, v2, v3}, Lcom/android/server/pm/Installer;->fixupAppData(Ljava/lang/String;I)V
    :try_end_17
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_f .. :try_end_17} :catch_18

    .line 3381
    goto :goto_20

    .line 3379
    :catch_18
    move-exception v1

    .line 3380
    .local v1, "e":Lcom/android/server/pm/Installer$InstallerException;
    const-string v2, "PackageManager"

    const-string v3, "Trouble fixing GIDs"

    invoke-static {v2, v3, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 3382
    .end local v1  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :goto_20
    invoke-virtual {v0}, Landroid/util/TimingsTraceLog;->traceEnd()V

    .line 3384
    const-string v1, "AppDataPrepare"

    invoke-virtual {v0, v1}, Landroid/util/TimingsTraceLog;->traceBegin(Ljava/lang/String;)V

    .line 3385
    if-eqz p1, :cond_8c

    invoke-interface {p1}, Ljava/util/List;->isEmpty()Z

    move-result v1

    if-eqz v1, :cond_31

    goto :goto_8c

    .line 3388
    :cond_31
    const/4 v1, 0x0

    .line 3389
    .local v1, "count":I
    invoke-interface {p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_36
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_6d

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    .line 3390
    .local v3, "pkgName":Ljava/lang/String;
    const/4 v4, 0x0

    .line 3391
    .local v4, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 3392
    :try_start_46
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v6, v3}, Lcom/android/server/pm/Settings;->getPackageLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v6

    .line 3393
    .local v6, "ps":Lcom/android/server/pm/PackageSetting;
    const/4 v7, 0x0

    if-eqz v6, :cond_58

    invoke-virtual {v6, v7}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v8

    if-eqz v8, :cond_58

    .line 3394
    iget-object v8, v6, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    move-object v4, v8

    .line 3396
    .end local v6  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_58
    monitor-exit v5
    :try_end_59
    .catchall {:try_start_46 .. :try_end_59} :catchall_6a

    .line 3397
    if-eqz v4, :cond_69

    .line 3398
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v5

    .line 3399
    const/4 v6, 0x1

    :try_start_5f
    invoke-direct {p0, v4, v7, p2, v6}, Lcom/android/server/pm/PackageManagerService;->prepareAppDataAndMigrateLIF(Landroid/content/pm/PackageParser$Package;IIZ)V

    .line 3401
    monitor-exit v5

    .line 3402
    add-int/lit8 v1, v1, 0x1

    goto :goto_69

    .line 3401
    :catchall_66
    move-exception v2

    monitor-exit v5
    :try_end_68
    .catchall {:try_start_5f .. :try_end_68} :catchall_66

    throw v2

    .line 3404
    .end local v3  # "pkgName":Ljava/lang/String;
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    :cond_69
    :goto_69
    goto :goto_36

    .line 3396
    .restart local v3  # "pkgName":Ljava/lang/String;
    .restart local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    :catchall_6a
    move-exception v2

    :try_start_6b
    monitor-exit v5
    :try_end_6c
    .catchall {:try_start_6b .. :try_end_6c} :catchall_6a

    throw v2

    .line 3405
    .end local v3  # "pkgName":Ljava/lang/String;
    .end local v4  # "pkg":Landroid/content/pm/PackageParser$Package;
    :cond_6d
    invoke-virtual {v0}, Landroid/util/TimingsTraceLog;->traceEnd()V

    .line 3406
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Deferred reconcileAppsData finished "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, " packages"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "PackageManager"

    invoke-static {v3, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3407
    return-void

    .line 3386
    .end local v1  # "count":I
    :cond_8c
    :goto_8c
    return-void
.end method

.method public synthetic lambda$notifyFirstLaunch$15$PackageManagerService(Ljava/lang/String;ILjava/lang/String;)V
    .registers 10
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I
    .param p3, "installerPackage"  # Ljava/lang/String;

    .line 15387
    const/4 v0, 0x0

    .local v0, "i":I
    :goto_1
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mRunningInstalls:Landroid/util/SparseArray;

    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I

    move-result v1

    const-string v2, "Package "

    const-string v3, "PackageManager"

    const/4 v4, 0x1

    if-ge v0, v1, :cond_5d

    .line 15388
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mRunningInstalls:Landroid/util/SparseArray;

    invoke-virtual {v1, v0}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$PostInstallData;

    .line 15389
    .local v1, "data":Lcom/android/server/pm/PackageManagerService$PostInstallData;
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService$PostInstallData;->res:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v5, v5, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    if-eq v5, v4, :cond_1d

    .line 15390
    goto :goto_5a

    .line 15392
    :cond_1d
    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService$PostInstallData;->res:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget-object v4, v4, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->pkg:Landroid/content/pm/PackageParser$Package;

    iget-object v4, v4, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v4, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {p1, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_5a

    .line 15394
    const/4 v4, 0x0

    .local v4, "uIndex":I
    :goto_2c
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService$PostInstallData;->res:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget-object v5, v5, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    array-length v5, v5

    if-ge v4, v5, :cond_5a

    .line 15395
    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService$PostInstallData;->res:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget-object v5, v5, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->newUsers:[I

    aget v5, v5, v4

    if-ne p2, v5, :cond_57

    .line 15396
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v5, :cond_56

    .line 15397
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " being restored so deferring FIRST_LAUNCH"

    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v3, v2}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 15400
    :cond_56
    return-void

    .line 15394
    :cond_57
    add-int/lit8 v4, v4, 0x1

    goto :goto_2c

    .line 15387
    .end local v1  # "data":Lcom/android/server/pm/PackageManagerService$PostInstallData;
    .end local v4  # "uIndex":I
    :cond_5a
    :goto_5a
    add-int/lit8 v0, v0, 0x1

    goto :goto_1

    .line 15406
    .end local v0  # "i":I
    :cond_5d
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v0, :cond_78

    .line 15407
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " sending normal FIRST_LAUNCH"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v3, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 15409
    :cond_78
    invoke-virtual {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->isInstantApp(Ljava/lang/String;I)Z

    move-result v0

    .line 15410
    .local v0, "isInstantApp":Z
    const/4 v1, 0x0

    if-eqz v0, :cond_82

    sget-object v2, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    goto :goto_86

    :cond_82
    new-array v2, v4, [I

    aput p2, v2, v1

    .line 15411
    .local v2, "userIds":[I
    :goto_86
    if-eqz v0, :cond_8d

    new-array v3, v4, [I

    aput p2, v3, v1

    goto :goto_8f

    :cond_8d
    sget-object v3, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    :goto_8f
    move-object v1, v3

    .line 15412
    .local v1, "instantUserIds":[I
    invoke-direct {p0, p1, p3, v2, v1}, Lcom/android/server/pm/PackageManagerService;->sendFirstLaunchBroadcast(Ljava/lang/String;Ljava/lang/String;[I[I)V

    .line 15413
    return-void
.end method

.method public synthetic lambda$processInstallRequestsAsync$14$PackageManagerService(ZLjava/util/List;)V
    .registers 11
    .param p1, "success"  # Z
    .param p2, "installRequests"  # Ljava/util/List;

    .line 15216
    if-eqz p1, :cond_44

    .line 15217
    invoke-interface {p2}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_6
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_1c

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 15218
    .local v1, "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v3, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    invoke-virtual {v2, v3}, Lcom/android/server/pm/PackageManagerService$InstallArgs;->doPreInstall(I)I

    .line 15219
    .end local v1  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    goto :goto_6

    .line 15220
    :cond_1c
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v0

    .line 15221
    :try_start_1f
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->installPackagesTracedLI(Ljava/util/List;)V

    .line 15222
    monitor-exit v0
    :try_end_23
    .catchall {:try_start_1f .. :try_end_23} :catchall_41

    .line 15223
    invoke-interface {p2}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_27
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_44

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 15224
    .restart local v1  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v3, v3, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->returnCode:I

    iget-object v4, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    iget v4, v4, Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/pm/PackageManagerService$InstallArgs;->doPostInstall(II)I

    .line 15226
    .end local v1  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    goto :goto_27

    .line 15222
    :catchall_41
    move-exception v1

    :try_start_42
    monitor-exit v0
    :try_end_43
    .catchall {:try_start_42 .. :try_end_43} :catchall_41

    throw v1

    .line 15228
    :cond_44
    invoke-interface {p2}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :goto_48
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_6c

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;

    .line 15229
    .restart local v1  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v2, v2, Lcom/android/server/pm/PackageManagerService$InstallArgs;->user:Landroid/os/UserHandle;

    invoke-virtual {v2}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v2

    iget-object v3, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    new-instance v4, Lcom/android/server/pm/PackageManagerService$PostInstallData;

    iget-object v5, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->args:Lcom/android/server/pm/PackageManagerService$InstallArgs;

    iget-object v6, v1, Lcom/android/server/pm/PackageManagerService$InstallRequest;->installResult:Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;

    const/4 v7, 0x0

    invoke-direct {v4, v5, v6, v7}, Lcom/android/server/pm/PackageManagerService$PostInstallData;-><init>(Lcom/android/server/pm/PackageManagerService$InstallArgs;Lcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Ljava/lang/Runnable;)V

    invoke-direct {p0, v2, v3, v4}, Lcom/android/server/pm/PackageManagerService;->restoreAndPostInstall(ILcom/android/server/pm/PackageManagerService$PackageInstalledInfo;Lcom/android/server/pm/PackageManagerService$PostInstallData;)V

    .line 15231
    .end local v1  # "request":Lcom/android/server/pm/PackageManagerService$InstallRequest;
    goto :goto_48

    .line 15232
    :cond_6c
    return-void
.end method

.method public synthetic lambda$removePackageDataLIF$21$PackageManagerService(Lcom/android/server/pm/PackageSetting;)V
    .registers 5
    .param p1, "deletedPs"  # Lcom/android/server/pm/PackageSetting;

    .line 19822
    iget-object v0, p1, Lcom/android/server/pm/PackageSetting;->name:Ljava/lang/String;

    iget v1, p1, Lcom/android/server/pm/PackageSetting;->appId:I

    const-string/jumbo v2, "permission grant or revoke changed gids"

    invoke-direct {p0, v0, v1, v2}, Lcom/android/server/pm/PackageManagerService;->killApplication(Ljava/lang/String;ILjava/lang/String;)V

    .line 19824
    return-void
.end method

.method public synthetic lambda$removeUnusedPackagesLPw$34$PackageManagerService(Ljava/lang/String;I)V
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userHandle"  # I

    .line 24687
    const-wide/16 v2, -0x1

    const/4 v5, 0x0

    move-object v0, p0

    move-object v1, p1

    move v4, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/PackageManagerService;->deletePackageX(Ljava/lang/String;JII)I

    return-void
.end method

.method public synthetic lambda$resetUserChangesToRuntimePermissionsAndFlagsLPw$22$PackageManagerService(II)V
    .registers 5
    .param p1, "revocationUID"  # I
    .param p2, "revocationUserId"  # I

    .line 20933
    invoke-static {p1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v0

    const-string/jumbo v1, "permissions revoked"

    invoke-direct {p0, v0, p2, v1}, Lcom/android/server/pm/PackageManagerService;->killUid(IILjava/lang/String;)V

    return-void
.end method

.method public synthetic lambda$restoreDefaultApps$26$PackageManagerService(Lorg/xmlpull/v1/XmlPullParser;I)V
    .registers 6
    .param p1, "parser1"  # Lorg/xmlpull/v1/XmlPullParser;
    .param p2, "userId1"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;,
            Lorg/xmlpull/v1/XmlPullParserException;
        }
    .end annotation

    .line 21664
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 21665
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/Settings;->readDefaultAppsLPw(Lorg/xmlpull/v1/XmlPullParser;I)V

    .line 21666
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p2}, Lcom/android/server/pm/Settings;->removeDefaultBrowserPackageNameLPw(I)Ljava/lang/String;

    move-result-object v1

    .line 21667
    .local v1, "defaultBrowser":Ljava/lang/String;
    monitor-exit v0
    :try_end_f
    .catchall {:try_start_3 .. :try_end_f} :catchall_1f

    .line 21668
    if-eqz v1, :cond_1e

    .line 21670
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 21671
    :try_start_14
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultBrowserProvider:Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;

    .line 21672
    .local v2, "provider":Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;
    monitor-exit v0
    :try_end_17
    .catchall {:try_start_14 .. :try_end_17} :catchall_1b

    .line 21673
    invoke-interface {v2, v1, p2}, Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;->setDefaultBrowser(Ljava/lang/String;I)Z

    goto :goto_1e

    .line 21672
    .end local v2  # "provider":Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;
    :catchall_1b
    move-exception v2

    :try_start_1c
    monitor-exit v0
    :try_end_1d
    .catchall {:try_start_1c .. :try_end_1d} :catchall_1b

    throw v2

    .line 21675
    :cond_1e
    :goto_1e
    return-void

    .line 21667
    .end local v1  # "defaultBrowser":Ljava/lang/String;
    :catchall_1f
    move-exception v1

    :try_start_20
    monitor-exit v0
    :try_end_21
    .catchall {:try_start_20 .. :try_end_21} :catchall_1f

    throw v1
.end method

.method public synthetic lambda$restoreIntentFilterVerification$27$PackageManagerService(Lorg/xmlpull/v1/XmlPullParser;I)V
    .registers 5
    .param p1, "parser1"  # Lorg/xmlpull/v1/XmlPullParser;
    .param p2, "userId1"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;,
            Lorg/xmlpull/v1/XmlPullParserException;
        }
    .end annotation

    .line 21724
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 21725
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/Settings;->readAllDomainVerificationsLPr(Lorg/xmlpull/v1/XmlPullParser;I)V

    .line 21726
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 21727
    monitor-exit v0

    .line 21728
    return-void

    .line 21727
    :catchall_f
    move-exception v1

    monitor-exit v0
    :try_end_11
    .catchall {:try_start_3 .. :try_end_11} :catchall_f

    throw v1
.end method

.method public synthetic lambda$restorePreferredActivities$25$PackageManagerService(Lorg/xmlpull/v1/XmlPullParser;I)V
    .registers 5
    .param p1, "readParser"  # Lorg/xmlpull/v1/XmlPullParser;
    .param p2, "readUserId"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;,
            Lorg/xmlpull/v1/XmlPullParserException;
        }
    .end annotation

    .line 21605
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 21606
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/Settings;->readPreferredActivitiesLPw(Lorg/xmlpull/v1/XmlPullParser;I)V

    .line 21607
    monitor-exit v0
    :try_end_9
    .catchall {:try_start_3 .. :try_end_9} :catchall_d

    .line 21608
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(I)Z

    .line 21609
    return-void

    .line 21607
    :catchall_d
    move-exception v1

    :try_start_e
    monitor-exit v0
    :try_end_f
    .catchall {:try_start_e .. :try_end_f} :catchall_d

    throw v1
.end method

.method public synthetic lambda$revokeDefaultPermissionsFromDisabledTelephonyDataServices$37$PackageManagerService([Ljava/lang/String;I)V
    .registers 4
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "userId"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .line 26162
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    .line 26163
    invoke-virtual {v0, p1, p2}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->revokeDefaultPermissionsFromDisabledTelephonyDataServices([Ljava/lang/String;I)V

    .line 26162
    return-void
.end method

.method public synthetic lambda$sendMyPackageSuspendedOrUnsuspended$12$PackageManagerService(ZI[Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;)V
    .registers 20
    .param p1, "suspended"  # Z
    .param p2, "userId"  # I
    .param p3, "affectedPackages"  # [Ljava/lang/String;
    .param p4, "action"  # Ljava/lang/String;
    .param p5, "intentExtras"  # Landroid/os/Bundle;

    move-object/from16 v1, p3

    .line 14419
    :try_start_2
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v0

    .line 14420
    .local v0, "am":Landroid/app/IActivityManager;
    if-nez v0, :cond_2b

    .line 14421
    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "IActivityManager null. Cannot send MY_PACKAGE_ "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 14422
    if-eqz p1, :cond_19

    const-string v4, ""

    goto :goto_1b

    :cond_19
    const-string v4, "UN"

    :goto_1b
    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, "SUSPENDED broadcasts"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 14421
    invoke-static {v2, v3}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    .line 14423
    return-void

    .line 14425
    :cond_2b
    const/4 v2, 0x1

    new-array v10, v2, [I

    const/4 v2, 0x0

    aput p2, v10, v2

    .line 14426
    .local v10, "targetUserIds":[I
    array-length v12, v1

    move v13, v2

    :goto_33
    if-ge v13, v12, :cond_48

    aget-object v8, v1, v13

    .line 14427
    .local v8, "packageName":Ljava/lang/String;
    const/4 v5, 0x0

    const/high16 v7, 0x1000000

    const/4 v9, 0x0

    const/4 v11, 0x0

    move-object v2, p0

    move-object v3, v0

    move-object/from16 v4, p4

    move-object/from16 v6, p5

    invoke-direct/range {v2 .. v11}, Lcom/android/server/pm/PackageManagerService;->doSendBroadcast(Landroid/app/IActivityManager;Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[IZ)V
    :try_end_45
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_45} :catch_49

    .line 14426
    .end local v8  # "packageName":Ljava/lang/String;
    add-int/lit8 v13, v13, 0x1

    goto :goto_33

    .line 14433
    .end local v0  # "am":Landroid/app/IActivityManager;
    .end local v10  # "targetUserIds":[I
    :cond_48
    goto :goto_4a

    .line 14431
    :catch_49
    move-exception v0

    .line 14434
    :goto_4a
    return-void
.end method

.method public synthetic lambda$sendPackageAddedForNewUsers$9$PackageManagerService([ILjava/lang/String;Z)V
    .registers 7
    .param p1, "userIds"  # [I
    .param p2, "packageName"  # Ljava/lang/String;
    .param p3, "includeStopped"  # Z

    .line 13742
    array-length v0, p1

    const/4 v1, 0x0

    :goto_2
    if-ge v1, v0, :cond_c

    aget v2, p1, v1

    .line 13743
    .local v2, "userId":I
    invoke-direct {p0, p2, p3, v2}, Lcom/android/server/pm/PackageManagerService;->sendBootCompletedBroadcastToSystemApp(Ljava/lang/String;ZI)V

    .line 13742
    .end local v2  # "userId":I
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .line 13746
    :cond_c
    return-void
.end method

.method public synthetic lambda$sendPackageBroadcast$7$PackageManagerService([ILjava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I)V
    .registers 22
    .param p1, "userIds"  # [I
    .param p2, "action"  # Ljava/lang/String;
    .param p3, "pkg"  # Ljava/lang/String;
    .param p4, "extras"  # Landroid/os/Bundle;
    .param p5, "flags"  # I
    .param p6, "targetPkg"  # Ljava/lang/String;
    .param p7, "finishedReceiver"  # Landroid/content/IIntentReceiver;
    .param p8, "instantUserIds"  # [I

    move-object/from16 v11, p8

    .line 13493
    :try_start_2
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v0

    .line 13494
    .local v0, "am":Landroid/app/IActivityManager;
    if-nez v0, :cond_9

    return-void

    .line 13496
    :cond_9
    if-nez p1, :cond_11

    .line 13497
    invoke-interface {v0}, Landroid/app/IActivityManager;->getRunningUserIds()[I

    move-result-object v1

    move-object v12, v1

    .local v1, "resolvedUserIds":[I
    goto :goto_13

    .line 13499
    .end local v1  # "resolvedUserIds":[I
    :cond_11
    move-object v1, p1

    move-object v12, v1

    .line 13501
    .local v12, "resolvedUserIds":[I
    :goto_13
    const/4 v10, 0x0

    move-object v1, p0

    move-object v2, v0

    move-object v3, p2

    move-object/from16 v4, p3

    move-object/from16 v5, p4

    move/from16 v6, p5

    move-object/from16 v7, p6

    move-object/from16 v8, p7

    move-object v9, v12

    invoke-direct/range {v1 .. v10}, Lcom/android/server/pm/PackageManagerService;->doSendBroadcast(Landroid/app/IActivityManager;Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[IZ)V

    .line 13503
    if-eqz v11, :cond_3e

    sget-object v1, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    if-eq v11, v1, :cond_3e

    .line 13504
    const/4 v10, 0x1

    move-object v1, p0

    move-object v2, v0

    move-object v3, p2

    move-object/from16 v4, p3

    move-object/from16 v5, p4

    move/from16 v6, p5

    move-object/from16 v7, p6

    move-object/from16 v8, p7

    move-object/from16 v9, p8

    invoke-direct/range {v1 .. v10}, Lcom/android/server/pm/PackageManagerService;->doSendBroadcast(Landroid/app/IActivityManager;Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[IZ)V
    :try_end_3e
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_3e} :catch_3f

    .line 13508
    .end local v0  # "am":Landroid/app/IActivityManager;
    .end local v12  # "resolvedUserIds":[I
    :cond_3e
    goto :goto_40

    .line 13507
    :catch_3f
    move-exception v0

    .line 13509
    :goto_40
    return-void
.end method

.method public synthetic lambda$systemReady$29$PackageManagerService(I)V
    .registers 8
    .param p1, "userId"  # I

    .line 22666
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 22667
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    sget-object v2, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    const/4 v3, 0x0

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 22669
    invoke-virtual {v4}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v4

    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 22667
    invoke-virtual {v1, v2, v3, v4, v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updateAllPermissions(Ljava/lang/String;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 22670
    monitor-exit v0

    .line 22671
    return-void

    .line 22670
    :catchall_15
    move-exception v1

    monitor-exit v0
    :try_end_17
    .catchall {:try_start_3 .. :try_end_17} :catchall_15

    throw v1
.end method

.method public synthetic lambda$unloadPrivatePackages$31$PackageManagerService(Landroid/os/storage/VolumeInfo;)V
    .registers 2
    .param p1, "vol"  # Landroid/os/storage/VolumeInfo;

    .line 23695
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->unloadPrivatePackagesInner(Landroid/os/storage/VolumeInfo;)V

    return-void
.end method

.method public synthetic lambda$updateDefaultHomeNotLocked$28$PackageManagerService(ILjava/lang/Boolean;)V
    .registers 4
    .param p1, "userId"  # I
    .param p2, "successful"  # Ljava/lang/Boolean;

    .line 21990
    invoke-virtual {p2}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v0

    if-eqz v0, :cond_9

    .line 21991
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->postPreferredActivityChangedBroadcast(I)V

    .line 21993
    :cond_9
    return-void
.end method

.method public logAppProcessStartIfNeeded(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;I)V
    .registers 10
    .param p1, "processName"  # Ljava/lang/String;
    .param p2, "uid"  # I
    .param p3, "seinfo"  # Ljava/lang/String;
    .param p4, "apkFile"  # Ljava/lang/String;
    .param p5, "pid"  # I

    .line 26248
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_b

    .line 26249
    return-void

    .line 26251
    :cond_b
    invoke-static {}, Landroid/app/admin/SecurityLog;->isLoggingEnabled()Z

    move-result v0

    if-nez v0, :cond_12

    .line 26252
    return-void

    .line 26254
    :cond_12
    new-instance v0, Landroid/os/Bundle;

    invoke-direct {v0}, Landroid/os/Bundle;-><init>()V

    .line 26255
    .local v0, "data":Landroid/os/Bundle;
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v1

    const-string/jumbo v3, "startTimestamp"

    invoke-virtual {v0, v3, v1, v2}, Landroid/os/Bundle;->putLong(Ljava/lang/String;J)V

    .line 26256
    const-string/jumbo v1, "processName"

    invoke-virtual {v0, v1, p1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 26257
    const-string/jumbo v1, "uid"

    invoke-virtual {v0, v1, p2}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V

    .line 26258
    const-string/jumbo v1, "seinfo"

    invoke-virtual {v0, v1, p3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 26259
    const-string v1, "apkFile"

    invoke-virtual {v0, v1, p4}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 26260
    const-string/jumbo v1, "pid"

    invoke-virtual {v0, v1, p5}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V

    .line 26261
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mProcessLoggingHandler:Lcom/android/server/pm/ProcessLoggingHandler;

    const/4 v2, 0x1

    invoke-virtual {v1, v2}, Lcom/android/server/pm/ProcessLoggingHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 26263
    .local v1, "msg":Landroid/os/Message;
    invoke-virtual {v1, v0}, Landroid/os/Message;->setData(Landroid/os/Bundle;)V

    .line 26264
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mProcessLoggingHandler:Lcom/android/server/pm/ProcessLoggingHandler;

    invoke-virtual {v2, v1}, Lcom/android/server/pm/ProcessLoggingHandler;->sendMessage(Landroid/os/Message;)Z

    .line 26265
    return-void
.end method

.method public movePackage(Ljava/lang/String;Ljava/lang/String;)I
    .registers 14
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "volumeUuid"  # Ljava/lang/String;

    .line 24286
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.MOVE_PACKAGE"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 24288
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 24289
    .local v0, "callingUid":I
    new-instance v9, Landroid/os/UserHandle;

    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    invoke-direct {v9, v1}, Landroid/os/UserHandle;-><init>(I)V

    .line 24290
    .local v9, "user":Landroid/os/UserHandle;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mNextMoveId:Ljava/util/concurrent/atomic/AtomicInteger;

    invoke-virtual {v1}, Ljava/util/concurrent/atomic/AtomicInteger;->getAndIncrement()I

    move-result v1

    .line 24291
    .local v1, "moveId":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v10, Lcom/android/server/pm/-$$Lambda$PackageManagerService$uo2Qs0M_YmpseropZZft4hdSstM;

    move-object v3, v10

    move-object v4, p0

    move-object v5, p1

    move-object v6, p2

    move v7, v1

    move v8, v0

    invoke-direct/range {v3 .. v9}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$uo2Qs0M_YmpseropZZft4hdSstM;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;Ljava/lang/String;IILandroid/os/UserHandle;)V

    invoke-virtual {v2, v10}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 24299
    return v1
.end method

.method public movePrimaryStorage(Ljava/lang/String;)I
    .registers 7
    .param p1, "volumeUuid"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .line 24560
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.MOVE_PACKAGE"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 24562
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mNextMoveId:Ljava/util/concurrent/atomic/AtomicInteger;

    invoke-virtual {v0}, Ljava/util/concurrent/atomic/AtomicInteger;->getAndIncrement()I

    move-result v0

    .line 24563
    .local v0, "realMoveId":I
    new-instance v1, Landroid/os/Bundle;

    invoke-direct {v1}, Landroid/os/Bundle;-><init>()V

    .line 24564
    .local v1, "extras":Landroid/os/Bundle;
    const-string v2, "android.os.storage.extra.FS_UUID"

    invoke-virtual {v1, v2, p1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 24565
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    invoke-static {v2, v0, v1}, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;->access$5400(Lcom/android/server/pm/PackageManagerService$MoveCallbacks;ILandroid/os/Bundle;)V

    .line 24567
    new-instance v2, Lcom/android/server/pm/PackageManagerService$10;

    invoke-direct {v2, p0, v0}, Lcom/android/server/pm/PackageManagerService$10;-><init>(Lcom/android/server/pm/PackageManagerService;I)V

    .line 24579
    .local v2, "callback":Landroid/content/pm/IPackageMoveObserver;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v4, Landroid/os/storage/StorageManager;

    invoke-virtual {v3, v4}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/os/storage/StorageManager;

    .line 24580
    .local v3, "storage":Landroid/os/storage/StorageManager;
    invoke-virtual {v3, p1, v2}, Landroid/os/storage/StorageManager;->setPrimaryStorageUuid(Ljava/lang/String;Landroid/content/pm/IPackageMoveObserver;)V

    .line 24581
    return v0
.end method

.method public notifyDexLoad(Ljava/lang/String;Ljava/util/List;Ljava/util/List;Ljava/lang/String;)V
    .registers 13
    .param p1, "loadingPackageName"  # Ljava/lang/String;
    .param p4, "loaderIsa"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;",
            "Ljava/lang/String;",
            ")V"
        }
    .end annotation

    .line 10333
    .local p2, "classLoaderNames":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local p3, "classPaths":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v6

    .line 10334
    .local v6, "userId":I
    const/4 v0, 0x0

    invoke-virtual {p0, p1, v0, v6}, Lcom/android/server/pm/PackageManagerService;->getApplicationInfo(Ljava/lang/String;II)Landroid/content/pm/ApplicationInfo;

    move-result-object v7

    .line 10335
    .local v7, "ai":Landroid/content/pm/ApplicationInfo;
    if-nez v7, :cond_2a

    .line 10336
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Loading a package that does not exist for the calling user. package="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, ", user="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10338
    return-void

    .line 10340
    :cond_2a
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    move-object v1, v7

    move-object v2, p2

    move-object v3, p3

    move-object v4, p4

    move v5, v6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/dex/DexManager;->notifyDexLoad(Landroid/content/pm/ApplicationInfo;Ljava/util/List;Ljava/util/List;Ljava/lang/String;I)V

    .line 10341
    return-void
.end method

.method notifyFirstLaunch(Ljava/lang/String;Ljava/lang/String;I)V
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "installerPackage"  # Ljava/lang/String;
    .param p3, "userId"  # I

    .line 15386
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$SxjjyVM6HSS7vYvHTON2BdU4enc;

    invoke-direct {v1, p0, p1, p3, p2}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$SxjjyVM6HSS7vYvHTON2BdU4enc;-><init>(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;ILjava/lang/String;)V

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 15414
    return-void
.end method

.method public notifyPackageAdded(Ljava/lang/String;I)V
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "uid"  # I

    .line 13515
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 13516
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    invoke-virtual {v1}, Landroid/util/ArraySet;->size()I

    move-result v1

    if-nez v1, :cond_d

    .line 13517
    monitor-exit v0

    return-void

    .line 13519
    :cond_d
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    .line 13520
    invoke-virtual {v1}, Landroid/util/ArraySet;->size()I

    move-result v1

    new-array v1, v1, [Landroid/content/pm/PackageManagerInternal$PackageListObserver;

    .line 13521
    .local v1, "observerArray":[Landroid/content/pm/PackageManagerInternal$PackageListObserver;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    invoke-virtual {v2, v1}, Landroid/util/ArraySet;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v2

    check-cast v2, [Landroid/content/pm/PackageManagerInternal$PackageListObserver;

    move-object v1, v2

    .line 13522
    .local v1, "observers":[Landroid/content/pm/PackageManagerInternal$PackageListObserver;
    monitor-exit v0
    :try_end_1f
    .catchall {:try_start_3 .. :try_end_1f} :catchall_2d

    .line 13523
    array-length v0, v1

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_22
    if-ltz v0, :cond_2c

    .line 13524
    aget-object v2, v1, v0

    invoke-interface {v2, p1, p2}, Landroid/content/pm/PackageManagerInternal$PackageListObserver;->onPackageAdded(Ljava/lang/String;I)V

    .line 13523
    add-int/lit8 v0, v0, -0x1

    goto :goto_22

    .line 13526
    .end local v0  # "i":I
    :cond_2c
    return-void

    .line 13522
    .end local v1  # "observers":[Landroid/content/pm/PackageManagerInternal$PackageListObserver;
    :catchall_2d
    move-exception v1

    :try_start_2e
    monitor-exit v0
    :try_end_2f
    .catchall {:try_start_2e .. :try_end_2f} :catchall_2d

    throw v1
.end method

.method public notifyPackageChanged(Ljava/lang/String;I)V
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "uid"  # I

    .line 13531
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 13532
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    invoke-virtual {v1}, Landroid/util/ArraySet;->size()I

    move-result v1

    if-nez v1, :cond_d

    .line 13533
    monitor-exit v0

    return-void

    .line 13535
    :cond_d
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    .line 13536
    invoke-virtual {v1}, Landroid/util/ArraySet;->size()I

    move-result v1

    new-array v1, v1, [Landroid/content/pm/PackageManagerInternal$PackageListObserver;

    .line 13537
    .local v1, "observerArray":[Landroid/content/pm/PackageManagerInternal$PackageListObserver;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    invoke-virtual {v2, v1}, Landroid/util/ArraySet;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v2

    check-cast v2, [Landroid/content/pm/PackageManagerInternal$PackageListObserver;

    move-object v1, v2

    .line 13538
    .local v1, "observers":[Landroid/content/pm/PackageManagerInternal$PackageListObserver;
    monitor-exit v0
    :try_end_1f
    .catchall {:try_start_3 .. :try_end_1f} :catchall_2d

    .line 13539
    array-length v0, v1

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_22
    if-ltz v0, :cond_2c

    .line 13540
    aget-object v2, v1, v0

    invoke-interface {v2, p1, p2}, Landroid/content/pm/PackageManagerInternal$PackageListObserver;->onPackageChanged(Ljava/lang/String;I)V

    .line 13539
    add-int/lit8 v0, v0, -0x1

    goto :goto_22

    .line 13542
    .end local v0  # "i":I
    :cond_2c
    return-void

    .line 13538
    .end local v1  # "observers":[Landroid/content/pm/PackageManagerInternal$PackageListObserver;
    :catchall_2d
    move-exception v1

    :try_start_2e
    monitor-exit v0
    :try_end_2f
    .catchall {:try_start_2e .. :try_end_2f} :catchall_2d

    throw v1
.end method

.method public notifyPackageRemoved(Ljava/lang/String;I)V
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "uid"  # I

    .line 13553
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 13554
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    invoke-virtual {v1}, Landroid/util/ArraySet;->size()I

    move-result v1

    if-nez v1, :cond_d

    .line 13555
    monitor-exit v0

    return-void

    .line 13557
    :cond_d
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    .line 13558
    invoke-virtual {v1}, Landroid/util/ArraySet;->size()I

    move-result v1

    new-array v1, v1, [Landroid/content/pm/PackageManagerInternal$PackageListObserver;

    .line 13559
    .local v1, "observerArray":[Landroid/content/pm/PackageManagerInternal$PackageListObserver;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackageListObservers:Landroid/util/ArraySet;

    invoke-virtual {v2, v1}, Landroid/util/ArraySet;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v2

    check-cast v2, [Landroid/content/pm/PackageManagerInternal$PackageListObserver;

    move-object v1, v2

    .line 13560
    .local v1, "observers":[Landroid/content/pm/PackageManagerInternal$PackageListObserver;
    monitor-exit v0
    :try_end_1f
    .catchall {:try_start_3 .. :try_end_1f} :catchall_2d

    .line 13561
    array-length v0, v1

    add-int/lit8 v0, v0, -0x1

    .local v0, "i":I
    :goto_22
    if-ltz v0, :cond_2c

    .line 13562
    aget-object v2, v1, v0

    invoke-interface {v2, p1, p2}, Landroid/content/pm/PackageManagerInternal$PackageListObserver;->onPackageRemoved(Ljava/lang/String;I)V

    .line 13561
    add-int/lit8 v0, v0, -0x1

    goto :goto_22

    .line 13564
    .end local v0  # "i":I
    :cond_2c
    return-void

    .line 13560
    .end local v1  # "observers":[Landroid/content/pm/PackageManagerInternal$PackageListObserver;
    :catchall_2d
    move-exception v1

    :try_start_2e
    monitor-exit v0
    :try_end_2f
    .catchall {:try_start_2e .. :try_end_2f} :catchall_2d

    throw v1
.end method

.method public notifyPackageUse(Ljava/lang/String;I)V
    .registers 7
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "reason"  # I

    .line 10295
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 10296
    :try_start_3
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    .line 10297
    .local v1, "callingUid":I
    invoke-static {v1}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v2

    .line 10298
    .local v2, "callingUserId":I
    invoke-direct {p0, v1}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v3

    if-eqz v3, :cond_19

    .line 10299
    invoke-direct {p0, p1, v1}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v3

    if-nez v3, :cond_21

    .line 10300
    monitor-exit v0

    return-void

    .line 10303
    :cond_19
    invoke-virtual {p0, p1, v2}, Lcom/android/server/pm/PackageManagerService;->isInstantApp(Ljava/lang/String;I)Z

    move-result v3

    if-eqz v3, :cond_21

    .line 10304
    monitor-exit v0

    return-void

    .line 10307
    :cond_21
    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->notifyPackageUseLocked(Ljava/lang/String;I)V

    .line 10308
    .end local v1  # "callingUid":I
    .end local v2  # "callingUserId":I
    monitor-exit v0

    .line 10309
    return-void

    .line 10308
    :catchall_26
    move-exception v1

    monitor-exit v0
    :try_end_28
    .catchall {:try_start_3 .. :try_end_28} :catchall_26

    throw v1
.end method

.method public notifyPackagesReplacedReceived([Ljava/lang/String;)V
    .registers 9
    .param p1, "packages"  # [Ljava/lang/String;

    .line 2222
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 2223
    .local v0, "callingUid":I
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    .line 2225
    .local v1, "callingUserId":I
    array-length v2, p1

    const/4 v3, 0x0

    :goto_a
    if-ge v3, v2, :cond_26

    aget-object v4, p1, v3

    .line 2226
    .local v4, "packageName":Ljava/lang/String;
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 2227
    .local v5, "setting":Lcom/android/server/pm/PackageSetting;
    if-eqz v5, :cond_23

    invoke-direct {p0, v5, v0, v1}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v6

    if-eqz v6, :cond_23

    .line 2228
    invoke-direct {p0, v4}, Lcom/android/server/pm/PackageManagerService;->notifyInstallObserver(Ljava/lang/String;)V

    .line 2225
    .end local v4  # "packageName":Ljava/lang/String;
    .end local v5  # "setting":Lcom/android/server/pm/PackageSetting;
    :cond_23
    add-int/lit8 v3, v3, 0x1

    goto :goto_a

    .line 2231
    :cond_26
    return-void
.end method

.method onNewUserCreated(I)V
    .registers 8
    .param p1, "userId"  # I

    .line 24706
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->grantDefaultPermissions(I)V

    .line 24707
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 24709
    :try_start_8
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    sget-object v2, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    const/4 v3, 0x1

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 24710
    invoke-virtual {v4}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v4

    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 24709
    invoke-virtual {v1, v2, v3, v4, v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updateAllPermissions(Ljava/lang/String;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 24712
    monitor-exit v0

    .line 24713
    return-void

    .line 24712
    :catchall_1a
    move-exception v1

    monitor-exit v0
    :try_end_1c
    .catchall {:try_start_8 .. :try_end_1c} :catchall_1a

    throw v1
.end method

.method public onShellCommand(Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;[Ljava/lang/String;Landroid/os/ShellCallback;Landroid/os/ResultReceiver;)V
    .registers 15
    .param p1, "in"  # Ljava/io/FileDescriptor;
    .param p2, "out"  # Ljava/io/FileDescriptor;
    .param p3, "err"  # Ljava/io/FileDescriptor;
    .param p4, "args"  # [Ljava/lang/String;
    .param p5, "callback"  # Landroid/os/ShellCallback;
    .param p6, "resultReceiver"  # Landroid/os/ResultReceiver;

    .line 22770
    new-instance v0, Lcom/android/server/pm/PackageManagerShellCommand;

    invoke-direct {v0, p0}, Lcom/android/server/pm/PackageManagerShellCommand;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    move-object v1, p0

    move-object v2, p1

    move-object v3, p2

    move-object v4, p3

    move-object v5, p4

    move-object v6, p5

    move-object v7, p6

    invoke-virtual/range {v0 .. v7}, Lcom/android/server/pm/PackageManagerShellCommand;->exec(Landroid/os/Binder;Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;Ljava/io/FileDescriptor;[Ljava/lang/String;Landroid/os/ShellCallback;Landroid/os/ResultReceiver;)I

    .line 22772
    return-void
.end method

.method public onTransact(ILandroid/os/Parcel;Landroid/os/Parcel;I)Z
    .registers 8
    .param p1, "code"  # I
    .param p2, "data"  # Landroid/os/Parcel;
    .param p3, "reply"  # Landroid/os/Parcel;
    .param p4, "flags"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .line 4252
    :try_start_0
    invoke-super {p0, p1, p2, p3, p4}, Landroid/content/pm/IPackageManager$Stub;->onTransact(ILandroid/os/Parcel;Landroid/os/Parcel;I)Z

    move-result v0
    :try_end_4
    .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_4} :catch_5

    return v0

    .line 4253
    :catch_5
    move-exception v0

    .line 4254
    .local v0, "e":Ljava/lang/RuntimeException;
    instance-of v1, v0, Ljava/lang/SecurityException;

    if-nez v1, :cond_15

    instance-of v1, v0, Ljava/lang/IllegalArgumentException;

    if-nez v1, :cond_15

    .line 4255
    const-string v1, "PackageManager"

    const-string v2, "Package Manager Crash"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 4257
    :cond_15
    throw v0
.end method

.method performDexOpt(Lcom/android/server/pm/dex/DexoptOptions;)Z
    .registers 5
    .param p1, "options"  # Lcom/android/server/pm/dex/DexoptOptions;

    .line 10418
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    const/4 v1, 0x0

    if-eqz v0, :cond_c

    .line 10419
    return v1

    .line 10420
    :cond_c
    invoke-virtual {p1}, Lcom/android/server/pm/dex/DexoptOptions;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v2

    invoke-virtual {p0, v0, v2}, Lcom/android/server/pm/PackageManagerService;->isInstantApp(Ljava/lang/String;I)Z

    move-result v0

    if-eqz v0, :cond_1b

    .line 10421
    return v1

    .line 10424
    :cond_1b
    invoke-virtual {p1}, Lcom/android/server/pm/dex/DexoptOptions;->isDexoptOnlySecondaryDex()Z

    move-result v0

    if-eqz v0, :cond_28

    .line 10425
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/dex/DexManager;->dexoptSecondaryDex(Lcom/android/server/pm/dex/DexoptOptions;)Z

    move-result v0

    return v0

    .line 10427
    :cond_28
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->performDexOptWithStatus(Lcom/android/server/pm/dex/DexoptOptions;)I

    move-result v0

    .line 10428
    .local v0, "dexoptStatus":I
    const/4 v2, -0x1

    if-eq v0, v2, :cond_30

    const/4 v1, 0x1

    :cond_30
    return v1
.end method

.method public performDexOptMode(Ljava/lang/String;ZLjava/lang/String;ZZLjava/lang/String;)Z
    .registers 15
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "checkProfiles"  # Z
    .param p3, "targetCompilerFilter"  # Ljava/lang/String;
    .param p4, "force"  # Z
    .param p5, "bootComplete"  # Z
    .param p6, "splitName"  # Ljava/lang/String;

    .line 10378
    nop

    .line 10379
    const/4 v0, 0x0

    if-eqz p4, :cond_6

    const/4 v1, 0x2

    goto :goto_7

    :cond_6
    move v1, v0

    :goto_7
    or-int/2addr v1, p2

    .line 10380
    if-eqz p5, :cond_b

    const/4 v0, 0x4

    :cond_b
    or-int/2addr v0, v1

    .line 10381
    .local v0, "flags":I
    new-instance v1, Lcom/android/server/pm/dex/DexoptOptions;

    const/4 v4, -0x1

    move-object v2, v1

    move-object v3, p1

    move-object v5, p3

    move-object v6, p6

    move v7, v0

    invoke-direct/range {v2 .. v7}, Lcom/android/server/pm/dex/DexoptOptions;-><init>(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;I)V

    invoke-virtual {p0, v1}, Lcom/android/server/pm/PackageManagerService;->performDexOpt(Lcom/android/server/pm/dex/DexoptOptions;)Z

    move-result v1

    return v1
.end method

.method public performDexOptSecondary(Ljava/lang/String;Ljava/lang/String;Z)Z
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "compilerFilter"  # Ljava/lang/String;
    .param p3, "force"  # Z

    .line 10395
    nop

    .line 10398
    if-eqz p3, :cond_5

    const/4 v0, 0x2

    goto :goto_6

    :cond_5
    const/4 v0, 0x0

    :goto_6
    or-int/lit8 v0, v0, 0xd

    .line 10399
    .local v0, "flags":I
    new-instance v1, Lcom/android/server/pm/dex/DexoptOptions;

    invoke-direct {v1, p1, p2, v0}, Lcom/android/server/pm/dex/DexoptOptions;-><init>(Ljava/lang/String;Ljava/lang/String;I)V

    invoke-virtual {p0, v1}, Lcom/android/server/pm/PackageManagerService;->performDexOpt(Lcom/android/server/pm/dex/DexoptOptions;)Z

    move-result v1

    return v1
.end method

.method performDexOptWithStatus(Lcom/android/server/pm/dex/DexoptOptions;)I
    .registers 3
    .param p1, "options"  # Lcom/android/server/pm/dex/DexoptOptions;

    .line 10439
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->performDexOptTraced(Lcom/android/server/pm/dex/DexoptOptions;)I

    move-result v0

    return v0
.end method

.method public performFstrimIfNeeded()V
    .registers 10

    .line 10049
    const-string v0, "Only the system can request fstrim"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrRoot(Ljava/lang/String;)V

    .line 10053
    :try_start_5
    invoke-static {}, Lcom/android/internal/content/PackageHelper;->getStorageManager()Landroid/os/storage/IStorageManager;

    move-result-object v0

    .line 10054
    .local v0, "sm":Landroid/os/storage/IStorageManager;
    if-eqz v0, :cond_79

    .line 10055
    const/4 v1, 0x0

    .line 10056
    .local v1, "doTrim":Z
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 10057
    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    const-string v3, "fstrim_mandatory_interval"

    const-wide/32 v4, 0xf731400

    .line 10056
    invoke-static {v2, v3, v4, v5}, Landroid/provider/Settings$Global;->getLong(Landroid/content/ContentResolver;Ljava/lang/String;J)J

    move-result-wide v2

    .line 10060
    .local v2, "interval":J
    const-wide/16 v4, 0x0

    cmp-long v4, v2, v4

    if-lez v4, :cond_4a

    .line 10061
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v4

    invoke-interface {v0}, Landroid/os/storage/IStorageManager;->lastMaintenance()J

    move-result-wide v6

    sub-long/2addr v4, v6

    .line 10062
    .local v4, "timeSinceLast":J
    cmp-long v6, v4, v2

    if-lez v6, :cond_4a

    .line 10063
    const/4 v1, 0x1

    .line 10064
    const-string v6, "PackageManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "No disk maintenance in "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v4, v5}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v8, "; running immediately"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10068
    .end local v4  # "timeSinceLast":J
    :cond_4a
    if-eqz v1, :cond_78

    .line 10070
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v4
    :try_end_4f
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_4f} :catch_82

    .line 10071
    :try_start_4f
    iget-boolean v5, p0, Lcom/android/server/pm/PackageManagerService;->mDexOptDialogShown:Z

    .line 10072
    .local v5, "dexOptDialogShown":Z
    monitor-exit v4
    :try_end_52
    .catchall {:try_start_4f .. :try_end_52} :catchall_75

    .line 10073
    :try_start_52
    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->isFirstBoot()Z

    move-result v4
    :try_end_56
    .catch Landroid/os/RemoteException; {:try_start_52 .. :try_end_56} :catch_82

    if-nez v4, :cond_71

    if-eqz v5, :cond_71

    .line 10075
    :try_start_5a
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v4

    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 10076
    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v6

    const v7, 0x1040085

    invoke-virtual {v6, v7}, Landroid/content/res/Resources;->getString(I)Ljava/lang/String;

    move-result-object v6

    const/4 v7, 0x1

    .line 10075
    invoke-interface {v4, v6, v7}, Landroid/app/IActivityManager;->showBootMessage(Ljava/lang/CharSequence;Z)V
    :try_end_6f
    .catch Landroid/os/RemoteException; {:try_start_5a .. :try_end_6f} :catch_70

    .line 10079
    goto :goto_71

    .line 10078
    :catch_70
    move-exception v4

    .line 10081
    :cond_71
    :goto_71
    :try_start_71
    invoke-interface {v0}, Landroid/os/storage/IStorageManager;->runMaintenance()V
    :try_end_74
    .catch Landroid/os/RemoteException; {:try_start_71 .. :try_end_74} :catch_82

    goto :goto_78

    .line 10072
    .end local v5  # "dexOptDialogShown":Z
    :catchall_75
    move-exception v5

    :try_start_76
    monitor-exit v4
    :try_end_77
    .catchall {:try_start_76 .. :try_end_77} :catchall_75

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    :try_start_77
    throw v5

    .line 10083
    .end local v1  # "doTrim":Z
    .end local v2  # "interval":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    :cond_78
    :goto_78
    goto :goto_81

    .line 10084
    :cond_79
    const-string v1, "PackageManager"

    const-string/jumbo v2, "storageManager service unavailable!"

    invoke-static {v1, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_81
    .catch Landroid/os/RemoteException; {:try_start_77 .. :try_end_81} :catch_82

    .line 10088
    .end local v0  # "sm":Landroid/os/storage/IStorageManager;
    :goto_81
    goto :goto_83

    .line 10086
    :catch_82
    move-exception v0

    .line 10089
    :goto_83
    return-void
.end method

.method public queryContentProviders(Ljava/lang/String;IILjava/lang/String;)Landroid/content/pm/ParceledListSlice;
    .registers 21
    .param p1, "processName"  # Ljava/lang/String;
    .param p2, "uid"  # I
    .param p3, "flags"  # I
    .param p4, "metaDataKey"  # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "II",
            "Ljava/lang/String;",
            ")",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/ProviderInfo;",
            ">;"
        }
    .end annotation

    .line 9368
    move-object/from16 v7, p0

    move-object/from16 v8, p1

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v9

    .line 9369
    .local v9, "callingUid":I
    if-eqz v8, :cond_f

    invoke-static/range {p2 .. p2}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v0

    goto :goto_13

    .line 9370
    :cond_f
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    :goto_13
    move v10, v0

    .line 9371
    .local v10, "userId":I
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v10}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_21

    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v0

    return-object v0

    .line 9372
    :cond_21
    move/from16 v0, p3

    invoke-direct {v7, v0, v10, v8}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForComponent(IILjava/lang/Object;)I

    move-result v11

    .line 9373
    .end local p3  # "flags":I
    .local v11, "flags":I
    const/4 v0, 0x0

    .line 9374
    .local v0, "finalList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ProviderInfo;>;"
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    .line 9375
    move-object/from16 v2, p1

    move-object/from16 v3, p4

    move/from16 v4, p2

    move v5, v11

    move v6, v10

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/ComponentResolver;->queryProviders(Ljava/lang/String;Ljava/lang/String;III)Ljava/util/List;

    move-result-object v12

    .line 9376
    .local v12, "matchList":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ProviderInfo;>;"
    if-nez v12, :cond_3a

    const/4 v1, 0x0

    goto :goto_3e

    :cond_3a
    invoke-interface {v12}, Ljava/util/List;->size()I

    move-result v1

    :goto_3e
    move v13, v1

    .line 9377
    .local v13, "listSize":I
    iget-object v14, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v14

    .line 9378
    const/4 v1, 0x0

    move-object v15, v0

    move v0, v1

    .local v0, "i":I
    .local v15, "finalList":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ProviderInfo;>;"
    :goto_45
    if-ge v0, v13, :cond_8c

    .line 9379
    :try_start_47
    invoke-interface {v12, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/ProviderInfo;

    move-object v6, v1

    .line 9380
    .local v6, "providerInfo":Landroid/content/pm/ProviderInfo;
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, v6, v11, v10}, Lcom/android/server/pm/Settings;->isEnabledAndMatchLPr(Landroid/content/pm/ComponentInfo;II)Z

    move-result v1

    if-nez v1, :cond_57

    .line 9381
    goto :goto_87

    .line 9383
    :cond_57
    iget-object v1, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, v6, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    move-object v2, v1

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 9384
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    new-instance v4, Landroid/content/ComponentName;

    iget-object v1, v6, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    iget-object v3, v6, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v1, v3}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 9386
    .local v4, "component":Landroid/content/ComponentName;
    const/4 v5, 0x4

    move-object/from16 v1, p0

    move v3, v9

    move-object v7, v6

    .end local v6  # "providerInfo":Landroid/content/pm/ProviderInfo;
    .local v7, "providerInfo":Landroid/content/pm/ProviderInfo;
    move v6, v10

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;ILandroid/content/ComponentName;II)Z

    move-result v1

    if-eqz v1, :cond_7a

    .line 9387
    goto :goto_87

    .line 9389
    :cond_7a
    if-nez v15, :cond_84

    .line 9390
    new-instance v1, Ljava/util/ArrayList;

    sub-int v3, v13, v0

    invoke-direct {v1, v3}, Ljava/util/ArrayList;-><init>(I)V

    move-object v15, v1

    .line 9392
    :cond_84
    invoke-virtual {v15, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 9378
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "component":Landroid/content/ComponentName;
    .end local v7  # "providerInfo":Landroid/content/pm/ProviderInfo;
    :goto_87
    add-int/lit8 v0, v0, 0x1

    move-object/from16 v7, p0

    goto :goto_45

    .line 9394
    .end local v0  # "i":I
    :cond_8c
    monitor-exit v14
    :try_end_8d
    .catchall {:try_start_47 .. :try_end_8d} :catchall_9f

    .line 9396
    if-eqz v15, :cond_9a

    .line 9397
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sProviderInitOrderSorter:Ljava/util/Comparator;

    invoke-virtual {v15, v0}, Ljava/util/ArrayList;->sort(Ljava/util/Comparator;)V

    .line 9398
    new-instance v0, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v0, v15}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    return-object v0

    .line 9401
    :cond_9a
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v0

    return-object v0

    .line 9394
    :catchall_9f
    move-exception v0

    :try_start_a0
    monitor-exit v14
    :try_end_a1
    .catchall {:try_start_a0 .. :try_end_a1} :catchall_9f

    throw v0
.end method

.method public queryInstrumentation(Ljava/lang/String;I)Landroid/content/pm/ParceledListSlice;
    .registers 8
    .param p1, "targetPackage"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "I)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/InstrumentationInfo;",
            ">;"
        }
    .end annotation

    .line 9423
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 9424
    .local v0, "callingUid":I
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    .line 9425
    .local v1, "callingUserId":I
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 9426
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v2, v0, v1}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-eqz v3, :cond_1d

    .line 9427
    invoke-static {}, Landroid/content/pm/ParceledListSlice;->emptyList()Landroid/content/pm/ParceledListSlice;

    move-result-object v3

    return-object v3

    .line 9429
    :cond_1d
    new-instance v3, Landroid/content/pm/ParceledListSlice;

    invoke-direct {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->queryInstrumentationInternal(Ljava/lang/String;I)Ljava/util/List;

    move-result-object v4

    invoke-direct {v3, v4}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    return-object v3
.end method

.method public queryIntentActivities(Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ParceledListSlice;
    .registers 9
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 7459
    const-wide/32 v0, 0x40000

    :try_start_3
    const-string/jumbo v2, "queryIntentActivities"

    invoke-static {v0, v1, v2}, Landroid/os/Trace;->traceBegin(JLjava/lang/String;)V

    .line 7461
    new-instance v2, Landroid/content/pm/ParceledListSlice;

    .line 7462
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v3

    invoke-direct {v2, v3}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V
    :try_end_12
    .catchall {:try_start_3 .. :try_end_12} :catchall_16

    .line 7464
    invoke-static {v0, v1}, Landroid/os/Trace;->traceEnd(J)V

    .line 7461
    return-object v2

    .line 7464
    :catchall_16
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Trace;->traceEnd(J)V

    throw v2
.end method

.method public queryIntentActivityOptions(Landroid/content/ComponentName;[Landroid/content/Intent;[Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ParceledListSlice;
    .registers 10
    .param p1, "caller"  # Landroid/content/ComponentName;
    .param p2, "specifics"  # [Landroid/content/Intent;
    .param p3, "specificTypes"  # [Ljava/lang/String;
    .param p4, "intent"  # Landroid/content/Intent;
    .param p5, "resolvedType"  # Ljava/lang/String;
    .param p6, "flags"  # I
    .param p7, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/ComponentName;",
            "[",
            "Landroid/content/Intent;",
            "[",
            "Ljava/lang/String;",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8323
    new-instance v0, Landroid/content/pm/ParceledListSlice;

    invoke-direct/range {p0 .. p7}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivityOptionsInternal(Landroid/content/ComponentName;[Landroid/content/Intent;[Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    return-object v0
.end method

.method public queryIntentContentProviders(Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ParceledListSlice;
    .registers 7
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8742
    new-instance v0, Landroid/content/pm/ParceledListSlice;

    .line 8743
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/pm/PackageManagerService;->queryIntentContentProvidersInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    .line 8742
    return-object v0
.end method

.method public queryIntentReceivers(Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ParceledListSlice;
    .registers 12
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8506
    new-instance v0, Landroid/content/pm/ParceledListSlice;

    .line 8507
    const/4 v6, 0x0

    move-object v1, p0

    move-object v2, p1

    move-object v3, p2

    move v4, p3

    move v5, p4

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->queryIntentReceiversInternal(Landroid/content/Intent;Ljava/lang/String;IIZ)Ljava/util/List;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    .line 8506
    return-object v0
.end method

.method public queryIntentServices(Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ParceledListSlice;
    .registers 14
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/content/Intent;",
            "Ljava/lang/String;",
            "II)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/ResolveInfo;",
            ">;"
        }
    .end annotation

    .line 8621
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    .line 8622
    .local v7, "callingUid":I
    new-instance v8, Landroid/content/pm/ParceledListSlice;

    const/4 v6, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move v3, p3

    move v4, p4

    move v5, v7

    invoke-direct/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->queryIntentServicesInternal(Landroid/content/Intent;Ljava/lang/String;IIIZ)Ljava/util/List;

    move-result-object v0

    invoke-direct {v8, v0}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    return-object v8
.end method

.method public queryPermissionsByGroup(Ljava/lang/String;I)Landroid/content/pm/ParceledListSlice;
    .registers 5
    .param p1, "groupName"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "I)",
            "Landroid/content/pm/ParceledListSlice<",
            "Landroid/content/pm/PermissionInfo;",
            ">;"
        }
    .end annotation

    .line 4870
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 4871
    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, p1, p2, v1}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->getPermissionInfoByGroup(Ljava/lang/String;II)Ljava/util/List;

    move-result-object v0

    .line 4872
    .local v0, "permissionList":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/PermissionInfo;>;"
    if-nez v0, :cond_e

    const/4 v1, 0x0

    goto :goto_13

    :cond_e
    new-instance v1, Landroid/content/pm/ParceledListSlice;

    invoke-direct {v1, v0}, Landroid/content/pm/ParceledListSlice;-><init>(Ljava/util/List;)V

    :goto_13
    return-object v1
.end method

.method public querySyncProviders(Ljava/util/List;Ljava/util/List;)V
    .registers 6
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;",
            "Ljava/util/List<",
            "Landroid/content/pm/ProviderInfo;",
            ">;)V"
        }
    .end annotation

    .annotation runtime Ljava/lang/Deprecated;
    .end annotation

    .line 9358
    .local p1, "outNames":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local p2, "outInfo":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ProviderInfo;>;"
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_b

    .line 9359
    return-void

    .line 9361
    :cond_b
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    iget-boolean v1, p0, Lcom/android/server/pm/PackageManagerService;->mSafeMode:Z

    .line 9362
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v2

    .line 9361
    invoke-virtual {v0, p1, p2, v1, v2}, Lcom/android/server/pm/ComponentResolver;->querySyncProviders(Ljava/util/List;Ljava/util/List;ZI)V

    .line 9363
    return-void
.end method

.method reconcileAppsData(IIZ)V
    .registers 9
    .param p1, "userId"  # I
    .param p2, "flags"  # I
    .param p3, "migrateAppsData"  # Z

    .line 23840
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v1, Landroid/os/storage/StorageManager;

    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/os/storage/StorageManager;

    .line 23841
    .local v0, "storage":Landroid/os/storage/StorageManager;
    invoke-virtual {v0}, Landroid/os/storage/StorageManager;->getWritablePrivateVolumes()Ljava/util/List;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_12
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_2d

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/os/storage/VolumeInfo;

    .line 23842
    .local v2, "vol":Landroid/os/storage/VolumeInfo;
    invoke-virtual {v2}, Landroid/os/storage/VolumeInfo;->getFsUuid()Ljava/lang/String;

    move-result-object v3

    .line 23843
    .local v3, "volumeUuid":Ljava/lang/String;
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstallLock:Ljava/lang/Object;

    monitor-enter v4

    .line 23844
    :try_start_25
    invoke-direct {p0, v3, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->reconcileAppsDataLI(Ljava/lang/String;IIZ)V

    .line 23845
    monitor-exit v4

    .line 23846
    .end local v2  # "vol":Landroid/os/storage/VolumeInfo;
    .end local v3  # "volumeUuid":Ljava/lang/String;
    goto :goto_12

    .line 23845
    .restart local v2  # "vol":Landroid/os/storage/VolumeInfo;
    .restart local v3  # "volumeUuid":Ljava/lang/String;
    :catchall_2a
    move-exception v1

    monitor-exit v4
    :try_end_2c
    .catchall {:try_start_25 .. :try_end_2c} :catchall_2a

    throw v1

    .line 23847
    .end local v2  # "vol":Landroid/os/storage/VolumeInfo;
    .end local v3  # "volumeUuid":Ljava/lang/String;
    :cond_2d
    return-void
.end method

.method public reconcileSecondaryDexFiles(Ljava/lang/String;)V
    .registers 3
    .param p1, "packageName"  # Ljava/lang/String;

    .line 10540
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_b

    .line 10541
    return-void

    .line 10542
    :cond_b
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    invoke-virtual {p0, p1, v0}, Lcom/android/server/pm/PackageManagerService;->isInstantApp(Ljava/lang/String;I)Z

    move-result v0

    if-eqz v0, :cond_16

    .line 10543
    return-void

    .line 10545
    :cond_16
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/dex/DexManager;->reconcileSecondaryDexFiles(Ljava/lang/String;)V

    .line 10546
    return-void
.end method

.method public registerDexModule(Ljava/lang/String;Ljava/lang/String;ZLandroid/content/pm/IDexModuleRegisterCallback;)V
    .registers 10
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "dexModulePath"  # Ljava/lang/String;
    .param p3, "isSharedModule"  # Z
    .param p4, "callback"  # Landroid/content/pm/IDexModuleRegisterCallback;

    .line 10346
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    .line 10347
    .local v0, "userId":I
    const/4 v1, 0x0

    invoke-virtual {p0, p1, v1, v0}, Lcom/android/server/pm/PackageManagerService;->getApplicationInfo(Ljava/lang/String;II)Landroid/content/pm/ApplicationInfo;

    move-result-object v2

    .line 10349
    .local v2, "ai":Landroid/content/pm/ApplicationInfo;
    if-nez v2, :cond_32

    .line 10350
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Registering a dex module for a package that does not exist for the calling user. package="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, ", user="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10352
    new-instance v3, Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;

    const-string v4, "Package not installed"

    invoke-direct {v3, v1, v4}, Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;-><init>(ZLjava/lang/String;)V

    move-object v1, v3

    .local v1, "result":Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;
    goto :goto_38

    .line 10354
    .end local v1  # "result":Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;
    :cond_32
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    invoke-virtual {v1, v2, p2, p3, v0}, Lcom/android/server/pm/dex/DexManager;->registerDexModule(Landroid/content/pm/ApplicationInfo;Ljava/lang/String;ZI)Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;

    move-result-object v1

    .line 10357
    .restart local v1  # "result":Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;
    :goto_38
    if-eqz p4, :cond_44

    .line 10358
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v4, Lcom/android/server/pm/-$$Lambda$PackageManagerService$opO5L-t6aW9gAx6B5CGlW6sAaX8;

    invoke-direct {v4, p4, p2, v1}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$opO5L-t6aW9gAx6B5CGlW6sAaX8;-><init>(Landroid/content/pm/IDexModuleRegisterCallback;Ljava/lang/String;Lcom/android/server/pm/dex/DexManager$RegisterDexModuleResult;)V

    invoke-virtual {v3, v4}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 10366
    :cond_44
    return-void
.end method

.method public registerMoveCallback(Landroid/content/pm/IPackageMoveObserver;)V
    .registers 5
    .param p1, "callback"  # Landroid/content/pm/IPackageMoveObserver;

    .line 24593
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.MOUNT_UNMOUNT_FILESYSTEMS"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 24595
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;->register(Landroid/content/pm/IPackageMoveObserver;)V

    .line 24596
    return-void
.end method

.method removeCodePathLI(Ljava/io/File;)V
    .registers 5
    .param p1, "codePath"  # Ljava/io/File;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mInstallLock"
        }
    .end annotation

    .line 10767
    invoke-virtual {p1}, Ljava/io/File;->isDirectory()Z

    move-result v0

    if-eqz v0, :cond_19

    .line 10769
    :try_start_6
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {p1}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Lcom/android/server/pm/Installer;->rmPackageDir(Ljava/lang/String;)V
    :try_end_f
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_6 .. :try_end_f} :catch_10

    goto :goto_18

    .line 10770
    :catch_10
    move-exception v0

    .line 10771
    .local v0, "e":Lcom/android/server/pm/Installer$InstallerException;
    const-string v1, "PackageManager"

    const-string v2, "Failed to remove code path"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10772
    .end local v0  # "e":Lcom/android/server/pm/Installer$InstallerException;
    :goto_18
    goto :goto_1c

    .line 10774
    :cond_19
    invoke-virtual {p1}, Ljava/io/File;->delete()Z

    .line 10776
    :goto_1c
    return-void
.end method

.method removeDexFiles(Ljava/util/List;[Ljava/lang/String;)V
    .registers 10
    .param p2, "instructionSets"  # [Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;[",
            "Ljava/lang/String;",
            ")V"
        }
    .end annotation

    .line 16364
    .local p1, "allCodePaths":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    invoke-interface {p1}, Ljava/util/List;->isEmpty()Z

    move-result v0

    if-nez v0, :cond_36

    .line 16365
    if-eqz p2, :cond_2d

    .line 16368
    invoke-static {p2}, Lcom/android/server/pm/InstructionSets;->getDexCodeInstructionSets([Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v0

    .line 16369
    .local v0, "dexCodeInstructionSets":[Ljava/lang/String;
    invoke-interface {p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_10
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_36

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/String;

    .line 16370
    .local v2, "codePath":Ljava/lang/String;
    array-length v3, v0

    const/4 v4, 0x0

    :goto_1e
    if-ge v4, v3, :cond_2c

    aget-object v5, v0, v4

    .line 16372
    .local v5, "dexCodeInstructionSet":Ljava/lang/String;
    :try_start_22
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-virtual {v6, v2, v5}, Lcom/android/server/pm/Installer;->rmdex(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_27
    .catch Lcom/android/server/pm/Installer$InstallerException; {:try_start_22 .. :try_end_27} :catch_28

    .line 16374
    goto :goto_29

    .line 16373
    :catch_28
    move-exception v6

    .line 16370
    .end local v5  # "dexCodeInstructionSet":Ljava/lang/String;
    :goto_29
    add-int/lit8 v4, v4, 0x1

    goto :goto_1e

    .line 16376
    .end local v2  # "codePath":Ljava/lang/String;
    :cond_2c
    goto :goto_10

    .line 16366
    .end local v0  # "dexCodeInstructionSets":[Ljava/lang/String;
    :cond_2d
    new-instance v0, Ljava/lang/IllegalStateException;

    const-string/jumbo v1, "instructionSet == null"

    invoke-direct {v0, v1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 16378
    :cond_36
    return-void
.end method

.method removeInstalledPackageLI(Landroid/content/pm/PackageParser$Package;Z)V
    .registers 9
    .param p1, "pkg"  # Landroid/content/pm/PackageParser$Package;
    .param p2, "chatty"  # Z

    .line 13400
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_20

    .line 13401
    if-eqz p2, :cond_20

    .line 13402
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Removing package "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 13406
    :cond_20
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 13408
    :try_start_23
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v2, p1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 13409
    invoke-virtual {p0, p1, p2}, Lcom/android/server/pm/PackageManagerService;->cleanPackageDataStructuresLILPw(Landroid/content/pm/PackageParser$Package;Z)V

    .line 13412
    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    if-eqz v1, :cond_3a

    iget-object v1, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    goto :goto_3b

    :cond_3a
    const/4 v1, 0x0

    .line 13413
    .local v1, "childCount":I
    :goto_3b
    const/4 v2, 0x0

    .local v2, "i":I
    :goto_3c
    if-ge v2, v1, :cond_55

    .line 13414
    iget-object v3, p1, Landroid/content/pm/PackageParser$Package;->childPackages:Ljava/util/ArrayList;

    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 13415
    .local v3, "childPkg":Landroid/content/pm/PackageParser$Package;
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v5, v3, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 13416
    invoke-virtual {p0, v3, p2}, Lcom/android/server/pm/PackageManagerService;->cleanPackageDataStructuresLILPw(Landroid/content/pm/PackageParser$Package;Z)V

    .line 13413
    .end local v3  # "childPkg":Landroid/content/pm/PackageParser$Package;
    add-int/lit8 v2, v2, 0x1

    goto :goto_3c

    .line 13418
    .end local v1  # "childCount":I
    .end local v2  # "i":I
    :cond_55
    monitor-exit v0

    .line 13419
    return-void

    .line 13418
    :catchall_57
    move-exception v1

    monitor-exit v0
    :try_end_59
    .catchall {:try_start_23 .. :try_end_59} :catchall_57

    throw v1
.end method

.method public removeOnPermissionsChangeListener(Landroid/content/pm/IOnPermissionsChangeListener;)V
    .registers 4
    .param p1, "listener"  # Landroid/content/pm/IOnPermissionsChangeListener;

    .line 6368
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-nez v0, :cond_17

    .line 6371
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 6372
    :try_start_d
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mOnPermissionChangeListeners:Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;

    invoke-virtual {v1, p1}, Lcom/android/server/pm/PackageManagerService$OnPermissionChangeListeners;->removeListenerLocked(Landroid/content/pm/IOnPermissionsChangeListener;)V

    .line 6373
    monitor-exit v0

    .line 6374
    return-void

    .line 6373
    :catchall_14
    move-exception v1

    monitor-exit v0
    :try_end_16
    .catchall {:try_start_d .. :try_end_16} :catchall_14

    throw v1

    .line 6369
    :cond_17
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Instant applications don\'t have access to this method"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method removePackageLI(Ljava/lang/String;Z)V
    .registers 5
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "chatty"  # Z

    .line 13385
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_INSTALL:Z

    if-eqz v0, :cond_1c

    .line 13386
    if-eqz p2, :cond_1c

    .line 13387
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Removing package "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 13391
    :cond_1c
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 13392
    :try_start_1f
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 13393
    .local v1, "removedPackage":Landroid/content/pm/PackageParser$Package;
    if-eqz v1, :cond_2c

    .line 13394
    invoke-virtual {p0, v1, p2}, Lcom/android/server/pm/PackageManagerService;->cleanPackageDataStructuresLILPw(Landroid/content/pm/PackageParser$Package;Z)V

    .line 13396
    .end local v1  # "removedPackage":Landroid/content/pm/PackageParser$Package;
    :cond_2c
    monitor-exit v0

    .line 13397
    return-void

    .line 13396
    :catchall_2e
    move-exception v1

    monitor-exit v0
    :try_end_30
    .catchall {:try_start_1f .. :try_end_30} :catchall_2e

    throw v1
.end method

.method public removePermission(Ljava/lang/String;)V
    .registers 5
    .param p1, "permName"  # Ljava/lang/String;

    .line 5982
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v1

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    invoke-virtual {v0, p1, v1, v2}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->removeDynamicPermission(Ljava/lang/String;ILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 5983
    return-void
.end method

.method public removeWhitelistedRestrictedPermission(Ljava/lang/String;Ljava/lang/String;II)Z
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "permission"  # Ljava/lang/String;
    .param p3, "whitelistFlags"  # I
    .param p4, "userId"  # I

    .line 6206
    invoke-static {p2}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6208
    invoke-direct {p0, p2}, Lcom/android/server/pm/PackageManagerService;->checkExistsAndEnforceCannotModifyImmutablyRestrictedPermission(Ljava/lang/String;)Z

    move-result v0

    const/4 v1, 0x0

    if-nez v0, :cond_b

    .line 6209
    return v1

    .line 6212
    :cond_b
    invoke-virtual {p0, p1, p3, p4}, Lcom/android/server/pm/PackageManagerService;->getWhitelistedRestrictedPermissions(Ljava/lang/String;II)Ljava/util/List;

    move-result-object v0

    .line 6214
    .local v0, "permissions":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v0, :cond_1c

    invoke-interface {v0, p2}, Ljava/util/List;->remove(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_1c

    .line 6215
    invoke-direct {p0, p1, v0, p3, p4}, Lcom/android/server/pm/PackageManagerService;->setWhitelistedRestrictedPermissions(Ljava/lang/String;Ljava/util/List;II)Z

    move-result v1

    return v1

    .line 6218
    :cond_1c
    return v1
.end method

.method public replacePreferredActivity(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;I)V
    .registers 21
    .param p1, "filter"  # Landroid/content/IntentFilter;
    .param p2, "match"  # I
    .param p3, "set"  # [Landroid/content/ComponentName;
    .param p4, "activity"  # Landroid/content/ComponentName;
    .param p5, "userId"  # I

    .line 21177
    move-object v9, p0

    move-object/from16 v10, p1

    move/from16 v11, p5

    invoke-virtual/range {p1 .. p1}, Landroid/content/IntentFilter;->countActions()I

    move-result v0

    const/4 v7, 0x1

    if-ne v0, v7, :cond_274

    .line 21181
    invoke-virtual/range {p1 .. p1}, Landroid/content/IntentFilter;->countDataAuthorities()I

    move-result v0

    if-nez v0, :cond_267

    .line 21182
    invoke-virtual/range {p1 .. p1}, Landroid/content/IntentFilter;->countDataPaths()I

    move-result v0

    if-nez v0, :cond_262

    .line 21183
    invoke-virtual/range {p1 .. p1}, Landroid/content/IntentFilter;->countDataSchemes()I

    move-result v0

    if-gt v0, v7, :cond_25d

    .line 21184
    invoke-virtual/range {p1 .. p1}, Landroid/content/IntentFilter;->countDataTypes()I

    move-result v0

    if-nez v0, :cond_258

    .line 21190
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v12

    .line 21191
    .local v12, "callingUid":I
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v4, 0x1

    const/4 v5, 0x0

    const-string/jumbo v6, "replace preferred activity"

    move v2, v12

    move/from16 v3, p5

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 21194
    iget-object v0, v9, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.SET_PREFERRED_APPLICATIONS"

    invoke-virtual {v0, v1}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_73

    .line 21197
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 21198
    :try_start_42
    invoke-direct {p0, v12}, Lcom/android/server/pm/PackageManagerService;->getUidTargetSdkVersionLockedLPr(I)I

    move-result v0

    const/16 v2, 0x8

    if-ge v0, v2, :cond_66

    .line 21200
    const-string v0, "PackageManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Ignoring replacePreferredActivity() from uid "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 21201
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 21200
    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 21202
    monitor-exit v1

    return-void

    .line 21204
    :cond_66
    monitor-exit v1
    :try_end_67
    .catchall {:try_start_42 .. :try_end_67} :catchall_70

    .line 21205
    iget-object v0, v9, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const/4 v1, 0x0

    const-string v2, "android.permission.SET_PREFERRED_APPLICATIONS"

    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_73

    .line 21204
    :catchall_70
    move-exception v0

    :try_start_71
    monitor-exit v1
    :try_end_72
    .catchall {:try_start_71 .. :try_end_72} :catchall_70

    throw v0

    .line 21209
    :cond_73
    :goto_73
    iget-object v1, v9, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 21210
    :try_start_76
    iget-object v0, v9, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v0, v11}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PreferredIntentResolver;

    .line 21211
    .local v0, "pir":Lcom/android/server/pm/PreferredIntentResolver;
    if-eqz v0, :cond_238

    .line 21213
    invoke-virtual {v0, v10}, Lcom/android/server/pm/PreferredIntentResolver;->findFilters(Landroid/content/IntentFilter;)Ljava/util/ArrayList;

    move-result-object v2

    .line 21214
    .local v2, "existing":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PreferredActivity;>;"
    const/4 v3, 0x4

    if-eqz v2, :cond_1c6

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v4

    if-ne v4, v7, :cond_1c6

    .line 21215
    const/4 v4, 0x0

    invoke-virtual {v2, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PreferredActivity;

    .line 21216
    .local v4, "cur":Lcom/android/server/pm/PreferredActivity;
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    const/high16 v6, 0xfff0000

    if-eqz v5, :cond_15c

    .line 21217
    const-string v5, "PackageManager"

    const-string v8, "Checking replace of preferred:"

    invoke-static {v5, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21218
    new-instance v5, Landroid/util/LogPrinter;

    const-string v8, "PackageManager"

    invoke-direct {v5, v3, v8}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;)V

    const-string v8, "  "

    invoke-virtual {v10, v5, v8}, Landroid/content/IntentFilter;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 21219
    iget-object v5, v4, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-boolean v5, v5, Lcom/android/server/pm/PreferredComponent;->mAlways:Z

    if-nez v5, :cond_be

    .line 21220
    const-string v5, "PackageManager"

    const-string v8, "  -- CUR; not mAlways!"

    invoke-static {v5, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    goto/16 :goto_15c

    .line 21222
    :cond_be
    const-string v5, "PackageManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "  -- CUR: mMatch="

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v4, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget v13, v13, Lcom/android/server/pm/PreferredComponent;->mMatch:I

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v5, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21223
    const-string v5, "PackageManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "  -- CUR: mSet="

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v4, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v13, v13, Lcom/android/server/pm/PreferredComponent;->mSetComponents:[Ljava/lang/String;

    .line 21224
    invoke-static {v13}, Ljava/util/Arrays;->toString([Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v13

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    .line 21223
    invoke-static {v5, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21225
    const-string v5, "PackageManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "  -- CUR: mComponent="

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v4, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v13, v13, Lcom/android/server/pm/PreferredComponent;->mShortComponent:Ljava/lang/String;

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v5, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21226
    const-string v5, "PackageManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "  -- NEW: mMatch="

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    and-int v13, p2, v6

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v5, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21228
    const-string v5, "PackageManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "  -- CUR: mSet="

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-static/range {p3 .. p3}, Ljava/util/Arrays;->toString([Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v13

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v5, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21229
    const-string v5, "PackageManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "  -- CUR: mComponent="

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual/range {p4 .. p4}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {v8, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v5, v8}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21232
    :cond_15c
    :goto_15c
    iget-object v5, v4, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-boolean v5, v5, Lcom/android/server/pm/PreferredComponent;->mAlways:Z

    if-eqz v5, :cond_1c1

    iget-object v5, v4, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v5, v5, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;
    :try_end_166
    .catchall {:try_start_76 .. :try_end_166} :catchall_24f

    move-object/from16 v13, p4

    :try_start_168
    invoke-virtual {v5, v13}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_1b9

    iget-object v5, v4, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget v5, v5, Lcom/android/server/pm/PreferredComponent;->mMatch:I

    and-int v6, p2, v6

    if-ne v5, v6, :cond_1b9

    iget-object v5, v4, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;
    :try_end_178
    .catchall {:try_start_168 .. :try_end_178} :catchall_1bc

    .line 21234
    move-object/from16 v14, p3

    :try_start_17a
    invoke-virtual {v5, v14}, Lcom/android/server/pm/PreferredComponent;->sameSet([Landroid/content/ComponentName;)Z

    move-result v5

    if-eqz v5, :cond_1ca

    .line 21236
    sget-boolean v5, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v5, :cond_1b7

    .line 21237
    const-string v5, "PackageManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Replacing with same preferred activity "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v4, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v7, v7, Lcom/android/server/pm/PreferredComponent;->mShortComponent:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " for user "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21240
    new-instance v5, Landroid/util/LogPrinter;

    const-string v6, "PackageManager"

    invoke-direct {v5, v3, v6}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;)V

    const-string v3, "  "

    invoke-virtual {v10, v5, v3}, Landroid/content/IntentFilter;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 21242
    :cond_1b7
    monitor-exit v1

    return-void

    .line 21232
    :cond_1b9
    move-object/from16 v14, p3

    goto :goto_1ca

    .line 21261
    .end local v0  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    .end local v2  # "existing":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PreferredActivity;>;"
    .end local v4  # "cur":Lcom/android/server/pm/PreferredActivity;
    :catchall_1bc
    move-exception v0

    move-object/from16 v14, p3

    goto/16 :goto_254

    .line 21232
    .restart local v0  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    .restart local v2  # "existing":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PreferredActivity;>;"
    .restart local v4  # "cur":Lcom/android/server/pm/PreferredActivity;
    :cond_1c1
    move-object/from16 v14, p3

    move-object/from16 v13, p4

    goto :goto_1ca

    .line 21214
    .end local v4  # "cur":Lcom/android/server/pm/PreferredActivity;
    :cond_1c6
    move-object/from16 v14, p3

    move-object/from16 v13, p4

    .line 21245
    :cond_1ca
    :goto_1ca
    if-eqz v2, :cond_23c

    .line 21246
    sget-boolean v4, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v4, :cond_1f6

    .line 21247
    const-string v4, "PackageManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, " existing preferred matches for:"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21248
    new-instance v4, Landroid/util/LogPrinter;

    const-string v5, "PackageManager"

    invoke-direct {v4, v3, v5}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;)V

    const-string v5, "  "

    invoke-virtual {v10, v4, v5}, Landroid/content/IntentFilter;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 21250
    :cond_1f6
    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v4

    sub-int/2addr v4, v7

    .local v4, "i":I
    :goto_1fb
    if-ltz v4, :cond_23c

    .line 21251
    invoke-virtual {v2, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PreferredActivity;

    .line 21252
    .local v5, "pa":Lcom/android/server/pm/PreferredActivity;
    sget-boolean v6, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v6, :cond_232

    .line 21253
    const-string v6, "PackageManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Removing existing preferred activity "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v8, v5, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v8, v8, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v8, ":"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 21255
    new-instance v6, Landroid/util/LogPrinter;

    const-string v7, "PackageManager"

    invoke-direct {v6, v3, v7}, Landroid/util/LogPrinter;-><init>(ILjava/lang/String;)V

    const-string v7, "  "

    invoke-virtual {v5, v6, v7}, Lcom/android/server/pm/PreferredActivity;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 21257
    :cond_232
    invoke-virtual {v0, v5}, Lcom/android/server/pm/PreferredIntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 21250
    .end local v5  # "pa":Lcom/android/server/pm/PreferredActivity;
    add-int/lit8 v4, v4, -0x1

    goto :goto_1fb

    .line 21211
    .end local v2  # "existing":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PreferredActivity;>;"
    .end local v4  # "i":I
    :cond_238
    move-object/from16 v14, p3

    move-object/from16 v13, p4

    .line 21261
    .end local v0  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    :cond_23c
    monitor-exit v1
    :try_end_23d
    .catchall {:try_start_17a .. :try_end_23d} :catchall_256

    .line 21262
    const/4 v6, 0x1

    const-string v8, "Replacing preferred"

    move-object v1, p0

    move-object/from16 v2, p1

    move/from16 v3, p2

    move-object/from16 v4, p3

    move-object/from16 v5, p4

    move/from16 v7, p5

    invoke-direct/range {v1 .. v8}, Lcom/android/server/pm/PackageManagerService;->addPreferredActivityInternal(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;ZILjava/lang/String;)V

    .line 21264
    return-void

    .line 21261
    :catchall_24f
    move-exception v0

    move-object/from16 v14, p3

    move-object/from16 v13, p4

    :goto_254
    :try_start_254
    monitor-exit v1
    :try_end_255
    .catchall {:try_start_254 .. :try_end_255} :catchall_256

    throw v0

    :catchall_256
    move-exception v0

    goto :goto_254

    .line 21184
    .end local v12  # "callingUid":I
    :cond_258
    move-object/from16 v14, p3

    move-object/from16 v13, p4

    goto :goto_26b

    .line 21183
    :cond_25d
    move-object/from16 v14, p3

    move-object/from16 v13, p4

    goto :goto_26b

    .line 21182
    :cond_262
    move-object/from16 v14, p3

    move-object/from16 v13, p4

    goto :goto_26b

    .line 21181
    :cond_267
    move-object/from16 v14, p3

    move-object/from16 v13, p4

    .line 21185
    :goto_26b
    new-instance v0, Ljava/lang/IllegalArgumentException;

    const-string/jumbo v1, "replacePreferredActivity expects filter to have no data authorities, paths, or types; and at most one scheme."

    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 21178
    :cond_274
    move-object/from16 v14, p3

    move-object/from16 v13, p4

    new-instance v0, Ljava/lang/IllegalArgumentException;

    const-string/jumbo v1, "replacePreferredActivity expects filter to have only 1 action."

    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public resetApplicationPreferences(I)V
    .registers 8
    .param p1, "userId"  # I

    .line 21389
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const/4 v1, 0x0

    const-string v2, "android.permission.SET_PREFERRED_APPLICATIONS"

    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 21391
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 21394
    .local v2, "identity":J
    :try_start_c
    new-instance v0, Landroid/util/SparseBooleanArray;

    invoke-direct {v0}, Landroid/util/SparseBooleanArray;-><init>()V

    .line 21395
    .local v0, "changedUsers":Landroid/util/SparseBooleanArray;
    invoke-direct {p0, v1, v0, p1}, Lcom/android/server/pm/PackageManagerService;->clearPackagePreferredActivitiesLPw(Ljava/lang/String;Landroid/util/SparseBooleanArray;I)V

    .line 21396
    invoke-virtual {v0}, Landroid/util/SparseBooleanArray;->size()I

    move-result v4

    if-lez v4, :cond_1d

    .line 21397
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->postPreferredActivityChangedBroadcast(I)V

    .line 21399
    :cond_1d
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v4
    :try_end_20
    .catchall {:try_start_c .. :try_end_20} :catchall_4a

    .line 21400
    :try_start_20
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v5, p1}, Lcom/android/server/pm/Settings;->applyDefaultPreferredAppsLPw(I)V

    .line 21401
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->clearIntentFilterVerificationsLPw(I)V

    .line 21402
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->primeDomainVerificationsLPw(I)V

    .line 21403
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->resetUserChangesToRuntimePermissionsAndFlagsLPw(I)V

    .line 21404
    monitor-exit v4
    :try_end_2f
    .catchall {:try_start_20 .. :try_end_2f} :catchall_47

    .line 21405
    :try_start_2f
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->updateDefaultHomeNotLocked(I)Z

    .line 21410
    invoke-virtual {p0, v1, p1}, Lcom/android/server/pm/PackageManagerService;->setDefaultBrowserPackageName(Ljava/lang/String;I)Z

    .line 21411
    invoke-direct {p0, p1}, Lcom/android/server/pm/PackageManagerService;->resetNetworkPolicies(I)V

    .line 21412
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1
    :try_end_3b
    .catchall {:try_start_2f .. :try_end_3b} :catchall_4a

    .line 21413
    :try_start_3b
    invoke-virtual {p0, p1}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 21414
    monitor-exit v1
    :try_end_3f
    .catchall {:try_start_3b .. :try_end_3f} :catchall_44

    .line 21416
    .end local v0  # "changedUsers":Landroid/util/SparseBooleanArray;
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 21417
    nop

    .line 21418
    return-void

    .line 21414
    .restart local v0  # "changedUsers":Landroid/util/SparseBooleanArray;
    :catchall_44
    move-exception v4

    :try_start_45
    monitor-exit v1
    :try_end_46
    .catchall {:try_start_45 .. :try_end_46} :catchall_44

    .end local v2  # "identity":J
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "userId":I
    :try_start_46
    throw v4
    :try_end_47
    .catchall {:try_start_46 .. :try_end_47} :catchall_4a

    .line 21404
    .restart local v2  # "identity":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "userId":I
    :catchall_47
    move-exception v1

    :try_start_48
    monitor-exit v4
    :try_end_49
    .catchall {:try_start_48 .. :try_end_49} :catchall_47

    .end local v2  # "identity":J
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "userId":I
    :try_start_49
    throw v1
    :try_end_4a
    .catchall {:try_start_49 .. :try_end_4a} :catchall_4a

    .line 21416
    .end local v0  # "changedUsers":Landroid/util/SparseBooleanArray;
    .restart local v2  # "identity":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "userId":I
    :catchall_4a
    move-exception v0

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0
.end method

.method public resetRuntimePermissions()V
    .registers 11

    .line 6007
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.REVOKE_RUNTIME_PERMISSIONS"

    const-string/jumbo v2, "revokeRuntimePermission"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6011
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 6012
    .local v0, "callingUid":I
    const/16 v1, 0x3e8

    if-eq v0, v1, :cond_1e

    if-eqz v0, :cond_1e

    .line 6013
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v2, "android.permission.INTERACT_ACROSS_USERS_FULL"

    const-string/jumbo v3, "resetRuntimePermissions"

    invoke-virtual {v1, v2, v3}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6018
    :cond_1e
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 6019
    :try_start_21
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    sget-object v3, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 6020
    invoke-virtual {v4}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v4

    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 6019
    const/4 v6, 0x0

    invoke-virtual {v2, v3, v6, v4, v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updateAllPermissions(Ljava/lang/String;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 6022
    invoke-static {}, Lcom/android/server/pm/UserManagerService;->getInstance()Lcom/android/server/pm/UserManagerService;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v2

    array-length v3, v2

    :goto_3a
    if-ge v6, v3, :cond_63

    aget v4, v2, v6

    .line 6023
    .local v4, "userId":I
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v5}, Landroid/util/ArrayMap;->size()I

    move-result v5

    .line 6024
    .local v5, "packageCount":I
    const/4 v7, 0x0

    .local v7, "i":I
    :goto_45
    if-ge v7, v5, :cond_60

    .line 6025
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v8, v7}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/pm/PackageParser$Package;

    .line 6026
    .local v8, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v9, v8, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    instance-of v9, v9, Lcom/android/server/pm/PackageSetting;

    if-nez v9, :cond_56

    .line 6027
    goto :goto_5d

    .line 6029
    :cond_56
    iget-object v9, v8, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v9, Lcom/android/server/pm/PackageSetting;

    .line 6030
    .local v9, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {p0, v9, v4}, Lcom/android/server/pm/PackageManagerService;->resetUserChangesToRuntimePermissionsAndFlagsLPw(Lcom/android/server/pm/PackageSetting;I)V

    .line 6024
    .end local v8  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v9  # "ps":Lcom/android/server/pm/PackageSetting;
    :goto_5d
    add-int/lit8 v7, v7, 0x1

    goto :goto_45

    .line 6022
    .end local v4  # "userId":I
    .end local v5  # "packageCount":I
    .end local v7  # "i":I
    :cond_60
    add-int/lit8 v6, v6, 0x1

    goto :goto_3a

    .line 6033
    :cond_63
    monitor-exit v1

    .line 6034
    return-void

    .line 6033
    :catchall_65
    move-exception v2

    monitor-exit v1
    :try_end_67
    .catchall {:try_start_21 .. :try_end_67} :catchall_65

    throw v2
.end method

.method public resetVersion(Ljava/lang/String;)V
    .registers 12
    .param p1, "pkgName"  # Ljava/lang/String;

    .line 26748
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    iget-object v0, v0, Lcom/android/server/pm/PackageDefaultOpService;->mPackages:Ljava/util/HashMap;

    invoke-virtual {v0, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageDefaultOpService$Op;

    .line 26749
    .local v0, "pkg":Lcom/android/server/pm/PackageDefaultOpService$Op;
    if-eqz v0, :cond_12a

    .line 26750
    const/4 v1, 0x1

    iput-boolean v1, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->activate:Z

    .line 26752
    const/4 v1, 0x0

    invoke-virtual {p0, p1, v1}, Lcom/android/server/pm/PackageManagerService;->getPackageInfoForVersion(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;

    move-result-object v1

    .line 26753
    .local v1, "pkgInfo":Landroid/content/pm/PackageInfo;
    if-eqz v1, :cond_1a

    .line 26754
    iget v2, v1, Landroid/content/pm/PackageInfo;->versionCode:I

    iput v2, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    .line 26756
    :cond_1a
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 26757
    :try_start_1d
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    iget-object v4, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/PackageParser$Package;

    .line 26758
    .local v3, "p":Landroid/content/pm/PackageParser$Package;
    if-nez v3, :cond_2b

    .line 26759
    monitor-exit v2

    return-void

    .line 26761
    :cond_2b
    const-string v4, "PackageDefaultOp"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v6, "resetVersion "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, ": "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v6, " pkg : "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->uid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, "  "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, "  "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->newVersion:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, " "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26765
    iget v4, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    iput v4, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    .line 26766
    const-string v4, "PackageDefaultOp"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v6, "resetVersion 1 "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v6, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " change version from "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v6, " to "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v6, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26769
    iget-object v4, v3, Landroid/content/pm/PackageParser$Package;->mExtras:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 26770
    .local v4, "extrasPs":Lcom/android/server/pm/PackageSetting;
    if-eqz v4, :cond_dd

    .line 26771
    iget v5, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    int-to-long v5, v5

    iput-wide v5, v4, Lcom/android/server/pm/PackageSetting;->versionCode:J

    .line 26772
    const-string v5, "PackageDefaultOp"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v7, "resetVersion 2 "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v7, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, " change version from "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v7, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v7, " to "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v7, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26777
    :cond_dd
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v5, v5, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    iget-object v6, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/PackageSetting;

    .line 26778
    .local v5, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v5, :cond_120

    .line 26779
    iget-object v6, v5, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 26780
    .local v6, "pkgser":Landroid/content/pm/PackageParser$Package;
    if-eqz v6, :cond_120

    .line 26781
    iget v7, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    iput v7, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    .line 26782
    const-string v7, "PackageDefaultOp"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v9, "resetVersion 3 "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v9, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->packageName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " change version from "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v9, v3, Landroid/content/pm/PackageParser$Package;->mVersionCode:I

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v9, " to "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget v9, v0, Lcom/android/server/pm/PackageDefaultOpService$Op;->oldVersion:I

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 26787
    .end local v3  # "p":Landroid/content/pm/PackageParser$Package;
    .end local v4  # "extrasPs":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v6  # "pkgser":Landroid/content/pm/PackageParser$Package;
    :cond_120
    monitor-exit v2
    :try_end_121
    .catchall {:try_start_1d .. :try_end_121} :catchall_127

    .line 26788
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDOS:Lcom/android/server/pm/PackageDefaultOpService;

    invoke-virtual {v2}, Lcom/android/server/pm/PackageDefaultOpService;->writeState()V

    goto :goto_12a

    .line 26787
    :catchall_127
    move-exception v3

    :try_start_128
    monitor-exit v2
    :try_end_129
    .catchall {:try_start_128 .. :try_end_129} :catchall_127

    throw v3

    .line 26790
    .end local v1  # "pkgInfo":Landroid/content/pm/PackageInfo;
    :cond_12a
    :goto_12a
    return-void
.end method

.method public resolveContentProvider(Ljava/lang/String;II)Landroid/content/pm/ProviderInfo;
    .registers 5
    .param p1, "name"  # Ljava/lang/String;
    .param p2, "flags"  # I
    .param p3, "userId"  # I

    .line 9328
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->resolveContentProviderInternal(Ljava/lang/String;II)Landroid/content/pm/ProviderInfo;

    move-result-object v0

    return-object v0
.end method

.method public resolveIntent(Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;
    .registers 12
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I

    .line 6835
    nop

    .line 6836
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 6835
    const/4 v5, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move v3, p3

    move v4, p4

    invoke-direct/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->resolveIntentInternal(Landroid/content/Intent;Ljava/lang/String;IIZI)Landroid/content/pm/ResolveInfo;

    move-result-object v0

    return-object v0
.end method

.method public resolveService(Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/pm/ResolveInfo;
    .registers 12
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "userId"  # I

    .line 8597
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 8598
    .local v6, "callingUid":I
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move v3, p3

    move v4, p4

    move v5, v6

    invoke-direct/range {v0 .. v5}, Lcom/android/server/pm/PackageManagerService;->resolveServiceInternal(Landroid/content/Intent;Ljava/lang/String;III)Landroid/content/pm/ResolveInfo;

    move-result-object v0

    return-object v0
.end method

.method public restoreDefaultApps([BI)V
    .registers 6
    .param p1, "backup"  # [B
    .param p2, "userId"  # I

    .line 21654
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_45

    .line 21659
    :try_start_8
    invoke-static {}, Landroid/util/Xml;->newPullParser()Lorg/xmlpull/v1/XmlPullParser;

    move-result-object v0

    .line 21660
    .local v0, "parser":Lorg/xmlpull/v1/XmlPullParser;
    new-instance v1, Ljava/io/ByteArrayInputStream;

    invoke-direct {v1, p1}, Ljava/io/ByteArrayInputStream;-><init>([B)V

    sget-object v2, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;

    invoke-virtual {v2}, Ljava/nio/charset/Charset;->name()Ljava/lang/String;

    move-result-object v2

    invoke-interface {v0, v1, v2}, Lorg/xmlpull/v1/XmlPullParser;->setInput(Ljava/io/InputStream;Ljava/lang/String;)V

    .line 21661
    const-string v1, "da"

    new-instance v2, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Pp4_btmBWcU4MSQGdxkevYH2ykk;

    invoke-direct {v2, p0}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Pp4_btmBWcU4MSQGdxkevYH2ykk;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    invoke-direct {p0, v0, p2, v1, v2}, Lcom/android/server/pm/PackageManagerService;->restoreFromXml(Lorg/xmlpull/v1/XmlPullParser;ILjava/lang/String;Lcom/android/server/pm/PackageManagerService$BlobXmlRestorer;)V
    :try_end_24
    .catch Ljava/lang/Exception; {:try_start_8 .. :try_end_24} :catch_25

    .line 21680
    .end local v0  # "parser":Lorg/xmlpull/v1/XmlPullParser;
    goto :goto_44

    .line 21676
    :catch_25
    move-exception v0

    .line 21677
    .local v0, "e":Ljava/lang/Exception;
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v1, :cond_44

    .line 21678
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Exception restoring default apps: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 21681
    .end local v0  # "e":Ljava/lang/Exception;
    :cond_44
    :goto_44
    return-void

    .line 21655
    :cond_45
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Only the system may call restoreDefaultApps()"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public restoreIntentFilterVerification([BI)V
    .registers 6
    .param p1, "backup"  # [B
    .param p2, "userId"  # I

    .line 21715
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_46

    .line 21720
    :try_start_8
    invoke-static {}, Landroid/util/Xml;->newPullParser()Lorg/xmlpull/v1/XmlPullParser;

    move-result-object v0

    .line 21721
    .local v0, "parser":Lorg/xmlpull/v1/XmlPullParser;
    new-instance v1, Ljava/io/ByteArrayInputStream;

    invoke-direct {v1, p1}, Ljava/io/ByteArrayInputStream;-><init>([B)V

    sget-object v2, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;

    invoke-virtual {v2}, Ljava/nio/charset/Charset;->name()Ljava/lang/String;

    move-result-object v2

    invoke-interface {v0, v1, v2}, Lorg/xmlpull/v1/XmlPullParser;->setInput(Ljava/io/InputStream;Ljava/lang/String;)V

    .line 21722
    const-string/jumbo v1, "iv"

    new-instance v2, Lcom/android/server/pm/-$$Lambda$PackageManagerService$0SKkmiMHwV7GtNKjt3VjlPFbtJU;

    invoke-direct {v2, p0}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$0SKkmiMHwV7GtNKjt3VjlPFbtJU;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    invoke-direct {p0, v0, p2, v1, v2}, Lcom/android/server/pm/PackageManagerService;->restoreFromXml(Lorg/xmlpull/v1/XmlPullParser;ILjava/lang/String;Lcom/android/server/pm/PackageManagerService$BlobXmlRestorer;)V
    :try_end_25
    .catch Ljava/lang/Exception; {:try_start_8 .. :try_end_25} :catch_26

    .line 21733
    .end local v0  # "parser":Lorg/xmlpull/v1/XmlPullParser;
    goto :goto_45

    .line 21729
    :catch_26
    move-exception v0

    .line 21730
    .local v0, "e":Ljava/lang/Exception;
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v1, :cond_45

    .line 21731
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Exception restoring preferred activities: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 21734
    .end local v0  # "e":Ljava/lang/Exception;
    :cond_45
    :goto_45
    return-void

    .line 21716
    :cond_46
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Only the system may call restorePreferredActivities()"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public restorePreferredActivities([BI)V
    .registers 6
    .param p1, "backup"  # [B
    .param p2, "userId"  # I

    .line 21596
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    const/16 v1, 0x3e8

    if-ne v0, v1, :cond_46

    .line 21601
    :try_start_8
    invoke-static {}, Landroid/util/Xml;->newPullParser()Lorg/xmlpull/v1/XmlPullParser;

    move-result-object v0

    .line 21602
    .local v0, "parser":Lorg/xmlpull/v1/XmlPullParser;
    new-instance v1, Ljava/io/ByteArrayInputStream;

    invoke-direct {v1, p1}, Ljava/io/ByteArrayInputStream;-><init>([B)V

    sget-object v2, Ljava/nio/charset/StandardCharsets;->UTF_8:Ljava/nio/charset/Charset;

    invoke-virtual {v2}, Ljava/nio/charset/Charset;->name()Ljava/lang/String;

    move-result-object v2

    invoke-interface {v0, v1, v2}, Lorg/xmlpull/v1/XmlPullParser;->setInput(Ljava/io/InputStream;Ljava/lang/String;)V

    .line 21603
    const-string/jumbo v1, "pa"

    new-instance v2, Lcom/android/server/pm/-$$Lambda$PackageManagerService$CFIaoUml0xnIO5ZwPO1dl9xEVgc;

    invoke-direct {v2, p0}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$CFIaoUml0xnIO5ZwPO1dl9xEVgc;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    invoke-direct {p0, v0, p2, v1, v2}, Lcom/android/server/pm/PackageManagerService;->restoreFromXml(Lorg/xmlpull/v1/XmlPullParser;ILjava/lang/String;Lcom/android/server/pm/PackageManagerService$BlobXmlRestorer;)V
    :try_end_25
    .catch Ljava/lang/Exception; {:try_start_8 .. :try_end_25} :catch_26

    .line 21614
    .end local v0  # "parser":Lorg/xmlpull/v1/XmlPullParser;
    goto :goto_45

    .line 21610
    :catch_26
    move-exception v0

    .line 21611
    .local v0, "e":Ljava/lang/Exception;
    sget-boolean v1, Lcom/android/server/pm/PackageManagerService;->DEBUG_BACKUP:Z

    if-eqz v1, :cond_45

    .line 21612
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Exception restoring preferred activities: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/Exception;->getMessage()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "PackageManager"

    invoke-static {v2, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 21615
    .end local v0  # "e":Ljava/lang/Exception;
    :cond_45
    :goto_45
    return-void

    .line 21597
    :cond_46
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Only the system may call restorePreferredActivities()"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public revokeDefaultPermissionsFromDisabledTelephonyDataServices([Ljava/lang/String;I)V
    .registers 5
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26160
    const-string/jumbo v0, "revokeDefaultPermissionsFromDisabledTelephonyDataServices"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrPhoneCaller(Ljava/lang/String;)V

    .line 26161
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26162
    :try_start_9
    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Wj5mb4brzWgOPLO1KKQ_kaMGbx4;

    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$Wj5mb4brzWgOPLO1KKQ_kaMGbx4;-><init>(Lcom/android/server/pm/PackageManagerService;[Ljava/lang/String;I)V

    invoke-static {v1}, Landroid/os/Binder;->withCleanCallingIdentity(Lcom/android/internal/util/FunctionalUtils$ThrowingRunnable;)V

    .line 26165
    monitor-exit v0

    .line 26166
    return-void

    .line 26165
    :catchall_13
    move-exception v1

    monitor-exit v0
    :try_end_15
    .catchall {:try_start_9 .. :try_end_15} :catchall_13

    throw v1
.end method

.method public revokeDefaultPermissionsFromLuiApps([Ljava/lang/String;I)V
    .registers 7
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "userId"  # I

    .line 26184
    const-string/jumbo v0, "revokeDefaultPermissionsFromLuiApps"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrPhoneCaller(Ljava/lang/String;)V

    .line 26185
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26186
    :try_start_9
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1
    :try_end_d
    .catchall {:try_start_9 .. :try_end_d} :catchall_1d

    .line 26188
    .local v1, "identity":J
    :try_start_d
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    invoke-virtual {v3, p1, p2}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->revokeDefaultPermissionsFromLuiApps([Ljava/lang/String;I)V
    :try_end_12
    .catchall {:try_start_d .. :try_end_12} :catchall_18

    .line 26190
    :try_start_12
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 26191
    nop

    .line 26192
    .end local v1  # "identity":J
    monitor-exit v0

    .line 26193
    return-void

    .line 26190
    .restart local v1  # "identity":J
    :catchall_18
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageNames":[Ljava/lang/String;
    .end local p2  # "userId":I
    throw v3

    .line 26192
    .end local v1  # "identity":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageNames":[Ljava/lang/String;
    .restart local p2  # "userId":I
    :catchall_1d
    move-exception v1

    monitor-exit v0
    :try_end_1f
    .catchall {:try_start_12 .. :try_end_1f} :catchall_1d

    throw v1
.end method

.method public revokeRuntimePermission(Ljava/lang/String;Ljava/lang/String;I)V
    .registers 11
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "permName"  # Ljava/lang/String;
    .param p3, "userId"  # I

    .line 5997
    nop

    .line 5998
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 5997
    const-string v1, "android.permission.ADJUST_RUNTIME_PERMISSIONS_POLICY"

    invoke-virtual {p0, v1, v0}, Lcom/android/server/pm/PackageManagerService;->checkUidPermission(Ljava/lang/String;I)I

    move-result v0

    if-nez v0, :cond_f

    const/4 v0, 0x1

    goto :goto_10

    :cond_f
    const/4 v0, 0x0

    :goto_10
    move v4, v0

    .line 6001
    .local v4, "overridePolicy":Z
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    move-object v2, p2

    move-object v3, p1

    move v5, p3

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->revokeRuntimePermission(Ljava/lang/String;Ljava/lang/String;ZILcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 6003
    return-void
.end method

.method public runBackgroundDexoptJob(Ljava/util/List;)Z
    .registers 5
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;)Z"
        }
    .end annotation

    .line 10559
    .local p1, "packageNames":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_c

    .line 10560
    const/4 v0, 0x0

    return v0

    .line 10562
    :cond_c
    const-string/jumbo v0, "runBackgroundDexoptJob"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrRootOrShell(Ljava/lang/String;)V

    .line 10563
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 10565
    .local v0, "identity":J
    :try_start_16
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-static {p0, v2, p1}, Lcom/android/server/pm/BackgroundDexOptService;->runIdleOptimizationsNow(Lcom/android/server/pm/PackageManagerService;Landroid/content/Context;Ljava/util/List;)Z

    move-result v2
    :try_end_1c
    .catchall {:try_start_16 .. :try_end_1c} :catchall_20

    .line 10567
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10565
    return v2

    .line 10567
    :catchall_20
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v2
.end method

.method scheduleWritePackageListLocked(I)V
    .registers 6
    .param p1, "userId"  # I

    .line 2375
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v1, 0x13

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->hasMessages(I)Z

    move-result v0

    if-nez v0, :cond_19

    .line 2376
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 2377
    .local v0, "msg":Landroid/os/Message;
    iput p1, v0, Landroid/os/Message;->arg1:I

    .line 2378
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const-wide/16 v2, 0x2710

    invoke-virtual {v1, v0, v2, v3}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2380
    .end local v0  # "msg":Landroid/os/Message;
    :cond_19
    return-void
.end method

.method scheduleWritePackageRestrictionsLocked(I)V
    .registers 10
    .param p1, "userId"  # I

    .line 2388
    const/4 v0, 0x0

    const/4 v1, -0x1

    if-ne p1, v1, :cond_b

    .line 2389
    sget-object v1, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v1

    goto :goto_10

    :cond_b
    const/4 v1, 0x1

    new-array v1, v1, [I

    aput p1, v1, v0

    .line 2390
    .local v1, "userIds":[I
    :goto_10
    array-length v2, v1

    :goto_11
    if-ge v0, v2, :cond_3b

    aget v3, v1, v0

    .line 2391
    .local v3, "nextUserId":I
    sget-object v4, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v4, v3}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v4

    if-nez v4, :cond_1e

    return-void

    .line 2392
    :cond_1e
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mDirtyUsers:Landroid/util/ArraySet;

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    invoke-virtual {v4, v5}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 2393
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v5, 0xe

    invoke-virtual {v4, v5}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->hasMessages(I)Z

    move-result v4

    if-nez v4, :cond_38

    .line 2394
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const-wide/16 v6, 0x2710

    invoke-virtual {v4, v5, v6, v7}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendEmptyMessageDelayed(IJ)Z

    .line 2390
    .end local v3  # "nextUserId":I
    :cond_38
    add-int/lit8 v0, v0, 0x1

    goto :goto_11

    .line 2397
    :cond_3b
    return-void
.end method

.method scheduleWritePackageRestrictionsLocked(Landroid/os/UserHandle;)V
    .registers 3
    .param p1, "user"  # Landroid/os/UserHandle;

    .line 2383
    if-nez p1, :cond_4

    const/4 v0, -0x1

    goto :goto_8

    :cond_4
    invoke-virtual {p1}, Landroid/os/UserHandle;->getIdentifier()I

    move-result v0

    .line 2384
    .local v0, "userId":I
    :goto_8
    invoke-virtual {p0, v0}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 2385
    return-void
.end method

.method scheduleWriteSettingsLocked()V
    .registers 5

    .line 2369
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v1, 0xd

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->hasMessages(I)Z

    move-result v0

    if-nez v0, :cond_11

    .line 2370
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const-wide/16 v2, 0x2710

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendEmptyMessageDelayed(IJ)Z

    .line 2372
    :cond_11
    return-void
.end method

.method public sendDeviceCustomizationReadyBroadcast()V
    .registers 20

    .line 26533
    move-object/from16 v1, p0

    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v2, "android.permission.SEND_DEVICE_CUSTOMIZATION_READY"

    const-string/jumbo v3, "sendDeviceCustomizationReadyBroadcast"

    invoke-virtual {v0, v2, v3}, Landroid/content/Context;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 26536
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 26538
    .local v2, "ident":J
    :try_start_10
    new-instance v0, Landroid/content/Intent;

    const-string v4, "android.intent.action.DEVICE_CUSTOMIZATION_READY"

    invoke-direct {v0, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    move-object v4, v0

    .line 26539
    .local v4, "intent":Landroid/content/Intent;
    const/high16 v0, 0x1000000

    invoke-virtual {v4, v0}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 26540
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v5

    .line 26541
    .local v5, "am":Landroid/app/IActivityManager;
    const-string v0, "android.permission.RECEIVE_DEVICE_CUSTOMIZATION_READY"

    filled-new-array {v0}, [Ljava/lang/String;

    move-result-object v13
    :try_end_27
    .catchall {:try_start_10 .. :try_end_27} :catchall_47

    .line 26545
    .local v13, "requiredPermissions":[Ljava/lang/String;
    const/4 v6, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v14, -0x1

    const/4 v15, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, -0x1

    move-object v7, v4

    :try_start_36
    invoke-interface/range {v5 .. v18}, Landroid/app/IActivityManager;->broadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;[Ljava/lang/String;ILandroid/os/Bundle;ZZI)I
    :try_end_39
    .catch Landroid/os/RemoteException; {:try_start_36 .. :try_end_39} :catch_3f
    .catchall {:try_start_36 .. :try_end_39} :catchall_47

    .line 26549
    nop

    .line 26551
    .end local v4  # "intent":Landroid/content/Intent;
    .end local v5  # "am":Landroid/app/IActivityManager;
    .end local v13  # "requiredPermissions":[Ljava/lang/String;
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 26552
    nop

    .line 26553
    return-void

    .line 26547
    .restart local v4  # "intent":Landroid/content/Intent;
    .restart local v5  # "am":Landroid/app/IActivityManager;
    .restart local v13  # "requiredPermissions":[Ljava/lang/String;
    :catch_3f
    move-exception v0

    move-object v6, v0

    move-object v0, v6

    .line 26548
    .local v0, "e":Landroid/os/RemoteException;
    :try_start_42
    invoke-virtual {v0}, Landroid/os/RemoteException;->rethrowFromSystemServer()Ljava/lang/RuntimeException;

    move-result-object v6

    .end local v2  # "ident":J
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    throw v6
    :try_end_47
    .catchall {:try_start_42 .. :try_end_47} :catchall_47

    .line 26551
    .end local v0  # "e":Landroid/os/RemoteException;
    .end local v4  # "intent":Landroid/content/Intent;
    .end local v5  # "am":Landroid/app/IActivityManager;
    .end local v13  # "requiredPermissions":[Ljava/lang/String;
    .restart local v2  # "ident":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    :catchall_47
    move-exception v0

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0
.end method

.method public sendPackageAddedForNewUsers(Ljava/lang/String;ZZI[I[I)V
    .registers 21
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "sendBootCompleted"  # Z
    .param p3, "includeStopped"  # Z
    .param p4, "appId"  # I
    .param p5, "userIds"  # [I
    .param p6, "instantUserIds"  # [I

    .line 13729
    move-object v9, p0

    move-object/from16 v10, p5

    invoke-static/range {p5 .. p5}, Lcom/android/internal/util/ArrayUtils;->isEmpty([I)Z

    move-result v0

    if-eqz v0, :cond_10

    invoke-static/range {p6 .. p6}, Lcom/android/internal/util/ArrayUtils;->isEmpty([I)Z

    move-result v0

    if-eqz v0, :cond_10

    .line 13730
    return-void

    .line 13732
    :cond_10
    new-instance v0, Landroid/os/Bundle;

    const/4 v1, 0x1

    invoke-direct {v0, v1}, Landroid/os/Bundle;-><init>(I)V

    move-object v11, v0

    .line 13735
    .local v11, "extras":Landroid/os/Bundle;
    invoke-static/range {p5 .. p5}, Lcom/android/internal/util/ArrayUtils;->isEmpty([I)Z

    move-result v0

    const/4 v1, 0x0

    if-eqz v0, :cond_21

    aget v0, p6, v1

    goto :goto_23

    :cond_21
    aget v0, v10, v1

    .line 13734
    :goto_23
    move/from16 v12, p4

    invoke-static {v0, v12}, Landroid/os/UserHandle;->getUid(II)I

    move-result v13

    .line 13736
    .local v13, "uid":I
    const-string v0, "android.intent.extra.UID"

    invoke-virtual {v11, v0, v13}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V

    .line 13738
    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v6, 0x0

    const-string v1, "android.intent.action.PACKAGE_ADDED"

    move-object v0, p0

    move-object v2, p1

    move-object v3, v11

    move-object/from16 v7, p5

    move-object/from16 v8, p6

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/pm/PackageManagerService;->sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V

    .line 13740
    if-eqz p2, :cond_53

    invoke-static/range {p5 .. p5}, Lcom/android/internal/util/ArrayUtils;->isEmpty([I)Z

    move-result v0

    if-nez v0, :cond_53

    .line 13741
    iget-object v0, v9, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v1, Lcom/android/server/pm/-$$Lambda$PackageManagerService$4R9Zu2zflm9xqt9wOD23IIJnqLs;

    move-object v2, p1

    move/from16 v3, p3

    invoke-direct {v1, p0, v10, p1, v3}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$4R9Zu2zflm9xqt9wOD23IIJnqLs;-><init>(Lcom/android/server/pm/PackageManagerService;[ILjava/lang/String;Z)V

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    goto :goto_56

    .line 13740
    :cond_53
    move-object v2, p1

    move/from16 v3, p3

    .line 13749
    :goto_56
    return-void
.end method

.method public sendPackageBroadcast(Ljava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I[I)V
    .registers 22
    .param p1, "action"  # Ljava/lang/String;
    .param p2, "pkg"  # Ljava/lang/String;
    .param p3, "extras"  # Landroid/os/Bundle;
    .param p4, "flags"  # I
    .param p5, "targetPkg"  # Ljava/lang/String;
    .param p6, "finishedReceiver"  # Landroid/content/IIntentReceiver;
    .param p7, "userIds"  # [I
    .param p8, "instantUserIds"  # [I

    .line 13491
    move-object v10, p0

    iget-object v11, v10, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    new-instance v12, Lcom/android/server/pm/-$$Lambda$PackageManagerService$O5iApY07YeJyXA8KUFVcxpCf1NI;

    move-object v0, v12

    move-object v1, p0

    move-object/from16 v2, p7

    move-object v3, p1

    move-object v4, p2

    move-object/from16 v5, p3

    move/from16 v6, p4

    move-object/from16 v7, p5

    move-object/from16 v8, p6

    move-object/from16 v9, p8

    invoke-direct/range {v0 .. v9}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$O5iApY07YeJyXA8KUFVcxpCf1NI;-><init>(Lcom/android/server/pm/PackageManagerService;[ILjava/lang/String;Ljava/lang/String;Landroid/os/Bundle;ILjava/lang/String;Landroid/content/IIntentReceiver;[I)V

    invoke-virtual {v11, v12}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->post(Ljava/lang/Runnable;)Z

    .line 13510
    return-void
.end method

.method public sendSessionCommitBroadcast(Landroid/content/pm/PackageInstaller$SessionInfo;I)V
    .registers 13
    .param p1, "sessionInfo"  # Landroid/content/pm/PackageInstaller$SessionInfo;
    .param p2, "userId"  # I

    .line 21833
    invoke-static {}, Lcom/android/server/pm/UserManagerService;->getInstance()Lcom/android/server/pm/UserManagerService;

    move-result-object v0

    .line 21834
    .local v0, "ums":Lcom/android/server/pm/UserManagerService;
    if-eqz v0, :cond_62

    .line 21835
    invoke-virtual {v0, p2}, Lcom/android/server/pm/UserManagerService;->getProfileParent(I)Landroid/content/pm/UserInfo;

    move-result-object v1

    .line 21836
    .local v1, "parent":Landroid/content/pm/UserInfo;
    if-eqz v1, :cond_f

    iget v2, v1, Landroid/content/pm/UserInfo;->id:I

    goto :goto_10

    :cond_f
    move v2, p2

    .line 21837
    .local v2, "launcherUid":I
    :goto_10
    invoke-direct {p0, v2}, Lcom/android/server/pm/PackageManagerService;->getDefaultHomeActivity(I)Landroid/content/ComponentName;

    move-result-object v3

    .line 21838
    .local v3, "launcherComponent":Landroid/content/ComponentName;
    const-string v4, "android.intent.extra.USER"

    const-string v5, "android.content.pm.extra.SESSION"

    const-string v6, "android.content.pm.action.SESSION_COMMITTED"

    if-eqz v3, :cond_3e

    .line 21839
    new-instance v7, Landroid/content/Intent;

    invoke-direct {v7, v6}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 21840
    invoke-virtual {v7, v5, p1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;

    move-result-object v7

    .line 21841
    invoke-static {p2}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;

    move-result-object v8

    invoke-virtual {v7, v4, v8}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;

    move-result-object v7

    .line 21842
    invoke-virtual {v3}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Landroid/content/Intent;->setPackage(Ljava/lang/String;)Landroid/content/Intent;

    move-result-object v7

    .line 21843
    .local v7, "launcherIntent":Landroid/content/Intent;
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-static {v2}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;

    move-result-object v9

    invoke-virtual {v8, v7, v9}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)V

    .line 21846
    .end local v7  # "launcherIntent":Landroid/content/Intent;
    :cond_3e
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mAppPredictionServicePackage:Ljava/lang/String;

    if-eqz v7, :cond_62

    .line 21847
    new-instance v7, Landroid/content/Intent;

    invoke-direct {v7, v6}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 21848
    invoke-virtual {v7, v5, p1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;

    move-result-object v5

    .line 21849
    invoke-static {p2}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;

    move-result-object v6

    invoke-virtual {v5, v4, v6}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;

    move-result-object v4

    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mAppPredictionServicePackage:Ljava/lang/String;

    .line 21850
    invoke-virtual {v4, v5}, Landroid/content/Intent;->setPackage(Ljava/lang/String;)Landroid/content/Intent;

    move-result-object v4

    .line 21851
    .local v4, "predictorIntent":Landroid/content/Intent;
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-static {v2}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;

    move-result-object v6

    invoke-virtual {v5, v4, v6}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)V

    .line 21854
    .end local v1  # "parent":Landroid/content/pm/UserInfo;
    .end local v2  # "launcherUid":I
    .end local v3  # "launcherComponent":Landroid/content/ComponentName;
    .end local v4  # "predictorIntent":Landroid/content/Intent;
    :cond_62
    return-void
.end method

.method public sendSessionUpdatedBroadcast(Landroid/content/pm/PackageInstaller$SessionInfo;I)V
    .registers 6
    .param p1, "sessionInfo"  # Landroid/content/pm/PackageInstaller$SessionInfo;
    .param p2, "userId"  # I

    .line 21823
    iget-object v0, p1, Landroid/content/pm/PackageInstaller$SessionInfo;->installerPackageName:Ljava/lang/String;

    invoke-static {v0}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v0

    if-eqz v0, :cond_9

    .line 21824
    return-void

    .line 21826
    :cond_9
    new-instance v0, Landroid/content/Intent;

    const-string v1, "android.content.pm.action.SESSION_UPDATED"

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 21827
    const-string v1, "android.content.pm.extra.SESSION"

    invoke-virtual {v0, v1, p1}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;

    move-result-object v0

    iget-object v1, p1, Landroid/content/pm/PackageInstaller$SessionInfo;->installerPackageName:Ljava/lang/String;

    .line 21828
    invoke-virtual {v0, v1}, Landroid/content/Intent;->setPackage(Ljava/lang/String;)Landroid/content/Intent;

    move-result-object v0

    .line 21829
    .local v0, "sessionUpdatedIntent":Landroid/content/Intent;
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-static {p2}, Landroid/os/UserHandle;->of(I)Landroid/os/UserHandle;

    move-result-object v2

    invoke-virtual {v1, v0, v2}, Landroid/content/Context;->sendBroadcastAsUser(Landroid/content/Intent;Landroid/os/UserHandle;)V

    .line 21830
    return-void
.end method

.method public setApplicationCategoryHint(Ljava/lang/String;ILjava/lang/String;)V
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "categoryHint"  # I
    .param p3, "callerPackageName"  # Ljava/lang/String;

    .line 15176
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-nez v0, :cond_9b

    .line 15179
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v1, Landroid/app/AppOpsManager;

    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/app/AppOpsManager;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, v1, p3}, Landroid/app/AppOpsManager;->checkPackage(ILjava/lang/String;)V

    .line 15181
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 15182
    :try_start_1e
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 15183
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_81

    .line 15186
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v3

    invoke-direct {p0, v1, v2, v3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v2

    if-nez v2, :cond_6a

    .line 15189
    iget-object v2, v1, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    invoke-static {p3, v2}, Ljava/util/Objects;->equals(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_4b

    .line 15194
    iget v2, v1, Lcom/android/server/pm/PackageSetting;->categoryHint:I

    if-eq v2, p2, :cond_49

    .line 15195
    iput p2, v1, Lcom/android/server/pm/PackageSetting;->categoryHint:I

    .line 15196
    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->scheduleWriteSettingsLocked()V

    .line 15198
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_49
    monitor-exit v0

    .line 15199
    return-void

    .line 15190
    .restart local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    :cond_4b
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Calling package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " is not installer for "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "categoryHint":I
    .end local p3  # "callerPackageName":Ljava/lang/String;
    throw v2

    .line 15187
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "categoryHint":I
    .restart local p3  # "callerPackageName":Ljava/lang/String;
    :cond_6a
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unknown target package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "categoryHint":I
    .end local p3  # "callerPackageName":Ljava/lang/String;
    throw v2

    .line 15184
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "categoryHint":I
    .restart local p3  # "callerPackageName":Ljava/lang/String;
    :cond_81
    new-instance v2, Ljava/lang/IllegalArgumentException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unknown target package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "categoryHint":I
    .end local p3  # "callerPackageName":Ljava/lang/String;
    throw v2

    .line 15198
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "categoryHint":I
    .restart local p3  # "callerPackageName":Ljava/lang/String;
    :catchall_98
    move-exception v1

    monitor-exit v0
    :try_end_9a
    .catchall {:try_start_1e .. :try_end_9a} :catchall_98

    throw v1

    .line 15177
    :cond_9b
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Instant applications don\'t have access to this method"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public setApplicationEnabledSetting(Ljava/lang/String;IIILjava/lang/String;)V
    .registers 13
    .param p1, "appPackageName"  # Ljava/lang/String;
    .param p2, "newState"  # I
    .param p3, "flags"  # I
    .param p4, "userId"  # I
    .param p5, "callingPackage"  # Ljava/lang/String;

    .line 22169
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p4}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_9

    return-void

    .line 22170
    :cond_9
    if-nez p5, :cond_13

    .line 22171
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-static {v0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

    move-result-object p5

    .line 22175
    :cond_13
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 22176
    :try_start_16
    const-string v1, "PackageManager"

    invoke-static {v1, p1, p2}, Lcom/android/server/pm/SetupPackageHandler;->setValueByPackageStateLocked(Ljava/lang/String;Ljava/lang/String;I)V

    .line 22177
    monitor-exit v0
    :try_end_1c
    .catchall {:try_start_16 .. :try_end_1c} :catchall_27

    .line 22180
    const/4 v2, 0x0

    move-object v0, p0

    move-object v1, p1

    move v3, p2

    move v4, p3

    move v5, p4

    move-object v6, p5

    invoke-direct/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->setEnabledSetting(Ljava/lang/String;Ljava/lang/String;IIILjava/lang/String;)V

    .line 22181
    return-void

    .line 22177
    :catchall_27
    move-exception v1

    :try_start_28
    monitor-exit v0
    :try_end_29
    .catchall {:try_start_28 .. :try_end_29} :catchall_27

    throw v1
.end method

.method public setApplicationHiddenSettingAsUser(Ljava/lang/String;ZI)Z
    .registers 16
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "hidden"  # Z
    .param p3, "userId"  # I

    .line 13791
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.MANAGE_USERS"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 13793
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 13794
    .local v0, "callingUid":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v2, "setApplicationHiddenSetting for user "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    const/4 v6, 0x1

    const/4 v7, 0x1

    move v4, v0

    move v5, p3

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 13798
    const/4 v1, 0x0

    if-eqz p2, :cond_4c

    invoke-direct {p0, p1, p3}, Lcom/android/server/pm/PackageManagerService;->isPackageDeviceAdmin(Ljava/lang/String;I)Z

    move-result v2

    if-eqz v2, :cond_4c

    .line 13799
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Not hiding package "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, ": has active device admin"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "PackageManager"

    invoke-static {v3, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13800
    return v1

    .line 13803
    :cond_4c
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 13805
    .local v2, "callingId":J
    const/4 v4, 0x0

    .line 13806
    .local v4, "sendAdded":Z
    const/4 v5, 0x0

    .line 13808
    .local v5, "sendRemoved":Z
    :try_start_52
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6
    :try_end_55
    .catchall {:try_start_52 .. :try_end_55} :catchall_11d

    .line 13809
    :try_start_55
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v7, v7, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v7, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    .line 13810
    .local v7, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-nez v7, :cond_66

    .line 13811
    monitor-exit v6
    :try_end_62
    .catchall {:try_start_55 .. :try_end_62} :catchall_11a

    .line 13863
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13811
    return v1

    .line 13813
    :cond_66
    :try_start_66
    invoke-direct {p0, v7, v0, p3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v8

    if-eqz v8, :cond_71

    .line 13814
    monitor-exit v6
    :try_end_6d
    .catchall {:try_start_66 .. :try_end_6d} :catchall_11a

    .line 13863
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13814
    return v1

    .line 13817
    :cond_71
    :try_start_71
    const-string v8, "android"

    invoke-virtual {v8, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_85

    .line 13818
    const-string v8, "PackageManager"

    const-string v9, "Cannot hide package: android"

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13819
    monitor-exit v6
    :try_end_81
    .catchall {:try_start_71 .. :try_end_81} :catchall_11a

    .line 13863
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13819
    return v1

    .line 13824
    :cond_85
    :try_start_85
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v8, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/pm/PackageParser$Package;

    .line 13825
    .local v8, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v8, :cond_b8

    iget-object v9, v8, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-eqz v9, :cond_b8

    .line 13826
    const-string v9, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Cannot hide package: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, " providing static shared library: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v11, v8, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13829
    monitor-exit v6
    :try_end_b4
    .catchall {:try_start_85 .. :try_end_b4} :catchall_11a

    .line 13863
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13829
    return v1

    .line 13832
    :cond_b8
    if-eqz p2, :cond_e5

    :try_start_ba
    iget v9, v7, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-static {v0, v9}, Landroid/os/UserHandle;->isSameApp(II)Z

    move-result v9

    if-nez v9, :cond_e5

    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mProtectedPackages:Lcom/android/server/pm/ProtectedPackages;

    .line 13833
    invoke-virtual {v9, p3, p1}, Lcom/android/server/pm/ProtectedPackages;->isPackageStateProtected(ILjava/lang/String;)Z

    move-result v9

    if-eqz v9, :cond_e5

    .line 13834
    const-string v9, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Not hiding protected package: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13835
    monitor-exit v6
    :try_end_e1
    .catchall {:try_start_ba .. :try_end_e1} :catchall_11a

    .line 13863
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13835
    return v1

    .line 13838
    :cond_e5
    :try_start_e5
    invoke-virtual {v7, p3}, Lcom/android/server/pm/PackageSetting;->getHidden(I)Z

    move-result v9

    if-eq v9, p2, :cond_f8

    .line 13839
    invoke-virtual {v7, p2, p3}, Lcom/android/server/pm/PackageSetting;->setHidden(ZI)V

    .line 13840
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v9, p3}, Lcom/android/server/pm/Settings;->writePackageRestrictionsLPr(I)V

    .line 13841
    if-eqz p2, :cond_f7

    .line 13842
    const/4 v5, 0x1

    goto :goto_f8

    .line 13844
    :cond_f7
    const/4 v4, 0x1

    .line 13847
    .end local v8  # "pkg":Landroid/content/pm/PackageParser$Package;
    :cond_f8
    :goto_f8
    monitor-exit v6
    :try_end_f9
    .catchall {:try_start_e5 .. :try_end_f9} :catchall_11a

    .line 13848
    const/4 v6, 0x1

    if-eqz v4, :cond_104

    .line 13849
    :try_start_fc
    invoke-direct {p0, p1, v7, p3}, Lcom/android/server/pm/PackageManagerService;->sendPackageAddedForUser(Ljava/lang/String;Lcom/android/server/pm/PackageSetting;I)V
    :try_end_ff
    .catchall {:try_start_fc .. :try_end_ff} :catchall_11d

    .line 13850
    nop

    .line 13863
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13850
    return v6

    .line 13852
    :cond_104
    if-eqz v5, :cond_115

    .line 13857
    :try_start_106
    iget v1, v7, Lcom/android/server/pm/PackageSetting;->appId:I

    const-string v8, "hiding pkg"

    invoke-direct {p0, p1, v1, p3, v8}, Lcom/android/server/pm/PackageManagerService;->killApplication(Ljava/lang/String;IILjava/lang/String;)V

    .line 13859
    invoke-direct {p0, p1, v7, p3}, Lcom/android/server/pm/PackageManagerService;->sendApplicationHiddenForUser(Ljava/lang/String;Lcom/android/server/pm/PackageSetting;I)V
    :try_end_110
    .catchall {:try_start_106 .. :try_end_110} :catchall_11d

    .line 13860
    nop

    .line 13863
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13860
    return v6

    .line 13863
    .end local v4  # "sendAdded":Z
    .end local v5  # "sendRemoved":Z
    :cond_115
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13864
    nop

    .line 13865
    return v1

    .line 13847
    .end local v7  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "sendAdded":Z
    .restart local v5  # "sendRemoved":Z
    :catchall_11a
    move-exception v1

    :try_start_11b
    monitor-exit v6
    :try_end_11c
    .catchall {:try_start_11b .. :try_end_11c} :catchall_11a

    .end local v0  # "callingUid":I
    .end local v2  # "callingId":J
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "packageName":Ljava/lang/String;
    .end local p2  # "hidden":Z
    .end local p3  # "userId":I
    :try_start_11c
    throw v1
    :try_end_11d
    .catchall {:try_start_11c .. :try_end_11d} :catchall_11d

    .line 13863
    .end local v4  # "sendAdded":Z
    .end local v5  # "sendRemoved":Z
    .restart local v0  # "callingUid":I
    .restart local v2  # "callingId":J
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "packageName":Ljava/lang/String;
    .restart local p2  # "hidden":Z
    .restart local p3  # "userId":I
    :catchall_11d
    move-exception v1

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v1
.end method

.method public setBlockUninstallForUser(Ljava/lang/String;ZI)Z
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "blockUninstall"  # Z
    .param p3, "userId"  # I

    .line 20212
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.DELETE_PACKAGES"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 20214
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 20218
    :try_start_b
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 20219
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v1, :cond_3c

    iget-object v2, v1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    if-eqz v2, :cond_3c

    .line 20220
    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Cannot block uninstall of package: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " providing static shared library: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v4, v1, Landroid/content/pm/PackageParser$Package;->staticSharedLibName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 20222
    const/4 v2, 0x0

    monitor-exit v0

    return v2

    .line 20224
    :cond_3c
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, p3, p1, p2}, Lcom/android/server/pm/Settings;->setBlockUninstallLPw(ILjava/lang/String;Z)V

    .line 20225
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2, p3}, Lcom/android/server/pm/Settings;->writePackageRestrictionsLPr(I)V

    .line 20226
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    monitor-exit v0

    .line 20227
    const/4 v0, 0x1

    return v0

    .line 20226
    :catchall_49
    move-exception v1

    monitor-exit v0
    :try_end_4b
    .catchall {:try_start_b .. :try_end_4b} :catchall_49

    throw v1
.end method

.method public setCheckPermissionDelegateLocked(Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;)V
    .registers 2
    .param p1, "delegate"  # Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;
    .annotation build Lcom/android/internal/annotations/GuardedBy;
        value = {
            "mPackages"
        }
    .end annotation

    .line 10318
    iput-object p1, p0, Lcom/android/server/pm/PackageManagerService;->mCheckPermissionDelegate:Landroid/content/pm/PackageManagerInternal$CheckPermissionDelegate;

    .line 10319
    return-void
.end method

.method public setComponentEnabledSetting(Landroid/content/ComponentName;III)V
    .registers 15
    .param p1, "componentName"  # Landroid/content/ComponentName;
    .param p2, "newState"  # I
    .param p3, "flags"  # I
    .param p4, "userId"  # I

    .line 22197
    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, p4}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_9

    return-void

    .line 22200
    :cond_9
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 22201
    :try_start_c
    const-string v1, "PackageManager"

    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2, p2}, Lcom/android/server/pm/SetupPackageHandler;->setValueByPackageStateLocked(Ljava/lang/String;Ljava/lang/String;I)V

    .line 22202
    monitor-exit v0
    :try_end_16
    .catchall {:try_start_c .. :try_end_16} :catchall_27

    .line 22204
    invoke-virtual {p1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v4

    .line 22205
    invoke-virtual {p1}, Landroid/content/ComponentName;->getClassName()Ljava/lang/String;

    move-result-object v5

    const/4 v9, 0x0

    .line 22204
    move-object v3, p0

    move v6, p2

    move v7, p3

    move v8, p4

    invoke-direct/range {v3 .. v9}, Lcom/android/server/pm/PackageManagerService;->setEnabledSetting(Ljava/lang/String;Ljava/lang/String;IIILjava/lang/String;)V

    .line 22206
    return-void

    .line 22202
    :catchall_27
    move-exception v1

    :try_start_28
    monitor-exit v0
    :try_end_29
    .catchall {:try_start_28 .. :try_end_29} :catchall_27

    throw v1
.end method

.method public setDefaultBrowserPackageName(Ljava/lang/String;I)Z
    .registers 7
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "userId"  # I

    .line 15001
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const/4 v1, 0x0

    const-string v2, "android.permission.SET_PREFERRED_APPLICATIONS"

    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 15003
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    if-eq v0, p2, :cond_15

    .line 15004
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v2, "android.permission.INTERACT_ACROSS_USERS_FULL"

    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 15007
    :cond_15
    const/4 v0, -0x1

    const/4 v1, 0x0

    if-ne p2, v0, :cond_1a

    .line 15008
    return v1

    .line 15011
    :cond_1a
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 15012
    :try_start_1d
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultBrowserProvider:Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;

    .line 15013
    .local v2, "provider":Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;
    monitor-exit v0
    :try_end_20
    .catchall {:try_start_1d .. :try_end_20} :catchall_43

    .line 15014
    if-nez v2, :cond_2b

    .line 15015
    const-string v0, "PackageManager"

    const-string/jumbo v3, "mDefaultBrowserProvider is null"

    invoke-static {v0, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 15016
    return v1

    .line 15018
    :cond_2b
    invoke-interface {v2, p1, p2}, Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;->setDefaultBrowser(Ljava/lang/String;I)Z

    move-result v0

    .line 15019
    .local v0, "successful":Z
    if-nez v0, :cond_32

    .line 15020
    return v1

    .line 15022
    :cond_32
    if-eqz p1, :cond_41

    .line 15023
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 15024
    :try_start_37
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    invoke-virtual {v3, p1, p2}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->grantDefaultPermissionsToDefaultBrowser(Ljava/lang/String;I)V

    .line 15026
    monitor-exit v1

    goto :goto_41

    :catchall_3e
    move-exception v3

    monitor-exit v1
    :try_end_40
    .catchall {:try_start_37 .. :try_end_40} :catchall_3e

    throw v3

    .line 15028
    :cond_41
    :goto_41
    const/4 v1, 0x1

    return v1

    .line 15013
    .end local v0  # "successful":Z
    .end local v2  # "provider":Landroid/content/pm/PackageManagerInternal$DefaultBrowserProvider;
    :catchall_43
    move-exception v1

    :try_start_44
    monitor-exit v0
    :try_end_45
    .catchall {:try_start_44 .. :try_end_45} :catchall_43

    throw v1
.end method

.method public setDistractingPackageRestrictionsAsUser([Ljava/lang/String;II)[Ljava/lang/String;
    .registers 16
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "restrictionFlags"  # I
    .param p3, "userId"  # I

    .line 14234
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.SUSPEND_APPS"

    const-string/jumbo v2, "setDistractingPackageRestrictionsAsUser"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 14237
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 14238
    .local v0, "callingUid":I
    if-eqz v0, :cond_3a

    const/16 v1, 0x3e8

    if-eq v0, v1, :cond_3a

    .line 14239
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v1

    if-ne v1, p3, :cond_1b

    goto :goto_3a

    .line 14240
    :cond_1b
    new-instance v1, Ljava/lang/SecurityException;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Calling uid "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, " cannot call for user "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 14243
    :cond_3a
    :goto_3a
    const-string/jumbo v1, "packageNames cannot be null"

    invoke-static {p1, v1}, Lcom/android/internal/util/Preconditions;->checkNotNull(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 14245
    new-instance v1, Ljava/util/ArrayList;

    array-length v2, p1

    invoke-direct {v1, v2}, Ljava/util/ArrayList;-><init>(I)V

    .line 14246
    .local v1, "changedPackagesList":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    new-instance v2, Landroid/util/IntArray;

    array-length v3, p1

    invoke-direct {v2, v3}, Landroid/util/IntArray;-><init>(I)V

    .line 14247
    .local v2, "changedUids":Landroid/util/IntArray;
    new-instance v3, Ljava/util/ArrayList;

    array-length v4, p1

    invoke-direct {v3, v4}, Ljava/util/ArrayList;-><init>(I)V

    .line 14248
    .local v3, "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    if-eqz p2, :cond_59

    invoke-direct {p0, p1, p3}, Lcom/android/server/pm/PackageManagerService;->canSuspendPackageForUserInternal([Ljava/lang/String;I)[Z

    move-result-object v4

    goto :goto_5a

    .line 14249
    :cond_59
    const/4 v4, 0x0

    :goto_5a
    nop

    .line 14251
    .local v4, "canRestrict":[Z
    const/4 v5, 0x0

    .local v5, "i":I
    :goto_5c
    array-length v6, p1

    if-ge v5, v6, :cond_c4

    .line 14252
    aget-object v6, p1, v5

    .line 14254
    .local v6, "packageName":Ljava/lang/String;
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v7

    .line 14255
    :try_start_64
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v8, v8, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v8, v6}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/pm/PackageSetting;

    .line 14256
    .local v8, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v8, :cond_9f

    invoke-direct {p0, v8, v0, p3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v9

    if-eqz v9, :cond_77

    goto :goto_9f

    .line 14262
    :cond_77
    monitor-exit v7
    :try_end_78
    .catchall {:try_start_64 .. :try_end_78} :catchall_c1

    .line 14263
    if-eqz v4, :cond_82

    aget-boolean v7, v4, v5

    if-nez v7, :cond_82

    .line 14264
    invoke-interface {v3, v6}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 14265
    goto :goto_be

    .line 14267
    :cond_82
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v9

    .line 14268
    :try_start_85
    invoke-virtual {v8, p3}, Lcom/android/server/pm/PackageSetting;->getDistractionFlags(I)I

    move-result v7

    .line 14269
    .local v7, "oldDistractionFlags":I
    if-eq p2, v7, :cond_9a

    .line 14270
    invoke-virtual {v8, p2, p3}, Lcom/android/server/pm/PackageSetting;->setDistractionFlags(II)V

    .line 14271
    invoke-interface {v1, v6}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 14272
    iget v10, v8, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-static {p3, v10}, Landroid/os/UserHandle;->getUid(II)I

    move-result v10

    invoke-virtual {v2, v10}, Landroid/util/IntArray;->add(I)V

    .line 14274
    .end local v7  # "oldDistractionFlags":I
    :cond_9a
    monitor-exit v9

    goto :goto_be

    :catchall_9c
    move-exception v7

    monitor-exit v9
    :try_end_9e
    .catchall {:try_start_85 .. :try_end_9e} :catchall_9c

    throw v7

    .line 14257
    :cond_9f
    :goto_9f
    :try_start_9f
    const-string v9, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Could not find package setting for package: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, ". Skipping..."

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14259
    invoke-interface {v3, v6}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 14260
    monitor-exit v7

    .line 14251
    .end local v6  # "packageName":Ljava/lang/String;
    .end local v8  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :goto_be
    add-int/lit8 v5, v5, 0x1

    goto :goto_5c

    .line 14262
    .restart local v6  # "packageName":Ljava/lang/String;
    :catchall_c1
    move-exception v8

    monitor-exit v7
    :try_end_c3
    .catchall {:try_start_9f .. :try_end_c3} :catchall_c1

    throw v8

    .line 14277
    .end local v5  # "i":I
    .end local v6  # "packageName":Ljava/lang/String;
    :cond_c4
    invoke-interface {v1}, Ljava/util/List;->isEmpty()Z

    move-result v5

    if-nez v5, :cond_e9

    .line 14278
    nop

    .line 14279
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v5

    new-array v5, v5, [Ljava/lang/String;

    .line 14278
    invoke-interface {v1, v5}, Ljava/util/List;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v5

    check-cast v5, [Ljava/lang/String;

    .line 14280
    .local v5, "changedPackages":[Ljava/lang/String;
    invoke-virtual {v2}, Landroid/util/IntArray;->toArray()[I

    move-result-object v6

    invoke-direct {p0, v5, v6, p3, p2}, Lcom/android/server/pm/PackageManagerService;->sendDistractingPackagesChanged([Ljava/lang/String;[III)V

    .line 14282
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v6

    .line 14283
    :try_start_e1
    invoke-virtual {p0, p3}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 14284
    monitor-exit v6

    goto :goto_e9

    :catchall_e6
    move-exception v7

    monitor-exit v6
    :try_end_e8
    .catchall {:try_start_e1 .. :try_end_e8} :catchall_e6

    throw v7

    .line 14286
    .end local v5  # "changedPackages":[Ljava/lang/String;
    :cond_e9
    :goto_e9
    const/4 v5, 0x0

    new-array v5, v5, [Ljava/lang/String;

    invoke-interface {v3, v5}, Ljava/util/List;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v5

    check-cast v5, [Ljava/lang/String;

    return-object v5
.end method

.method public setForceFull(Ljava/lang/String;Z)Z
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "forceFull"  # Z

    .line 26912
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.FORCE_STOP_PACKAGES"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 26914
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26915
    :try_start_b
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 26916
    .local v1, "pkg":Landroid/content/pm/PackageParser$Package;
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 26917
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_48

    if-nez v2, :cond_22

    goto :goto_48

    .line 26920
    :cond_22
    iget-object v3, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v3}, Landroid/content/pm/ApplicationInfo;->isForceFull()Z

    move-result v3

    if-eq v3, p2, :cond_39

    .line 26921
    iget-object v3, v1, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v3, p2}, Landroid/content/pm/ApplicationInfo;->setForceFull(Z)V

    .line 26922
    invoke-static {v1}, Landroid/content/pm/PackageParser;->setMaxAspectRatio(Landroid/content/pm/PackageParser$Package;)V

    .line 26923
    iget v3, v2, Lcom/android/server/pm/PackageSetting;->appId:I

    const-string v4, "forceFull"

    invoke-direct {p0, p1, v3, v4}, Lcom/android/server/pm/PackageManagerService;->killApplication(Ljava/lang/String;ILjava/lang/String;)V

    .line 26926
    :cond_39
    invoke-virtual {v2}, Lcom/android/server/pm/PackageSetting;->isForceFull()Z

    move-result v3

    if-eq v3, p2, :cond_45

    .line 26927
    invoke-virtual {v2, p2}, Lcom/android/server/pm/PackageSetting;->setForceFull(Z)V

    .line 26928
    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->scheduleWriteSettingsLocked()V

    .line 26930
    :cond_45
    const/4 v3, 0x1

    monitor-exit v0

    return v3

    .line 26918
    :cond_48
    :goto_48
    const/4 v3, 0x0

    monitor-exit v0

    return v3

    .line 26931
    .end local v1  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    :catchall_4b
    move-exception v1

    monitor-exit v0
    :try_end_4d
    .catchall {:try_start_b .. :try_end_4d} :catchall_4b

    throw v1
.end method

.method public setHarmfulAppWarning(Ljava/lang/String;Ljava/lang/CharSequence;I)V
    .registers 12
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "warning"  # Ljava/lang/CharSequence;
    .param p3, "userId"  # I

    .line 26476
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    .line 26477
    .local v6, "callingUid":I
    invoke-static {v6}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v7

    .line 26479
    .local v7, "callingAppId":I
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v3, 0x1

    const/4 v4, 0x1

    const-string/jumbo v5, "setHarmfulAppInfo"

    move v1, v6

    move v2, p3

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 26482
    const/16 v0, 0x3e8

    if-eq v7, v0, :cond_2b

    if-eqz v7, :cond_2b

    .line 26483
    const-string v0, "android.permission.SET_HARMFUL_APP_WARNINGS"

    invoke-virtual {p0, v0, v6}, Lcom/android/server/pm/PackageManagerService;->checkUidPermission(Ljava/lang/String;I)I

    move-result v0

    if-nez v0, :cond_23

    goto :goto_2b

    .line 26484
    :cond_23
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Caller must have the android.permission.SET_HARMFUL_APP_WARNINGS permission."

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 26488
    :cond_2b
    :goto_2b
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26489
    :try_start_2e
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1, p2, p3}, Lcom/android/server/pm/Settings;->setHarmfulAppWarningLPw(Ljava/lang/String;Ljava/lang/CharSequence;I)V

    .line 26490
    invoke-virtual {p0, p3}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 26491
    monitor-exit v0

    .line 26492
    return-void

    .line 26491
    :catchall_38
    move-exception v1

    monitor-exit v0
    :try_end_3a
    .catchall {:try_start_2e .. :try_end_3a} :catchall_38

    throw v1
.end method

.method public setHomeActivity(Landroid/content/ComponentName;I)V
    .registers 13
    .param p1, "comp"  # Landroid/content/ComponentName;
    .param p2, "userId"  # I

    .line 21999
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_b

    .line 22000
    return-void

    .line 22002
    :cond_b
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 22003
    .local v0, "homeActivities":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Landroid/content/pm/ResolveInfo;>;"
    invoke-virtual {p0, v0, p2}, Lcom/android/server/pm/PackageManagerService;->getHomeActivitiesAsUser(Ljava/util/List;I)Landroid/content/ComponentName;

    .line 22005
    const/4 v1, 0x0

    .line 22007
    .local v1, "found":Z
    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 22008
    .local v2, "size":I
    new-array v9, v2, [Landroid/content/ComponentName;

    .line 22009
    .local v9, "set":[Landroid/content/ComponentName;
    const/4 v3, 0x0

    .local v3, "i":I
    :goto_1b
    if-ge v3, v2, :cond_3c

    .line 22010
    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/pm/ResolveInfo;

    .line 22011
    .local v4, "candidate":Landroid/content/pm/ResolveInfo;
    iget-object v5, v4, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 22012
    .local v5, "info":Landroid/content/pm/ActivityInfo;
    new-instance v6, Landroid/content/ComponentName;

    iget-object v7, v5, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v8, v5, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v6, v7, v8}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 22013
    .local v6, "activityName":Landroid/content/ComponentName;
    aput-object v6, v9, v3

    .line 22014
    if-nez v1, :cond_39

    invoke-virtual {v6, p1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_39

    .line 22015
    const/4 v1, 0x1

    .line 22009
    .end local v4  # "candidate":Landroid/content/pm/ResolveInfo;
    .end local v5  # "info":Landroid/content/pm/ActivityInfo;
    .end local v6  # "activityName":Landroid/content/ComponentName;
    :cond_39
    add-int/lit8 v3, v3, 0x1

    goto :goto_1b

    .line 22018
    .end local v3  # "i":I
    :cond_3c
    if-eqz v1, :cond_4c

    .line 22022
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getHomeFilter()Landroid/content/IntentFilter;

    move-result-object v4

    const/high16 v5, 0x100000

    move-object v3, p0

    move-object v6, v9

    move-object v7, p1

    move v8, p2

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/PackageManagerService;->replacePreferredActivity(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;I)V

    .line 22024
    return-void

    .line 22019
    :cond_4c
    new-instance v3, Ljava/lang/IllegalArgumentException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Component "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v5, " cannot be home on user "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v3
.end method

.method public setInstallLocation(I)Z
    .registers 5
    .param p1, "loc"  # I

    .line 24607
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.WRITE_SECURE_SETTINGS"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 24609
    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->getInstallLocation()I

    move-result v0

    const/4 v1, 0x1

    if-ne v0, p1, :cond_10

    .line 24610
    return v1

    .line 24612
    :cond_10
    if-eqz p1, :cond_1a

    if-eq p1, v1, :cond_1a

    const/4 v0, 0x2

    if-ne p1, v0, :cond_18

    goto :goto_1a

    .line 24618
    :cond_18
    const/4 v0, 0x0

    return v0

    .line 24614
    :cond_1a
    :goto_1a
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string v2, "default_install_location"

    invoke-static {v0, v2, p1}, Landroid/provider/Settings$Global;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z

    .line 24616
    return v1
.end method

.method public setInstallerPackageName(Ljava/lang/String;Ljava/lang/String;)V
    .registers 16
    .param p1, "targetPackage"  # Ljava/lang/String;
    .param p2, "installerPackageName"  # Ljava/lang/String;

    .line 15081
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 15082
    .local v0, "callingUid":I
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v1

    if-eqz v1, :cond_b

    .line 15083
    return-void

    .line 15086
    :cond_b
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 15087
    :try_start_e
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 15088
    .local v2, "targetPackageSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v2, :cond_164

    .line 15090
    invoke-static {v0}, Landroid/os/UserHandle;->getUserId(I)I

    move-result v3

    .line 15089
    invoke-direct {p0, v2, v0, v3}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-nez v3, :cond_164

    .line 15095
    const/4 v3, 0x0

    if-eqz p2, :cond_4b

    .line 15096
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v4, v4, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v4, p2}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/PackageSetting;

    .line 15097
    .local v4, "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v4, :cond_34

    goto :goto_4c

    .line 15098
    :cond_34
    new-instance v3, Ljava/lang/IllegalArgumentException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unknown installer package: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v3, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "targetPackage":Ljava/lang/String;
    .end local p2  # "installerPackageName":Ljava/lang/String;
    throw v3

    .line 15102
    .end local v4  # "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "targetPackage":Ljava/lang/String;
    .restart local p2  # "installerPackageName":Ljava/lang/String;
    :cond_4b
    move-object v4, v3

    .line 15106
    .restart local v4  # "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    :goto_4c
    invoke-static {v0}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v5

    .line 15107
    .local v5, "appId":I
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v6, v5}, Lcom/android/server/pm/Settings;->getSettingLPr(I)Lcom/android/server/pm/SettingBase;

    move-result-object v6

    .line 15108
    .local v6, "obj":Ljava/lang/Object;
    if-eqz v6, :cond_14d

    .line 15109
    instance-of v7, v6, Lcom/android/server/pm/SharedUserSetting;

    if-eqz v7, :cond_66

    .line 15110
    move-object v7, v6

    check-cast v7, Lcom/android/server/pm/SharedUserSetting;

    iget-object v7, v7, Lcom/android/server/pm/SharedUserSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v7, v7, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v7, v7, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .local v7, "callerSignature":[Landroid/content/pm/Signature;
    goto :goto_73

    .line 15112
    .end local v7  # "callerSignature":[Landroid/content/pm/Signature;
    :cond_66
    instance-of v7, v6, Lcom/android/server/pm/PackageSetting;

    if-eqz v7, :cond_12e

    .line 15113
    move-object v7, v6

    check-cast v7, Lcom/android/server/pm/PackageSetting;

    iget-object v7, v7, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v7, v7, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v7, v7, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    .line 15123
    .restart local v7  # "callerSignature":[Landroid/content/pm/Signature;
    :goto_73
    if-eqz v4, :cond_99

    .line 15124
    iget-object v8, v4, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v8, v8, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v8, v8, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    invoke-static {v7, v8}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v8

    if-nez v8, :cond_82

    goto :goto_99

    .line 15127
    :cond_82
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Caller does not have same cert as new installer package "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-direct {v3, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "targetPackage":Ljava/lang/String;
    .end local p2  # "installerPackageName":Ljava/lang/String;
    throw v3

    .line 15135
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "targetPackage":Ljava/lang/String;
    .restart local p2  # "installerPackageName":Ljava/lang/String;
    :cond_99
    :goto_99
    iget-object v8, v2, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    .line 15137
    .local v8, "targetInstallerPackageName":Ljava/lang/String;
    if-nez v8, :cond_9e

    goto :goto_a8

    .line 15138
    :cond_9e
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v3, v3, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v3, v8}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/PackageSetting;

    :goto_a8
    nop

    .line 15140
    .local v3, "targetInstallerPkgSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v3, :cond_cf

    .line 15141
    iget-object v9, v3, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

    iget-object v9, v9, Lcom/android/server/pm/PackageSignatures;->mSigningDetails:Landroid/content/pm/PackageParser$SigningDetails;

    iget-object v9, v9, Landroid/content/pm/PackageParser$SigningDetails;->signatures:[Landroid/content/pm/Signature;

    invoke-static {v7, v9}, Lcom/android/server/pm/PackageManagerServiceUtils;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

    move-result v9

    if-nez v9, :cond_b8

    goto :goto_11e

    .line 15144
    :cond_b8
    new-instance v9, Ljava/lang/SecurityException;

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Caller does not have same cert as old installer package "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-direct {v9, v10}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "targetPackage":Ljava/lang/String;
    .end local p2  # "installerPackageName":Ljava/lang/String;
    throw v9

    .line 15148
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "targetPackage":Ljava/lang/String;
    .restart local p2  # "installerPackageName":Ljava/lang/String;
    :cond_cf
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v10, "android.permission.INSTALL_PACKAGES"

    invoke-virtual {v9, v10}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v9

    if-eqz v9, :cond_11e

    .line 15153
    const v9, 0x534e4554

    const/4 v10, 0x3

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v11, 0x0

    const-string v12, "150857253"

    aput-object v12, v10, v11

    const/4 v11, 0x1

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v10, v11

    const/4 v11, 0x2

    const-string v12, ""

    aput-object v12, v10, v11

    invoke-static {v9, v10}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 15155
    invoke-direct {p0, v0}, Lcom/android/server/pm/PackageManagerService;->getUidTargetSdkVersionLockedLPr(I)I

    move-result v9

    const/16 v10, 0x1d

    if-gt v9, v10, :cond_fd

    .line 15160
    monitor-exit v1

    return-void

    .line 15156
    :cond_fd
    new-instance v9, Ljava/lang/SecurityException;

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Neither user "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v11, " nor current process has "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, "android.permission.INSTALL_PACKAGES"

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-direct {v9, v10}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "targetPackage":Ljava/lang/String;
    .end local p2  # "installerPackageName":Ljava/lang/String;
    throw v9

    .line 15165
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "targetPackage":Ljava/lang/String;
    .restart local p2  # "installerPackageName":Ljava/lang/String;
    :cond_11e
    :goto_11e
    iput-object p2, v2, Lcom/android/server/pm/PackageSetting;->installerPackageName:Ljava/lang/String;

    .line 15166
    if-eqz p2, :cond_129

    .line 15167
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v9, v9, Lcom/android/server/pm/Settings;->mInstallerPackages:Landroid/util/ArraySet;

    invoke-virtual {v9, p2}, Landroid/util/ArraySet;->add(Ljava/lang/Object;)Z

    .line 15169
    :cond_129
    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->scheduleWriteSettingsLocked()V

    .line 15170
    .end local v2  # "targetPackageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v3  # "targetInstallerPkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v4  # "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "appId":I
    .end local v6  # "obj":Ljava/lang/Object;
    .end local v7  # "callerSignature":[Landroid/content/pm/Signature;
    .end local v8  # "targetInstallerPackageName":Ljava/lang/String;
    monitor-exit v1

    .line 15171
    return-void

    .line 15115
    .restart local v2  # "targetPackageSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v4  # "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "appId":I
    .restart local v6  # "obj":Ljava/lang/Object;
    :cond_12e
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Bad object "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v8, " for uid "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v3, v7}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "targetPackage":Ljava/lang/String;
    .end local p2  # "installerPackageName":Ljava/lang/String;
    throw v3

    .line 15118
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "targetPackage":Ljava/lang/String;
    .restart local p2  # "installerPackageName":Ljava/lang/String;
    :cond_14d
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unknown calling UID: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v3, v7}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "targetPackage":Ljava/lang/String;
    .end local p2  # "installerPackageName":Ljava/lang/String;
    throw v3

    .line 15091
    .end local v4  # "installerPackageSetting":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "appId":I
    .end local v6  # "obj":Ljava/lang/Object;
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "targetPackage":Ljava/lang/String;
    .restart local p2  # "installerPackageName":Ljava/lang/String;
    :cond_164
    new-instance v3, Ljava/lang/IllegalArgumentException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unknown target package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v0  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "targetPackage":Ljava/lang/String;
    .end local p2  # "installerPackageName":Ljava/lang/String;
    throw v3

    .line 15170
    .end local v2  # "targetPackageSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v0  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "targetPackage":Ljava/lang/String;
    .restart local p2  # "installerPackageName":Ljava/lang/String;
    :catchall_17b
    move-exception v2

    monitor-exit v1
    :try_end_17d
    .catchall {:try_start_e .. :try_end_17d} :catchall_17b

    throw v2
.end method

.method public setInstantAppCookie(Ljava/lang/String;[BI)Z
    .registers 10
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "cookie"  # [B
    .param p3, "userId"  # I

    .line 9235
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    const/4 v3, 0x1

    const/4 v4, 0x1

    const-string/jumbo v5, "setInstantAppCookie"

    move v2, p3

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 9238
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {p0, p1, v0}, Lcom/android/server/pm/PackageManagerService;->isCallerSameApp(Ljava/lang/String;I)Z

    move-result v0

    if-nez v0, :cond_1b

    .line 9239
    const/4 v0, 0x0

    return v0

    .line 9241
    :cond_1b
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 9242
    :try_start_1e
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppRegistry:Lcom/android/server/pm/InstantAppRegistry;

    invoke-virtual {v1, p1, p2, p3}, Lcom/android/server/pm/InstantAppRegistry;->setInstantAppCookieLPw(Ljava/lang/String;[BI)Z

    move-result v1

    monitor-exit v0

    return v1

    .line 9244
    :catchall_26
    move-exception v1

    monitor-exit v0
    :try_end_28
    .catchall {:try_start_1e .. :try_end_28} :catchall_26

    throw v1
.end method

.method public setLastChosenActivity(Landroid/content/Intent;Ljava/lang/String;ILandroid/content/IntentFilter;ILandroid/content/ComponentName;)V
    .registers 25
    .param p1, "intent"  # Landroid/content/Intent;
    .param p2, "resolvedType"  # Ljava/lang/String;
    .param p3, "flags"  # I
    .param p4, "filter"  # Landroid/content/IntentFilter;
    .param p5, "match"  # I
    .param p6, "activity"  # Landroid/content/ComponentName;

    .line 6898
    move-object/from16 v10, p0

    move-object/from16 v11, p1

    move-object/from16 v12, p2

    move/from16 v13, p3

    move-object/from16 v14, p4

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    invoke-direct {v10, v0}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_15

    .line 6899
    return-void

    .line 6901
    :cond_15
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v15

    .line 6902
    .local v15, "userId":I
    sget-boolean v0, Lcom/android/server/pm/PackageManagerService;->DEBUG_PREFERRED:Z

    if-eqz v0, :cond_6d

    .line 6903
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v1, "setLastChosenActivity intent="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v1, " resolvedType="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " flags="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v13}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, " filter="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v1, " match="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move/from16 v9, p5

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, " activity="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v8, p6

    invoke-virtual {v0, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "PackageManager"

    invoke-static {v1, v0}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 6909
    new-instance v0, Landroid/util/PrintStreamPrinter;

    sget-object v1, Ljava/lang/System;->out:Ljava/io/PrintStream;

    invoke-direct {v0, v1}, Landroid/util/PrintStreamPrinter;-><init>(Ljava/io/PrintStream;)V

    const-string v1, "    "

    invoke-virtual {v14, v0, v1}, Landroid/content/IntentFilter;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    goto :goto_71

    .line 6902
    :cond_6d
    move/from16 v9, p5

    move-object/from16 v8, p6

    .line 6911
    :goto_71
    const/4 v0, 0x0

    invoke-virtual {v11, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 6912
    invoke-direct {v10, v11, v12, v13, v15}, Lcom/android/server/pm/PackageManagerService;->queryIntentActivitiesInternal(Landroid/content/Intent;Ljava/lang/String;II)Ljava/util/List;

    move-result-object v16

    .line 6915
    .local v16, "query":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x1

    const/16 v17, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    move/from16 v3, p3

    move-object/from16 v4, v16

    move/from16 v8, v17

    move v9, v15

    invoke-virtual/range {v0 .. v9}, Lcom/android/server/pm/PackageManagerService;->findPreferredActivityNotLocked(Landroid/content/Intent;Ljava/lang/String;ILjava/util/List;IZZZI)Landroid/content/pm/ResolveInfo;

    .line 6918
    const/4 v3, 0x0

    const-string v7, "Setting last chosen"

    move-object/from16 v1, p4

    move/from16 v2, p5

    move-object/from16 v4, p6

    move v6, v15

    invoke-direct/range {v0 .. v7}, Lcom/android/server/pm/PackageManagerService;->addPreferredActivityInternal(Landroid/content/IntentFilter;I[Landroid/content/ComponentName;Landroid/content/ComponentName;ZILjava/lang/String;)V

    .line 6920
    return-void
.end method

.method public setPackageStoppedState(Ljava/lang/String;ZI)V
    .registers 21
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "stopped"  # Z
    .param p3, "userId"  # I

    .line 22471
    move-object/from16 v8, p0

    move/from16 v15, p3

    sget-object v0, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v0, v15}, Lcom/android/server/pm/UserManagerService;->exists(I)Z

    move-result v0

    if-nez v0, :cond_d

    return-void

    .line 22472
    :cond_d
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    .line 22473
    .local v7, "callingUid":I
    invoke-direct {v8, v7}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    if-eqz v0, :cond_18

    .line 22474
    return-void

    .line 22476
    :cond_18
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.CHANGE_COMPONENT_ENABLED_STATE"

    invoke-virtual {v0, v1}, Landroid/content/Context;->checkCallingOrSelfPermission(Ljava/lang/String;)I

    move-result v16

    .line 22478
    .local v16, "permission":I
    if-nez v16, :cond_24

    const/4 v0, 0x1

    goto :goto_25

    :cond_24
    const/4 v0, 0x0

    :goto_25
    move v5, v0

    .line 22479
    .local v5, "allowedByPermission":Z
    iget-object v9, v8, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    const/4 v12, 0x1

    const/4 v13, 0x1

    const-string/jumbo v14, "stop package"

    move v10, v7

    move/from16 v11, p3

    invoke-virtual/range {v9 .. v14}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->enforceCrossUserPermission(IIZZLjava/lang/String;)V

    .line 22482
    iget-object v9, v8, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v9

    .line 22483
    :try_start_36
    iget-object v0, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;
    :try_end_3a
    .catchall {:try_start_36 .. :try_end_3a} :catchall_63

    move-object/from16 v10, p1

    :try_start_3c
    invoke-virtual {v0, v10}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    .line 22484
    .local v0, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-direct {v8, v0, v7, v15}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v1

    if-nez v1, :cond_5e

    iget-object v1, v8, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;
    :try_end_4a
    .catchall {:try_start_3c .. :try_end_4a} :catchall_61

    .line 22485
    move-object/from16 v2, p0

    move-object/from16 v3, p1

    move/from16 v4, p2

    move v6, v7

    move v11, v7

    .end local v7  # "callingUid":I
    .local v11, "callingUid":I
    move/from16 v7, p3

    :try_start_54
    invoke-virtual/range {v1 .. v7}, Lcom/android/server/pm/Settings;->setPackageStoppedStateLPw(Lcom/android/server/pm/PackageManagerService;Ljava/lang/String;ZZII)Z

    move-result v1

    if-eqz v1, :cond_5f

    .line 22487
    invoke-virtual {v8, v15}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    goto :goto_5f

    .line 22484
    .end local v11  # "callingUid":I
    .restart local v7  # "callingUid":I
    :cond_5e
    move v11, v7

    .line 22489
    .end local v0  # "ps":Lcom/android/server/pm/PackageSetting;
    .end local v7  # "callingUid":I
    .restart local v11  # "callingUid":I
    :cond_5f
    :goto_5f
    monitor-exit v9

    .line 22490
    return-void

    .line 22489
    .end local v11  # "callingUid":I
    .restart local v7  # "callingUid":I
    :catchall_61
    move-exception v0

    goto :goto_66

    :catchall_63
    move-exception v0

    move-object/from16 v10, p1

    :goto_66
    move v11, v7

    .end local v7  # "callingUid":I
    .restart local v11  # "callingUid":I
    :goto_67
    monitor-exit v9
    :try_end_68
    .catchall {:try_start_54 .. :try_end_68} :catchall_69

    throw v0

    :catchall_69
    move-exception v0

    goto :goto_67
.end method

.method public setPackagesSuspendedAsUser([Ljava/lang/String;ZLandroid/os/PersistableBundle;Landroid/os/PersistableBundle;Landroid/content/pm/SuspendDialogInfo;Ljava/lang/String;I)[Ljava/lang/String;
    .registers 28
    .param p1, "packageNames"  # [Ljava/lang/String;
    .param p2, "suspended"  # Z
    .param p3, "appExtras"  # Landroid/os/PersistableBundle;
    .param p4, "launcherExtras"  # Landroid/os/PersistableBundle;
    .param p5, "dialogInfo"  # Landroid/content/pm/SuspendDialogInfo;
    .param p6, "callingPackage"  # Ljava/lang/String;
    .param p7, "userId"  # I

    .line 14327
    move-object/from16 v7, p0

    move-object/from16 v8, p1

    move/from16 v6, p2

    move-object/from16 v5, p6

    move/from16 v4, p7

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    .line 14328
    .local v3, "callingUid":I
    const-string/jumbo v0, "setPackagesSuspendedAsUser"

    invoke-direct {v7, v5, v3, v4, v0}, Lcom/android/server/pm/PackageManagerService;->enforceCanSetPackagesSuspendedAsUser(Ljava/lang/String;IILjava/lang/String;)V

    .line 14331
    invoke-static/range {p1 .. p1}, Lcom/android/internal/util/ArrayUtils;->isEmpty([Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1b

    .line 14332
    return-object v8

    .line 14335
    :cond_1b
    new-instance v0, Ljava/util/ArrayList;

    array-length v1, v8

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    move-object v2, v0

    .line 14336
    .local v2, "changedPackagesList":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    new-instance v0, Landroid/util/IntArray;

    array-length v1, v8

    invoke-direct {v0, v1}, Landroid/util/IntArray;-><init>(I)V

    move-object v1, v0

    .line 14337
    .local v1, "changedUids":Landroid/util/IntArray;
    new-instance v0, Ljava/util/ArrayList;

    array-length v9, v8

    invoke-direct {v0, v9}, Ljava/util/ArrayList;-><init>(I)V

    move-object v15, v0

    .line 14338
    .local v15, "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v6, :cond_37

    invoke-direct {v7, v8, v4}, Lcom/android/server/pm/PackageManagerService;->canSuspendPackageForUserInternal([Ljava/lang/String;I)[Z

    move-result-object v0

    goto :goto_38

    .line 14339
    :cond_37
    const/4 v0, 0x0

    :goto_38
    move-object/from16 v16, v0

    .line 14341
    .local v16, "canSuspend":[Z
    const/4 v0, 0x0

    move v14, v0

    .local v14, "i":I
    :goto_3c
    array-length v0, v8

    if-ge v14, v0, :cond_114

    .line 14342
    aget-object v13, v8, v14

    .line 14343
    .local v13, "packageName":Ljava/lang/String;
    invoke-virtual {v5, v13}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_7d

    .line 14344
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Calling package: "

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, " trying to "

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 14345
    if-eqz v6, :cond_5e

    const-string v9, ""

    goto :goto_61

    :cond_5e
    const-string/jumbo v9, "un"

    :goto_61
    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string/jumbo v9, "suspend itself. Ignoring"

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 14344
    const-string v9, "PackageManager"

    invoke-static {v9, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14346
    invoke-interface {v15, v13}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 14347
    move/from16 v18, v3

    move/from16 v19, v14

    move-object v8, v15

    goto/16 :goto_fe

    .line 14350
    :cond_7d
    iget-object v9, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v9

    .line 14351
    :try_start_80
    iget-object v0, v7, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v0, v0, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v13}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/PackageSetting;

    move-object v12, v0

    .line 14352
    .local v12, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v12, :cond_d8

    invoke-direct {v7, v12, v3, v4}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v0

    if-eqz v0, :cond_9b

    move/from16 v18, v3

    move-object v3, v12

    move-object v5, v13

    move/from16 v19, v14

    move-object v8, v15

    goto :goto_df

    .line 14358
    :cond_9b
    monitor-exit v9
    :try_end_9c
    .catchall {:try_start_80 .. :try_end_9c} :catchall_109

    .line 14359
    if-eqz v16, :cond_ab

    aget-boolean v0, v16, v14

    if-nez v0, :cond_ab

    .line 14360
    invoke-interface {v15, v13}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 14361
    move/from16 v18, v3

    move/from16 v19, v14

    move-object v8, v15

    goto :goto_fe

    .line 14363
    :cond_ab
    iget-object v11, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v11

    .line 14364
    move-object v9, v12

    move/from16 v10, p2

    move-object/from16 v17, v11

    move-object/from16 v11, p6

    move/from16 v18, v3

    move-object v3, v12

    .end local v12  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v3, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .local v18, "callingUid":I
    move-object/from16 v12, p5

    move-object v5, v13

    .end local v13  # "packageName":Ljava/lang/String;
    .local v5, "packageName":Ljava/lang/String;
    move-object/from16 v13, p3

    move/from16 v19, v14

    .end local v14  # "i":I
    .local v19, "i":I
    move-object/from16 v14, p4

    move-object v8, v15

    .end local v15  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v8, "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move/from16 v15, p7

    :try_start_c4
    invoke-virtual/range {v9 .. v15}, Lcom/android/server/pm/PackageSetting;->setSuspended(ZLjava/lang/String;Landroid/content/pm/SuspendDialogInfo;Landroid/os/PersistableBundle;Landroid/os/PersistableBundle;I)V

    .line 14366
    monitor-exit v17
    :try_end_c8
    .catchall {:try_start_c4 .. :try_end_c8} :catchall_d5

    .line 14367
    invoke-interface {v2, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 14368
    iget v0, v3, Lcom/android/server/pm/PackageSetting;->appId:I

    invoke-static {v4, v0}, Landroid/os/UserHandle;->getUid(II)I

    move-result v0

    invoke-virtual {v1, v0}, Landroid/util/IntArray;->add(I)V

    goto :goto_fe

    .line 14366
    :catchall_d5
    move-exception v0

    :try_start_d6
    monitor-exit v17
    :try_end_d7
    .catchall {:try_start_d6 .. :try_end_d7} :catchall_d5

    throw v0

    .line 14352
    .end local v5  # "packageName":Ljava/lang/String;
    .end local v8  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v18  # "callingUid":I
    .end local v19  # "i":I
    .local v3, "callingUid":I
    .restart local v12  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v13  # "packageName":Ljava/lang/String;
    .restart local v14  # "i":I
    .restart local v15  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_d8
    move/from16 v18, v3

    move-object v3, v12

    move-object v5, v13

    move/from16 v19, v14

    move-object v8, v15

    .line 14353
    .end local v12  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v13  # "packageName":Ljava/lang/String;
    .end local v14  # "i":I
    .end local v15  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v3, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .restart local v5  # "packageName":Ljava/lang/String;
    .restart local v8  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v18  # "callingUid":I
    .restart local v19  # "i":I
    :goto_df
    :try_start_df
    const-string v0, "PackageManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Could not find package setting for package: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, ". Skipping suspending/un-suspending."

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v0, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14355
    invoke-interface {v8, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 14356
    monitor-exit v9

    .line 14341
    .end local v3  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v5  # "packageName":Ljava/lang/String;
    :goto_fe
    add-int/lit8 v14, v19, 0x1

    move-object/from16 v5, p6

    move-object v15, v8

    move/from16 v3, v18

    move-object/from16 v8, p1

    .end local v19  # "i":I
    .restart local v14  # "i":I
    goto/16 :goto_3c

    .line 14358
    .end local v8  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v18  # "callingUid":I
    .local v3, "callingUid":I
    .restart local v13  # "packageName":Ljava/lang/String;
    .restart local v15  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :catchall_109
    move-exception v0

    move/from16 v18, v3

    move-object v5, v13

    move/from16 v19, v14

    move-object v8, v15

    .end local v3  # "callingUid":I
    .end local v13  # "packageName":Ljava/lang/String;
    .end local v14  # "i":I
    .end local v15  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v5  # "packageName":Ljava/lang/String;
    .restart local v8  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v18  # "callingUid":I
    .restart local v19  # "i":I
    :goto_110
    monitor-exit v9
    :try_end_111
    .catchall {:try_start_df .. :try_end_111} :catchall_112

    throw v0

    :catchall_112
    move-exception v0

    goto :goto_110

    .line 14341
    .end local v5  # "packageName":Ljava/lang/String;
    .end local v8  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v18  # "callingUid":I
    .end local v19  # "i":I
    .restart local v3  # "callingUid":I
    .restart local v14  # "i":I
    .restart local v15  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    :cond_114
    move/from16 v18, v3

    move/from16 v19, v14

    move-object v8, v15

    .line 14371
    .end local v3  # "callingUid":I
    .end local v14  # "i":I
    .end local v15  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v8  # "unactionedPackages":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v18  # "callingUid":I
    invoke-interface {v2}, Ljava/util/List;->isEmpty()Z

    move-result v0

    if-nez v0, :cond_154

    .line 14372
    nop

    .line 14373
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v0

    new-array v0, v0, [Ljava/lang/String;

    .line 14372
    invoke-interface {v2, v0}, Ljava/util/List;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v0

    move-object v9, v0

    check-cast v9, [Ljava/lang/String;

    .line 14374
    .local v9, "changedPackages":[Ljava/lang/String;
    nop

    .line 14375
    invoke-virtual {v1}, Landroid/util/IntArray;->toArray()[I

    move-result-object v3

    .line 14374
    move-object v10, v1

    .end local v1  # "changedUids":Landroid/util/IntArray;
    .local v10, "changedUids":Landroid/util/IntArray;
    move-object/from16 v1, p0

    move-object v11, v2

    .end local v2  # "changedPackagesList":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .local v11, "changedPackagesList":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    move-object v2, v9

    move/from16 v12, v18

    .end local v18  # "callingUid":I
    .local v12, "callingUid":I
    move v13, v4

    move/from16 v4, p7

    move/from16 v5, p2

    move v14, v6

    move-object/from16 v6, p4

    invoke-direct/range {v1 .. v6}, Lcom/android/server/pm/PackageManagerService;->sendPackagesSuspendedForUser([Ljava/lang/String;[IIZLandroid/os/PersistableBundle;)V

    .line 14376
    move-object/from16 v1, p3

    invoke-direct {v7, v9, v14, v1, v13}, Lcom/android/server/pm/PackageManagerService;->sendMyPackageSuspendedOrUnsuspended([Ljava/lang/String;ZLandroid/os/PersistableBundle;I)V

    .line 14377
    iget-object v2, v7, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v2

    .line 14378
    :try_start_14c
    invoke-virtual {v7, v13}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 14379
    monitor-exit v2

    goto :goto_15c

    :catchall_151
    move-exception v0

    monitor-exit v2
    :try_end_153
    .catchall {:try_start_14c .. :try_end_153} :catchall_151

    throw v0

    .line 14371
    .end local v9  # "changedPackages":[Ljava/lang/String;
    .end local v10  # "changedUids":Landroid/util/IntArray;
    .end local v11  # "changedPackagesList":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v12  # "callingUid":I
    .restart local v1  # "changedUids":Landroid/util/IntArray;
    .restart local v2  # "changedPackagesList":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v18  # "callingUid":I
    :cond_154
    move-object v10, v1

    move-object v11, v2

    move v13, v4

    move v14, v6

    move/from16 v12, v18

    move-object/from16 v1, p3

    .line 14381
    .end local v1  # "changedUids":Landroid/util/IntArray;
    .end local v2  # "changedPackagesList":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .end local v18  # "callingUid":I
    .restart local v10  # "changedUids":Landroid/util/IntArray;
    .restart local v11  # "changedPackagesList":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    .restart local v12  # "callingUid":I
    :goto_15c
    invoke-interface {v8}, Ljava/util/List;->size()I

    move-result v0

    new-array v0, v0, [Ljava/lang/String;

    invoke-interface {v8, v0}, Ljava/util/List;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v0

    check-cast v0, [Ljava/lang/String;

    return-object v0
.end method

.method public setPermissionEnforced(Ljava/lang/String;Z)V
    .registers 7
    .param p1, "permission"  # Ljava/lang/String;
    .param p2, "enforced"  # Z

    .line 24729
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.GRANT_RUNTIME_PERMISSIONS"

    const-string/jumbo v2, "setPermissionEnforced"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 24731
    const-string v0, "android.permission.READ_EXTERNAL_STORAGE"

    invoke-virtual {v0, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_55

    .line 24732
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 24733
    :try_start_15
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mReadExternalStorageEnforced:Ljava/lang/Boolean;

    if-eqz v1, :cond_25

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mReadExternalStorageEnforced:Ljava/lang/Boolean;

    .line 24734
    invoke-virtual {v1}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v1

    if-eq v1, p2, :cond_35

    .line 24735
    :cond_25
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    .line 24736
    if-eqz p2, :cond_2c

    sget-object v2, Ljava/lang/Boolean;->TRUE:Ljava/lang/Boolean;

    goto :goto_2e

    :cond_2c
    sget-object v2, Ljava/lang/Boolean;->FALSE:Ljava/lang/Boolean;

    :goto_2e
    iput-object v2, v1, Lcom/android/server/pm/Settings;->mReadExternalStorageEnforced:Ljava/lang/Boolean;

    .line 24737
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 24739
    :cond_35
    monitor-exit v0
    :try_end_36
    .catchall {:try_start_15 .. :try_end_36} :catchall_52

    .line 24742
    invoke-static {}, Landroid/app/ActivityManager;->getService()Landroid/app/IActivityManager;

    move-result-object v0

    .line 24743
    .local v0, "am":Landroid/app/IActivityManager;
    if-eqz v0, :cond_50

    .line 24744
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 24746
    .local v1, "token":J
    :try_start_40
    const-string/jumbo v3, "setPermissionEnforcement"

    invoke-interface {v0, v3}, Landroid/app/IActivityManager;->killProcessesBelowForeground(Ljava/lang/String;)Z
    :try_end_46
    .catch Landroid/os/RemoteException; {:try_start_40 .. :try_end_46} :catch_4c
    .catchall {:try_start_40 .. :try_end_46} :catchall_47

    goto :goto_4d

    .line 24749
    :catchall_47
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v3

    .line 24747
    :catch_4c
    move-exception v3

    .line 24749
    :goto_4d
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 24752
    .end local v0  # "am":Landroid/app/IActivityManager;
    .end local v1  # "token":J
    :cond_50
    nop

    .line 24755
    return-void

    .line 24739
    :catchall_52
    move-exception v1

    :try_start_53
    monitor-exit v0
    :try_end_54
    .catchall {:try_start_53 .. :try_end_54} :catchall_52

    throw v1

    .line 24753
    :cond_55
    new-instance v0, Ljava/lang/IllegalArgumentException;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "No selective enforcement for "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public setRequiredForSystemUser(Ljava/lang/String;Z)Z
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "systemUserApp"  # Z

    .line 20243
    const-string/jumbo v0, "setRequiredForSystemUser can only be run by the system or root"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrRoot(Ljava/lang/String;)V

    .line 20244
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 20245
    :try_start_9
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 20246
    .local v1, "ps":Lcom/android/server/pm/PackageSetting;
    if-nez v1, :cond_2e

    .line 20247
    const-string v2, "PackageManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Package doesn\'t exist: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 20248
    const/4 v2, 0x0

    monitor-exit v0

    return v2

    .line 20250
    :cond_2e
    if-eqz p2, :cond_37

    .line 20251
    iget v2, v1, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    or-int/lit16 v2, v2, 0x200

    iput v2, v1, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    goto :goto_3d

    .line 20253
    :cond_37
    iget v2, v1, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    and-int/lit16 v2, v2, -0x201

    iput v2, v1, Lcom/android/server/pm/PackageSetting;->pkgPrivateFlags:I

    .line 20255
    :goto_3d
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 20256
    .end local v1  # "ps":Lcom/android/server/pm/PackageSetting;
    monitor-exit v0

    .line 20257
    const/4 v0, 0x1

    return v0

    .line 20256
    :catchall_45
    move-exception v1

    monitor-exit v0
    :try_end_47
    .catchall {:try_start_9 .. :try_end_47} :catchall_45

    throw v1
.end method

.method public setRuntimePermissionsVersion(II)V
    .registers 6
    .param p1, "version"  # I
    .param p2, "userId"  # I

    .line 26108
    invoke-static {p1}, Lcom/android/internal/util/Preconditions;->checkArgumentNonnegative(I)I

    .line 26109
    invoke-static {p2}, Lcom/android/internal/util/Preconditions;->checkArgumentNonnegative(I)I

    .line 26110
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.ADJUST_RUNTIME_PERMISSIONS_POLICY"

    const-string/jumbo v2, "setRuntimePermissionVersion"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 26113
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26114
    :try_start_13
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/pm/Settings;->setDefaultRuntimePermissionsVersionLPr(II)V

    .line 26115
    monitor-exit v0

    .line 26116
    return-void

    .line 26115
    :catchall_1a
    move-exception v1

    monitor-exit v0
    :try_end_1c
    .catchall {:try_start_13 .. :try_end_1c} :catchall_1a

    throw v1
.end method

.method public setSystemAppHiddenUntilInstalled(Ljava/lang/String;Z)V
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "hidden"  # Z

    .line 13870
    const-string/jumbo v0, "setSystemAppHiddenUntilInstalled"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrPhoneCaller(Ljava/lang/String;)V

    .line 13871
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 13872
    :try_start_9
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 13873
    .local v1, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_41

    invoke-virtual {v1}, Lcom/android/server/pm/PackageSetting;->isSystem()Z

    move-result v2

    if-nez v2, :cond_1c

    goto :goto_41

    .line 13876
    :cond_1c
    iget-object v2, v1, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    .line 13877
    .local v2, "pkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v2, :cond_28

    iget-object v3, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    if-eqz v3, :cond_28

    .line 13878
    iget-object v3, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-boolean p2, v3, Landroid/content/pm/ApplicationInfo;->hiddenUntilInstalled:Z

    .line 13880
    :cond_28
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, p1}, Lcom/android/server/pm/Settings;->getDisabledSystemPkgLPr(Ljava/lang/String;)Lcom/android/server/pm/PackageSetting;

    move-result-object v3

    .line 13881
    .local v3, "disabledPs":Lcom/android/server/pm/PackageSetting;
    if-nez v3, :cond_32

    .line 13882
    monitor-exit v0

    return-void

    .line 13884
    :cond_32
    iget-object v4, v3, Lcom/android/server/pm/PackageSetting;->pkg:Landroid/content/pm/PackageParser$Package;

    move-object v2, v4

    .line 13885
    if-eqz v2, :cond_3f

    iget-object v4, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    if-eqz v4, :cond_3f

    .line 13886
    iget-object v4, v2, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iput-boolean p2, v4, Landroid/content/pm/ApplicationInfo;->hiddenUntilInstalled:Z

    .line 13888
    .end local v1  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    .end local v2  # "pkg":Landroid/content/pm/PackageParser$Package;
    .end local v3  # "disabledPs":Lcom/android/server/pm/PackageSetting;
    :cond_3f
    monitor-exit v0

    .line 13889
    return-void

    .line 13874
    .restart local v1  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_41
    :goto_41
    monitor-exit v0

    return-void

    .line 13888
    .end local v1  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :catchall_43
    move-exception v1

    monitor-exit v0
    :try_end_45
    .catchall {:try_start_9 .. :try_end_45} :catchall_43

    throw v1
.end method

.method public setSystemAppInstallState(Ljava/lang/String;ZI)Z
    .registers 13
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "installed"  # Z
    .param p3, "userId"  # I

    .line 13893
    const-string/jumbo v0, "setSystemAppInstallState"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrPhoneCaller(Ljava/lang/String;)V

    .line 13894
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 13895
    :try_start_9
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 13897
    .local v1, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    const/4 v2, 0x0

    if-eqz v1, :cond_5a

    invoke-virtual {v1}, Lcom/android/server/pm/PackageSetting;->isSystem()Z

    move-result v3

    if-nez v3, :cond_1d

    goto :goto_5a

    .line 13901
    :cond_1d
    invoke-virtual {v1, p3}, Lcom/android/server/pm/PackageSetting;->getInstalled(I)Z

    move-result v3

    if-ne v3, p2, :cond_25

    .line 13902
    monitor-exit v0

    return v2

    .line 13904
    .end local v1  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_25
    monitor-exit v0
    :try_end_26
    .catchall {:try_start_9 .. :try_end_26} :catchall_5c

    .line 13906
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 13908
    .local v0, "callingId":J
    const/4 v2, 0x1

    if-eqz p2, :cond_3c

    .line 13910
    const/high16 v6, 0x400000

    const/4 v7, 0x3

    const/4 v8, 0x0

    move-object v3, p0

    move-object v4, p1

    move v5, p3

    :try_start_34
    invoke-virtual/range {v3 .. v8}, Lcom/android/server/pm/PackageManagerService;->installExistingPackageAsUser(Ljava/lang/String;IIILjava/util/List;)I
    :try_end_37
    .catchall {:try_start_34 .. :try_end_37} :catchall_55

    .line 13916
    nop

    .line 13927
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13916
    return v2

    .line 13920
    :cond_3c
    :try_start_3c
    new-instance v3, Landroid/content/pm/VersionedPackage;

    const/4 v4, -0x1

    invoke-direct {v3, p1, v4}, Landroid/content/pm/VersionedPackage;-><init>(Ljava/lang/String;I)V

    new-instance v4, Landroid/content/pm/PackageManager$LegacyPackageDeleteObserver;

    const/4 v5, 0x0

    invoke-direct {v4, v5}, Landroid/content/pm/PackageManager$LegacyPackageDeleteObserver;-><init>(Landroid/content/pm/IPackageDeleteObserver;)V

    .line 13922
    invoke-virtual {v4}, Landroid/content/pm/PackageManager$LegacyPackageDeleteObserver;->getBinder()Landroid/content/pm/IPackageDeleteObserver2;

    move-result-object v4

    const/4 v5, 0x4

    .line 13920
    invoke-virtual {p0, v3, v4, p3, v5}, Lcom/android/server/pm/PackageManagerService;->deletePackageVersioned(Landroid/content/pm/VersionedPackage;Landroid/content/pm/IPackageDeleteObserver2;II)V
    :try_end_50
    .catchall {:try_start_3c .. :try_end_50} :catchall_55

    .line 13925
    nop

    .line 13927
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13925
    return v2

    .line 13927
    :catchall_55
    move-exception v2

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v2

    .line 13898
    .end local v0  # "callingId":J
    .restart local v1  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_5a
    :goto_5a
    :try_start_5a
    monitor-exit v0

    return v2

    .line 13904
    .end local v1  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :catchall_5c
    move-exception v1

    monitor-exit v0
    :try_end_5e
    .catchall {:try_start_5a .. :try_end_5e} :catchall_5c

    throw v1
.end method

.method public setUpdateAvailable(Ljava/lang/String;Z)V
    .registers 6
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "updateAvailable"  # Z

    .line 22185
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.INSTALL_PACKAGES"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 22186
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 22187
    :try_start_b
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v1, v1, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/PackageSetting;

    .line 22188
    .local v1, "pkgSetting":Lcom/android/server/pm/PackageSetting;
    if-eqz v1, :cond_1a

    .line 22189
    invoke-virtual {v1, p2}, Lcom/android/server/pm/PackageSetting;->setUpdateAvailable(Z)V

    .line 22191
    .end local v1  # "pkgSetting":Lcom/android/server/pm/PackageSetting;
    :cond_1a
    monitor-exit v0

    .line 22192
    return-void

    .line 22191
    :catchall_1c
    move-exception v1

    monitor-exit v0
    :try_end_1e
    .catchall {:try_start_b .. :try_end_1e} :catchall_1c

    throw v1
.end method

.method public shouldShowRequestPermissionRationale(Ljava/lang/String;Ljava/lang/String;I)Z
    .registers 11
    .param p1, "permissionName"  # Ljava/lang/String;
    .param p2, "packageName"  # Ljava/lang/String;
    .param p3, "userId"  # I

    .line 6318
    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v0

    if-eq v0, p3, :cond_1e

    .line 6319
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "canShowRequestPermissionRationale for user "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "android.permission.INTERACT_ACROSS_USERS_FULL"

    invoke-virtual {v0, v2, v1}, Landroid/content/Context;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6324
    :cond_1e
    const/high16 v0, 0x10000000

    invoke-virtual {p0, p2, v0, p3}, Lcom/android/server/pm/PackageManagerService;->getPackageUid(Ljava/lang/String;II)I

    move-result v0

    .line 6325
    .local v0, "uid":I
    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v1

    invoke-static {v1}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v1

    invoke-static {v0}, Landroid/os/UserHandle;->getAppId(I)I

    move-result v2

    const/4 v3, 0x0

    if-eq v1, v2, :cond_34

    .line 6326
    return v3

    .line 6329
    :cond_34
    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->checkPermission(Ljava/lang/String;Ljava/lang/String;I)I

    move-result v1

    if-nez v1, :cond_3b

    .line 6331
    return v3

    .line 6336
    :cond_3b
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 6338
    .local v1, "identity":J
    :try_start_3f
    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->getPermissionFlags(Ljava/lang/String;Ljava/lang/String;I)I

    move-result v4
    :try_end_43
    .catchall {:try_start_3f .. :try_end_43} :catchall_54

    .line 6341
    .local v4, "flags":I
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6342
    nop

    .line 6344
    const/16 v5, 0x16

    .line 6348
    .local v5, "fixedFlags":I
    and-int/lit8 v6, v4, 0x16

    if-eqz v6, :cond_4e

    .line 6349
    return v3

    .line 6352
    :cond_4e
    and-int/lit8 v6, v4, 0x1

    if-eqz v6, :cond_53

    const/4 v3, 0x1

    :cond_53
    return v3

    .line 6341
    .end local v4  # "flags":I
    .end local v5  # "fixedFlags":I
    :catchall_54
    move-exception v3

    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v3
.end method

.method public shutdown()V
    .registers 5

    .line 10678
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackageUsage:Lcom/android/server/pm/PackageUsage;

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageUsage;->writeNow(Ljava/lang/Object;)V

    .line 10679
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mCompilerStats:Lcom/android/server/pm/CompilerStats;

    invoke-virtual {v0}, Lcom/android/server/pm/CompilerStats;->writeNow()V

    .line 10680
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mDexManager:Lcom/android/server/pm/dex/DexManager;

    invoke-virtual {v0}, Lcom/android/server/pm/dex/DexManager;->writePackageDexUsageNow()V

    .line 10681
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-static {v0}, Lcom/android/server/PackageWatchdog;->getInstance(Landroid/content/Context;)Lcom/android/server/PackageWatchdog;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/PackageWatchdog;->writeNow()V

    .line 10684
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 10685
    :try_start_1d
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v2, 0xe

    invoke-virtual {v1, v2}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->hasMessages(I)Z

    move-result v1

    if-eqz v1, :cond_4d

    .line 10686
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v1, v2}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->removeMessages(I)V

    .line 10687
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mDirtyUsers:Landroid/util/ArraySet;

    invoke-virtual {v1}, Landroid/util/ArraySet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_32
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_48

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/Integer;

    invoke-virtual {v2}, Ljava/lang/Integer;->intValue()I

    move-result v2

    .line 10688
    .local v2, "userId":I
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, v2}, Lcom/android/server/pm/Settings;->writePackageRestrictionsLPr(I)V

    .line 10689
    .end local v2  # "userId":I
    goto :goto_32

    .line 10690
    :cond_48
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mDirtyUsers:Landroid/util/ArraySet;

    invoke-virtual {v1}, Landroid/util/ArraySet;->clear()V

    .line 10692
    :cond_4d
    monitor-exit v0

    .line 10693
    return-void

    .line 10692
    :catchall_4f
    move-exception v1

    monitor-exit v0
    :try_end_51
    .catchall {:try_start_1d .. :try_end_51} :catchall_4f

    throw v1
.end method

.method public startFlymePackageManagerService(Landroid/content/Context;Lcom/android/server/pm/PackageManagerService;)Lcom/android/server/pm/FlymePackageManagerService;
    .registers 5
    .param p1, "context"  # Landroid/content/Context;
    .param p2, "pms"  # Lcom/android/server/pm/PackageManagerService;

    .line 26639
    new-instance v0, Lcom/android/server/pm/FlymePackageManagerService;

    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mInstaller:Lcom/android/server/pm/Installer;

    invoke-direct {v0, p1, p2, v1}, Lcom/android/server/pm/FlymePackageManagerService;-><init>(Landroid/content/Context;Lcom/android/server/pm/PackageManagerService;Lcom/android/server/pm/Installer;)V

    .line 26640
    .local v0, "service":Lcom/android/server/pm/FlymePackageManagerService;
    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->flymePackageManagerService:Lcom/android/server/pm/FlymePackageManagerService;

    .line 26641
    return-object v0
.end method

.method public systemReady()V
    .registers 15

    .line 22560
    const-string v0, "Only the system can claim the system is ready"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrRoot(Ljava/lang/String;)V

    .line 22562
    const/4 v0, 0x1

    iput-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mSystemReady:Z

    .line 22563
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v1

    .line 22564
    .local v1, "resolver":Landroid/content/ContentResolver;
    new-instance v2, Lcom/android/server/pm/PackageManagerService$6;

    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-direct {v2, p0, v3, v1}, Lcom/android/server/pm/PackageManagerService$6;-><init>(Lcom/android/server/pm/PackageManagerService;Landroid/os/Handler;Landroid/content/ContentResolver;)V

    .line 22577
    .local v2, "co":Landroid/database/ContentObserver;
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    .line 22578
    const-string v4, "enable_ephemeral_feature"

    invoke-static {v4}, Landroid/provider/Settings$Global;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v4

    .line 22577
    const/4 v5, -0x1

    const/4 v6, 0x0

    invoke-virtual {v3, v4, v6, v2, v5}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;I)V

    .line 22580
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    .line 22581
    const-string/jumbo v4, "instant_apps_enabled"

    invoke-static {v4}, Landroid/provider/Settings$Secure;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v4

    .line 22580
    invoke-virtual {v3, v4, v6, v2, v5}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;I)V

    .line 22582
    invoke-virtual {v2, v0}, Landroid/database/ContentObserver;->onChange(Z)V

    .line 22586
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getOpPackageName()Ljava/lang/String;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 22587
    invoke-virtual {v4}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v4

    .line 22586
    invoke-static {v3, p0, v4, v6}, Lcom/android/internal/telephony/CarrierAppUtils;->disableCarrierAppsUntilPrivileged(Ljava/lang/String;Landroid/content/pm/IPackageManager;Landroid/content/ContentResolver;I)V

    .line 22589
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->disableSkuSpecificApps()V

    .line 22592
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    .line 22593
    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    .line 22592
    const-string v4, "compatibility_mode"

    invoke-static {v3, v4, v0}, Landroid/provider/Settings$Global;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v3

    if-ne v3, v0, :cond_5a

    goto :goto_5b

    :cond_5a
    move v0, v6

    .line 22595
    .local v0, "compatibilityModeEnabled":Z
    :goto_5b
    invoke-static {v0}, Landroid/content/pm/PackageParser;->setCompatibilityModeEnabled(Z)V

    .line 22597
    sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_SETTINGS:Z

    if-eqz v3, :cond_78

    .line 22598
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "compatibility mode:"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, "PackageManager"

    invoke-static {v4, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 22601
    :cond_78
    sget-object v3, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    .line 22603
    .local v3, "grantPermissionsUserIds":[I
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v4

    .line 22612
    :try_start_7d
    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V

    .line 22613
    .local v5, "removed":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PreferredActivity;>;"
    move v7, v6

    .local v7, "i":I
    :goto_83
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v8, v8, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v8}, Landroid/util/SparseArray;->size()I

    move-result v8

    if-ge v7, v8, :cond_101

    .line 22614
    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v8, v8, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    invoke-virtual {v8, v7}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/pm/PreferredIntentResolver;

    .line 22615
    .local v8, "pir":Lcom/android/server/pm/PreferredIntentResolver;
    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 22616
    invoke-virtual {v8}, Lcom/android/server/pm/PreferredIntentResolver;->filterSet()Ljava/util/Set;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v9

    :goto_a2
    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z

    move-result v10

    if-eqz v10, :cond_be

    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/pm/PreferredActivity;

    .line 22617
    .local v10, "pa":Lcom/android/server/pm/PreferredActivity;
    iget-object v11, p0, Lcom/android/server/pm/PackageManagerService;->mComponentResolver:Lcom/android/server/pm/ComponentResolver;

    iget-object v12, v10, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v12, v12, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v11, v12}, Lcom/android/server/pm/ComponentResolver;->isActivityDefined(Landroid/content/ComponentName;)Z

    move-result v11

    if-nez v11, :cond_bd

    .line 22618
    invoke-virtual {v5, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 22620
    .end local v10  # "pa":Lcom/android/server/pm/PreferredActivity;
    :cond_bd
    goto :goto_a2

    .line 22621
    :cond_be
    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-lez v9, :cond_fe

    .line 22622
    move v9, v6

    .local v9, "r":I
    :goto_c5
    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v9, v10, :cond_f1

    .line 22623
    invoke-virtual {v5, v9}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/pm/PreferredActivity;

    .line 22624
    .restart local v10  # "pa":Lcom/android/server/pm/PreferredActivity;
    const-string v11, "PackageManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Removing dangling preferred activity: "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-object v13, v10, Lcom/android/server/pm/PreferredActivity;->mPref:Lcom/android/server/pm/PreferredComponent;

    iget-object v13, v13, Lcom/android/server/pm/PreferredComponent;->mComponent:Landroid/content/ComponentName;

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    invoke-static {v11, v12}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 22626
    invoke-virtual {v8, v10}, Lcom/android/server/pm/PreferredIntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 22622
    .end local v10  # "pa":Lcom/android/server/pm/PreferredActivity;
    add-int/lit8 v9, v9, 0x1

    goto :goto_c5

    .line 22628
    .end local v9  # "r":I
    :cond_f1
    iget-object v9, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v10, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v10, v10, Lcom/android/server/pm/Settings;->mPreferredActivities:Landroid/util/SparseArray;

    .line 22629
    invoke-virtual {v10, v7}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v10

    .line 22628
    invoke-virtual {v9, v10}, Lcom/android/server/pm/Settings;->writePackageRestrictionsLPr(I)V

    .line 22613
    .end local v8  # "pir":Lcom/android/server/pm/PreferredIntentResolver;
    :cond_fe
    add-int/lit8 v7, v7, 0x1

    goto :goto_83

    .line 22633
    .end local v7  # "i":I
    :cond_101
    invoke-static {}, Lcom/android/server/pm/UserManagerService;->getInstance()Lcom/android/server/pm/UserManagerService;

    move-result-object v7

    invoke-virtual {v7}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v7

    array-length v8, v7
    :try_end_10a
    .catchall {:try_start_7d .. :try_end_10a} :catchall_1ca

    move-object v9, v3

    move v3, v6

    .end local v3  # "grantPermissionsUserIds":[I
    .local v9, "grantPermissionsUserIds":[I
    :goto_10c
    if-ge v3, v8, :cond_120

    :try_start_10e
    aget v10, v7, v3

    .line 22634
    .local v10, "userId":I
    iget-object v11, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v11, v10}, Lcom/android/server/pm/Settings;->areDefaultRuntimePermissionsGrantedLPr(I)Z

    move-result v11

    if-nez v11, :cond_11d

    .line 22635
    invoke-static {v9, v10}, Lcom/android/internal/util/ArrayUtils;->appendInt([II)[I

    move-result-object v11

    move-object v9, v11

    .line 22633
    .end local v10  # "userId":I
    :cond_11d
    add-int/lit8 v3, v3, 0x1

    goto :goto_10c

    .line 22639
    .end local v5  # "removed":Ljava/util/ArrayList;, "Ljava/util/ArrayList<Lcom/android/server/pm/PreferredActivity;>;"
    :cond_120
    monitor-exit v4
    :try_end_121
    .catchall {:try_start_10e .. :try_end_121} :catchall_1c7

    .line 22641
    sget-object v3, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v3}, Lcom/android/server/pm/UserManagerService;->systemReady()V

    .line 22643
    array-length v3, v9

    move v4, v6

    :goto_128
    if-ge v4, v3, :cond_134

    aget v5, v9, v4

    .line 22644
    .local v5, "userId":I
    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    invoke-virtual {v7, v5}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->grantDefaultPermissions(I)V

    .line 22643
    .end local v5  # "userId":I
    add-int/lit8 v4, v4, 0x1

    goto :goto_128

    .line 22647
    :cond_134
    sget-object v3, Lcom/android/server/pm/PackageManagerService;->EMPTY_INT_ARRAY:[I

    if-ne v9, v3, :cond_13d

    .line 22651
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mDefaultPermissionPolicy:Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;

    invoke-virtual {v3}, Lcom/android/server/pm/permission/DefaultPermissionGrantPolicy;->scheduleReadDefaultPermissionExceptions()V

    .line 22657
    :cond_13d
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v3

    .line 22658
    :try_start_140
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    sget-object v5, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    .line 22659
    invoke-virtual {v7}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v7

    iget-object v8, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 22658
    invoke-virtual {v4, v5, v6, v7, v8}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updateAllPermissions(Ljava/lang/String;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 22662
    const-class v4, Lcom/android/server/policy/PermissionPolicyInternal;

    .line 22663
    invoke-static {v4}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/policy/PermissionPolicyInternal;

    .line 22664
    .local v4, "permissionPolicyInternal":Lcom/android/server/policy/PermissionPolicyInternal;
    new-instance v5, Lcom/android/server/pm/-$$Lambda$PackageManagerService$orqEly190XwOVPZamgdj4g2IzLU;

    invoke-direct {v5, p0}, Lcom/android/server/pm/-$$Lambda$PackageManagerService$orqEly190XwOVPZamgdj4g2IzLU;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    invoke-virtual {v4, v5}, Lcom/android/server/policy/PermissionPolicyInternal;->setOnInitializedCallback(Lcom/android/server/policy/PermissionPolicyInternal$OnInitializedCallback;)V

    .line 22672
    .end local v4  # "permissionPolicyInternal":Lcom/android/server/policy/PermissionPolicyInternal;
    monitor-exit v3
    :try_end_160
    .catchall {:try_start_140 .. :try_end_160} :catchall_1c4

    .line 22675
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-class v4, Landroid/os/storage/StorageManager;

    invoke-virtual {v3, v4}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/os/storage/StorageManager;

    .line 22676
    .local v3, "storage":Landroid/os/storage/StorageManager;
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mStorageListener:Landroid/os/storage/StorageEventListener;

    invoke-virtual {v3, v4}, Landroid/os/storage/StorageManager;->registerListener(Landroid/os/storage/StorageEventListener;)V

    .line 22678
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstallerService:Lcom/android/server/pm/PackageInstallerService;

    invoke-virtual {v4}, Lcom/android/server/pm/PackageInstallerService;->systemReady()V

    .line 22679
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mApexManager:Lcom/android/server/pm/ApexManager;

    invoke-virtual {v4}, Lcom/android/server/pm/ApexManager;->systemReady()V

    .line 22680
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPackageDexOptimizer:Lcom/android/server/pm/PackageDexOptimizer;

    invoke-virtual {v4}, Lcom/android/server/pm/PackageDexOptimizer;->systemReady()V

    .line 22682
    invoke-direct {p0}, Lcom/android/server/pm/PackageManagerService;->getStorageManagerInternal()Landroid/os/storage/StorageManagerInternal;

    move-result-object v4

    new-instance v5, Lcom/android/server/pm/PackageManagerService$7;

    invoke-direct {v5, p0}, Lcom/android/server/pm/PackageManagerService$7;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    invoke-virtual {v4, v5}, Landroid/os/storage/StorageManagerInternal;->addExternalStoragePolicy(Landroid/os/storage/StorageManagerInternal$ExternalStorageMountPolicy;)V

    .line 22705
    sget-object v4, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    sget-object v5, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    invoke-virtual {v4, v5}, Lcom/android/server/pm/UserManagerService;->reconcileUsers(Ljava/lang/String;)V

    .line 22706
    sget-object v4, Landroid/os/storage/StorageManager;->UUID_PRIVATE_INTERNAL:Ljava/lang/String;

    invoke-direct {p0, v4}, Lcom/android/server/pm/PackageManagerService;->reconcileApps(Ljava/lang/String;)V

    .line 22708
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    invoke-virtual {v4}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->systemReady()V

    .line 22710
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstantAppResolverConnection:Lcom/android/server/pm/InstantAppResolverConnection;

    if-eqz v4, :cond_1b0

    .line 22711
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    new-instance v5, Lcom/android/server/pm/PackageManagerService$8;

    invoke-direct {v5, p0}, Lcom/android/server/pm/PackageManagerService$8;-><init>(Lcom/android/server/pm/PackageManagerService;)V

    new-instance v6, Landroid/content/IntentFilter;

    const-string v7, "android.intent.action.BOOT_COMPLETED"

    invoke-direct {v6, v7}, Landroid/content/IntentFilter;-><init>(Ljava/lang/String;)V

    invoke-virtual {v4, v5, v6}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;

    .line 22720
    :cond_1b0
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mModuleInfoProvider:Lcom/android/server/pm/ModuleInfoProvider;

    invoke-virtual {v4}, Lcom/android/server/pm/ModuleInfoProvider;->systemReady()V

    .line 22725
    iget-object v4, p0, Lcom/android/server/pm/PackageManagerService;->mInstallerService:Lcom/android/server/pm/PackageInstallerService;

    invoke-virtual {v4}, Lcom/android/server/pm/PackageInstallerService;->restoreAndApplyStagedSessionIfNeeded()V

    .line 22729
    invoke-static {}, Lcom/flyme/server/pm/FlymeDexOptManager;->getInstance()Lcom/flyme/server/pm/FlymeDexOptManager;

    move-result-object v4

    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v4, p0, v5}, Lcom/flyme/server/pm/FlymeDexOptManager;->initEnv(Lcom/android/server/pm/PackageManagerService;Landroid/content/Context;)V

    .line 22731
    return-void

    .line 22672
    .end local v3  # "storage":Landroid/os/storage/StorageManager;
    :catchall_1c4
    move-exception v4

    :try_start_1c5
    monitor-exit v3
    :try_end_1c6
    .catchall {:try_start_1c5 .. :try_end_1c6} :catchall_1c4

    throw v4

    .line 22639
    :catchall_1c7
    move-exception v5

    move-object v3, v9

    goto :goto_1cb

    .end local v9  # "grantPermissionsUserIds":[I
    .local v3, "grantPermissionsUserIds":[I
    :catchall_1ca
    move-exception v5

    :goto_1cb
    :try_start_1cb
    monitor-exit v4
    :try_end_1cc
    .catchall {:try_start_1cb .. :try_end_1cc} :catchall_1ca

    throw v5
.end method

.method public unregisterMoveCallback(Landroid/content/pm/IPackageMoveObserver;)V
    .registers 5
    .param p1, "callback"  # Landroid/content/pm/IPackageMoveObserver;

    .line 24600
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.MOUNT_UNMOUNT_FILESYSTEMS"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 24602
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mMoveCallbacks:Lcom/android/server/pm/PackageManagerService$MoveCallbacks;

    invoke-virtual {v0, p1}, Lcom/android/server/pm/PackageManagerService$MoveCallbacks;->unregister(Landroid/content/pm/IPackageMoveObserver;)V

    .line 24603
    return-void
.end method

.method unsuspendForNonSystemSuspendingPackages(Landroid/util/ArraySet;)V
    .registers 6
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/util/ArraySet<",
            "Ljava/lang/Integer;",
            ">;)V"
        }
    .end annotation

    .line 14480
    .local p1, "userIds":Landroid/util/ArraySet;, "Landroid/util/ArraySet<Ljava/lang/Integer;>;"
    invoke-virtual {p1}, Landroid/util/ArraySet;->size()I

    move-result v0

    .line 14481
    .local v0, "sz":I
    const/4 v1, 0x0

    .local v1, "i":I
    :goto_5
    if-ge v1, v0, :cond_19

    .line 14482
    sget-object v2, Lcom/android/server/pm/-$$Lambda$PackageManagerService$8F_cRTr5jDNmLElQPCCP6cIQBH4;->INSTANCE:Lcom/android/server/pm/-$$Lambda$PackageManagerService$8F_cRTr5jDNmLElQPCCP6cIQBH4;

    .line 14484
    invoke-virtual {p1, v1}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/Integer;

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    .line 14482
    invoke-direct {p0, v2, v3}, Lcom/android/server/pm/PackageManagerService;->unsuspendForSuspendingPackages(Ljava/util/function/Predicate;I)V

    .line 14481
    add-int/lit8 v1, v1, 0x1

    goto :goto_5

    .line 14486
    .end local v1  # "i":I
    :cond_19
    return-void
.end method

.method unsuspendForSuspendingPackage(Ljava/lang/String;I)V
    .registers 8
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "affectedUser"  # I

    .line 14463
    const/4 v0, 0x0

    const/4 v1, -0x1

    if-ne p2, v1, :cond_b

    sget-object v1, Lcom/android/server/pm/PackageManagerService;->sUserManager:Lcom/android/server/pm/UserManagerService;

    invoke-virtual {v1}, Lcom/android/server/pm/UserManagerService;->getUserIds()[I

    move-result-object v1

    goto :goto_10

    .line 14464
    :cond_b
    const/4 v1, 0x1

    new-array v1, v1, [I

    aput p2, v1, v0

    :goto_10
    nop

    .line 14465
    .local v1, "userIds":[I
    array-length v2, v1

    :goto_12
    if-ge v0, v2, :cond_24

    aget v3, v1, v0

    .line 14466
    .local v3, "userId":I
    invoke-static {p1}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;

    new-instance v4, Lcom/android/server/pm/-$$Lambda$S4BXTl5Ly3EHhXAReFCtlz2B8eo;

    invoke-direct {v4, p1}, Lcom/android/server/pm/-$$Lambda$S4BXTl5Ly3EHhXAReFCtlz2B8eo;-><init>(Ljava/lang/String;)V

    invoke-direct {p0, v4, v3}, Lcom/android/server/pm/PackageManagerService;->unsuspendForSuspendingPackages(Ljava/util/function/Predicate;I)V

    .line 14465
    .end local v3  # "userId":I
    add-int/lit8 v0, v0, 0x1

    goto :goto_12

    .line 14468
    :cond_24
    return-void
.end method

.method updateFlagsForResolve(IILandroid/content/Intent;I)I
    .registers 12
    .param p1, "flags"  # I
    .param p2, "userId"  # I
    .param p3, "intent"  # Landroid/content/Intent;
    .param p4, "callingUid"  # I

    .line 5316
    const/4 v5, 0x0

    const/4 v6, 0x0

    move-object v0, p0

    move v1, p1

    move v2, p2

    move-object v3, p3

    move v4, p4

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZZ)I

    move-result v0

    return v0
.end method

.method updateFlagsForResolve(IILandroid/content/Intent;IZ)I
    .registers 13
    .param p1, "flags"  # I
    .param p2, "userId"  # I
    .param p3, "intent"  # Landroid/content/Intent;
    .param p4, "callingUid"  # I
    .param p5, "wantInstantApps"  # Z

    .line 5321
    const/4 v6, 0x0

    move-object v0, p0

    move v1, p1

    move v2, p2

    move-object v3, p3

    move v4, p4

    move v5, p5

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForResolve(IILandroid/content/Intent;IZZ)I

    move-result v0

    return v0
.end method

.method updateFlagsForResolve(IILandroid/content/Intent;IZZ)I
    .registers 11
    .param p1, "flags"  # I
    .param p2, "userId"  # I
    .param p3, "intent"  # Landroid/content/Intent;
    .param p4, "callingUid"  # I
    .param p5, "wantInstantApps"  # Z
    .param p6, "onlyExposedExplicitly"  # Z

    .line 5327
    iget-boolean v0, p0, Lcom/android/server/pm/PackageManagerService;->mSafeMode:Z

    if-eqz v0, :cond_7

    .line 5328
    const/high16 v0, 0x100000

    or-int/2addr p1, v0

    .line 5330
    :cond_7
    invoke-direct {p0, p4}, Lcom/android/server/pm/PackageManagerService;->getInstantAppPackageName(I)Ljava/lang/String;

    move-result-object v0

    const/high16 v1, 0x800000

    if-eqz v0, :cond_19

    .line 5332
    if-eqz p6, :cond_14

    .line 5333
    const/high16 v0, 0x2000000

    or-int/2addr p1, v0

    .line 5335
    :cond_14
    const/high16 v0, 0x1000000

    or-int/2addr p1, v0

    .line 5336
    or-int/2addr p1, v1

    goto :goto_3a

    .line 5338
    :cond_19
    and-int v0, p1, v1

    const/4 v1, 0x1

    const/4 v2, 0x0

    if-eqz v0, :cond_21

    move v0, v1

    goto :goto_22

    :cond_21
    move v0, v2

    .line 5339
    .local v0, "wantMatchInstant":Z
    :goto_22
    if-nez p5, :cond_2f

    if-eqz v0, :cond_2d

    .line 5340
    invoke-direct {p0, p4, p2}, Lcom/android/server/pm/PackageManagerService;->canViewInstantApps(II)Z

    move-result v3

    if-eqz v3, :cond_2d

    goto :goto_2f

    :cond_2d
    move v1, v2

    goto :goto_30

    :cond_2f
    :goto_2f
    nop

    .line 5341
    .local v1, "allowMatchInstant":Z
    :goto_30
    const v2, -0x3000001

    and-int/2addr p1, v2

    .line 5343
    if-nez v1, :cond_3a

    .line 5344
    const v2, -0x800001

    and-int/2addr p1, v2

    .line 5347
    .end local v0  # "wantMatchInstant":Z
    .end local v1  # "allowMatchInstant":Z
    :cond_3a
    :goto_3a
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/pm/PackageManagerService;->updateFlagsForComponent(IILjava/lang/Object;)I

    move-result v0

    return v0
.end method

.method public updateIntentVerificationStatus(Ljava/lang/String;II)Z
    .registers 9
    .param p1, "packageName"  # Ljava/lang/String;
    .param p2, "status"  # I
    .param p3, "userId"  # I

    .line 14935
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.SET_PREFERRED_APPLICATIONS"

    const/4 v2, 0x0

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 14938
    const/4 v0, 0x0

    .line 14939
    .local v0, "result":Z
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v1

    .line 14940
    :try_start_c
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    iget-object v2, v2, Lcom/android/server/pm/Settings;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/PackageSetting;

    .line 14941
    .local v2, "ps":Lcom/android/server/pm/PackageSetting;
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    invoke-static {}, Landroid/os/UserHandle;->getCallingUserId()I

    move-result v4

    invoke-direct {p0, v2, v3, v4}, Lcom/android/server/pm/PackageManagerService;->filterAppAccessLPr(Lcom/android/server/pm/PackageSetting;II)Z

    move-result v3

    if-eqz v3, :cond_27

    .line 14942
    const/4 v3, 0x0

    monitor-exit v1

    return v3

    .line 14944
    :cond_27
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v3, p1, p2, p3}, Lcom/android/server/pm/Settings;->updateIntentFilterVerificationStatusLPw(Ljava/lang/String;II)Z

    move-result v3

    move v0, v3

    .line 14945
    .end local v2  # "ps":Lcom/android/server/pm/PackageSetting;
    monitor-exit v1
    :try_end_2f
    .catchall {:try_start_c .. :try_end_2f} :catchall_35

    .line 14946
    if-eqz v0, :cond_34

    .line 14947
    invoke-virtual {p0, p3}, Lcom/android/server/pm/PackageManagerService;->scheduleWritePackageRestrictionsLocked(I)V

    .line 14949
    :cond_34
    return v0

    .line 14945
    :catchall_35
    move-exception v2

    :try_start_36
    monitor-exit v1
    :try_end_37
    .catchall {:try_start_36 .. :try_end_37} :catchall_35

    throw v2
.end method

.method public updatePackagesIfNeeded()V
    .registers 13

    .line 10093
    const-string v0, "Only the system can request package update"

    invoke-static {v0}, Lcom/android/server/pm/PackageManagerService;->enforceSystemOrRoot(Ljava/lang/String;)V

    .line 10096
    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->isDeviceUpgrading()Z

    move-result v0

    .line 10101
    .local v0, "causeUpgrade":Z
    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->isFirstBoot()Z

    move-result v1

    const/4 v2, 0x1

    const/4 v3, 0x0

    if-nez v1, :cond_18

    iget-boolean v1, p0, Lcom/android/server/pm/PackageManagerService;->mIsPreNUpgrade:Z

    if-eqz v1, :cond_16

    goto :goto_18

    :cond_16
    move v1, v3

    goto :goto_19

    :cond_18
    :goto_18
    move v1, v2

    .line 10104
    .local v1, "causeFirstBoot":Z
    :goto_19
    invoke-static {}, Ldalvik/system/VMRuntime;->didPruneDalvikCache()Z

    move-result v4

    .line 10106
    .local v4, "causePrunedCache":Z
    if-nez v0, :cond_24

    if-nez v1, :cond_24

    if-nez v4, :cond_24

    .line 10107
    return-void

    .line 10111
    :cond_24
    iget-object v5, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v5

    .line 10112
    :try_start_27
    iget-object v6, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v6}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v6

    invoke-static {v6, p0}, Lcom/android/server/pm/PackageManagerServiceUtils;->getPackagesForDexopt(Ljava/util/Collection;Lcom/android/server/pm/PackageManagerService;)Ljava/util/List;

    move-result-object v6

    .line 10113
    .local v6, "pkgs":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/PackageParser$Package;>;"
    monitor-exit v5
    :try_end_32
    .catchall {:try_start_27 .. :try_end_32} :catchall_80

    .line 10115
    invoke-static {}, Ljava/lang/System;->nanoTime()J

    move-result-wide v7

    .line 10116
    .local v7, "startTime":J
    iget-boolean v5, p0, Lcom/android/server/pm/PackageManagerService;->mIsPreNUpgrade:Z

    invoke-direct {p0, v6, v5, v3, v3}, Lcom/android/server/pm/PackageManagerService;->performDexOptUpgrade(Ljava/util/List;ZIZ)[I

    move-result-object v5

    .line 10123
    .local v5, "stats":[I
    sget-object v9, Ljava/util/concurrent/TimeUnit;->NANOSECONDS:Ljava/util/concurrent/TimeUnit;

    .line 10124
    invoke-static {}, Ljava/lang/System;->nanoTime()J

    move-result-wide v10

    sub-long/2addr v10, v7

    invoke-virtual {v9, v10, v11}, Ljava/util/concurrent/TimeUnit;->toSeconds(J)J

    move-result-wide v9

    long-to-int v9, v9

    .line 10126
    .local v9, "elapsedTimeSeconds":I
    iget-object v10, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    aget v3, v5, v3

    const-string/jumbo v11, "opt_dialog_num_dexopted"

    invoke-static {v10, v11, v3}, Lcom/android/internal/logging/MetricsLogger;->histogram(Landroid/content/Context;Ljava/lang/String;I)V

    .line 10127
    iget-object v3, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    aget v2, v5, v2

    const-string/jumbo v10, "opt_dialog_num_skipped"

    invoke-static {v3, v10, v2}, Lcom/android/internal/logging/MetricsLogger;->histogram(Landroid/content/Context;Ljava/lang/String;I)V

    .line 10128
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const/4 v3, 0x2

    aget v3, v5, v3

    const-string/jumbo v10, "opt_dialog_num_failed"

    invoke-static {v2, v10, v3}, Lcom/android/internal/logging/MetricsLogger;->histogram(Landroid/content/Context;Ljava/lang/String;I)V

    .line 10129
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {p0}, Lcom/android/server/pm/PackageManagerService;->getOptimizablePackages()Landroid/util/ArraySet;

    move-result-object v3

    invoke-virtual {v3}, Landroid/util/ArraySet;->size()I

    move-result v3

    const-string/jumbo v10, "opt_dialog_num_total"

    invoke-static {v2, v10, v3}, Lcom/android/internal/logging/MetricsLogger;->histogram(Landroid/content/Context;Ljava/lang/String;I)V

    .line 10130
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string/jumbo v3, "opt_dialog_time_s"

    invoke-static {v2, v3, v9}, Lcom/android/internal/logging/MetricsLogger;->histogram(Landroid/content/Context;Ljava/lang/String;I)V

    .line 10131
    return-void

    .line 10113
    .end local v5  # "stats":[I
    .end local v6  # "pkgs":Ljava/util/List;, "Ljava/util/List<Landroid/content/pm/PackageParser$Package;>;"
    .end local v7  # "startTime":J
    .end local v9  # "elapsedTimeSeconds":I
    :catchall_80
    move-exception v2

    :try_start_81
    monitor-exit v5
    :try_end_82
    .catchall {:try_start_81 .. :try_end_82} :catchall_80

    throw v2
.end method

.method public updatePermissionFlags(Ljava/lang/String;Ljava/lang/String;IIZI)V
    .registers 19
    .param p1, "permName"  # Ljava/lang/String;
    .param p2, "packageName"  # Ljava/lang/String;
    .param p3, "flagMask"  # I
    .param p4, "flagValues"  # I
    .param p5, "checkAdjustPolicyFlagPermission"  # Z
    .param p6, "userId"  # I

    .line 6045
    move-object v1, p0

    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v11

    .line 6046
    .local v11, "callingUid":I
    const/4 v2, 0x0

    .line 6048
    .local v2, "overridePolicy":Z
    const/16 v0, 0x3e8

    if-eq v11, v0, :cond_3c

    if-eqz v11, :cond_3c

    .line 6049
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 6051
    .local v3, "callingIdentity":J
    and-int/lit8 v0, p3, 0x4

    if-eqz v0, :cond_37

    .line 6052
    if-eqz p5, :cond_20

    .line 6053
    :try_start_16
    iget-object v0, v1, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v5, "android.permission.ADJUST_RUNTIME_PERMISSIONS_POLICY"

    const-string v6, "Need android.permission.ADJUST_RUNTIME_PERMISSIONS_POLICY to change policy flags"

    invoke-virtual {v0, v5, v6}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_28

    .line 6057
    :cond_20
    const/16 v0, 0x1d

    invoke-direct {p0, v11, v0}, Lcom/android/server/pm/PackageManagerService;->hasTargetSdkInUidLowerThan(II)Z

    move-result v0

    if-eqz v0, :cond_2a

    .line 6065
    :goto_28
    const/4 v2, 0x1

    goto :goto_37

    .line 6058
    :cond_2a
    new-instance v0, Ljava/lang/IllegalArgumentException;

    const-string v5, "android.permission.ADJUST_RUNTIME_PERMISSIONS_POLICY needs  to be checked for packages targeting 29 or later when changing policy flags"

    invoke-direct {v0, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    .end local v2  # "overridePolicy":Z
    .end local v3  # "callingIdentity":J
    .end local v11  # "callingUid":I
    .end local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .end local p1  # "permName":Ljava/lang/String;
    .end local p2  # "packageName":Ljava/lang/String;
    .end local p3  # "flagMask":I
    .end local p4  # "flagValues":I
    .end local p5  # "checkAdjustPolicyFlagPermission":Z
    .end local p6  # "userId":I
    throw v0
    :try_end_32
    .catchall {:try_start_16 .. :try_end_32} :catchall_32

    .line 6068
    .restart local v2  # "overridePolicy":Z
    .restart local v3  # "callingIdentity":J
    .restart local v11  # "callingUid":I
    .restart local p0  # "this":Lcom/android/server/pm/PackageManagerService;
    .restart local p1  # "permName":Ljava/lang/String;
    .restart local p2  # "packageName":Ljava/lang/String;
    .restart local p3  # "flagMask":I
    .restart local p4  # "flagValues":I
    .restart local p5  # "checkAdjustPolicyFlagPermission":Z
    .restart local p6  # "userId":I
    :catchall_32
    move-exception v0

    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0

    :cond_37
    :goto_37
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6069
    move v0, v2

    goto :goto_3d

    .line 6072
    .end local v3  # "callingIdentity":J
    :cond_3c
    move v0, v2

    .end local v2  # "overridePolicy":Z
    .local v0, "overridePolicy":Z
    :goto_3d
    iget-object v2, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v10, v1, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    move-object v3, p1

    move-object v4, p2

    move v5, p3

    move/from16 v6, p4

    move v7, v11

    move/from16 v8, p6

    move v9, v0

    invoke-virtual/range {v2 .. v10}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updatePermissionFlags(Ljava/lang/String;Ljava/lang/String;IIIIZLcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 6075
    return-void
.end method

.method public updatePermissionFlagsForAllApps(III)V
    .registers 12
    .param p1, "flagMask"  # I
    .param p2, "flagValues"  # I
    .param p3, "userId"  # I

    .line 6083
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 6084
    :try_start_3
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    .line 6085
    invoke-static {}, Lcom/android/server/pm/PackageManagerService;->getCallingUid()I

    move-result v4

    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->values()Ljava/util/Collection;

    move-result-object v6

    iget-object v7, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionCallback:Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;

    .line 6084
    move v2, p1

    move v3, p2

    move v5, p3

    invoke-virtual/range {v1 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updatePermissionFlagsForAllApps(IIIILjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)Z

    move-result v1

    .line 6087
    .local v1, "changed":Z
    if-eqz v1, :cond_20

    .line 6088
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    const/4 v3, 0x0

    invoke-virtual {v2, p3, v3}, Lcom/android/server/pm/Settings;->writeRuntimePermissionsForUserLPr(IZ)V

    .line 6090
    .end local v1  # "changed":Z
    :cond_20
    monitor-exit v0

    .line 6091
    return-void

    .line 6090
    :catchall_22
    move-exception v1

    monitor-exit v0
    :try_end_24
    .catchall {:try_start_3 .. :try_end_24} :catchall_22

    throw v1
.end method

.method public updatePermissions(Ljava/lang/String;)V
    .registers 10
    .param p1, "pkgName"  # Ljava/lang/String;

    .line 26839
    if-eqz p1, :cond_27

    .line 26840
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    monitor-enter v0

    .line 26841
    :try_start_5
    iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mPackages:Landroid/util/ArrayMap;

    invoke-virtual {v1, p1}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/PackageParser$Package;

    .line 26842
    .local v1, "tarPkg":Landroid/content/pm/PackageParser$Package;
    if-eqz v1, :cond_22

    .line 26843
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mPermissionManager:Lcom/android/server/pm/permission/PermissionManagerServiceInternal;

    iget-object v3, v1, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;

    const/4 v5, 0x1

    .line 26844
    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;

    move-result-object v6

    const/4 v7, 0x0

    .line 26843
    move-object v4, v1

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/pm/permission/PermissionManagerServiceInternal;->updatePermissions(Ljava/lang/String;Landroid/content/pm/PackageParser$Package;ZLjava/util/Collection;Lcom/android/server/pm/permission/PermissionManagerServiceInternal$PermissionCallback;)V

    .line 26846
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;

    invoke-virtual {v2}, Lcom/android/server/pm/Settings;->writeLPr()V

    .line 26848
    .end local v1  # "tarPkg":Landroid/content/pm/PackageParser$Package;
    :cond_22
    monitor-exit v0

    goto :goto_27

    :catchall_24
    move-exception v1

    monitor-exit v0
    :try_end_26
    .catchall {:try_start_5 .. :try_end_26} :catchall_24

    throw v1

    .line 26864
    :cond_27
    :goto_27
    return-void
.end method

.method public verifyIntentFilter(IILjava/util/List;)V
    .registers 7
    .param p1, "id"  # I
    .param p2, "verificationCode"  # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(II",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;)V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .line 14900
    .local p3, "failedDomains":Ljava/util/List;, "Ljava/util/List<Ljava/lang/String;>;"
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.INTENT_FILTER_VERIFICATION_AGENT"

    const-string v2, "Only intentfilter verification agents can verify applications"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 14904
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v1, 0x12

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 14905
    .local v0, "msg":Landroid/os/Message;
    new-instance v1, Lcom/android/server/pm/IntentFilterVerificationResponse;

    .line 14906
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-direct {v1, v2, p2, p3}, Lcom/android/server/pm/IntentFilterVerificationResponse;-><init>(IILjava/util/List;)V

    .line 14907
    .local v1, "response":Lcom/android/server/pm/IntentFilterVerificationResponse;
    iput p1, v0, Landroid/os/Message;->arg1:I

    .line 14908
    iput-object v1, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 14909
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v2, v0}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 14910
    return-void
.end method

.method public verifyPendingInstall(II)V
    .registers 6
    .param p1, "id"  # I
    .param p2, "verificationCode"  # I
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .line 14643
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;

    const-string v1, "android.permission.PACKAGE_VERIFICATION_AGENT"

    const-string v2, "Only package verification agents can verify applications"

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->enforceCallingOrSelfPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 14647
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    const/16 v1, 0xf

    invoke-virtual {v0, v1}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 14648
    .local v0, "msg":Landroid/os/Message;
    new-instance v1, Lcom/android/server/pm/PackageVerificationResponse;

    .line 14649
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-direct {v1, p2, v2}, Lcom/android/server/pm/PackageVerificationResponse;-><init>(II)V

    .line 14650
    .local v1, "response":Lcom/android/server/pm/PackageVerificationResponse;
    iput p1, v0, Landroid/os/Message;->arg1:I

    .line 14651
    iput-object v1, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 14652
    iget-object v2, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;

    invoke-virtual {v2, v0}, Lcom/android/server/pm/PackageManagerService$PackageHandler;->sendMessage(Landroid/os/Message;)Z

    .line 14653
    return-void
.end method

.method public waitForAppDataPrepared()V
    .registers 3

    .line 22734
    iget-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPrepareAppDataFuture:Ljava/util/concurrent/Future;

    if-nez v0, :cond_5

    .line 22735
    return-void

    .line 22737
    :cond_5
    const-string/jumbo v1, "wait for prepareAppData"

    invoke-static {v0, v1}, Lcom/android/internal/util/ConcurrentUtils;->waitForFutureNoInterrupt(Ljava/util/concurrent/Future;Ljava/lang/String;)Ljava/lang/Object;

    .line 22738
    const/4 v0, 0x0

    iput-object v0, p0, Lcom/android/server/pm/PackageManagerService;->mPrepareAppDataFuture:Ljava/util/concurrent/Future;

    .line 22739
    return-void
.end method
